{"version":3,"file":"timeline.bundle.js","sources":["../src/timeline-task.js","../src/timeline.js"],"sourcesContent":["import { Type } from 'main.core';\nimport { TaskUserData, TaskStatus } from 'bizproc.task';\nimport type { Timestamp } from 'bizproc.types';\n\nexport type TimelineTaskData = {\n\tcanView: boolean,\n\tstatus: number,\n\tid?: number,\n\tname?: string,\n\tmodified?: Timestamp,\n\tusers?: TaskUserData[],\n\texecutionTime: ?Timestamp,\n\tapproveType?: string,\n\turl: string,\n};\n\nexport class TimelineTask\n{\n\t#data: TimelineTaskData = {};\n\n\tconstructor(data: TimelineTaskData)\n\t{\n\t\tif (Type.isPlainObject(data))\n\t\t{\n\t\t\tthis.#data = data;\n\t\t}\n\t}\n\n\tcanView(): boolean\n\t{\n\t\treturn Type.isBoolean(this.#data.canView) ? this.#data.canView : false;\n\t}\n\n\tget status(): TaskStatus\n\t{\n\t\treturn new TaskStatus(this.#data.status);\n\t}\n\n\tget id(): number\n\t{\n\t\treturn Type.isInteger(this.#data.id) ? this.#data.id : 0;\n\t}\n\n\tget name(): string\n\t{\n\t\treturn Type.isString(this.#data.name) ? this.#data.name : '';\n\t}\n\n\tget modified(): Timestamp\n\t{\n\t\treturn Type.isInteger(this.#data.modified) ? Math.max(this.#data.modified, 0) : 0;\n\t}\n\n\tget users(): TaskUserData[]\n\t{\n\t\treturn Type.isArray(this.#data.users) ? this.#data.users : [];\n\t}\n\n\tget executionTime(): ?number\n\t{\n\t\treturn Type.isInteger(this.#data.executionTime) ? Math.max(this.#data.executionTime, 0) : null;\n\t}\n\n\tget approveType(): string\n\t{\n\t\treturn Type.isString(this.#data.approveType) ? this.#data.approveType : '';\n\t}\n\n\tget url(): ?null\n\t{\n\t\treturn Type.isStringFilled(this.#data.url) ? this.#data.url : null;\n\t}\n}\n","// eslint-disable-next-line max-classes-per-file\nimport { ajax, Type, Tag, Text, Dom, Runtime, Uri, Loc } from 'main.core';\nimport { DocumentId } from 'bizproc.document';\nimport { Timestamp, UserId } from 'bizproc.types';\nimport { Alert, AlertColor } from 'ui.alerts';\nimport 'ui.icons.b24';\nimport { TextCrop } from 'ui.textcrop';\nimport { Popup } from 'main.popup';\nimport { TaskStatus, TaskUserData, TaskData } from 'bizproc.task';\nimport { DateTimeFormat } from 'main.date';\n\nimport { TimelineTask } from './timeline-task';\n\nimport './css/style.css';\n\nexport type TimelineUserData = {\n\tid: UserId,\n\tlogin: string,\n\tname: string,\n\tlastName: string,\n\tsecondName: string,\n\tfullName: string,\n\tworkPosition: string,\n\tlink: string,\n\tavatarSize100: string,\n\tstatus: number,\n};\n\nexport type TimelineStatsData = {\n\taverageDuration: ?number,\n\tefficiency: string,\n};\n\nexport type TimelineData = {\n\tdocument: DocumentId,\n\tisWorkflowRunning: boolean,\n\ttimeToStart: ?Timestamp,\n\texecutionTime: ?Timestamp,\n\tstarted: ?Timestamp,\n\tstartedBy: UserId,\n\ttasks: TimelineTask[],\n\tusers: Map<UserId, TimelineUserData>,\n\tuserStatuses: Map<UserId, TaskStatus>,\n\tstats: TimelineStatsData,\n};\n\nexport class DurationFormatter\n{\n\tstatic #getFormatString(seconds: number): string\n\t{\n\t\tconst limits = [\n\t\t\t[3600 * 24 * 366, 'Ydiff'],\n\t\t\t[3600 * 24 * 31, 'mdiff'],\n\t\t\t[3600 * 24, 'ddiff'],\n\t\t\t[3600, 'Hdiff'],\n\t\t\t[60, 'idiff'],\n\t\t];\n\t\tfor (const limit of limits)\n\t\t{\n\t\t\tif (seconds > limit[0])\n\t\t\t{\n\t\t\t\treturn limit[1];\n\t\t\t}\n\t\t}\n\n\t\treturn 'sdiff';\n\t}\n\n\tstatic formatTimestamp(timestamp: number): string\n\t{\n\t\treturn DateTimeFormat.format(\n\t\t\tthis.#getFormatString(Date.now() / 1000 - timestamp),\n\t\t\ttimestamp,\n\t\t);\n\t}\n\n\tstatic formatTimeInterval(interval: ?number): string\n\t{\n\t\tif (Type.isNil(interval))\n\t\t{\n\t\t\treturn Loc.getMessage('BIZPROC_WORKFLOW_TIMELINE_SLIDER_AVERAGE_PROCESS_TIME_UNKNOWN');\n\t\t}\n\n\t\tif (interval === 0)\n\t\t{\n\t\t\treturn Loc.getMessage('BIZPROC_WORKFLOW_TIMELINE_SLIDER_ZERO_SECOND_INTERVAL');\n\t\t}\n\n\t\treturn DateTimeFormat.format(this.#getFormatString(interval), 0, interval);\n\t}\n\n\tstatic formatDate(timestamp: number, format: string): string\n\t{\n\t\treturn DateTimeFormat.format(format, timestamp);\n\t}\n}\n\nexport class Timeline\n{\n\t#workflowId: string;\n\t// #taskId: number;\n\t#data: ?TimelineData;\n\t#isLoaded: boolean;\n\t#errors: Array<{ message: string }> = [];\n\t#container: HTMLDivElement;\n\t#biPopup: HTMLDivElement;\n\t#dateFormat: string;\n\n\tconstructor(options: { workflowId: string, taskId?: number, }, config: { dateFormat: ?string, timeFormat: ?string, })\n\t{\n\t\tthis.#container = this.#renderContainer();\n\t\tsetTimeout(() => {\n\t\t\tthis.#textCrop();\n\t\t}, 500);\n\t\tif (Type.isPlainObject(options))\n\t\t{\n\t\t\tthis.#workflowId = options.workflowId;\n\t\t\t// this.#taskId = options.taskId;\n\t\t\tthis.#isLoaded = false;\n\n\t\t\tthis.#loadTimeline();\n\t\t}\n\n\t\tif (Type.isPlainObject(config))\n\t\t{\n\t\t\tthis.#dateFormat = `${config.dateFormat || 'j F Y'} ${config.timeFormat || 'H:i'}`;\n\t\t}\n\t}\n\n\tstatic open(options: { workflowId: string, taskId?: number }): void\n\t{\n\t\tRuntime\n\t\t\t.loadExtension('sidepanel')\n\t\t\t.then(() => {\n\t\t\t\tBX.SidePanel.Instance.open(\n\t\t\t\t\tUri.addParam(\n\t\t\t\t\t\t'/bitrix/components/bitrix/bizproc.workflow.timeline.slider/index.php',\n\t\t\t\t\t\tType.isPlainObject(options) ? options : {},\n\t\t\t\t\t),\n\t\t\t\t\t{\n\t\t\t\t\t\twidth: 950,\n\t\t\t\t\t\tallowChangeHistory: false,\n\t\t\t\t\t\tcacheable: false,\n\t\t\t\t\t\tloader: '/bitrix/js/bizproc/workflow/timeline/img/skeleton.svg',\n\t\t\t\t\t},\n\t\t\t\t);\n\t\t\t})\n\t\t\t.catch((response) => console.error(response.errors))\n\t\t;\n\t}\n\n\t#loadTimeline(): void\n\t{\n\t\tajax.runAction('bizproc.workflow.getTimeline', {\n\t\t\tdata: { workflowId: this.#workflowId },\n\t\t}).then((response) => {\n\t\t\tthis.#setDataFromResponse(response);\n\t\t\tthis.#isLoaded = true;\n\t\t\tthis.render();\n\t\t}).catch((response) => {\n\t\t\tthis.#setDataFromResponse(response);\n\t\t\tthis.#isLoaded = true;\n\t\t\tthis.render();\n\t\t});\n\t}\n\n\t#setDataFromResponse(response): void\n\t{\n\t\tif (Type.isPlainObject(response))\n\t\t{\n\t\t\tconst getString = (value, defaultValue = '') => (Type.isString(value) ? value : defaultValue);\n\t\t\tconst getArray = (value, defaultValue = []) => (Type.isArray(value) ? value : defaultValue);\n\t\t\tconst getBool = (value, defaultValue = false) => (Type.isBoolean(value) ? value : defaultValue);\n\t\t\tconst getInteger = (value, defaultValue = 0) => (Type.isInteger(value) ? value : defaultValue);\n\n\t\t\tif (Type.isPlainObject(response.data))\n\t\t\t{\n\t\t\t\tthis.#data = {\n\t\t\t\t\tdocument: new DocumentId({\n\t\t\t\t\t\tdocumentId: getArray(response.data.documentType),\n\t\t\t\t\t\tentityName: getString(response.data.entityName),\n\t\t\t\t\t\tdocumentName: getString(response.data.documentName),\n\t\t\t\t\t\tdocumentUrl: getString(response.data.documentUrl),\n\t\t\t\t\t\tmoduleName: getString(response.data.moduleName),\n\t\t\t\t\t}),\n\t\t\t\t\tisWorkflowRunning: getBool(response.data.isWorkflowRunning),\n\t\t\t\t\ttimeToStart: getInteger(response.data.timeToStart, null),\n\t\t\t\t\texecutionTime: getInteger(response.data.executionTime, null),\n\t\t\t\t\tstarted: getInteger(response.data.started, null),\n\t\t\t\t\tstartedBy: getInteger(response.data.startedBy),\n\t\t\t\t\ttasks: getArray(response.data.tasks).map((taskData) => new TimelineTask(taskData)),\n\t\t\t\t\tusers: new Map(),\n\t\t\t\t\tstats: {\n\t\t\t\t\t\taverageDuration: getInteger(response.data.stats.averageDuration, null),\n\t\t\t\t\t\tefficiency: getString(response.data.stats.efficiency),\n\t\t\t\t\t},\n\t\t\t\t};\n\n\t\t\t\tfor (const user of getArray(response.data.users))\n\t\t\t\t{\n\t\t\t\t\tthis.#data.users.set(Text.toInteger(user.id), user);\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis.#errors = getArray(response.errors);\n\t\t}\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\tDom.clean(this.#container);\n\n\t\tif (!this.#isLoaded || this.#hasErrors())\n\t\t{\n\t\t\tDom.append(this.#renderErrors(), this.#container);\n\t\t\tDom.append(this.#renderLoadingStub(), this.#container);\n\t\t}\n\n\t\tif (Type.isPlainObject(this.#data))\n\t\t{\n\t\t\tDom.replace(this.#container, this.#renderContainer());\n\t\t\tthis.#createEfficiencyPopup().show();\n\t\t\t// this.showBiPopup();\n\t\t}\n\n\t\treturn this.#container;\n\t}\n\n\t#renderHTMLElements(elements: Array<HTMLElement>): string\n\t{\n\t\tlet content = '';\n\t\telements.forEach((element) => {\n\t\t\tcontent += element.outerHTML;\n\t\t});\n\n\t\treturn content;\n\t}\n\n\t#renderItemTitle(title, iconClass, iconText, crop): HTMLElement\n\t{\n\t\tconst iconClassValue = Type.isString(iconClass) ? (` ${iconClass}`) : '';\n\t\tconst iconTextValue = Type.isString(iconText) ? iconText : '';\n\t\tconst cropValue = crop ? ' data-crop=\"crop\"' : '';\n\n\t\treturn Tag.render`\n\t\t\t<div>\n\t\t\t\t<span class=\"bizproc-workflow-timeline-icon${iconClassValue}\">${iconTextValue}</span>\n\t\t\t\t<div class=\"bizproc-workflow-timeline-title\"${cropValue}>${Text.encode(title)}</div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\t#renderSubject(subject): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"bizproc-workflow-timeline-subject\">${Text.encode(subject)}</div>\n\t\t`;\n\t}\n\n\t#renderProceedTaskButton(task: TaskData): HTMLElement\n\t{\n\t\tconst uri = (\n\t\t\ttask.url\n\t\t\t|| new Uri('/bitrix/components/bitrix/bizproc.workflow.info/')\n\t\t\t\t.setQueryParams({ workflow: this.#workflowId, task: task.id })\n\t\t\t\t.toString()\n\t\t);\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"task-button --hidden\">\n\t\t\t\t<a class=\"ui-btn ui-btn-xs ui-btn-primary ui-btn-round\" href=\"${Text.encode(uri)}\">\n\t\t\t\t\t${Loc.getMessage('BIZPROC_WORKFLOW_TIMELINE_SLIDER_BUTTON_PROCEED')}\n\t\t\t\t</a>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\t#renderUser(userId: UserId, userData: ?TaskUserData = null, task: ?TaskData = null): HTMLElement\n\t{\n\t\tconst user = this.#data.users.get(userId || userData.id);\n\t\tlet userClass = '';\n\t\tlet isWaiting = false;\n\t\tif (userData)\n\t\t{\n\t\t\tconst status = new TaskStatus(userData.status);\n\t\t\tif (status.isYes() || status.isOk())\n\t\t\t{\n\t\t\t\tuserClass = ' --voted-up';\n\t\t\t}\n\n\t\t\tif (status.isNo())\n\t\t\t{\n\t\t\t\tuserClass = ' --voted-down';\n\t\t\t}\n\n\t\t\tif (status.isWaiting())\n\t\t\t{\n\t\t\t\tisWaiting = true;\n\t\t\t}\n\t\t}\n\t\tconst position = Type.isString(user.workPosition)\n\t\t\t? (`<div class=\"bizproc-workflow-timeline-user-pos\">${Text.encode(user.workPosition)}</div>`)\n\t\t\t: '';\n\t\tlet avatar = '<i></i>';\n\t\tif (Type.isString(user.avatarSize100))\n\t\t{\n\t\t\tavatar = `<i style=\"background-image: url('${user.avatarSize100}')\"></i>`;\n\t\t}\n\t\tconst button = (task?.id && isWaiting) ? this.#renderProceedTaskButton(task) : '';\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"bizproc-workflow-timeline-user${userClass}\">\n\t\t\t\t<div class=\"bizproc-workflow-timeline-userlogo ui-icon ui-icon-common-user\">\n\t\t\t\t\t${avatar}\n\t\t\t\t</div>\n\t\t\t\t<div class=\"bizproc-workflow-timeline-user-block\">\n\t\t\t\t\t<a class=\"bizproc-workflow-timeline-link\" href=\"${user.link}\">${Text.encode(user.fullName)}</a>\n\t\t\t\t\t${position}\n\t\t\t\t</div>\n\t\t\t\t${button}\n\t\t\t</div>\n\t\t`;\n\t}\n\n\t#renderDoc(name, link, type, iconClass): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"bizproc-workflow-timeline-doc\">\n\t\t\t\t${this.#renderCaption(Loc.getMessage('BIZPROC_WORKFLOW_TIMELINE_SLIDER_START_DOC'))}\n\t\t\t\t<div class=\"bizproc-workflow-timeline-type\">\n\t\t\t\t\t<span class=\"ui-icon-set ${iconClass}\"></span>\n\t\t\t\t\t<span class=\"bizproc-workflow-timeline-type-text\">${type}</span>\n\t\t\t\t</div>\n\t\t\t\t<a class=\"bizproc-workflow-timeline-link\" href=\"${link}\" target=\"_top\">${Text.encode(name)}</a>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\t#renderCaption(caption): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"bizproc-workflow-timeline-caption\">${caption}</div>\n\t\t`;\n\t}\n\n\t#renderNotice(subject, text): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"bizproc-workflow-timeline-notice\">\n\t\t\t\t<div class=\"bizproc-workflow-timeline-subject\">${Text.encode(subject)}</div>\n\t\t\t\t<span class=\"bizproc-workflow-timeline-text\">${Text.encode(text)}</span>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\t#renderStatus(text, statusClass): HTMLElement\n\t{\n\t\tconst statusClassValue = Type.isString(statusClass) ? (` ${statusClass}`) : '';\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"bizproc-workflow-timeline-status${statusClassValue}\">${Text.encode(text)}</div>\n\t\t`;\n\t}\n\n\t#renderMore(): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"bizproc-workflow-timeline-item --more\">\n\t\t\t\t<div class=\"bizproc-workflow-timeline-item-inner\">\n\t\t\t\t\t<span class=\"bizproc-workflow-timeline-icon\"></span>\n\t\t\t\t\t<button class=\"ui-btn ui-btn-light-border ui-btn-xs\" type=\"button\" onclick=\"expandMore(event)\">\n\t\t\t\t\t\t<span class=\"ui-btn-text\">\n\t\t\t\t\t\t\t${Loc.getMessage('BIZPROC_WORKFLOW_TIMELINE_SLIDER_MORE_TASKS')}\n\t\t\t\t\t\t</span>\n\t\t\t\t\t</button>\n\t\t\t\t\t<script type=\"text/javascript\">\n\t\t\t\t\t\tfunction expandMore(event)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tconst moreItemBlock = event.target.closest('.--more');\n\t\t\t\t\t\t\tconst hiddenBlocks = document.querySelectorAll('.bizproc-workflow-timeline-item.--hidden:not(.--efficiency)');\n\t\t\t\t\t\t\tBX.Dom.addClass(moreItemBlock, '--hidden');\n\t\t\t\t\t\t\thiddenBlocks.forEach((hiddenBlock) => BX.Dom.removeClass(hiddenBlock, '--hidden'));\n\t\t\t\t\t\t}\n\t\t\t\t\t</script>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\t#renderContent(children): HTMLElement\n\t{\n\t\treturn (Tag.render`\n\t\t\t<div class=\"bizproc-workflow-timeline-content\">\n\t\t\t\t${this.#renderHTMLElements(children)}\n\t\t\t</div>\n\t\t`);\n\t}\n\n\t#renderItem(children, itemClass, efficiencyClass): HTMLElement\n\t{\n\t\tconst itemClassValue = Type.isString(itemClass) ? (` ${itemClass}`) : '';\n\t\tconst efficiencyClassValue = (\n\t\t\tType.isString(efficiencyClass) ? (` data-efficiency-class=\"${efficiencyClass}\"`) : ''\n\t\t);\n\n\t\treturn (Tag.render`\n\t\t\t<div class=\"bizproc-workflow-timeline-item${itemClassValue}\"${efficiencyClassValue}>\n\t\t\t\t<div class=\"bizproc-workflow-timeline-item-inner\">\n\t\t\t\t\t${children}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`);\n\t}\n\n\t#renderUserList(children): HTMLElement\n\t{\n\t\tlet hideMarksScript = '';\n\t\tif (children.length === 1)\n\t\t{\n\t\t\thideMarksScript = Tag.render`\n\t\t\t\t<script type=\"text/javascript\">\n\t\t\t\t\t(function () {\n\t\t\t\t\t\tfor (let userItem of document\n\t\t\t\t\t\t\t.currentScript\n\t\t\t\t\t\t\t.closest('.bizproc-workflow-timeline-user-list')\n\t\t\t\t\t\t\t.querySelectorAll('.bizproc-workflow-timeline-user')\n\t\t\t\t\t\t)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tBX.Dom.removeClass(userItem, ['--voted-up', '--voted-down']);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\t)();\n\t\t\t\t</script>\n\t\t\t`;\n\t\t}\n\n\t\treturn (Tag.render`\n\t\t\t<div class=\"bizproc-workflow-timeline-user-list\">\n\t\t\t\t${this.#renderHTMLElements(children)}\n\t\t\t\t${hideMarksScript}\n\t\t\t</div>\n\t\t`);\n\t}\n\n\t#renderVoteCaption(votedCnt, totalCnt): HTMLElement\n\t{\n\t\treturn this.#renderCaption(\n\t\t\tLoc.getMessage(\n\t\t\t\t'BIZPROC_WORKFLOW_TIMELINE_SLIDER_VOTED',\n\t\t\t\t{\n\t\t\t\t\t'#VOTED#': votedCnt,\n\t\t\t\t\t'#TOTAL#': totalCnt,\n\t\t\t\t},\n\t\t\t),\n\t\t);\n\t}\n\n\tgetStatusName(taskStatus: TaskStatus): string\n\t{\n\t\tif (taskStatus.isYes() || taskStatus.isOk())\n\t\t{\n\t\t\treturn Loc.getMessage('BIZPROC_WORKFLOW_TIMELINE_SLIDER_PERFORMED');\n\t\t}\n\n\t\tif (taskStatus.isNo() || taskStatus.isCancel())\n\t\t{\n\t\t\treturn Loc.getMessage('BIZPROC_WORKFLOW_TIMELINE_SLIDER_DECLINED');\n\t\t}\n\n\t\tif (taskStatus.isWaiting())\n\t\t{\n\t\t\treturn Loc.getMessage('BIZPROC_WORKFLOW_TIMELINE_SLIDER_PERFORMING');\n\t\t}\n\n\t\treturn taskStatus.name;\n\t}\n\n\t#renderItemsList(items): HTMLElement\n\t{\n\t\treturn (Tag.render`\n\t\t\t<div class=\"bizproc-workflow-timeline-wrapper\">\n\t\t\t\t<div class=\"bizproc-workflow-timeline-inner\">\n\t\t\t\t\t<div class=\"bizproc-workflow-timeline-list\">\n\t\t\t\t\t\t${this.#renderHTMLElements(items)}\n\t\t\t\t\t</div>\n\t\t\t\t\t<script type=\"text/javascript\">\n\t\t\t\t\t\t(function() {\n\t\t\t\t\t\t\tconst buttons = document.querySelectorAll('.task-button.--hidden');\n\t\t\t\t\t\t\tconst showButtons = buttons.length > 1;\n\t\t\t\t\t\t\tbuttons.forEach(function (button) {\n\t\t\t\t\t\t\t\tBX.Dom.insertBefore(\n\t\t\t\t\t\t\t\t\tbutton.closest('.bizproc-workflow-timeline-user'),\n\t\t\t\t\t\t\t\t\tbutton.closest('.bizproc-workflow-timeline-user-list').firstChild\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\tif (showButtons)\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tBX.Dom.removeClass(button, '--hidden')\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t})();\n\t\t\t\t\t</script>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`);\n\t}\n\n\t#renderFirstBlock(): HTMLElement\n\t{\n\t\tconst content = [];\n\t\tif (this.#data.startedBy)\n\t\t{\n\t\t\tcontent.push(\n\t\t\t\tthis.#renderCaption(Loc.getMessage('BIZPROC_WORKFLOW_TIMELINE_SLIDER_FROM')),\n\t\t\t\tthis.#renderUser(this.#data.startedBy),\n\t\t\t);\n\t\t}\n\t\tcontent.push(\n\t\t\tthis.#renderDoc(\n\t\t\t\tthis.#data.document.name,\n\t\t\t\tthis.#data.document.url,\n\t\t\t\tthis.#data.document.moduleName,\n\t\t\t\t'--file-2',\n\t\t\t),\n\t\t);\n\n\t\tif (!Type.isNil(this.#data.timeToStart))\n\t\t{\n\t\t\tcontent.push(this.#renderNotice(\n\t\t\t\tLoc.getMessage('BIZPROC_WORKFLOW_TIMELINE_SLIDER_EXECUTION_TIME'),\n\t\t\t\tDurationFormatter.formatTimeInterval(this.#data.timeToStart),\n\t\t\t));\n\t\t}\n\n\t\treturn this.#renderItem([\n\t\t\tthis.#renderItemTitle(\n\t\t\t\tthis.#data.document.entityName,\n\t\t\t\t'--success',\n\t\t\t\t'1',\n\t\t\t),\n\t\t\tthis.#data.started && this.#renderSubject(DurationFormatter.formatDate(this.#data.started, this.#dateFormat)),\n\t\t\tthis.#renderContent(content),\n\t\t], '--selected');\n\t}\n\n\t// eslint-disable-next-line max-lines-per-function\n\t#renderContainer(): HTMLElement\n\t{\n\t\tconst items = [];\n\t\tlet efficiencyClass = '';\n\t\tlet isWaiting = false;\n\n\t\tif (this.#data)\n\t\t{\n\t\t\tlet taskNumber = 1;\n\t\t\tlet task = null;\n\t\t\tlet hasHidden = false;\n\t\t\tlet userId = Loc.getMessage('USER_ID');\n\t\t\tuserId = userId ? parseInt(userId, 10) : null;\n\n\t\t\titems.push(this.#renderFirstBlock());\n\n\t\t\tfor (const taskIndex of Object.keys(this.#data.tasks))\n\t\t\t{\n\t\t\t\ttask = this.#data.tasks[taskIndex];\n\t\t\t\tlet iconClass = null;\n\n\t\t\t\tlet taskNumberNeeded = true;\n\t\t\t\tisWaiting = task.status.isWaiting();\n\t\t\t\tif (task.canView())\n\t\t\t\t{\n\t\t\t\t\tconst content = [];\n\t\t\t\t\tif (isWaiting)\n\t\t\t\t\t{\n\t\t\t\t\t\tif (hasHidden)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\titems.push(this.#renderMore());\n\t\t\t\t\t\t\thasHidden = false;\n\t\t\t\t\t\t}\n\t\t\t\t\t\ticonClass = '--processing';\n\t\t\t\t\t\ttaskNumberNeeded = false;\n\t\t\t\t\t\tif (task.approveType === 'vote')\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tlet votedCnt = 0;\n\t\t\t\t\t\t\t// eslint-disable-next-line max-depth\n\t\t\t\t\t\t\tfor (const user of task.users)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t// eslint-disable-next-line max-depth\n\t\t\t\t\t\t\t\tif (!(new TaskStatus(user.status).isWaiting()))\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tvotedCnt++;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tcontent.push(this.#renderVoteCaption(votedCnt, task.users.length));\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tcontent.push(this.#renderCaption(this.getStatusName(task.status)));\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\thasHidden = true;\n\t\t\t\t\t\tif (task.status.isOk() || task.status.isYes())\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\ticonClass = '--success';\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcontent.push(this.#renderCaption(this.getStatusName(task.status)));\n\t\t\t\t\t}\n\t\t\t\t\tconst users = [];\n\t\t\t\t\tfor (const user of Object.values(task.users))\n\t\t\t\t\t{\n\t\t\t\t\t\tusers.push(this.#renderUser(null, user, (user.id === userId) ? task : null));\n\t\t\t\t\t}\n\n\t\t\t\t\tif (users.length > 0)\n\t\t\t\t\t{\n\t\t\t\t\t\tcontent.push(this.#renderUserList(users));\n\t\t\t\t\t}\n\n\t\t\t\t\tif (!Type.isNil(task.executionTime))\n\t\t\t\t\t{\n\t\t\t\t\t\tcontent.push(\n\t\t\t\t\t\t\tthis.#renderNotice(\n\t\t\t\t\t\t\t\tLoc.getMessage('BIZPROC_WORKFLOW_TIMELINE_SLIDER_EXECUTION_TIME'),\n\t\t\t\t\t\t\t\tDurationFormatter.formatTimeInterval(task.executionTime),\n\t\t\t\t\t\t\t),\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t\titems.push(this.#renderItem([\n\t\t\t\t\t\tthis.#renderItemTitle(\n\t\t\t\t\t\t\ttask.name,\n\t\t\t\t\t\t\ticonClass,\n\t\t\t\t\t\t\ttaskNumberNeeded ? ((++taskNumber).toString()) : null,\n\t\t\t\t\t\t),\n\t\t\t\t\t\tthis.#renderSubject(DurationFormatter.formatDate(task.modified, this.#dateFormat)),\n\t\t\t\t\t\tthis.#renderContent(content),\n\t\t\t\t\t], isWaiting ? '--processing' : '--hidden'));\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tlet techItemClass = '--tech';\n\t\t\t\t\tif (isWaiting && this.#data.tasks.length > 1)\n\t\t\t\t\t{\n\t\t\t\t\t\ttechItemClass += ' --hidden';\n\t\t\t\t\t\thasHidden = true;\n\t\t\t\t\t}\n\t\t\t\t\titems.push(this.#renderItem([\n\t\t\t\t\t\tthis.#renderItemTitle(Loc.getMessage('BIZPROC_WORKFLOW_TIMELINE_SLIDER_NO_RIGHTS_TO_VIEW')),\n\t\t\t\t\t\tthis.#renderSubject(Loc.getMessage('BIZPROC_WORKFLOW_TIMELINE_SLIDER_NO_RIGHTS_TO_VIEW_TIP')),\n\t\t\t\t\t], techItemClass));\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (hasHidden)\n\t\t\t{\n\t\t\t\titems.push(this.#renderMore());\n\t\t\t}\n\n\t\t\tif (this.#data.isWorkflowRunning)\n\t\t\t{\n\t\t\t\tif (isWaiting)\n\t\t\t\t{\n\t\t\t\t\titems.push(this.#renderItem([\n\t\t\t\t\t\tthis.#renderItemTitle(Loc.getMessage('BIZPROC_WORKFLOW_TIMELINE_SLIDER_IN_PROGRESS')),\n\t\t\t\t\t\tthis.#renderSubject(\n\t\t\t\t\t\t\tLoc.getMessage('BIZPROC_WORKFLOW_TIMELINE_SLIDER_IN_PROGRESS_TIP'),\n\t\t\t\t\t\t),\n\t\t\t\t\t], '--tech --previous-item'));\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\titems.push(this.#renderItem([\n\t\t\t\t\t\tthis.#renderItemTitle(Loc.getMessage('BIZPROC_WORKFLOW_TIMELINE_SLIDER_IN_PROGRESS_INTERMEDIATE')),\n\t\t\t\t\t\tthis.#renderSubject(\n\t\t\t\t\t\t\tLoc.getMessage('BIZPROC_WORKFLOW_TIMELINE_SLIDER_IN_PROGRESS_INTERMEDIATE_TIP'),\n\t\t\t\t\t\t),\n\t\t\t\t\t], '--tech --previous-item'));\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tconst isOk = !task || task.status.isOk() || task.status.isYes();\n\t\t\t\tconst content = [\n\t\t\t\t\tthis.#renderCaption(Loc.getMessage('BIZPROC_WORKFLOW_TIMELINE_SLIDER_PROCESS_FINISHED')),\n\t\t\t\t];\n\t\t\t\tif (this.#data.startedBy)\n\t\t\t\t{\n\t\t\t\t\tcontent.push(\n\t\t\t\t\t\tisOk\n\t\t\t\t\t\t\t? this.#renderStatus(Loc.getMessage('BIZPROC_WORKFLOW_TIMELINE_SLIDER_APPROVED_FOR'))\n\t\t\t\t\t\t\t: this.#renderStatus(\n\t\t\t\t\t\t\t\tLoc.getMessage('BIZPROC_WORKFLOW_TIMELINE_SLIDER_DECLINED'),\n\t\t\t\t\t\t\t\t'--failure',\n\t\t\t\t\t\t\t),\n\t\t\t\t\t\tthis.#renderUser(this.#data.startedBy),\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t\tcontent.push(this.#renderNotice(\n\t\t\t\t\tLoc.getMessage('BIZPROC_WORKFLOW_TIMELINE_SLIDER_PROCESS_EXECUTED'),\n\t\t\t\t\tDurationFormatter.formatTimeInterval(this.#data.executionTime),\n\t\t\t\t));\n\t\t\t\tefficiencyClass = isOk ? '--success' : '--declined';\n\t\t\t\titems.push(\n\t\t\t\t\tthis.#renderItem(\n\t\t\t\t\t\t[\n\t\t\t\t\t\t\tthis.#renderItemTitle(\n\t\t\t\t\t\t\t\tthis.#data.document.entityName,\n\t\t\t\t\t\t\t\tisOk ? '--success' : null,\n\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\tthis.#data.started && this.#renderSubject(\n\t\t\t\t\t\t\t\tDurationFormatter.formatDate(\n\t\t\t\t\t\t\t\t\tthis.#data.started + this.#data.executionTime,\n\t\t\t\t\t\t\t\t\tthis.#dateFormat,\n\t\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\tthis.#renderContent(content),\n\t\t\t\t\t\t],\n\t\t\t\t\t\tisOk ? '--success --previous' : '--declined --selected --previous',\n\t\t\t\t\t\tefficiencyClass,\n\t\t\t\t\t),\n\t\t\t\t\tthis.#renderEfficiencyInlineContent(),\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\n\t\treturn this.#renderItemsList(items);\n\t}\n\n\t#textCrop()\n\t{\n\t\tconst textCropNodes = document.querySelectorAll('[data-crop=\"crop\"]');\n\t\tfor (const textCropNode of textCropNodes)\n\t\t{\n\t\t\tconst text = new TextCrop({\n\t\t\t\trows: 2,\n\t\t\t\ttarget: textCropNode,\n\n\t\t\t});\n\t\t\ttext.init();\n\t\t}\n\t}\n\n\t#createEfficiencyPopup(): Popup\n\t{\n\t\treturn new Popup({\n\t\t\twidth: 403,\n\t\t\tminHeight: 345,\n\t\t\tcloseIcon: true,\n\t\t\tcontent: this.#renderEfficiencyPopupContent(),\n\t\t\tbindElement: {\n\t\t\t\tleft: 555,\n\t\t\t\ttop: 130,\n\t\t\t},\n\t\t\tpadding: 26,\n\t\t\tborderRadius: '18px',\n\t\t\tclassName: '--bizproc-timeline-popup',\n\t\t\tevents: {\n\t\t\t\tonPopupClose: () => {\n\t\t\t\t\tlet inlineEfficiencyPrev = document.querySelector('.--previous-item');\n\t\t\t\t\tif (!inlineEfficiencyPrev)\n\t\t\t\t\t{\n\t\t\t\t\t\tinlineEfficiencyPrev = document.querySelector('.bizproc-workflow-timeline-item.--processing');\n\t\t\t\t\t}\n\n\t\t\t\t\tif (!inlineEfficiencyPrev)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tBX.Dom.addClass(inlineEfficiencyPrev, '--previous');\n\t\t\t\t\tlet efficiencyInlineClass = inlineEfficiencyPrev.getAttribute('data-efficiency-class');\n\t\t\t\t\tif (!efficiencyInlineClass)\n\t\t\t\t\t{\n\t\t\t\t\t\tefficiencyInlineClass = '';\n\t\t\t\t\t}\n\t\t\t\t\tinlineEfficiencyPrev.after(this.#renderEfficiencyInlineContent(efficiencyInlineClass));\n\t\t\t\t},\n\t\t\t},\n\t\t});\n\t}\n\n\t#getEfficiencyData()\n\t{\n\t\tlet logoClass = '--first';\n\t\tlet notice = Loc.getMessage('BIZPROC_WORKFLOW_TIMELINE_SLIDER_NO_STATS');\n\n\t\tswitch (this.#data.stats.efficiency)\n\t\t{\n\t\t\tcase 'fast':\n\t\t\t\tif (\n\t\t\t\t\tDurationFormatter.formatTimeInterval(this.#data.stats.averageDuration)\n\t\t\t\t\t=== DurationFormatter.formatTimeInterval(this.#data.executionTime)\n\t\t\t\t)\n\t\t\t\t{\n\t\t\t\t\tlogoClass = '--slow';\n\t\t\t\t\tnotice = Loc.getMessage('BIZPROC_WORKFLOW_TIMELINE_SLIDER_PERFORMED_SLOWLY');\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tlogoClass = '--fast';\n\t\t\t\t\tnotice = Loc.getMessage('BIZPROC_WORKFLOW_TIMELINE_SLIDER_PERFORMED_QUICKLY');\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase 'slow':\n\t\t\t\tlogoClass = '--slow';\n\t\t\t\tnotice = Loc.getMessage('BIZPROC_WORKFLOW_TIMELINE_SLIDER_PERFORMED_SLOWLY');\n\t\t\t\tbreak;\n\t\t\tcase 'stopped':\n\t\t\t\tlogoClass = '--stopped';\n\t\t\t\tnotice = Loc.getMessage('BIZPROC_WORKFLOW_TIMELINE_SLIDER_PERFORMED_NO_PROGRESS');\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tbreak;\n\t\t}\n\n\t\treturn [logoClass, notice];\n\t}\n\n\t#renderEfficiencyInlineContent(itemClass: string): HTMLElement\n\t{\n\t\tconst [logoClass, notice] = this.#getEfficiencyData();\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"bizproc-workflow-timeline-item --efficiency ${itemClass}\">\n\t\t\t\t<div class=\"bizproc-workflow-timeline-item-inner\">\n\t\t\t\t\t<div class=\"bizproc-workflow-timeline-title\">\n\t\t\t\t\t\t${Loc.getMessage('BIZPROC_WORKFLOW_TIMELINE_SLIDER_EFFECTIVITY_MARK')}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"bizproc-workflow-timeline-content\">\n\t\t\t\t\t\t<div class=\"bizproc-workflow-timeline-eff-icon ${logoClass}\"></div>\n\t\t\t\t\t\t<div class=\"bizproc-workflow-timeline-content-inner\">\n\t\t\t\t\t\t\t<div class=\"bizproc-workflow-timeline-caption\">${notice}</div>\n\t\t\t\t\t\t\t<div class=\"bizproc-workflow-timeline-notice\">\n\t\t\t\t\t\t\t\t<div class=\"bizproc-workflow-timeline-subject\">\n\t\t\t\t\t\t\t\t\t${Loc.getMessage('BIZPROC_WORKFLOW_TIMELINE_SLIDER_CURRENT_PROCESS_TIME')}\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<span class=\"bizproc-workflow-timeline-text\">\n\t\t\t\t\t\t\t\t\t${DurationFormatter.formatTimeInterval(this.#data.executionTime)}\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class=\"bizproc-workflow-timeline-notice\">\n\t\t\t\t\t\t\t\t<div class=\"bizproc-workflow-timeline-subject\">\n\t\t\t\t\t\t\t\t\t${Loc.getMessage('BIZPROC_WORKFLOW_TIMELINE_SLIDER_AVERAGE_PROCESS_TIME')}\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<span class=\"bizproc-workflow-timeline-text\">\n\t\t\t\t\t\t\t\t\t${\n\t\t\t\t\t\t\t\t\t\t(this.#data.stats.averageDuration === null)\n\t\t\t\t\t\t\t\t\t\t\t? Loc.getMessage('BIZPROC_WORKFLOW_TIMELINE_SLIDER_AVERAGE_PROCESS_TIME_UNKNOWN')\n\t\t\t\t\t\t\t\t\t\t\t: DurationFormatter.formatTimeInterval(this.#data.stats.averageDuration)\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\t\n\t\t\t</div>\n\t\t`;\n\t}\n\n\t#renderEfficiencyPopupContent()\n\t{\n\t\tconst [logoClass, notice] = this.#getEfficiencyData();\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"bizproc-timeline-popup\">\n\t\t\t\t<div class=\"bizproc-timeline-popup-title\">\n\t\t\t\t\t${Loc.getMessage('BIZPROC_WORKFLOW_TIMELINE_SLIDER_EFFECTIVITY_MARK')}\n\t\t\t\t</div>\n\t\t\t\t<div class=\"bizproc-timeline-popup-main\">\n\t\t\t\t\t<div class=\"bizproc-timeline-popup-status\">\n\t\t\t\t\t\t<div class=\"bizproc-timeline-popup-logo ${logoClass}\"></div>\n\t\t\t\t\t\t<div class=\"bizproc-timeline-popup-notice\">${notice}</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"bizproc-timeline-popup-content\">\n\t\t\t\t\t\t<div class=\"bizproc-timeline-popup-block\">\n\t\t\t\t\t\t\t<span class=\"bizproc-timeline-popup-val\">\n\t\t\t\t\t\t\t\t${DurationFormatter.formatTimeInterval(this.#data.executionTime)}\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t<div class=\"bizproc-timeline-popup-prop\">\n\t\t\t\t\t\t\t\t${Loc.getMessage('BIZPROC_WORKFLOW_TIMELINE_SLIDER_CURRENT_PROCESS_TIME')}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"bizproc-timeline-popup-block\">\n\t\t\t\t\t\t\t<span class=\"bizproc-timeline-popup-val\">\n\t\t\t\t\t\t\t\t${DurationFormatter.formatTimeInterval(this.#data.stats.averageDuration)}\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t<div class=\"bizproc-timeline-popup-prop\">\n\t\t\t\t\t\t\t\t${Loc.getMessage('BIZPROC_WORKFLOW_TIMELINE_SLIDER_AVERAGE_PROCESS_TIME')}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"bizproc-timeline-popup-footer\">\n\t\t\t\t\t<p class=\"bizproc-timeline-popup-text\">\n\t\t\t\t\t\t${Loc.getMessage('BIZPROC_WORKFLOW_TIMELINE_SLIDER_PERFORMANCE_TUNING_TIP')}\n\t\t\t\t\t</p>\n\t\t\t\t\t<a class=\"bizproc-timeline-popup-text\" href=\"javascript:top.BX.Helper.show('redirect=detail&code=18783714')\">\n\t\t\t\t\t\t${Loc.getMessage('BIZPROC_WORKFLOW_TIMELINE_SLIDER_PERFORMANCE_TUNING_LINK')}\n\t\t\t\t\t</a>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tshowBiPopup(): void\n\t{\n\t\tthis.#getBiPopup().show();\n\t}\n\n\t#getBiPopup(): Popup\n\t{\n\t\tif (!this.#biPopup)\n\t\t{\n\t\t\treturn this.#createBiPopup();\n\t\t}\n\n\t\treturn this.#biPopup;\n\t}\n\n\t#createBiPopup(): Popup\n\t{\n\t\tthis.#biPopup = new Popup({\n\t\t\twidth: 403,\n\t\t\tminHeight: 183,\n\t\t\tcloseIcon: true,\n\t\t\tcontent: this.#renderBiPopupContent(),\n\t\t\tbindElement: {\n\t\t\t\tleft: 207,\n\t\t\t\ttop: 482,\n\t\t\t},\n\t\t\tpadding: 17,\n\t\t\tborderRadius: '18px',\n\t\t\tclassName: '--bizproc-timeline-popup --bi',\n\t\t});\n\n\t\treturn this.#biPopup;\n\t}\n\n\t#renderBiPopupContent()\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"bizproc-timeline-popup\">\n\t\t\t\t<div class=\"bizproc-timeline-popup-title\">${Loc.getMessage('BIZPROC_WORKFLOW_TIMELINE_SLIDER_BI_ANALYTICS_TITLE')}</div>\n\t\t\t\t<p class=\"bizproc-timeline-popup-info\">${Loc.getMessage('BIZPROC_WORKFLOW_TIMELINE_SLIDER_BI_ANALYTICS_TIP')}</p>\n\t\t\t\t<button class=\"ui-btn ui-btn-light-border ui-btn-round ui-btn-xs\">\n\t\t\t\t\t<span class=\"ui-btn-text\">${Loc.getMessage('BIZPROC_WORKFLOW_TIMELINE_SLIDER_BI_ANALYTICS_LINK')}</span>\n\t\t\t\t</button>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\t#renderLoadingStub(): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<img src=\"/bitrix/js/bizproc/workflow/timeline/img/skeleton.svg\"\n\t\t\t\t style=\"width:100%; margin: 0; padding: 0;\"/>\n\t\t`;\n\t}\n\n\t#renderErrors(): HTMLElement\n\t{\n\t\tconst errorsContainer = Dom.create('div');\n\n\t\tfor (const error of this.#errors)\n\t\t{\n\t\t\tconst alert = new Alert({\n\t\t\t\ttext: Text.encode(error.message),\n\t\t\t\tcolor: AlertColor.DANGER,\n\t\t\t\tcloseBtn: true,\n\t\t\t\tanimated: true,\n\t\t\t});\n\n\t\t\talert.renderTo(errorsContainer);\n\t\t}\n\n\t\treturn errorsContainer;\n\t}\n\n\t#hasErrors(): boolean\n\t{\n\t\treturn this.#errors.length > 0;\n\t}\n}\n"],"names":["TimelineTask","constructor","data","Type","isPlainObject","canView","isBoolean","status","TaskStatus","id","isInteger","name","isString","modified","Math","max","users","isArray","executionTime","approveType","url","isStringFilled","DurationFormatter","formatTimestamp","timestamp","DateTimeFormat","format","Date","now","formatTimeInterval","interval","isNil","Loc","getMessage","formatDate","seconds","limits","limit","Timeline","options","config","setTimeout","workflowId","dateFormat","timeFormat","open","Runtime","loadExtension","then","BX","SidePanel","Instance","Uri","addParam","width","allowChangeHistory","cacheable","loader","catch","response","console","error","errors","render","Dom","clean","append","replace","show","getStatusName","taskStatus","isYes","isOk","isNo","isCancel","isWaiting","showBiPopup","ajax","runAction","getString","value","defaultValue","getArray","getBool","getInteger","document","DocumentId","documentId","documentType","entityName","documentName","documentUrl","moduleName","isWorkflowRunning","timeToStart","started","startedBy","tasks","map","taskData","Map","stats","averageDuration","efficiency","user","set","Text","toInteger","elements","content","forEach","element","outerHTML","title","iconClass","iconText","crop","iconClassValue","iconTextValue","cropValue","Tag","encode","subject","task","uri","setQueryParams","workflow","toString","userId","userData","get","userClass","position","workPosition","avatar","avatarSize100","button","link","fullName","type","caption","text","statusClass","statusClassValue","children","itemClass","efficiencyClass","itemClassValue","efficiencyClassValue","hideMarksScript","length","votedCnt","totalCnt","items","push","taskNumber","hasHidden","parseInt","taskIndex","Object","keys","taskNumberNeeded","values","techItemClass","textCropNodes","querySelectorAll","textCropNode","TextCrop","rows","target","init","Popup","minHeight","closeIcon","bindElement","left","top","padding","borderRadius","className","events","onPopupClose","inlineEfficiencyPrev","querySelector","addClass","efficiencyInlineClass","getAttribute","after","logoClass","notice","errorsContainer","create","alert","Alert","message","color","AlertColor","DANGER","closeBtn","animated","renderTo"],"mappings":"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"}