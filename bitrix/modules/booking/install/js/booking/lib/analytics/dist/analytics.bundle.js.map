{"version":3,"file":"analytics.bundle.js","sources":["../src/lib/index.js","../src/resource-creation-wizard/lib.js","../src/section/lib.js","../src/banner/banner-analytics.js","../src/booking/booking-analytics.js","../src/resource-creation-wizard/rcw-analytics.js","../src/section/section-analytics.js"],"sourcesContent":["import { Core } from 'booking.core';\nimport { AnalyticsCSection, Model, Module } from 'booking.const';\n\nexport function getCSection(): $Values<typeof AnalyticsCSection>\n{\n\tconst embedItems = Core.getStore()?.state?.[Model.Interface]?.embedItems || [];\n\tconst fromCrm = embedItems.some((item) => item.moduleId === Module.Crm);\n\n\treturn fromCrm ? AnalyticsCSection.crm : AnalyticsCSection.booking;\n}\n","import { Type } from 'main.core';\nimport { Core } from 'booking.core';\nimport { Model } from 'booking.const';\n\nexport { getCSection } from '../lib';\n\nexport function isExistingResource(): boolean\n{\n\tconst $store = Core.getStore();\n\tconst resourceId = $store.state[Model.ResourceCreationWizard].resourceId || null;\n\n\treturn Type.isNumber(resourceId);\n}\n","import { EntityTypeId, Module } from 'booking.const';\nimport type { DealData } from 'booking.model.bookings';\n\nimport type { OpenSectionCSubSection, OpenSectionCSection } from './types';\n\nexport function getOpenSectionCSection(editingBookingId: number, embedItems: DealData[] = []): OpenSectionCSection\n{\n\treturn embedItems.some(({ moduleId }) => moduleId === Module.Crm) || editingBookingId > 0\n\t\t? 'crm'\n\t\t: 'main_menu';\n}\n\nexport function getOpenSectionCSubSection(editingBookingId: number, embedItems: DealData[] = []): OpenSectionCSubSection\n{\n\tif (editingBookingId > 0)\n\t{\n\t\treturn 'crm_business';\n\t}\n\n\tif (embedItems.length === 0)\n\t{\n\t\treturn '';\n\t}\n\n\tconst entityTypeSet = new Set(embedItems.map(({ entityTypeId }) => entityTypeId));\n\tconst isType = (entityTypeId: $Values<typeof EntityTypeId>): boolean => entityTypeSet.has(entityTypeId);\n\tconst isSmart = (): boolean => {\n\t\tconst regExp = /^DYNAMIC_\\d+$/;\n\t\tfor (const entityType of entityTypeSet)\n\t\t{\n\t\t\tif (regExp.test(entityType))\n\t\t\t{\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\n\t\treturn false;\n\t};\n\n\tif (isType(EntityTypeId.Lead))\n\t{\n\t\treturn 'lead';\n\t}\n\n\tif (isType(EntityTypeId.Deal))\n\t{\n\t\treturn 'deal';\n\t}\n\n\tif (isSmart())\n\t{\n\t\treturn 'smart';\n\t}\n\n\tif (isType(EntityTypeId.Company))\n\t{\n\t\treturn 'company';\n\t}\n\n\tif (isType(EntityTypeId.Contact))\n\t{\n\t\treturn 'contact';\n\t}\n\n\treturn '';\n}\n","import { sendData } from 'ui.analytics';\nimport { AnalyticsTool, AnalyticsCategory } from 'booking.const';\nimport type { ShowPopupBannerAnalyticsOptions, ClickEnableBannerAnalyticsOptions } from './types';\n\nexport class BannerAnalytics\n{\n\tstatic sendShowPopup(): void\n\t{\n\t\tconst options: ShowPopupBannerAnalyticsOptions = {\n\t\t\ttool: AnalyticsTool.booking,\n\t\t\tcategory: AnalyticsCategory.booking,\n\t\t\tevent: 'show_popup',\n\t\t\tc_section: 'booking',\n\t\t};\n\t\tsendData(options);\n\t}\n\n\tstatic sendClickEnable(): void\n\t{\n\t\tconst options: ClickEnableBannerAnalyticsOptions = {\n\t\t\ttool: AnalyticsTool.booking,\n\t\t\tcategory: AnalyticsCategory.booking,\n\t\t\tevent: 'click_enable',\n\t\t\tc_section: 'booking',\n\t\t};\n\t\tsendData(options);\n\t}\n}\n","import { sendData } from 'ui.analytics';\n\nimport { Core } from 'booking.core';\nimport { AnalyticsTool, AnalyticsCategory, Model } from 'booking.const';\n\nimport { getCSection } from '../lib';\nimport type { AddBookingOptions } from './types';\n\nexport class BookingAnalytics\n{\n\tstatic sendAddMultiBookings(bookingIds: number[]): void\n\t{\n\t\tconst $store = Core.getStore();\n\t\tconst cSection = getCSection();\n\t\tconst overbookingMap = $store.getters[`${Model.Bookings}/overbookingMap`];\n\t\tfor (const bookingId of bookingIds)\n\t\t{\n\t\t\tconst isOverbooking = overbookingMap.has(bookingId);\n\t\t\tconst options: AddBookingOptions = {\n\t\t\t\ttool: AnalyticsTool.booking,\n\t\t\t\tcategory: AnalyticsCategory.booking,\n\t\t\t\tevent: 'add_booking',\n\t\t\t\tc_section: cSection,\n\t\t\t\tc_element: 'multi_button',\n\t\t\t\tp1: 'isMultiResource_Y',\n\t\t\t\tp2: isOverbooking ? 'isOverbooking_Y' : 'isOverbooking_N',\n\t\t\t\tp3: 'isWaitlist_N',\n\t\t\t};\n\t\t\tsendData(options);\n\t\t}\n\t}\n\n\tstatic sendAddBooking({ isOverbooking, isWaitlist }: { isOverbooking: boolean, isWaitlist: boolean }): void\n\t{\n\t\tconst options: AddBookingOptions = {\n\t\t\ttool: AnalyticsTool.booking,\n\t\t\tcategory: AnalyticsCategory.booking,\n\t\t\tevent: 'add_booking',\n\t\t\tc_section: getCSection(),\n\t\t\tc_element: 'solo_button',\n\t\t\tp1: 'isMultiResource_N',\n\t\t\tp2: isOverbooking ? 'isOverbooking_Y' : 'isOverbooking_N',\n\t\t\tp3: isWaitlist ? 'isWaitlist_Y' : 'isWaitlist_N',\n\t\t};\n\t\tsendData(options);\n\t}\n}\n","import { sendData } from 'ui.analytics';\n\nimport { Core } from 'booking.core';\nimport {\n\tAnalyticsTool,\n\tAnalyticsCategory,\n\tAnalyticsEvent,\n\tAnalyticsElement,\n\tModel,\n} from 'booking.const';\nimport type { SlotLengthId } from 'booking.model.resource-creation-wizard';\n\nimport { getCSection, isExistingResource } from './lib';\nimport type {\n\tClickAddResourceOptions,\n\tAddResourceStep1Options,\n\tAddResourceStep2Options,\n\tAddResourceFinishOptions,\n\tAcceptAgreementOptions,\n\tP1RenderType,\n\tP2SetSchedule,\n\tP3SlotLength,\n\tP1InfoNotification,\n\tP2ConfirmationNotification,\n\tP3ReminderNotification,\n\tP4DelayedNotification,\n\tP5FeedbackNotification,\n\tAcceptAgreementCSubSection,\n} from './types';\n\nexport class RcwAnalytics\n{\n\tstatic sendClickAddResource(): void\n\t{\n\t\tconst options: ClickAddResourceOptions = {\n\t\t\ttool: AnalyticsTool.booking,\n\t\t\tcategory: AnalyticsCategory.booking,\n\t\t\tevent: AnalyticsEvent.clickAddResource,\n\t\t\tc_section: getCSection(),\n\t\t\tc_element: AnalyticsElement.addButton,\n\t\t};\n\n\t\tsendData(options);\n\t}\n\n\tstatic sendAddResourceStep1(): void\n\t{\n\t\tconst $store = Core.getStore();\n\t\tif (isExistingResource())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst options: AddResourceStep1Options = {\n\t\t\ttool: AnalyticsTool.booking,\n\t\t\tcategory: AnalyticsCategory.booking,\n\t\t\tevent: AnalyticsEvent.addResourceStep1,\n\t\t\tc_section: getCSection(),\n\t\t};\n\n\t\tlet code = $store.getters[`${Model.ResourceCreationWizard}/advertisingResourceType`]?.code || null;\n\t\tif (code === 'none')\n\t\t{\n\t\t\tcode = 'other';\n\t\t}\n\n\t\tif (!code)\n\t\t{\n\t\t\tconsole.error('Booking.RCW. Code not found');\n\n\t\t\treturn;\n\t\t}\n\n\t\toptions.type = code;\n\n\t\tsendData(options);\n\t}\n\n\tstatic sendAddResourceStep2(): void\n\t{\n\t\tconst $store = Core.getStore();\n\t\tif (isExistingResource())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst getP1 = (): P1RenderType => {\n\t\t\treturn $store.state[Model.ResourceCreationWizard].resource.isMain\n\t\t\t\t? 'renderType_main'\n\t\t\t\t: 'renderType_additional';\n\t\t};\n\n\t\tconst getP2 = (): P2SetSchedule => {\n\t\t\treturn $store.state[Model.ResourceCreationWizard].globalSchedule\n\t\t\t\t? 'setSchedule_Y'\n\t\t\t\t: 'setSchedule_N';\n\t\t};\n\n\t\tconst getP3 = (): P3SlotLength => {\n\t\t\tconst slotLengthId: SlotLengthId = $store.state[Model.ResourceCreationWizard].slotLengthId;\n\t\t\tswitch (slotLengthId / 60)\n\t\t\t{\n\t\t\t\tcase 1:\n\t\t\t\t\treturn 'slotLength_1h';\n\t\t\t\tcase 2:\n\t\t\t\t\treturn 'slotLength_2h';\n\t\t\t\tcase 24:\n\t\t\t\t\treturn 'slotLength_24h';\n\t\t\t\tcase 168:\n\t\t\t\t\treturn 'slotLength_7d';\n\t\t\t\tdefault:\n\t\t\t\t\treturn 'slotLength_custom';\n\t\t\t}\n\t\t};\n\n\t\tconst options: AddResourceStep2Options = {\n\t\t\ttool: AnalyticsTool.booking,\n\t\t\tcategory: AnalyticsCategory.booking,\n\t\t\tevent: AnalyticsEvent.addResourceStep2,\n\t\t\tc_section: getCSection(),\n\t\t\tp1: getP1(),\n\t\t\tp2: getP2(),\n\t\t\tp3: getP3(),\n\t\t};\n\t\tsendData(options);\n\t}\n\n\tstatic sendAddResourceFinish(): void\n\t{\n\t\tconst $store = Core.getStore();\n\t\tif (isExistingResource())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst isCurrentSenderAvailable = $store.getters[`${Model.Notifications}/isCurrentSenderAvailable`];\n\t\tconst resource = $store.state[Model.ResourceCreationWizard].resource;\n\n\t\tconst getP1 = (): P1InfoNotification => {\n\t\t\treturn isCurrentSenderAvailable && resource.isInfoNotificationOn\n\t\t\t\t? 'infoNotification_Y'\n\t\t\t\t: 'infoNotification_N';\n\t\t};\n\n\t\tconst getP2 = (): P2ConfirmationNotification => {\n\t\t\treturn isCurrentSenderAvailable && resource.isConfirmationNotificationOn\n\t\t\t\t? 'confirmationNotification_Y'\n\t\t\t\t: 'confirmationNotification_N';\n\t\t};\n\n\t\tconst getP3 = (): P3ReminderNotification => {\n\t\t\treturn isCurrentSenderAvailable && resource.isReminderNotificationOn\n\t\t\t\t? 'reminderNotification_Y'\n\t\t\t\t: 'reminderNotification_N';\n\t\t};\n\n\t\tconst getP4 = (): P4DelayedNotification => {\n\t\t\treturn isCurrentSenderAvailable && resource.isDelayedNotificationOn\n\t\t\t\t? 'delayedNotification_Y'\n\t\t\t\t: 'delayedNotification_N';\n\t\t};\n\n\t\tconst getP5 = (): P5FeedbackNotification => {\n\t\t\treturn isCurrentSenderAvailable && resource.isFeedbackNotificationOn\n\t\t\t\t? 'feedbackNotification_Y'\n\t\t\t\t: 'feedbackNotification_N';\n\t\t};\n\n\t\tconst options: AddResourceFinishOptions = {\n\t\t\ttool: AnalyticsTool.booking,\n\t\t\tcategory: AnalyticsCategory.booking,\n\t\t\tevent: AnalyticsEvent.addResourceFinish,\n\t\t\tc_section: getCSection(),\n\t\t\tp1: getP1(),\n\t\t\tp2: getP2(),\n\t\t\tp3: getP3(),\n\t\t\tp4: getP4(),\n\t\t\tp5: getP5(),\n\t\t};\n\t\tsendData(options);\n\t}\n\n\tstatic sendAcceptAgreement({ accepted }: { accepted: boolean }): void\n\t{\n\t\tif (isExistingResource())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst getCSubSection = (): AcceptAgreementCSubSection => {\n\t\t\treturn accepted ? 'accept' : 'deny';\n\t\t};\n\n\t\tconst options: AcceptAgreementOptions = {\n\t\t\ttool: AnalyticsTool.booking,\n\t\t\tcategory: AnalyticsCategory.booking,\n\t\t\tevent: AnalyticsEvent.acceptAgreement,\n\t\t\tc_section: getCSection(),\n\t\t\tc_sub_section: getCSubSection(),\n\t\t};\n\t\tsendData(options);\n\t}\n}\n","import { sendData } from 'ui.analytics';\n\nimport { Core } from 'booking.core';\nimport {\n\tAnalyticsTool,\n\tAnalyticsCategory,\n\tModel,\n} from 'booking.const';\nimport type { DealData } from 'booking.model.bookings';\n\nimport { getOpenSectionCSection, getOpenSectionCSubSection } from './lib';\nimport type { OpenSectionAnalyticsOptions } from './types';\n\nexport class SectionAnalytics\n{\n\tstatic sendOpenSection(): void\n\t{\n\t\tconst $store = Core.getStore();\n\t\tconst embedItems: DealData[] = $store.getters[`${Model.Interface}/embedItems`];\n\t\tconst editingBookingId: number = $store.getters[`${Model.Interface}/editingBookingId`] || 0;\n\n\t\tconst options: OpenSectionAnalyticsOptions = {\n\t\t\ttool: AnalyticsTool.booking,\n\t\t\tcategory: AnalyticsCategory.booking,\n\t\t\tevent: 'open_section',\n\t\t\tc_section: getOpenSectionCSection(editingBookingId, embedItems),\n\t\t\tc_sub_section: getOpenSectionCSubSection(editingBookingId, embedItems),\n\t\t};\n\t\tsendData(options);\n\t}\n}\n"],"names":["getCSection","Core","getStore","_Core$getStore","state","_Core$getStore$state","Model","Interface","_Core$getStore$state$","embedItems","some","item","moduleId","Module","Crm","AnalyticsCSection","crm","booking","isExistingResource","resourceId","ResourceCreationWizard","Type","isNumber","getOpenSectionCSection","editingBookingId","getOpenSectionCSubSection","length","entityTypeSet","Set","map","entityTypeId","isType","has","EntityTypeId","Lead","Deal","regExp","entityType","test","isSmart","Company","Contact","[object Object]","options","tool","AnalyticsTool","category","AnalyticsCategory","event","c_section","sendData","bookingIds","$store","cSection","overbookingMap","getters","Bookings","bookingId","isOverbooking","c_element","p1","p2","p3","isWaitlist","AnalyticsEvent","clickAddResource","AnalyticsElement","addButton","addResourceStep1","code","_$store$getters","type","console","error","addResourceStep2","resource","isMain","globalSchedule","slotLengthId","getP3","isCurrentSenderAvailable","Notifications","addResourceFinish","isInfoNotificationOn","isConfirmationNotificationOn","isReminderNotificationOn","p4","isDelayedNotificationOn","p5","isFeedbackNotificationOn","accepted","acceptAgreement","c_sub_section"],"mappings":"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"}