{"version":3,"file":"segments.bundle.js","sources":["../src/segments.js"],"sourcesContent":["export type LineSegment = [number, number];\n\nexport class Segments\n{\n\t#segments: LineSegment[] = [];\n\n\tconstructor(segments: LineSegment[] = [])\n\t{\n\t\tthis.#segments = segments;\n\t}\n\n\ttoArray(): LineSegment[]\n\t{\n\t\treturn this.#segments;\n\t}\n\n\tadd(segment: LineSegment): LineSegment[]\n\t{\n\t\t// <...[+++]...> new segment doesnt add anything\n\t\tif (this.#segments.some((it: LineSegment) => segment[0] >= it[0] && segment[1] <= it[1]))\n\t\t{\n\t\t\treturn this.#segments;\n\t\t}\n\n\t\tconst intersects = this.#segments.some((it: LineSegment) => segment[1] > it[0] && segment[0] < it[1]);\n\t\tif (!intersects)\n\t\t{\n\t\t\tthis.#segments = [...this.#segments, segment];\n\n\t\t\treturn this.#segments;\n\t\t}\n\n\t\tthis.#segments = this.#segments.map((it: LineSegment) => {\n\t\t\t// <...[...>+++] extend right\n\t\t\tif (segment[0] >= it[0] && segment[0] <= it[1] && segment[1] >= it[1])\n\t\t\t{\n\t\t\t\treturn [it[0], segment[1]];\n\t\t\t}\n\n\t\t\t// [+++<...]...> extend left\n\t\t\tif (segment[1] >= it[0] && segment[1] <= it[1] && segment[1] <= it[0])\n\t\t\t{\n\t\t\t\treturn [segment[0], it[1]];\n\t\t\t}\n\n\t\t\t// [+++<...>+++] replace\n\t\t\tif (segment[0] < it[0] && segment[1] > it[1])\n\t\t\t{\n\t\t\t\treturn segment;\n\t\t\t}\n\n\t\t\treturn it;\n\t\t});\n\n\t\treturn this.#segments;\n\t}\n\n\tsubtract(segment: LineSegment): LineSegment[]\n\t{\n\t\tthis.#segments = this.#segments.flatMap((it: LineSegment) => {\n\t\t\t// <...[--->---] cut right\n\t\t\tif (segment[0] >= it[0] && segment[0] <= it[1] && segment[1] >= it[1])\n\t\t\t{\n\t\t\t\treturn [[it[0], segment[0]]];\n\t\t\t}\n\n\t\t\t// [---<---]...> cut left\n\t\t\tif (segment[1] >= it[0] && segment[1] <= it[1] && segment[1] <= it[0])\n\t\t\t{\n\t\t\t\treturn [[segment[1], it[1]]];\n\t\t\t}\n\n\t\t\t// <...[---]...> split into 2\n\t\t\tif (segment[0] > it[0] && segment[1] < it[1])\n\t\t\t{\n\t\t\t\treturn [\n\t\t\t\t\t[it[0], segment[0]],\n\t\t\t\t\t[segment[1], it[1]],\n\t\t\t\t];\n\t\t\t}\n\n\t\t\t// [---<--->---] remove\n\t\t\tif (segment[0] < it[0] && segment[1] > it[1])\n\t\t\t{\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\treturn [it];\n\t\t}).filter((it: LineSegment) => it !== null && (it[1] - it[0] > 0));\n\n\t\treturn this.#segments;\n\t}\n}\n"],"names":["Segments","constructor","segments","toArray","add","segment","some","it","intersects","map","subtract","flatMap","filter"],"mappings":"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"}