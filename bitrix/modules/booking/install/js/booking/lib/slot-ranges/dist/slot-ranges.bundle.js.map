{"version":3,"file":"slot-ranges.bundle.js","sources":["../src/apply-timezone.js","../src/slot-ranges.js"],"sourcesContent":["import { DateFormat } from 'booking.const';\nimport { Duration } from 'booking.lib.duration';\nimport { Timezone } from 'booking.lib.timezone';\nimport type { SlotRange } from 'booking.model.resources';\n\nexport function applyTimezone(slotRanges: SlotRange[], dateTs: number, timezone: string): SlotRange[]\n{\n\tconst minutesInDay = Duration.getUnitDurations().d / Duration.getUnitDurations().i;\n\tconst timezoneOffset = Timezone.getOffset(dateTs, timezone);\n\n\treturn slotRanges.map((slotRange: SlotRange): SlotRange => {\n\t\tconst slotTimezoneOffset = Timezone.getOffset(dateTs, slotRange.timezone);\n\t\tconst minutesOffset = (timezoneOffset - slotTimezoneOffset) / 60;\n\n\t\treturn {\n\t\t\t...slotRange,\n\t\t\tfrom: slotRange.from + minutesOffset,\n\t\t\tto: slotRange.to + minutesOffset,\n\t\t};\n\t}).map((slotRange: SlotRange) => {\n\t\tif (slotRange.from > minutesInDay)\n\t\t{\n\t\t\treturn {\n\t\t\t\t...slotRange,\n\t\t\t\tfrom: slotRange.from - minutesInDay,\n\t\t\t\tto: slotRange.to - minutesInDay,\n\t\t\t\tweekDays: slotRange.weekDays.map((weekDay) => getNextDay(weekDay)),\n\t\t\t};\n\t\t}\n\n\t\tif (slotRange.to < 0)\n\t\t{\n\t\t\treturn {\n\t\t\t\t...slotRange,\n\t\t\t\tfrom: slotRange.from + minutesInDay,\n\t\t\t\tto: slotRange.to + minutesInDay,\n\t\t\t\tweekDays: slotRange.weekDays.map((weekDay) => getPreviousDay(weekDay)),\n\t\t\t};\n\t\t}\n\n\t\treturn slotRange;\n\t}).flatMap((slotRange: SlotRange): SlotRange[] => {\n\t\tif (slotRange.from < 0)\n\t\t{\n\t\t\treturn [\n\t\t\t\t{\n\t\t\t\t\t...slotRange,\n\t\t\t\t\tfrom: 0,\n\t\t\t\t},\n\t\t\t\t...slotRange.weekDays.map((weekDay) => ({\n\t\t\t\t\t...slotRange,\n\t\t\t\t\tfrom: minutesInDay + slotRange.from,\n\t\t\t\t\tto: minutesInDay,\n\t\t\t\t\tweekDays: [getPreviousDay(weekDay)],\n\t\t\t\t})),\n\t\t\t];\n\t\t}\n\n\t\tif (slotRange.to > minutesInDay)\n\t\t{\n\t\t\treturn [\n\t\t\t\t{\n\t\t\t\t\t...slotRange,\n\t\t\t\t\tto: minutesInDay,\n\t\t\t\t},\n\t\t\t\t...slotRange.weekDays.map((weekDay) => ({\n\t\t\t\t\t...slotRange,\n\t\t\t\t\tfrom: 0,\n\t\t\t\t\tto: slotRange.to - minutesInDay,\n\t\t\t\t\tweekDays: [getNextDay(weekDay)],\n\t\t\t\t})),\n\t\t\t];\n\t\t}\n\n\t\treturn slotRange;\n\t});\n}\n\nfunction getNextDay(weekDay: string): string\n{\n\treturn DateFormat.WeekDays[(DateFormat.WeekDays.indexOf(weekDay) + 1) % 7];\n}\n\nfunction getPreviousDay(weekDay: string): string\n{\n\treturn DateFormat.WeekDays[(DateFormat.WeekDays.indexOf(weekDay) + 7 - 1) % 7];\n}\n","import { applyTimezone } from './apply-timezone';\n\nexport const SlotRanges = {\n\tapplyTimezone,\n};\n"],"names":["applyTimezone","slotRanges","dateTs","timezone","minutesInDay","Duration","getUnitDurations","d","i","timezoneOffset","Timezone","getOffset","map","slotRange","slotTimezoneOffset","minutesOffset","from","to","weekDays","weekDay","getNextDay","getPreviousDay","flatMap","DateFormat","WeekDays","indexOf","SlotRanges"],"mappings":";;;;;;CAKO,SAASA,aAAa,CAACC,UAAuB,EAAEC,MAAc,EAAEC,QAAgB,EACvF;GACC,MAAMC,YAAY,GAAGC,6BAAQ,CAACC,gBAAgB,EAAE,CAACC,CAAC,GAAGF,6BAAQ,CAACC,gBAAgB,EAAE,CAACE,CAAC;GAClF,MAAMC,cAAc,GAAGC,6BAAQ,CAACC,SAAS,CAACT,MAAM,EAAEC,QAAQ,CAAC;GAE3D,OAAOF,UAAU,CAACW,GAAG,CAAEC,SAAoB,IAAgB;KAC1D,MAAMC,kBAAkB,GAAGJ,6BAAQ,CAACC,SAAS,CAACT,MAAM,EAAEW,SAAS,CAACV,QAAQ,CAAC;KACzE,MAAMY,aAAa,GAAG,CAACN,cAAc,GAAGK,kBAAkB,IAAI,EAAE;KAEhE,OAAO;OACN,GAAGD,SAAS;OACZG,IAAI,EAAEH,SAAS,CAACG,IAAI,GAAGD,aAAa;OACpCE,EAAE,EAAEJ,SAAS,CAACI,EAAE,GAAGF;MACnB;IACD,CAAC,CAACH,GAAG,CAAEC,SAAoB,IAAK;KAChC,IAAIA,SAAS,CAACG,IAAI,GAAGZ,YAAY,EACjC;OACC,OAAO;SACN,GAAGS,SAAS;SACZG,IAAI,EAAEH,SAAS,CAACG,IAAI,GAAGZ,YAAY;SACnCa,EAAE,EAAEJ,SAAS,CAACI,EAAE,GAAGb,YAAY;SAC/Bc,QAAQ,EAAEL,SAAS,CAACK,QAAQ,CAACN,GAAG,CAAEO,OAAO,IAAKC,UAAU,CAACD,OAAO,CAAC;QACjE;;KAGF,IAAIN,SAAS,CAACI,EAAE,GAAG,CAAC,EACpB;OACC,OAAO;SACN,GAAGJ,SAAS;SACZG,IAAI,EAAEH,SAAS,CAACG,IAAI,GAAGZ,YAAY;SACnCa,EAAE,EAAEJ,SAAS,CAACI,EAAE,GAAGb,YAAY;SAC/Bc,QAAQ,EAAEL,SAAS,CAACK,QAAQ,CAACN,GAAG,CAAEO,OAAO,IAAKE,cAAc,CAACF,OAAO,CAAC;QACrE;;KAGF,OAAON,SAAS;IAChB,CAAC,CAACS,OAAO,CAAET,SAAoB,IAAkB;KACjD,IAAIA,SAAS,CAACG,IAAI,GAAG,CAAC,EACtB;OACC,OAAO,CACN;SACC,GAAGH,SAAS;SACZG,IAAI,EAAE;QACN,EACD,GAAGH,SAAS,CAACK,QAAQ,CAACN,GAAG,CAAEO,OAAO,KAAM;SACvC,GAAGN,SAAS;SACZG,IAAI,EAAEZ,YAAY,GAAGS,SAAS,CAACG,IAAI;SACnCC,EAAE,EAAEb,YAAY;SAChBc,QAAQ,EAAE,CAACG,cAAc,CAACF,OAAO,CAAC;QAClC,CAAC,CAAC,CACH;;KAGF,IAAIN,SAAS,CAACI,EAAE,GAAGb,YAAY,EAC/B;OACC,OAAO,CACN;SACC,GAAGS,SAAS;SACZI,EAAE,EAAEb;QACJ,EACD,GAAGS,SAAS,CAACK,QAAQ,CAACN,GAAG,CAAEO,OAAO,KAAM;SACvC,GAAGN,SAAS;SACZG,IAAI,EAAE,CAAC;SACPC,EAAE,EAAEJ,SAAS,CAACI,EAAE,GAAGb,YAAY;SAC/Bc,QAAQ,EAAE,CAACE,UAAU,CAACD,OAAO,CAAC;QAC9B,CAAC,CAAC,CACH;;KAGF,OAAON,SAAS;IAChB,CAAC;CACH;CAEA,SAASO,UAAU,CAACD,OAAe,EACnC;GACC,OAAOI,wBAAU,CAACC,QAAQ,CAAC,CAACD,wBAAU,CAACC,QAAQ,CAACC,OAAO,CAACN,OAAO,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC;CAC3E;CAEA,SAASE,cAAc,CAACF,OAAe,EACvC;GACC,OAAOI,wBAAU,CAACC,QAAQ,CAAC,CAACD,wBAAU,CAACC,QAAQ,CAACC,OAAO,CAACN,OAAO,CAAC,GAAG,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC;CAC/E;;OCpFaO,UAAU,GAAG;GACzB1B;CACD,CAAC;;;;;;;;"}