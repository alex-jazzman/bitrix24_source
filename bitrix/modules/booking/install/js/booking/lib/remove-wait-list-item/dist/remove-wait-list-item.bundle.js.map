{"version":3,"file":"remove-wait-list-item.bundle.js","sources":["../src/remove-wait-list-item.js"],"sourcesContent":["import { Loc } from 'main.core';\nimport 'ui.notification';\n\nimport { Model } from 'booking.const';\nimport { Core } from 'booking.core';\nimport { waitListService } from 'booking.provider.service.wait-list-service';\n\nconst secondsToDelete = 5;\n\nexport class RemoveWaitListItem\n{\n\t#balloon: BX.UI.Notification.Balloon;\n\t#waitListItemId: number;\n\t#secondsLeft: number;\n\t#cancelingTheDeletion: boolean;\n\t#interval: number;\n\n\tconstructor(waitListItemId: number)\n\t{\n\t\tthis.#waitListItemId = waitListItemId;\n\t\tthis.#removeWaitListItem();\n\t}\n\n\t#removeWaitListItem(): void\n\t{\n\t\tthis.#secondsLeft = secondsToDelete;\n\n\t\tthis.#balloon = BX.UI.Notification.Center.notify({\n\t\t\tid: `booking-notify-remove-waitlist-item-${this.#waitListItemId}`,\n\t\t\tcontent: this.#getBalloonTitle(),\n\t\t\tactions: [\n\t\t\t\t{\n\t\t\t\t\ttitle: Loc.getMessage('BB_BOOKING_REMOVE_BALLOON_CANCEL'),\n\t\t\t\t\tevents: {\n\t\t\t\t\t\tmouseup: this.#cancelDeletion,\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t],\n\t\t\tevents: {\n\t\t\t\tonClose: this.#onBalloonClose,\n\t\t\t},\n\t\t});\n\n\t\tthis.#startDeletion();\n\t}\n\n\t#startDeletion(): void\n\t{\n\t\tthis.#interval = setInterval(() => {\n\t\t\tthis.#secondsLeft--;\n\n\t\t\tthis.#balloon.update({ content: this.#getBalloonTitle() });\n\n\t\t\tif (this.#secondsLeft <= 0)\n\t\t\t{\n\t\t\t\tthis.#balloon.close();\n\t\t\t}\n\t\t}, 1000);\n\n\t\tvoid Core.getStore().dispatch(`${Model.Interface}/addDeletingWaitListItemId`, this.#waitListItemId);\n\t}\n\n\t#getBalloonTitle(): string\n\t{\n\t\treturn Loc.getMessage('BB_BOOKING_REMOVE_BALLOON_TEXT', {\n\t\t\t'#countdown#': this.#secondsLeft,\n\t\t});\n\t}\n\n\t#cancelDeletion = (): void => {\n\t\tthis.#cancelingTheDeletion = true;\n\t\tthis.#balloon.close();\n\n\t\tvoid Core.getStore().dispatch(`${Model.Interface}/removeDeletingWaitListItemId`, this.#waitListItemId);\n\t};\n\n\t#onBalloonClose = (): void => {\n\t\tclearInterval(this.#interval);\n\n\t\tif (this.#cancelingTheDeletion)\n\t\t{\n\t\t\tthis.#cancelingTheDeletion = false;\n\n\t\t\treturn;\n\t\t}\n\n\t\tvoid waitListService.delete(this.#waitListItemId);\n\t};\n}\n"],"names":["secondsToDelete","RemoveWaitListItem","constructor","waitListItemId","close","Core","getStore","dispatch","Model","Interface","clearInterval","waitListService","delete","BX","UI","Notification","Center","notify","id","content","actions","title","Loc","getMessage","events","mouseup","onClose","setInterval","update"],"mappings":";;;;;;CAOA,MAAMA,eAAe,GAAG,CAAC;CAAC;CAAA;CAAA;CAAA;CAAA;CAAA;CAAA;CAAA;CAAA;CAAA;AAE1B,CAAO,MAAMC,kBAAkB,CAC/B;GAOCC,WAAW,CAACC,cAAsB,EAClC;KAAA;OAAA;;KAAA;OAAA;;KAAA;OAAA;;KAAA;OAAA;OAAA;;KAAA;OAAA;OAAA;;KAAA;OAAA;OAAA;;KAAA;OAAA;OAAA;;KAAA;OAAA;OAAA;;KAAA;OAAA;OAAA,OAmDkB,MAAY;SAC7B,4CAAI,kDAAyB,IAAI;SACjC,4CAAI,sBAAUC,KAAK,EAAE;SAErB,KAAKC,iBAAI,CAACC,QAAQ,EAAE,CAACC,QAAQ,CAAE,GAAEC,mBAAK,CAACC,SAAU,+BAA8B,0CAAE,IAAI,oCAAiB;;;KACtG;OAAA;OAAA,OAEiB,MAAY;SAC7BC,aAAa,yCAAC,IAAI,wBAAW;SAE7B,4CAAI,IAAI,iDACR;WACC,4CAAI,kDAAyB,KAAK;WAElC;;SAGD,KAAKC,wDAAe,CAACC,MAAM,yCAAC,IAAI,oCAAiB;;;KAnEjD,4CAAI,sCAAmBT,cAAc;KACrC,4CAAI;;CAoEN;CAAC,gCAhEA;GACC,4CAAI,gCAAgBH,eAAe;GAEnC,4CAAI,wBAAYa,EAAE,CAACC,EAAE,CAACC,YAAY,CAACC,MAAM,CAACC,MAAM,CAAC;KAChDC,EAAE,EAAG,uCAAoC,wCAAE,IAAI,mCAAiB,EAAC;KACjEC,OAAO,0CAAE,IAAI,uCAAmB;KAChCC,OAAO,EAAE,CACR;OACCC,KAAK,EAAEC,aAAG,CAACC,UAAU,CAAC,kCAAkC,CAAC;OACzDC,MAAM,EAAE;SACPC,OAAO,0CAAE,IAAI;;MAEd,CACD;KACDD,MAAM,EAAE;OACPE,OAAO,0CAAE,IAAI;;IAEd,CAAC;GAEF,4CAAI;CACL;CAAC,2BAGD;GACC,4CAAI,0BAAaC,WAAW,CAAC,MAAM;KAClC,4CAAI,+BAAe;KAEnB,4CAAI,sBAAUC,MAAM,CAAC;OAAET,OAAO,0CAAE,IAAI;MAAqB,CAAC;KAE1D,IAAI,4CAAI,iCAAiB,CAAC,EAC1B;OACC,4CAAI,sBAAUf,KAAK,EAAE;;IAEtB,EAAE,IAAI,CAAC;GAER,KAAKC,iBAAI,CAACC,QAAQ,EAAE,CAACC,QAAQ,CAAE,GAAEC,mBAAK,CAACC,SAAU,4BAA2B,0CAAE,IAAI,oCAAiB;CACpG;CAAC,6BAGD;GACC,OAAOa,aAAG,CAACC,UAAU,CAAC,gCAAgC,EAAE;KACvD,aAAa,0CAAE,IAAI;IACnB,CAAC;CACH;;;;;;;;"}