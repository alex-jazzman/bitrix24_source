{"version":3,"file":"booking-service.bundle.js","sources":["../src/mappers.js","../src/booking-data-extractor.js","../src/booking-service.js","../src/index.js"],"sourcesContent":["import { Type } from 'main.core';\nimport type { BookingModel } from 'booking.model.bookings';\nimport type { BookingDto, BookingFromWaitListItemDto } from './types';\n\nexport function mapModelToDto(booking: BookingModel): BookingDto\n{\n\tconst mappings = {\n\t\tid: () => Number(booking.id) || 0,\n\t\tresources: () => booking.resourcesIds.map((id) => ({ id })),\n\t\tprimaryClient: () => booking.clients?.[0],\n\t\tclients: () => booking.clients,\n\t\tname: () => booking.name,\n\t\tdatePeriod: () => ({\n\t\t\tfrom: {\n\t\t\t\ttimestamp: booking.dateFromTs / 1000,\n\t\t\t\ttimezone: booking.timezoneFrom,\n\t\t\t},\n\t\t\tto: {\n\t\t\t\ttimestamp: booking.dateToTs / 1000,\n\t\t\t\ttimezone: booking.timezoneTo,\n\t\t\t},\n\t\t}),\n\t\tisConfirmed: () => booking.isConfirmed,\n\t\trrule: () => booking.rrule,\n\t\tnote: () => booking.note,\n\t\tvisitStatus: () => booking.visitStatus,\n\t\texternalData: () => booking.externalData,\n\t};\n\n\tconst dependentFields = new Map([\n\t\t['resources', ['resourcesIds']],\n\t\t['datePeriod', ['dateFromTs', 'dateToTs']],\n\t]);\n\n\treturn Object.keys(mappings).reduce((result, field) => {\n\t\tconst dependencies = dependentFields.get(field);\n\t\tconst hasDependencies = dependencies ? dependencies.every((dep) => dep in booking) : true;\n\n\t\tif (hasDependencies && (field in booking || dependencies))\n\t\t{\n\t\t\tconst value = mappings[field]();\n\t\t\tif (value !== undefined)\n\t\t\t{\n\t\t\t\t// eslint-disable-next-line no-param-reassign\n\t\t\t\tresult[field] = value;\n\t\t\t}\n\t\t}\n\n\t\treturn result;\n\t}, {});\n}\n\nexport function mapDtoToModel(bookingDto: BookingDto): BookingModel\n{\n\tconst clients = bookingDto.clients.filter((client) => Type.isArrayFilled(Object.values(client.data)));\n\tconst booking = {\n\t\tid: bookingDto.id,\n\t\tupdatedAt: bookingDto.updatedAt,\n\t\tresourcesIds: getSortedResourcesByPrimary(bookingDto),\n\t\tprimaryClient: clients?.[0],\n\t\tclients,\n\t\tcounter: bookingDto.counter,\n\t\tcounters: bookingDto.counters,\n\t\tcreatedAt: bookingDto.createdAt,\n\t\tname: bookingDto.name,\n\t\tdateFromTs: bookingDto.datePeriod.from.timestamp * 1000,\n\t\ttimezoneFrom: bookingDto.datePeriod.from.timezone,\n\t\tdateToTs: bookingDto.datePeriod.to.timestamp * 1000,\n\t\ttimezoneTo: bookingDto.datePeriod.to.timezone,\n\t\tisConfirmed: bookingDto.isConfirmed,\n\t\trrule: bookingDto.rrule,\n\t\tnote: bookingDto.note,\n\t\tvisitStatus: bookingDto.visitStatus,\n\t\texternalData: bookingDto.externalData,\n\t\tmessages: bookingDto.messages?.length ? bookingDto.messages : undefined,\n\t};\n\n\treturn Object.fromEntries(Object.entries(booking).filter(([, value]) => !Type.isUndefined(value)));\n}\n\nfunction getSortedResourcesByPrimary({ resources }: BookingDto): number[]\n{\n\treturn [\n\t\tresources.find((resource) => resource.isPrimary),\n\t\t...resources.filter((resource) => !resource.isPrimary),\n\t].map(({ id }) => id);\n}\n\nexport function mapModelToCreateFromWaitListItemDto(\n\twaitListItemId: number,\n\tbooking: BookingModel,\n): BookingFromWaitListItemDto\n{\n\treturn {\n\t\twaitListItemId,\n\t\tresources: booking.resourcesIds.map((id) => ({ id })),\n\t\tdatePeriod: {\n\t\t\tfrom: {\n\t\t\t\ttimestamp: booking.dateFromTs / 1000,\n\t\t\t\ttimezone: booking.timezoneFrom,\n\t\t\t},\n\t\t\tto: {\n\t\t\t\ttimestamp: booking.dateToTs / 1000,\n\t\t\t\ttimezone: booking.timezoneTo,\n\t\t\t},\n\t\t},\n\t};\n}\n","import { ClientMappers } from 'booking.provider.service.client-service';\nimport { ResourceMappers } from 'booking.provider.service.resources-service';\nimport type { BookingModel } from 'booking.model.bookings';\nimport type { ClientModel } from 'booking.model.clients';\nimport type { ClientDto } from 'booking.provider.service.client-service';\nimport type { ResourceModel } from 'booking.model.resources';\nimport type { ResourceDto } from 'booking.provider.service.resources-service';\n\nimport { mapDtoToModel } from './mappers';\nimport type { BookingDto } from './types';\n\nexport class BookingDataExtractor\n{\n\t#response: BookingDto[];\n\n\tconstructor(response: BookingDto[])\n\t{\n\t\tthis.#response = response;\n\t}\n\n\tgetBookings(): BookingModel[]\n\t{\n\t\treturn this.#response.map((bookingDto: BookingDto): BookingModel => mapDtoToModel(bookingDto));\n\t}\n\n\tgetBookingsIds(): number[]\n\t{\n\t\treturn this.#response.map(({ id }) => id);\n\t}\n\n\tgetClients(): ClientModel[]\n\t{\n\t\treturn this.#response\n\t\t\t.flatMap(({ clients }) => clients)\n\t\t\t.map((clientDto: ClientDto): ClientModel => {\n\t\t\t\treturn ClientMappers.mapDtoToModel(clientDto);\n\t\t\t})\n\t\t;\n\t}\n\n\tgetResources(): ResourceModel[]\n\t{\n\t\treturn this.#response\n\t\t\t.flatMap(({ resources }) => resources)\n\t\t\t.map((resourceDto: ResourceDto): ResourceModel => {\n\t\t\t\treturn ResourceMappers.mapDtoToModel(resourceDto);\n\t\t\t})\n\t\t;\n\t}\n}\n","import { Event } from 'main.core';\n\nimport { Core } from 'booking.core';\nimport { EventName, Model } from 'booking.const';\nimport { ApiClient } from 'booking.lib.api-client';\nimport { bookingFilter } from 'booking.lib.booking-filter';\nimport { deepToRaw } from 'booking.lib.deep-to-raw';\nimport { mainPageService } from 'booking.provider.service.main-page-service';\nimport type { BookingModel } from 'booking.model.bookings';\nimport type { BookingUIFilter, BookingListFilter } from 'booking.lib.booking-filter';\n\nimport { BookingDataExtractor } from './booking-data-extractor';\nimport { mapModelToDto, mapDtoToModel, mapModelToCreateFromWaitListItemDto } from './mappers';\nimport type { BookingDto } from './types';\n\nclass BookingService\n{\n\t#filterRequests: { [key: string]: Promise } = {};\n\t#lastFilterRequest: Promise;\n\n\tasync add(booking: BookingModel): Promise<{ success: boolean, booking: ?BookingModel }>\n\t{\n\t\tconst id = booking.id;\n\t\tconst $store = Core.getStore();\n\n\t\ttry\n\t\t{\n\t\t\tawait $store.dispatch(`${Model.Interface}/addCreatedFromEmbedBooking`, id);\n\t\t\tawait $store.dispatch(`${Model.Filter}/addQuickFilterIgnoredBookingId`, id);\n\t\t\tawait $store.dispatch(`${Model.Bookings}/add`, booking);\n\n\t\t\tconst bookingDto = mapModelToDto(booking);\n\t\t\tconst data = await (new ApiClient()).post('Booking.add', { booking: bookingDto });\n\t\t\tconst createdBooking = mapDtoToModel(data);\n\n\t\t\tconst clients = new BookingDataExtractor([data]).getClients();\n\t\t\tvoid $store.dispatch(`${Model.Clients}/upsertMany`, clients);\n\n\t\t\tawait $store.dispatch(`${Model.Interface}/setAnimationPause`, true);\n\t\t\tawait $store.dispatch(`${Model.Interface}/addCreatedFromEmbedBooking`, createdBooking.id);\n\t\t\tawait $store.dispatch(`${Model.Filter}/addQuickFilterIgnoredBookingId`, createdBooking.id);\n\t\t\tawait $store.dispatch(`${Model.Bookings}/update`, {\n\t\t\t\tid,\n\t\t\t\tbooking: createdBooking,\n\t\t\t});\n\n\t\t\tEvent.EventEmitter.emit(EventName.CreateBookings, {\n\t\t\t\tbookings: [createdBooking],\n\t\t\t});\n\n\t\t\tvoid mainPageService.fetchCounters();\n\n\t\t\treturn {\n\t\t\t\tsuccess: true,\n\t\t\t\tbooking: createdBooking,\n\t\t\t};\n\t\t}\n\t\tcatch (error)\n\t\t{\n\t\t\tvoid $store.dispatch(`${Model.Bookings}/delete`, id);\n\n\t\t\tconsole.error('BookingService: add error', error);\n\n\t\t\treturn { success: false };\n\t\t}\n\t\tfinally\n\t\t{\n\t\t\tawait $store.dispatch(`${Model.Interface}/setAnimationPause`, false);\n\t\t}\n\t}\n\n\tasync addList(bookings: BookingModel[]): Promise<void>\n\t{\n\t\tconst $store = Core.getStore();\n\n\t\ttry\n\t\t{\n\t\t\tawait $store.dispatch(`${Model.Interface}/addCreatedFromEmbedBooking`, bookings.map(({ id }) => id));\n\t\t\tconst bookingList = bookings.map((booking) => mapModelToDto(booking));\n\n\t\t\tconst api = new ApiClient();\n\t\t\tconst data = await api.post('Booking.addList', { bookingList });\n\t\t\tconst createdBookings = data.map((d) => mapDtoToModel(d));\n\n\t\t\tawait Promise.all([\n\t\t\t\t$store.dispatch(`${Model.Interface}/addCreatedFromEmbedBooking`, createdBookings.map(({ id }) => id)),\n\t\t\t\t$store.dispatch(`${Model.Bookings}/upsertMany`, createdBookings),\n\t\t\t]);\n\n\t\t\tEvent.EventEmitter.emit(EventName.CreateBookings, {\n\t\t\t\tbookings: createdBookings,\n\t\t\t});\n\n\t\t\tvoid mainPageService.fetchCounters();\n\n\t\t\treturn createdBookings;\n\t\t}\n\t\tcatch (error)\n\t\t{\n\t\t\tconsole.error('BookingService: add list error', error);\n\n\t\t\treturn [];\n\t\t}\n\t}\n\n\tasync update(booking: BookingModel): Promise<void>\n\t{\n\t\tconst id = booking.id;\n\t\tconst bookingBeforeUpdate = { ...Core.getStore().getters[`${Model.Bookings}/getById`](id) };\n\n\t\ttry\n\t\t{\n\t\t\tif (booking.clients)\n\t\t\t{\n\t\t\t\t// eslint-disable-next-line no-param-reassign\n\t\t\t\tbooking.primaryClient ??= booking.clients[0];\n\t\t\t}\n\n\t\t\tawait Core.getStore().dispatch(`${Model.Bookings}/update`, { id, booking });\n\n\t\t\tconst bookingDto = mapModelToDto(booking);\n\t\t\tconst data = await (new ApiClient()).post('Booking.update', { booking: bookingDto });\n\t\t\tconst updatedBooking = mapDtoToModel(data);\n\n\t\t\tvoid Core.getStore().dispatch(`${Model.Bookings}/update`, {\n\t\t\t\tid,\n\t\t\t\tbooking: updatedBooking,\n\t\t\t});\n\n\t\t\tconst clients = new BookingDataExtractor([data]).getClients();\n\n\t\t\tvoid Core.getStore().dispatch(`${Model.Clients}/upsertMany`, clients);\n\n\t\t\tEvent.EventEmitter.emit(EventName.UpdateBooking, {\n\t\t\t\toldBooking: deepToRaw(bookingBeforeUpdate),\n\t\t\t\tnewBooking: deepToRaw(updatedBooking),\n\t\t\t});\n\n\t\t\tvoid mainPageService.fetchCounters();\n\t\t}\n\t\tcatch (error)\n\t\t{\n\t\t\tvoid Core.getStore().dispatch(`${Model.Bookings}/update`, {\n\t\t\t\tid,\n\t\t\t\tbooking: bookingBeforeUpdate,\n\t\t\t});\n\n\t\t\tconsole.error('BookingService: update error', error);\n\t\t}\n\t}\n\n\tasync delete(id: number): Promise<void>\n\t{\n\t\tconst bookingBeforeDelete = { ...Core.getStore().getters[`${Model.Bookings}/getById`](id) };\n\n\t\ttry\n\t\t{\n\t\t\tvoid Core.getStore().dispatch(`${Model.Bookings}/delete`, id);\n\n\t\t\tawait (new ApiClient()).post('Booking.delete', { id });\n\n\t\t\tEvent.EventEmitter.emit(EventName.DeleteBooking, {\n\t\t\t\tbooking: deepToRaw(bookingBeforeDelete),\n\t\t\t});\n\n\t\t\tawait this.#onAfterDelete(id);\n\t\t}\n\t\tcatch (error)\n\t\t{\n\t\t\tvoid Core.getStore().dispatch(`${Model.Bookings}/upsert`, bookingBeforeDelete);\n\n\t\t\tconsole.error('BookingService: delete error', error);\n\t\t}\n\t}\n\n\tasync deleteList(ids: number[]): Promise<void>\n\t{\n\t\ttry\n\t\t{\n\t\t\tvoid Core.getStore().dispatch(`${Model.Bookings}/deleteMany`, ids);\n\n\t\t\tawait (new ApiClient()).post('Booking.deleteList', { ids });\n\n\t\t\tawait Promise.all(ids.map((id: number) => this.#onAfterDelete(id)));\n\t\t}\n\t\tcatch (error)\n\t\t{\n\t\t\tconsole.error('BookingService: delete list error', error);\n\t\t}\n\t}\n\n\tasync createFromWaitListItem(waitListItemId: number, booking: BookingModel): Promise<{\n\t\tsuccess: boolean,\n\t\tbooking?: BookingModel\n\t}>\n\t{\n\t\tconst $store = Core.getStore();\n\t\tconst id = booking.id;\n\t\tconst waitListItem = { ...$store.getters[`${Model.WaitList}/getById`](waitListItemId) };\n\n\t\ttry\n\t\t{\n\t\t\tif ($store.getters[`${Model.Interface}/isWaitListItemCreatedFromEmbed`](waitListItemId))\n\t\t\t{\n\t\t\t\tawait $store.dispatch(`${Model.Interface}/addCreatedFromEmbedBooking`, id);\n\t\t\t}\n\n\t\t\tawait $store.dispatch(`${Model.WaitList}/delete`, waitListItemId);\n\t\t\tawait $store.dispatch(`${Model.Bookings}/add`, booking);\n\n\t\t\tconst createFromWaitListItemDto = mapModelToCreateFromWaitListItemDto(\n\t\t\t\twaitListItemId,\n\t\t\t\tbooking,\n\t\t\t);\n\t\t\tconst data = await (new ApiClient()).post('Booking.createFromWaitListItem', createFromWaitListItemDto);\n\t\t\tconst createdBooking = mapDtoToModel(data);\n\n\t\t\tawait $store.dispatch(`${Model.Interface}/setAnimationPause`, true);\n\t\t\tconst clients = new BookingDataExtractor([data]).getClients();\n\t\t\tawait Promise.all([\n\t\t\t\t$store.dispatch(`${Model.Clients}/upsertMany`, clients),\n\t\t\t\t$store.dispatch(`${Model.Filter}/addQuickFilterIgnoredBookingId`, createdBooking.id),\n\t\t\t\t$store.dispatch(`${Model.Bookings}/update`, {\n\t\t\t\t\tid,\n\t\t\t\t\tbooking: createdBooking,\n\t\t\t\t}),\n\t\t\t\t$store.dispatch(`${Model.Interface}/addCreatedFromEmbedBooking`, createdBooking.id),\n\t\t\t]);\n\n\t\t\tEvent.EventEmitter.emit(EventName.CreateBookings, {\n\t\t\t\tbookings: [createdBooking],\n\t\t\t});\n\n\t\t\tvoid mainPageService.fetchCounters();\n\n\t\t\treturn {\n\t\t\t\tsuccess: true,\n\t\t\t\tbooking: createdBooking,\n\t\t\t};\n\t\t}\n\t\tcatch (error)\n\t\t{\n\t\t\tawait $store.dispatch(`${Model.Bookings}/delete`, id);\n\t\t\tawait $store.dispatch(`${Model.WaitList}/upsert`, waitListItem);\n\n\t\t\tconsole.error('BookingService: add from wait list item error', error);\n\n\t\t\treturn {\n\t\t\t\tsuccess: false,\n\t\t\t};\n\t\t}\n\t\tfinally\n\t\t{\n\t\t\tawait $store.dispatch(`${Model.Interface}/setAnimationPause`, false);\n\t\t}\n\t}\n\n\tasync #onAfterDelete(id: number): Promise<void>\n\t{\n\t\tconst editingBookingId = Core.getStore().getters[`${Model.Interface}/editingBookingId`];\n\t\tif (id === editingBookingId)\n\t\t{\n\t\t\tawait Core.getStore().dispatch(`${Model.Interface}/setEditingBookingId`, 0);\n\n\t\t\tconst selectedDateTs = Core.getStore().getters[`${Model.Interface}/selectedDateTs`];\n\n\t\t\tawait mainPageService.loadData(selectedDateTs / 1000);\n\n\t\t\tconst resourcesIds = Core.getStore().getters[`${Model.Interface}/resourcesIds`];\n\n\t\t\tmainPageService.clearCache(resourcesIds);\n\t\t}\n\n\t\tvoid Core.getStore().dispatch(`${Model.Interface}/addDeletingBooking`, id);\n\t}\n\n\tclearFilterCache(): void\n\t{\n\t\tthis.#filterRequests = {};\n\t}\n\n\tasync filter(fields: BookingUIFilter): Promise<void>\n\t{\n\t\ttry\n\t\t{\n\t\t\tconst filter = bookingFilter.prepareFilter(fields);\n\n\t\t\tconst key = JSON.stringify(filter);\n\t\t\tthis.#filterRequests[key] ??= this.#requestFilter(filter);\n\t\t\tthis.#lastFilterRequest = this.#filterRequests[key];\n\n\t\t\tconst data: BookingDto[] = await this.#filterRequests[key];\n\n\t\t\tvoid this.#extractFilterData({ data, key });\n\t\t}\n\t\tcatch (error)\n\t\t{\n\t\t\tconsole.error('BookingService: filter error', error);\n\t\t}\n\t}\n\n\tasync getById(id: number): Promise<void>\n\t{\n\t\ttry\n\t\t{\n\t\t\tconst data: BookingDto[] = await this.#requestFilter({ ID: [id] });\n\t\t\tconst extractor = new BookingDataExtractor(data);\n\t\t\tawait Promise.all([\n\t\t\t\tCore.getStore().dispatch(`${Model.Resources}/upsertMany`, extractor.getResources()),\n\t\t\t\tCore.getStore().dispatch(`${Model.Bookings}/upsertMany`, extractor.getBookings()),\n\t\t\t\tCore.getStore().dispatch(`${Model.Clients}/upsertMany`, extractor.getClients()),\n\t\t\t]);\n\t\t}\n\t\tcatch (error)\n\t\t{\n\t\t\tconsole.error('BookingService: getById error', error);\n\t\t}\n\t}\n\n\tasync #extractFilterData({ data, key }: { data: BookingDto[], key: string, date: Date }): Promise<void>\n\t{\n\t\tconst extractor = new BookingDataExtractor(data);\n\n\t\tawait Promise.all([\n\t\t\tCore.getStore().dispatch(`${Model.Resources}/insertMany`, extractor.getResources()),\n\t\t\tCore.getStore().dispatch(`${Model.Bookings}/insertMany`, extractor.getBookings()),\n\t\t\tCore.getStore().dispatch(`${Model.Clients}/insertMany`, extractor.getClients()),\n\t\t]);\n\n\t\tif (this.#filterRequests[key] !== this.#lastFilterRequest)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tvoid Core.getStore().dispatch(`${Model.Filter}/setFilteredBookingsIds`, extractor.getBookingsIds());\n\t}\n\n\tasync #requestFilter(filter: BookingListFilter): Promise<BookingDto[]>\n\t{\n\t\treturn new ApiClient().post('Booking.list', {\n\t\t\tfilter,\n\t\t\tselect: [\n\t\t\t\t'RESOURCES',\n\t\t\t\t'CLIENTS',\n\t\t\t\t'EXTERNAL_DATA',\n\t\t\t\t'NOTE',\n\t\t\t],\n\t\t\twithCounters: true,\n\t\t\twithClientData: true,\n\t\t\twithExternalData: true,\n\t\t});\n\t}\n}\n\nexport const bookingService = new BookingService();\n","import { mapModelToDto, mapDtoToModel } from './mappers';\n\nexport { bookingService } from './booking-service';\nexport const BookingMappers = { mapModelToDto, mapDtoToModel };\nexport type { BookingDto, DealDataDto } from './types';\n"],"names":["mapModelToDto","booking","mappings","id","Number","resources","resourcesIds","map","primaryClient","clients","name","datePeriod","from","timestamp","dateFromTs","timezone","timezoneFrom","to","dateToTs","timezoneTo","isConfirmed","rrule","note","visitStatus","externalData","dependentFields","Map","Object","keys","reduce","result","field","dependencies","get","hasDependencies","every","dep","value","undefined","mapDtoToModel","bookingDto","filter","client","Type","isArrayFilled","values","data","updatedAt","getSortedResourcesByPrimary","counter","counters","createdAt","messages","length","fromEntries","entries","isUndefined","find","resource","isPrimary","mapModelToCreateFromWaitListItemDto","waitListItemId","BookingDataExtractor","constructor","response","getBookings","getBookingsIds","getClients","flatMap","clientDto","ClientMappers","getResources","resourceDto","ResourceMappers","BookingService","add","$store","Core","getStore","dispatch","Model","Interface","Filter","Bookings","ApiClient","post","createdBooking","Clients","Event","EventEmitter","emit","EventName","CreateBookings","bookings","mainPageService","fetchCounters","success","error","console","addList","bookingList","api","createdBookings","d","Promise","all","update","bookingBeforeUpdate","getters","updatedBooking","UpdateBooking","oldBooking","deepToRaw","newBooking","delete","bookingBeforeDelete","DeleteBooking","deleteList","ids","createFromWaitListItem","waitListItem","WaitList","createFromWaitListItemDto","clearFilterCache","fields","bookingFilter","prepareFilter","key","JSON","stringify","getById","ID","extractor","Resources","editingBookingId","selectedDateTs","loadData","clearCache","select","withCounters","withClientData","withExternalData","bookingService","BookingMappers"],"mappings":"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"}