this.BX=this.BX||{};(function(t,e,i,o,n,s,r,a,c,l,d,u,p,m,h,f,v,R,T,g,y,_,S,C,b,w,E,I,N,B,k,L,A,D,M,O,z,$,W,x,P,F){"use strict";const H={name:"UiLoader",props:{show:Boolean},data(){return{loader:new r.Loader}},mounted(){void this.loader.show(this.$refs.loader)},template:`\n\t\t<div ref="loader"></div>\n\t`};const G={name:"ResourceCreationWizardLayout",props:{step:{type:Number,required:true},title:{type:String,default:""},loading:Boolean},watch:{step(){var t;(t=this.$refs.wrapper)==null?void 0:t.scrollTo(0,0)}},components:{UiLoader:H},template:`\n\t\t<div class="resource-creation-wizard-layout">\n\t\t\t<div ref="wrapper" class="resource-creation-wizard__wrapper">\n\t\t\t\t<div class="resource-creation-wizard__header">\n\t\t\t\t\t<slot name="header">\n\t\t\t\t\t\t<h4 class="resource-creation-wizard__header-title">\n\t\t\t\t\t\t\t{{ title }}\n\t\t\t\t\t\t</h4>\n\t\t\t\t\t</slot>\n\t\t\t\t</div>\n\t\t\t\t<div v-show="!loading" class="resource-creation-wizard__content">\n\t\t\t\t\t<slot/>\n\t\t\t\t</div>\n\t\t\t\t<UiLoader v-if="loading"/>\n\t\t\t</div>\n\t\t\t<slot name="footer"/>\n\t\t</div>\n\t`};const U={name:"ResourceCreationWizardHeader",computed:{title(){return this.$store.state["resource-creation-wizard"].resourceName}},template:`\n\t\t<span class="resource-creation-wizard__header-title">\n\t\t\t{{ title }}\n\t\t</span>\n\t`};const V={name:"NextButton",components:{UiButton:D.Button},props:{step:{type:Number,required:true},steps:{type:Array,required:true},disabled:Boolean,waiting:Boolean},computed:{currentStep(){return this.steps[this.step-1]},size(){return D.ButtonSize.SMALL},color(){return D.ButtonColor.SUCCESS}},template:`\n\t\t<UiButton\n\t\t\t:text="currentStep.labelNext"\n\t\t\t:title="currentStep.labelNext"\n\t\t\t:size\n\t\t\t:color\n\t\t\t:disabled\n\t\t\t:waiting\n\t\t\t@click="currentStep.next()"\n\t\t/>\n\t`};const q={name:"BackButton",props:{step:{type:Number,required:true},steps:{type:Array,required:true}},computed:{buttonSize(){return D.ButtonSize.SMALL},buttonColor(){return D.ButtonColor.LINK},currentStep(){return this.steps[this.step-1]}},components:{UiButton:D.Button},template:`\n\t\t<UiButton\n\t\t\tclass="resource-creation-wizard__back-button"\n\t\t\t:text="currentStep.labelBack"\n\t\t\t:title="currentStep.labelBack"\n\t\t\t:size="buttonSize"\n\t\t\t:color="buttonColor"\n\t\t\t@click="currentStep.back()"\n\t\t/>\n\t`};class X{constructor(t=false){this.hidden=false;this.hidden=t}get store(){return a.Core.getStore()}get labelNext(){return k.Loc.getMessage("BRCW_BUTTON_CONTINUE")}get labelBack(){return k.Loc.getMessage("BRCW_BUTTON_CANCEL")}async next(){await this.store.dispatch("resource-creation-wizard/nextStep")}async back(){await this.store.dispatch("resource-creation-wizard/prevStep")}}class j extends X{constructor(){super(true)}get labelBack(){return k.Loc.getMessage("BRCW_BUTTON_CANCEL")}async next(){await super.next()}back(){k.Event.EventEmitter.emit(P.EventName.CloseWizard)}}var K=babelHelpers.classPrivateFieldLooseKey("resource");var Y=babelHelpers.classPrivateFieldLooseKey("isBitrix24Approved");var Q=babelHelpers.classPrivateFieldLooseKey("isBitrix24SenderAvailable");var Z=babelHelpers.classPrivateFieldLooseKey("prepareCompanySlotRanges");var J=babelHelpers.classPrivateFieldLooseKey("prepareResourceTypeNotifications");var tt=babelHelpers.classPrivateFieldLooseKey("upsertResource");var et=babelHelpers.classPrivateFieldLooseKey("prepareNotificationOptions");class it extends X{constructor(){super();Object.defineProperty(this,et,{value:lt});Object.defineProperty(this,tt,{value:ct});Object.defineProperty(this,J,{value:at});Object.defineProperty(this,Z,{value:rt});Object.defineProperty(this,Q,{value:st});Object.defineProperty(this,Y,{value:nt});Object.defineProperty(this,K,{get:ot,set:void 0});this.step=3}get labelNext(){var t;return k.Type.isNull((t=babelHelpers.classPrivateFieldLooseBase(this,K)[K].id)!=null?t:null)?k.Loc.getMessage("BRCW_BUTTON_CREATE_RESOURCE"):k.Loc.getMessage("BRCW_BUTTON_UPDATE_RESOURCE")}async next(){this.store.commit(`${P.Model.ResourceCreationWizard}/setSaving`,true);u.RcwAnalytics.sendAddResourceFinish();const t=await babelHelpers.classPrivateFieldLooseBase(this,Y)[Y]();if(!t){this.store.commit(`${P.Model.ResourceCreationWizard}/setSaving`,false);return}if(this.store.getters[`${P.Model.ResourceCreationWizard}/isGlobalSchedule`]){await this.store.dispatch(`${P.Model.ResourceCreationWizard}/updateResource`,{slotRanges:babelHelpers.classPrivateFieldLooseBase(this,Z)[Z](babelHelpers.classPrivateFieldLooseBase(this,K)[K])})}const e=await babelHelpers.classPrivateFieldLooseBase(this,tt)[tt](babelHelpers.classPrivateFieldLooseBase(this,K)[K]);if(!e){this.store.commit(`${P.Model.ResourceCreationWizard}/setSaving`,false);return}await h.resourceTypeService.update({id:babelHelpers.classPrivateFieldLooseBase(this,K)[K].typeId,...babelHelpers.classPrivateFieldLooseBase(this,J)[J](babelHelpers.classPrivateFieldLooseBase(this,K)[K])});k.Event.EventEmitter.emit(P.EventName.CloseWizard)}}function ot(){return this.store.getters[`${P.Model.ResourceCreationWizard}/getResource`]}function nt(){if(!babelHelpers.classPrivateFieldLooseBase(this,Q)[Q]()){return Promise.resolve(true)}return l.ConditionChecker.checkIsApproved({senderType:l.Types.bitrix24})}function st(){const t=this.store.getters[`${P.Model.Notifications}/getSenders`].find((t=>t.moduleId===P.Module.Crm&&t.code===l.Types.bitrix24));if(!t){return false}return t.canUse}function rt(t){var e,i;const o=(e=(i=t.slotRanges[0])==null?void 0:i.slotSize)!=null?e:60;const n=this.store.getters[`${P.Model.ResourceCreationWizard}/getCompanyScheduleSlots`];const s=this.store.getters[`${P.Model.Interface}/timezone`];return n.map((t=>({...t,slotSize:o,timezone:s})))}function at(t){const e=this.store.getters[`${P.Model.ResourceTypes}/getById`](t.typeId);return Object.values(this.store.getters[`${P.Model.Dictionary}/getNotifications`]).map((({value:t})=>t)).reduce(((i,o)=>{const n=P.NotificationFieldsMap.NotificationOn[o];const s=P.NotificationFieldsMap.TemplateType[o];const r=P.NotificationFieldsMap.Settings[o];const a=this.store.getters[`${P.Model.ResourceCreationWizard}/isCheckedForAll`](o);return{...i,[n]:a?t[n]:e[n],[s]:a?t[s]:e[s],...r.reduce(((i,o)=>({...i,[o]:a?t[o]:e[o]})),{})}}),{})}async function ct(t){const e=Boolean(t.id);const i=await(e?d.resourceService.update(t):d.resourceService.add(t));let o=k.Loc.getMessage(e?"BRCW_UPDATE_SUCCESS_MESSAGE":"BRCW_CREATE_SUCCESS_MESSAGE");if(k.Type.isArrayFilled(i.errors)){o=i.errors[0].message}c.Notifier.notify(babelHelpers.classPrivateFieldLooseBase(this,et)[et](o));return!k.Type.isArrayFilled(i.errors)}function lt(t){return{id:k.Text.getRandom(),text:t}}var dt=babelHelpers.classPrivateFieldLooseKey("isFirstStep");class ut extends X{constructor(){super();Object.defineProperty(this,dt,{get:pt,set:void 0});this.step=2}get labelBack(){return babelHelpers.classPrivateFieldLooseBase(this,dt)[dt]?super.labelBack:k.Loc.getMessage("BRCW_BUTTON_BACK")}async next(){const t=this.store;if(!t.state[P.Model.ResourceCreationWizard].resource.name){if(!k.Type.isNull(t.state[P.Model.ResourceCreationWizard].resourceId)){await t.dispatch(`${P.Model.ResourceCreationWizard}/setInvalidResourceName`,true);return}await t.dispatch(`${P.Model.ResourceCreationWizard}/updateResource`,{name:k.Loc.getMessage("BRCW_DEFAULT_RESOURCE_NAME")})}if(!t.state[P.Model.ResourceCreationWizard].resource.typeId){await t.dispatch(`${P.Model.ResourceCreationWizard}/setInvalidResourceType`,true);return}await super.next();u.RcwAnalytics.sendAddResourceStep2()}async back(){if(babelHelpers.classPrivateFieldLooseBase(this,dt)[dt]){k.Event.EventEmitter.emit(P.EventName.CloseWizard)}else{await super.back()}}}function pt(){return this.store.getters[`${P.Model.ResourceCreationWizard}/startStep`]===this.step}const mt={name:"ResourceCreationWizardFooter",props:{step:{type:Number,required:true},disabled:Boolean},data(){return{steps:[new j,new ut,new it]}},computed:W.mapGetters({isSaving:`${P.Model.ResourceCreationWizard}/isSaving`}),components:{BackButton:q,NextButton:V},template:`\n\t\t<div v-if="!steps[step - 1].hidden" class="resource-creation-wizard__footer">\n\t\t\t<NextButton :step :steps :disabled :waiting="isSaving"/>\n\t\t\t<BackButton :step :steps :disabled="isSaving"/>\n\t\t</div>\n\t`};const ht={name:"ResourceType",emits:["selected"],props:{resourceType:{type:Object,required:true}},data(){return{IconSet:O.Set}},components:{Icon:O.BIcon},template:`\n\t\t<div class="booking--rcw--resource-type-item" @click="$emit('selected', resourceType)">\n\t\t\t<div class="rcw__resource-type">\n\t\t\t\t<div :class="['booking--rcw--resource-type__icon', 'booking--rcw--resource-type__icon--' + resourceType.code]">\n\t\t\t\t</div>\n\t\t\t\t<div class="rcw__resource-type__row">\n\t\t\t\t\t<div class="rcw__resource-type__label">\n\t\t\t\t\t\t<div class="rcw__resource-type__label-title">{{ resourceType.name }}</div>\n\t\t\t\t\t\t<div class="rcw__resource-type__label-description">{{ resourceType.description }}</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<Icon :name="IconSet.ARROW_RIGHT"/>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t`};const ft={name:"ResourceCategoryCard",setup(){return{code:P.HelpDesk.ResourceType.code,anchorCode:P.HelpDesk.ResourceType.anchorCode}},computed:{resourceTypes(){return this.$store.state[P.Model.ResourceCreationWizard].advertisingResourceTypes}},methods:{async selectResourceType({relatedResourceTypeId:t}){await this.$store.dispatch(`${P.Model.ResourceCreationWizard}/updateResource`,{typeId:t});await this.$store.dispatch(`${P.Model.ResourceCreationWizard}/nextStep`);u.RcwAnalytics.sendAddResourceStep1()}},components:{HelpDeskLoc:M.HelpDeskLoc,ResourceType:ht},template:`\n\t\t<div class="resource-category-card">\n\t\t\t<div class="resource-category-card__header">\n\t\t\t\t<div class="resource-category-card__header__title">\n\t\t\t\t\t{{ loc('BRCW_CHOOSE_CATEGORY_MSGVER_1') }}\n\t\t\t\t</div>\n\t\t\t\t<HelpDeskLoc\n\t\t\t\t\t:message="loc('BRCW_CHOOSE_CATEGORY_DESCRIPTION_MSGVER_2')"\n\t\t\t\t\t:code="code"\n\t\t\t\t\t:anchor="anchorCode"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t\t<div class="resource-category-card__content resource-creation-wizard__form">\n\t\t\t\t<ResourceType\n\t\t\t\t\tv-for="resourceType in resourceTypes"\n\t\t\t\t\t:key="resourceType.code"\n\t\t\t\t\t:resource-type\n\t\t\t\t\t:data-id="'brcw-resource-type-list-' + resourceType.code"\n\t\t\t\t\t@selected="selectResourceType"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t</div>\n\t`};const vt={name:"ErrorMessage",props:{message:{type:String,default:""}},template:`\n\t\t<div class="booking--rcw--error-message-container">\n\t\t\t<div class="booking--rcw--error-message">\n\t\t\t\t<span class="ui-icon-set --warning"></span>\n\t\t\t\t<span>{{ message }}</span>\n\t\t\t</div>\n\t\t</div>\n\t`};const Rt={name:"ResourceSettingsCardBaseFields",emits:["nameUpdate","typeUpdate"],props:{initialResourceName:{type:String,default:""},initialResourceType:{type:Object,required:true}},data(){return{entityId:P.EntitySelectorEntity.ResourceType,typeSelectorId:`booking-resource-creation-types${k.Text.getRandom()}`,typeName:this.initialResourceType.typeName}},computed:{resourceName:{get(){return this.initialResourceName},set(t=""){this.$emit("nameUpdate",t)}},invalidResourceName(){return this.$store.state[P.Model.ResourceCreationWizard].invalidResourceName},invalidResourceType(){return this.$store.state[P.Model.ResourceCreationWizard].invalidResourceType},errorMessage(){return this.loc("BRCW_SETTINGS_CARD_REQUIRED_FIELD")}},methods:{showTypeSelector(){const t=this.getTypeSelectorDialog(this.$refs.typeSelectorAngle);t.show()},getTypeSelectorDialog(t){var e;const i=p.Dialog.getById(this.typeSelectorId);if(i){i.setTargetNode(t);return i}return new p.Dialog({id:this.typeSelectorId,targetNode:t,width:300,height:400,enableSearch:true,dropdownMode:true,context:"bookingResourceCreationType",multiple:false,cacheable:true,preselectedItems:[[this.entityId,(e=this.initialResourceType)==null?void 0:e.typeId]],entities:[{id:this.entityId,dynamicLoad:true,dynamicSearch:true}],popupOptions:{targetContainer:this.$root.$el.querySelector(".resource-creation-wizard__wrapper")},searchOptions:{allowCreateItem:true,footerOptions:{label:this.loc("BRCW_SETTINGS_CARD_TYPE_SELECTOR_CREATE_BTN")}},events:{"Search:onItemCreateAsync":t=>new Promise((e=>{const{searchQuery:i}=t.getData();const o=t.getTarget();this.createType(i.getQuery()).then((t=>{this.updateResourceType(t.id,t.name);o.addItem(this.prepareTypeToDialog(t));o.hide();e()})).catch((()=>{e()}))})),"Item:onSelect":t=>{const e=t.getData().item;this.updateResourceType(e.getId(),e.getTitle())}}})},async createType(t){return h.resourceTypeService.add({moduleId:"booking",name:t})},prepareTypeToDialog(t){return{id:t.id,entityId:this.entityId,title:t.name,sort:1,selected:true,tabs:"recents",supertitle:this.loc("BRCW_SETTINGS_CARD_TYPE_SELECTOR_SUPER_TITLE"),avatar:"/bitrix/js/booking/images/entity-selector/resource-type.svg"}},updateResourceType(t,e){this.typeName=e;this.$emit("typeUpdate",t)},scrollToBaseFieldsForm(){var t;(t=this.$refs.baseFieldsForm)==null?void 0:t.scrollIntoView(true,{behavior:"smooth",block:"center"})}},watch:{invalidResourceName(t){if(t){this.scrollToBaseFieldsForm()}},invalidResourceType(t){if(t){this.scrollToBaseFieldsForm()}}},components:{ErrorMessage:vt,EmptyRichLoc:M.EmptyRichLoc},template:`\n\t\t<div ref="baseFieldsForm" class="ui-form resource-creation-wizard__form-settings --base">\n\t\t\t<div class="ui-form-row-inline booking--rcw--form-row-align">\n\t\t\t\t<div class="ui-form-row">\n\t\t\t\t\t<div class="ui-form-label">\n\t\t\t\t\t\t<label class="ui-ctl-label-text" for="brcw-settings-resource-name">\n\t\t\t\t\t\t\t{{ loc('BRCW_SETTINGS_CARD_NAME_LABEL') }}\n\t\t\t\t\t\t</label>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="ui-form-content booking--rcw--field-with-validation">\n\t\t\t\t\t\t<div class="ui-ctl ui-ctl-textbox ui-ctl-w100">\n\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\tv-model.trim="resourceName"\n\t\t\t\t\t\t\t\tid="brcw-settings-resource-name"\n\t\t\t\t\t\t\t\tdata-id="brcw-settings-resource-name-input"\n\t\t\t\t\t\t\t\ttype="text"\n\t\t\t\t\t\t\t\tclass="ui-ctl-element"\n\t\t\t\t\t\t\t\t:class="{ '--error': invalidResourceName }"\n\t\t\t\t\t\t\t\t:placeholder="loc('BRCW_SETTINGS_CARD_NAME_LABEL')"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<ErrorMessage\n\t\t\t\t\t\t\tv-if="invalidResourceName"\n\t\t\t\t\t\t\t:message="errorMessage"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="ui-form-line">\n\t\t\t\t\t\t<div class="booking--rcw--resource-name-description">\n\t\t\t\t\t\t\t<EmptyRichLoc\n\t\t\t\t\t\t\t\t:message="loc('BRCW_SETTINGS_CARD_NAME_DESCRIPTION')"\n\t\t\t\t\t\t\t\t:rules="['nowrap']"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class="ui-form-row">\n\t\t\t\t\t<div class="ui-form-label">\n\t\t\t\t\t\t<div class="ui-ctl-label-text">\n\t\t\t\t\t\t\t{{ loc('BRCW_SETTINGS_CARD_TYPE_LABEL') }}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="ui-form-content booking--rcw--field-with-validation">\n\t\t\t\t\t\t<div class="ui-ctl ui-ctl-after-icon ui-ctl-dropdown ui-ctl-w100">\n\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\tref="typeSelectorAngle"\n\t\t\t\t\t\t\t\tclass="ui-ctl-after ui-ctl-icon-angle"\n\t\t\t\t\t\t\t></div>\n\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\tref="typeSelectorElement"\n\t\t\t\t\t\t\t\tdata-id="brcw-settings-resource-type-selector"\n\t\t\t\t\t\t\t\tclass="ui-ctl-element resource-creation-wizard__form-settings-element"\n\t\t\t\t\t\t\t\t:class="{\n\t\t\t\t\t\t\t\t\t'--placeholder': !typeName,\n\t\t\t\t\t\t\t\t\t'--error': invalidResourceType,\n\t\t\t\t\t\t\t\t}"\n\t\t\t\t\t\t\t\t@click="showTypeSelector"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<template v-if="typeName">\n\t\t\t\t\t\t\t\t\t{{ typeName }}\n\t\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t\t<template v-else>\n\t\t\t\t\t\t\t\t\t{{ loc('BRCW_SETTINGS_CARD_TYPE_PLACEHOLDER') }}\n\t\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<ErrorMessage\n\t\t\t\t\t\t\tv-if="invalidResourceType"\n\t\t\t\t\t\t\t:message="errorMessage"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t`};const Tt={name:"ResourceSettingsCardTitleLayout",props:{title:{type:String,required:true},iconType:{type:String,required:true}},components:{Icon:O.BIcon},template:`\n\t\t<div class="resource-creation-wizard__form-settings-title-row">\n\t\t\t<Icon\n\t\t\t\t:name="iconType"\n\t\t\t\t:color="'var(--ui-color-primary)'"\n\t\t\t\t:size="24"\n\t\t\t/>\n\t\t\t<div class="resource-creation-wizard__form-settings-title">\n\t\t\t\t{{ title }}\n\t\t\t</div>\n\t\t</div>\n\t`};const gt={name:"ScheduleItem",emits:["update:model-value"],props:{modelValue:{type:Boolean,required:true},itemClass:{type:String,required:true},title:{type:String,required:true},description:{type:String,required:true},value:{type:Boolean,required:true}},setup(){return{code:P.HelpDesk.ResourceSchedule.code,anchorCode:P.HelpDesk.ResourceSchedule.anchorCode}},computed:{isSelected(){return this.modelValue.toString()===this.value.toString()}},methods:{selectOption(){this.$emit("update:model-value",this.value)}},components:{HelpDeskLoc:M.HelpDeskLoc},template:`\n\t\t<div\n\t\t\t:class="['booking--rcw--schedule-item', { '--selected': isSelected }]"\n\t\t\t@click="selectOption"\n\t\t>\n\t\t\t<div class="booking--rcw--schedule-item-radio ui-ctl-radio">\n\t\t\t\t<input\n\t\t\t\t\t:id="itemClass"\n\t\t\t\t\t:checked="isSelected"\n\t\t\t\t\t:value="value.toString()"\n\t\t\t\t\ttype="radio"\n\t\t\t\t\tclass="ui-ctl-element"\n\t\t\t\t\t@input="$emit('update:model-value', $event.target.value === 'true')"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t\t<div class="booking--rcw--schedule-item-text">\n\t\t\t\t<label\n\t\t\t\t\t:for="itemClass"\n\t\t\t\t\tclass="booking--rcw--schedule-item-text-title">\n\t\t\t\t\t{{ title }}\n\t\t\t\t</label>\n\t\t\t\t<HelpDeskLoc\n\t\t\t\t\t:message="description"\n\t\t\t\t\t:code="code"\n\t\t\t\t\t:anchor="anchorCode"\n\t\t\t\t\t:rules="['nowrap']"\n\t\t\t\t\tclass="booking--rcw--schedule-item-text-description"\n\t\t\t\t\tlink-class="booking--rcw--more booking--rcw--schedule-item-text-description-more"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t\t<div class="booking--rcw--schedule-item-view" :class="itemClass"></div>\n\t\t</div>\n\t`};const yt={name:"ResourceSettingsCardScheduleTypes",emits:["update:model-value"],props:{modelValue:{type:Boolean,default:true}},setup(){const t=k.Loc.getMessage("BRCW_SETTINGS_CARD_SCHEDULE_TITLE_MSGVER_1");const e=O.Set.COLLABORATION;const i=[{id:"common",itemClass:"resource-creation-wizard__form-settings-schedule-view-common",title:k.Loc.getMessage("BRCW_SETTINGS_CARD_SCHEDULE_COLUMNS_TITLE_MSGVER_1"),description:k.Loc.getMessage("BRCW_SETTINGS_CARD_SCHEDULE_COLUMNS_DESCRIPTION_MSGVER_2"),value:true},{id:"extra",itemClass:"resource-creation-wizard__form-settings-schedule-view-extra",title:k.Loc.getMessage("BRCW_SETTINGS_CARD_SCHEDULE_CROSS_RESOURCING_TITLE_MSGVER_1"),description:k.Loc.getMessage("BRCW_SETTINGS_CARD_SCHEDULE_CROSS_RESOURCING_DESCRIPTION_MSGVER_2"),value:false}];return{items:i,title:t,titleIconType:e}},components:{ScheduleItem:gt,TitleLayout:Tt},template:`\n\t\t<div class="ui-form resource-creation-wizard__form-settings --schedule">\n\t\t\t<TitleLayout\n\t\t\t\t:title="title"\n\t\t\t\t:iconType="titleIconType"\n\t\t\t/>\n\t\t\t<div class="resource-creation-wizard__form-settings-schedule-view">\n\t\t\t\t<ScheduleItem\n\t\t\t\t\tv-for="item in items"\n\t\t\t\t\t:key="item.id"\n\t\t\t\t\t:data-id="'brcw-resource-schedule-view-' + item.id"\n\t\t\t\t\t:model-value="modelValue"\n\t\t\t\t\t:item-class="item.itemClass"\n\t\t\t\t\t:title="item.title"\n\t\t\t\t\t:description="item.description"\n\t\t\t\t\t:value="item.value"\n\t\t\t\t\t@update:model-value="$emit('update:model-value', $event)"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t</div>\n\t`};const _t={name:"ResourceSettingsCardTextLayout",props:{type:{type:String,required:true},text:{type:String,required:true}},setup(t){return{code:P.HelpDesk[`Resource${t.type}`].code,anchorCode:P.HelpDesk[`Resource${t.type}`].anchorCode}},components:{HelpDeskLoc:M.HelpDeskLoc},template:`\n\t\t<div class="resource-creation-wizard__form-settings-text-row">\n\t\t\t<HelpDeskLoc\n\t\t\t\t:message="text"\n\t\t\t\t:code="code"\n\t\t\t\t:anchor="anchorCode"\n\t\t\t\tclass="resource-creation-wizard__form-settings-text"\n\t\t\t/>\n\t\t</div>\n\t`};const{mapGetters:St}=W.createNamespacedHelpers("resource-creation-wizard");const Ct={data(){return{selected:{Mon:false,Tue:false,Wed:false,Thu:false,Fri:false,Sat:false,Sun:false},daysLabel:""}},created(){this.initialDays.forEach((t=>{if(Object.prototype.hasOwnProperty.call(this.selected,t)){this.selected[t]=true}}));this.daysLabel=this.formatDaysLabel()},methods:{formatDaysLabel(){const t=this.loc("BRCW_SETTINGS_CARD_WORK_TIME_DAYS");const e=this.companyScheduleSlots[0].weekDays;if(this.isArraysEqual(this.selectedDays,e)){return t}const i=Object.keys(this.daysLabelMap);const o=this.selectedDays.sort(((t,e)=>i.indexOf(t)-i.indexOf(e)));const n=o.map((t=>this.daysLabelMap[t]));return String(n.join(", "))},getDayDefaultIndex(t){const e={Sun:0,Mon:1,Tue:2,Wed:3,Thu:4,Fri:5,Sat:6};return e[t]},isArraysEqual(t,e){return t.length===e.length&&t.every(((t,i)=>t===e[i]))}},computed:{...St({companyScheduleSlots:"getCompanyScheduleSlots",weekStart:"weekStart"}),selectedDays(){return Object.keys(this.selected).filter((t=>this.selected[t]))},daysLabelMap(){const t=[];const e="D";const i=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"];const o=i.indexOf(this.weekStart);const n=[...i.slice(o),...i.slice(0,o)];n.forEach(((i,o)=>{const n=(new Date).getDay();const s=this.getDayDefaultIndex(i);const r=(s-n+7)%7;const a=new Date;a.setDate(a.getDate()+r);t[o]=L.DateTimeFormat.format(e,a)}));return n.reduce(((e,i,o)=>{e[i]=t[o];return e}),{})}}};const bt={name:"ResourceSettingsCardWeekDaysPopup",emits:["select","close"],props:{id:{type:String,required:true},bindElement:{type:HTMLElement,required:true},initialDays:{type:Array,required:true}},components:{Popup:A.Popup},mixins:[Ct],methods:{close(){this.$emit("close")},click(t){const e=Object.keys(this.selected).filter((t=>this.selected[t]===true));if(e.length===1&&e[0]===t){return}this.selected[t]=!this.selected[t];this.$emit("select",this.selectedDays,this.formatDaysLabel())}},computed:{popupId(){return`booking-work-time-popup-${this.id}`},config(){return{bindElement:this.bindElement,targetContainer:this.$root.$el.querySelector(".resource-creation-wizard__wrapper"),offsetRight:this.bindElement.offsetWidth,angle:false,bindOptions:{forceBindPosition:true,forceLeft:true}}}},template:`\n\t\t<Popup\n\t\t\t:id="popupId"\n\t\t\t:config="config"\n\t\t\t@close="close"\n\t\t\tref="popup"\n\t\t>\n\t\t\t<div class="resource-creation-wizard__form-week-days-popup">\n\t\t\t\t<div\n\t\t\t\t\tv-for="(day, index) in daysLabelMap"\n\t\t\t\t\t:key="index"\n\t\t\t\t\t:data-id="'brcw-resource-work-time-week-day-' + index + '-' + id"\n\t\t\t\t\tclass="resource-creation-wizard__form-week-days-popup-weekday"\n\t\t\t\t\t:class="{ '--selected': selected[index] }"\n\t\t\t\t\t@click="() => click(index)"\n\t\t\t\t>\n\t\t\t\t\t<div class="resource-creation-wizard__form-week-days-popup-weekday-text">\n\t\t\t\t\t\t{{ day }}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="resource-creation-wizard__form-week-days-popup-weekday-icon"></div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</Popup>\n\t`};const wt={name:"ResourceSettingsCardWorkTimeSlotRange",emits:["add","update","remove"],props:{id:{type:Number,required:true},isLastRange:{type:Boolean,required:true},initialSlotRange:{type:Object,required:true}},components:{WeekDaysPopup:bt},mixins:[Ct],data(){return{fromId:"from",toId:"to",fromTs:0,toTs:0,duration:0,isShownDays:false,arrow:{days:false,from:false,to:false},removeSlot:!this.isLastRange,localSlotRange:{...this.initialSlotRange},initialDays:[...this.initialSlotRange.weekDays]}},created(){this.fromTs=this.slotRange.from;this.toTs=this.slotRange.to;this.duration=this.toTs-this.fromTs},watch:{"slotRange.from":function(t){this.fromTs=t;this.toTs=this.fromTs+this.duration;this.update()},"slotRange.to":function(t){this.toTs=t;if(this.toTs<=this.fromTs){this.fromTs=this.toTs-this.duration}this.duration=this.toTs-this.fromTs;this.update()}},methods:{showDays(){this.isShownDays=true;this.arrow.days=true},hideDays(){this.isShownDays=false;this.arrow.days=false},selectDays(t,e){this.slotRange.weekDays=t;this.daysLabel=e;this.update()},show(t,e){if(this.arrow[e]===true){return}const i=`booking-work-time-popup-${this.id}-${e}`;B.MenuManager.destroy(i);const o=B.MenuManager.create({id:i,className:"resource-creation-wizard__form-work-time-menu",bindElement:t,targetContainer:this.$root.$el.querySelector(".resource-creation-wizard__wrapper"),autoHide:true,closeByEsc:true,events:{onShow:()=>{this.arrow[e]=true;const t=o.getMenuItems().find((t=>k.Dom.hasClass(t.getLayout().item,"--selected")));const i=36;const n=2*i;const s=o.getPopupWindow().getContentContainer();const r=k.Dom.getRelativePosition(t.getContainer(),s).top;s.scrollTo({top:s.scrollTop+r-n,behavior:"instant"})},onClose:()=>{this.arrow[e]=false}},maxHeight:200,minWidth:t.offsetWidth});for(const[t,i]of Object.entries(this.generateTimeMap(e))){const n=parseInt(t,10);const s="menu-popup-item menu-popup-no-icon";o.addMenuItem({text:i,className:this.slotRange[e]===n?`${s} --selected`:s,dataset:{id:e,minutes:n},onclick:()=>{this.slotRange[e]=parseInt(n,10);o.close()}})}o.show()},generateTimeMap(t){const e={};const i=L.DateTimeFormat.getFormat("SHORT_TIME_FORMAT");const o=30;const n=t===this.toId?this.fromTs+o:0;const s=t===this.fromId?this.toTs:1440;for(let t=n;t<s;t+=o){const o=(new Date).setHours(0,t,0,0)/1e3;e[t]=L.DateTimeFormat.format(i,o)}if(t===this.toId){const t=(new Date).setHours(0,0,0,0)/1e3;e[s]=L.DateTimeFormat.format(i,t)}return e},clickBtn(){if(this.removeSlot===false){this.removeSlot=true;this.$emit("add")}else{this.removeSlot=false;this.$emit("remove",this.id)}},update(){this.$emit("update",this.id,this.slotRange)}},computed:{daysId(){return`days-${this.id}`},days(){return this.$refs.days},slotRange(){return this.localSlotRange},fromLabel(){const t=this.generateTimeMap(this.fromId);return t[this.slotRange.from]},toLabel(){const t=this.generateTimeMap(this.toId);return t[this.slotRange.to]}},template:`\n\t\t<div class="ui-form-content resource-creation-wizard__form-work-time-selector-widget">\n\t\t\t<div class="ui-form-row resource-creation-wizard__form-work-time-selector-widget-days">\n\t\t\t\t<div\n\t\t\t\t\tref="days"\n\t\t\t\t\t:data-id="'brcw-resource-work-time-slot-range-days-' + id"\n\t\t\t\t\tclass="rcw-ui-ctl ui-ctl ui-ctl-after-icon ui-ctl-dropdown ui-ctl-sm ui-ctl-round"\n\t\t\t\t\t@click="showDays"\n\t\t\t\t>\n\t\t\t\t\t<div\n\t\t\t\t\t\tclass="ui-ctl-after ui-ctl-icon-angle"\n\t\t\t\t\t\t:class="{ '--active': arrow.days }"\n\t\t\t\t\t></div>\n\t\t\t\t\t<div class="ui-ctl-element">\n\t\t\t\t\t\t{{ daysLabel }}\n\t\t\t\t\t</div>\n\t\t\t\t\t<WeekDaysPopup\n\t\t\t\t\t\tv-if="isShownDays"\n\t\t\t\t\t\t:id="daysId"\n\t\t\t\t\t\t:bindElement="days"\n\t\t\t\t\t\t:initialDays="slotRange.weekDays"\n\t\t\t\t\t\t@select="selectDays"\n\t\t\t\t\t\t@close="hideDays"\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div class="ui-form-row resource-creation-wizard__form-work-time-selector-widget-time">\n\t\t\t\t<div class="ui-form-content">\n\t\t\t\t\t<div class="ui-form-row">\n\t\t\t\t\t\t<div\n\t\t\t\t\t\t\tref="from"\n\t\t\t\t\t\t\t:data-id="'brcw-resource-work-time-slot-range-from-' + id"\n\t\t\t\t\t\t\tclass="ui-ctl ui-ctl-after-icon ui-ctl-dropdown ui-ctl-sm ui-ctl-round"\n\t\t\t\t\t\t\t@click="() => show($refs.from, fromId)"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\tclass="ui-ctl-after ui-ctl-icon-angle"\n\t\t\t\t\t\t\t\t:class="{ '--active': arrow.from }"\n\t\t\t\t\t\t\t></div>\n\t\t\t\t\t\t\t<div class="ui-ctl-element">{{ fromLabel }}</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="ui-form-row">\n\t\t\t\t\t\t<div class="resource-creation-wizard__form-work-time-selector-dash"></div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="ui-form-row">\n\t\t\t\t\t\t<div\n\t\t\t\t\t\t\tref="to"\n\t\t\t\t\t\t\t:data-id="'brcw-resource-work-time-slot-range-to-' + id"\n\t\t\t\t\t\t\tclass="ui-ctl ui-ctl-after-icon ui-ctl-dropdown ui-ctl-sm ui-ctl-round"\n\t\t\t\t\t\t\t@click="() => show($refs.to, toId)"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\tclass="ui-ctl-after ui-ctl-icon-angle"\n\t\t\t\t\t\t\t\t:class="{ '--active': arrow.to }"\n\t\t\t\t\t\t\t></div>\n\t\t\t\t\t\t\t<div class="ui-ctl-element">{{ toLabel }}</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div class="ui-form-row resource-creation-wizard__form-work-time-selector-btn-row">\n\t\t\t\t<div\n\t\t\t\t\t:data-id="'brcw-resource-work-time-slot-range-add-' + id"\n\t\t\t\t\tclass="resource-creation-wizard__form-work-time-selector-btn"\n\t\t\t\t\t:class="{ '--remove': removeSlot }"\n\t\t\t\t\t@click="clickBtn"\n\t\t\t\t></div>\n\t\t\t</div>\n\t\t</div>\n\t`};const Et={name:"ResourceSettingsCardWorkTimeSelector",emits:["update","updateGlobalSchedule","getGlobalSchedule"],props:{initialSlotRanges:{type:Array,required:true},isGlobalSchedule:{type:Boolean,required:true},defaultSlotRange:{type:Object,required:true},initialTimezone:{type:String,required:true},currentTimezone:{type:String,required:true},isCompanyScheduleAccess:{type:Boolean,required:true},companyScheduleUrl:{type:String,required:true}},components:{WorkTimeSlotRange:wt,Icon:O.BIcon},data(){return{localSlotRanges:this.processSlotRanges(this.initialSlotRanges),isChecked:this.isGlobalSchedule,hasTimezonesDifference:false,formattedInitialOffset:"",formattedCurrentOffset:""}},created(){this.calculateDifferenceBetweenTimezones(this.initialTimezone,this.currentTimezone)},watch:{initialSlotRanges:{handler(t){this.localSlotRanges=this.processSlotRanges(t)},deep:true},isChecked(t){this.$emit("updateGlobalSchedule",t)}},methods:{openCompanyWorkTime(t){const e=t.target===t.currentTarget;if(!e&&this.isCompanyScheduleAccess&&this.companyScheduleUrl!==""){top.BX.Event.EventEmitter.subscribeOnce(top.BX.Event.EventEmitter.GLOBAL_TARGET,"SidePanel.Slider:onLoad",(t=>{const e=t.getTarget();e.getWindow().BX.Event.EventEmitter.subscribeOnce(e.getWindow().BX.Event.EventEmitter.GLOBAL_TARGET,"BX.Intranet.Settings:onSuccessSave",(t=>{const e=t.getData();e.reloadAfterClose=false;this.$emit("getGlobalSchedule")}))}));BX.SidePanel.Instance.open(this.companyScheduleUrl,{cacheable:false});t.preventDefault()}},updateSlotRange(t,e){this.slotRanges[t]=e;this.$emit("update",this.slotRanges)},addSlotRange(){this.slotRanges.push(this.defaultSlotRange);this.$emit("update",this.slotRanges)},removeSlotRange(t){this.slotRanges.splice(t,1);this.$emit("update",this.slotRanges)},processSlotRanges(t){return t.map((t=>{if(t.id===null){return{...t,id:k.Text.getRandom()}}return t}))},getTimezoneOffset(t){return v.Timezone.getOffset(Date.now(),t)/-60},calculateDifferenceBetweenTimezones(t,e){const i=this.getTimezoneOffset(t);const o=this.getTimezoneOffset(e);this.hasTimezonesDifference=i!==o;if(this.hasTimezonesDifference){const e=t=>{const e=t>=0?"+":"-";const i=Math.floor(Math.abs(t)/60);const o=Math.abs(t)%60;return`${e}${i}:${o.toString().padStart(2,"0")}`};this.formattedInitialOffset=`UTC ${e(-i)} ${t}`;const n=o-i;this.formattedCurrentOffset=e(n)}},onSlotClick(){this.isChecked=false}},computed:{companyWorkTimeOptionLabel(){return this.loc("BRCW_SETTINGS_CARD_WORK_TIME_COMPANY_OPTION")},slotRanges(){return this.localSlotRanges},isSlotsDisabled(){return this.isChecked},timezoneIconType(){return O.Set.EARTH_TIME},formattedTimezonesText(){return this.loc("BRCW_SETTINGS_CARD_WORK_TIME_TIMEZONES").replace("#utc#",this.formattedInitialOffset).replace("#difference#",this.formattedCurrentOffset)}},template:`\n\t\t<div class="ui-form resource-creation-wizard__form-work-time-selector">\n\t\t\t<div class="ui-form-row-inline">\n\t\t\t\t<div class="ui-form-row">\n\t\t\t\t\t<label\n\t\t\t\t\t\tfor="brcw-settings-work-time-company-option"\n\t\t\t\t\t\tclass="ui-ctl ui-ctl-checkbox"\n\t\t\t\t\t>\n\t\t\t\t\t\t<input\n\t\t\t\t\t\t\tid="brcw-settings-work-time-company-option"\n\t\t\t\t\t\t\tdata-id="brcw-settings-work-time-company-option"\n\t\t\t\t\t\t\ttype="checkbox"\n\t\t\t\t\t\t\tclass="ui-ctl-element"\n\t\t\t\t\t\t\tv-model="isChecked"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t<span\n\t\t\t\t\t\t\tclass="ui-ctl-label-text work-time-selector-label-text"\n\t\t\t\t\t\t\t:class="{'--disabled': !isCompanyScheduleAccess || companyScheduleUrl === ''}"\n\t\t\t\t\t\t\t@click="openCompanyWorkTime"\n\t\t\t\t\t\t\tv-html="companyWorkTimeOptionLabel"\n\t\t\t\t\t\t></span>\n\t\t\t\t\t</label>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div\n\t\t\t\tclass="resource-creation-wizard__form-work-time-selector-slots"\n\t\t\t\t:class="{'--disabled': isSlotsDisabled }"\n\t\t\t>\n\t\t\t\t<div\n\t\t\t\t\tv-for="(slotRange, index) in slotRanges"\n\t\t\t\t\t:key="slotRange.id"\n\t\t\t\t\t:data-id="'brcw-resource-work-time-slot-' + slotRange.id"\n\t\t\t\t\tclass="ui-form-row-inline"\n\t\t\t\t\t@click="onSlotClick"\n\t\t\t\t>\n\t\t\t\t\t<WorkTimeSlotRange\n\t\t\t\t\t\t:id="index"\n\t\t\t\t\t\t:initialSlotRange="slotRange"\n\t\t\t\t\t\t:isLastRange="index === slotRanges.length - 1"\n\t\t\t\t\t\t@add="addSlotRange"\n\t\t\t\t\t\t@update="updateSlotRange"\n\t\t\t\t\t\t@remove="removeSlotRange"\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t\t<div\n\t\t\t\t\tv-if="hasTimezonesDifference"\n\t\t\t\t\tclass="resource-creation-wizard__form-work-time-selector-slots-timezone"\n\t\t\t\t>\n\t\t\t\t\t<div class="resource-creation-wizard__form-work-time-selector-slots-timezone-icon">\n\t\t\t\t\t\t<Icon\n\t\t\t\t\t\t\t:name="timezoneIconType"\n\t\t\t\t\t\t\t:color="'var(--ui-color-palette-gray-50)'"\n\t\t\t\t\t\t\t:size="24"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div\n\t\t\t\t\t\tclass="resource-creation-wizard__form-work-time-selector-slots-timezone-text"\n\t\t\t\t\t\tv-html="formattedTimezonesText"\n\t\t\t\t\t></div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t`};const It={name:"ResourceSettingsCardWorkTime",emits:["update","updateGlobalSchedule","getGlobalSchedule"],props:{initialSlotRanges:{type:Array,required:true},isGlobalSchedule:{type:Boolean,required:true},defaultSlotRange:{type:Object,required:true},initialTimezone:{type:String,required:true},currentTimezone:{type:String,required:true},isCompanyScheduleAccess:{type:Boolean,required:true},companyScheduleUrl:{type:String,required:true}},components:{TitleLayout:Tt,TextLayout:_t,WorkTimeSelector:Et},methods:{update(t){this.$emit("update",t)},updateGlobalSchedule(t){this.$emit("updateGlobalSchedule",t)},getGlobalSchedule(){this.$emit("getGlobalSchedule")}},computed:{title(){return this.loc("BRCW_SETTINGS_CARD_WORK_TIME_TITLE_MSGVER_1")},titleIconType(){return O.Set.CLOCK_2}},template:`\n\t\t<div class="ui-form resource-creation-wizard__form-settings">\n\t\t\t<TitleLayout\n\t\t\t\t:title="title"\n\t\t\t\t:iconType="titleIconType"\n\t\t\t/>\n\t\t\t<TextLayout\n\t\t\t\ttype="WorkTime"\n\t\t\t\t:text="loc('BRCW_SETTINGS_CARD_WORK_TIME_TEXT_MSGVER_2')"\n\t\t\t/>\n\t\t\t<WorkTimeSelector\n\t\t\t\t:initialSlotRanges="initialSlotRanges"\n\t\t\t\t:defaultSlotRange="defaultSlotRange"\n\t\t\t\t:isGlobalSchedule="isGlobalSchedule"\n\t\t\t\t:initialTimezone="initialTimezone"\n\t\t\t\t:currentTimezone="currentTimezone"\n\t\t\t\t:isCompanyScheduleAccess="isCompanyScheduleAccess"\n\t\t\t\t:companyScheduleUrl="companyScheduleUrl"\n\t\t\t\t@update="update"\n\t\t\t\t@updateGlobalSchedule="updateGlobalSchedule"\n\t\t\t\t@getGlobalSchedule="getGlobalSchedule"\n\t\t\t/>\n\t\t</div>\n\t`};const Nt={name:"ResourceSettingsCardSlotLengthSlotLengthPrecisionSelection",directives:{hint:C.hint},emits:["input"],components:{},props:{initialValue:{type:Number,default:0}},data(){return{days:0,hours:0,minutes:0,minutesFocused:false}},created(){this.distributeInitialValue()},methods:{distributeInitialValue(){let t=this.initialValue;this.days=Math.floor(t/(24*60));t%=24*60;this.hours=Math.floor(t/60);t%=60;this.minutes=t},calculateTotalMinutes(){const t=this.days*24*60+this.hours*60+this.minutes;this.$emit("input",t)},validateHours(){this.hours=parseInt(this.hours,10);if(!k.Type.isNumber(this.hours)){this.hours=0}if(this.hours>12){this.hours=12}if(this.hours===0){setTimeout((()=>{if(!this.minutesFocused){this.calculateTotalMinutes()}}),0)}else{this.calculateTotalMinutes()}},validateMinutes(){this.minutesFocused=false;this.minutes=parseInt(this.minutes,10);if(!k.Type.isNumber(this.minutes)){this.minutes=0}if(this.minutes>59){this.minutes=59}this.calculateTotalMinutes()},handleEnterKey(t){if(t.key==="Enter"){t.target.blur()}}},computed:{hourHint(){return{text:this.loc("BRCW_SETTINGS_CARD_SLOT_LENGTH_PRECISION_LIMIT_HOUR"),popupOptions:{targetContainer:this.$root.$el.querySelector(".resource-creation-wizard__wrapper")}}},minutesHint(){return{text:this.loc("BRCW_SETTINGS_CARD_SLOT_LENGTH_PRECISION_LIMIT_MINUTES"),popupOptions:{targetContainer:this.$root.$el.querySelector(".resource-creation-wizard__wrapper")}}}},template:`\n\t\t<div class="ui-form resource-creation-wizard__form-slot-length-precision-selection">\n\t\t\t<div class="ui-form-row-inline">\n\t\t\t\t<div class="ui-form-row --disabled">\n\t\t\t\t\t<div class="ui-form-content">\n\t\t\t\t\t\t<div class="ui-form-row">\n\t\t\t\t\t\t\t<div class="ui-ctl ui-ctl-time ui-ctl-sm ui-ctl-round">\n\t\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\t\t:data-id="'brcw-resource-slot-length-precision-days'"\n\t\t\t\t\t\t\t\t\tv-model="days"\n\t\t\t\t\t\t\t\t\ttype="text"\n\t\t\t\t\t\t\t\t\tclass="ui-ctl-element"\n\t\t\t\t\t\t\t\t\tdisabled\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="ui-form-row">\n\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t{{ loc('BRCW_SETTINGS_CARD_SLOT_LENGTH_PRECISION_1') }}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class="ui-form-row">\n\t\t\t\t\t<div class="ui-form-content">\n\t\t\t\t\t\t<div class="ui-form-row">\n\t\t\t\t\t\t\t<div \n\t\t\t\t\t\t\t\tclass="ui-ctl ui-ctl-time ui-ctl-sm ui-ctl-round"\n\t\t\t\t\t\t\t\tv-hint="hourHint"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\t\t:data-id="'brcw-resource-slot-length-precision-hours'"\n\t\t\t\t\t\t\t\t\tv-model="hours"\n\t\t\t\t\t\t\t\t\ttype="text"\n\t\t\t\t\t\t\t\t\tclass="ui-ctl-element"\n\t\t\t\t\t\t\t\t\t@blur="validateHours"\n\t\t\t\t\t\t\t\t\t@keydown="handleEnterKey"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="ui-form-row">\n\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t{{ loc('BRCW_SETTINGS_CARD_SLOT_LENGTH_PRECISION_2') }}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class="ui-form-row">\n\t\t\t\t\t<div class="ui-form-content">\n\t\t\t\t\t\t<div class="ui-form-row">\n\t\t\t\t\t\t\t<div \n\t\t\t\t\t\t\t\tclass="ui-ctl ui-ctl-time ui-ctl-sm ui-ctl-round"\n\t\t\t\t\t\t\t\tv-hint="minutesHint"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\t\t:data-id="'brcw-resource-slot-length-precision-minutes'"\n\t\t\t\t\t\t\t\t\tv-model="minutes"\n\t\t\t\t\t\t\t\t\ttype="text"\n\t\t\t\t\t\t\t\t\tclass="ui-ctl-element"\n\t\t\t\t\t\t\t\t\t@focus="minutesFocused = true"\n\t\t\t\t\t\t\t\t\t@blur="validateMinutes"\n\t\t\t\t\t\t\t\t\t@keydown="handleEnterKey"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="ui-form-row">\n\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t{{ loc('BRCW_SETTINGS_CARD_SLOT_LENGTH_PRECISION_3') }}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t`};const Bt=T.Duration.getUnitDurations();const kt=Object.fromEntries(Object.entries(Bt).map((([t,e])=>[t,e/Bt.i])));const Lt=new Set([kt.H*24,kt.d*7]);const At={name:"ResourceSettingsCardSlotLengthSelector",directives:{hint:C.hint},emits:["select"],components:{SlotLengthPrecisionSelection:Nt},props:{initialSelectedValue:{type:Number,required:true}},data(){return{selectedPrecisionValue:this.initialSelectedValue,precisionMode:false}},computed:{selectedValue:{get(){return this.$store.state[P.Model.ResourceCreationWizard].slotLengthId},set(t){this.$store.dispatch(`${P.Model.ResourceCreationWizard}/setSlotLengthId`,{slotLengthId:t})}},durations(){return[{label:new T.Duration(Bt.H).format("H"),value:kt.H},{label:new T.Duration(Bt.H*2).format("H"),value:kt.H*2},{label:new T.Duration(Bt.H*24).format("H"),value:kt.H*24},{label:new T.Duration(Bt.d*7).format("d"),value:kt.d*7},{label:this.loc("BRCW_SETTINGS_CARD_SLOT_LENGTH_SELECTOR_CUSTOM"),value:0}]}},created(){const t=new Set([kt.H,kt.H*2,kt.H*24,kt.d*7]);this.selectedValue=this.initialSelectedValue;if(!t.has(this.selectedValue)){this.selectedValue=0;this.precisionMode=true}},methods:{select(t){if(Lt.has(t)){return}this.selectedValue=parseInt(t,10);if(t===0){this.precisionMode=true}else{this.precisionMode=false;this.$emit("select",this.selectedValue)}},selectPrecision(t){this.selectedPrecisionValue=t===0?kt.H:parseInt(t,10);if(t===0){this.selectedValue=kt.H;this.precisionMode=false}this.$emit("select",this.selectedPrecisionValue)},getClass(t){return{"ui-btn-primary":this.selectedValue===t,"ui-btn-light":this.selectedValue!==t,"ui-btn-disabled":Lt.has(t)}},getSoonHintContent(t){if(Lt.has(t)){return{text:this.loc("BRCW_SOON_HINT"),popupOptions:{targetContainer:this.$root.$el.querySelector(".resource-creation-wizard__wrapper"),bindOptions:{position:"bottom"},offsetLeft:0,offsetTop:0}}}return null}},template:`\n\t\t<div class="resource-creation-wizard__form-slot-length-selector">\n\t\t\t<div\n\t\t\t\tv-for="(duration, index) in durations"\n\t\t\t\t:key="index"\n\t\t\t\t:data-id="'brcw-resource-slot-length-selector-size-' + index"\n\t\t\t\tclass="ui-btn ui-btn-xs"\n\t\t\t\t:class="getClass(duration.value)"\n\t\t\t\t@click="select(duration.value)"\n\t\t\t\tv-hint="getSoonHintContent(duration.value)"\n\t\t\t>\n\t\t\t\t{{ duration.label }}\n\t\t\t</div>\n\t\t</div>\n\t\t<transition name="fade">\n\t\t\t<div\n\t\t\t\tv-if="precisionMode"\n\t\t\t\tclass="resource-creation-wizard__form-slot-length-precision"\n\t\t\t>\n\t\t\t\t<SlotLengthPrecisionSelection\n\t\t\t\t\t:initialValue="selectedPrecisionValue"\n\t\t\t\t\t@input="selectPrecision"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t</transition>\n\t`};const Dt={name:"ResourceSettingsCardSlotLength",emits:["select"],components:{TitleLayout:Tt,TextLayout:_t,SlotLengthSelector:At},props:{initialSelectedValue:{type:Number,default:60}},data(){return{selectedSlotLength:this.initialSelectedValue}},methods:{updateSelectedValue(t){this.selectedSlotLength=t;this.$emit("select",t)}},computed:{title(){return this.loc("BRCW_SETTINGS_CARD_SLOT_LENGTH_TITLE_MSGVER_1")},titleIconType(){return O.Set.GANTT_GRAPHS}},template:`\n\t\t<div class="ui-form resource-creation-wizard__form-settings">\n\t\t\t<TitleLayout\n\t\t\t\t:title="title"\n\t\t\t\t:iconType="titleIconType"\n\t\t\t/>\n\t\t\t<TextLayout\n\t\t\t\ttype="SlotLength"\n\t\t\t\t:text="loc('BRCW_SETTINGS_CARD_SLOT_LENGTH_TEXT_MSGVER_2')"\n\t\t\t/>\n\t\t\t<div>\n\t\t\t\t<SlotLengthSelector\n\t\t\t\t\t:initialSelectedValue="initialSelectedValue"\n\t\t\t\t\t@select="updateSelectedValue"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t</div>\n\t`};const{mapGetters:Mt,mapActions:Ot,mapMutations:zt}=W.createNamespacedHelpers("resource-creation-wizard");const $t={name:"ResourceSettingsCard",components:{BaseFields:Rt,ScheduleTypes:yt,WorkTime:It,SlotLength:Dt},created(){var t,e,i;this.initialTimezone=this.getInitialSlotTimeZone();this.selectedSlotLength=(t=(e=this.resource.slotRanges)==null?void 0:(i=e[0])==null?void 0:i.slotSize)!=null?t:60;const o=k.Type.isArrayFilled(this.resource.slotRanges)?this.resource.slotRanges:this.companyScheduleSlots;this.updateSlotRanges(o)},data(){return{selectedSlotLength:60,initialTimezone:""}},methods:{...Ot(["updateResource","setInvalidResourceName","setInvalidResourceType"]),...zt(["setGlobalSchedule"]),updateResourceName(t){this.updateResource({name:t});if(t){this.setInvalidResourceName(false)}},updateResourceType(t){this.updateResource({typeId:t});if(t){this.setInvalidResourceType(false)}},updateSlotRanges(t){this.updateResource({slotRanges:this.updateSlotDataForAllRanges(t)})},updateSlotLength(t){this.selectedSlotLength=t;if(this.resource.slotRanges.length===0){return}this.updateSlotRanges(this.resource.slotRanges)},updateSlotDataForAllRanges(t){const e=t||this.resource.slotRanges;return e.map((t=>({...t,slotSize:this.selectedSlotLength,timezone:this.timezone})))},updateGlobalSchedule(t){this.setGlobalSchedule(t)},async fetchData(){await N.resourceCreationWizardService.fetchData();if(!this.isEditForm){this.updateSlotRanges(this.companyScheduleSlots)}},getInitialSlotTimeZone(){var t;const e=this.isEditForm?this.resource.slotRanges:this.companyScheduleSlots;return(t=e[0])==null?void 0:t.timezone}},computed:{...W.mapGetters({timezone:`${P.Model.Interface}/timezone`}),...Mt({resource:"getResource",companyScheduleSlots:"getCompanyScheduleSlots",isCompanyScheduleAccess:"isCompanyScheduleAccess",companyScheduleUrl:"companyScheduleUrl",isGlobalSchedule:"isGlobalSchedule"}),resourceName(){return this.resource.name},resourceType(){const t=this.$store.getters[`${P.Model.ResourceTypes}/getById`](this.resource.typeId);return{typeId:this.resource.typeId,typeName:t==null?void 0:t.name}},slotRanges(){return this.resource.slotRanges},defaultSlotRange(){return this.companyScheduleSlots[0]},slotSize(){var t,e;const i=(t=this.resource.slotRanges)==null?void 0:t[0];return(e=i==null?void 0:i.slotSize)!=null?e:60},isMain:{get(){return this.resource.isMain},set(t){this.updateResource({isMain:t})}},isEditForm(){return this.resource.id!==null}},template:`\n\t\t<div class="resource-settings-card">\n\t\t\t<BaseFields\n\t\t\t\tdata-id="brcw-resource-settings-base"\n\t\t\t\t:initialResourceName="resourceName"\n\t\t\t\t:initialResourceType="resourceType"\n\t\t\t\t@nameUpdate="updateResourceName"\n\t\t\t\t@typeUpdate="updateResourceType"\n\t\t\t/>\n\t\t\t<ScheduleTypes\n\t\t\t\tdata-id="brcw-resource-settings-schedule-types"\n\t\t\t\tv-model="isMain"\n\t\t\t/>\n\t\t\t<WorkTime\n\t\t\t\tdata-id="brcw-resource-settings-work-time"\n\t\t\t\t:initialSlotRanges="slotRanges"\n\t\t\t\t:defaultSlotRange="defaultSlotRange"\n\t\t\t\t:isGlobalSchedule="isGlobalSchedule"\n\t\t\t\t:initialTimezone="initialTimezone"\n\t\t\t\t:currentTimezone="timezone"\n\t\t\t\t:isCompanyScheduleAccess="isCompanyScheduleAccess"\n\t\t\t\t:companyScheduleUrl="companyScheduleUrl"\n\t\t\t\t@update="updateSlotRanges"\n\t\t\t\t@updateGlobalSchedule="updateGlobalSchedule"\n\t\t\t\t@getGlobalSchedule="fetchData"\n\t\t\t/>\n\t\t\t<SlotLength\n\t\t\t\tdata-id="brcw-resource-settings-slot-length"\n\t\t\t\t:initialSelectedValue="slotSize"\n\t\t\t\t@select="updateSlotLength"\n\t\t\t/>\n\t\t</div>\n\t`};const Wt={components:{BIcon:O.BIcon,BMenu:S.BMenu},props:{value:{type:Number,required:true},items:{type:Array,required:true}},setup(){return{Actions:z.Actions}},data(){return{isMenuShown:false}},computed:{text(){return this.items.find((({value:t})=>t===this.value)).name},menuOptions(){return{id:"booking-resource-creation-wizard-label-dropdown-menu",bindElement:this.$refs.container,offsetTop:8,items:this.items.map((({name:t,value:e})=>({title:t,onClick:()=>this.$emit("update:value",e)}))),targetContainer:this.$root.$el.querySelector(".resource-creation-wizard__wrapper")}}},methods:{handleClick(){this.isMenuShown=true}},template:`\n\t\t<div class="booking-resource-creation-wizard-label-dropdown" ref="container" @click="handleClick">\n\t\t\t<span>{{ text }}</span>\n\t\t\t<BIcon :name="Actions.CHEVRON_DOWN"/>\n\t\t</div>\n\t\t<BMenu v-if="isMenuShown" :options="menuOptions" @close="isMenuShown = false"/>\n\t`};const xt={name:"ChannelMenu",emits:["popupShown","popupClosed","updateChannel"],props:{currentChannel:{type:String,default:null}},data(){return{ButtonSize:D.ButtonSize,ButtonColor:D.ButtonColor,ButtonIcon:D.ButtonIcon,menuPopup:null,channel:this.loc("BRCW_NOTIFICATION_CARD_MESSAGE_SELECT_WHA")}},computed:{...W.mapGetters({isChannelChoiceAvailable:`${P.Model.ResourceCreationWizard}/isChannelChoiceAvailable`}),popupId(){return"booking-choose-channel-menu"},notificationChannelOptions(){return[{label:this.loc("BRCW_NOTIFICATION_CARD_MESSAGE_SELECT_WHA"),value:P.NotificationChannel.WhatsApp},{label:this.loc("BRCW_NOTIFICATION_CARD_TEMPLATE_POPUP_SELECT_SMS_MSGVER_1"),value:P.NotificationChannel.Sms}]}},mounted(){var t;this.channel=((t=this.notificationChannelOptions.find((({value:t})=>t===this.currentChannel)))==null?void 0:t.label)||this.loc("BRCW_NOTIFICATION_CARD_MESSAGE_SELECT_WHA")},unmounted(){if(this.menuPopup){this.destroy()}},methods:{openMenu(){var t,e;if((t=this.menuPopup)!=null&&(e=t.popupWindow)!=null&&e.isShown()){this.destroy();return}const i=this.$refs["menu-button"];this.menuPopup=B.MenuManager.create(this.popupId,i,this.getMenuItems(),{className:"booking-choose-channel-menu",closeByEsc:true,autoHide:true,offsetTop:0,offsetLeft:i.offsetWidth-i.offsetWidth/2,angle:true,cacheable:true,targetContainer:document.querySelector("div.resource-creation-wizard__wrapper"),events:{onClose:()=>this.destroy(),onDestroy:()=>this.destroy()}});this.menuPopup.show();this.bindScrollEvent();this.$emit("popupShown")},getMenuItems(){return[{text:this.loc("BRCW_NOTIFICATION_CARD_MESSAGE_SELECT_WHA"),onclick:()=>{this.channel=this.loc("BRCW_NOTIFICATION_CARD_MESSAGE_SELECT_WHA");this.$emit("updateChannel",P.NotificationChannel.WhatsApp);this.destroy()}},{text:this.loc("BRCW_NOTIFICATION_CARD_TEMPLATE_POPUP_SELECT_SMS_MSGVER_1"),onclick:()=>{this.channel=this.loc("BRCW_NOTIFICATION_CARD_TEMPLATE_POPUP_SELECT_SMS_MSGVER_1");this.$emit("updateChannel",P.NotificationChannel.Sms);this.destroy()}}]},destroy(){B.MenuManager.destroy(this.popupId);this.unbindScrollEvent();this.$emit("popupClosed")},bindScrollEvent(){k.Event.bind(document,"scroll",this.adjustPosition,{capture:true})},unbindScrollEvent(){k.Event.unbind(document,"scroll",this.adjustPosition,{capture:true})},adjustPosition(){var t,e;(t=this.menuPopup)==null?void 0:(e=t.popupWindow)==null?void 0:e.adjustPosition()}},components:{Icon:O.BIcon},template:`\n\t\t<span\n\t\t\tclass="booking-resource-creation-wizard-channel-menu-button"\n\t\t\t:class="{'--disabled': !isChannelChoiceAvailable}"\n\t\t\tref="menu-button"\n\t\t\t@click="isChannelChoiceAvailable && openMenu()"\n\t\t>\n\t\t\t{{ channel }}\n\t\t</span>\n\t`};const Pt={name:"ResourceNotificationChooseTemplatePopup",emits:["close","templateTypeSelected"],props:{bindElement:{type:HTMLElement,required:true},model:{type:Object,required:true},currentChannel:{type:String,required:true},currentTemplateType:{type:String,required:true},buttonSize:{type:String,default:D.ButtonSize.EXTRA_SMALL},buttonColors:{type:Object,default:()=>({selected:D.ButtonColor.BASE_LIGHT,default:D.ButtonColor.PRIMARY})}},data(){return{IconSet:O.Set,messenger:P.NotificationChannel.WhatsApp,selectedTemplateType:this.currentTemplateType}},components:{Popup:A.Popup,ChannelMenu:xt,Icon:O.BIcon},beforeMount(){this.messenger=this.currentChannel},mounted(){this.adjustPosition();k.Event.bind(document,"scroll",this.adjustPosition,{capture:true})},beforeUnmount(){k.Event.unbind(document,"scroll",this.adjustPosition,{capture:true})},computed:{...W.mapGetters({templateTypes:`${P.Model.Dictionary}/getNotificationTemplates`}),popupId(){return`booking-resource-wizard-choose-template-popup-${k.Text.getRandom(4)}`},config(){var t,e;return{className:"booking-resource-wizard-choose-template-popup",bindElement:this.bindElement,bindOptions:{forceBindPosition:true,forceTop:true},width:350,offsetLeft:((t=(e=this.bindElement.childNodes[0])==null?void 0:e.offsetWidth)!=null?t:146)+10,offsetTop:-149,animation:"fading-slide",angle:{offset:120,position:"left"},angleBorderRadius:"4px 0",padding:15,targetContainer:document.querySelector("div.resource-creation-wizard__wrapper")}},getFormattedTime(){return L.DateTimeFormat.format(L.DateTimeFormat.getFormat("SHORT_TIME_FORMAT"),Date.now()/1e3)}},methods:{getMessageTemplate(t,e){const i=this.model.templates.find((t=>t.type===e));if(!i){return""}switch(t){case P.NotificationChannel.WhatsApp:return i.text;case P.NotificationChannel.Sms:return i.textSms;default:return""}},handleChannelChange(t){this.messenger=t},chooseType(t){this.selectedTemplateType=t;this.$emit("templateTypeSelected",this.selectedTemplateType)},adjustPosition(){this.$refs.popup.adjustPosition({forceBindPosition:true,forceTop:true})},getButtonText(t){return this.selectedTemplateType===t?this.loc("BRCW_NOTIFICATION_CARD_TEMPLATE_POPUP_BTN_SELECTED"):this.loc("BRCW_NOTIFICATION_CARD_TEMPLATE_POPUP_BTN_SELECT_TYPE")},getButtonColor(t){return this.selectedTemplateType===t?this.buttonColors.selected:this.buttonColors.default},getTemplateTitle(t){const e=Object.values(this.templateTypes).find((e=>e.value===t));return e?e.name:""}},template:`\n\t\t<Popup\n\t\t\tv-slot="{freeze, unfreeze}"\n\t\t\t:id="popupId"\n\t\t\t:config="config"\n\t\t\tref="popup"\n\t\t\t@close="$emit('close')"\n\t\t>\n\t\t\t<div class="booking-resource-wizard-choose-template-popup">\n\t\t\t\t<div class="booking-resource-wizard-choose-template-popup-header">\n\t\t\t\t\t<div class="booking-resource-wizard-choose-template-popup-header-title">\n\t\t\t\t\t\t{{ loc('BRCW_NOTIFICATION_CARD_TEMPLATE_POPUP_HEADER_TITLE') }}\n\t\t\t\t\t\t<ChannelMenu\n\t\t\t\t\t\t\t:current-channel="messenger"\n\t\t\t\t\t\t\t@popupShown="freeze"\n\t\t\t\t\t\t\t@popupClosed="unfreeze"\n\t\t\t\t\t\t\t@updateChannel="handleChannelChange"\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<Icon\n\t\t\t\t\t\t\t:class="['--close-btn']"\n\t\t\t\t\t\t\t:name="IconSet.CROSS_25"\n\t\t\t\t\t\t\t:color="'var(--ui-color-palette-gray-20)'"\n\t\t\t\t\t\t\t@click="$emit('close')"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="booking-resource-wizard-choose-template-popup-header-close-btn"></div>\n\t\t\t\t\t<div class="booking-resource-wizard-choose-template-popup-header-line"></div>\n\t\t\t\t</div>\n\t\t\t\t<div class="booking-resource-wizard-choose-template-popup-container">\n\t\t\t\t\t<div v-for="template in this.model.templates" :key="template.type"\n\t\t\t\t\t\t class="booking-resource-wizard-choose-template-popup-content">\n\t\t\t\t\t\t<div class="booking-resource-wizard-choose-template-popup-content-desc">\n\t\t\t\t\t\t\t{{ getTemplateTitle(template.type) }}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="booking-resource-wizard-choose-template-popup-content-msg-example">\n\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t:class="['booking-resource-wizard-choose-template-popup-content-msg-example-body', messenger]">\n\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\t:class="['booking-resource-wizard-choose-template-popup-content-msg-example-body-text', messenger]">\n\t\t\t\t\t\t\t\t\t<div v-html="getMessageTemplate(messenger, template.type)"></div>\n\t\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\t\t:class="['booking-resource-wizard-choose-template-popup-content-msg-example-body-text-time', messenger]">\n\t\t\t\t\t\t\t\t\t\t{{ getFormattedTime }}\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\t:class="['booking-resource-wizard-choose-template-popup-content-msg-example-body-text-tail', messenger]"></div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class="booking-resource-wizard-choose-template-popup-content-msg-example-actions">\n\t\t\t\t\t\t\t\t<Icon\n\t\t\t\t\t\t\t\t\t:name="IconSet.CIRCLE_CHECK"\n\t\t\t\t\t\t\t\t\t:color="'var(--ui-color-palette-green-55)'"\n\t\t\t\t\t\t\t\t\t:size="24"\n\t\t\t\t\t\t\t\t\tv-if="selectedTemplateType === template.type"\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\t\t:class="['ui-btn ui-btn-round', buttonSize, getButtonColor(template.type), {'--selected': selectedTemplateType === template.type}]"\n\t\t\t\t\t\t\t\t\ttype="button"\n\t\t\t\t\t\t\t\t\t@click="chooseType(template.type)"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t{{ getButtonText(template.type) }}\n\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</Popup>\n\t`};const Ft={template:`\n\t\t<div class="booking-resource-creation-wizard-message-template-empty">\n\t\t\t<div class="booking-resource-creation-wizard-message-template-empty-icon"></div>\n\t\t\t<div class="booking-resource-creation-wizard-message-template-empty-text">\n\t\t\t\t{{ loc('BRCW_MESSAGE_TEMPLATE_SOON_TEXT') }}\n\t\t\t</div>\n\t\t</div>\n\t`};const Ht={name:"ResourceNotificationCheckBoxRow",emits:["update:checked"],props:{checked:{type:Boolean,required:true},disabled:{type:Boolean,required:false,default:false}},template:`\n\t\t<label class="resource-creation-wizard__form-notification-text-row">\n\t\t\t<span class="resource-creation-wizard__form-notification-text-row-checkbox">\n\t\t\t\t<input\n\t\t\t\t\ttype="checkbox"\n\t\t\t\t\t:disabled="disabled"\n\t\t\t\t\t:checked="checked"\n\t\t\t\t\t@input="$emit('update:checked', $event.target.checked)"\n\t\t\t\t/>\n\t\t\t</span>\n\t\t\t<slot/>\n\t\t</label>\n\t`};const Gt={props:{type:{type:String,required:true},disabled:{type:Boolean,required:true}},computed:{isCheckedForAll:{get(){return this.$store.getters[`${P.Model.ResourceCreationWizard}/isCheckedForAll`](this.type)},set(t){this.$store.dispatch(`${P.Model.ResourceCreationWizard}/setCheckedForAll`,{type:this.type,isChecked:t})}}},components:{ResourceNotificationCheckBoxRow:Ht},template:`\n\t\t<ResourceNotificationCheckBoxRow\n\t\t\tv-model:checked="isCheckedForAll"\n\t\t\t:disabled="disabled"\n\t\t>\n\t\t\t<div class="resource-creation-wizard__form-notification-text">\n\t\t\t\t{{ loc('BRCW_NOTIFICATION_CARD_HELPER_TEXT_APPLY_FOR_ALL') }}\n\t\t\t</div>\n\t\t</ResourceNotificationCheckBoxRow>\n\t`};const Ut={name:"ResourceNotificationTextRow",props:{icon:{type:String,required:true}},template:`\n\t\t<div class="resource-creation-wizard__form-notification-text-row">\n\t\t\t<div :class="[icon, 'ui-icon-set', 'resource-creation-wizard__form-notification-text-row-icon']"></div>\n\t\t\t<div class="resource-creation-wizard__form-notification-text">\n\t\t\t\t<slot/>\n\t\t\t</div>\n\t\t</div>\n\t`};const Vt={props:{description:{type:String,required:true},helpDesk:{type:Object,required:true}},components:{HelpDeskLoc:M.HelpDeskLoc,ResourceNotificationTextRow:Ut},template:`\n\t\t<ResourceNotificationTextRow icon="--info-1">\n\t\t\t<HelpDeskLoc \n\t\t\t\t:message="description"\n\t\t\t\t:code="helpDesk.code"\n\t\t\t\t:anchor="helpDesk.anchorCode"\n\t\t\t/>\n\t\t</ResourceNotificationTextRow>\n\t`};const qt={components:{RichLoc:$.RichLoc},props:{text:{type:String,required:true}},computed:{preparedTemplate(){return this.text.replaceAll("\n","[br/]").replaceAll(/#(.+?)#/g,"[accent][[bold]$1[/bold]][/accent]")}},template:`\n\t\t<RichLoc\n\t\t\tclass="resource-creation-wizard__form-notification-info-template"\n\t\t\t:placeholder="['[accent]', '[br/]']"\n\t\t\t:text="preparedTemplate"\n\t\t>\n\t\t\t<template #accent="{ text: accentText }">\n\t\t\t\t<RichLoc tag="span" class="--accent" placeholder="[bold]" :text="accentText">\n\t\t\t\t\t<template #bold="{ text: boldText }">\n\t\t\t\t\t\t<span class="--bold">{{ boldText }}</span>\n\t\t\t\t\t</template>\n\t\t\t\t</RichLoc>\n\t\t\t</template>\n\t\t\t<template #br><br/></template>\n\t\t</RichLoc>\n\t`};const Xt={components:{BIcon:O.BIcon,Description:Vt,CyclePopup:F.CyclePopup,RichLoc:$.RichLoc},props:{text:{type:String,required:true},description:{type:String,required:true},helpDesk:{type:Object,required:true},scrollToCard:{type:String,default:null}},setup(){return{Main:z.Main}},data(){return{isPopupShown:false}},computed:{notificationText(){return this.text.replaceAll("\n","[br/]")}},template:`\n\t\t<div class="booking-resource-creation-wizard-notification --manager">\n\t\t\t<div class="booking-resource-creation-wizard-notification-main">\n\t\t\t\t<div class="resource-creation-wizard__form-notification-info-title-row">\n\t\t\t\t\t<BIcon :name="Main.BELL_1"/>\n\t\t\t\t\t<div class="resource-creation-wizard__form-notification-info-title">\n\t\t\t\t\t\t{{ loc('BRCW_NOTIFICATION_CARD_MANAGER') }}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="booking-resource-creation-wizard-manager-see" @click="isPopupShown = true">\n\t\t\t\t\t\t{{ loc('BRCW_NOTIFICATION_CARD_MANAGER_SEE') }}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class="resource-creation-wizard__form-notification-info">\n\t\t\t\t\t<div class="resource-creation-wizard__form-notification-info-text-row">\n\t\t\t\t\t\t{{ loc('BRCW_NOTIFICATION_CARD_MANAGER_TEXT') }}\n\t\t\t\t\t</div>\n\t\t\t\t\t<RichLoc\n\t\t\t\t\t\tclass="resource-creation-wizard__form-notification-info-template"\n\t\t\t\t\t\t:placeholder="'[br/]'"\n\t\t\t\t\t\t:text="notificationText"\n\t\t\t\t\t>\n\t\t\t\t\t\t<template #br><br/></template>\n\t\t\t\t\t</RichLoc>\n\t\t\t\t</div>\n\t\t\t\t<Description :description="description" :helpDesk="helpDesk"/>\n\t\t\t\t<slot/>\n\t\t\t</div>\n\t\t\t<CyclePopup v-if="isPopupShown" :scrollToCard="scrollToCard" @close="isPopupShown = false"/>\n\t\t</div>\n\t`};const jt=t=>new Promise((e=>setTimeout(e,t)));const Kt={name:"ResourceNotification",components:{Switcher:I.Switcher,BIcon:O.BIcon,UiButton:D.Button,Description:Vt,ChannelMenu:xt,ChooseTemplatePopup:Pt,TemplateEmpty:Ft,CheckedForAll:Gt,MessageTemplate:qt,ManagerNotification:Xt},directives:{hint:C.hint},props:{type:{type:String,required:true},title:{type:String,required:true},description:{type:String,required:true},helpDesk:{type:Object,required:true},checked:{type:Boolean,default:false},disabled:{type:Boolean,default:false},managerDescription:{type:String,default:""},scrollToCard:{type:String,default:null}},emits:["update:checked"],setup(){return{ButtonSize:D.ButtonSize,ButtonColor:D.ButtonColor,Actions:z.Actions,CRM:z.CRM}},data(){return{messenger:P.NotificationChannel.WhatsApp,showTemplatePopup:false}},computed:{...W.mapGetters({resource:`${P.Model.ResourceCreationWizard}/getResource`,isCurrentSenderAvailable:`${P.Model.Notifications}/isCurrentSenderAvailable`}),model(){return this.$store.getters[`${P.Model.Notifications}/getByType`](this.type)},template(){const t=this.resource[this.templateTypeField];return this.model.templates.find((e=>e.type===t))},messageTemplate(){var t,e,i,o,n;return(t={[P.NotificationChannel.WhatsApp]:(e=(i=this.template)==null?void 0:i.text)!=null?e:"",[P.NotificationChannel.Sms]:(o=(n=this.template)==null?void 0:n.textSms)!=null?o:""}[this.messenger])!=null?t:""},hasTemplate(){return this.isCurrentSenderAvailable&&this.messageTemplate},disableSwitcher(){return this.disabled||!this.isCurrentSenderAvailable||!this.template},templateTypeField(){return P.NotificationFieldsMap.TemplateType[this.type]},ordinal(){return P.NotificationFieldsMap.Ordinal[this.type]},soonHint(){return{text:this.loc("BRCW_BOOKING_SOON_HINT"),popupOptions:{offsetLeft:60,targetContainer:this.$root.$el.querySelector(".resource-creation-wizard__wrapper")}}}},created(){this.hintManager=BX.UI.Hint.createInstance({id:`brwc-notification-hint-${k.Text.getRandom(5)}`,popupParameters:{targetContainer:this.$root.$el.querySelector(".resource-creation-wizard__wrapper")}})},mounted(){this.hintManager.init(this.$el);void this.animateHeight(false)},updated(){this.hintManager.init(this.$el);void this.animateHeight(true)},methods:{handleChannelChange(t){this.messenger=t},handleTemplateTypeSelected(t){void this.$store.dispatch(`${P.Model.ResourceCreationWizard}/updateResource`,{[this.templateTypeField]:t})},getChooseTemplateButton(){return this.$refs.chooseTemplateBtn||null},expand(){void N.resourceCreationWizardService.updateNotificationExpanded(this.type,!this.model.isExpanded)},async animateHeight(t){var e;k.Dom.style(this.$el,"transition",null);if(t){await jt(10)}const i=this.$el.offsetHeight;k.Dom.style(this.$el,"height",null);if(!this.model.isExpanded){var o;k.Dom.style(this.$refs.main,"display","none");k.Dom.style((o=this.$refs.manager)==null?void 0:o.$el,"display","none")}const n=this.$el.offsetHeight;k.Dom.style(this.$refs.main,"display",null);k.Dom.style((e=this.$refs.manager)==null?void 0:e.$el,"display",null);k.Dom.style(this.$el,"height",`${i}px`);if(t){k.Dom.style(this.$el,"transition","height 0.2s");await jt(10);k.Dom.style(this.$el,"height",`${n}px`)}else{k.Dom.style(this.$el,"height",`${n}px`)}}},template:`\n\t\t<div class="booking-resource-creation-wizard-notification-container" :class="{'--disabled': !checked}">\n\t\t\t<div class="booking-resource-creation-wizard-notification">\n\t\t\t\t<div class="booking-resource-creation-wizard-notification-header" @click="expand">\n\t\t\t\t\t<div class="booking-resource-creation-wizard-notification-number">{{ ordinal }}</div>\n\t\t\t\t\t<div class="booking-resource-creation-wizard-notification-title">{{ title }}</div>\n\t\t\t\t\t<BIcon :name="model.isExpanded ? Actions.CHEVRON_UP : Actions.CHEVRON_DOWN"/>\n\t\t\t\t</div>\n\t\t\t\t<div class="booking-resource-creation-wizard-notification-main" ref="main">\n\t\t\t\t\t<div class="resource-creation-wizard__form-notification-info-title-row --main">\n\t\t\t\t\t\t<BIcon :name="CRM.CHAT_LINE"/>\n\t\t\t\t\t\t<div class="resource-creation-wizard__form-notification-info-title">\n\t\t\t\t\t\t\t{{ loc('BRCW_NOTIFICATION_CARD_MESSAGE') }}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<Switcher\n\t\t\t\t\t\t\tv-hint="disableSwitcher && soonHint"\n\t\t\t\t\t\t\tclass="resource-creation-wizard__form-notification-info-switcher"\n\t\t\t\t\t\t\t:data-id="'brcw-resource-notification-info-switcher-' + type"\n\t\t\t\t\t\t\t:model-value="checked"\n\t\t\t\t\t\t\t:disabled="disableSwitcher"\n\t\t\t\t\t\t\t@update:model-value="$emit('update:checked', $event)"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="resource-creation-wizard__form-notification-info --message">\n\t\t\t\t\t\t<div class="resource-creation-wizard__form-notification-info-text-row">\n\t\t\t\t\t\t\t{{ loc('BRCW_NOTIFICATION_CARD_MESSAGE_TEXT') }}\n\t\t\t\t\t\t\t<ChannelMenu\n\t\t\t\t\t\t\t\t:current-channel="messenger"\n\t\t\t\t\t\t\t\t@updateChannel="handleChannelChange"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<template v-if="hasTemplate">\n\t\t\t\t\t\t\t<MessageTemplate :text="messageTemplate"/>\n\t\t\t\t\t\t\t<div class="resource-creation-wizard__form-notification-info-template-choose-buttons">\n\t\t\t\t\t\t\t\t<div class="booking-resource-creation-wizard-choose-template-button" ref="chooseTemplateBtn">\n\t\t\t\t\t\t\t\t\t<UiButton\n\t\t\t\t\t\t\t\t\t\t:disabled="!checked"\n\t\t\t\t\t\t\t\t\t\t:text="loc('BRCW_NOTIFICATION_CARD_CHOOSE_TEMPLATE_TYPE')"\n\t\t\t\t\t\t\t\t\t\t:size="ButtonSize.EXTRA_SMALL"\n\t\t\t\t\t\t\t\t\t\t:color="ButtonColor.LIGHT_BORDER"\n\t\t\t\t\t\t\t\t\t\t:round="true"\n\t\t\t\t\t\t\t\t\t\t@click="showTemplatePopup = true"\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</template>\n\t\t\t\t\t\t<TemplateEmpty v-else/>\n\t\t\t\t\t\t<ChooseTemplatePopup\n\t\t\t\t\t\t\tv-if="showTemplatePopup"\n\t\t\t\t\t\t\t:bindElement="$refs.chooseTemplateBtn"\n\t\t\t\t\t\t\t:model="model"\n\t\t\t\t\t\t\t:current-channel="messenger"\n\t\t\t\t\t\t\t:currentTemplateType="resource[templateTypeField]"\n\t\t\t\t\t\t\t@templateTypeSelected="handleTemplateTypeSelected"\n\t\t\t\t\t\t\t@close="showTemplatePopup = false"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t\t<Description :description="description" :helpDesk="helpDesk"/>\n\t\t\t\t\t<slot name="client"/>\n\t\t\t\t\t<CheckedForAll :type="type" :disabled="!checked"/>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<ManagerNotification\n\t\t\t\tv-if="$slots.manager"\n\t\t\t\t:description="managerDescription"\n\t\t\t\t:text="model.managerNotification"\n\t\t\t\t:helpDesk="helpDesk"\n\t\t\t\t:scrollToCard="scrollToCard"\n\t\t\t\tref="manager"\n\t\t\t>\n\t\t\t\t<slot name="manager"/>\n\t\t\t</ManagerNotification>\n\t\t</div>\n\t`};const Yt={name:"ResourceNotificationCardBaseInfo",components:{ResourceNotification:Kt,ResourceNotificationTextRow:Ut,LabelDropdown:Wt,RichLoc:$.RichLoc},props:{model:{type:Object,required:true}},computed:{...W.mapGetters({resource:`${P.Model.ResourceCreationWizard}/getResource`,isCurrentSenderAvailable:`${P.Model.Notifications}/isCurrentSenderAvailable`}),isInfoNotificationOn:{get(){return this.isCurrentSenderAvailable&&this.resource.isInfoNotificationOn},set(t){void this.$store.dispatch(`${P.Model.ResourceCreationWizard}/updateResource`,{isInfoNotificationOn:t})}},infoNotificationDelay:{get(){return this.resource.infoNotificationDelay},set(t){void this.$store.dispatch(`${P.Model.ResourceCreationWizard}/updateResource`,{infoNotificationDelay:t});this.$refs.card.$forceUpdate()}},locInfoTimeSend(){return this.loc("BRCW_NOTIFICATION_CARD_BASE_INFO_HELPER_TEXT_SECOND").replace("#time#","[delay/]")},helpDesk(){return P.HelpDesk.ResourceNotificationInfo}},mounted(){if(_.ahaMoments.shouldShow(P.AhaMoment.MessageTemplate)){setTimeout((()=>this.showAhaMoment()),500)}},methods:{async showAhaMoment(){const t=this.$refs.card.getChooseTemplateButton();if(k.Type.isNull(t)){return}await _.ahaMoments.showGuide({id:"booking-message-template",title:this.loc("BOOKING_AHA_MESSAGE_TEMPLATE_TITLE"),text:this.loc("BOOKING_AHA_MESSAGE_TEMPLATE_TEXT"),article:P.HelpDesk.AhaMessageTemplate,target:this.$refs.card.getChooseTemplateButton(),targetContainer:this.$root.$el.querySelector(".resource-creation-wizard__wrapper")});_.ahaMoments.setShown(P.AhaMoment.MessageTemplate)}},template:`\n\t\t<ResourceNotification\n\t\t\tv-model:checked="isInfoNotificationOn"\n\t\t\t:type="model.type"\n\t\t\t:title="loc('BRCW_NOTIFICATION_CARD_BASE_INFO_TITLE_MSGVER_1')"\n\t\t\t:description="loc('BRCW_NOTIFICATION_CARD_BASE_INFO_HELPER_TEXT_FIRST_MSGVER_2')"\n\t\t\t:helpDesk="helpDesk"\n\t\t\tref="card"\n\t\t>\n\t\t\t<template #client>\n\t\t\t\t<ResourceNotificationTextRow icon="--clock-2">\n\t\t\t\t\t<RichLoc :text="locInfoTimeSend" :placeholder="'[delay/]'">\n\t\t\t\t\t\t<template #delay>\n\t\t\t\t\t\t\t<LabelDropdown v-model:value="infoNotificationDelay" :items="model.settings.notification.delayValues"/>\n\t\t\t\t\t\t</template>\n\t\t\t\t\t</RichLoc>\n\t\t\t\t</ResourceNotificationTextRow>\n\t\t\t</template>\n\t\t</ResourceNotification>\n\t`};const Qt={name:"ResourceNotificationCardConfirmation",components:{ResourceNotification:Kt,ResourceNotificationTextRow:Ut,LabelDropdown:Wt,RichLoc:$.RichLoc},props:{model:{type:Object,required:true}},setup(){return{HelpDesk:P.HelpDesk,CardId:F.CardId}},computed:{...W.mapGetters({resource:`${P.Model.ResourceCreationWizard}/getResource`,isCurrentSenderAvailable:`${P.Model.Notifications}/isCurrentSenderAvailable`}),isConfirmationNotificationOn:{get(){return this.isCurrentSenderAvailable&&this.resource.isConfirmationNotificationOn},set(t){void this.$store.dispatch(`${P.Model.ResourceCreationWizard}/updateResource`,{isConfirmationNotificationOn:t})}},confirmationNotificationDelay:{get(){return this.resource.confirmationNotificationDelay},set(t){void this.$store.dispatch(`${P.Model.ResourceCreationWizard}/updateResource`,{confirmationNotificationDelay:t});this.$refs.card.$forceUpdate()}},confirmationNotificationRepetitions:{get(){return this.resource.confirmationNotificationRepetitions},set(t){void this.$store.dispatch(`${P.Model.ResourceCreationWizard}/updateResource`,{confirmationNotificationRepetitions:t});this.$refs.card.$forceUpdate()}},confirmationNotificationRepetitionsInterval:{get(){return this.resource.confirmationNotificationRepetitionsInterval},set(t){void this.$store.dispatch(`${P.Model.ResourceCreationWizard}/updateResource`,{confirmationNotificationRepetitionsInterval:t});this.$refs.card.$forceUpdate()}},confirmationCounterDelay:{get(){return this.resource.confirmationCounterDelay},set(t){void this.$store.dispatch(`${P.Model.ResourceCreationWizard}/updateResource`,{confirmationCounterDelay:t});this.$refs.card.$forceUpdate()}},locSendMessageBefore(){return this.loc("BRCW_NOTIFICATION_CARD_CONFIRMATION_HELPER_TEXT_SECOND").replace("#days_before#","[delay/]")},locRetryMessage(){return this.loc("BRCW_NOTIFICATION_CARD_CONFIRMATION_HELPER_TEXT_THIRD").replace("#times#","[repeat/]").replace("#time_delay#","[repeatInterval/]")},locManagerRemindTime(){return this.loc("BRCW_NOTIFICATION_CARD_CONFIRMATION_MANAGER_REMIND_TIME").replace("#time#","[delay/]")}},template:`\n\t\t<ResourceNotification\n\t\t\tv-model:checked="isConfirmationNotificationOn"\n\t\t\t:type="model.type"\n\t\t\t:title="loc('BRCW_NOTIFICATION_CARD_CONFIRMATION_TITLE_MSGVER_2')"\n\t\t\t:description="loc('BRCW_NOTIFICATION_CARD_CONFIRMATION_HELPER_TEXT_FIRST_MSGVER_2')"\n\t\t\t:helpDesk="HelpDesk.ResourceNotificationConfirmation"\n\t\t\t:managerDescription="loc('BRCW_NOTIFICATION_CARD_CONFIRMATION_MANAGER_HELPER')"\n\t\t\t:scrollToCard="CardId.Unconfirmed"\n\t\t\tref="card"\n\t\t>\n\t\t\t<template #client>\n\t\t\t\t<ResourceNotificationTextRow icon="--clock-2">\n\t\t\t\t\t<RichLoc :text="locSendMessageBefore" :placeholder="'[delay/]'">\n\t\t\t\t\t\t<template #delay>\n\t\t\t\t\t\t\t<LabelDropdown v-model:value="confirmationNotificationDelay" :items="model.settings.notification.delayValues"/>\n\t\t\t\t\t\t</template>\n\t\t\t\t\t</RichLoc>\n\t\t\t\t</ResourceNotificationTextRow>\n\t\t\t\t<ResourceNotificationTextRow icon="--undo-1">\n\t\t\t\t\t<RichLoc :text="locRetryMessage" :placeholder="['[repeat/]', '[repeatInterval/]']">\n\t\t\t\t\t\t<template #repeat>\n\t\t\t\t\t\t\t<LabelDropdown v-model:value="confirmationNotificationRepetitions" :items="model.settings.notification.repeatValues"/>\n\t\t\t\t\t\t</template>\n\t\t\t\t\t\t<template #repeatInterval>\n\t\t\t\t\t\t\t<LabelDropdown v-model:value="confirmationNotificationRepetitionsInterval" :items="model.settings.notification.repeatIntervalValues"/>\n\t\t\t\t\t\t</template>\n\t\t\t\t\t</RichLoc>\n\t\t\t\t</ResourceNotificationTextRow>\n\t\t\t</template>\n\t\t\t<template #manager>\n\t\t\t\t<ResourceNotificationTextRow icon="--clock-2">\n\t\t\t\t\t<RichLoc :text="locManagerRemindTime" :placeholder="'[delay/]'">\n\t\t\t\t\t\t<template #delay>\n\t\t\t\t\t\t\t<LabelDropdown v-model:value="confirmationCounterDelay" :items="model.settings.counter.delayValues"/>\n\t\t\t\t\t\t</template>\n\t\t\t\t\t</RichLoc>\n\t\t\t\t</ResourceNotificationTextRow>\n\t\t\t</template>\n\t\t</ResourceNotification>\n\t`};const Zt={name:"ResourceNotificationCardReminder",components:{ResourceNotification:Kt,ResourceNotificationTextRow:Ut,LabelDropdown:Wt,RichLoc:$.RichLoc},props:{model:{type:Object,required:true}},computed:{...W.mapGetters({resource:`${P.Model.ResourceCreationWizard}/getResource`,isCurrentSenderAvailable:`${P.Model.Notifications}/isCurrentSenderAvailable`}),isReminderNotificationOn:{get(){return this.isCurrentSenderAvailable&&this.resource.isReminderNotificationOn},set(t){void this.$store.dispatch(`${P.Model.ResourceCreationWizard}/updateResource`,{isReminderNotificationOn:t})}},reminderNotificationDelay:{get(){return this.resource.reminderNotificationDelay},set(t){void this.$store.dispatch(`${P.Model.ResourceCreationWizard}/updateResource`,{reminderNotificationDelay:t});this.$refs.card.$forceUpdate()}},locSendReminderTime(){return this.loc("BRCW_NOTIFICATION_CARD_REMINDER_HELPER_TEXT_SECOND").replace("#time#","[delay/]")},helpDesk(){return P.HelpDesk.ResourceNotificationReminder}},template:`\n\t\t<ResourceNotification\n\t\t\tv-model:checked="isReminderNotificationOn"\n\t\t\t:type="model.type"\n\t\t\t:title="loc('BRCW_NOTIFICATION_CARD_REMINDER_TITLE')"\n\t\t\t:description="loc('BRCW_NOTIFICATION_CARD_REMINDER_HELPER_TEXT_FIRST_MSGVER_1')"\n\t\t\t:helpDesk="helpDesk"\n\t\t\tref="card"\n\t\t>\n\t\t\t<template #client>\n\t\t\t\t<ResourceNotificationTextRow icon="--clock-2">\n\t\t\t\t\t<RichLoc :text="locSendReminderTime" :placeholder="'[delay/]'">\n\t\t\t\t\t\t<template #delay>\n\t\t\t\t\t\t\t<LabelDropdown v-model:value="reminderNotificationDelay" :items="model.settings.notification.delayValues"/>\n\t\t\t\t\t\t</template>\n\t\t\t\t\t</RichLoc>\n\t\t\t\t</ResourceNotificationTextRow>\n\t\t\t</template>\n\t\t</ResourceNotification>\n\t`};const Jt={name:"ResourceNotificationCardFeedback",components:{ResourceNotification:Kt,ResourceNotificationTextRow:Ut,LabelDropdown:Wt,RichLoc:$.RichLoc},props:{model:{type:Object,required:true}},data(){return{labelValue:this.model.settings.notification.delayValues[0].value}},computed:{...W.mapGetters({resource:`${P.Model.ResourceCreationWizard}/getResource`,isCurrentSenderAvailable:`${P.Model.Notifications}/isCurrentSenderAvailable`}),isFeedbackNotificationOn:{get(){return false},set(t){void this.$store.dispatch(`${P.Model.ResourceCreationWizard}/updateResource`,{isFeedbackNotificationOn:t})}},locSendFeedbackTime(){return this.loc("BRCW_NOTIFICATION_CARD_FEEDBACK_HELPER_TEXT_SECOND").replace("#time#","[delay/]")},helpDesk(){return P.HelpDesk.ResourceNotificationFeedback}},template:`\n\t\t<ResourceNotification\n\t\t\tv-model:checked="isFeedbackNotificationOn"\n\t\t\t:type="model.type"\n\t\t\t:title="loc('BRCW_NOTIFICATION_CARD_FEEDBACK_TITLE')"\n\t\t\t:description="loc('BRCW_NOTIFICATION_CARD_FEEDBACK_HELPER_TEXT_FIRST_MSGVER_2')"\n\t\t\t:helpDesk="helpDesk"\n\t\t\t:disabled="true"\n\t\t>\n\t\t\t<template #client>\n\t\t\t\t<ResourceNotificationTextRow icon="--clock-2">\n\t\t\t\t\t<RichLoc :text="locSendFeedbackTime" :placeholder="'[delay/]'">\n\t\t\t\t\t\t<template #delay>\n\t\t\t\t\t\t\t<LabelDropdown v-model:value="labelValue" :items="model.settings.notification.delayValues"/>\n\t\t\t\t\t\t</template>\n\t\t\t\t\t</RichLoc>\n\t\t\t\t</ResourceNotificationTextRow>\n\t\t\t</template>\n\t\t</ResourceNotification>\n\t`};const te={name:"ResourceNotificationCardLate",components:{ResourceNotification:Kt,ResourceNotificationTextRow:Ut,LabelDropdown:Wt,RichLoc:$.RichLoc},props:{model:{type:Object,required:true}},setup(){return{HelpDesk:P.HelpDesk,CardId:F.CardId}},computed:{...W.mapGetters({resource:`${P.Model.ResourceCreationWizard}/getResource`,isCurrentSenderAvailable:`${P.Model.Notifications}/isCurrentSenderAvailable`}),isDelayedNotificationOn:{get(){return this.isCurrentSenderAvailable&&this.resource.isDelayedNotificationOn},set(t){void this.$store.dispatch(`${P.Model.ResourceCreationWizard}/updateResource`,{isDelayedNotificationOn:t})}},delayedNotificationDelay:{get(){return this.resource.delayedNotificationDelay},set(t){void this.$store.dispatch(`${P.Model.ResourceCreationWizard}/updateResource`,{delayedNotificationDelay:t});this.$refs.card.$forceUpdate()}},delayedCounterDelay:{get(){return this.resource.delayedCounterDelay},set(t){void this.$store.dispatch(`${P.Model.ResourceCreationWizard}/updateResource`,{delayedCounterDelay:t});this.$refs.card.$forceUpdate()}},locSendMessageAfter(){return this.loc("BRCW_NOTIFICATION_CARD_LATE_HELPER_TEXT_SECOND_MSGVER_1").replace("#time#","[delay/]")},locNotifyManagerIn(){return this.loc("BRCW_NOTIFICATION_CARD_LATE_MANAGER_NOTIFY_IN").replace("#time#","[delay/]")}},template:`\n\t\t<ResourceNotification\n\t\t\tv-model:checked="isDelayedNotificationOn"\n\t\t\t:type="model.type"\n\t\t\t:title="loc('BRCW_NOTIFICATION_CARD_LATE_TITLE_MSGVER_1')"\n\t\t\t:description="loc('BRCW_NOTIFICATION_CARD_LATE_HELPER_TEXT_FIRST_MSGVER_2')"\n\t\t\t:helpDesk="HelpDesk.ResourceNotificationLate"\n\t\t\t:managerDescription="loc('BRCW_NOTIFICATION_CARD_LATE_MANAGER_HELPER')"\n\t\t\t:scrollToCard="CardId.Late"\n\t\t\tref="card"\n\t\t>\n\t\t\t<template #client>\n\t\t\t\t<ResourceNotificationTextRow icon="--clock-2">\n\t\t\t\t\t<RichLoc :text="locSendMessageAfter" :placeholder="'[delay/]'">\n\t\t\t\t\t\t<template #delay>\n\t\t\t\t\t\t\t<LabelDropdown v-model:value="delayedNotificationDelay" :items="model.settings.notification.delayValues"/>\n\t\t\t\t\t\t</template>\n\t\t\t\t\t</RichLoc>\n\t\t\t\t</ResourceNotificationTextRow>\n\t\t\t</template>\n\t\t\t<template #manager>\n\t\t\t\t<ResourceNotificationTextRow icon="--clock-2">\n\t\t\t\t\t<RichLoc :text="locNotifyManagerIn" :placeholder="'[delay/]'">\n\t\t\t\t\t\t<template #delay>\n\t\t\t\t\t\t\t<LabelDropdown v-model:value="delayedCounterDelay" :items="model.settings.counter.delayValues"/>\n\t\t\t\t\t\t</template>\n\t\t\t\t\t</RichLoc>\n\t\t\t\t</ResourceNotificationTextRow>\n\t\t\t</template>\n\t\t</ResourceNotification>\n\t`};const ee={name:"ResourceNotificationCard",computed:{notificationViews(){return this.notifications.map((t=>{var e;return(e={[this.dictionary.Info.value]:{view:Yt,model:t},[this.dictionary.Confirmation.value]:{view:Qt,model:t},[this.dictionary.Reminder.value]:{view:Zt,model:t},[this.dictionary.Delayed.value]:{view:te,model:t},[this.dictionary.Feedback.value]:{view:Jt,model:t}}[t.type])!=null?e:{}}))},...W.mapGetters({notifications:`${P.Model.Notifications}/get`,dictionary:`${P.Model.Dictionary}/getNotifications`})},template:`\n\t\t<div class="resource-notification-card">\n\t\t\t<slot v-for="notification of notificationViews" :key="notification.view">\n\t\t\t\t<component\n\t\t\t\t\t:is="notification.view"\n\t\t\t\t\t:model="notification.model"\n\t\t\t\t\t:data-id="'brcw-resource-notification-view-' + notification.view"\n\t\t\t\t/>\n\t\t\t</slot>\n\t\t</div>\n\t`};const ie={name:"ResourceCreationWizardApp",components:{ResourceCreationWizardLayout:G,ResourceCreationWizardHeader:U,ResourceCreationWizardFooter:mt,ResourceCategoryCard:ft,ResourceSettingsCard:$t,ResourceNotificationCard:ee},data(){return{init:true}},computed:{...W.mapState({step:t=>t["resource-creation-wizard"].step,fetching:t=>t["resource-creation-wizard"].fetching}),...W.mapGetters("resource-creation-wizard",["invalidCurrentCard","resourceId"]),currentView(){const t=this.step||1;switch(t){case 2:return"ResourceSettingsCard";case 3:return"ResourceNotificationCard";default:return"ResourceCategoryCard"}},isEditForm(){return this.resourceId!==null}},async beforeMount(){await this.initApp()},methods:{...W.mapActions("resource-creation-wizard",["initState"]),...W.mapMutations("resource-creation-wizard",["prevStep","updateFetching","setGlobalSchedule"]),async initApp(){await this.initState();await this.loadWizardData();this.init=false},async loadWizardData(){try{this.updateFetching(true);await N.resourceCreationWizardService.fetchData()}catch(t){console.error("Loading wizard data error",t)}finally{this.updateFetching(false);if(!this.isEditForm){this.setGlobalSchedule(true)}}}},template:`\n\t\t<div id="booking-resource-creation-wizard" class="booking-resource-creation-wizard">\n\t\t\t<ResourceCreationWizardLayout :loading="fetching" :step>\n\t\t\t\t<template #header>\n\t\t\t\t\t<ResourceCreationWizardHeader/>\n\t\t\t\t</template>\n\t\t\t\t<template v-if="!init">\n\t\t\t\t\t<component :is="currentView"/>\n\t\t\t\t</template>\n\t\t\t\t<template #footer>\n\t\t\t\t\t<ResourceCreationWizardFooter :step/>\n\t\t\t\t</template>\n\t\t\t</ResourceCreationWizardLayout>\n\t\t</div>\n\t`};let oe=t=>t,ne;var se=babelHelpers.classPrivateFieldLooseKey("width");var re=babelHelpers.classPrivateFieldLooseKey("application");var ae=babelHelpers.classPrivateFieldLooseKey("makeName");var ce=babelHelpers.classPrivateFieldLooseKey("mountContent");var le=babelHelpers.classPrivateFieldLooseKey("initCore");var de=babelHelpers.classPrivateFieldLooseKey("makeContainer");class ue{constructor(){Object.defineProperty(this,de,{value:fe});Object.defineProperty(this,le,{value:he});Object.defineProperty(this,ce,{value:me});Object.defineProperty(this,re,{writable:true,value:null})}open(t=null){s.SidePanelInstance.open(babelHelpers.classPrivateFieldLooseBase(ue,ae)[ae](t),{width:babelHelpers.classPrivateFieldLooseBase(ue,se)[se],cacheable:false,events:{onClose:this.closeSidePanel.bind(this)},contentCallback:async()=>{await babelHelpers.classPrivateFieldLooseBase(this,le)[le](t);this.subscribe();const e=babelHelpers.classPrivateFieldLooseBase(this,de)[de]();babelHelpers.classPrivateFieldLooseBase(this,ce)[ce](e);return e}})}async closeSidePanel(){this.unsubscribe();babelHelpers.classPrivateFieldLooseBase(this,re)[re].unmount();babelHelpers.classPrivateFieldLooseBase(this,re)[re]=null;await a.Core.removeDynamicModule(P.Model.ResourceCreationWizard);await a.Core.removeDynamicModule(P.Model.Notifications)}subscribe(){k.Event.EventEmitter.subscribe(P.EventName.CloseWizard,this.close)}unsubscribe(){k.Event.EventEmitter.unsubscribe(P.EventName.CloseWizard,this.close)}close(){s.SidePanelInstance.close()}}function pe(t="new"){return`booking:resource-creation-wizard:${t||"new"}`}function me(t){const o=e.BitrixVue.createApp(ie,a.Core.getParams());o.mixin(i.locMixin);o.use(a.Core.getStore());o.mount(t);babelHelpers.classPrivateFieldLooseBase(this,re)[re]=o}async function he(t){try{await a.Core.init();await a.Core.addDynamicModule(n.ResourceCreationWizardModel.create().setVariables({resourceId:t}));await a.Core.addDynamicModule(o.Notifications.create())}catch(t){console.error("Init Resource creation wizard error",t)}}function fe(){return k.Tag.render(ne||(ne=oe`
			<div id="booking-resource-creation-wizard-app" class="booking-resource-creation-wizard-app"></div>
		`))}Object.defineProperty(ue,ae,{value:pe});Object.defineProperty(ue,se,{writable:true,value:600});t.ResourceCreationWizard=ue})(this.BX.Booking=this.BX.Booking||{},BX.Vue3,BX.Booking.Component.Mixin,BX.Booking.Model,BX.Booking.Model,BX.Booking.Lib,BX,BX.Booking,BX.UI.NotificationManager,BX.Crm.MessageSender,BX.Booking.Provider.Service,BX.Booking.Lib,BX.UI.EntitySelector,BX.Booking.Model,BX.Booking.Provider.Service,BX.Event,BX.Booking.Lib,BX.UI,BX.Booking.Lib,BX,BX.UI,BX.Booking.Lib,BX.UI.Vue3.Components,BX.Vue3.Directives,BX,BX,BX,BX.Booking.Component,BX.Booking.Provider.Service,BX.Main,BX,BX.Main,BX.Booking.Component,BX.Booking.Component,BX.Booking.Component,BX.UI.IconSet,BX.UI.IconSet,BX.UI.Vue3.Components,BX.Vue3.Vuex,BX,BX.Booking.Const,BX.Booking.Component);
//# sourceMappingURL=resource-creation-wizard.bundle.map.js