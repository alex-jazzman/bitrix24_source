{"version":3,"file":"counter-floating.bundle.js","sources":["../src/counter-floating-hint-popup.js","../src/counter-floating-limit-popup.js","../src/counter-floating.js"],"sourcesContent":["import { Loc } from 'main.core';\nimport type { PopupOptions } from 'main.popup';\n\nimport { Popup } from 'booking.component.popup';\nimport { AhaMoment } from 'booking.const';\nimport { ahaMoments } from 'booking.lib.aha-moments';\n\nimport './counter-floating-hint-popup.css';\n\n// @vue/component\nexport const CounterFloatingHintPopup = {\n\tname: 'CounterFloatingHintPopup',\n\tcomponents: {\n\t\tPopup,\n\t},\n\tprops: {\n\t\tcount: {\n\t\t\ttype: Number,\n\t\t\trequired: true,\n\t\t},\n\t\tbindElement: {\n\t\t\ttype: HTMLElement,\n\t\t\trequired: true,\n\t\t},\n\t},\n\temits: ['close'],\n\tcomputed: {\n\t\tpopupId(): string\n\t\t{\n\t\t\treturn 'booking-counter-floating-hint-popup';\n\t\t},\n\t\tconfig(): PopupOptions\n\t\t{\n\t\t\treturn {\n\t\t\t\tbindElement: this.bindElement,\n\t\t\t\tminWidth: 200,\n\t\t\t\toffsetTop: this.bindElement.offsetHeight * -1.1,\n\t\t\t\toffsetLeft: (this.bindElement.offsetWidth * -1) - 90,\n\t\t\t\tbackground: '#2878ca',\n\t\t\t\tpadding: 13,\n\t\t\t\tangle: {\n\t\t\t\t\toffset: 20,\n\t\t\t\t\tposition: 'right',\n\t\t\t\t},\n\t\t\t\tangleBorderRadius: '4px 0',\n\t\t\t};\n\t\t},\n\t\ttitle(): string\n\t\t{\n\t\t\treturn Loc.getMessagePlural('BOOKING_BOOKING_FILTER_COUNTER_FLOATING_AHA_MOMENT_TITLE', this.count, {\n\t\t\t\t'#COUNT#': this.count,\n\t\t\t});\n\t\t},\n\t},\n\tmethods: {\n\t\tclosePopup(): void\n\t\t{\n\t\t\tahaMoments.setShown(AhaMoment.SearchNavigation);\n\t\t\tthis.$emit('close');\n\t\t},\n\t},\n\ttemplate: `\n\t\t<Popup\n\t\t\t:id=\"popupId\"\n\t\t\t:config\n\t\t\tref=\"popup\"\n\t\t\t@close=\"closePopup\"\n\t\t>\n\t\t\t<div class=\"booking--booking--counter-floating-hint-popup-content\">\n\t\t\t\t<div class=\"booking--booking--counter-floating-hint-popup-content__title\">{{ title }}</div>\n\t\t\t\t<div class=\"booking--booking--counter-floating-hint-popup-content__subtitle\">\n\t\t\t\t\t{{ loc('BOOKING_BOOKING_FILTER_COUNTER_FLOATING_AHA_MOMENT_SUBTITLE') }}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</Popup>\n\t`,\n};\n","import type { PopupOptions } from 'main.popup';\n\nimport { Popup } from 'booking.component.popup';\n\nimport './counter-floating-limit-popup.css';\n\n// @vue/component\nexport const CounterFloatingLimitPopup = {\n\tname: 'CounterFloatingLimitPopup',\n\tcomponents: {\n\t\tPopup,\n\t},\n\tprops: {\n\t\tbindElement: {\n\t\t\ttype: HTMLElement,\n\t\t\trequired: true,\n\t\t},\n\t},\n\temits: ['close'],\n\tcomputed: {\n\t\tpopupId(): string\n\t\t{\n\t\t\treturn 'booking-counter-floating-limit-popup';\n\t\t},\n\t\tconfig(): PopupOptions\n\t\t{\n\t\t\treturn {\n\t\t\t\tbindElement: this.bindElement,\n\t\t\t\tminWidth: 200,\n\t\t\t\toffsetTop: this.bindElement.offsetHeight * -1.1,\n\t\t\t\toffsetLeft: (this.bindElement.offsetWidth * -1) - 85,\n\t\t\t\tbackground: '#2878ca',\n\t\t\t\tpadding: 13,\n\t\t\t\tangle: {\n\t\t\t\t\toffset: 20,\n\t\t\t\t\tposition: 'right',\n\t\t\t\t},\n\t\t\t\tangleBorderRadius: '4px 0',\n\t\t\t};\n\t\t},\n\t},\n\ttemplate: `\n\t\t<Popup\n\t\t\t:id=\"popupId\"\n\t\t\t:config\n\t\t\tref=\"popup\"\n\t\t\t@close=\"$emit('close')\"\n\t\t>\n\t\t\t<div class=\"booking--booking--counter-floating-limit-popup-content\">\n\t\t\t\t<div class=\"booking--booking--counter-floating-limit-popup-content__title\">\n\t\t\t\t\t{{ loc('BOOKING_BOOKING_FILTER_COUNTER_FLOATING_LIMIT_POPUP_TITLE') }}\n\t\t\t\t</div>\n\t\t\t\t<div class=\"booking--booking--counter-floating-limit-popup-content__subtitle\">\n\t\t\t\t\t{{ loc('BOOKING_BOOKING_FILTER_COUNTER_FLOATING_LIMIT_POPUP_SUBTITLE') }}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</Popup>\n\t`,\n};\n","import { Loc } from 'main.core';\nimport { mapGetters } from 'ui.vue3.vuex';\nimport { BIcon, Outline } from 'ui.icon-set.api.vue';\n\nimport { AhaMoment, Model } from 'booking.const';\nimport { ahaMoments } from 'booking.lib.aha-moments';\nimport { filterResultNavigator } from 'booking.lib.filter-result-navigator';\nimport { CounterFloatingHintPopup } from './counter-floating-hint-popup';\nimport { CounterFloatingLimitPopup } from './counter-floating-limit-popup';\n\nimport './style.css';\n\nconst ANIMATION_TIME_MS = 500;\nconst LIMIT_POPUP_TIME_MS = 5000;\n\n// @vue/component\nexport const CounterFloating = {\n\tname: 'UiCounterFloating',\n\tcomponents: {\n\t\tBIcon,\n\t\tCounterFloatingHintPopup,\n\t\tCounterFloatingLimitPopup,\n\t},\n\tprops: {\n\t\tcount: {\n\t\t\ttype: [String, Number],\n\t\t\tdefault: '',\n\t\t},\n\t},\n\temits: ['previous', 'next'],\n\tsetup(): CounterFloatingSetupObject\n\t{\n\t\tconst iconColor = 'var(--ui-color-base-8)';\n\t\tconst iconSize = 16;\n\n\t\treturn {\n\t\t\tOutline,\n\t\t\ticonColor,\n\t\t\ticonSize,\n\t\t};\n\t},\n\tdata(): CounterFloatingData\n\t{\n\t\treturn {\n\t\t\tshownAha: false,\n\t\t\tshownLimitPopup: false,\n\t\t\tshownLimitAnimation: false,\n\t\t\tlimitPopupTimeoutId: null,\n\t\t};\n\t},\n\tcomputed: {\n\t\t...mapGetters({\n\t\t\tisMaxFilterDate: `${Model.Filter}/isMaxFilterDate`,\n\t\t\tisMinFilterDate: `${Model.Filter}/isMinFilterDate`,\n\t\t\tselectedDateTs: `${Model.Interface}/selectedDateTs`,\n\t\t}),\n\t\tfilterCount(): string\n\t\t{\n\t\t\treturn Loc.getMessagePlural('BOOKING_BOOKING_FILTER_COUNTER_FLOATING_COUNT', this.count, {\n\t\t\t\t'#COUNT#': this.count,\n\t\t\t});\n\t\t},\n\t},\n\tmounted(): void\n\t{\n\t\tif (this.count > 0 && this.$refs.container && ahaMoments.shouldShow(AhaMoment.SearchNavigation))\n\t\t{\n\t\t\tsetTimeout(() => {\n\t\t\t\tthis.shownAha = true;\n\t\t\t}, 300);\n\t\t}\n\t},\n\tmethods: {\n\t\tasync setSelectedDateTs(nextSelectedDateTs: number): Promise<void>\n\t\t{\n\t\t\tif (!nextSelectedDateTs)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tawait this.$store.dispatch(`${Model.Interface}/setSelectedDateTs`, nextSelectedDateTs);\n\t\t},\n\t\tasync previous(): void\n\t\t{\n\t\t\tif (this.isMinFilterDate)\n\t\t\t{\n\t\t\t\tthis.startLimitAnimation();\n\t\t\t\tthis.showLimitPopup();\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst previousDateTs = await filterResultNavigator.getPreviousFilterDateTs();\n\t\t\tif (previousDateTs)\n\t\t\t{\n\t\t\t\tawait this.setSelectedDateTs(previousDateTs);\n\t\t\t}\n\t\t},\n\t\tasync next(): void\n\t\t{\n\t\t\tif (this.isMaxFilterDate)\n\t\t\t{\n\t\t\t\tthis.startLimitAnimation();\n\t\t\t\tthis.showLimitPopup();\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst nextFilterDateTs = await filterResultNavigator.getNextFilterDateTs();\n\t\t\tif (nextFilterDateTs)\n\t\t\t{\n\t\t\t\tawait this.setSelectedDateTs(nextFilterDateTs);\n\t\t\t}\n\t\t},\n\t\tshowLimitPopup(): void\n\t\t{\n\t\t\tif (this.shownLimitPopup)\n\t\t\t{\n\t\t\t\tclearTimeout(this.limitPopupTimeoutId);\n\t\t\t\tthis.shownLimitPopup = false;\n\t\t\t}\n\n\t\t\tthis.$nextTick(() => {\n\t\t\t\tthis.shownLimitPopup = true;\n\n\t\t\t\tthis.limitPopupTimeoutId = setTimeout(() => {\n\t\t\t\t\tthis.shownLimitPopup = false;\n\t\t\t\t}, LIMIT_POPUP_TIME_MS);\n\t\t\t});\n\t\t},\n\t\tstartLimitAnimation(): void\n\t\t{\n\t\t\tthis.shownLimitAnimation = true;\n\n\t\t\tsetTimeout(() => {\n\t\t\t\tthis.shownLimitAnimation = false;\n\t\t\t}, ANIMATION_TIME_MS);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div ref=\"container\" class=\"booking-booking-counter-floating\">\n\t\t\t<div :class=\"['booking--booking--counter-floating_row', {\n\t\t\t\t'--twitching': shownLimitAnimation,\n\t\t\t}]\">\n\t\t\t\t<div class=\"booking-booking-counter-floating-text\">\n\t\t\t\t\t{{ filterCount }}\n\t\t\t\t</div>\n\t\t\t\t<div class=\"booking-booking-counter-floating-buttons\">\n\t\t\t\t\t<div\n\t\t\t\t\t\t:class=\"{\n\t\t\t\t\t\t\t'booking-booking-counter-floating-action-button': true,\n\t\t\t\t\t\t\t'--disabled': isMinFilterDate,\n\t\t\t\t\t\t}\"\n\t\t\t\t\t\t@click=\"previous\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<BIcon :name=\"Outline.CHEVRON_LEFT_L\" :size=\"iconSize\" :color=\"iconColor\"/>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div\n\t\t\t\t\t\t:class=\"{\n\t\t\t\t\t\t\t'booking-booking-counter-floating-action-button': true,\n\t\t\t\t\t\t\t'--disabled': isMaxFilterDate\n\t\t\t\t\t\t}\"\n\t\t\t\t\t\t@click=\"next\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<BIcon :name=\"Outline.CHEVRON_RIGHT_L\" :size=\"iconSize\" :color=\"iconColor\"/>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<template v-if=\"shownAha\">\n\t\t\t\t<CounterFloatingHintPopup :count=\"count\" :bindElement=\"$refs.container\" @close=\"shownAha = false\"/>\n\t\t\t</template>\n\t\t\t<template v-if=\"shownLimitPopup\">\n\t\t\t\t<CounterFloatingLimitPopup :bindElement=\"$refs.container\"/>\n\t\t\t</template>\n\t\t</div>\n\t`,\n};\n\ntype CounterFloatingSetupObject = {\n\ticonColor: string,\n\ticonSize: number,\n\tOutline: { [key: string]: string }\n}\n\ntype CounterFloatingData = {\n\tshownAha: boolean;\n\tshownLimitPopup: boolean;\n\tshownLimitAnimation: boolean;\n\tlimitPopupTimeoutId: number | null;\n}\n"],"names":["CounterFloatingHintPopup","name","components","Popup","props","count","type","Number","required","bindElement","HTMLElement","emits","computed","popupId","config","this","minWidth","offsetTop","offsetHeight","offsetLeft","offsetWidth","background","padding","angle","offset","position","angleBorderRadius","title","Loc","getMessagePlural","#COUNT#","methods","closePopup","ahaMoments","setShown","AhaMoment","SearchNavigation","$emit","template","CounterFloatingLimitPopup","CounterFloating","BIcon","String","default","setup","Outline","iconColor","iconSize","data","shownAha","shownLimitPopup","shownLimitAnimation","limitPopupTimeoutId","mapGetters","isMaxFilterDate","Model","Filter","isMinFilterDate","selectedDateTs","Interface","filterCount","mounted","$refs","container","shouldShow","setTimeout","_this","setSelectedDateTs","nextSelectedDateTs","_context","_this2","$store","dispatch","previous","_this3","_context2","startLimitAnimation","showLimitPopup","filterResultNavigator","getPreviousFilterDateTs","previousDateTs","next","_this4","_context3","getNextFilterDateTs","nextFilterDateTs","clearTimeout","$nextTick","_this5","_this6"],"mappings":"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"}