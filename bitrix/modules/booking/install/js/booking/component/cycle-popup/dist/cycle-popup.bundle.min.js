this.BX=this.BX||{};this.BX.Booking=this.BX.Booking||{};(function(t,e,i,o,n,p,c,s,l,r,d,a,u){"use strict";const v=Object.freeze({Default:"default",Unconfirmed:"unconfirmed",Confirmed:"confirmed",Late:"late",Waitlist:"waitlist",Overbooking:"overbooking"});const O={props:{segments:{type:Array,required:true},selectedSegmentId:{type:String,required:true}},emits:["update:selectedSegmentId"],template:`\n\t\t<div class="booking-cycle-popup-segment-button">\n\t\t\t<template v-for="segment of segments" :key="segment.title">\n\t\t\t\t<div\n\t\t\t\t\tclass="booking-cycle-popup-segment"\n\t\t\t\t\t:class="{ '--selected': segment.id === selectedSegmentId }"\n\t\t\t\t\t@click="$emit('update:selectedSegmentId', segment.id)"\n\t\t\t\t>\n\t\t\t\t\t{{ segment.title }}\n\t\t\t\t</div>\n\t\t\t</template>\n\t\t</div>\n\t`};const C={template:`\n\t\t<div class="booking-cycle-popup-preview-booking">\n\t\t\t<div class="booking-cycle-popup-preview-booking-title">{{ loc('BOOKING_CYCLE_POPUP_CLIENT') }}</div>\n\t\t\t<slot/>\n\t\t</div>\n\t`};const P={components:{BookingCard:C,BIcon:o.BIcon,UiCounter:s.Counter},props:{type:{type:String,required:true}},setup(){return{Main:n.Main,Outline:n.Outline,CounterSize:s.CounterSize,CounterColor:s.CounterColor,CardId:v}},template:`\n\t\t<div>\n\t\t\t<template v-if="type === CardId.Overbooking">\n\t\t\t\t<BookingCard class="--left"/>\n\t\t\t\t<BookingCard class="--right"/>\n\t\t\t</template>\n\t\t\t<BookingCard v-else :class="'--' + type">\n\t\t\t\t<div class="booking-cycle-popup-preview-booking-row">\n\t\t\t\t\t<div class="booking-cycle-popup-preview-booking-row-line"></div>\n\t\t\t\t\t<div class="booking-cycle-popup-preview-booking-icons">\n\t\t\t\t\t\t<BIcon :name="Outline.PHONE_UP"/>\n\t\t\t\t\t\t<BIcon :name="Outline.CHATS"/>\n\t\t\t\t\t\t<BIcon :name="Outline.CRM_LETTERS"/>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class="booking-cycle-popup-preview-counter">\n\t\t\t\t\t<UiCounter\n\t\t\t\t\t\tv-if="[CardId.Unconfirmed, CardId.Late].includes(type)"\n\t\t\t\t\t\t:value="1"\n\t\t\t\t\t\t:color="CounterColor.DANGER"\n\t\t\t\t\t\t:size="CounterSize.MEDIUM"\n\t\t\t\t\t\t:border="true"\n\t\t\t\t\t/>\n\t\t\t\t\t<div v-if="type === CardId.Confirmed" class="booking-cycle-popup-preview-counter-icon">\n\t\t\t\t\t\t<BIcon :name="Main.CHECK"/>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div v-if="type === CardId.Late" class="booking-cycle-popup-preview-line"></div>\n\t\t\t</BookingCard>\n\t\t</div>\n\t`};const g={props:{type:{type:String,required:true}},setup(){return{CardId:v}},computed:{title(){var t;return(t={[v.Waitlist]:this.loc("BOOKING_CYCLE_POPUP_BOOKING_WAITLIST"),[v.Overbooking]:this.loc("BOOKING_CYCLE_POPUP_BOOKING_OVERBOOKING")}[this.type])!=null?t:this.loc("BOOKING_CYCLE_POPUP_BOOKING")},fields(){if(this.type===v.Waitlist){return[this.loc("BOOKING_CYCLE_POPUP_CLIENT")]}return[this.loc("BOOKING_CYCLE_POPUP_DATE_TIME"),this.loc("BOOKING_CYCLE_POPUP_RESOURCE")]},day(){return l.DateTimeFormat.format("d")}},template:`\n\t\t<div class="booking-cycle-popup-preview-crm" :class="'--' + type">\n\t\t\t<div class="booking-cycle-popup-preview-crm-header">\n\t\t\t\t<div class="booking-cycle-popup-preview-crm-checkbox"></div>\n\t\t\t\t<div class="booking-cycle-popup-preview-crm-title">{{ title }}</div>\n\t\t\t\t<div v-if="[CardId.Unconfirmed, CardId.Late].includes(type)" class="booking-cycle-popup-preview-crm-pill"></div>\n\t\t\t</div>\n\t\t\t<div class="booking-cycle-popup-preview-crm-main">\n\t\t\t\t<div class="booking-cycle-popup-preview-calendar-container">\n\t\t\t\t\t<div class="booking-cycle-popup-preview-calendar">\n\t\t\t\t\t\t<div class="booking-cycle-popup-preview-calendar-header"></div>\n\t\t\t\t\t\t<div class="booking-cycle-popup-preview-calendar-content">\n\t\t\t\t\t\t\t<div v-if="type === CardId.Waitlist" class="booking-cycle-popup-preview-calendar-days"></div>\n\t\t\t\t\t\t\t<template v-else>\n\t\t\t\t\t\t\t\t<div class="booking-cycle-popup-preview-calendar-day">{{ day }}</div>\n\t\t\t\t\t\t\t\t<div class="booking-cycle-popup-preview-calendar-line"></div>\n\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class="booking-cycle-popup-preview-crm-fields">\n\t\t\t\t\t<template v-for="field of fields" :key="field">\n\t\t\t\t\t\t<div class="booking-cycle-popup-preview-crm-field-title">{{ field }}</div>\n\t\t\t\t\t\t<div class="booking-cycle-popup-preview-crm-field-value"></div>\n\t\t\t\t\t</template>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t`};const _={components:{Booking:P,Crm:g},props:{mode:{type:String,required:true},type:{type:String,required:true}},computed:{isBooking(){return this.mode===i.Module.Booking}},template:`\n\t\t<div class="booking-cycle-popup-card-preview">\n\t\t\t<Booking v-if="isBooking" :type="type"/>\n\t\t\t<Crm v-else :type="type"/>\n\t\t</div>\n\t`};const m={components:{SegmentButton:O,Preview:_},inject:["context"],props:{id:{type:String,required:true},title:{type:String,required:true},description:{type:String,required:true}},data(){var t;return{previewMode:(t=this.context)!=null?t:i.Module.Booking}},computed:{segments(){return[{id:i.Module.Booking,title:this.loc("BOOKING_CYCLE_POPUP_SEE_BOOKING")},{id:i.Module.Crm,title:this.loc("BOOKING_CYCLE_POPUP_SEE_CRM")}]}},template:`\n\t\t<div class="booking-cycle-popup-card" :data-card-id="id">\n\t\t\t<div class="booking-cycle-popup-card-main">\n\t\t\t\t<div class="booking-cycle-popup-card-title">{{ title }}</div>\n\t\t\t\t<div class="booking-cycle-popup-description">{{ description }}</div>\n\t\t\t\t<div class="booking-cycle-popup-choose-preview">\n\t\t\t\t\t<div class="booking-cycle-popup-see-how">{{ loc('BOOKING_CYCLE_POPUP_SEE_HOW') }}</div>\n\t\t\t\t\t<SegmentButton v-model:selectedSegmentId="previewMode" :segments="segments"/>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<Preview :mode="previewMode" :type="id"/>\n\t\t</div>\n\t`};const I={components:{Card:m},props:{id:{type:String,required:true},ordinal:{type:Number,required:true},title:{type:String,required:true},cards:{type:Array,required:true}},template:`\n\t\t<div class="booking-cycle-popup-step" :data-step-id="id">\n\t\t\t<div class="booking-cycle-popup-step-header">\n\t\t\t\t<div class="booking-cycle-popup-step-number">{{ ordinal }}</div>\n\t\t\t\t<div class="booking-cycle-popup-step-title">{{ title }}</div>\n\t\t\t</div>\n\t\t\t<template v-for="(card, index) of cards" :key="index">\n\t\t\t\t<Card\n\t\t\t\t\t:id="card.id"\n\t\t\t\t\t:title="card.title"\n\t\t\t\t\t:description="card.description"\n\t\t\t\t/>\n\t\t\t</template>\n\t\t</div>\n\t`};const y={components:{Step:I},provide(){return{context:this.context}},props:{context:{type:String,default:null},scrollToCard:{type:String,default:null}},emits:["close"],computed:{steps(){return[{id:"booked",title:this.loc("BOOKING_CYCLE_POPUP_BOOKED"),cards:[{id:v.Default,title:this.loc("BOOKING_CYCLE_POPUP_NEW_TITLE"),description:this.loc("BOOKING_CYCLE_POPUP_NEW_DESCRIPTION")},{id:v.Unconfirmed,title:this.loc("BOOKING_CYCLE_POPUP_UNCONFIRMED_TITLE"),description:this.loc("BOOKING_CYCLE_POPUP_UNCONFIRMED_DESCRIPTION")}]},{id:"confirmed",title:this.loc("BOOKING_CYCLE_POPUP_CONFIRMED_MSGVER1"),cards:[{id:v.Confirmed,title:this.loc("BOOKING_CYCLE_POPUP_CONFIRMED_TITLE"),description:this.loc("BOOKING_CYCLE_POPUP_CONFIRMED_DESCRIPTION")}]},{id:"late",title:this.loc("BOOKING_CYCLE_POPUP_LATE_MSGVER1"),cards:[{id:v.Late,title:this.loc("BOOKING_CYCLE_POPUP_LATE_TITLE_MSGVER1"),description:this.loc("BOOKING_CYCLE_POPUP_LATE_DESCRIPTION")}]},{id:"waitlist",title:this.loc("BOOKING_CYCLE_POPUP_WAITLIST"),cards:[{id:v.Waitlist,title:this.loc("BOOKING_CYCLE_POPUP_WAITLIST_TITLE_MSGVER1"),description:this.loc("BOOKING_CYCLE_POPUP_WAITLIST_DESCRIPTION")}]},{id:"overbooking",title:this.loc("BOOKING_CYCLE_POPUP_OVERBOOKING"),cards:[{id:v.Overbooking,title:this.loc("BOOKING_CYCLE_POPUP_OVERBOOKING_TITLE_MSGVER1"),description:this.loc("BOOKING_CYCLE_POPUP_OVERBOOKING_DESCRIPTION_MSGVER1")}]}]}},mounted(){setTimeout((()=>{var t;this.$refs.scrollable.scroll({top:(t=this.getScrollElement(this.scrollToCard))==null?void 0:t.offsetTop,behavior:"smooth"})}))},methods:{getScrollElement(t){const e=this.steps.find((e=>e.cards.some((e=>e.id===t))));if((e==null?void 0:e.cards.length)===1){return this.$refs.container.querySelector(`[data-step-id="${e.id}"]`)}return this.$refs.container.querySelector(`[data-card-id="${t}"]`)}},template:`\n\t\t<div class="booking-cycle-popup" ref="container">\n\t\t\t<div class="booking-cycle-popup-header">\n\t\t\t\t<div class="booking-cycle-popup-title">{{ loc('BOOKING_CYCLE_POPUP_TITLE') }}</div>\n\t\t\t\t<div class="booking-cycle-popup-description">{{ loc('BOOKING_CYCLE_POPUP_DESCRIPTION') }}</div>\n\t\t\t</div>\n\t\t\t<div class="booking-cycle-popup-main" ref="scrollable">\n\t\t\t\t<template v-for="(step, index) of steps" :key="index">\n\t\t\t\t\t<Step\n\t\t\t\t\t\t:id="step.id"\n\t\t\t\t\t\t:ordinal="index + 1"\n\t\t\t\t\t\t:title="step.title"\n\t\t\t\t\t\t:cards="step.cards"\n\t\t\t\t\t/>\n\t\t\t\t</template>\n\t\t\t</div>\n\t\t</div>\n\t`};const B=Object.freeze({popupOptions:{id:"booking-cycle-popup",width:540,height:500,padding:20,overlay:true,cacheable:false,autoHide:true,closeByEsc:true,animation:"fading",closeIcon:{top:"14px",right:"14px"}}});const E={components:{Popup:e.Popup,CyclePopupContent:y},props:{scrollToCard:{type:String,default:null}},emits:["close"],setup(){return{meta:B}},template:`\n\t\t<Popup :options="meta.popupOptions" @close="$emit('close')">\n\t\t\t<CyclePopupContent :scrollToCard="scrollToCard"/>\n\t\t</Popup>\n\t`};var k=babelHelpers.classPrivateFieldLooseKey("application");class b{constructor(){Object.defineProperty(this,k,{writable:true,value:null})}show(t){new d.Popup({...B.popupOptions,events:{onAfterPopupShow:e=>{babelHelpers.classPrivateFieldLooseBase(this,k)[k]=a.BitrixVue.createApp(y,t);babelHelpers.classPrivateFieldLooseBase(this,k)[k].mixin(u.locMixin);const{$el:i}=babelHelpers.classPrivateFieldLooseBase(this,k)[k].mount(r.Dom.create("div"));e.getContentContainer().replaceWith(i)},onPopupAfterClose:()=>{babelHelpers.classPrivateFieldLooseBase(this,k)[k].unmount()}}}).show()}}const h=new b;t.CyclePopup=E;t.CardId=v;t.cyclePopupOpener=h})(this.BX.Booking.Component=this.BX.Booking.Component||{},BX.UI.Vue3.Components,BX.Booking.Const,BX.UI.IconSet,BX.UI.IconSet,BX,BX,BX.Booking.Component,BX.Main,BX,BX.Main,BX.Vue3,BX.Vue3.Mixins);
//# sourceMappingURL=cycle-popup.bundle.map.js