this.BX=this.BX||{};this.BX.Booking=this.BX.Booking||{};(function(t,o,e,n,i,s,d){"use strict";const u={name:"NotePopup",emits:["save","close"],props:{id:{type:[Number,String],required:true},text:{type:String,default:""},bindElement:{type:Function,required:true},isEditMode:{type:Boolean,required:true},dataId:{type:[String,Number],default:""},dataElementPrefix:{type:String,default:""}},setup(){const t=d.ButtonSize;const o=d.ButtonColor;const e=n.ref("");const s=new i.Resolvable;return{buttonColor:o,buttonSize:t,mountedPromise:s,note:e}},beforeCreate(){const t=`booking-booking-note-popup-${this.id}`;e.PopupManager.getPopups().filter((o=>o.getId()===t)).forEach((t=>t.destroy()))},created(){this.note=this.text},mounted(){this.mountedPromise.resolve();this.adjustPosition();this.focusOnTextarea();o.Event.bind(document,"scroll",this.adjustPosition,true)},beforeUnmount(){o.Event.unbind(document,"scroll",this.adjustPosition,true)},computed:{popupId(){return`booking-booking-note-popup-${this.id}`},config(){return{className:"booking-booking-note-popup",bindElement:this.bindElement(),minWidth:this.bindElement().offsetWidth,height:120,offsetTop:-10,background:"var(--ui-color-background-note)",bindOptions:{forceBindPosition:true,position:"top"},autoHide:this.isEditMode}}},methods:{closePopup(){this.$emit("close")},saveNote(){if(this.text!==this.note){this.$emit("save",{id:this.id,note:this.note})}this.closePopup()},onMouseDown(){o.Event.unbind(window,"mouseup",this.onMouseUp);o.Event.bind(window,"mouseup",this.onMouseUp);this.setAutoHide(false)},onMouseUp(){o.Event.unbind(window,"mouseup",this.onMouseUp);setTimeout((()=>this.setAutoHide(this.isEditMode)),0)},setAutoHide(t){var o,e;(o=this.$refs.popup)==null?void 0:(e=o.getPopupInstance())==null?void 0:e.setAutoHide(t)},adjustPosition(){this.$refs.popup.adjustPosition()},focusOnTextarea(){setTimeout((()=>{if(this.isEditMode){this.$refs.textarea.focus()}}),0)}},watch:{isEditMode(t){this.setAutoHide(t);this.focusOnTextarea()},async note(){await this.mountedPromise;this.$refs.popup.getPopupInstance().setHeight(0);const t=120;const o=280;const e=this.$refs.textarea.scrollHeight+45;const n=Math.min(o,Math.max(t,e));this.$refs.popup.getPopupInstance().setHeight(n);this.adjustPosition()}},components:{Button:d.Button,Popup:s.Popup},template:`\n\t\t<Popup\n\t\t\t:id="popupId"\n\t\t\t:config="config"\n\t\t\tref="popup"\n\t\t\t@close="closePopup"\n\t\t>\n\t\t\t<div\n\t\t\t\tclass="booking-booking-note-popup-content"\n\t\t\t\t:data-element="dataElementPrefix + '-note-popup'"\n\t\t\t\t:data-id="dataId"\n\t\t\t\t@mousedown="onMouseDown"\n\t\t\t>\n\t\t\t\t<div\n\t\t\t\t\tclass="booking-booking-note-popup-title"\n\t\t\t\t\t:data-element="dataElementPrefix + '-note-popup-title'"\n\t\t\t\t\t:data-id="dataId"\n\t\t\t\t>\n\t\t\t\t\t{{ loc('BOOKING_BOOKING_NOTE_TITLE') }}\n\t\t\t\t</div>\n\t\t\t\t<textarea\n\t\t\t\t\tv-model.trim="note"\n\t\t\t\t\tclass="booking-booking-note-popup-textarea"\n\t\t\t\t\t:placeholder="loc('BOOKING_BOOKING_NOTE_HINT')"\n\t\t\t\t\t:disabled="!isEditMode"\n\t\t\t\t\t:data-element="dataElementPrefix + '-note-popup-textarea'"\n\t\t\t\t\t:data-id="dataId"\n\t\t\t\t\t:data-disabled="!isEditMode"\n\t\t\t\t\tref="textarea"\n\t\t\t\t></textarea>\n\t\t\t\t<div v-if="isEditMode" class="booking-booking-note-popup-buttons">\n\t\t\t\t\t<slot name="buttons">\n\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\t:dataset="{id: dataId, element: dataElementPrefix + '-note-popup-save'}"\n\t\t\t\t\t\t\t:text="loc('BOOKING_BOOKING_NOTE_SAVE')"\n\t\t\t\t\t\t\t:size="buttonSize.EXTRA_SMALL"\n\t\t\t\t\t\t\t:color="buttonColor.PRIMARY"\n\t\t\t\t\t\t\t@click="saveNote"\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\t:dataset="{id: dataId, element: dataElementPrefix + '-note-popup-cancel'}"\n\t\t\t\t\t\t\t:text="loc('BOOKING_BOOKING_NOTE_CANCEL')"\n\t\t\t\t\t\t\t:size="buttonSize.EXTRA_SMALL"\n\t\t\t\t\t\t\t:color="buttonColor.LINK"\n\t\t\t\t\t\t\t@click="closePopup"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</slot>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</Popup>\n\t`};t.NotePopup=u})(this.BX.Booking.Component=this.BX.Booking.Component||{},BX,BX.Main,BX.Vue3,BX.Booking.Lib,BX.Booking.Component,BX.Booking.Component);
//# sourceMappingURL=note-popup.bundle.map.js