this.BX=this.BX||{};this.BX.Booking=this.BX.Booking||{};(function(e,t,a,s,n,i,r){"use strict";function l(e){const t=r.Core.getStore();const a=t.getters["resources/getById"](e);return structuredClone(i.toRaw(a))}function o(){return{id:null,typeId:null,name:"",description:null,slotRanges:[],counter:null,entities:[],isMain:true,isDeleted:false,isConfirmationNotificationOn:false,isFeedbackNotificationOn:false,isInfoNotificationOn:false,isDelayedNotificationOn:false,isReminderNotificationOn:false,templateTypeConfirmation:"animate",templateTypeFeedback:"animate",templateTypeInfo:"animate",templateTypeDelayed:"animate",templateTypeReminder:"base",createdBy:0,createdAt:0,updatedAt:null}}class d extends a.BuilderModel{getName(){return s.Model.ResourceCreationWizard}getState(){return{resourceId:this.getVariable("resourceId",null),resourceName:"",resource:o(),advertisingResourceTypes:[],companyScheduleSlots:[],fetching:false,step:1,isSaving:false,invalidResourceName:false,invalidResourceType:false,invalidIntegrationCalendarUser:false,isCompanyScheduleAccess:false,companyScheduleUrl:"",weekStart:"Mon",globalSchedule:false,checkedForAll:{},isChannelChoiceAvailable:true,isIntegrationCalendarEnabled:false}}getGetters(){return{resourceId:e=>e.resourceId,getResource:e=>e.resource,isSaving:e=>e.isSaving,getCompanyScheduleSlots:e=>e.companyScheduleSlots,isGlobalSchedule:e=>e.globalSchedule,startStep:e=>t.Type.isNull(e.resourceId)?1:2,finishStep:()=>3,invalidIntegrationCalendarUser:e=>e.isIntegrationCalendarEnabled&&e.invalidIntegrationCalendarUser,invalidChooseTypeCard:e=>t.Type.isNull(e.resource.typeId),invalidSettingsCard:(e,t)=>e.invalidResourceName||!e.resource.typeId||t.invalidIntegrationCalendarUser,invalidCurrentCard:(e,t)=>{if(e.step===1){return t.invalidChooseTypeCard}if(e.step===2){return t.invalidSettingsCard}return false},isCompanyScheduleAccess:e=>e.isCompanyScheduleAccess,companyScheduleUrl:e=>e.companyScheduleUrl,weekStart:e=>e.weekStart,isChannelChoiceAvailable:e=>e.isChannelChoiceAvailable,isCheckedForAll:e=>t=>{var a;return(a=e.checkedForAll[t])!=null?a:true},advertisingResourceType:e=>{const t=e.resource.typeId;return e.advertisingResourceTypes.find((({relatedResourceTypeId:e})=>e===t))||null},entityCalendar:e=>{var t,a;return((t=e.resource)==null?void 0:(a=t.entities)==null?void 0:a.find((e=>e.entityType===s.ResourceEntityType.Calendar)))||null},isIntegrationCalendarEnabled:e=>e.isIntegrationCalendarEnabled}}getActions(){return{async initState({state:e,dispatch:a}){if(t.Type.isNull(e.resourceId)){await a("initCreateMaster")}else{await a("initEditMaster")}},initCreateMaster({state:e,commit:a}){a("init",{resourceId:e.resourceId,step:1});a("setCurrentResourceName",t.Loc.getMessage("BRCW_TITLE"))},initEditMaster({state:e,commit:t}){var a,n,i,r;const o=e.resourceId;const d=l(o);t("init",{resourceId:o,resource:d,step:2});t("setCurrentResourceName",d.name);t("setIsIntegrationCalendarEnabled",((a=d.entities)==null?void 0:(n=a.find((e=>e.entityType===s.ResourceEntityType.Calendar)))==null?void 0:(i=n.data)==null?void 0:(r=i.userIds)==null?void 0:r.length)>0)},nextStep({state:e,getters:t,commit:a}){if(t.invalidCurrentCard){return}if(e.step<t.finishStep){a("updateStep",e.step+1)}},prevStep({state:e,getters:t,commit:a}){if(e.step>t.startStep){a("updateStep",e.step-1)}},setAdvertisingTypes({commit:e},a){const s=[...a,{code:"none",name:t.Loc.getMessage("BRCW_CHOOSE_CATEGORY_YOUR_TYPE"),relatedResourceTypeId:0}];e("setAdvertisingTypes",s)},updateResource({commit:e,rootGetters:t},a){if(a.typeId){const e=t[`${s.Model.ResourceTypes}/getById`](a.typeId);const n=[...Object.values(s.NotificationFieldsMap.NotificationOn),...Object.values(s.NotificationFieldsMap.TemplateType),...Object.values(s.NotificationFieldsMap.Settings).flat()].reduce(((t,a)=>({...t,[a]:e[a]})),{});Object.assign(a,n)}e("updateResource",a)},createResourceEntityCalendar({commit:e}){e("createResourceEntityCalendar")},updateResourceEntityCalendar({commit:e},t){e("updateResourceEntityCalendar",t)},setCompanyScheduleSlots({commit:e},t){const a=Intl.DateTimeFormat().resolvedOptions().timeZone;e("setCompanyScheduleSlots",t.map((e=>({...e,weekDays:Object.values(e.weekDays),timezone:e.timezone||a}))))},setGlobalSchedule({commit:e},t){e("setGlobalSchedule",t)},setCompanyScheduleAccess({commit:e},t){e("setCompanyScheduleAccess",t)},setCompanyScheduleUrl({commit:e},t){e("setCompanyScheduleUrl",t)},setInvalidResourceName({commit:e,state:t},a){if(t.invalidResourceName!==a){e("setInvalidResourceName",a)}},setInvalidResourceType({commit:e,state:t},a){if(t.invalidResourceType!==a){e("setInvalidResourceType",a)}},setWeekStart({commit:e},t){e("setWeekStart",t)},setCheckedForAll({commit:e},{type:t,isChecked:a}){e("setCheckedForAll",{type:t,isChecked:a})},setSlotLengthId({commit:e},{slotLengthId:t}){e("setSlotLengthId",{slotLengthId:t})},setIsChannelChoiceAvailable({commit:e},t){e("setIsChannelChoiceAvailable",t)},setIsIntegrationCalendarEnabled({commit:e},t){e("setIsIntegrationCalendarEnabled",t)},setInvalidIntegrationCalendarUser({commit:e},t){e("setInvalidIntegrationCalendarUser",t)}}}getMutations(){return{init(e,{step:a,resourceId:s,resource:n=null}){e.step=a;e.resourceId=s;e.resource=t.Type.isNull(s)?o():n},setCurrentResourceName(e,t){e.resourceName=t},setAdvertisingTypes(e,t){e.advertisingResourceTypes=t},setCompanyScheduleSlots(e,t){e.companyScheduleSlots=t},updateStep(e,t){e.step=t},updateResource(e,t){e.resource={...e.resource,...t}},createResourceEntityCalendar(e){var t,a;const n=(t=e.resource)==null?void 0:(a=t.entities)==null?void 0:a.some((e=>e.entityType===s.ResourceEntityType.Calendar));if(!n){var i,r;(i=e.resource)==null?void 0:(r=i.entities)==null?void 0:r.push({entityType:s.ResourceEntityType.Calendar,entityId:0,data:{userIds:[],locationId:null,checkAvailability:false,reminders:[]}})}},updateResourceEntityCalendar(e,t){var a;const n=(a=e.resource)==null?void 0:a.entities.findIndex((e=>e.entityType===s.ResourceEntityType.Calendar));if(n>=0){const a=e.resource.entities[n];a.data={...a.data,...t}}},setGlobalSchedule(e,t){e.globalSchedule=Boolean(t)},updateFetching(e,t){e.fetching=t},setSaving(e,t){e.isSaving=t},setCompanyScheduleAccess(e,t){e.isCompanyScheduleAccess=t},setCompanyScheduleUrl(e,t){e.companyScheduleUrl=t},setInvalidResourceName(e,t){e.invalidResourceName=t},setInvalidResourceType(e,t){e.invalidResourceType=t},setWeekStart(e,t){e.weekStart=t},setCheckedForAll(e,{type:t,isChecked:a}){e.checkedForAll[t]=a},setSlotLengthId(e,{slotLengthId:t}){e.slotLengthId=t},setIsChannelChoiceAvailable(e,t){e.isChannelChoiceAvailable=t},setIsIntegrationCalendarEnabled(e,t){e.isIntegrationCalendarEnabled=t},setInvalidIntegrationCalendarUser(e,t=false){e.invalidIntegrationCalendarUser=t}}}}e.ResourceCreationWizardModel=d})(this.BX.Booking.Model=this.BX.Booking.Model||{},BX,BX.Vue3.Vuex,BX.Booking.Const,BX.Booking.Model,BX.Vue3,BX.Booking);
//# sourceMappingURL=resource-creation-wizard.bundle.map.js