{"version":3,"file":"booking.bundle.js","sources":["../src/lib/expand-off-hours/expand-off-hours.js","../src/components/filter/filter.js","../src/components/counters-panel/counters-panel.js","../src/components/after-title/statistics/statistics.js","../src/components/after-title/clients/clients.js","../src/components/after-title/profit/profit.js","../src/components/after-title/after-title.js","../src/components/grid/left-panel/off-hours/off-hours.js","../src/components/grid/left-panel/quick-filter/help-popup/help-popup.js","../src/components/grid/left-panel/quick-filter/quick-filter.js","../src/components/grid/left-panel/left-panel.js","../src/components/grid/now-line/now-line.js","../src/components/grid/bookings/booking/actions/actions-popup/client/client.js","../src/components/grid/bookings/booking/actions/actions-popup/deal/deal.js","../src/components/grid/bookings/booking/actions/actions-popup/document/document.js","../src/components/grid/bookings/booking/actions/actions-popup/extra-resources-info/booking-extra-resources-info.js","../src/components/grid/bookings/booking/actions/actions-popup/message/message.js","../src/components/grid/bookings/booking/actions/actions-popup/confirmation/confirmation.js","../src/components/grid/bookings/booking/actions/actions-popup/visit/visit.js","../src/components/grid/bookings/booking/actions/actions-popup/overbooking/overbooking.js","../src/components/grid/bookings/booking/actions/actions-popup/waitlist/waitlist.js","../src/components/grid/bookings/booking/actions/actions-popup/remove-btn/remove-btn.js","../src/components/grid/bookings/booking/actions/actions-popup/model/index.js","../src/components/grid/bookings/booking/actions/actions-popup/actions-popup.js","../src/components/grid/bookings/booking/actions/actions.js","../src/components/grid/bookings/booking/add-client/add-client.js","../src/components/grid/bookings/booking/booking-time/change-time-popup/change-time-popup.js","../src/components/grid/bookings/booking/booking-time/booking-time.js","../src/components/grid/bookings/booking/name/name.js","../src/components/grid/bookings/booking/note/note.js","../src/components/grid/bookings/booking/profit/profit.js","../src/components/grid/bookings/booking/crm-button/crm-button.js","../src/components/grid/bookings/booking/counter/counter.js","../src/components/grid/bookings/booking/resize/resize.js","../src/components/grid/bookings/booking/const.js","../src/components/grid/bookings/booking/booking-base.js","../src/components/grid/bookings/booking/lib/overbooking-free-space.js","../src/components/grid/bookings/booking/lib/index.js","../src/components/grid/bookings/booking/booking.js","../src/components/grid/bookings/busy-slot/busy-popup/busy-popup.js","../src/components/grid/bookings/busy-slot/busy-slot.js","../src/components/grid/base-cell/base-cell.js","../src/components/grid/bookings/cell/cell.js","../src/components/grid/bookings/quick-filter-line/quick-filter-line.js","../src/components/grid/bookings/model.js","../src/components/grid/bookings/libs/index.js","../src/components/grid/bookings/bookings.js","../src/components/grid/column/cell/cell.js","../src/components/grid/column/off-hours/off-hours.js","../src/components/grid/column/column.js","../src/lib/maximize/maximize.js","../src/components/grid/scale-panel/scale-panel.js","../src/components/grid/sidebar/calendar/calendar.js","../src/components/grid/sidebar/wait-list/components/wait-list-layout/wait-list-layout.js","../src/components/grid/sidebar/wait-list/components/wait-list-groups/wait-list-group-menu/composables/use-delete-wait-list-group.js","../src/components/grid/sidebar/wait-list/components/wait-list-groups/wait-list-group-menu/wait-list-group-menu.js","../src/components/grid/sidebar/wait-list/components/wait-list-groups/wait-list-groups.js","../src/components/grid/sidebar/wait-list/components/wait-list-item/name/name.js","../src/components/grid/sidebar/wait-list/components/wait-list-item/note/note.js","../src/components/grid/sidebar/wait-list/components/wait-list-item/profit/profit.js","../src/components/grid/sidebar/wait-list/components/wait-list-item/actions/actions-popup/components/client.js","../src/components/grid/sidebar/wait-list/components/wait-list-item/actions/actions-popup/components/confirmation.js","../src/components/grid/sidebar/wait-list/components/wait-list-item/actions/actions-popup/components/deal.js","../src/components/grid/sidebar/wait-list/components/wait-list-item/actions/actions-popup/components/document.js","../src/components/grid/sidebar/wait-list/components/wait-list-item/actions/actions-popup/components/message.js","../src/components/grid/sidebar/wait-list/components/wait-list-item/actions/actions-popup/components/remove.js","../src/components/grid/sidebar/wait-list/components/wait-list-item/actions/actions-popup/components/visit.js","../src/components/grid/sidebar/wait-list/components/wait-list-item/actions/actions-popup/actions-popup.js","../src/components/grid/sidebar/wait-list/components/wait-list-item/actions/actions.js","../src/components/grid/sidebar/wait-list/components/wait-list-item/add-client/add-client.js","../src/components/grid/sidebar/wait-list/components/wait-list-item/crm-button/crm-button.js","../src/components/grid/sidebar/wait-list/components/wait-list-item/wait-list-item.js","../src/components/grid/sidebar/wait-list/components/button-add-wait-list-item/button-add-wait-list-item.js","../src/components/grid/sidebar/wait-list/wait-list.js","../src/components/grid/sidebar/sidebar.js","../src/components/grid/drag-delete/drag-delete.js","../src/components/grid/grid.js","../src/components/header/resource/resource-workload/battery-icon/battery-icon.js","../src/components/header/resource/resource-workload/workload-popup/workload-popup.js","../src/components/header/resource/resource-workload/resource-workload.js","../src/components/header/resource/resource-menu/resource-menu.js","../src/components/header/resource/resource.js","../src/components/header/add-resource-button/add-resource-button.js","../src/components/header/select-resources/dialog-header/content-header.js","../src/components/header/select-resources/dialog-header/resource-types/resource-types.js","../src/components/header/select-resources/dialog-header/resize/resize.js","../src/components/header/select-resources/dialog-header/search/search.js","../src/components/header/select-resources/dialog-header/dialog-header.js","../src/components/header/select-resources/dialog-footer/content-footer.js","../src/components/header/select-resources/dialog-footer/dialog-footer.js","../src/components/header/select-resources/select-resources.js","../src/components/header/header.js","../src/components/intersections/multiple/multiple.js","../src/components/intersections/single/single.js","../src/components/intersections/intersections.js","../src/components/base-component/base-component.js","../src/components/multi-booking/booking-multiple-button/booking-multiple-button.js","../src/components/multi-booking/multi-booking-items-list/multi-booking-item.js","../src/components/multi-booking/multi-booking-items-list/multi-booking-items-list.js","../src/components/multi-booking/add-client-button/add-client-button.js","../src/components/multi-booking/cancel-button/cancel-button.js","../src/components/multi-booking/multi-booking.js","../src/components/banner/banner.js","../src/components/trial/trial.js","../src/components/crm-forms-button/crm-forms-popup/layout/crm-forms-popup-layout.js","../src/components/crm-forms-button/crm-forms-popup/crm-forms-list/crm-form-list-empty/crm-form-item-skeleton/crm-form-item-skeleton.js","../src/components/crm-forms-button/crm-forms-popup/crm-forms-list/crm-form-list-empty/crm-form-list-empty.js","../src/components/crm-forms-button/crm-forms-popup/crm-forms-list/crm-forms-list-item/crm-forms-list-item-name-link.js","../src/components/crm-forms-button/crm-forms-popup/crm-forms-list/crm-forms-list-item/crm-forms-list-item.js","../src/components/crm-forms-button/crm-forms-popup/crm-forms-list/crm-forms-list.js","../src/components/crm-forms-button/crm-forms-popup/toolbar/crm-forms-toolbar.js","../src/components/crm-forms-button/crm-forms-popup/add-crm-form-button/add-crm-form-button.js","../src/components/crm-forms-button/crm-forms-popup/all-crm-forms-button/all-crm-forms-button.js","../src/components/crm-forms-button/crm-forms-popup/crm-forms-popup.js","../src/components/crm-forms-button/crm-forms-button.js","../src/components/app.js","../src/booking.js"],"sourcesContent":["import { Dom } from 'main.core';\nimport { Core } from 'booking.core';\nimport { Model } from 'booking.const';\n\nconst cellHeight = 50;\nconst cellHeightProperty = '--booking-off-hours-cell-height';\nconst classCollapse = '--booking-booking-collapse';\nconst classExpand = '--booking-booking-expand';\n\nclass ExpandOffHours\n{\n\t#animation: BX.easing;\n\n\tget #container(): HTMLElement\n\t{\n\t\treturn Core.getParams().container;\n\t}\n\n\tget #content(): HTMLElement\n\t{\n\t\treturn BX('booking-content');\n\t}\n\n\tget #gridWrap(): HTMLElement\n\t{\n\t\treturn BX('booking-booking-grid-wrap');\n\t}\n\n\tget #fromHour(): number\n\t{\n\t\treturn Core.getStore().getters['interface/fromHour'];\n\t}\n\n\tget #toHour(): number\n\t{\n\t\treturn Core.getStore().getters['interface/toHour'];\n\t}\n\n\texpand({ keepScroll }): void\n\t{\n\t\tDom.removeClass(this.#container, classCollapse);\n\t\tDom.addClass(this.#container, classExpand);\n\t\tthis.animate(0, cellHeight, keepScroll);\n\t}\n\n\tcollapse(): void\n\t{\n\t\tDom.removeClass(this.#container, classExpand);\n\t\tDom.addClass(this.#container, classCollapse);\n\t\tthis.animate(cellHeight, 0, true);\n\t}\n\n\tanimate(fromHeight: number, toHeight: number, keepScroll: boolean = false): void\n\t{\n\t\tconst savedScrollTop = this.#gridWrap.scrollTop;\n\t\tconst savedScrollHeight = this.#gridWrap.scrollHeight;\n\t\tconst topCellsCoefficient = this.#fromHour / (24 - (this.#toHour - this.#fromHour));\n\n\t\tthis.#animation?.stop();\n\t\tthis.#animation = new BX.easing({\n\t\t\tduration: 200,\n\t\t\tstart: {\n\t\t\t\theight: fromHeight,\n\t\t\t},\n\t\t\tfinish: {\n\t\t\t\theight: toHeight,\n\t\t\t},\n\t\t\tstep: ({ height }) => {\n\t\t\t\tDom.style(this.#content, cellHeightProperty, `calc(var(--zoom) * ${height}px)`);\n\n\t\t\t\tif (keepScroll)\n\t\t\t\t{\n\t\t\t\t\tconst heightChange = this.#gridWrap.scrollHeight - savedScrollHeight;\n\n\t\t\t\t\tthis.#gridWrap.scrollTop = savedScrollTop + heightChange * topCellsCoefficient;\n\t\t\t\t}\n\t\t\t},\n\t\t});\n\t\tthis.#animation.animate();\n\t}\n\n\tsetExpanded(isExpanded: boolean): void\n\t{\n\t\tconst savedScrollTop = this.#gridWrap.scrollTop;\n\t\tconst savedScrollHeight = this.#gridWrap.scrollHeight;\n\t\tconst topCellsCoefficient = this.#fromHour / (24 - (this.#toHour - this.#fromHour));\n\n\t\tconst height = isExpanded ? cellHeight : 0;\n\t\tconst className = isExpanded ? classExpand : classCollapse;\n\n\t\tDom.removeClass(this.#container, [classCollapse, classExpand]);\n\t\tDom.addClass(this.#container, className);\n\t\tDom.style(this.#content, cellHeightProperty, `calc(var(--zoom) * ${height}px)`);\n\n\t\tconst heightChange = this.#gridWrap.scrollHeight - savedScrollHeight;\n\t\tthis.#gridWrap.scrollTop = savedScrollTop + heightChange * topCellsCoefficient;\n\n\t\tvoid Core.getStore().dispatch(`${Model.Interface}/setOffHoursExpanded`, isExpanded);\n\t}\n}\n\nexport const expandOffHours: ExpandOffHours = new ExpandOffHours();\n","import { BaseEvent, EventEmitter } from 'main.core.events';\nimport type { BookingUIFilter } from 'booking.lib.booking-filter';\n\nexport const FilterPreset = Object.freeze({\n\tCreatedByMe: 'booking-filter-preset-created-by-me',\n});\n\nexport const FilterField = Object.freeze({\n\tCreatedBy: 'CREATED_BY',\n\tContact: 'CONTACT',\n\tCompany: 'COMPANY',\n\tResource: 'RESOURCE',\n\tResourceLabel: 'RESOURCE_label',\n\tConfirmed: 'CONFIRMED',\n\tRequireAttention: 'REQUIRE_ATTENTION',\n});\n\nexport const RequireAttention = Object.freeze({\n\tDelayed: 'D',\n\tAwaitConfirmation: 'AC',\n});\n\nexport const Filter = {\n\temits: ['apply', 'clear'],\n\tprops: {\n\t\tfilterId: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tdata(): Object {\n\t\treturn {\n\t\t\tfilter: null,\n\t\t};\n\t},\n\tcreated(): void\n\t{\n\t\tthis.filter = BX.Main.filterManager.getById(this.filterId);\n\n\t\tEventEmitter.subscribe('BX.Main.Filter:beforeApply', this.onBeforeApply);\n\t},\n\tmethods: {\n\t\tonBeforeApply(event: BaseEvent): void\n\t\t{\n\t\t\tconst [filterId] = event.getData();\n\t\t\tif (filterId !== this.filterId)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (this.isFilterEmpty())\n\t\t\t{\n\t\t\t\tthis.$emit('clear');\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.$emit('apply');\n\t\t\t}\n\t\t},\n\t\tsetFields(fields: BookingUIFilter): void\n\t\t{\n\t\t\tconst preparedFields = this.filter.getFilterFieldsValues();\n\n\t\t\tpreparedFields[FilterField.RequireAttention] = fields.REQUIRE_ATTENTION;\n\t\t\tpreparedFields[FilterField.Resource] = fields.RESOURCE;\n\n\t\t\tif (FilterField.ResourceLabel in fields)\n\t\t\t{\n\t\t\t\tpreparedFields[FilterField.ResourceLabel] = fields.RESOURCE_label;\n\t\t\t}\n\n\t\t\tthis.filter.getApi().setFields(preparedFields);\n\t\t\tthis.filter.getApi().apply();\n\t\t},\n\t\tisFilterEmpty(): boolean\n\t\t{\n\t\t\treturn Object.keys(this.getFields()).length === 0;\n\t\t},\n\t\tgetFields(): BookingUIFilter\n\t\t{\n\t\t\tconst booleanFields = [FilterField.Confirmed, FilterField.Delayed];\n\t\t\tconst arrayFields = [FilterField.Company, FilterField.Contact, FilterField.CreatedBy, FilterField.Resource];\n\t\t\tconst stringFields = [FilterField.RequireAttention];\n\n\t\t\tconst filterFields = this.filter.getFilterFieldsValues();\n\t\t\tconst fields = booleanFields\n\t\t\t\t.filter((field) => ['Y', 'N'].includes(filterFields[field]))\n\t\t\t\t.reduce((acc, field) => ({\n\t\t\t\t\t...acc,\n\t\t\t\t\t[field]: filterFields[field],\n\t\t\t\t}), {})\n\t\t\t;\n\n\t\t\tarrayFields.forEach((field: string) => {\n\t\t\t\tif (filterFields[field]?.length > 0)\n\t\t\t\t{\n\t\t\t\t\tfields[field] = filterFields[field];\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tstringFields.forEach((field: string) => {\n\t\t\t\tif (filterFields[field]?.length > 0)\n\t\t\t\t{\n\t\t\t\t\tfields[field] = filterFields[field];\n\t\t\t\t}\n\t\t\t});\n\n\t\t\treturn fields;\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div></div>\n\t`,\n};\n","import { EventEmitter } from 'main.core.events';\nimport { mapGetters } from 'ui.vue3.vuex';\nimport { CounterPanel } from 'ui.counterpanel';\nimport { CounterColor } from 'ui.cnt';\nimport './counters-panel.css';\n\nexport const CounterItem = Object.freeze({\n\tAwaitConfirmation: 'await-confirmation',\n\tDelayed: 'delayed',\n});\n\nexport const CountersPanel = {\n\temits: ['activeItem'],\n\tprops: {\n\t\ttarget: HTMLElement,\n\t},\n\tmounted(): void\n\t{\n\t\tthis.addCounterPanel();\n\n\t\tEventEmitter.subscribe('BX.UI.CounterPanel.Item:activate', this.onActiveItem);\n\t\tEventEmitter.subscribe('BX.UI.CounterPanel.Item:deactivate', this.onActiveItem);\n\t},\n\tcomputed: mapGetters({\n\t\tcounters: 'counters/get',\n\t}),\n\tmethods: {\n\t\tsetItem(itemId: string | null): void\n\t\t{\n\t\t\tif (this.getActiveItem() === itemId)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tObject.values(CounterItem).forEach((id) => this.counterPanel.getItemById(id).deactivate());\n\n\t\t\tconst item = this.counterPanel.getItemById(itemId);\n\t\t\titem?.activate();\n\t\t},\n\t\taddCounterPanel(): void\n\t\t{\n\t\t\tthis.counterPanel = new CounterPanel({\n\t\t\t\ttarget: this.target,\n\t\t\t\titems: [\n\t\t\t\t\t{\n\t\t\t\t\t\tid: CounterItem.AwaitConfirmation,\n\t\t\t\t\t\ttitle: this.loc('BOOKING_BOOKING_COUNTER_PANEL_AWAIT_CONFIRMATION'),\n\t\t\t\t\t\tvalue: this.counters.unConfirmed,\n\t\t\t\t\t\tcolor: getFieldName(CounterColor, CounterColor.THEME),\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tid: CounterItem.Delayed,\n\t\t\t\t\t\ttitle: this.loc('BOOKING_BOOKING_COUNTER_PANEL_DELAYED'),\n\t\t\t\t\t\tvalue: this.counters.delayed,\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t});\n\n\t\t\tthis.counterPanel.init();\n\t\t},\n\t\tonActiveItem(): void\n\t\t{\n\t\t\tthis.$emit('activeItem', this.getActiveItem());\n\t\t},\n\t\tgetActiveItem(): string | null\n\t\t{\n\t\t\treturn this.counterPanel.getItems().find(({ isActive }) => isActive)?.id ?? null;\n\t\t},\n\t},\n\twatch: {\n\t\tcounters(counters): void\n\t\t{\n\t\t\tthis.counterPanel.getItems().forEach((item) => {\n\t\t\t\tif (item.id === CounterItem.AwaitConfirmation)\n\t\t\t\t{\n\t\t\t\t\titem.updateColor(getFieldName(CounterColor, CounterColor.DANGER));\n\t\t\t\t\titem.updateValue(counters.unConfirmed);\n\t\t\t\t}\n\n\t\t\t\tif (item.id === CounterItem.Delayed)\n\t\t\t\t{\n\t\t\t\t\titem.updateColor(getFieldName(CounterColor, CounterColor.DANGER));\n\t\t\t\t\titem.updateValue(counters.delayed);\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div v-if=\"false\"></div>\n\t`,\n};\n\nconst getFieldName = (obj, field) => Object.entries(obj).find(([, value]) => value === field)[0];\n","import { Event } from 'main.core';\nimport { StatisticsPopup } from 'booking.component.statistics-popup';\n\nexport const Statistics = {\n\tprops: {\n\t\tvalue: {\n\t\t\ttype: Number,\n\t\t\trequired: true,\n\t\t},\n\t\tvalueFormatted: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t\tincreasedValue: {\n\t\t\ttype: Number,\n\t\t\trequired: true,\n\t\t},\n\t\tincreasedValueFormatted: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t\tpopupId: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t\ttitle: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t\trows: {\n\t\t\ttype: Array,\n\t\t\trequired: true,\n\t\t},\n\t\tbutton: {\n\t\t\ttype: Object,\n\t\t\trequired: false,\n\t\t},\n\t},\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tisPopupShown: false,\n\t\t};\n\t},\n\tmethods: {\n\t\tonMouseEnter(): void\n\t\t{\n\t\t\tthis.clearTimeouts();\n\t\t\tthis.showTimeout = setTimeout(() => this.showPopup(), 100);\n\t\t},\n\t\tonMouseLeave(): void\n\t\t{\n\t\t\tEvent.unbind(document, 'mouseover', this.updateHoverElement);\n\t\t\tEvent.bind(document, 'mouseover', this.updateHoverElement);\n\n\t\t\tthis.clearTimeouts();\n\n\t\t\tif (!this.button)\n\t\t\t{\n\t\t\t\tthis.closePopup();\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.closeTimeout = setTimeout(() => {\n\t\t\t\tthis.popupContainer = document.getElementById(this.popupId);\n\t\t\t\tif (!this.popupContainer?.contains(this.hoverElement) && !this.$refs.container.contains(this.hoverElement))\n\t\t\t\t{\n\t\t\t\t\tthis.closePopup();\n\t\t\t\t}\n\n\t\t\t\tif (this.popupContainer)\n\t\t\t\t{\n\t\t\t\t\tEvent.unbind(this.popupContainer, 'mouseleave', this.onMouseLeave);\n\t\t\t\t\tEvent.bind(this.popupContainer, 'mouseleave', this.onMouseLeave);\n\t\t\t\t}\n\t\t\t}, 100);\n\t\t},\n\t\tupdateHoverElement(event: MouseEvent): void\n\t\t{\n\t\t\tthis.hoverElement = event.target;\n\t\t},\n\t\tshowPopup(): void\n\t\t{\n\t\t\tthis.clearTimeouts();\n\t\t\tthis.isPopupShown = true;\n\t\t},\n\t\tclosePopup(): void\n\t\t{\n\t\t\tthis.clearTimeouts();\n\t\t\tthis.isPopupShown = false;\n\t\t\tEvent.unbind(this.popupContainer, 'mouseleave', this.onMouseLeave);\n\t\t\tEvent.unbind(document, 'mouseover', this.updateHoverElement);\n\t\t},\n\t\tclearTimeouts(): void\n\t\t{\n\t\t\tclearTimeout(this.closeTimeout);\n\t\t\tclearTimeout(this.showTimeout);\n\t\t},\n\t\tclose()\n\t\t{\n\t\t\tthis.closePopup();\n\t\t\tthis.$emit('close');\n\t\t},\n\t},\n\twatch: {\n\t\tvalue(): void\n\t\t{\n\t\t\tthis.$refs.animation?.replaceWith(this.$refs.animation);\n\t\t},\n\t},\n\tcomponents: {\n\t\tStatisticsPopup,\n\t},\n\ttemplate: `\n\t\t<div class=\"booking-toolbar-after-title-info-profit-container\" ref=\"container\">\n\t\t\t<div\n\t\t\t\tv-html=\"valueFormatted\"\n\t\t\t\tclass=\"booking-toolbar-after-title-info-profit\"\n\t\t\t\t@click=\"showPopup\"\n\t\t\t\t@mouseenter=\"onMouseEnter\"\n\t\t\t\t@mouseleave=\"onMouseLeave\"\n\t\t\t></div>\n\t\t\t<div\n\t\t\t\tv-if=\"increasedValue > 0\"\n\t\t\t\tv-html=\"increasedValueFormatted\"\n\t\t\t\tclass=\"booking-toolbar-after-title-profit-increased\"\n\t\t\t\tref=\"animation\"\n\t\t\t></div>\n\t\t</div>\n\t\t<StatisticsPopup\n\t\t\tv-if=\"isPopupShown\"\n\t\t\t:popupId=\"popupId\"\n\t\t\t:bindElement=\"$refs.container\"\n\t\t\t:title=\"title\"\n\t\t\t:rows=\"rows\"\n\t\t\t:button=\"button\"\n\t\t\t@close=\"close\"\n\t\t/>\n\t`,\n};\n","import { Loc } from 'main.core';\nimport { mapGetters } from 'ui.vue3.vuex';\nimport { Model } from 'booking.const';\n\nimport { Statistics } from '../statistics/statistics';\n\nexport const Clients = {\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tincreasedValue: 0,\n\t\t};\n\t},\n\tcomputed: {\n\t\t...mapGetters({\n\t\t\ttotalNewClientsToday: `${Model.Interface}/totalNewClientsToday`,\n\t\t\ttotalClients: `${Model.Interface}/totalClients`,\n\t\t}),\n\t\tpopupId(): string\n\t\t{\n\t\t\treturn 'booking-booking-after-title-clients-popup';\n\t\t},\n\t\ttitle(): string\n\t\t{\n\t\t\treturn this.loc('BOOKING_BOOKING_AFTER_TITLE_CLIENTS_POPUP_TITLE');\n\t\t},\n\t\trows(): { title: string, value: string }[]\n\t\t{\n\t\t\treturn [\n\t\t\t\t{\n\t\t\t\t\ttitle: this.loc('BOOKING_BOOKING_AFTER_TITLE_CLIENTS_POPUP_TOTAL_CLIENTS_TODAY'),\n\t\t\t\t\tvalue: `+${this.totalNewClientsToday}`,\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\ttitle: this.loc('BOOKING_BOOKING_AFTER_TITLE_CLIENTS_POPUP_TOTAL_CLIENTS'),\n\t\t\t\t\tvalue: `<div>${this.totalClients}</div>`,\n\t\t\t\t},\n\t\t\t];\n\t\t},\n\t\tbutton(): Object\n\t\t{\n\t\t\treturn {\n\t\t\t\ttitle: this.loc('BOOKING_BOOKING_CLIENTS_LIST'),\n\t\t\t\tclick: () => BX.SidePanel.Instance.open('/crm/contact/list/'),\n\t\t\t};\n\t\t},\n\t\tclientsProfitFormatted(): string\n\t\t{\n\t\t\treturn Loc.getMessagePlural('BOOKING_BOOKING_PLUS_NUM_CLIENTS', this.totalNewClientsToday, {\n\t\t\t\t'#NUM#': this.totalNewClientsToday,\n\t\t\t});\n\t\t},\n\t\tincreasedValueFormatted(): string\n\t\t{\n\t\t\treturn Loc.getMessagePlural('BOOKING_BOOKING_PLUS_NUM_CLIENTS', this.increasedValue, {\n\t\t\t\t'#NUM#': this.increasedValue,\n\t\t\t});\n\t\t},\n\t},\n\twatch: {\n\t\ttotalNewClientsToday(newValue: number, previousValue: number): void\n\t\t{\n\t\t\tthis.increasedValue = newValue - previousValue;\n\t\t},\n\t},\n\tcomponents: {\n\t\tStatistics,\n\t},\n\ttemplate: `\n\t\t<Statistics\n\t\t\t:value=\"totalNewClientsToday\"\n\t\t\t:valueFormatted=\"clientsProfitFormatted\"\n\t\t\t:increasedValue=\"increasedValue\"\n\t\t\t:increasedValueFormatted=\"increasedValueFormatted\"\n\t\t\t:popupId=\"popupId\"\n\t\t\t:title=\"title\"\n\t\t\t:rows=\"rows\"\n\t\t\t:button=\"button\"\n\t\t/>\n\t`,\n};\n","import { DateTimeFormat } from 'main.date';\nimport { mapGetters } from 'ui.vue3.vuex';\nimport { Model } from 'booking.const';\nimport { currencyFormat } from 'booking.lib.currency-format';\nimport type { MoneyStatistics } from 'booking.model.interface';\n\nimport { Statistics } from '../statistics/statistics';\n\nexport const Profit = {\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tincreasedValue: 0,\n\t\t};\n\t},\n\tcomputed: {\n\t\t...mapGetters({\n\t\t\tmoneyStatistics: `${Model.Interface}/moneyStatistics`,\n\t\t}),\n\t\tpopupId(): string\n\t\t{\n\t\t\treturn 'booking-booking-after-title-profit-popup';\n\t\t},\n\t\ttitle(): string\n\t\t{\n\t\t\treturn this.loc('BOOKING_BOOKING_AFTER_TITLE_PROFIT_POPUP_TITLE');\n\t\t},\n\t\trows(): { title: string, value: string }[]\n\t\t{\n\t\t\tconst otherCurrencies = this.moneyStatistics?.month\n\t\t\t\t?.filter(({ currencyId }) => currencyId !== this.baseCurrencyId)\n\t\t\t\t?.map(({ currencyId }) => currencyId) ?? []\n\t\t\t;\n\n\t\t\treturn [\n\t\t\t\tthis.getTodayRow(this.baseCurrencyId),\n\t\t\t\t...otherCurrencies.map((currencyId: string) => this.getTodayRow(currencyId)),\n\t\t\t\tthis.getMonthRow(this.baseCurrencyId),\n\t\t\t\t...otherCurrencies.map((currencyId: string) => this.getMonthRow(currencyId)),\n\t\t\t];\n\t\t},\n\t\ttodayProfit(): number\n\t\t{\n\t\t\treturn this.getTodayProfit(this.moneyStatistics);\n\t\t},\n\t\ttodayProfitFormatted(): string\n\t\t{\n\t\t\treturn this.formatTodayProfit(this.todayProfit);\n\t\t},\n\t\tincreasedValueFormatted(): string\n\t\t{\n\t\t\treturn this.formatTodayProfit(this.increasedValue);\n\t\t},\n\t\tbaseCurrencyId(): string\n\t\t{\n\t\t\treturn currencyFormat.getBaseCurrencyId();\n\t\t},\n\t},\n\tmethods: {\n\t\tgetTodayRow(currencyId: string): { title: string, value: string }\n\t\t{\n\t\t\tconst title = this.loc('BOOKING_BOOKING_AFTER_TITLE_PROFIT_POPUP_TOTAL_TODAY');\n\n\t\t\treturn {\n\t\t\t\ttitle: currencyId === this.baseCurrencyId ? title : '',\n\t\t\t\tvalue: `+${this.getTodayProfitFormatted(currencyId)}`,\n\t\t\t};\n\t\t},\n\t\tgetMonthRow(currencyId: string): { title: string, value: string }\n\t\t{\n\t\t\tconst title = this.loc('BOOKING_BOOKING_AFTER_TITLE_PROFIT_POPUP_MONTH', {\n\t\t\t\t'#MONTH#': DateTimeFormat.format('f'),\n\t\t\t});\n\n\t\t\treturn {\n\t\t\t\ttitle: currencyId === this.baseCurrencyId ? title : '',\n\t\t\t\tvalue: `<div>${this.getMonthProfitFormatted(currencyId)}</div>`,\n\t\t\t};\n\t\t},\n\t\tgetTodayProfitFormatted(currency: string): string\n\t\t{\n\t\t\tconst statistics = this.moneyStatistics?.today?.find(({ currencyId }) => currencyId === currency);\n\t\t\tconst profit = statistics?.opportunity ?? 0;\n\n\t\t\treturn currencyFormat.format(currency, profit);\n\t\t},\n\t\tgetMonthProfitFormatted(currency: string): string\n\t\t{\n\t\t\tconst statistics = this.moneyStatistics?.month?.find(({ currencyId }) => currencyId === currency);\n\t\t\tconst profit = statistics?.opportunity ?? 0;\n\n\t\t\treturn currencyFormat.format(currency, profit);\n\t\t},\n\t\tgetTodayProfit(statistics: MoneyStatistics | null): number\n\t\t{\n\t\t\tconst statistic = statistics?.today?.find(({ currencyId }) => currencyId === this.baseCurrencyId);\n\n\t\t\treturn statistic?.opportunity ?? 0;\n\t\t},\n\t\tformatTodayProfit(profit: number): string\n\t\t{\n\t\t\treturn `+ <span>${currencyFormat.format(this.baseCurrencyId, profit)}</span>`;\n\t\t},\n\t},\n\twatch: {\n\t\tmoneyStatistics(newValue: MoneyStatistics, previousValue: MoneyStatistics): void\n\t\t{\n\t\t\tthis.increasedValue = this.getTodayProfit(newValue) - this.getTodayProfit(previousValue);\n\t\t},\n\t},\n\tcomponents: {\n\t\tStatistics,\n\t},\n\ttemplate: `\n\t\t<Statistics\n\t\t\t:value=\"todayProfit\"\n\t\t\t:valueFormatted=\"todayProfitFormatted\"\n\t\t\t:increasedValue=\"increasedValue\"\n\t\t\t:increasedValueFormatted=\"increasedValueFormatted\"\n\t\t\t:popupId=\"popupId\"\n\t\t\t:title=\"title\"\n\t\t\t:rows=\"rows\"\n\t\t/>\n\t`,\n};\n","import { DateTimeFormat } from 'main.date';\nimport { Clients } from './clients/clients';\nimport { Profit } from './profit/profit';\nimport './after-title.css';\n\nexport const AfterTitle = {\n\tcomputed: {\n\t\tdateFormatted(): string\n\t\t{\n\t\t\tconst format = DateTimeFormat.getFormat('DAY_SHORT_MONTH_FORMAT');\n\n\t\t\treturn DateTimeFormat.format(format, Date.now() / 1000);\n\t\t},\n\t},\n\tcomponents: {\n\t\tClients,\n\t\tProfit,\n\t},\n\ttemplate: `\n\t\t<div class=\"booking-toolbar-after-title\">\n\t\t\t<div class=\"booking-toolbar-after-title-date\" ref=\"date\">\n\t\t\t\t{{ dateFormatted }}\n\t\t\t</div>\n\t\t\t<div class=\"booking-toolbar-after-title-info\">\n\t\t\t\t<Clients/>\n\t\t\t\t<Profit/>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import { DateTimeFormat } from 'main.date';\nimport { mapGetters } from 'ui.vue3.vuex';\nimport { expandOffHours } from '../../../../lib/expand-off-hours/expand-off-hours';\nimport './off-hours.css';\n\nexport const OffHours = {\n\tprops: {\n\t\tbottom: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t},\n\tcomputed: {\n\t\t...mapGetters({\n\t\t\toffHoursHover: 'interface/offHoursHover',\n\t\t\toffHoursExpanded: 'interface/offHoursExpanded',\n\t\t\tfromHour: 'interface/fromHour',\n\t\t\ttoHour: 'interface/toHour',\n\t\t}),\n\t\tfromFormatted(): string\n\t\t{\n\t\t\tif (this.bottom)\n\t\t\t{\n\t\t\t\treturn this.formatHour(this.toHour);\n\t\t\t}\n\n\t\t\treturn this.formatHour(0);\n\t\t},\n\t\ttoFormatted(): string\n\t\t{\n\t\t\tif (this.bottom)\n\t\t\t{\n\t\t\t\treturn this.formatHour(24);\n\t\t\t}\n\n\t\t\treturn this.formatHour(this.fromHour);\n\t\t},\n\t},\n\tmethods: {\n\t\tformatHour(hour: number): string\n\t\t{\n\t\t\tconst timeFormat = DateTimeFormat.getFormat('SHORT_TIME_FORMAT');\n\t\t\tconst timestamp = new Date().setHours(hour, 0) / 1000;\n\n\t\t\treturn DateTimeFormat.format(timeFormat, timestamp);\n\t\t},\n\t\tanimateOffHours({ keepScroll }): void\n\t\t{\n\t\t\tif (this.offHoursExpanded)\n\t\t\t{\n\t\t\t\texpandOffHours.collapse();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\texpandOffHours.expand({ keepScroll });\n\t\t\t}\n\n\t\t\tvoid this.$store.dispatch('interface/setOffHoursExpanded', !this.offHoursExpanded);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div\n\t\t\tclass=\"booking-booking-off-hours\"\n\t\t\t:class=\"{'--hover': offHoursHover, '--bottom': bottom, '--top': !bottom}\"\n\t\t\t@click=\"animateOffHours({ keepScroll: bottom })\"\n\t\t\t@mouseenter=\"$store.dispatch('interface/setOffHoursHover', true)\"\n\t\t\t@mouseleave=\"$store.dispatch('interface/setOffHoursHover', false)\"\n\t\t>\n\t\t\t<div class=\"booking-booking-off-hours-border\"></div>\n\t\t\t<span>{{ fromFormatted }}</span>\n\t\t\t<span>{{ toFormatted }}</span>\n\t\t</div>\n\t`,\n};\n","import { PopupOptions } from 'main.popup';\nimport { RichLoc } from 'ui.vue3.components.rich-loc';\nimport { StickyPopup } from 'booking.component.popup';\nimport './help-popup.css';\n\nexport const HelpPopup = {\n\tname: 'HelpPopup',\n\tcomponents: {\n\t\tRichLoc,\n\t\tStickyPopup,\n\t},\n\temits: ['close'],\n\tprops: {\n\t\tbindElement: {\n\t\t\ttype: HTMLElement,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tcomputed: {\n\t\tpopupId(): string\n\t\t{\n\t\t\treturn 'booking-quick-filter-help-popup';\n\t\t},\n\t\tconfig(): PopupOptions\n\t\t{\n\t\t\treturn {\n\t\t\t\tclassName: 'booking-quick-filter-help-popup',\n\t\t\t\tbindElement: this.bindElement,\n\t\t\t\toffsetLeft: this.bindElement.offsetWidth,\n\t\t\t\toffsetTop: this.bindElement.offsetHeight,\n\t\t\t\tmaxWidth: 220,\n\t\t\t};\n\t\t},\n\t},\n\tmethods: {\n\t\tclosePopup(): void\n\t\t{\n\t\t\tthis.$emit('close');\n\t\t},\n\t},\n\ttemplate: `\n\t\t<StickyPopup\n\t\t\t:id=\"popupId\"\n\t\t\t:config=\"config\"\n\t\t\t@close=\"closePopup\"\n\t\t>\n\t\t\t<div class=\"booking-quick-filter-help-popup-content\">\n\t\t\t\t<div class=\"booking-quick-filter-help-popup-icon-container\">\n\t\t\t\t\t<div class=\"booking-quick-filter-help-popup-icon\"></div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"booking-quick-filter-help-popup-description\">\n\t\t\t\t\t<RichLoc :text=\"loc('BOOKING_QUICK_FILTER_HELP_MSGVER_1')\" placeholder=\"[bold]\">\n\t\t\t\t\t\t<template #bold=\"{ text }\">\n\t\t\t\t\t\t\t<span>{{ text }}</span>\n\t\t\t\t\t\t</template>\n\t\t\t\t\t</RichLoc>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</StickyPopup>\n\t`,\n};\n","import { BIcon as Icon, Set as IconSet } from 'ui.icon-set.api.vue';\nimport 'ui.icon-set.main';\nimport 'ui.icon-set.actions';\n\nimport { Model } from 'booking.const';\nimport { HelpPopup } from './help-popup/help-popup';\nimport './quick-filter.css';\n\nexport const QuickFilter = {\n\tprops: {\n\t\thour: {\n\t\t\ttype: Number,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tIconSet,\n\t\t\tisHelpPopupShown: false,\n\t\t};\n\t},\n\tcomputed: {\n\t\tactive(): boolean\n\t\t{\n\t\t\treturn this.hour in this.$store.getters[`${Model.Filter}/quickFilter`].active;\n\t\t},\n\t\thovered(): boolean\n\t\t{\n\t\t\treturn this.hour in this.$store.getters[`${Model.Filter}/quickFilter`].hovered;\n\t\t},\n\t},\n\tmethods: {\n\t\tonClick(): void\n\t\t{\n\t\t\tthis.closeHelpPopup();\n\n\t\t\tif (this.active)\n\t\t\t{\n\t\t\t\tvoid this.$store.dispatch(`${Model.Filter}/deactivateQuickFilter`, this.hour);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tvoid this.$store.dispatch(`${Model.Filter}/activateQuickFilter`, this.hour);\n\t\t\t}\n\t\t},\n\t\thover(): void\n\t\t{\n\t\t\tthis.helpPopupTimeout = setTimeout(() => this.showHelpPopup(), 1000);\n\n\t\t\tvoid this.$store.dispatch(`${Model.Filter}/hoverQuickFilter`, this.hour);\n\t\t},\n\t\tflee(): void\n\t\t{\n\t\t\tthis.closeHelpPopup();\n\n\t\t\tvoid this.$store.dispatch(`${Model.Filter}/fleeQuickFilter`, this.hour);\n\t\t},\n\t\tshowHelpPopup(): void\n\t\t{\n\t\t\tthis.isHelpPopupShown = true;\n\t\t},\n\t\tcloseHelpPopup(): void\n\t\t{\n\t\t\tclearTimeout(this.helpPopupTimeout);\n\t\t\tthis.isHelpPopupShown = false;\n\t\t},\n\t},\n\tcomponents: {\n\t\tIcon,\n\t\tHelpPopup,\n\t},\n\ttemplate: `\n\t\t<div\n\t\t\tclass=\"booking-booking-quick-filter-container\"\n\t\t\t:class=\"{'--hover': hovered || active, '--active': active}\"\n\t\t>\n\t\t\t<div\n\t\t\t\tclass=\"booking-booking-quick-filter\"\n\t\t\t\t@mouseenter=\"hover\"\n\t\t\t\t@mouseleave=\"flee\"\n\t\t\t\t@click=\"onClick\"\n\t\t\t>\n\t\t\t\t<Icon :name=\"active ? IconSet.CROSS_25 : IconSet.FUNNEL\"/>\n\t\t\t</div>\n\t\t\t<HelpPopup\n\t\t\t\tv-if=\"isHelpPopupShown\"\n\t\t\t\t:bindElement=\"$el\"\n\t\t\t\t@close=\"closeHelpPopup\"\n\t\t\t/>\n\t\t</div>\n\t`,\n};\n","import { DateTimeFormat } from 'main.date';\nimport { mapGetters } from 'ui.vue3.vuex';\nimport { range } from 'booking.lib.range';\n\nimport { OffHours } from './off-hours/off-hours';\nimport { QuickFilter } from './quick-filter/quick-filter';\nimport './left-panel.css';\n\ntype Hour = {\n\tvalue: number,\n\tformatted: string,\n\toffHours: boolean,\n\tlast: boolean,\n};\n\nexport const LeftPanel = {\n\tcomputed: {\n\t\t...mapGetters({\n\t\t\toffHoursHover: 'interface/offHoursHover',\n\t\t\toffHoursExpanded: 'interface/offHoursExpanded',\n\t\t\tfromHour: 'interface/fromHour',\n\t\t\ttoHour: 'interface/toHour',\n\t\t}),\n\t\tpanelHours(): Hour[]\n\t\t{\n\t\t\tconst timeFormat = DateTimeFormat.getFormat('SHORT_TIME_FORMAT');\n\t\t\tconst lastHour = this.offHoursExpanded ? 24 : this.toHour;\n\n\t\t\treturn range(0, 24).map((hour) => {\n\t\t\t\tconst timestamp = new Date().setHours(hour, 0) / 1000;\n\n\t\t\t\treturn {\n\t\t\t\t\tvalue: hour,\n\t\t\t\t\tformatted: DateTimeFormat.format(timeFormat, timestamp),\n\t\t\t\t\toffHours: hour < this.fromHour || hour >= this.toHour,\n\t\t\t\t\tlast: hour === lastHour,\n\t\t\t\t};\n\t\t\t});\n\t\t},\n\t},\n\tcomponents: {\n\t\tOffHours,\n\t\tQuickFilter,\n\t},\n\ttemplate: `\n\t\t<div class=\"booking-booking-grid-left-panel-container\">\n\t\t\t<div class=\"booking-booking-grid-left-panel\">\n\t\t\t\t<OffHours/>\n\t\t\t\t<OffHours :bottom=\"true\"/>\n\t\t\t\t<template v-for=\"hour of panelHours\" :key=\"hour.value\">\n\t\t\t\t\t<div\n\t\t\t\t\t\tv-if=\"hour.last\"\n\t\t\t\t\t\tclass=\"booking-booking-grid-left-panel-time-text\"\n\t\t\t\t\t>\n\t\t\t\t\t\t{{ hour.formatted }}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div\n\t\t\t\t\t\tv-if=\"hour.value !== 24\"\n\t\t\t\t\t\tclass=\"booking-booking-grid-left-panel-time\"\n\t\t\t\t\t\t:class=\"{'--off-hours': hour.offHours}\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<div class=\"booking-booking-grid-left-panel-time-text\">\n\t\t\t\t\t\t\t{{ hour.formatted }}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<QuickFilter :hour=\"hour.value\"/>\n\t\t\t\t\t</div>\n\t\t\t\t</template>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import { Dom } from 'main.core';\nimport { DateTimeFormat } from 'main.date';\nimport { mapGetters } from 'ui.vue3.vuex';\n\nimport { Model } from 'booking.const';\nimport './now-line.css';\n\nexport const NowLine = {\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tvisible: true,\n\t\t};\n\t},\n\tmounted(): void\n\t{\n\t\tthis.updateNowLine();\n\t\tsetInterval(() => this.updateNowLine(), 1000);\n\t},\n\tcomputed: mapGetters({\n\t\tzoom: `${Model.Interface}/zoom`,\n\t\tselectedDateTs: `${Model.Interface}/selectedDateTs`,\n\t\toffHoursExpanded: `${Model.Interface}/offHoursExpanded`,\n\t\tfromHour: `${Model.Interface}/fromHour`,\n\t\ttoHour: `${Model.Interface}/toHour`,\n\t\toffset: `${Model.Interface}/offset`,\n\t}),\n\tmethods: {\n\t\tsetVisible(visible: boolean): void\n\t\t{\n\t\t\tthis.visible = visible;\n\t\t\tthis.updateNowLine();\n\t\t},\n\t\tupdateNowLine(): void\n\t\t{\n\t\t\tconst now = new Date(Date.now() + this.offset);\n\n\t\t\tconst hourHeight = 50 * this.zoom;\n\t\t\tconst fromMinutes = this.fromHour * 60;\n\t\t\tconst nowMinutes = now.getHours() * 60 + now.getMinutes();\n\t\t\tconst toHour = this.offHoursExpanded ? 24 : this.toHour;\n\t\t\tconst toMinutes = Math.min(toHour * 60 + 21, nowMinutes);\n\t\t\tconst top = (toMinutes - fromMinutes) * (hourHeight / 60);\n\t\t\tDom.style(this.$refs.nowLine, 'top', `${top}px`);\n\n\t\t\tconst timeFormat = DateTimeFormat.getFormat('SHORT_TIME_FORMAT');\n\t\t\tconst timeFormatted = DateTimeFormat.format(timeFormat, now.getTime() / 1000);\n\t\t\tif (timeFormatted !== this.$refs.nowText.innerText)\n\t\t\t{\n\t\t\t\tthis.$refs.nowText.innerText = timeFormatted;\n\t\t\t}\n\n\t\t\tconst date = new Date(this.selectedDateTs + this.offset);\n\n\t\t\tconst visible = this.visible\n\t\t\t\t&& Date.UTC(date.getFullYear(), date.getMonth(), date.getDate())\n\t\t\t\t=== Date.UTC(now.getFullYear(), now.getMonth(), now.getDate())\n\t\t\t;\n\t\t\tDom.style(this.$refs.nowLine, 'display', visible ? '' : 'none');\n\t\t},\n\t},\n\twatch: {\n\t\tselectedDateTs(): void\n\t\t{\n\t\t\tthis.updateNowLine();\n\t\t},\n\t\tzoom(): void\n\t\t{\n\t\t\tthis.updateNowLine();\n\t\t},\n\t\toffHoursExpanded(offHoursExpanded: boolean): void\n\t\t{\n\t\t\tconst now = new Date();\n\t\t\tconst nowMinutes = now.getHours() * 60 + now.getMinutes();\n\t\t\tif (nowMinutes < this.toHour * 60)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.setVisible(!offHoursExpanded);\n\t\t\tsetTimeout(() => this.setVisible(true), 200);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"booking-booking-grid-now-line\" ref=\"nowLine\">\n\t\t\t<div class=\"booking-booking-grid-now-line-text\" ref=\"nowText\"></div>\n\t\t</div>\n\t`,\n};\n","import 'ui.icon-set.main';\n\nimport { Client } from 'booking.component.actions-popup';\nimport { bookingService } from 'booking.provider.service.booking-service';\nimport type { BookingModel } from 'booking.model.bookings';\nimport type {\n\tAddClientsPayload,\n\tUpdateClientsPayload,\n\tUpdateNotePayload,\n} from 'booking.component.actions-popup';\n\n// @vue/component\nexport const BookingClient = {\n\tname: 'BookingActionsPopupClient',\n\tprops: {\n\t\tbookingId: {\n\t\t\ttype: [Number, String],\n\t\t\trequired: true,\n\t\t},\n\t},\n\temits: ['freeze', 'unfreeze'],\n\tcomputed: {\n\t\tbooking(): BookingModel\n\t\t{\n\t\t\treturn this.$store.getters['bookings/getById'](this.bookingId);\n\t\t},\n\t},\n\tmethods: {\n\t\tasync addClients({ clients }: AddClientsPayload): Promise<void>\n\t\t{\n\t\t\tawait bookingService.update({\n\t\t\t\tid: this.booking.id,\n\t\t\t\tclients,\n\t\t\t});\n\t\t},\n\t\tasync updateClients({ clients }: UpdateClientsPayload): Promise<void>\n\t\t{\n\t\t\tawait bookingService.update({\n\t\t\t\tid: this.booking.id,\n\t\t\t\tclients,\n\t\t\t});\n\t\t},\n\t\tasync updateNote({ note }: UpdateNotePayload): Promise<void>\n\t\t{\n\t\t\tawait bookingService.update({\n\t\t\t\tid: this.booking.id,\n\t\t\t\tnote,\n\t\t\t});\n\t\t},\n\t},\n\tcomponents: {\n\t\tClient,\n\t},\n\ttemplate: `\n\t\t<Client\n\t\t\t:id=\"bookingId\"\n\t\t\t:clients=\"booking.clients\"\n\t\t\t:primaryClientData=\"booking.primaryClient\"\n\t\t\t:note=\"booking.note\"\n\t\t\t:dataId=\"bookingId\"\n\t\t\t:dataAttributes=\"{\n\t\t\t\t'data-booking-id': bookingId,\n\t\t\t}\"\n\t\t\tdataElementPrefix=\"booking\"\n\t\t\t@freeze=\"$emit('freeze')\"\n\t\t\t@unfreeze=\"$emit('unfreeze')\"\n\t\t\t@addClients=\"addClients\"\n\t\t\t@updateClients=\"updateClients\"\n\t\t\t@updateNote=\"updateNote\"\n\t\t/>\n\t`,\n};\n","import 'ui.icon-set.main';\n\nimport { CrmEntity, Model } from 'booking.const';\nimport { BookingDealHelper } from 'booking.lib.deal-helper';\nimport { Deal } from 'booking.component.actions-popup';\nimport type { BookingModel, DealData } from 'booking.model.bookings';\n\ntype BookingDealData = {\n\tdealHelper: BookingDealHelper;\n}\n\n// @vue/component\nexport const BookingDeal = {\n\tname: 'BookingActionsPopupDeal',\n\tcomponents: {\n\t\tDeal,\n\t},\n\tprops: {\n\t\tbookingId: {\n\t\t\ttype: [Number, String],\n\t\t\trequired: true,\n\t\t},\n\t},\n\temits: ['freeze', 'unfreeze'],\n\tsetup(props): BookingDealData\n\t{\n\t\tconst dealHelper = new BookingDealHelper(props.bookingId);\n\n\t\treturn {\n\t\t\tdealHelper,\n\t\t};\n\t},\n\tcomputed: {\n\t\tbooking(): BookingModel\n\t\t{\n\t\t\treturn this.$store.getters[`${Model.Bookings}/getById`](this.bookingId);\n\t\t},\n\t\tdeal(): DealData | null\n\t\t{\n\t\t\treturn this.booking.externalData?.find((data) => data.entityTypeId === CrmEntity.Deal) ?? null;\n\t\t},\n\t},\n\ttemplate: `\n\t\t<Deal\n\t\t\t:deal=\"deal\"\n\t\t\t:dealHelper=\"dealHelper\"\n\t\t\t:dataId=\"booking.id\"\n\t\t\t:dataAttributes=\"{\n\t\t\t\t'data-booking-id': bookingId,\n\t\t\t}\"\n\t\t\tdataElementPrefix=\"booking\"\n\t\t\t@freeze=\"$emit('freeze')\"\n\t\t\t@unfreeze=\"$emit('unfreeze')\"\n\t\t/>\n\t`,\n};\n","import 'ui.icon-set.main';\n\nimport { Document } from 'booking.component.actions-popup';\nimport { bookingActionsService } from 'booking.provider.service.booking-actions-service';\n\nexport const BookingDocument = {\n\tname: 'BookingActionsPopupDocument',\n\tprops: {\n\t\tbookingId: {\n\t\t\ttype: [Number, String],\n\t\t\trequired: true,\n\t\t},\n\t},\n\tdata(): { isLoading: boolean }\n\t{\n\t\treturn {\n\t\t\tisLoading: true,\n\t\t};\n\t},\n\tasync mounted()\n\t{\n\t\tawait bookingActionsService.getDocData();\n\n\t\tthis.isLoading = false;\n\t},\n\tcomponents: {\n\t\tDocument,\n\t},\n\ttemplate: `\n\t\t<Document\n\t\t\t:id=\"bookingId\"\n\t\t\t:loading=\"isLoading\"\n\t\t\tdisabled\n\t\t/>\n\t`,\n};\n","import { ExtraResourcesInfo } from 'booking.component.actions-popup';\n\n// @vue/component\nexport const BookingExtraResourcesInfo = {\n\tname: 'BookingExtraResourcesInfo',\n\tcomponents: {\n\t\tExtraResourcesInfo,\n\t},\n\tprops: {\n\t\tbookingId: {\n\t\t\ttype: [Number, String],\n\t\t\trequired: true,\n\t\t},\n\t},\n\temits: ['freeze', 'unfreeze'],\n\ttemplate: `\n\t\t<ExtraResourcesInfo\n\t\t\t:id=\"bookingId\"\n\t\t\t@open=\"$emit('freeze')\"\n\t\t\t@close=\"$emit('unfreeze')\"\n\t\t\t@freeze=\"$emit('freeze')\"\n\t\t\t@unfreeze=\"$emit('unfreeze')\"\n\t\t/>\n\t`,\n};\n","import { Notifier } from 'ui.notification-manager';\nimport { Type } from 'main.core';\nimport { mapGetters } from 'ui.vue3.vuex';\nimport 'ui.icon-set.main';\n\nimport { Model } from 'booking.const';\nimport { Message } from 'booking.component.actions-popup';\nimport { bookingActionsService } from 'booking.provider.service.booking-actions-service';\nimport type { BookingModel } from 'booking.model.bookings';\nimport type { ClientData, ClientModel } from 'booking.model.clients';\nimport type { UpdateNotificationTypePayload } from 'booking.component.actions-popup';\n\nexport const BookingMessage = {\n\tname: 'BookingActionsPopupMessage',\n\temits: ['freeze', 'unfreeze'],\n\tprops: {\n\t\tbookingId: {\n\t\t\ttype: Number,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tisLoading: true,\n\t\t\tisPrimaryClientIdUpdated: false,\n\t\t};\n\t},\n\tmounted(): void\n\t{\n\t\tvoid this.fetchMessageData();\n\t},\n\tcomputed: {\n\t\t...mapGetters({\n\t\t\tisCurrentSenderAvailable: `${Model.Interface}/isCurrentSenderAvailable`,\n\t\t}),\n\t\tbooking(): BookingModel\n\t\t{\n\t\t\treturn this.$store.getters['bookings/getById'](this.bookingId);\n\t\t},\n\t\tclient(): ClientModel | null\n\t\t{\n\t\t\tconst clientData: ClientData = this.booking.primaryClient;\n\n\t\t\treturn clientData ? this.$store.getters['clients/getByClientData'](clientData) : null;\n\t\t},\n\t\tclientId(): number\n\t\t{\n\t\t\treturn this.booking.primaryClient?.id;\n\t\t},\n\t\tupdatedAt(): number\n\t\t{\n\t\t\treturn this.booking.updatedAt;\n\t\t},\n\t},\n\twatch: {\n\t\tclientId(): void\n\t\t{\n\t\t\tthis.isPrimaryClientIdUpdated = true;\n\t\t},\n\t\tupdatedAt(): void\n\t\t{\n\t\t\tif (this.isPrimaryClientIdUpdated && this.isCurrentSenderAvailable)\n\t\t\t{\n\t\t\t\tvoid this.fetchMessageData();\n\n\t\t\t\tthis.isPrimaryClientIdUpdated = false;\n\t\t\t}\n\t\t},\n\t},\n\tmethods: {\n\t\tasync sendMessage({ notificationType }: UpdateNotificationTypePayload): Promise<void>\n\t\t{\n\t\t\ttry\n\t\t\t{\n\t\t\t\tawait bookingActionsService.sendMessage(this.bookingId, notificationType);\n\t\t\t\tvoid this.fetchMessageData();\n\t\t\t}\n\t\t\tcatch (result)\n\t\t\t{\n\t\t\t\tif (Type.isArrayFilled(result.errors))\n\t\t\t\t{\n\t\t\t\t\tNotifier.notify({\n\t\t\t\t\t\tid: 'booking-message-send-error',\n\t\t\t\t\t\ttext: result.errors[0].message,\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\tasync fetchMessageData(): Promise<void>\n\t\t{\n\t\t\tthis.isLoading = true;\n\n\t\t\tawait bookingActionsService.getMessageData(this.bookingId);\n\n\t\t\tthis.isLoading = false;\n\t\t},\n\t},\n\tcomponents: {\n\t\tMessage,\n\t},\n\ttemplate: `\n\t\t<Message\n\t\t\t:id=\"bookingId\"\n\t\t\t:clientData=\"booking.primaryClient\"\n\t\t\t:loading=\"isLoading\"\n\t\t\t:dataId=\"bookingId\"\n\t\t\tdataElementPrefix=\"booking\"\n\t\t\t@open=\"$emit('freeze')\"\n\t\t\t@close=\"$emit('unfreeze')\"\n\t\t\t@updateNotificationType=\"sendMessage\"\n\t\t/>\n\t`,\n};\n","import { Model } from 'booking.const';\nimport { Confirmation } from 'booking.component.actions-popup';\nimport { bookingService } from 'booking.provider.service.booking-service';\nimport type { BookingModel } from 'booking.model.bookings';\nimport type { UpdateConfirmationStatusPayload } from 'booking.component.actions-popup';\n\nexport const BookingConfirmation = {\n\temits: ['freeze', 'unfreeze'],\n\tname: 'BookingActionsPopupConfirmation',\n\tprops: {\n\t\tbookingId: {\n\t\t\ttype: [Number, String],\n\t\t\trequired: true,\n\t\t},\n\t},\n\tcomputed: {\n\t\tbooking(): BookingModel\n\t\t{\n\t\t\treturn this.$store.getters[`${Model.Bookings}/getById`](this.bookingId);\n\t\t},\n\t},\n\tmethods: {\n\t\tupdateConfirmationStatus({ isConfirmed }: UpdateConfirmationStatusPayload): void\n\t\t{\n\t\t\tvoid bookingService.update({\n\t\t\t\tid: this.booking.id,\n\t\t\t\tisConfirmed,\n\t\t\t});\n\t\t},\n\t},\n\tcomponents: {\n\t\tConfirmation,\n\t},\n\ttemplate: `\n\t\t<Confirmation\n\t\t\t:id=\"bookingId\"\n\t\t\t:isConfirmed=\"booking.isConfirmed\"\n\t\t\t:counters=\"booking.counters\"\n\t\t\t:dataId=\"booking.id\"\n\t\t\tdataElementPrefix=\"booking\"\n\t\t\t@open=\"$emit('freeze')\"\n\t\t\t@close=\"$emit('unfreeze')\"\n\t\t\t@updateConfirmationStatus=\"updateConfirmationStatus\"\n\t\t/>\n\t`,\n};\n","import { BIcon as Icon } from 'ui.icon-set.api.vue';\nimport 'ui.icon-set.main';\n\nimport { Model } from 'booking.const';\nimport { Loader } from 'booking.component.loader';\nimport { Visit } from 'booking.component.actions-popup';\nimport { bookingService } from 'booking.provider.service.booking-service';\nimport type { BookingModel } from 'booking.model.bookings';\nimport type { VisitUpdateVisitStatusPayload } from 'booking.component.actions-popup';\n\nexport const BookingVisit = {\n\temits: ['freeze', 'unfreeze'],\n\tname: 'BookingActionsPopupVisit',\n\tprops: {\n\t\tbookingId: {\n\t\t\ttype: [Number, String],\n\t\t\trequired: true,\n\t\t},\n\t},\n\tcomputed: {\n\t\tbooking(): BookingModel\n\t\t{\n\t\t\treturn this.$store.getters[`${Model.Bookings}/getById`](this.bookingId);\n\t\t},\n\t},\n\tmethods: {\n\t\tupdateVisitStatus({ visitStatus }: VisitUpdateVisitStatusPayload): void\n\t\t{\n\t\t\tvoid bookingService.update({\n\t\t\t\tid: this.booking.id,\n\t\t\t\tvisitStatus,\n\t\t\t});\n\t\t},\n\t},\n\tcomponents: {\n\t\tIcon,\n\t\tLoader,\n\t\tVisit,\n\t},\n\ttemplate: `\n\t\t<Visit\n\t\t\t:id=\"booking.id\"\n\t\t\t:visitStatus=\"booking.visitStatus\"\n\t\t\t:dataId=\"booking.id\"\n\t\t\tdataElementPrefix=\"booking\"\n\t\t\t:hasClients=\"booking.clients.length > 0\"\n\t\t\t@freeze=\"$emit('freeze')\"\n\t\t\t@unfreeze=\"$emit('unfreeze')\"\n\t\t\t@update:visitStatus=\"updateVisitStatus\"\n\t\t/>\n\t`,\n};\n","import { Text } from 'main.core';\nimport { computed } from 'ui.vue3';\nimport { mapGetters } from 'ui.vue3.vuex';\nimport { hint } from 'ui.vue3.directives.hint';\nimport { BIcon as Icon, Set as IconSet } from 'ui.icon-set.api.vue';\n\nimport { Model } from 'booking.const';\nimport { limit } from 'booking.lib.limit';\nimport { bookingService } from 'booking.provider.service.booking-service';\nimport { BookingAnalytics } from 'booking.lib.analytics';\nimport { ClientData } from 'booking.model.clients';\nimport type { BookingModel, DealData } from 'booking.model.bookings';\nimport 'ui.icon-set.main';\n\nimport './overbooking.css';\n\ntype OverbookingData = {\n\tplusIcon: string,\n\tplusIconSize: number,\n\tplusIconColor: string,\n};\n\n// @vue/component\nexport const Overbooking = {\n\tname: 'BookingActionsPopupOverbooking',\n\tcomponents: {\n\t\tIcon,\n\t},\n\tdirectives: {\n\t\thint,\n\t},\n\tprops: {\n\t\tbookingId: {\n\t\t\ttype: [Number, String],\n\t\t\trequired: true,\n\t\t},\n\t\tresourceId: {\n\t\t\ttype: Number,\n\t\t\trequired: true,\n\t\t},\n\t\tdisabled: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t},\n\temits: ['close'],\n\tsetup(props): OverbookingData\n\t{\n\t\tconst plusIcon = IconSet.PLUS_20;\n\t\tconst plusIconSize = 20;\n\t\tconst plusIconColor = computed((): string => {\n\t\t\treturn props.disabled ? 'var(--ui-color-palette-gray-20)' : 'var(--ui-color-palette-gray-60)';\n\t\t});\n\n\t\treturn {\n\t\t\tplusIcon,\n\t\t\tplusIconSize,\n\t\t\tplusIconColor,\n\t\t};\n\t},\n\tcomputed: {\n\t\t...mapGetters({\n\t\t\tgetBookingById: `${Model.Bookings}/getById`,\n\t\t\tdictionary: `${Model.Dictionary}/getBookingVisitStatuses`,\n\t\t\tisFeatureEnabled: `${Model.Interface}/isFeatureEnabled`,\n\t\t\ttimezone: `${Model.Interface}/timezone`,\n\t\t\tembedItems: `${Model.Interface}/embedItems`,\n\t\t}),\n\t\tbooking(): BookingModel\n\t\t{\n\t\t\treturn this.getBookingById(this.bookingId);\n\t\t},\n\t\thasOverbookingHint(): Object | undefined\n\t\t{\n\t\t\tif (!this.disabled)\n\t\t\t{\n\t\t\t\treturn undefined;\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\ttext: this.loc('BB_ACTIONS_POPUP_OVERBOOKING_DISABLED_HINT'),\n\t\t\t};\n\t\t},\n\t\tclients(): ClientData[]\n\t\t{\n\t\t\tconst clients = this.embedItems.filter((item: DealData) => {\n\t\t\t\treturn item.entityTypeId === 'CONTACT' || item.entityTypeId === 'COMPANY';\n\t\t\t});\n\n\t\t\treturn clients.map((item: DealData) => {\n\t\t\t\treturn {\n\t\t\t\t\tid: item.value,\n\t\t\t\t\ttype: {\n\t\t\t\t\t\tcode: item.entityTypeId,\n\t\t\t\t\t\tmodule: item.moduleId,\n\t\t\t\t\t},\n\t\t\t\t};\n\t\t\t});\n\t\t},\n\t},\n\tmethods: {\n\t\tasync addOverbooking(): void\n\t\t{\n\t\t\tif (this.disabled)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (!this.isFeatureEnabled)\n\t\t\t{\n\t\t\t\tlimit.show();\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst overbooking: BookingModel = {\n\t\t\t\t...this.booking,\n\t\t\t\tid: Text.getRandom(10),\n\t\t\t\tclients: this.clients,\n\t\t\t\tcounter: 0,\n\t\t\t\tcounters: [],\n\t\t\t\tcreatedAt: Date.now(),\n\t\t\t\texternalData: this.embedItems,\n\t\t\t\tisConfirmed: false,\n\t\t\t\tname: null,\n\t\t\t\tnote: null,\n\t\t\t\tresourcesIds: [this.resourceId],\n\t\t\t\tprimaryClient: undefined,\n\t\t\t\trrule: null,\n\t\t\t\ttimezoneFrom: this.timezone,\n\t\t\t\ttimezoneTo: this.timezone,\n\t\t\t\tupdatedAt: Date.now(),\n\t\t\t\tvisitStatus: this.dictionary.Unknown,\n\t\t\t};\n\t\t\tdelete overbooking.name;\n\n\t\t\tconst result = await bookingService.add(overbooking);\n\t\t\tif (result.success && result.booking)\n\t\t\t{\n\t\t\t\tBookingAnalytics.sendAddBooking({ isOverbooking: true });\n\t\t\t}\n\n\t\t\tthis.$emit('close');\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div\n\t\t\tv-hint=\"hasOverbookingHint\"\n\t\t\tclass=\"booking-actions-popup__item-overbooking-button\"\n\t\t\t:class=\"{'--disabled': disabled}\"\n\t\t\trole=\"button\"\n\t\t\ttabindex=\"0\"\n\t\t\t@click=\"addOverbooking\"\n\t\t>\n\t\t\t<Icon :name=\"plusIcon\" :size=\"plusIconSize\" :color=\"plusIconColor\"/>\n\t\t\t<div class=\"booking-actions-popup__item-overbooking-label\">\n\t\t\t\t{{ loc('BB_ACTIONS_POPUP_OVERBOOKING_LABEL') }}\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","// @vue/component\n\nimport { Text } from 'main.core';\nimport { mapGetters } from 'ui.vue3.vuex';\nimport { BIcon as Icon, Set as IconSet } from 'ui.icon-set.api.vue';\nimport 'ui.icon-set.main';\n\nimport { Model } from 'booking.const';\nimport { isRealId } from 'booking.lib.is-real-id';\nimport { BookingAnalytics } from 'booking.lib.analytics';\nimport { waitListService } from 'booking.provider.service.wait-list-service';\n\nimport './waitlist.css';\n\nexport const Waitlist = {\n\tname: 'BookingActionsPopupWaitlist',\n\tcomponents: {\n\t\tIcon,\n\t},\n\tprops: {\n\t\tbookingId: {\n\t\t\ttype: [Number, String],\n\t\t\trequired: true,\n\t\t},\n\t},\n\tcomputed: {\n\t\t...mapGetters({\n\t\t\tgetBookingById: `${Model.Bookings}/getById`,\n\t\t}),\n\t\tclockIcon(): string\n\t\t{\n\t\t\treturn IconSet.BLACK_CLOCK;\n\t\t},\n\t\tdisabled(): boolean\n\t\t{\n\t\t\treturn !isRealId(this.bookingId);\n\t\t},\n\t},\n\tmethods: {\n\t\tasync toWaitList(): Promise<void>\n\t\t{\n\t\t\tif (this.disabled)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst bookingId = this.bookingId;\n\t\t\tconst booking = this.getBookingById(bookingId);\n\n\t\t\tawait this.$store.dispatch(`${Model.Interface}/addDeletingBooking`, bookingId);\n\t\t\tconst result = await waitListService.createFromBooking(\n\t\t\t\tbookingId,\n\t\t\t\t{\n\t\t\t\t\tid: `tmp-id-${Date.now()}-${Text.getRandom(4)}`,\n\t\t\t\t\tclients: booking.clients,\n\t\t\t\t\tprimaryClient: booking.primaryClient,\n\t\t\t\t\texternalData: booking.externalData,\n\t\t\t\t\tcreatedAt: Date.now(),\n\t\t\t\t\tupdatedAt: Date.now(),\n\t\t\t\t},\n\t\t\t);\n\n\t\t\tif (result.success && result.waitListItem)\n\t\t\t{\n\t\t\t\tBookingAnalytics.sendAddWaitListItem();\n\t\t\t}\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div\n\t\t\tclass=\"booking--booking-actions-popup__item-waitlist-btn --end\"\n\t\t\t:class=\"{'--disabled': disabled}\"\n\t\t\t@click=\"toWaitList\">\n\t\t\t<Icon :name=\"clockIcon\" :size=\"20\" color=\"var(--ui-color-palette-gray-60)\"/>\n\t\t\t<div class=\"booking-actions-popup__item-waitlist-label\">\n\t\t\t\t{{ loc('BB_ACTIONS_POPUP_OVERBOOKING_LIST') }}\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import { h } from 'ui.vue3';\nimport { RemoveButton } from 'booking.component.actions-popup';\nimport { RemoveBooking } from 'booking.lib.remove-booking';\n\nfunction BookingRemoveBtn(props, { emit }): void\n{\n\tconst bookingId = props.bookingId;\n\tconst removeBooking = () => {\n\t\temit('close');\n\n\t\tnew RemoveBooking(bookingId);\n\t};\n\n\treturn h(\n\t\tRemoveButton,\n\t\t{\n\t\t\tdataAttributes: {\n\t\t\t\t'data-booking-id': bookingId,\n\t\t\t\t'data-element': 'booking-menu-remove-button',\n\t\t\t},\n\t\t\tonRemove: removeBooking,\n\t\t},\n\t);\n}\n\ntype BookingRemoveBtnProps = {\n\tbookingId: string | number,\n}\nconst bookingRemoveBtnProps: Array<$Keys<BookingRemoveBtnProps>> = ['bookingId'];\n\nBookingRemoveBtn.props = bookingRemoveBtnProps;\nBookingRemoveBtn.emits = ['close'];\n\nexport { BookingRemoveBtn };\n","import type { ActionsPopupAction } from '../types';\n\nexport const ActionsPopupActionEnum: ActionsPopupAction = Object.freeze({\n\tclient: 'client',\n\tconfirmation: 'confirmation',\n\tdeal: 'deal',\n\tdocument: 'document',\n\textraResourcesInfo: 'extraResourcesInfo',\n\tfullForm: 'fullForm',\n\tmessage: 'message',\n\tvisit: 'visit',\n\toverbooking: 'overbooking',\n\tremove: 'remove',\n\twaitList: 'waitList',\n});\n","import { Model } from 'booking.const';\nimport { ActionsPopup, FullForm, Info } from 'booking.component.actions-popup';\nimport type { PopupMakerItem, PopupOptions } from 'booking.component.actions-popup';\nimport type { BookingModel } from 'booking.model.bookings';\n\nimport { BookingClient } from './client/client';\nimport { BookingDeal } from './deal/deal';\nimport { BookingDocument } from './document/document';\nimport { BookingExtraResourcesInfo } from './extra-resources-info/booking-extra-resources-info';\nimport { BookingMessage } from './message/message';\nimport { BookingConfirmation } from './confirmation/confirmation';\nimport { BookingVisit } from './visit/visit';\nimport { Overbooking } from './overbooking/overbooking';\nimport { Waitlist } from './waitlist/waitlist';\nimport { BookingRemoveBtn } from './remove-btn/remove-btn';\nimport { ActionsPopupActionEnum } from './model';\nimport type { ActionsPopupOptions } from './types';\n\nexport type { ActionsPopupOptions };\n\ntype ActionsPopupData = {\n\tsoonTmp: boolean,\n};\n\n// @vue/component\nexport const BookingActionsPopup = {\n\tname: 'BookingActionsPopup',\n\tcomponents: {\n\t\tActionsPopup,\n\t\tOverbooking,\n\t\tWaitlist,\n\t\tBookingRemoveBtn,\n\t},\n\tprops: {\n\t\tbindElement: {\n\t\t\ttype: HTMLElement,\n\t\t\trequired: true,\n\t\t},\n\t\tbookingId: {\n\t\t\ttype: [Number, String],\n\t\t\trequired: true,\n\t\t},\n\t\tresourceId: {\n\t\t\ttype: Number,\n\t\t\trequired: true,\n\t\t},\n\t\t/**\n\t\t * @type ActionsPopupOptions\n\t\t */\n\t\toptions: {\n\t\t\ttype: Object,\n\t\t\tdefault: null,\n\t\t},\n\t},\n\temits: ['close'],\n\tdata(): ActionsPopupData\n\t{\n\t\treturn {\n\t\t\tsoonTmp: false,\n\t\t};\n\t},\n\tcomputed: {\n\t\tconfig(): PopupOptions\n\t\t{\n\t\t\treturn {\n\t\t\t\toffsetLeft: this.getOffsetLeft(),\n\t\t\t\toffsetTop: -200,\n\t\t\t};\n\t\t},\n\t\tcontentStructure(): Array<PopupMakerItem | Array<PopupMakerItem>>\n\t\t{\n\t\t\treturn [\n\t\t\t\t{\n\t\t\t\t\tid: ActionsPopupActionEnum.client,\n\t\t\t\t\tprops: {\n\t\t\t\t\t\tbookingId: this.bookingId,\n\t\t\t\t\t},\n\t\t\t\t\tcomponent: BookingClient,\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tid: ActionsPopupActionEnum.extraResourcesInfo,\n\t\t\t\t\tprops: {\n\t\t\t\t\t\tbookingId: this.bookingId,\n\t\t\t\t\t\tresourceId: this.resourceId,\n\t\t\t\t\t},\n\t\t\t\t\tcomponent: BookingExtraResourcesInfo,\n\t\t\t\t},\n\t\t\t\t[\n\t\t\t\t\t{\n\t\t\t\t\t\tid: ActionsPopupActionEnum.deal,\n\t\t\t\t\t\tprops: {\n\t\t\t\t\t\t\tbookingId: this.bookingId,\n\t\t\t\t\t\t},\n\t\t\t\t\t\tcomponent: BookingDeal,\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tid: ActionsPopupActionEnum.document,\n\t\t\t\t\t\tprops: {\n\t\t\t\t\t\t\tbookingId: this.bookingId,\n\t\t\t\t\t\t},\n\t\t\t\t\t\tcomponent: BookingDocument,\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t\t{\n\t\t\t\t\tid: ActionsPopupActionEnum.message,\n\t\t\t\t\tprops: {\n\t\t\t\t\t\tbookingId: this.bookingId,\n\t\t\t\t\t},\n\t\t\t\t\tcomponent: BookingMessage,\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tid: ActionsPopupActionEnum.confirmation,\n\t\t\t\t\tprops: {\n\t\t\t\t\t\tbookingId: this.bookingId,\n\t\t\t\t\t},\n\t\t\t\t\tcomponent: BookingConfirmation,\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tid: ActionsPopupActionEnum.visit,\n\t\t\t\t\tprops: {\n\t\t\t\t\t\tbookingId: this.bookingId,\n\t\t\t\t\t},\n\t\t\t\t\tcomponent: BookingVisit,\n\t\t\t\t},\n\t\t\t\t[\n\t\t\t\t\t{\n\t\t\t\t\t\tid: ActionsPopupActionEnum.fullForm,\n\t\t\t\t\t\tprops: {\n\t\t\t\t\t\t\tbookingId: this.bookingId,\n\t\t\t\t\t\t},\n\t\t\t\t\t\tcomponent: FullForm,\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tid: ActionsPopupActionEnum.info,\n\t\t\t\t\t\tclass: '--shrink',\n\t\t\t\t\t\tprops: {\n\t\t\t\t\t\t\tbookingId: this.bookingId,\n\t\t\t\t\t\t},\n\t\t\t\t\t\tcomponent: Info,\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t];\n\t\t},\n\t\tbooking(): BookingModel\n\t\t{\n\t\t\treturn this.$store.getters[`${Model.Bookings}/getById`](this.bookingId);\n\t\t},\n\t},\n\tmethods: {\n\t\tgetOffsetLeft(): number\n\t\t{\n\t\t\tconst { left } = this.bindElement.getBoundingClientRect();\n\t\t\tif (window.innerWidth - left < 325)\n\t\t\t{\n\t\t\t\treturn -325;\n\t\t\t}\n\n\t\t\treturn this.bindElement.offsetWidth;\n\t\t},\n\t},\n\ttemplate: `\n\t\t<ActionsPopup\n\t\t\t:popupId=\"bookingId\"\n\t\t\t:bindElement=\"bindElement\"\n\t\t\t:contentStructure=\"contentStructure\"\n\t\t\t:popupOptions=\"config\"\n\t\t\t@close=\"$emit('close')\"\n\t\t>\n\t\t\t<template #footer>\n\t\t\t\t<Overbooking\n\t\t\t\t\tv-if=\"!options?.overbooking?.hidden\"\n\t\t\t\t\t:bookingId\n\t\t\t\t\t:resourceId\n\t\t\t\t\t:disabled=\"Boolean(options?.overbooking?.disabled)\"\n\t\t\t\t\t@close=\"$emit('close')\"\n\t\t\t\t/>\n\t\t\t\t<Waitlist v-if=\"!options?.waitList?.hidden\" :bookingId/>\n\t\t\t\t<BookingRemoveBtn :bookingId @close=\"$emit('close')\"/>\n\t\t\t</template>\n\t\t</ActionsPopup>\n\t`,\n};\n","import { mapGetters } from 'ui.vue3.vuex';\nimport { Model } from 'booking.const';\nimport { BookingActionsPopup } from './actions-popup/actions-popup';\n\nexport type { ActionsPopupOptions } from './actions-popup/actions-popup';\n\nexport const Actions = {\n\tname: 'BookingActions',\n\tprops: {\n\t\tbookingId: {\n\t\t\ttype: [Number, String],\n\t\t\trequired: true,\n\t\t},\n\t\tresourceId: {\n\t\t\ttype: Number,\n\t\t\trequired: true,\n\t\t},\n\t\tactionsPopupOptions: {\n\t\t\ttype: Object,\n\t\t\tdefault: null,\n\t\t},\n\t},\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tshowPopup: false,\n\t\t};\n\t},\n\tmounted(): void\n\t{\n\t\tif (this.isEditingBookingMode && this.editingBookingId === this.bookingId)\n\t\t{\n\t\t\tthis.showPopup = true;\n\t\t}\n\t},\n\tcomputed: mapGetters({\n\t\teditingBookingId: `${Model.Interface}/editingBookingId`,\n\t\tisEditingBookingMode: `${Model.Interface}/isEditingBookingMode`,\n\t}),\n\tmethods: {\n\t\tclickHandler(): void\n\t\t{\n\t\t\tthis.showPopup = true;\n\t\t},\n\t},\n\tcomponents: {\n\t\tBookingActionsPopup,\n\t},\n\ttemplate: `\n\t\t<div \n\t\t\tref=\"node\"\n\t\t\tclass=\"booking-booking-booking-actions\"\n\t\t\tdata-element=\"booking-booking-actions-button\"\n\t\t\t:data-id=\"bookingId\"\n\t\t\t:data-resource-id=\"resourceId\"\n\t\t\t@click=\"clickHandler\"\n\t\t>\n\t\t\t<div class=\"booking-booking-booking-actions-inner\">\n\t\t\t\t<div class=\"ui-icon-set --chevron-down\"></div>\n\t\t\t</div>\n\t\t</div>\n\t\t<BookingActionsPopup\n\t\t\tv-if=\"showPopup\"\n\t\t\t:bookingId\n\t\t\t:bindElement=\"this.$refs.node\"\n\t\t\t:resourceId\n\t\t\t:options=\"actionsPopupOptions\"\n\t\t\t@close=\"showPopup = false\"\n\t\t/>\n\t`,\n};\n","import { mapGetters } from 'ui.vue3.vuex';\n\nimport { AddClient } from 'booking.component.booking';\nimport { AhaMoment, HelpDesk, Model } from 'booking.const';\nimport { bookingService } from 'booking.provider.service.booking-service';\nimport { ahaMoments } from 'booking.lib.aha-moments';\nimport { isRealId } from 'booking.lib.is-real-id';\nimport type { ClientData } from 'booking.model.clients';\n\nimport './add-client.css';\n\nexport const BookingAddClient = {\n\tname: 'BookingAddClient',\n\tprops: {\n\t\tbookingId: {\n\t\t\ttype: [Number, String],\n\t\t\trequired: true,\n\t\t},\n\t\tresourceId: {\n\t\t\ttype: Number,\n\t\t\trequired: true,\n\t\t},\n\t\texpired: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t},\n\tcomputed: {\n\t\t...mapGetters({\n\t\t\tgetBookingById: `${Model.Bookings}/getById`,\n\t\t}),\n\t},\n\tmounted(): void\n\t{\n\t\tif (isRealId(this.bookingId))\n\t\t{\n\t\t\tahaMoments.setBookingForAhaMoment(this.bookingId);\n\t\t}\n\n\t\tif (ahaMoments.shouldShow(AhaMoment.AddClient, { bookingId: this.bookingId }))\n\t\t{\n\t\t\tvoid this.showAhaMoment();\n\t\t}\n\t},\n\tmethods: {\n\t\tasync addClientsToBook(clients: ClientData[]): Promise<void>\n\t\t{\n\t\t\tconst booking = this.getBookingById(this.bookingId);\n\t\t\tawait bookingService.update({\n\t\t\t\tid: booking.id,\n\t\t\t\tclients,\n\t\t\t});\n\t\t},\n\t\tasync showAhaMoment(): Promise<void>\n\t\t{\n\t\t\tawait ahaMoments.show({\n\t\t\t\tid: 'booking-add-client',\n\t\t\t\ttitle: this.loc('BOOKING_AHA_ADD_CLIENT_TITLE'),\n\t\t\t\ttext: this.loc('BOOKING_AHA_ADD_CLIENT_TEXT_MSGVER_1'),\n\t\t\t\ttarget: this.$refs.bookingAddClientBtn?.$refs?.button,\n\t\t\t});\n\n\t\t\tahaMoments.setShown(AhaMoment.AddClient);\n\t\t},\n\t},\n\tcomponents: {\n\t\tAddClient,\n\t},\n\ttemplate: `\n\t\t<AddClient\n\t\t\t:expired=\"expired\"\n\t\t\t:dataAttributes=\"{\n\t\t\t\t'data-id': bookingId,\n\t\t\t\t'data-element': 'booking-add-client-button',\n\t\t\t\t'data-resource-id': resourceId,\n\t\t\t}\"\n\t\t\tbuttonClass=\"booking-booking-booking-add-client\"\n\t\t\tref=\"bookingAddClientBtn\"\n\t\t\t@add=\"addClientsToBook\"\n\t\t/>\n\t`,\n};\n","import { Event } from 'main.core';\nimport { PopupOptions } from 'main.popup';\nimport { mapGetters } from 'ui.vue3.vuex';\n\nimport { Model } from 'booking.const';\nimport { Popup } from 'booking.component.popup';\nimport { TimeSelector } from 'booking.component.time-selector';\nimport { Button, ButtonSize, ButtonColor, ButtonIcon } from 'booking.component.button';\nimport { bookingService } from 'booking.provider.service.booking-service';\nimport type { BookingModel, OverbookingMapItem } from 'booking.model.bookings';\nimport './change-time-popup.css';\n\nexport const ChangeTimePopup = {\n\tname: 'ChangeTimePopup',\n\temits: ['close'],\n\tprops: {\n\t\tbookingId: {\n\t\t\ttype: [Number, String],\n\t\t\trequired: true,\n\t\t},\n\t\tresourceId: {\n\t\t\ttype: Number,\n\t\t\trequired: true,\n\t\t},\n\t\ttargetNode: {\n\t\t\ttype: HTMLElement,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tButtonSize,\n\t\t\tButtonColor,\n\t\t\tButtonIcon,\n\t\t\tfromTs: 0,\n\t\t\ttoTs: 0,\n\t\t\tduration: 0,\n\t\t};\n\t},\n\tcreated(): void\n\t{\n\t\tthis.fromTs = this.booking.dateFromTs;\n\t\tthis.toTs = this.booking.dateToTs;\n\t\tthis.duration = this.toTs - this.fromTs;\n\t},\n\tmounted(): void\n\t{\n\t\tEvent.bind(document, 'scroll', this.adjustPosition, true);\n\t},\n\tbeforeUnmount(): void\n\t{\n\t\tEvent.unbind(document, 'scroll', this.adjustPosition, true);\n\t},\n\tcomputed: {\n\t\t...mapGetters({\n\t\t\tselectedDateTs: `${Model.Interface}/selectedDateTs`,\n\t\t}),\n\t\tpopupId(): string\n\t\t{\n\t\t\treturn `booking-change-time-popup-${this.bookingId}-${this.resourceId}`;\n\t\t},\n\t\tconfig(): PopupOptions\n\t\t{\n\t\t\treturn {\n\t\t\t\tclassName: 'booking-booking-change-time-popup',\n\t\t\t\tbindElement: this.targetNode,\n\t\t\t\toffsetTop: -10,\n\t\t\t\tbindOptions: {\n\t\t\t\t\tforceBindPosition: true,\n\t\t\t\t\tposition: 'top',\n\t\t\t\t},\n\t\t\t\tangle: {\n\t\t\t\t\toffset: this.targetNode.offsetWidth / 2,\n\t\t\t\t},\n\t\t\t};\n\t\t},\n\t\tisBusy(): boolean\n\t\t{\n\t\t\tconst bookingId = this.bookingId;\n\t\t\tconst bookings = this.bookings\n\t\t\t\t.filter(({ id, dateToTs, dateFromTs }) => {\n\t\t\t\t\tif (id !== bookingId && this.overbookingMap.has(id))\n\t\t\t\t\t{\n\t\t\t\t\t\tconst overbooking: OverbookingMapItem = this.overbookingMap.get(id);\n\t\t\t\t\t\tconst resourceIntersections = overbooking.items.find((item) => item.resourceId === this.resourceId);\n\t\t\t\t\t\tconst intersections = resourceIntersections?.intersections?.filter((intersection) => {\n\t\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t\tintersection.id !== bookingId\n\t\t\t\t\t\t\t\t&& intersection.dateToTs > this.fromTs\n\t\t\t\t\t\t\t\t&& this.toTs > intersection.dateFromTs\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t}) || [];\n\t\t\t\t\t\tif (resourceIntersections && intersections.length === 0)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\treturn (\n\t\t\t\t\t\tid !== bookingId\n\t\t\t\t\t\t&& dateToTs > this.fromTs\n\t\t\t\t\t\t&& this.toTs > dateFromTs\n\t\t\t\t\t);\n\t\t\t\t});\n\n\t\t\treturn bookings.length > 1;\n\t\t},\n\t\tbookings(): BookingModel[]\n\t\t{\n\t\t\treturn this.$store.getters[`${Model.Bookings}/getByDateAndResources`](\n\t\t\t\tthis.selectedDateTs,\n\t\t\t\tthis.booking.resourcesIds,\n\t\t\t);\n\t\t},\n\t\tbooking(): BookingModel\n\t\t{\n\t\t\treturn this.$store.getters['bookings/getById'](this.bookingId);\n\t\t},\n\t\toverbookingMap(): Map<number, OverbookingMapItem[]>\n\t\t{\n\t\t\treturn this.$store.getters[`${Model.Bookings}/overbookingMap`];\n\t\t},\n\t},\n\tmethods: {\n\t\tadjustPosition(): void\n\t\t{\n\t\t\tthis.$refs.popup.adjustPosition();\n\t\t\tthis.$refs.timeFrom.adjustMenuPosition();\n\t\t\tthis.$refs.timeTo.adjustMenuPosition();\n\t\t},\n\t\tclosePopup(): void\n\t\t{\n\t\t\tconst tsChanged = this.booking.dateFromTs !== this.fromTs || this.booking.dateToTs !== this.toTs;\n\t\t\tif (!this.isBusy && tsChanged)\n\t\t\t{\n\t\t\t\tvoid bookingService.update({\n\t\t\t\t\tid: this.booking.id,\n\t\t\t\t\tdateFromTs: this.fromTs,\n\t\t\t\t\tdateToTs: this.toTs,\n\t\t\t\t\ttimezoneFrom: this.booking.timezoneFrom,\n\t\t\t\t\ttimezoneTo: this.booking.timezoneTo,\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tthis.$emit('close');\n\t\t},\n\t\tfreeze(): void\n\t\t{\n\t\t\tthis.$refs.popup.getPopupInstance().setAutoHide(false);\n\t\t},\n\t\tunfreeze(): void\n\t\t{\n\t\t\tthis.$refs.popup.getPopupInstance().setAutoHide(true);\n\t\t},\n\t},\n\twatch: {\n\t\tfromTs(): void\n\t\t{\n\t\t\tthis.toTs = this.fromTs + this.duration;\n\t\t},\n\t\ttoTs(): void\n\t\t{\n\t\t\tif (this.toTs <= this.fromTs)\n\t\t\t{\n\t\t\t\tthis.fromTs = this.toTs - this.duration;\n\t\t\t}\n\n\t\t\tthis.duration = this.toTs - this.fromTs;\n\t\t},\n\t\tisBusy(): void\n\t\t{\n\t\t\tsetTimeout(() => this.adjustPosition(), 0);\n\t\t},\n\t},\n\tcomponents: {\n\t\tPopup,\n\t\tTimeSelector,\n\t\tButton,\n\t},\n\ttemplate: `\n\t\t<Popup\n\t\t\t:id=\"popupId\"\n\t\t\t:config=\"config\"\n\t\t\t@close=\"closePopup\"\n\t\t\tref=\"popup\"\n\t\t>\n\t\t\t<div class=\"booking-booking-change-time-popup-content\">\n\t\t\t\t<div class=\"booking-booking-change-time-popup-main\">\n\t\t\t\t\t<TimeSelector\n\t\t\t\t\t\tv-model=\"fromTs\"\n\t\t\t\t\t\t:hasError=\"isBusy\"\n\t\t\t\t\t\tdata-element=\"booking-change-time-from\"\n\t\t\t\t\t\t:data-ts=\"fromTs\"\n\t\t\t\t\t\t:data-booking-id=\"bookingId\"\n\t\t\t\t\t\tref=\"timeFrom\"\n\t\t\t\t\t\t@freeze=\"freeze\"\n\t\t\t\t\t\t@unfreeze=\"unfreeze\"\n\t\t\t\t\t\t@enterSave=\"closePopup\"\n\t\t\t\t\t/>\n\t\t\t\t\t<div class=\"booking-booking-change-time-popup-separator\"></div>\n\t\t\t\t\t<TimeSelector\n\t\t\t\t\t\tv-model=\"toTs\"\n\t\t\t\t\t\t:hasError=\"isBusy\"\n\t\t\t\t\t\t:minTs=\"fromTs\"\n\t\t\t\t\t\tdata-element=\"booking-change-time-to\"\n\t\t\t\t\t\t:data-ts=\"toTs\"\n\t\t\t\t\t\t:data-booking-id=\"bookingId\"\n\t\t\t\t\t\tref=\"timeTo\"\n\t\t\t\t\t\t@freeze=\"freeze\"\n\t\t\t\t\t\t@unfreeze=\"unfreeze\"\n\t\t\t\t\t\t@enterSave=\"closePopup\"\n\t\t\t\t\t/>\n\t\t\t\t\t<Button\n\t\t\t\t\t\tclass=\"booking-booking-change-time-popup-button\"\n\t\t\t\t\t\t:size=\"ButtonIcon.MEDIUM\"\n\t\t\t\t\t\t:color=\"ButtonColor.PRIMARY\"\n\t\t\t\t\t\t:icon=\"ButtonIcon.DONE\"\n\t\t\t\t\t\t:disabled=\"isBusy\"\n\t\t\t\t\t\t@click=\"closePopup\"\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t\t<div v-if=\"isBusy\" class=\"booking-booking-change-time-popup-error\">\n\t\t\t\t\t{{ loc('BOOKING_BOOKING_TIME_IS_NOT_AVAILABLE') }}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</Popup>\n\t`,\n};\n","import { DateTimeFormat } from 'main.date';\nimport { mapGetters } from 'ui.vue3.vuex';\nimport { Model } from 'booking.const';\nimport type { BookingModel } from 'booking.model.bookings';\nimport { ChangeTimePopup } from './change-time-popup/change-time-popup';\nimport './booking-time.css';\n\nexport const BookingTime = {\n\tprops: {\n\t\tbookingId: {\n\t\t\ttype: [Number, String],\n\t\t\trequired: true,\n\t\t},\n\t\tresourceId: {\n\t\t\ttype: Number,\n\t\t\trequired: true,\n\t\t},\n\t\tdateFromTs: {\n\t\t\ttype: Number,\n\t\t\trequired: true,\n\t\t},\n\t\tdateToTs: {\n\t\t\ttype: Number,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tshowPopup: false,\n\t\t};\n\t},\n\tcomputed: {\n\t\t...mapGetters({\n\t\t\toffset: `${Model.Interface}/offset`,\n\t\t\tisFeatureEnabled: `${Model.Interface}/isFeatureEnabled`,\n\t\t}),\n\t\tbooking(): BookingModel\n\t\t{\n\t\t\treturn this.$store.getters['bookings/getById'](this.bookingId);\n\t\t},\n\t\ttimeFormatted(): string\n\t\t{\n\t\t\tconst timeFormat = DateTimeFormat.getFormat('SHORT_TIME_FORMAT');\n\n\t\t\treturn this.loc('BOOKING_BOOKING_TIME_RANGE', {\n\t\t\t\t'#FROM#': DateTimeFormat.format(timeFormat, (this.dateFromTs + this.offset) / 1000),\n\t\t\t\t'#TO#': DateTimeFormat.format(timeFormat, (this.dateToTs + this.offset) / 1000),\n\t\t\t});\n\t\t},\n\t},\n\tmethods: {\n\t\tclickHandler(): void\n\t\t{\n\t\t\tif (!this.isFeatureEnabled)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.showPopup = true;\n\t\t},\n\t\tclosePopup(): void\n\t\t{\n\t\t\tthis.showPopup = false;\n\t\t},\n\t},\n\tcomponents: {\n\t\tChangeTimePopup,\n\t},\n\ttemplate: `\n\t\t<div\n\t\t\tclass=\"booking-booking-booking-time\"\n\t\t\t:class=\"{'--lock': !isFeatureEnabled}\"\n\t\t\tdata-element=\"booking-booking-time\"\n\t\t\t:data-booking-id=\"bookingId\"\n\t\t\t:data-resource-id=\"resourceId\"\n\t\t\t:data-from=\"booking.dateFromTs\"\n\t\t\t:data-to=\"booking.dateToTs\"\n\t\t\tref=\"time\"\n\t\t\t@click=\"clickHandler\"\n\t\t>\n\t\t\t{{ timeFormatted }}\n\t\t</div>\n\t\t<ChangeTimePopup\n\t\t\tv-if=\"showPopup\"\n\t\t\t:bookingId=\"bookingId\"\n\t\t\t:resourceId=\"resourceId\"\n\t\t\t:targetNode=\"$refs.time\"\n\t\t\t@close=\"closePopup\"\n\t\t/>\n\t`,\n};\n","// @vue/component\n\nimport { Model } from 'booking.const';\nimport { Name } from 'booking.component.booking';\nimport type { BookingModel } from 'booking.model.bookings';\nimport type { ClientData, ClientModel } from 'booking.model.clients';\n\nimport './name.css';\n\nexport const BookingName = {\n\tname: 'BookingName',\n\tcomponents: {\n\t\tName,\n\t},\n\tprops: {\n\t\tbookingId: {\n\t\t\ttype: [Number, String],\n\t\t\trequired: true,\n\t\t},\n\t\tresourceId: {\n\t\t\ttype: Number,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tcomputed: {\n\t\tbooking(): BookingModel\n\t\t{\n\t\t\treturn this.$store.getters[`${Model.Bookings}/getById`](this.bookingId);\n\t\t},\n\t\tclient(): ClientModel\n\t\t{\n\t\t\tconst clientData: ClientData = this.booking.primaryClient;\n\n\t\t\treturn clientData ? this.$store.getters[`${Model.Clients}/getByClientData`](clientData) : null;\n\t\t},\n\t\tbookingName(): string\n\t\t{\n\t\t\treturn this.client?.name || this.booking.name || this.loc('BOOKING_BOOKING_DEFAULT_BOOKING_NAME');\n\t\t},\n\t},\n\ttemplate: `\n\t\t<Name\n\t\t\t:name=\"bookingName\"\n\t\t\tclassName=\"booking-booking-booking-name\"\n\t\t\t:dataAttributes=\"{\n\t\t\t\t'data-element': 'booking-booking-name',\n\t\t\t\t'data-id': bookingId,\n\t\t\t\t'data-resource-id':resourceId,\n\t\t\t}\"\n\t\t/>\n\t`,\n};\n","import { Model } from 'booking.const';\nimport { Note } from 'booking.component.booking';\nimport { NotePopup } from 'booking.component.note-popup';\nimport { bookingService } from 'booking.provider.service.booking-service';\nimport type { BookingModel } from 'booking.model.bookings';\nimport type { NotePopupSavePayload } from 'booking.component.note-popup';\n\nimport './note.css';\n\n// @vue/component\nexport const BookingNote = {\n\tname: 'BookingNote',\n\tcomponents: {\n\t\tNote,\n\t\tNotePopup,\n\t},\n\tprops: {\n\t\tbookingId: {\n\t\t\ttype: [Number, String],\n\t\t\trequired: true,\n\t\t},\n\t\tbindElement: {\n\t\t\ttype: Function,\n\t\t\trequired: true,\n\t\t},\n\t\tvisiblePopup: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t},\n\tcomputed: {\n\t\tbooking(): BookingModel\n\t\t{\n\t\t\treturn this.$store.getters[`${Model.Bookings}/getById`](this.bookingId);\n\t\t},\n\t},\n\twatch: {\n\t\tvisiblePopup(visible: boolean): void\n\t\t{\n\t\t\tif (visible)\n\t\t\t{\n\t\t\t\tthis.$refs.note?.showViewPopup();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.$refs.note?.closeViewPopup();\n\t\t\t}\n\t\t},\n\t},\n\tmethods: {\n\t\tasync saveBookingNote({ note }: NotePopupSavePayload): Promise<void>\n\t\t{\n\t\t\tawait bookingService.update({\n\t\t\t\tid: this.booking.id,\n\t\t\t\tnote,\n\t\t\t});\n\t\t},\n\t},\n\ttemplate: `\n\t\t<Note\n\t\t\tref=\"note\"\n\t\t\t:id=\"bookingId\"\n\t\t\t:note=\"booking.note\"\n\t\t\t:bindElement\n\t\t\tclassName=\"booking-booking-booking-note-button\"\n\t\t\t:dataId=\"bookingId\"\n\t\t\tdataElementPrefix=\"booking\"\n\t\t\t:dataAttributes=\"{\n\t\t\t\t'data-id': bookingId,\n\t\t\t\t'data-element': 'booking-booking-note-button',\n\t\t\t}\"\n\t\t\t@save=\"saveBookingNote\"\n\t\t/>\n\t`,\n};\n","import { CrmEntity, Model } from 'booking.const';\nimport { Profit } from 'booking.component.booking';\nimport type { BookingModel, DealData } from 'booking.model.bookings';\nimport './profit.css';\n\nexport const BookingProfit = {\n\tname: 'BookingProfit',\n\tcomponents: {\n\t\tProfit,\n\t},\n\tprops: {\n\t\tbookingId: {\n\t\t\ttype: [Number, String],\n\t\t\trequired: true,\n\t\t},\n\t\tresourceId: {\n\t\t\ttype: Number,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tcomputed: {\n\t\tbooking(): BookingModel\n\t\t{\n\t\t\treturn this.$store.getters[`${Model.Bookings}/getById`](this.bookingId);\n\t\t},\n\t\tdeal(): DealData | null\n\t\t{\n\t\t\treturn this.booking.externalData?.find((data) => data.entityTypeId === CrmEntity.Deal) ?? null;\n\t\t},\n\t},\n\ttemplate: `\n\t\t<Profit\n\t\t\t:deal\n\t\t\t:dataAttributes=\"{\n\t\t\t\t'data-id': bookingId,\n\t\t\t\t'data-resource-id': resourceId,\n\t\t\t\t'data-element': 'booking-booking-profit'\n\t\t\t}\"\n\t\t\tclassName=\"booking-booking-booking-profit\"\n\t\t/>\n\t`,\n};\n","import { CrmButton } from 'booking.component.booking';\nimport { BookingDealHelper } from 'booking.lib.deal-helper';\n\nexport const BookingCrmButton = {\n\tname: 'BookingCrmButton',\n\tcomponents: {\n\t\tCrmButton,\n\t},\n\tprops: {\n\t\tbookingId: {\n\t\t\ttype: [Number, String],\n\t\t\trequired: true,\n\t\t},\n\t},\n\tsetup(props): { dealHelper: BookingDealHelper }\n\t{\n\t\tconst dealHelper = new BookingDealHelper(props.bookingId);\n\n\t\treturn {\n\t\t\tdealHelper,\n\t\t};\n\t},\n\ttemplate: `\n\t\t<CrmButton\n\t\t\t:dealHelper\n\t\t\t:dataAttributes=\"{\n\t\t\t\t'data-booking-id': bookingId,\n\t\t\t\t'data-element': 'booking-crm-button'\n\t\t\t}\"\n\t\t/>\n\t`,\n};\n","import { mapGetters } from 'ui.vue3.vuex';\nimport { BIcon } from 'ui.icon-set.api.vue';\nimport { Animated, Main } from 'ui.icon-set.api.core';\nimport 'ui.icon-set.animated';\nimport 'ui.icon-set.main';\n\nimport { Counter as UiCounter, CounterSize, CounterColor } from 'booking.component.counter';\nimport { Model, VisitStatus } from 'booking.const';\nimport type { BookingModel } from 'booking.model.bookings';\nimport './counter.css';\n\n// @vue/component\nexport const Counter = {\n\tcomponents: {\n\t\tBIcon,\n\t\tUiCounter,\n\t},\n\tprops: {\n\t\tbookingId: {\n\t\t\ttype: [Number, String],\n\t\t\trequired: true,\n\t\t},\n\t\tnowTs: {\n\t\t\ttype: Number,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tsetup(): Object\n\t{\n\t\treturn {\n\t\t\tAnimated,\n\t\t\tMain,\n\t\t\tCounterColor,\n\t\t\tCounterSize,\n\t\t};\n\t},\n\tcomputed: {\n\t\t...mapGetters({\n\t\t\tnotificationTypes: `${Model.Dictionary}/getNotifications`,\n\t\t}),\n\t\tbooking(): BookingModel\n\t\t{\n\t\t\treturn this.$store.getters[`${Model.Bookings}/getById`](this.bookingId);\n\t\t},\n\t\tshowClocking(): boolean\n\t\t{\n\t\t\tif (this.showCounter || this.isExpiredBooking || this.hasVisitStatus || this.isNotVisited)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tconst notificationTypes = Object.fromEntries(\n\t\t\t\tObject.entries(this.notificationTypes).map(([type, { value }]) => [type, value]),\n\t\t\t);\n\n\t\t\tconst confirmationSent = this.booking.messages?.some(\n\t\t\t\t({ notificationType }) => notificationType === notificationTypes.Confirmation,\n\t\t\t);\n\n\t\t\treturn !this.booking.isConfirmed && confirmationSent;\n\t\t},\n\t\tshowConfirmed(): boolean\n\t\t{\n\t\t\tif (this.showCounter || this.isExpiredBooking || this.isNotVisited)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\treturn this.booking.isConfirmed;\n\t\t},\n\t\tshowCounter(): boolean\n\t\t{\n\t\t\treturn this.booking.counter > 0;\n\t\t},\n\t\tisExpiredBooking(): boolean\n\t\t{\n\t\t\treturn this.nowTs > this.booking.dateToTs;\n\t\t},\n\t\thasVisitStatus(): boolean\n\t\t{\n\t\t\treturn [VisitStatus.Visited, VisitStatus.NotVisited].includes(this.booking.visitStatus);\n\t\t},\n\t\tisNotVisited(): boolean\n\t\t{\n\t\t\tconst started = this.nowTs > this.booking.dateFromTs;\n\t\t\tconst statusUnknown = this.booking.visitStatus === VisitStatus.Unknown;\n\t\t\tconst statusNotVisited = this.booking.visitStatus === VisitStatus.NotVisited;\n\n\t\t\treturn (started && statusUnknown) || statusNotVisited;\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"booking--counter\">\n\t\t\t<div v-if=\"showClocking\" class=\"booking-counter-icon --clocking\">\n\t\t\t\t<BIcon :name=\"Animated.LOADER_CLOCK\" :hoverable=\"false\"/>\n\t\t\t</div>\n\t\t\t<div v-else-if=\"showConfirmed\" class=\"booking-counter-icon --confirmed\">\n\t\t\t\t<BIcon :name=\"Main.CHECK\" :hoverable=\"false\"/>\n\t\t\t</div>\n\t\t\t<UiCounter\n\t\t\t\tv-else-if=\"showCounter\"\n\t\t\t\t:value=\"booking.counter\"\n\t\t\t\t:color=\"CounterColor.DANGER\"\n\t\t\t\t:size=\"CounterSize.LARGE\"\n\t\t\t\tborder\n\t\t\t/>\n\t\t</div>\n\t`,\n};\n","import { Dom, Event } from 'main.core';\nimport { Popup, PopupOptions } from 'main.popup';\nimport { mapGetters } from 'ui.vue3.vuex';\n\nimport { Model } from 'booking.const';\nimport { Duration } from 'booking.lib.duration';\nimport { isRealId } from 'booking.lib.is-real-id';\nimport { busySlots } from 'booking.lib.busy-slots';\nimport { grid } from 'booking.lib.grid';\nimport { bookingService } from 'booking.provider.service.booking-service';\nimport type { BookingModel, OverbookingMap } from 'booking.model.bookings';\n\nimport './resize.css';\n\nconst ResizeDirection = Object.freeze({\n\tFrom: -1,\n\tNone: 0,\n\tTo: 1,\n});\n\nconst minDuration = Duration.getUnitDurations().i * 5;\nconst minInitialDuration = Duration.getUnitDurations().i * 15;\n\n// @vue/component\nexport const Resize = {\n\tname: 'BookingResize',\n\tprops: {\n\t\tbookingId: {\n\t\t\ttype: [Number, String],\n\t\t\trequired: true,\n\t\t},\n\t\tresourceId: {\n\t\t\ttype: Number,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tsetup(): { tooltipTop: Popup | null, tooltipBottom: Popup | null }\n\t{\n\t\tconst tooltipTop = null;\n\t\tconst tooltipBottom = null;\n\n\t\treturn {\n\t\t\ttooltipTop,\n\t\t\ttooltipBottom,\n\t\t};\n\t},\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tresizeDirection: ResizeDirection.None,\n\t\t\tresizeFromTs: null,\n\t\t\tresizeToTs: null,\n\t\t};\n\t},\n\tcomputed: {\n\t\t...mapGetters({\n\t\t\tselectedDateTs: `${Model.Interface}/selectedDateTs`,\n\t\t\toverbookingMap: `${Model.Bookings}/overbookingMap`,\n\t\t}),\n\t\tbooking(): BookingModel\n\t\t{\n\t\t\treturn this.$store.getters[`${Model.Bookings}/getById`](this.bookingId);\n\t\t},\n\t\tlimits(): { fromTs: number, toTs: number }\n\t\t{\n\t\t\treturn {\n\t\t\t\tfromTs: new Date(this.selectedDateTs).setHours(0, 0, 0, 0),\n\t\t\t\ttoTs: new Date(this.selectedDateTs).setHours(24, 0, 0, 0),\n\t\t\t};\n\t\t},\n\t\tinitialHeight(): number\n\t\t{\n\t\t\treturn grid.calculateHeight(this.booking.dateFromTs, this.booking.dateToTs);\n\t\t},\n\t\tinitialDuration(): number\n\t\t{\n\t\t\treturn Math.max(this.booking.dateToTs - this.booking.dateFromTs, minInitialDuration);\n\t\t},\n\t\tdateFromTsRounded(): number\n\t\t{\n\t\t\treturn this.roundTimestamp(this.resizeFromTs);\n\t\t},\n\t\tdateToTsRounded(): number\n\t\t{\n\t\t\treturn this.roundTimestamp(this.resizeToTs);\n\t\t},\n\t\tclosestOnFrom(): number\n\t\t{\n\t\t\treturn this.colliding.reduce((closest, { toTs }) => {\n\t\t\t\treturn (closest < toTs && toTs <= this.booking.dateFromTs) ? toTs : closest;\n\t\t\t}, 0);\n\t\t},\n\t\tclosestOnTo(): number\n\t\t{\n\t\t\treturn this.colliding.reduce((closest, { fromTs }) => {\n\t\t\t\treturn (this.booking.dateToTs <= fromTs && fromTs < closest) ? fromTs : closest;\n\t\t\t}, Infinity);\n\t\t},\n\t\texcludeBookings(): number[] | (booking: BookingModel) => boolean\n\t\t{\n\t\t\t// return when overbooking option disabled\n\t\t\t// \treturn [this.bookingId];\n\t\t\tconst overbookingMap: OverbookingMap = this.overbookingMap;\n\n\t\t\treturn (booking: BookingModel) => {\n\t\t\t\tif (booking.id === this.bookingId)\n\t\t\t\t{\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\n\t\t\t\tconst overbooking = overbookingMap.get(booking.id);\n\t\t\t\tconst resourcesIds = this.booking.resourcesIds;\n\n\t\t\t\treturn !overbooking || overbooking.items.every((item) => !resourcesIds.includes(item.resourceId));\n\t\t\t};\n\t\t},\n\t\tcolliding(): { fromTs: number, toTs: number }[]\n\t\t{\n\t\t\treturn this.$store.getters[`${Model.Interface}/getColliding`](\n\t\t\t\tthis.booking.resourcesIds,\n\t\t\t\tthis.excludeBookings,\n\t\t\t);\n\t\t},\n\t\thasIntersections(): boolean\n\t\t{\n\t\t\treturn this.booking.resourcesIds.length > 1;\n\t\t},\n\t},\n\tmethods: {\n\t\tcreatePopup(options: Partial<PopupOptions>): Popup\n\t\t{\n\t\t\treturn new Popup({\n\t\t\t\tautoHide: true,\n\t\t\t\tcacheable: true,\n\t\t\t\tdarkMode: true,\n\t\t\t\t...options,\n\t\t\t});\n\t\t},\n\t\tshowTooltipTop(options: Partial<PopupOptions>): void\n\t\t{\n\t\t\tif (!this.tooltipTop)\n\t\t\t{\n\t\t\t\tthis.tooltipTop = this.createPopup({\n\t\t\t\t\tid: `resize-top-${this.bookingId}-${this.resourceId}`,\n\t\t\t\t\tbindElement: this.$refs.bookingResizeTop,\n\t\t\t\t\tbindOptions: {\n\t\t\t\t\t\tposition: 'bottom',\n\t\t\t\t\t},\n\t\t\t\t\toffsetLeft: this.$refs.bookingResizeTop.offsetWidth / 2,\n\t\t\t\t\tcontent: this.loc('BOOKING_RESIZE_GRID_LIMIT'),\n\t\t\t\t\t...options,\n\t\t\t\t});\n\t\t\t}\n\t\t\telse if (options?.content)\n\t\t\t{\n\t\t\t\tthis.tooltipTop.setContent(options.content);\n\t\t\t}\n\n\t\t\tthis.tooltipTop.show();\n\t\t},\n\t\tshowTooltipBottom(options: Partial<PopupOptions>): void\n\t\t{\n\t\t\tif (!this.tooltipBottom)\n\t\t\t{\n\t\t\t\tthis.tooltipBottom = this.createPopup({\n\t\t\t\t\tid: `resize-bottom-${this.bookingId}-${this.resourceId}`,\n\t\t\t\t\tbindElement: this.$refs.bookingResizeBottom,\n\t\t\t\t\tbindOptions: {\n\t\t\t\t\t\tposition: 'bottom',\n\t\t\t\t\t},\n\t\t\t\t\toffsetLeft: this.$refs.bookingResizeBottom.offsetWidth / 2,\n\t\t\t\t\tcontent: this.loc('BOOKING_RESIZE_GRID_LIMIT'),\n\t\t\t\t\t...options,\n\t\t\t\t});\n\t\t\t}\n\t\t\telse if (options?.content)\n\t\t\t{\n\t\t\t\tthis.tooltipBottom.setContent(options.content);\n\t\t\t}\n\n\t\t\tthis.tooltipBottom.show();\n\t\t},\n\t\thideTooltips(): void\n\t\t{\n\t\t\tthis.tooltipTop?.close?.();\n\t\t\tthis.tooltipBottom?.close?.();\n\t\t},\n\t\tonMouseDown(event: MouseEvent): void\n\t\t{\n\t\t\tconst direction = Dom.hasClass(event.target, '--from') ? ResizeDirection.From : ResizeDirection.To;\n\n\t\t\tvoid this.startResize(direction);\n\t\t},\n\t\tasync startResize(direction: number = ResizeDirection.To): Promise<void>\n\t\t{\n\t\t\tDom.style(document.body, 'user-select', 'none');\n\t\t\tEvent.bind(window, 'mouseup', this.endResize);\n\t\t\tEvent.bind(window, 'pointermove', this.resize);\n\t\t\tthis.resizeDirection = direction;\n\n\t\t\tvoid this.updateIds(this.bookingId, this.resourceId);\n\t\t},\n\t\tresize(event: MouseEvent): void\n\t\t{\n\t\t\tif (!this.resizeDirection)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst resizeHeight = this.resizeDirection === ResizeDirection.To\n\t\t\t\t? (event.clientY - this.$el.getBoundingClientRect().top)\n\t\t\t\t: (this.$el.getBoundingClientRect().bottom - event.clientY)\n\t\t\t;\n\t\t\tconst duration = resizeHeight * this.initialDuration / this.initialHeight;\n\t\t\tconst newDuration = Math.max(duration, minDuration);\n\n\t\t\tif (this.resizeDirection === ResizeDirection.To)\n\t\t\t{\n\t\t\t\tconst resizeToTs = this.booking.dateFromTs + newDuration;\n\t\t\t\tconst toTs = Math.min(resizeToTs, this.limits.toTs);\n\n\t\t\t\tthis.manageToLimitNotification(resizeToTs, toTs);\n\n\t\t\t\tthis.resizeFromTs = this.booking.dateFromTs;\n\t\t\t\tthis.resizeToTs = Math.min(toTs, this.closestOnTo);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tconst resizeFromTs = this.booking.dateToTs - newDuration;\n\t\t\t\tconst fromTs = Math.max(resizeFromTs, this.limits.fromTs);\n\n\t\t\t\tthis.manageFromLimitNotification(resizeFromTs, fromTs);\n\n\t\t\t\tthis.resizeFromTs = Math.max(fromTs, this.closestOnFrom);\n\t\t\t\tthis.resizeToTs = this.booking.dateToTs;\n\t\t\t}\n\n\t\t\tthis.$emit('update', this.resizeFromTs, this.resizeToTs);\n\t\t},\n\t\tasync endResize(): Promise<void>\n\t\t{\n\t\t\tthis.resizeBooking();\n\t\t\tthis.hideTooltips();\n\n\t\t\tDom.style(document.body, 'user-select', '');\n\t\t\tEvent.unbind(window, 'mouseup', this.endResize);\n\t\t\tEvent.unbind(window, 'pointermove', this.resize);\n\t\t\tthis.$emit('update', null, null);\n\n\t\t\tawait this.updateIds(null, null);\n\t\t},\n\t\tmanageFromLimitNotification(resizeFromTs: number, fromTs: number): void\n\t\t{\n\t\t\tconst colliding = this.colliding.filter(({ toTs }) => toTs === this.closestOnFrom);\n\n\t\t\tif (resizeFromTs < this.limits.fromTs)\n\t\t\t{\n\t\t\t\tthis.showTooltipTop({\n\t\t\t\t\tcontent: this.loc('BOOKING_RESIZE_GRID_LIMIT'),\n\t\t\t\t});\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (fromTs < this.closestOnFrom)\n\t\t\t{\n\t\t\t\tif (this.checkClosestByIntersection(colliding))\n\t\t\t\t{\n\t\t\t\t\tthis.showTooltipTop({\n\t\t\t\t\t\tcontent: this.loc('BOOKING_RESIZE_INTERSECTIONS_LIMIT'),\n\t\t\t\t\t});\n\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tthis.showTooltipTop({\n\t\t\t\t\tcontent: this.loc('BOOKING_RESIZE_LIMIT'),\n\t\t\t\t});\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.hideTooltips();\n\t\t},\n\t\tmanageToLimitNotification(resizeToTs: number, toTs: number): void\n\t\t{\n\t\t\tconst colliding = this.colliding.filter(({ fromTs }) => fromTs === this.closestOnTo);\n\n\t\t\tif (resizeToTs > this.limits.toTs)\n\t\t\t{\n\t\t\t\tthis.showTooltipBottom({\n\t\t\t\t\tcontent: this.loc('BOOKING_RESIZE_GRID_LIMIT'),\n\t\t\t\t});\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (toTs > this.closestOnTo)\n\t\t\t{\n\t\t\t\tif (this.checkClosestByIntersection(colliding))\n\t\t\t\t{\n\t\t\t\t\tthis.showTooltipBottom({\n\t\t\t\t\t\tcontent: this.loc('BOOKING_RESIZE_INTERSECTIONS_LIMIT'),\n\t\t\t\t\t});\n\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tthis.showTooltipBottom({\n\t\t\t\t\tcontent: this.loc('BOOKING_RESIZE_LIMIT'),\n\t\t\t\t});\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.hideTooltips();\n\t\t},\n\t\tcheckClosestByIntersection(colliding): boolean\n\t\t{\n\t\t\treturn (\n\t\t\t\tthis.hasIntersections\n\t\t\t\t&& (\n\t\t\t\t\tcolliding.length === 1\n\t\t\t\t\t|| colliding.filter((coll) => coll.resourcesIds[0] !== this.resourceId).length >= 2\n\t\t\t\t)\n\t\t\t);\n\t\t},\n\t\tasync updateIds(bookingId: number, resourceId: number): Promise<void>\n\t\t{\n\t\t\tawait Promise.all([\n\t\t\t\tthis.$store.dispatch(`${Model.Interface}/setResizedBookingId`, bookingId),\n\t\t\t\tthis.$store.dispatch(`${Model.Interface}/setDraggedBookingResourceId`, resourceId),\n\t\t\t]);\n\n\t\t\tvoid busySlots.loadBusySlots();\n\t\t},\n\t\tresizeBooking(): void\n\t\t{\n\t\t\tif (!this.dateFromTsRounded || !this.dateToTsRounded)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (this.dateFromTsRounded === this.booking.dateFromTs && this.dateToTsRounded === this.booking.dateToTs)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst resource = this.$store.getters[`${Model.Resources}/getById`](this.resourceId);\n\t\t\tif (resource.isDeleted)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst id = this.bookingId;\n\t\t\tconst booking = {\n\t\t\t\tid,\n\t\t\t\tdateFromTs: this.dateFromTsRounded,\n\t\t\t\tdateToTs: this.dateToTsRounded,\n\t\t\t\ttimezoneFrom: this.booking.timezoneFrom,\n\t\t\t\ttimezoneTo: this.booking.timezoneTo,\n\t\t\t};\n\n\t\t\tif (!isRealId(this.bookingId))\n\t\t\t{\n\t\t\t\tvoid this.$store.dispatch(`${Model.Bookings}/update`, { id, booking });\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tvoid bookingService.update({\n\t\t\t\tid,\n\t\t\t\t...booking,\n\t\t\t});\n\t\t},\n\t\troundTimestamp(timestamp: number): void\n\t\t{\n\t\t\tconst fiveMinutes = Duration.getUnitDurations().i * 5;\n\n\t\t\treturn Math.round(timestamp / fiveMinutes) * fiveMinutes;\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div>\n\t\t\t<div ref=\"bookingResizeTop\" class=\"booking-booking-resize --from\" @mousedown=\"onMouseDown\"></div>\n\t\t\t<div ref=\"bookingResizeBottom\" class=\"booking-booking-resize --to\" @mousedown=\"onMouseDown\"></div>\n\t\t</div>\n\t`,\n};\n","export const BookingWidth = 280;\n","import { mapGetters } from 'ui.vue3.vuex';\n\nimport { DraggedElementKind, Model, VisitStatus } from 'booking.const';\nimport { Communication, DisabledPopup } from 'booking.component.booking';\nimport { Duration } from 'booking.lib.duration';\nimport { mousePosition } from 'booking.lib.mouse-position';\nimport { isRealId } from 'booking.lib.is-real-id';\nimport { grid } from 'booking.lib.grid';\nimport type { BookingModel } from 'booking.model.bookings';\nimport type { ClientModel, ClientData } from 'booking.model.clients';\n\nimport { BookingAddClient } from './add-client/add-client';\nimport { BookingTime } from './booking-time/booking-time';\nimport { Actions } from './actions/actions';\nimport { BookingName } from './name/name';\nimport { BookingNote } from './note/note';\nimport { BookingProfit } from './profit/profit';\nimport { BookingCrmButton } from './crm-button/crm-button';\nimport { Counter } from './counter/counter';\nimport { Resize } from './resize/resize';\nimport { BookingWidth } from './const';\nimport type { BookingUiDuration } from './types';\nimport './booking.css';\n\nexport type { BookingUiDuration };\n\n// @vue/component\nexport const BookingBase = {\n\tname: 'BookingBase',\n\tprops: {\n\t\tbookingId: {\n\t\t\ttype: [Number, String],\n\t\t\trequired: true,\n\t\t},\n\t\tresourceId: {\n\t\t\ttype: Number,\n\t\t\trequired: true,\n\t\t},\n\t\tnowTs: {\n\t\t\ttype: Number,\n\t\t\trequired: true,\n\t\t},\n\t\twidth: {\n\t\t\ttype: Number,\n\t\t\tdefault: BookingWidth,\n\t\t},\n\t\tleftOffset: {\n\t\t\ttype: Number,\n\t\t\tdefault: 0,\n\t\t},\n\t\tbookingClass: {\n\t\t\ttype: [String, Object, Array],\n\t\t\tdefault: '',\n\t\t},\n\t\tbookingStyle: {\n\t\t\ttype: [String, Object, Array],\n\t\t\tdefault: '',\n\t\t},\n\t},\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tvisible: true,\n\t\t\tisDisabledPopupShown: false,\n\t\t\tresizeFromTs: null,\n\t\t\tresizeToTs: null,\n\t\t\tvisibleNotePopup: false,\n\t\t};\n\t},\n\tmounted(): void\n\t{\n\t\tthis.updateVisibility();\n\t\tthis.updateVisibilityDuringTransition();\n\n\t\tsetTimeout(() => {\n\t\t\tif (!this.isReal && mousePosition.isMousePressed())\n\t\t\t{\n\t\t\t\tvoid this.$refs.resize.startResize();\n\t\t\t}\n\t\t}, 300);\n\t},\n\tbeforeUnmount(): void\n\t{\n\t\tif (this.deletingBookings[this.bookingId] || !this.booking?.resourcesIds.includes(this.resourceId))\n\t\t{\n\t\t\tthis.$el.remove();\n\t\t}\n\t},\n\tcomputed: {\n\t\t...mapGetters({\n\t\t\tresourcesIds: `${Model.Interface}/resourcesIds`,\n\t\t\tzoom: `${Model.Interface}/zoom`,\n\t\t\tscroll: `${Model.Interface}/scroll`,\n\t\t\tdraggedBookingId: `${Model.Interface}/draggedBookingId`,\n\t\t\tdraggedDataTransfer: `${Model.Interface}/draggedDataTransfer`,\n\t\t\teditingBookingId: `${Model.Interface}/editingBookingId`,\n\t\t\tisEditingBookingMode: `${Model.Interface}/isEditingBookingMode`,\n\t\t\tdeletingBookings: `${Model.Interface}/deletingBookings`,\n\t\t}),\n\t\tisReal(): boolean\n\t\t{\n\t\t\treturn isRealId(this.bookingId);\n\t\t},\n\t\tbooking(): BookingModel\n\t\t{\n\t\t\treturn this.$store.getters[`${Model.Bookings}/getById`](this.bookingId);\n\t\t},\n\t\tclient(): ClientModel\n\t\t{\n\t\t\tconst clientData: ClientData = this.booking.primaryClient;\n\n\t\t\treturn clientData ? this.$store.getters[`${Model.Clients}/getByClientData`](clientData) : null;\n\t\t},\n\t\tleft(): number\n\t\t{\n\t\t\treturn grid.calculateLeft(this.resourceId);\n\t\t},\n\t\ttop(): number\n\t\t{\n\t\t\treturn grid.calculateTop(this.dateFromTs);\n\t\t},\n\t\theight(): number\n\t\t{\n\t\t\treturn grid.calculateHeight(this.dateFromTs, this.dateToTs);\n\t\t},\n\t\trealHeight(): number\n\t\t{\n\t\t\treturn grid.calculateRealHeight(this.dateFromTs, this.dateToTs);\n\t\t},\n\t\tdateFromTs(): number\n\t\t{\n\t\t\treturn this.resizeFromTs ?? this.booking.dateFromTs;\n\t\t},\n\t\tdateToTs(): number\n\t\t{\n\t\t\treturn this.resizeToTs ?? this.booking.dateToTs;\n\t\t},\n\t\tdateFromTsRounded(): number\n\t\t{\n\t\t\treturn this.roundTimestamp(this.resizeFromTs) ?? this.dateFromTs;\n\t\t},\n\t\tdateToTsRounded(): number\n\t\t{\n\t\t\treturn this.roundTimestamp(this.resizeToTs) ?? this.dateToTs;\n\t\t},\n\t\tdisabled(): boolean\n\t\t{\n\t\t\treturn this.isEditingBookingMode && this.editingBookingId !== this.bookingId;\n\t\t},\n\t\tbookingOffset(): number\n\t\t{\n\t\t\treturn this.leftOffset * this.zoom;\n\t\t},\n\t\tisExpiredBooking(): boolean\n\t\t{\n\t\t\treturn this.booking.dateToTs < this.nowTs;\n\t\t},\n\t\tisNotVisited(): boolean\n\t\t{\n\t\t\tconst started = this.nowTs > this.booking.dateFromTs;\n\t\t\tconst statusUnknown = this.booking.visitStatus === VisitStatus.Unknown;\n\t\t\tconst statusNotVisited = this.booking.visitStatus === VisitStatus.NotVisited;\n\n\t\t\treturn (started && statusUnknown) || statusNotVisited;\n\t\t},\n\t\tdisabledHover(): boolean\n\t\t{\n\t\t\treturn (\n\t\t\t\tthis.draggedDataTransfer.id > 0\n\t\t\t\t&& (\n\t\t\t\t\tthis.draggedDataTransfer.kind !== DraggedElementKind.Booking\n\t\t\t\t\t|| this.draggedDataTransfer.id !== this.bookingId\n\t\t\t\t)\n\t\t\t);\n\t\t},\n\t},\n\tmethods: {\n\t\tupdateVisibilityDuringTransition(): void\n\t\t{\n\t\t\tthis.animation?.stop();\n\t\t\t// eslint-disable-next-line new-cap\n\t\t\tthis.animation = new BX.easing({\n\t\t\t\tduration: 200,\n\t\t\t\tstart: {},\n\t\t\t\tfinish: {},\n\t\t\t\tstep: this.updateVisibility,\n\t\t\t});\n\t\t\tthis.animation.animate();\n\t\t},\n\t\tupdateVisibility(): void\n\t\t{\n\t\t\tif (!this.$el)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst rect = this.$el.getBoundingClientRect();\n\t\t\tthis.visible = rect.right > 0 && rect.left < window.innerWidth;\n\t\t},\n\t\tonNoteMouseEnter(): void\n\t\t{\n\t\t\tthis.showNoteTimeout = setTimeout((): void => {\n\t\t\t\tthis.visibleNotePopup = true;\n\t\t\t}, 100);\n\t\t},\n\t\tonNoteMouseLeave(): void\n\t\t{\n\t\t\tclearTimeout(this.showNoteTimeout);\n\t\t\tthis.visibleNotePopup = false;\n\t\t},\n\t\tonClick(event: PointerEvent): void\n\t\t{\n\t\t\tif (this.disabled)\n\t\t\t{\n\t\t\t\tthis.isDisabledPopupShown = true;\n\n\t\t\t\tevent.stopPropagation();\n\t\t\t}\n\t\t},\n\t\tresizeUpdate(resizeFromTs: number | null, resizeToTs: number | null): void\n\t\t{\n\t\t\tthis.resizeFromTs = resizeFromTs;\n\t\t\tthis.resizeToTs = resizeToTs;\n\t\t},\n\t\troundTimestamp(timestamp: number | null): number | null\n\t\t{\n\t\t\tconst fiveMinutes = Duration.getUnitDurations().i * 5;\n\n\t\t\treturn timestamp ? Math.round(timestamp / fiveMinutes) * fiveMinutes : null;\n\t\t},\n\t},\n\twatch: {\n\t\tscroll(): void\n\t\t{\n\t\t\tthis.updateVisibility();\n\t\t},\n\t\tzoom(): void\n\t\t{\n\t\t\tthis.updateVisibility();\n\t\t},\n\t\tresourcesIds(): void\n\t\t{\n\t\t\tthis.updateVisibilityDuringTransition();\n\t\t},\n\t\tvisible(visible): void\n\t\t{\n\t\t\tif (visible)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tsetTimeout(() => {\n\t\t\t\tthis.updateVisibility();\n\t\t\t}, 2000);\n\t\t},\n\t},\n\tcomponents: {\n\t\tActions,\n\t\tBookingAddClient,\n\t\tBookingCrmButton,\n\t\tBookingTime,\n\t\tBookingName,\n\t\tBookingNote,\n\t\tBookingProfit,\n\t\tCommunication,\n\t\tCounter,\n\t\tDisabledPopup,\n\t\tResize,\n\t},\n\ttemplate: `\n\t\t<div\n\t\t\tclass=\"booking-booking-booking booking--draggable-item\"\n\t\t\tdata-element=\"booking-booking\"\n\t\t\t:data-id=\"bookingId\"\n\t\t\t:data-resource-id=\"resourceId\"\n\t\t\tdata-kind=\"booking\"\n\t\t\t:style=\"[bookingStyle, {\n\t\t\t\t'--left': left + bookingOffset + 'px',\n\t\t\t\t'--top': top + 'px',\n\t\t\t\t'--height': height + 'px',\n\t\t\t\t'--width': width + 'px',\n\t\t\t}].flat(1)\"\n\t\t\t:class=\"[bookingClass, {\n\t\t\t\t'--not-real': !isReal,\n\t\t\t\t'--zoom-is-less-than-08': zoom < 0.8,\n\t\t\t\t'--compact-mode': realHeight < 40 || zoom < 0.8,\n\t\t\t\t'--small': realHeight <= 15,\n\t\t\t\t'--long': realHeight >= 65,\n\t\t\t\t'--disabled': disabled,\n\t\t\t\t'--confirmed': booking.isConfirmed && !isNotVisited,\n\t\t\t\t'--expired': isExpiredBooking,\n\t\t\t\t'--not-visited': isNotVisited,\n\t\t\t\t'--resizing': resizeFromTs && resizeToTs,\n\t\t\t\t'--no-pointer-events': disabledHover,\n\t\t\t}].flat(1)\"\n\t\t\t@click.capture=\"onClick\"\n\t\t>\n\t\t\t<div v-if=\"visible\" class=\"booking-booking-booking-padding\">\n\t\t\t\t<Counter :bookingId=\"bookingId\" :nowTs=\"nowTs\"/>\n\t\t\t\t<div class=\"booking-booking-booking-inner\">\n\t\t\t\t\t<div class=\"booking-booking-booking-content\">\n\t\t\t\t\t\t<div class=\"booking-booking-booking-content-row\">\n\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\tclass=\"booking-booking-booking-name-container\"\n\t\t\t\t\t\t\t\t@mouseenter=\"onNoteMouseEnter\"\n\t\t\t\t\t\t\t\t@mouseleave=\"onNoteMouseLeave\"\n\t\t\t\t\t\t\t\t@click=\"visibleNotePopup = true\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<BookingName :bookingId=\"bookingId\" :resourceId=\"resourceId\"/>\n\t\t\t\t\t\t\t\t<BookingNote\n\t\t\t\t\t\t\t\t\t:bookingId=\"bookingId\"\n\t\t\t\t\t\t\t\t\t:bindElement=\"() => $el\"\n\t\t\t\t\t\t\t\t\t:visiblePopup=\"visibleNotePopup\"\n\t\t\t\t\t\t\t\t\tref=\"note\"\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<BookingTime\n\t\t\t\t\t\t\t\t:bookingId=\"bookingId\"\n\t\t\t\t\t\t\t\t:resourceId=\"resourceId\"\n\t\t\t\t\t\t\t\t:dateFromTs=\"dateFromTsRounded\"\n\t\t\t\t\t\t\t\t:dateToTs=\"dateToTsRounded\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t<BookingProfit :bookingId=\"bookingId\" :resourceId=\"resourceId\"/>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"booking-booking-booking-content-row --lower\">\n\t\t\t\t\t\t\t<BookingTime\n\t\t\t\t\t\t\t\t:bookingId=\"bookingId\"\n\t\t\t\t\t\t\t\t:resourceId=\"resourceId\"\n\t\t\t\t\t\t\t\t:dateFromTs=\"dateFromTsRounded\"\n\t\t\t\t\t\t\t\t:dateToTs=\"dateToTsRounded\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t<div v-if=\"client\" class=\"booking-booking-booking-buttons\">\n\t\t\t\t\t\t\t\t<Communication/>\n\t\t\t\t\t\t\t\t<BookingCrmButton :bookingId=\"bookingId\"/>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<BookingAddClient\n\t\t\t\t\t\t\t\tv-else\n\t\t\t\t\t\t\t\t:bookingId=\"bookingId\"\n\t\t\t\t\t\t\t\t:resourceId=\"resourceId\"\n\t\t\t\t\t\t\t\t:expired=\"isExpiredBooking\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<slot name=\"actions\">\n\t\t\t\t\t\t<Actions :bookingId=\"bookingId\" :resourceId=\"resourceId\"/>\n\t\t\t\t\t</slot>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<Resize\n\t\t\t\tv-if=\"!disabled\"\n\t\t\t\t:bookingId=\"bookingId\"\n\t\t\t\t:resourceId=\"resourceId\"\n\t\t\t\tref=\"resize\"\n\t\t\t\t@update=\"resizeUpdate\"\n\t\t\t/>\n\t\t\t<DisabledPopup\n\t\t\t\tv-if=\"isDisabledPopupShown\"\n\t\t\t\t:popupId=\"['booking-booking-disabled-popup', bookingId, resourceId].join('-')\"\n\t\t\t\t:bindElement=\"() => $el\"\n\t\t\t\tcontentClass=\"booking-booking-disabled-popup-content\"\n\t\t\t\t@close=\"isDisabledPopupShown = false\"\n\t\t\t/>\n\t\t\t<slot/>\n\t\t</div>\n\t`,\n};\n","import type { BookingModel } from 'booking.model.bookings';\nimport type { Occupancy } from 'booking.model.interface';\n\ntype GetOverbookingFreeSpaceProps = {\n\tbooking: BookingModel,\n\tcolliding: Occupancy[],\n\tselectedDateTs: number,\n\tdraggedBookingResourcesIds: number[],\n};\n\nexport function getOverbookingFreeSpace({\n\tbooking,\n\tcolliding,\n\tselectedDateTs,\n\tdraggedBookingResourcesIds,\n}: GetOverbookingFreeSpaceProps): { fromTs: number, toTs: number }\n{\n\tconst minTs = new Date(selectedDateTs).setHours(0, 0, 0, 0);\n\tconst maxTs = new Date(selectedDateTs).setHours(24, 0, 0, 0);\n\tconst freeSpace = {\n\t\tfromTs: minTs,\n\t\ttoTs: maxTs,\n\t};\n\n\tif (draggedBookingResourcesIds.length > 1)\n\t{\n\t\tconst bookingColliding = colliding.find(({ fromTs }) => fromTs === booking.dateFromTs);\n\t\tif (bookingColliding && draggedBookingResourcesIds.every((id) => bookingColliding.resourcesIds.includes(id)))\n\t\t{\n\t\t\treturn null;\n\t\t}\n\t}\n\n\tfor (const { fromTs, toTs } of colliding)\n\t{\n\t\tif (toTs <= booking.dateFromTs)\n\t\t{\n\t\t\tfreeSpace.fromTs = Math.max(freeSpace.fromTs, toTs);\n\t\t}\n\n\t\tif (booking.dateToTs <= fromTs)\n\t\t{\n\t\t\tfreeSpace.toTs = Math.min(freeSpace.toTs, fromTs);\n\t\t}\n\t}\n\n\tif (freeSpace.fromTs === minTs && freeSpace.toTs === maxTs)\n\t{\n\t\treturn null;\n\t}\n\n\treturn freeSpace;\n}\n\nexport function findTimeForDroppedBooking(freeSpace: Occupancy, booking: BookingModel, droppedBooking: BookingModel): {\n\tdateFromTs: number,\n\tdateToTs: number\n}\n{\n\tconst duration = droppedBooking.dateToTs - droppedBooking.dateFromTs;\n\tif (booking.dateFromTs >= freeSpace.fromTs && booking.dateFromTs + duration <= freeSpace.toTs)\n\t{\n\t\treturn {\n\t\t\tdateFromTs: booking.dateFromTs,\n\t\t\tdateToTs: booking.dateFromTs + duration,\n\t\t};\n\t}\n\n\tif (booking.dateToTs - duration >= freeSpace.fromTs && booking.dateToTs <= freeSpace.toTs)\n\t{\n\t\treturn {\n\t\t\tdateFromTs: booking.dateToTs - duration,\n\t\t\tdateToTs: booking.dateToTs,\n\t\t};\n\t}\n\n\treturn {\n\t\tdateFromTs: freeSpace.fromTs,\n\t\tdateToTs: freeSpace.fromTs + duration,\n\t};\n}\n","export { getOverbookingFreeSpace, findTimeForDroppedBooking } from './overbooking-free-space';\n\nimport type { BookingId } from 'booking.model.bookings';\nimport { OverlappingBookings } from '../types';\nimport { BookingWidth } from '../const';\n\nexport function countBookingWidth(overlappingBookings: OverlappingBookings): number\n{\n\tconst overlappingBookingsCount = overlappingBookings.length > 0 ? overlappingBookings.length : 1;\n\n\treturn BookingWidth / overlappingBookingsCount;\n}\n\ntype CountBookingLeftOffsetProps = {\n\tbookingId: BookingId,\n\tbookingWidth: number,\n\toverlappingBookings: OverlappingBookings,\n}\n\nexport function countBookingLeftOffset({\n\tbookingId,\n\tbookingWidth,\n\toverlappingBookings,\n}: CountBookingLeftOffsetProps): number\n{\n\tlet index = overlappingBookings.indexOf(bookingId);\n\tif (index === -1)\n\t{\n\t\tindex = 0;\n\t}\n\n\treturn bookingWidth * index;\n}\n","import { Event, Type } from 'main.core';\nimport { mapGetters } from 'ui.vue3.vuex';\n\nimport { Model, DraggedElementKind } from 'booking.const';\nimport { isRealId } from 'booking.lib.is-real-id';\nimport { BookingAnalytics } from 'booking.lib.analytics';\nimport { bookingService } from 'booking.provider.service.booking-service';\nimport type {\n\tBookingModel,\n\tOverbookingMapItem,\n\tOverbookingResourceIntersections,\n} from 'booking.model.bookings';\nimport type { Occupancy, DraggedDataTransfer } from 'booking.model.interface';\n\nimport { Actions } from './actions/actions';\nimport { BookingBase } from './booking-base';\nimport './booking.css';\nimport {\n\tcountBookingLeftOffset,\n\tcountBookingWidth,\n\tgetOverbookingFreeSpace,\n\tfindTimeForDroppedBooking,\n} from './lib';\nimport type {\n\tBookingUiDuration,\n\tOverlappingBookings,\n} from './types';\nimport type { ActionsPopupOptions } from './actions/actions';\n\nexport type { BookingUiDuration };\n\n// @vue/component\nexport const Booking = {\n\tname: 'Booking',\n\tcomponents: {\n\t\tBookingBase,\n\t\tActions,\n\t},\n\tprops: {\n\t\tbookingId: {\n\t\t\ttype: [Number, String],\n\t\t\trequired: true,\n\t\t},\n\t\tresourceId: {\n\t\t\ttype: Number,\n\t\t\trequired: true,\n\t\t},\n\t\tnowTs: {\n\t\t\ttype: Number,\n\t\t\trequired: true,\n\t\t},\n\t\t/**\n\t\t * @param {BookingUiGroup[]} bookingUiGroups\n\t\t */\n\t\tbookingUiGroups: {\n\t\t\ttype: Array,\n\t\t\tdefault: () => [],\n\t\t},\n\t},\n\tdata(): { dropArea: boolean, freeSpace: ?Occupancy }\n\t{\n\t\treturn {\n\t\t\tdropArea: false,\n\t\t\tfreeSpace: null,\n\t\t};\n\t},\n\tcomputed: {\n\t\t...mapGetters({\n\t\t\tgetBookingById: `${Model.Bookings}/getById`,\n\t\t\toverbookingMap: `${Model.Bookings}/overbookingMap`,\n\t\t\tselectedDateTs: `${Model.Interface}/selectedDateTs`,\n\t\t\tdeletingBookings: `${Model.Interface}/deletingBookings`,\n\t\t\tanimationPause: `${Model.Interface}/animationPause`,\n\t\t\tisBookingCreatedFromEmbed: `${Model.Interface}/isBookingCreatedFromEmbed`,\n\t\t\teditingBookingId: `${Model.Interface}/editingBookingId`,\n\t\t\tdraggedDataTransfer: `${Model.Interface}/draggedDataTransfer`,\n\t\t\tdraggedBookingId: `${Model.Interface}/draggedBookingId`,\n\t\t\tgetWaitListItemById: `${Model.WaitList}/getById`,\n\t\t\tgetResourceById: `${Model.Resources}/getById`,\n\t\t\tisDeletingResourceFilterMode: `${Model.Filter}/isDeletingResourceFilterMode`,\n\t\t\tdeletingResource: `${Model.Filter}/deletingResource`,\n\t\t}),\n\t\tbooking(): BookingModel\n\t\t{\n\t\t\treturn this.getBookingById(this.bookingId);\n\t\t},\n\t\tdeletingBookings(): number[]\n\t\t{\n\t\t\treturn Object.values(this.$store.getters[`${Model.Interface}/deletingBookings`]);\n\t\t},\n\t\toverbooking(): OverbookingMapItem | null\n\t\t{\n\t\t\treturn this.overbookingMap.get(this.bookingId) || null;\n\t\t},\n\t\toverbookingInResource(): OverbookingResourceIntersections | null\n\t\t{\n\t\t\treturn this.overbooking?.items\n\t\t\t\t?.find((item) => item.resourceId === this.resourceId) || null;\n\t\t},\n\t\thasOverbooking(): boolean\n\t\t{\n\t\t\treturn (this.overbookingInResource?.intersections || [])\n\t\t\t\t.some(({ id }) => !this.deletingBookings.includes(id));\n\t\t},\n\t\tisShifted(): boolean\n\t\t{\n\t\t\treturn (\n\t\t\t\tthis.hasOverbooking\n\t\t\t\t&& Type.isPlainObject(this.overbookingInResource)\n\t\t\t\t&& this.overbookingInResource.shifted\n\t\t\t);\n\t\t},\n\t\toverlappingBookings(): OverlappingBookings\n\t\t{\n\t\t\tconst bookingId = !this.isShifted || !this.hasOverbooking\n\t\t\t\t? this.bookingId\n\t\t\t\t: this.overbookingDependencies[0];\n\n\t\t\treturn this.bookingUiGroups.find(({ bookingIds }) => bookingIds.includes((bookingId)))?.bookingIds || [];\n\t\t},\n\t\toverbookingDependencies(): number[]\n\t\t{\n\t\t\treturn (this.overbookingInResource?.intersections || []).map(({ id }) => id);\n\t\t},\n\t\tbookingWidth(): number\n\t\t{\n\t\t\tif (this.hasOverbooking)\n\t\t\t{\n\t\t\t\treturn countBookingWidth(this.overlappingBookings) / 2;\n\t\t\t}\n\n\t\t\treturn countBookingWidth(this.overlappingBookings);\n\t\t},\n\t\tleftOffset(): number\n\t\t{\n\t\t\tif (this.isShifted)\n\t\t\t{\n\t\t\t\tconst bookingId = this.overbookingDependencies[0];\n\t\t\t\tconst leftOffset = countBookingLeftOffset({\n\t\t\t\t\tbookingId,\n\t\t\t\t\tbookingWidth: this.bookingWidth,\n\t\t\t\t\toverlappingBookings: this.overlappingBookings,\n\t\t\t\t});\n\n\t\t\t\treturn leftOffset * 2 + this.bookingWidth;\n\t\t\t}\n\n\t\t\treturn countBookingLeftOffset({\n\t\t\t\tbookingId: this.booking.id,\n\t\t\t\tbookingWidth: this.hasOverbooking ? this.bookingWidth * 2 : this.bookingWidth,\n\t\t\t\toverlappingBookings: this.overlappingBookings,\n\t\t\t});\n\t\t},\n\t\tactionsPopupOptions(): ActionsPopupOptions\n\t\t{\n\t\t\treturn {\n\t\t\t\toverbooking: {\n\t\t\t\t\tdisabled: this.overbooking !== null,\n\t\t\t\t\thidden: this.isDeletedResource,\n\t\t\t\t},\n\t\t\t\twaitList: {\n\t\t\t\t\thidden: this.isDeletedResource,\n\t\t\t\t},\n\t\t\t};\n\t\t},\n\t\trealBooking(): boolean\n\t\t{\n\t\t\treturn Type.isNumber(this.bookingId);\n\t\t},\n\t\thasAccent(): boolean\n\t\t{\n\t\t\treturn this.editingBookingId === this.bookingId || this.isBookingCreatedFromEmbed(this.bookingId);\n\t\t},\n\t\tisDeletedResource(): boolean\n\t\t{\n\t\t\treturn this.getResourceById(this.resourceId)?.isDeleted ?? false;\n\t\t},\n\t\tisShaded(): boolean\n\t\t{\n\t\t\treturn (\n\t\t\t\tthis.isDeletingResourceFilterMode\n\t\t\t\t&& this.resourceId !== this.deletingResource.id\n\t\t\t);\n\t\t},\n\t},\n\twatch: {\n\t\tdraggedDataTransfer: {\n\t\t\thandler(draggedDataTransfer: DraggedDataTransfer): void\n\t\t\t{\n\t\t\t\tif (this.hasOverbooking)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (draggedDataTransfer.kind === DraggedElementKind.Booking && draggedDataTransfer.id === this.bookingId)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (!draggedDataTransfer || !draggedDataTransfer.kind || !draggedDataTransfer.id)\n\t\t\t\t{\n\t\t\t\t\tthis.stopDropHandler();\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.startDropHandler();\n\t\t\t\t}\n\t\t\t},\n\t\t\tdeep: true,\n\t\t},\n\t},\n\tmethods: {\n\t\tdragMouseEnter(): void\n\t\t{\n\t\t\tif (this.isDeletedResource)\n\t\t\t{\n\t\t\t\tthis.dropArea = false;\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (this.dropArea || !this.draggedDataTransfer.id)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (this.draggedDataTransfer.kind === DraggedElementKind.WaitListItem)\n\t\t\t{\n\t\t\t\tthis.freeSpace = {\n\t\t\t\t\tfromTs: this.booking.dateFromTs,\n\t\t\t\t\ttoTs: this.booking.dateToTs,\n\t\t\t\t\tresourcesIds: this.booking.resourcesIds,\n\t\t\t\t};\n\t\t\t\tthis.dropArea = true;\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst draggedBookingId = this.draggedBookingId;\n\t\t\tif (draggedBookingId === null)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst draggedBooking = this.getBookingById(draggedBookingId);\n\t\t\tconst bookingDuration = this.booking.dateToTs - this.booking.dateFromTs;\n\t\t\tconst draggedBookingDuration = draggedBooking.dateToTs - draggedBooking.dateFromTs;\n\t\t\tif (bookingDuration >= draggedBookingDuration && draggedBooking.resourcesIds.length <= 1)\n\t\t\t{\n\t\t\t\tthis.freeSpace = {\n\t\t\t\t\tfromTs: this.booking.dateFromTs,\n\t\t\t\t\ttoTs: this.booking.dateToTs,\n\t\t\t\t\tresourcesIds: this.booking.resourcesIds,\n\t\t\t\t};\n\t\t\t\tthis.dropArea = true;\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst excludeBookingFn = (booking: BookingModel): boolean => {\n\t\t\t\tif (booking.id === this.draggedBookingId)\n\t\t\t\t{\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\n\t\t\t\tconst overbooking = this.overbookingMap.get(booking.id);\n\t\t\t\tconst resourceId = this.resourceId;\n\n\t\t\t\treturn !overbooking || overbooking.items.some((item) => item.resourceId === resourceId);\n\t\t\t};\n\t\t\tconst colliding = this.$store.getters[`${Model.Interface}/getColliding`](\n\t\t\t\tthis.resourceId,\n\t\t\t\texcludeBookingFn,\n\t\t\t);\n\t\t\tif (colliding.length === 0)\n\t\t\t{\n\t\t\t\tthis.freeSpace = {\n\t\t\t\t\tfromTs: this.booking.dateFromTs,\n\t\t\t\t\ttoTs: this.booking.dateToTs,\n\t\t\t\t\tresourcesIds: this.booking.resourcesIds,\n\t\t\t\t};\n\t\t\t\tthis.dropArea = true;\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst freeSpace = getOverbookingFreeSpace({\n\t\t\t\tbooking: this.booking,\n\t\t\t\tcolliding,\n\t\t\t\tselectedDateTs: this.selectedDateTs,\n\t\t\t\tdraggedBookingResourcesIds: draggedBooking.resourcesIds,\n\t\t\t});\n\t\t\tthis.freeSpace = freeSpace;\n\t\t\tthis.dropArea = freeSpace && (freeSpace.toTs - freeSpace.fromTs) >= draggedBookingDuration;\n\t\t},\n\t\tdragMouseLeave(): void\n\t\t{\n\t\t\tthis.dropArea = false;\n\t\t\tthis.freeSpace = null;\n\t\t},\n\t\tasync dropElement(): void\n\t\t{\n\t\t\tconst id = this.draggedDataTransfer.id;\n\t\t\tif (!id || !this.freeSpace)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (this.draggedDataTransfer.kind === DraggedElementKind.Booking)\n\t\t\t{\n\t\t\t\tawait this.dropBooking(id);\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (this.draggedDataTransfer.kind === DraggedElementKind.WaitListItem)\n\t\t\t{\n\t\t\t\tawait this.dropWaitListItem(id);\n\t\t\t}\n\t\t},\n\t\tasync dropBooking(id: number | string): Promise<void>\n\t\t{\n\t\t\tconst droppedBooking = this.getBookingById(id);\n\t\t\tconst { dateFromTs, dateToTs } = findTimeForDroppedBooking(this.freeSpace, this.booking, droppedBooking);\n\t\t\tconst overbooking = {\n\t\t\t\tid,\n\t\t\t\tdateFromTs,\n\t\t\t\tdateToTs,\n\t\t\t\ttimezoneFrom: droppedBooking.timezoneFrom,\n\t\t\t\ttimezoneTo: droppedBooking.timezoneTo,\n\t\t\t\tresourcesIds: [\n\t\t\t\t\t...new Set([\n\t\t\t\t\t\tthis.resourceId,\n\t\t\t\t\t\t...droppedBooking.resourcesIds.slice(1, droppedBooking.resourcesIds.length),\n\t\t\t\t\t]),\n\t\t\t\t],\n\t\t\t};\n\n\t\t\tif (!isRealId(id))\n\t\t\t{\n\t\t\t\tawait this.$store.dispatch(`${Model.Bookings}/update`, { id, booking: overbooking });\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tawait bookingService.update({\n\t\t\t\tid,\n\t\t\t\t...overbooking,\n\t\t\t});\n\t\t},\n\t\tasync dropWaitListItem(id: number): Promise<void>\n\t\t{\n\t\t\tconst droppedWaitListItem = this.getWaitListItemById(id);\n\t\t\tconst clients = [...droppedWaitListItem.clients];\n\t\t\tconst resource = this.getResourceById(this.resourceId);\n\t\t\tconst timezone = resource?.slotRanges?.[0]?.timezone;\n\n\t\t\tconst overbooking: BookingModel = {\n\t\t\t\tid: `wl${id}`,\n\t\t\t\tresourcesIds: [this.resourceId],\n\t\t\t\tname: droppedWaitListItem.name,\n\t\t\t\tnote: droppedWaitListItem.note,\n\t\t\t\tclients,\n\t\t\t\tprimaryClient: clients.length > 0 ? clients[0] : undefined,\n\t\t\t\texternalData: [...droppedWaitListItem.externalData],\n\t\t\t\tdateFromTs: this.booking.dateFromTs,\n\t\t\t\tdateToTs: this.booking.dateToTs,\n\t\t\t\ttimezoneFrom: timezone,\n\t\t\t\ttimezoneTo: timezone,\n\t\t\t};\n\t\t\tconst result = await bookingService.createFromWaitListItem(id, overbooking);\n\n\t\t\tif (result.success && result.booking)\n\t\t\t{\n\t\t\t\tBookingAnalytics.sendAddBooking({ isOverbooking: true });\n\t\t\t}\n\t\t},\n\t\tstartDropHandler(): void\n\t\t{\n\t\t\tEvent.bind(this.$el, 'mousemove', this.dragMouseEnter, { capture: true });\n\t\t\tEvent.bind(this.$el, 'mouseleave', this.dragMouseLeave, { capture: true });\n\t\t\tEvent.bind(this.$el, 'mouseup', this.dropElement, { capture: true });\n\t\t},\n\t\tstopDropHandler(): void\n\t\t{\n\t\t\tthis.dropArea = false;\n\t\t\tthis.freeSpace = null;\n\t\t\tEvent.unbind(this.$el, 'mousemove', this.dragMouseEnter, { capture: true });\n\t\t\tEvent.unbind(this.$el, 'mouseleave', this.dragMouseLeave, { capture: true });\n\t\t\tEvent.unbind(this.$el, 'mouseup', this.dropElement, { capture: true });\n\t\t},\n\t},\n\ttemplate: `\n\t\t<BookingBase\n\t\t\t:bookingId\n\t\t\t:resourceId\n\t\t\t:nowTs\n\t\t\t:leftOffset\n\t\t\t:bookingClass=\"{\n\t\t\t\t'--short': overlappingBookings.length > 1,\n\t\t\t\t'--overbooking': hasOverbooking,\n\t\t\t\t'--overbooking-bg': hasOverbooking || overbooking !== null,\n\t\t\t\t'--shifted': isShifted && !realBooking,\n\t\t\t\t'--drop-area': dropArea,\n\t\t\t\t'--accent': hasAccent,\n\t\t\t\t'--shaded': isShaded,\n\t\t\t\t'not-transition': animationPause,\n\t\t\t}\"\n\t\t\t:width=\"bookingWidth\"\n\t\t>\n\t\t\t<template #actions>\n\t\t\t\t<Actions\n\t\t\t\t\t:bookingId\n\t\t\t\t\t:resourceId\n\t\t\t\t\t:actionsPopupOptions\n\t\t\t\t/>\n\t\t\t</template>\n\t\t\t<div class=\"booking--booking-pseudo-overbooking\"></div>\n\t\t</BookingBase>\n\t`,\n};\n","import { DateTimeFormat } from 'main.date';\nimport { Popup as MainPopup, PopupOptions } from 'main.popup';\nimport { mapGetters } from 'ui.vue3.vuex';\n\nimport { Popup } from 'booking.component.popup';\nimport { BusySlot, Model } from 'booking.const';\nimport type { ResourceModel } from 'booking.model.resources';\nimport './busy-popup.css';\n\n// @vue/component\nexport const BusyPopup = {\n\tname: 'BusyPopup',\n\tcomponents: {\n\t\tPopup,\n\t},\n\tprops: {\n\t\tbusySlot: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t},\n\temits: ['close'],\n\tcomputed: {\n\t\t...mapGetters({\n\t\t\toffset: `${Model.Interface}/offset`,\n\t\t\tmousePosition: `${Model.Interface}/mousePosition`,\n\t\t}),\n\t\tresource(): ResourceModel\n\t\t{\n\t\t\tconst resourceId = (\n\t\t\t\tthis.busySlot.type === BusySlot.Intersection\n\t\t\t\t\t? this.busySlot.intersectingResourceId\n\t\t\t\t\t: this.busySlot.resourceId\n\t\t\t);\n\n\t\t\treturn this.$store.getters[`${Model.Resources}/getById`](resourceId);\n\t\t},\n\t\tpopupId(): string\n\t\t{\n\t\t\treturn `booking-booking-busy-popup-${this.busySlot.resourceId}`;\n\t\t},\n\t\tconfig(): PopupOptions\n\t\t{\n\t\t\tconst width = 200;\n\n\t\t\tconst angleLeft = MainPopup.getOption('angleMinBottom');\n\t\t\tconst angleOffset = width / 2 - angleLeft;\n\n\t\t\treturn {\n\t\t\t\tbindElement: this.mousePosition,\n\t\t\t\twidth,\n\t\t\t\tbackground: '#2878ca',\n\t\t\t\toffsetTop: -5,\n\t\t\t\toffsetLeft: -angleOffset + angleLeft,\n\t\t\t\tbindOptions: {\n\t\t\t\t\tforceBindPosition: true,\n\t\t\t\t\tposition: 'top',\n\t\t\t\t},\n\t\t\t\tangle: {\n\t\t\t\t\toffset: angleOffset,\n\t\t\t\t\tposition: 'bottom',\n\t\t\t\t},\n\t\t\t\tangleBorderRadius: '4px 0',\n\t\t\t\tautoHide: false,\n\t\t\t};\n\t\t},\n\t\ttextFormatted(): string\n\t\t{\n\t\t\tconst timeFormat = DateTimeFormat.getFormat('SHORT_TIME_FORMAT');\n\n\t\t\tconst messageId = this.getPopupMessageId(this.busySlot.type);\n\n\t\t\treturn this.loc(messageId, {\n\t\t\t\t'#RESOURCE#': this.resource.name,\n\t\t\t\t'#TIME_FROM#': DateTimeFormat.format(timeFormat, (this.busySlot.fromTs + this.offset) / 1000),\n\t\t\t\t'#TIME_TO#': DateTimeFormat.format(timeFormat, (this.busySlot.toTs + this.offset) / 1000),\n\t\t\t});\n\t\t},\n\t},\n\twatch: {\n\t\tmousePosition: {\n\t\t\thandler(): void\n\t\t\t{\n\t\t\t\tthis.adjustPosition();\n\t\t\t},\n\t\t\tdeep: true,\n\t\t},\n\t},\n\tmethods: {\n\t\tgetPopupMessageId(slotType: $Values<BusySlot>): string\n\t\t{\n\t\t\tif (slotType === BusySlot.Intersection)\n\t\t\t{\n\t\t\t\treturn 'BOOKING_BOOKING_INTERSECTING_RESOURCE_IS_BUSY';\n\t\t\t}\n\n\t\t\tif (slotType === BusySlot.IntersectionOverbooking)\n\t\t\t{\n\t\t\t\treturn 'BOOKING_BOOKING_INTERSECTING_RESOURCE_IS_FULL_BUSY';\n\t\t\t}\n\n\t\t\treturn 'BOOKING_BOOKING_RESOURCE_IS_BUSY';\n\t\t},\n\t\tadjustPosition(): void\n\t\t{\n\t\t\tconst popup: MainPopup = this.$refs.popup?.getPopupInstance();\n\t\t\tif (!popup)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tpopup.setBindElement(this.mousePosition);\n\t\t\tpopup.adjustPosition();\n\t\t},\n\t\tclosePopup(): void\n\t\t{\n\t\t\tthis.$emit('close');\n\t\t},\n\t},\n\ttemplate: `\n\t\t<Popup\n\t\t\tv-if=\"mousePosition.left !== 0 && mousePosition.top !== 0\"\n\t\t\t:id=\"popupId\"\n\t\t\t:config=\"config\"\n\t\t\tref=\"popup\"\n\t\t\t@close=\"closePopup\"\n\t\t>\n\t\t\t<div class=\"booking-booking-busy-popup\">\n\t\t\t\t{{ textFormatted }}\n\t\t\t</div>\n\t\t</Popup>\n\t`,\n};\n","import { Dom, Event, Type } from 'main.core';\nimport { createNamespacedHelpers } from 'ui.vue3.vuex';\n\nimport { BusySlot as BusySlotType, Model } from 'booking.const';\nimport { grid } from 'booking.lib.grid';\n\nimport { BusyPopup } from './busy-popup/busy-popup';\nimport './busy-slot.css';\n\nconst { mapGetters: mapInterfaceGetters } = createNamespacedHelpers(Model.Interface);\nconst { mapGetters: mapFilterGetters } = createNamespacedHelpers(Model.Filter);\n\nconst BookingBusySlotClassName = 'booking-booking-busy-slot';\n\ntype BusySlotData = {\n\tisPopupShown: boolean,\n};\n\n// @vue/component\nexport const BusySlot = {\n\tname: 'BusySlot',\n\tcomponents: {\n\t\tBusyPopup,\n\t},\n\tprops: {\n\t\tbusySlot: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tsetup(): { BookingBusySlotClassName: string, BusySlotType: BusySlotType }\n\t{\n\t\treturn {\n\t\t\tBookingBusySlotClassName,\n\t\t\tBusySlotType,\n\t\t};\n\t},\n\tdata(): BusySlotData\n\t{\n\t\treturn {\n\t\t\tisPopupShown: false,\n\t\t};\n\t},\n\tcomputed: {\n\t\t...mapInterfaceGetters({\n\t\t\tdisabledBusySlots: 'disabledBusySlots',\n\t\t\tisEditingBookingMode: 'isEditingBookingMode',\n\t\t\tisDragMode: 'isDragMode',\n\t\t}),\n\t\t...mapFilterGetters({\n\t\t\tisFilterMode: 'isFilterMode',\n\t\t}),\n\t\tisDisabled(): boolean\n\t\t{\n\t\t\tconst isDragOffHours = this.isDragMode && this.busySlot.type === BusySlotType.OffHours;\n\t\t\tconst isDragOverbooking = this.isDragMode && this.busySlot.type === BusySlotType.IntersectionOverbooking;\n\n\t\t\tif (this.isFilterMode || isDragOffHours || isDragOverbooking)\n\t\t\t{\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\treturn this.busySlot.id in this.disabledBusySlots;\n\t\t},\n\t\tleft(): number\n\t\t{\n\t\t\treturn grid.calculateLeft(this.busySlot.resourceId);\n\t\t},\n\t\ttop(): number\n\t\t{\n\t\t\treturn grid.calculateTop(this.busySlot.fromTs);\n\t\t},\n\t\theight(): number\n\t\t{\n\t\t\treturn grid.calculateHeight(this.busySlot.fromTs, this.busySlot.toTs);\n\t\t},\n\t},\n\tmethods: {\n\t\tonClick(): void\n\t\t{\n\t\t\tif (\n\t\t\t\tthis.isFilterMode\n\t\t\t\t|| this.isEditingBookingMode\n\t\t\t\t|| this.busySlot.type === BusySlotType.IntersectionOverbooking\n\t\t\t)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tvoid this.$store.dispatch(`${Model.Interface}/addDisabledBusySlot`, this.busySlot);\n\t\t},\n\t\tonMouseEnter(): void\n\t\t{\n\t\t\tclearTimeout(this.showTimeout);\n\t\t\tthis.showTimeout = setTimeout(() => this.showPopup(), 300);\n\t\t\tEvent.unbind(document, 'mousemove', this.onMouseMove);\n\t\t\tEvent.bind(document, 'mousemove', this.onMouseMove);\n\t\t},\n\t\tonMouseMove(event: MouseEvent): void\n\t\t{\n\t\t\tif (this.cursorInsideContainer(event.target))\n\t\t\t{\n\t\t\t\tthis.updatePopup(event);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tEvent.unbind(document, 'mousemove', this.onMouseMove);\n\t\t\t\tthis.closePopup();\n\t\t\t}\n\t\t},\n\t\tonMouseLeave(event: MouseEvent): void\n\t\t{\n\t\t\tif (event.relatedTarget?.closest('.popup-window')?.querySelector('.booking-booking-busy-popup'))\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tEvent.unbind(document, 'mousemove', this.onMouseMove);\n\t\t\tthis.closePopup();\n\t\t},\n\t\tcursorInsideContainer(eventTarget: EventTarget | null): boolean\n\t\t{\n\t\t\treturn !Type.isNull(eventTarget) && Dom.hasClass(eventTarget, this.BookingBusySlotClassName);\n\t\t},\n\t\tupdatePopup(event: MouseEvent): void\n\t\t{\n\t\t\tconst rect = this.$refs.container?.getBoundingClientRect();\n\t\t\tif (\n\t\t\t\tthis.isDragMode\n\t\t\t\t|| !rect\n\t\t\t\t|| event.clientY > rect.top + rect.height\n\t\t\t\t|| event.clientY < rect.top\n\t\t\t\t|| event.clientX < rect.left\n\t\t\t\t|| event.clientX > rect.left + rect.width\n\t\t\t)\n\t\t\t{\n\t\t\t\tthis.closePopup();\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.showTimeout ??= setTimeout(() => this.showPopup(), 300);\n\t\t},\n\t\tshowPopup(): void\n\t\t{\n\t\t\tthis.isPopupShown = true;\n\t\t},\n\t\tclosePopup(): void\n\t\t{\n\t\t\tclearTimeout(this.showTimeout);\n\t\t\tthis.showTimeout = null;\n\t\t\tthis.isPopupShown = false;\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div\n\t\t\tv-if=\"left >= 0\"\n\t\t\t:class=\"[BookingBusySlotClassName, {\n\t\t\t\t'--disabled': isDisabled,\n\t\t\t}]\"\n\t\t\t:style=\"{\n\t\t\t\t'--left': left + 'px',\n\t\t\t\t'--top': top + 'px',\n\t\t\t\t'--height': height + 'px',\n\t\t\t\t'z-index': busySlot.type === BusySlotType.IntersectionOverbooking ? 1 : 'unset',\n\t\t\t}\"\n\t\t\tdata-element=\"booking-busy-slot\"\n\t\t\t:data-id=\"busySlot.resourceId\"\n\t\t\t:data-from=\"busySlot.fromTs\"\n\t\t\t:data-to=\"busySlot.toTs\"\n\t\t\tref=\"container\"\n\t\t\t@click.stop=\"onClick\"\n\t\t\t@mouseenter.stop=\"onMouseEnter\"\n\t\t\t@mouseleave.stop=\"onMouseLeave\"\n\t\t></div>\n\t\t<BusyPopup\n\t\t\tv-if=\"isPopupShown\"\n\t\t\t:busySlot=\"busySlot\"\n\t\t\t@close=\"closePopup\"\n\t\t/>\n\t`,\n};\n","import { Event } from 'main.core';\nimport { DateTimeFormat } from 'main.date';\n\nimport { mapGetters } from 'ui.vue3.vuex';\nimport { BIcon as Icon, Set as IconSet } from 'ui.icon-set.api.vue';\n\nimport { Model } from 'booking.const';\nimport { DealData } from 'booking.model.bookings';\nimport { ClientData } from 'booking.model.clients';\nimport { bookingService } from 'booking.provider.service.booking-service';\nimport { BookingAnalytics } from 'booking.lib.analytics';\nimport { limit } from 'booking.lib.limit';\nimport { grid } from 'booking.lib.grid';\nimport './base-cell.css';\n\n/**\n * @typedef {Object} Cell\n * @property {string} id\n * @property {number} fromTs\n * @property {number} toTs\n * @property {number} resourceId\n * @property {boolean} boundedToBottom\n */\nexport const BaseCell = {\n\tprops: {\n\t\t/** @type {Cell} */\n\t\tcell: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t\tclassName: {\n\t\t\ttype: [String, Object],\n\t\t\tdefault: '',\n\t\t},\n\t},\n\tcomponents: {\n\t\tIcon,\n\t},\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tIconSet,\n\t\t};\n\t},\n\tcomputed: {\n\t\t...mapGetters({\n\t\t\tselectedCells: `${Model.Interface}/selectedCells`,\n\t\t\tzoom: `${Model.Interface}/zoom`,\n\t\t\tintersections: `${Model.Interface}/intersections`,\n\t\t\ttimezone: `${Model.Interface}/timezone`,\n\t\t\toffset: `${Model.Interface}/offset`,\n\t\t\tisFeatureEnabled: `${Model.Interface}/isFeatureEnabled`,\n\t\t\tdraggedDataTransfer: `${Model.Interface}/draggedDataTransfer`,\n\t\t\tembedItems: `${Model.Interface}/embedItems`,\n\t\t}),\n\t\tselected(): boolean\n\t\t{\n\t\t\treturn this.cell.id in this.selectedCells;\n\t\t},\n\t\thasSelectedCells(): boolean\n\t\t{\n\t\t\treturn Object.keys(this.selectedCells).length > 0;\n\t\t},\n\t\ttimeFormatted(): string\n\t\t{\n\t\t\tconst timeFormat = DateTimeFormat.getFormat('SHORT_TIME_FORMAT');\n\n\t\t\treturn this.loc('BOOKING_BOOKING_TIME_RANGE', {\n\t\t\t\t'#FROM#': DateTimeFormat.format(timeFormat, (this.cell.fromTs + this.offset) / 1000),\n\t\t\t\t'#TO#': DateTimeFormat.format(timeFormat, (this.cell.toTs + this.offset) / 1000),\n\t\t\t});\n\t\t},\n\t\theight(): number\n\t\t{\n\t\t\treturn grid.calculateRealHeight(this.cell.fromTs, this.cell.toTs);\n\t\t},\n\t\texternalData(): DealData[]\n\t\t{\n\t\t\treturn this.embedItems;\n\t\t},\n\t\tclients(): ClientData[]\n\t\t{\n\t\t\tconst clients = this.embedItems.filter((item: DealData) => {\n\t\t\t\treturn item.entityTypeId === 'CONTACT' || item.entityTypeId === 'COMPANY';\n\t\t\t});\n\n\t\t\treturn clients.map((item: DealData) => {\n\t\t\t\treturn {\n\t\t\t\t\tid: item.value,\n\t\t\t\t\ttype: {\n\t\t\t\t\t\tcode: item.entityTypeId,\n\t\t\t\t\t\tmodule: item.moduleId,\n\t\t\t\t\t},\n\t\t\t\t};\n\t\t\t});\n\t\t},\n\t},\n\tmethods: {\n\t\tonCellSelected({ target: { checked } }): void\n\t\t{\n\t\t\tif (!this.isFeatureEnabled)\n\t\t\t{\n\t\t\t\tlimit.show();\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (checked)\n\t\t\t{\n\t\t\t\tthis.$store.dispatch(`${Model.Interface}/addSelectedCell`, this.cell);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.$store.dispatch(`${Model.Interface}/removeSelectedCell`, this.cell);\n\t\t\t}\n\t\t},\n\t\tonMouseDown(): void\n\t\t{\n\t\t\tif (!this.isFeatureEnabled)\n\t\t\t{\n\t\t\t\tvoid limit.show();\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tvoid this.$store.dispatch(`${Model.Interface}/setHoveredCell`, null);\n\n\t\t\tthis.creatingBookingId = `tmp-id-${Date.now()}-${Math.random()}`;\n\n\t\t\tvoid this.$store.dispatch(`${Model.Filter}/addQuickFilterIgnoredBookingId`, this.creatingBookingId);\n\t\t\tvoid this.$store.dispatch(`${Model.Bookings}/add`, {\n\t\t\t\tid: this.creatingBookingId,\n\t\t\t\tdateFromTs: this.cell.fromTs,\n\t\t\t\tdateToTs: this.cell.toTs,\n\t\t\t\tresourcesIds: [...new Set([\n\t\t\t\t\tthis.cell.resourceId,\n\t\t\t\t\t...(this.intersections[0] ?? []),\n\t\t\t\t\t...(this.intersections[this.cell.resourceId] ?? []),\n\t\t\t\t])],\n\t\t\t\ttimezoneFrom: this.timezone,\n\t\t\t\ttimezoneTo: this.timezone,\n\t\t\t\texternalData: this.externalData,\n\t\t\t\tclients: this.clients,\n\t\t\t});\n\n\t\t\tEvent.bind(window, 'mouseup', this.addBooking);\n\t\t},\n\t\taddBooking(): void\n\t\t{\n\t\t\tEvent.unbind(window, 'mouseup', this.addBooking);\n\n\t\t\tif (!this.isFeatureEnabled)\n\t\t\t{\n\t\t\t\tvoid limit.show();\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tsetTimeout(async (): Promise<void> => {\n\t\t\t\tconst creatingBooking = this.$store.getters[`${Model.Bookings}/getById`](this.creatingBookingId);\n\t\t\t\tconst result = await bookingService.add(creatingBooking);\n\t\t\t\tif (result.success && result.booking)\n\t\t\t\t{\n\t\t\t\t\tconst overbookingMap = this.$store.getters[`${Model.Bookings}/overbookingMap`];\n\t\t\t\t\tBookingAnalytics.sendAddBooking({\n\t\t\t\t\t\tisOverbooking: Boolean(overbookingMap?.has?.(result.booking.id)),\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div\n\t\t\tclass=\"booking-booking-base-cell\"\n\t\t\t:class=\"[className, {\n\t\t\t\t'--selected': selected,\n\t\t\t\t'--bounded-to-bottom': cell.boundedToBottom,\n\t\t\t\t'--height-is-less-than-40': height < 40,\n\t\t\t\t'--compact-mode': height < 40 || zoom < 0.8,\n\t\t\t\t'--small': height <= 12.5,\n\t\t\t}]\"\n\t\t\t:style=\"{\n\t\t\t\t'--height': height + 'px',\n\t\t\t}\"\n\t\t\tdata-element=\"booking-base-cell\"\n\t\t\t:data-resource-id=\"cell.resourceId\"\n\t\t\t:data-from=\"cell.fromTs\"\n\t\t\t:data-to=\"cell.toTs\"\n\t\t\t:data-selected=\"selected\"\n\t\t>\n\t\t\t<div class=\"booking-booking-grid-cell-padding\">\n\t\t\t\t<div class=\"booking-booking-grid-cell-inner\">\n\t\t\t\t\t<label\n\t\t\t\t\t\tclass=\"booking-booking-grid-cell-time\"\n\t\t\t\t\t\tdata-element=\"booking-grid-cell-select-label\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<span class=\"booking-booking-grid-cell-time-inner\">\n\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\tv-if=\"!draggedDataTransfer.id\"\n\t\t\t\t\t\t\t\tclass=\"booking-booking-grid-cell-checkbox\"\n\t\t\t\t\t\t\t\ttype=\"checkbox\"\n\t\t\t\t\t\t\t\t:checked=\"selected\"\n\t\t\t\t\t\t\t\t@change=\"onCellSelected\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<span data-element=\"booking-grid-cell-time\">\n\t\t\t\t\t\t\t\t{{ timeFormatted }}\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t</span>\n\t\t\t\t\t</label>\n\t\t\t\t\t<div\n\t\t\t\t\t\tv-if=\"!hasSelectedCells && !draggedDataTransfer.id\"\n\t\t\t\t\t\tclass=\"booking-booking-grid-cell-select-button-container\"\n\t\t\t\t\t\tref=\"button\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<div\n\t\t\t\t\t\t\tclass=\"booking-booking-grid-cell-select-button\"\n\t\t\t\t\t\t\t:class=\"{'--lock': !isFeatureEnabled}\"\n\t\t\t\t\t\t\tdata-element=\"booking-grid-cell-add-button\"\n\t\t\t\t\t\t\t@mousedown=\"onMouseDown\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<div class=\"booking-booking-grid-cell-select-button-text\">\n\t\t\t\t\t\t\t\t{{ loc('BOOKING_BOOKING_SELECT') }}\n\t\t\t\t\t\t\t\t<Icon v-if=\"!isFeatureEnabled\" :name=\"IconSet.LOCK\" />\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class=\"ui-icon-set --chevron-right\"></div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import { mapGetters } from 'ui.vue3.vuex';\n\nimport { Model } from 'booking.const';\nimport { grid } from 'booking.lib.grid';\nimport { checkBookingIntersection } from 'booking.lib.check-booking-intersection';\n\nimport { BaseCell } from '../../base-cell/base-cell';\nimport './cell.css';\n\n/**\n * @typedef {Object} Cell\n * @property {string} id\n * @property {number} fromTs\n * @property {number} toTs\n * @property {number} resourceId\n * @property {boolean} boundedToBottom\n *\n * @vue/component\n */\nexport const Cell = {\n\tname: 'HoveredCell',\n\tcomponents: {\n\t\tBaseCell,\n\t},\n\tprops: {\n\t\t/** @type {Cell} */\n\t\tcell: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t\tdraggedBooking: {\n\t\t\ttype: Object,\n\t\t\tdefault: null,\n\t\t},\n\t},\n\tdata(): { overbookingPositionsInCell: string[] }\n\t{\n\t\treturn {\n\t\t\toverbookingPositionsInCell: [],\n\t\t};\n\t},\n\tcomputed: {\n\t\t...mapGetters({\n\t\t\toverbookingMap: `${Model.Bookings}/overbookingMap`,\n\t\t}),\n\t\tleft(): number\n\t\t{\n\t\t\tconst left = grid.calculateLeft(this.cell.resourceId);\n\t\t\tconst overbookingPositions = this.overbookingPositionsInCell;\n\t\t\tif (overbookingPositions.length > 1)\n\t\t\t{\n\t\t\t\treturn -1;\n\t\t\t}\n\n\t\t\tif (overbookingPositions.length === 0 || overbookingPositions[0])\n\t\t\t{\n\t\t\t\treturn left;\n\t\t\t}\n\n\t\t\treturn left + grid.calculateWidth(this.width);\n\t\t},\n\t\ttop(): number\n\t\t{\n\t\t\treturn grid.calculateTop(this.cell.fromTs);\n\t\t},\n\t\theight(): number\n\t\t{\n\t\t\tconst fromTs = this.cell.fromTs;\n\t\t\tconst draggedBookingDuration = this.draggedBooking\n\t\t\t\t? this.draggedBooking.dateToTs - this.draggedBooking.dateFromTs\n\t\t\t\t: Infinity;\n\t\t\tconst toTs = draggedBookingDuration < this.cell.toTs - fromTs\n\t\t\t\t? fromTs + draggedBookingDuration\n\t\t\t\t: this.cell.toTs;\n\n\t\t\treturn grid.calculateHeight(fromTs, toTs);\n\t\t},\n\t\twidth(): number\n\t\t{\n\t\t\treturn this.overbookingPositionsInCell.length === 0 ? 280 : 280 / 2;\n\t\t},\n\t},\n\tmounted(): void\n\t{\n\t\tthis.calcOverbookingPositionsInCell();\n\t},\n\tmethods: {\n\t\tcalcOverbookingPositionsInCell(): void\n\t\t{\n\t\t\tconst resourceId = this.cell.resourceId;\n\t\t\tconst cellTimespan = {\n\t\t\t\tdateFromTs: this.cell.fromTs,\n\t\t\t\tdateToTs: this.cell.toTs,\n\t\t\t};\n\t\t\tconst positions: string[] = [];\n\n\t\t\tfor (const [, overbooking] of this.overbookingMap)\n\t\t\t{\n\t\t\t\tconst resourceOverbooking = overbooking.items.find((item) => item.resourceId === resourceId);\n\t\t\t\tif (\n\t\t\t\t\tresourceOverbooking\n\t\t\t\t\t&& checkBookingIntersection(overbooking.booking, cellTimespan)\n\t\t\t\t\t&& !positions.includes(resourceOverbooking?.shifted)\n\t\t\t\t)\n\t\t\t\t{\n\t\t\t\t\tpositions.push(resourceOverbooking?.shifted);\n\t\t\t\t}\n\n\t\t\t\tif (positions.length > 2)\n\t\t\t\t{\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.overbookingPositionsInCell = positions;\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div\n\t\t\tv-if=\"left >= 0\"\n\t\t\tclass=\"booking-booking-selected-cell\"\n\t\t\t:style=\"{\n\t\t\t\t'--left': left + 'px',\n\t\t\t\t'--top': top + 'px',\n\t\t\t\t'--height': height + 'px',\n\t\t\t\t'--width': width + 'px',\n\t\t\t}\"\n\t\t\t@mouseleave=\"$store.dispatch('interface/setHoveredCell', null)\"\n\t\t>\n\t\t\t<BaseCell\n\t\t\t\t:cell=\"cell\"\n\t\t\t\t:className=\"{ '--overbooking': overbookingPositionsInCell.length > 0 }\"\n\t\t\t/>\n\t\t</div>\n\t`,\n};\n","import { Model } from 'booking.const';\nimport { mapGetters } from 'ui.vue3.vuex';\nimport { grid } from 'booking.lib.grid';\nimport './quick-filter-line.css';\n\nexport const QuickFilterLine = {\n\tprops: {\n\t\thour: {\n\t\t\ttype: Number,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tcomputed: {\n\t\t...mapGetters({\n\t\t\tselectedDateTs: `${Model.Interface}/selectedDateTs`,\n\t\t\tresourcesIds: `${Model.Interface}/resourcesIds`,\n\t\t}),\n\t\ttop(): number\n\t\t{\n\t\t\treturn grid.calculateTop(this.fromTs);\n\t\t},\n\t\twidth(): number\n\t\t{\n\t\t\treturn this.resourcesIds.length * 280;\n\t\t},\n\t\tfromTs(): number\n\t\t{\n\t\t\treturn new Date(this.selectedDateTs).setHours(this.hour);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div\n\t\t\tclass=\"booking-booking-quick-filter-line\"\n\t\t\t:style=\"{\n\t\t\t\t'--top': top + 'px',\n\t\t\t\t'--width': width + 'px',\n\t\t\t}\"\n\t\t></div>\n\t`,\n};\n","export const MinUiBookingDurationMs = 15 * 60 * 1000;\n","import { inInterval } from 'booking.lib.in-interval';\nimport type {\n\tBookingModel,\n\tBookingModelUi,\n\tBookingUiGroup,\n\tOverbookingMapItem,\n} from 'booking.model.bookings';\nimport { MinUiBookingDurationMs } from '../model';\n\nfunction getBookingUiSlot({ dateFromTs, dateToTs }: BookingModel): [number, number]\n{\n\tconst duration = dateToTs - dateFromTs;\n\n\treturn [\n\t\tdateFromTs,\n\t\tduration < MinUiBookingDurationMs ? dateFromTs + MinUiBookingDurationMs : dateToTs,\n\t];\n}\n\nexport function createBookingModelUi(\n\tresourceId: number,\n\tbooking: BookingModel,\n\toverbookingMapItem: ?OverbookingMapItem,\n): BookingModelUi\n{\n\treturn {\n\t\t...booking,\n\t\tresourcesIds: [resourceId],\n\t\tuiSlot: getBookingUiSlot(booking),\n\t\toverbooking: overbookingMapItem?.items?.some((item) => {\n\t\t\treturn item.resourceId === resourceId && item.shifted;\n\t\t}),\n\t};\n}\n\ntype Bookings = Array<BookingModel | BookingModelUi>;\n\nexport function splitBookingsByResourceId(bookings: Bookings): Map<number, Bookings>\n{\n\tconst resourceBookingsMap: Map<number, Bookings> = new Map();\n\tfor (const booking of bookings)\n\t{\n\t\tconst resourceId = booking.resourcesIds?.[0] || 0;\n\t\tlet resourceBookings: Bookings = [];\n\t\tif (resourceBookingsMap.has(resourceId))\n\t\t{\n\t\t\tresourceBookings = resourceBookingsMap.get(resourceId) || [];\n\t\t}\n\n\t\tresourceBookings.push(booking);\n\t\tresourceBookingsMap.set(resourceId, resourceBookings);\n\t}\n\n\treturn resourceBookingsMap;\n}\n\nexport function groupBookingUis(bookings: BookingModelUi[]): BookingUiGroup[]\n{\n\tconst groups: BookingUiGroup[] = [];\n\tif (bookings.length === 0)\n\t{\n\t\treturn groups;\n\t}\n\n\tlet group: BookingUiGroup = {\n\t\tslot: [0, 0],\n\t\tbookingIds: [],\n\t};\n\n\tbookings\n\t\t.filter((booking) => !booking.overbooking)\n\t\t.map((booking) => {\n\t\t\treturn {\n\t\t\t\tid: booking.id,\n\t\t\t\tuiSlot: booking.uiSlot,\n\t\t\t};\n\t\t})\n\t\t.sort((a, b) => a.uiSlot[0] - b.uiSlot[0])\n\t\t.forEach((booking) => {\n\t\t\tif (group.bookingIds.length === 0)\n\t\t\t{\n\t\t\t\tgroup.slot = [booking.uiSlot[0], booking.uiSlot[1]];\n\t\t\t}\n\t\t\telse if (inInterval(booking.uiSlot[0], group.slot))\n\t\t\t{\n\t\t\t\tgroup.slot[1] = booking.uiSlot[1];\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tgroups.push(group);\n\t\t\t\tgroup = {\n\t\t\t\t\tslot: [booking.uiSlot[0], booking.uiSlot[1]],\n\t\t\t\t\tbookingIds: [],\n\t\t\t\t};\n\t\t\t}\n\n\t\t\tgroup.bookingIds.push(booking.id);\n\t\t});\n\tgroups.push(group);\n\n\treturn groups;\n}\n\nexport function getResourceBookingUiGroups(\n\tresourceBookingsMap: Map<number, BookingModelUi[]>,\n): Map<number, BookingUiGroup[]>\n{\n\tconst resourceBookingUiGroups: Map<number, BookingUiGroup[]> = new Map();\n\n\tif (resourceBookingsMap instanceof Map)\n\t{\n\t\t[...resourceBookingsMap.keys()]\n\t\t\t.forEach((resourceId) => {\n\t\t\t\tconst bookingGroups = groupBookingUis(\n\t\t\t\t\tresourceBookingsMap.get(resourceId) || [],\n\t\t\t\t);\n\t\t\t\tresourceBookingUiGroups.set(resourceId, bookingGroups);\n\t\t\t});\n\t}\n\n\treturn resourceBookingUiGroups;\n}\n","import { createNamespacedHelpers } from 'ui.vue3.vuex';\n\nimport { Model } from 'booking.const';\nimport { busySlots } from 'booking.lib.busy-slots';\nimport type { BookingModel, BookingModelUi } from 'booking.model.bookings';\n\nimport type { BookingUiDuration } from './booking/types';\nimport { Booking } from './booking/booking';\nimport { BusySlot } from './busy-slot/busy-slot';\nimport { Cell } from './cell/cell';\nimport { QuickFilterLine } from './quick-filter-line/quick-filter-line';\nimport {\n\tcreateBookingModelUi,\n\tsplitBookingsByResourceId,\n\tgetResourceBookingUiGroups,\n} from './libs';\nimport './bookings.css';\n\nconst { mapGetters: mapBookingsGetters } = createNamespacedHelpers(Model.Bookings);\nconst { mapGetters: mapInterfaceGetters } = createNamespacedHelpers(Model.Interface);\nconst { mapGetters: mapFilterGetters } = createNamespacedHelpers(Model.Filter);\n\nexport const Bookings = {\n\tname: 'Bookings',\n\tdata(): { nowTs: number }\n\t{\n\t\treturn {\n\t\t\tnowTs: Date.now(),\n\t\t};\n\t},\n\tcomputed: {\n\t\t...mapBookingsGetters({\n\t\t\toverbookingMap: 'overbookingMap',\n\t\t}),\n\t\t...mapInterfaceGetters({\n\t\t\tresourcesIds: 'resourcesIds',\n\t\t\tselectedDateTs: 'selectedDateTs',\n\t\t\tselectedCells: 'selectedCells',\n\t\t\thoveredCell: 'hoveredCell',\n\t\t\tbusySlots: 'busySlots',\n\t\t\tisFeatureEnabled: 'isFeatureEnabled',\n\t\t\teditingBookingId: 'editingBookingId',\n\t\t\tembedItems: 'embedItems',\n\t\t\tdraggedBookingId: 'draggedBookingId',\n\t\t}),\n\t\t...mapFilterGetters({\n\t\t\tfilteredBookingsIds: 'filteredBookingsIds',\n\t\t\tisFilterMode: 'isFilterMode',\n\t\t\tquickFilter: 'quickFilter',\n\t\t}),\n\t\tresourcesHash(): string\n\t\t{\n\t\t\tconst resources = this.$store.getters[`${Model.Resources}/getByIds`](this.resourcesIds)\n\t\t\t\t.map(({ id, slotRanges }) => ({ id, slotRanges }))\n\t\t\t;\n\n\t\t\treturn JSON.stringify(resources);\n\t\t},\n\t\tbookingsHash(): string\n\t\t{\n\t\t\tconst bookings = this.bookings\n\t\t\t\t.map(({ id, dateFromTs, dateToTs }) => ({ id, dateFromTs, dateToTs }))\n\t\t\t;\n\n\t\t\treturn JSON.stringify(bookings);\n\t\t},\n\t\tbookings(): BookingModelUi[]\n\t\t{\n\t\t\tconst dateTs = this.selectedDateTs;\n\n\t\t\tlet bookings = [];\n\t\t\tif (this.isFilterMode)\n\t\t\t{\n\t\t\t\tbookings = this.$store.getters[`${Model.Bookings}/getByDateAndIds`](dateTs, this.filteredBookingsIds);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tbookings = this.$store.getters[`${Model.Bookings}/getByDateAndResources`](dateTs, this.resourcesIds);\n\t\t\t}\n\n\t\t\treturn bookings.flatMap((booking) => {\n\t\t\t\treturn booking.resourcesIds\n\t\t\t\t\t.filter((resourceId: number) => this.resourcesIds.includes(resourceId))\n\t\t\t\t\t.map((resourceId: number) => {\n\t\t\t\t\t\treturn createBookingModelUi(resourceId, booking, this.overbookingMap.get(booking.id));\n\t\t\t\t\t});\n\t\t\t}).sort((a, b) => {\n\t\t\t\tif (a.resourcesIds[0] !== b.resourcesIds[0])\n\t\t\t\t{\n\t\t\t\t\treturn b.resourcesIds[0] - a.resourcesIds[0];\n\t\t\t\t}\n\n\t\t\t\tif (a.dateFromTs !== b.dateFromTs)\n\t\t\t\t{\n\t\t\t\t\treturn a.dateFromTs - b.dateFromTs;\n\t\t\t\t}\n\n\t\t\t\treturn b.overbooking - a.overbooking;\n\t\t\t});\n\t\t},\n\t\tcells(): CellDto[]\n\t\t{\n\t\t\tconst cells = [...Object.values(this.selectedCells), this.hoveredCell];\n\t\t\tconst dateFromTs = this.selectedDateTs;\n\t\t\tconst dateToTs = new Date(dateFromTs).setDate(new Date(dateFromTs).getDate() + 1);\n\n\t\t\treturn cells.filter((cell: CellDto) => cell && cell.toTs > dateFromTs && dateToTs > cell.fromTs);\n\t\t},\n\t\tquickFilterHours(): number[]\n\t\t{\n\t\t\tconst activeHours = new Set(Object.values(this.quickFilter.active));\n\n\t\t\treturn Object.values(this.quickFilter.hovered).filter((hour) => !activeHours.has(hour));\n\t\t},\n\t\tresourceBookings(): Map<number, BookingModelUi>\n\t\t{\n\t\t\treturn splitBookingsByResourceId(this.bookings);\n\t\t},\n\t\tresourceBookingsUiGroupsMap(): Map<number, BookingUiDuration[]>\n\t\t{\n\t\t\treturn getResourceBookingUiGroups(this.resourceBookings);\n\t\t},\n\t\tembedEditingMode(): boolean\n\t\t{\n\t\t\treturn (\n\t\t\t\tthis.isFeatureEnabled\n\t\t\t\t&& (\n\t\t\t\t\tthis.editingBookingId > 0\n\t\t\t\t\t|| (this.embedItems?.length ?? 0) > 0\n\t\t\t\t)\n\t\t\t);\n\t\t},\n\t\tdraggedBooking(): BookingModel | null\n\t\t{\n\t\t\tif (!this.draggedBookingId)\n\t\t\t{\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\treturn this.bookings.find(({ id }) => id === this.draggedBookingId) || null;\n\t\t},\n\t},\n\tmounted(): void\n\t{\n\t\tthis.startInterval();\n\t},\n\tmethods: {\n\t\tgenerateBookingKey(booking: BookingModel): string\n\t\t{\n\t\t\treturn `${booking.id}-${booking.resourcesIds[0]}`;\n\t\t},\n\t\tgetBookingUiGroupsByResourceId(resourceId: number): BookingUiDuration[]\n\t\t{\n\t\t\treturn this.resourceBookingsUiGroupsMap.get(resourceId) || [];\n\t\t},\n\t\tstartInterval(): void\n\t\t{\n\t\t\tsetInterval(() => {\n\t\t\t\tthis.nowTs = Date.now();\n\t\t\t}, 5 * 1000);\n\t\t},\n\t},\n\twatch: {\n\t\tselectedDateTs(): void\n\t\t{\n\t\t\tvoid busySlots.loadBusySlots();\n\t\t},\n\t\tbookingsHash(): void\n\t\t{\n\t\t\tvoid busySlots.loadBusySlots();\n\t\t},\n\t\tresourcesHash(): void\n\t\t{\n\t\t\tvoid busySlots.loadBusySlots();\n\t\t},\n\t\toverbookingMap(): void\n\t\t{\n\t\t\tvoid busySlots.loadBusySlots();\n\t\t},\n\t},\n\tcomponents: {\n\t\tBooking,\n\t\tBusySlot,\n\t\tCell,\n\t\tQuickFilterLine,\n\t},\n\ttemplate: `\n\t\t<div\n\t\t\tclass=\"booking-booking-bookings\"\n\t\t\t:class=\"{\n\t\t\t\t'embed-editing-mode': embedEditingMode,\n\t\t\t}\"\n\t\t>\n\t\t\t<TransitionGroup name=\"booking-transition-booking\">\n\t\t\t\t<template v-for=\"booking of bookings\" :key=\"generateBookingKey(booking)\">\n\t\t\t\t\t<Booking\n\t\t\t\t\t\t:bookingId=\"booking.id\"\n\t\t\t\t\t\t:resourceId=\"booking.resourcesIds[0]\"\n\t\t\t\t\t\t:nowTs\n\t\t\t\t\t\t:bookingUiGroups=\"getBookingUiGroupsByResourceId(booking.resourcesIds[0])\"\n\t\t\t\t\t/>\n\t\t\t\t</template>\n\t\t\t</TransitionGroup>\n\t\t\t<template v-for=\"busySlot of busySlots\" :key=\"busySlot.id\">\n\t\t\t\t<BusySlot\n\t\t\t\t\t:busySlot=\"busySlot\"\n\t\t\t\t/>\n\t\t\t</template>\n\t\t\t<template v-for=\"cell of cells\" :key=\"cell.id\">\n\t\t\t\t<Cell\n\t\t\t\t\t:cell=\"cell\"\n\t\t\t\t\t:draggedBooking=\"draggedBooking\"\n\t\t\t\t/>\n\t\t\t</template>\n\t\t\t<template v-for=\"hour of quickFilterHours\" :key=\"hour\">\n\t\t\t\t<QuickFilterLine\n\t\t\t\t\t:hour=\"hour\"\n\t\t\t\t/>\n\t\t\t</template>\n\t\t</div>\n\t`,\n};\n","import { mapGetters } from 'ui.vue3.vuex';\nimport { Model } from 'booking.const';\nimport type { BookingModel } from 'booking.model.bookings';\n\nimport type { CellDto, CellData } from './types';\nimport './cell.css';\n\nconst halfHour = 30 * 60 * 1000;\n\nexport const Cell = {\n\tname: 'Cell',\n\tprops: {\n\t\t/** @type {CellDto} */\n\t\tcell: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tdata(): CellData\n\t{\n\t\treturn {\n\t\t\thalfOffset: 0,\n\t\t};\n\t},\n\tcomputed: {\n\t\t...mapGetters({\n\t\t\toverbookingMap: `${Model.Bookings}/overbookingMap`,\n\t\t\tisFilterMode: `${Model.Filter}/isFilterMode`,\n\t\t\tisEditingBookingMode: `${Model.Interface}/isEditingBookingMode`,\n\t\t\tdraggedBookingId: `${Model.Interface}/draggedBookingId`,\n\t\t\tdraggedDataTransfer: `${Model.Interface}/draggedDataTransfer`,\n\t\t\tresizedBookingId: `${Model.Interface}/resizedBookingId`,\n\t\t\tquickFilter: `${Model.Filter}/quickFilter`,\n\t\t}),\n\t\tdraggedElementId(): number\n\t\t{\n\t\t\treturn this.draggedDataTransfer.id;\n\t\t},\n\t\tisAvailable(): boolean\n\t\t{\n\t\t\tif (this.isFilterMode || this.resizedBookingId || (this.isEditingBookingMode && !this.draggedDataTransfer.id))\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tconst { fromTs, toTs } = this.freeSpace;\n\n\t\t\tconst cellFromTs = this.cell.fromTs;\n\t\t\tconst cellHalfTs = this.cell.fromTs + halfHour;\n\n\t\t\treturn (toTs > cellFromTs || toTs > cellHalfTs) && (toTs - fromTs) >= this.duration;\n\t\t},\n\t\tfromTs(): number\n\t\t{\n\t\t\treturn Math.min(this.freeSpace.toTs - this.duration, this.cell.fromTs) + this.halfOffset;\n\t\t},\n\t\ttoTs(): number\n\t\t{\n\t\t\treturn this.fromTs + this.duration;\n\t\t},\n\t\tduration(): number\n\t\t{\n\t\t\tif (this.draggedBooking)\n\t\t\t{\n\t\t\t\treturn this.draggedBooking.dateToTs - this.draggedBooking.dateFromTs;\n\t\t\t}\n\n\t\t\treturn this.cell.toTs - this.cell.fromTs;\n\t\t},\n\t\tdraggedBooking(): BookingModel\n\t\t{\n\t\t\treturn this.$store.getters[`${Model.Bookings}/getById`](this.draggedBookingId) ?? null;\n\t\t},\n\t\tfreeSpace(): { fromTs: number, toTs: number }\n\t\t{\n\t\t\tlet maxFrom = 0;\n\t\t\tlet minTo = Infinity;\n\t\t\tfor (const { fromTs, toTs } of this.colliding)\n\t\t\t{\n\t\t\t\tif (this.cell.fromTs + halfHour > fromTs && this.cell.fromTs + halfHour < toTs)\n\t\t\t\t{\n\t\t\t\t\tmaxFrom = toTs;\n\t\t\t\t\tminTo = fromTs;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\t\tif (toTs <= this.cell.fromTs + halfHour)\n\t\t\t\t{\n\t\t\t\t\tmaxFrom = Math.max(maxFrom, toTs);\n\t\t\t\t}\n\n\t\t\t\tif (fromTs >= this.cell.fromTs + halfHour)\n\t\t\t\t{\n\t\t\t\t\tminTo = Math.min(minTo, fromTs);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn { fromTs: maxFrom, toTs: minTo };\n\t\t},\n\t\tcolliding(): { fromTs: number, toTs: number }[]\n\t\t{\n\t\t\treturn this.$store.getters[`${Model.Interface}/getColliding`](\n\t\t\t\tthis.cell.resourceId,\n\t\t\t\tthis.excludeBookingColliding,\n\t\t\t);\n\t\t},\n\t\tquickFilterHovered(): boolean\n\t\t{\n\t\t\treturn (this.cell.minutes / 60) in this.quickFilter.hovered;\n\t\t},\n\t\tquickFilterActive(): boolean\n\t\t{\n\t\t\treturn (this.cell.minutes / 60) in this.quickFilter.active;\n\t\t},\n\t},\n\tmethods: {\n\t\texcludeBookingColliding(booking: BookingModel): boolean\n\t\t{\n\t\t\tif (booking.id === this.draggedBookingId)\n\t\t\t{\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\tconst resourceId = this.cell.resourceId;\n\t\t\tconst overbooking = this.overbookingMap.get(booking.id);\n\n\t\t\treturn overbooking && overbooking.items.some((item) => item.resourceId === resourceId);\n\t\t},\n\t\tmouseEnterHandler(event: MouseEvent): void\n\t\t{\n\t\t\tthis.updateHalfHour(event);\n\t\t},\n\t\tmouseLeaveHandler(event: MouseEvent): void\n\t\t{\n\t\t\tconst nextHoveredCell = event.relatedTarget?.closest('.booking-booking-base-cell');\n\n\t\t\tif (!nextHoveredCell || nextHoveredCell?.dataset?.selected === 'true')\n\t\t\t{\n\t\t\t\tvoid this.$store.dispatch(`${Model.Interface}/setHoveredCell`, null);\n\t\t\t}\n\t\t},\n\t\tmouseMoveHandler(event: MouseEvent): void\n\t\t{\n\t\t\tthis.updateHalfHour(event);\n\t\t},\n\t\tupdateHalfHour(event: MouseEvent): void\n\t\t{\n\t\t\tif (this.$refs.button?.contains(event.target))\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.halfOffset = 0;\n\t\t\tconst clientY = event.clientY - window.scrollY;\n\t\t\tconst rect = this.$el.getBoundingClientRect();\n\t\t\tconst bottomHalf = clientY > (rect.top + rect.top + rect.height) / 2;\n\t\t\tconst canSubtractHalfHour = this.fromTs >= this.freeSpace.fromTs;\n\t\t\tconst canAddHalfHour = this.toTs + halfHour <= this.freeSpace.toTs;\n\n\t\t\tif ((bottomHalf && canAddHalfHour) || (!bottomHalf && !canSubtractHalfHour))\n\t\t\t{\n\t\t\t\tthis.halfOffset = halfHour;\n\t\t\t}\n\n\t\t\tif (\n\t\t\t\t((!bottomHalf && !canSubtractHalfHour) || (bottomHalf && !canAddHalfHour))\n\t\t\t\t&& this.freeSpace.fromTs - this.cell.fromTs > 0\n\t\t\t)\n\t\t\t{\n\t\t\t\tthis.halfOffset = this.freeSpace.fromTs - this.cell.fromTs;\n\t\t\t}\n\t\t\telse if ((!bottomHalf && canSubtractHalfHour) || (bottomHalf && !canAddHalfHour))\n\t\t\t{\n\t\t\t\tthis.halfOffset = 0;\n\t\t\t}\n\n\t\t\tconst offsetNotMatchesHalf = bottomHalf === (this.halfOffset === 0);\n\n\t\t\tif (this.duration <= halfHour && offsetNotMatchesHalf)\n\t\t\t{\n\t\t\t\tthis.clearCell(event);\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.hoverCell({\n\t\t\t\tid: `${this.cell.resourceId}-${this.fromTs}-${this.toTs}`,\n\t\t\t\tfromTs: this.fromTs,\n\t\t\t\ttoTs: this.toTs,\n\t\t\t\tresourceId: this.cell.resourceId,\n\t\t\t\tboundedToBottom: this.toTs === this.freeSpace.toTs,\n\t\t\t});\n\t\t},\n\t\tclearCell(event: MouseEvent): void\n\t\t{\n\t\t\tconst nextHoveredCell = event.relatedTarget?.closest('.booking-booking-base-cell');\n\n\t\t\tif (!nextHoveredCell || nextHoveredCell?.dataset?.selected === 'true')\n\t\t\t{\n\t\t\t\tvoid this.$store.dispatch(`${Model.Interface}/setHoveredCell`, null);\n\t\t\t}\n\t\t},\n\t\thoverCell(cell: CellDto): void\n\t\t{\n\t\t\tvoid this.$store.dispatch(`${Model.Interface}/setHoveredCell`, null);\n\n\t\t\tif (this.isAvailable)\n\t\t\t{\n\t\t\t\tvoid this.$store.dispatch(`${Model.Interface}/setHoveredCell`, cell);\n\t\t\t}\n\t\t},\n\t},\n\twatch: {\n\t\tdraggedElementId(): void\n\t\t{\n\t\t\tif (!this.draggedElementId)\n\t\t\t{\n\t\t\t\tvoid this.$store.dispatch(`${Model.Interface}/setHoveredCell`, null);\n\t\t\t}\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div\n\t\t\tclass=\"booking-booking-grid-cell\"\n\t\t\t:class=\"{\n\t\t\t\t'--quick-filter-hovered': quickFilterHovered,\n\t\t\t\t'--quick-filter-active': quickFilterActive,\n\t\t\t}\"\n\t\t\tdata-element=\"booking-grid-cell\"\n\t\t\t:data-resource-id=\"cell.resourceId\"\n\t\t\t:data-from=\"cell.fromTs\"\n\t\t\t:data-to=\"cell.toTs\"\n\t\t\t@mouseenter=\"mouseEnterHandler\"\n\t\t\t@mouseleave=\"mouseLeaveHandler\"\n\t\t\t@mousemove=\"mouseMoveHandler\"\n\t\t></div>\n\t`,\n};\n","import { mapGetters } from 'ui.vue3.vuex';\nimport { Model } from 'booking.const';\nimport { expandOffHours } from '../../../../lib/expand-off-hours/expand-off-hours';\nimport './off-hours.css';\n\nexport const OffHours = {\n\tprops: {\n\t\tbottom: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t},\n\tcomputed: mapGetters({\n\t\toffHoursHover: `${Model.Interface}/offHoursHover`,\n\t\toffHoursExpanded: `${Model.Interface}/offHoursExpanded`,\n\t}),\n\tmethods: {\n\t\tanimateOffHours({ keepScroll }): void\n\t\t{\n\t\t\tif (this.offHoursExpanded)\n\t\t\t{\n\t\t\t\texpandOffHours.collapse();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\texpandOffHours.expand({ keepScroll });\n\t\t\t}\n\n\t\t\tvoid this.$store.dispatch(`${Model.Interface}/setOffHoursExpanded`, !this.offHoursExpanded);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"booking-booking-grid-padding\">\n\t\t\t<div\n\t\t\t\tclass=\"booking-booking-column-off-hours\"\n\t\t\t\t:class=\"{'--bottom': bottom, '--hover': offHoursHover}\"\n\t\t\t\t@click=\"animateOffHours({ keepScroll: bottom })\"\n\t\t\t\t@mouseenter=\"$store.dispatch('interface/setOffHoursHover', true)\"\n\t\t\t\t@mouseleave=\"$store.dispatch('interface/setOffHoursHover', false)\"\n\t\t\t></div>\n\t\t</div>\n\t`,\n};\n","import { createNamespacedHelpers } from 'ui.vue3.vuex';\nimport { range } from 'booking.lib.range';\nimport { Model } from 'booking.const';\nimport type { ResourceModel } from 'booking.model.resources';\nimport { Cell } from './cell/cell';\nimport { OffHours } from './off-hours/off-hours';\nimport './column.css';\n\nconst { mapGetters: mapInterfaceGetters } = createNamespacedHelpers(Model.Interface);\n\nexport const Column = {\n\tprops: {\n\t\tresourceId: Number,\n\t},\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tvisible: true,\n\t\t};\n\t},\n\tmounted(): void\n\t{\n\t\tthis.updateVisibility();\n\t\tthis.updateVisibilityDuringTransition();\n\t},\n\tcomputed: {\n\t\t...mapInterfaceGetters({\n\t\t\tresourcesIds: 'resourcesIds',\n\t\t\tzoom: 'zoom',\n\t\t\tscroll: 'scroll',\n\t\t\tselectedDateTs: 'selectedDateTs',\n\t\t\toffHoursHover: 'offHoursHover',\n\t\t\toffHoursExpanded: 'offHoursExpanded',\n\t\t\tfromHour: 'fromHour',\n\t\t\ttoHour: 'toHour',\n\t\t\toffset: 'offset',\n\t\t}),\n\t\tresource(): ResourceModel\n\t\t{\n\t\t\treturn this.$store.getters['resources/getById'](this.resourceId);\n\t\t},\n\t\tfromMinutes(): number\n\t\t{\n\t\t\treturn this.fromHour * 60;\n\t\t},\n\t\ttoMinutes(): number\n\t\t{\n\t\t\treturn this.toHour * 60;\n\t\t},\n\t\tslotSize(): number\n\t\t{\n\t\t\treturn this.resource.slotRanges[0]?.slotSize ?? 60;\n\t\t},\n\t\toffHoursTopCells(): CellDto[]\n\t\t{\n\t\t\treturn this.cells.filter((it: CellDto) => it.minutes < this.fromMinutes);\n\t\t},\n\t\tworkTimeCells(): CellDto[]\n\t\t{\n\t\t\treturn this.cells.filter((it: CellDto) => it.minutes >= this.fromMinutes && it.minutes < this.toMinutes);\n\t\t},\n\t\toffHoursBottomCells(): CellDto[]\n\t\t{\n\t\t\treturn this.cells.filter((it: CellDto) => it.minutes >= this.toMinutes);\n\t\t},\n\t\tcells(): CellDto[]\n\t\t{\n\t\t\tconst hour = 3600 * 1000;\n\t\t\tconst from = this.selectedDateTs;\n\t\t\tconst to = new Date(from).setDate(new Date(from).getDate() + 1);\n\n\t\t\treturn range(from, to - hour, hour).map((fromTs) => {\n\t\t\t\tconst toTs = fromTs + this.slotSize * 60 * 1000;\n\n\t\t\t\treturn {\n\t\t\t\t\tid: `${this.resource.id}-${fromTs}-${toTs}`,\n\t\t\t\t\tfromTs,\n\t\t\t\t\ttoTs,\n\t\t\t\t\tminutes: new Date(fromTs + this.offset).getHours() * 60,\n\t\t\t\t\tresourceId: this.resource.id,\n\t\t\t\t};\n\t\t\t});\n\t\t},\n\t},\n\tmethods: {\n\t\tupdateVisibilityDuringTransition(): void\n\t\t{\n\t\t\tthis.animation?.stop();\n\t\t\tthis.animation = new BX.easing({\n\t\t\t\tduration: 200,\n\t\t\t\tstart: {},\n\t\t\t\tfinish: {},\n\t\t\t\tstep: this.updateVisibility,\n\t\t\t});\n\t\t\tthis.animation.animate();\n\t\t},\n\t\tupdateVisibility(): void\n\t\t{\n\t\t\tconst rect = this.$el.getBoundingClientRect();\n\t\t\tthis.visible = rect.right > 0 && rect.left < window.innerWidth;\n\t\t},\n\t},\n\twatch: {\n\t\tscroll(): void\n\t\t{\n\t\t\tthis.updateVisibility();\n\t\t},\n\t\tzoom(): void\n\t\t{\n\t\t\tthis.updateVisibility();\n\t\t},\n\t\tresourcesIds(): void\n\t\t{\n\t\t\tthis.updateVisibilityDuringTransition();\n\t\t},\n\t},\n\tcomponents: {\n\t\tCell,\n\t\tOffHours,\n\t},\n\ttemplate: `\n\t\t<div\n\t\t\tclass=\"booking-booking-grid-column\"\n\t\t\tdata-element=\"booking-grid-column\"\n\t\t\t:data-id=\"resourceId\"\n\t\t>\n\t\t\t<template v-if=\"visible\">\n\t\t\t\t<OffHours/>\n\t\t\t\t<div class=\"booking-booking-grid-off-hours-cells\">\n\t\t\t\t\t<Cell v-for=\"cell of offHoursTopCells\" :key=\"cell.id\" :cell=\"cell\"/>\n\t\t\t\t</div>\n\t\t\t\t<Cell v-for=\"cell of workTimeCells\" :key=\"cell.id\" :cell=\"cell\"/>\n\t\t\t\t<div class=\"booking-booking-grid-off-hours-cells --bottom\">\n\t\t\t\t\t<Cell v-for=\"cell of offHoursBottomCells\" :key=\"cell.id\" :cell=\"cell\"/>\n\t\t\t\t</div>\n\t\t\t\t<OffHours :bottom=\"true\"/>\n\t\t\t</template>\n\t\t</div>\n\t`,\n};\n","import { Dom, Extension, Tag } from 'main.core';\nimport { Core } from 'booking.core';\nimport { Model } from 'booking.const';\nimport './maximize.css';\n\ntype Inset = {\n\tleft: number,\n\ttop: number,\n\tright: number,\n\tbottom: number,\n};\n\nconst isAirTemplate = Extension.getSettings('booking.booking').isAirTemplate;\n\nconst duration = 200;\nconst counterPanelScopeClass = 'ui-counter-panel__scope';\nconst darkThemeClass = 'bitrix24-dark-theme --ui-context-content-light';\n\nexport class Maximize\n{\n\t#slider;\n\t#overlay: HTMLElement;\n\n\tconstructor({ onOverlayClick })\n\t{\n\t\tthis.onOverlayClick = onOverlayClick;\n\t\tthis.#slider = new (BX.SidePanel.Manager.getSliderClass())('');\n\t\tthis.#overlay = this.#renderOverlay();\n\n\t\tif (top.BX)\n\t\t{\n\t\t\ttop.BX.Event.EventEmitter.subscribe('SidePanel.Slider:onCloseComplete', this.#handleSliderClose);\n\t\t\ttop.BX.Event.EventEmitter.subscribe('SidePanel.Slider:onDestroy', this.#handleSliderClose);\n\t\t}\n\t}\n\n\t#handleSliderClose = (): void => {\n\t\tif (this.#isExpanded)\n\t\t{\n\t\t\tthis.#slider.applyHacks();\n\t\t\tBX.SidePanel.Instance.disablePageScrollbar();\n\t\t}\n\t};\n\n\t#renderOverlay(): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"booking-booking-overlay\" onclick=\"${this.onOverlayClick}\"></div>\n\t\t`;\n\t}\n\n\tget #isExpanded(): boolean\n\t{\n\t\treturn Core.getStore().getters[`${Model.Interface}/expanded`];\n\t}\n\n\tasync maximize(): Promise<void>\n\t{\n\t\tawait Core.getStore().dispatch(`${Model.Interface}/setExpanded`, true);\n\n\t\tthis.#slider.applyHacks();\n\t\tBX.SidePanel.Instance.disablePageScrollbar();\n\n\t\tconst start = this.#getInset(this.#appContainer);\n\t\tDom.style(this.#appContainer, 'position', 'fixed');\n\t\tDom.style(this.#appContainer, 'inset', '0 0 0 0');\n\t\tconst finish = this.#getInset(this.#appContainer);\n\n\t\tthis.#applyMaximizedStyles();\n\n\t\tDom.removeClass(this.#overlay, '--closing');\n\t\tDom.addClass(this.#overlay, '--opening');\n\t\tDom.append(this.#overlay, document.body);\n\t\tawait this.#animate(start, finish);\n\t}\n\n\tasync minimize(): Promise<void>\n\t{\n\t\tawait Core.getStore().dispatch(`${Model.Interface}/setExpanded`, false);\n\n\t\tthis.#slider.resetHacks();\n\t\tBX.SidePanel.Instance.enablePageScrollbar();\n\n\t\tconst start = this.#getInset(this.#appContainer);\n\t\tDom.style(this.#appContainer, 'position', null);\n\t\tconst finish = this.#getInset(this.#appContainer);\n\n\t\tthis.#applyMinimizedStyles();\n\n\t\tDom.removeClass(this.#overlay, '--opening');\n\t\tDom.addClass(this.#overlay, '--closing');\n\t\tDom.style(this.#appContainer, 'position', 'fixed');\n\t\tawait this.#animate(start, finish);\n\t\tDom.style(this.#appContainer, 'position', null);\n\t\tDom.remove(this.#overlay);\n\t}\n\n\t#getInset(container: HTMLElement): Inset\n\t{\n\t\tconst rect = container.getBoundingClientRect();\n\n\t\treturn {\n\t\t\tleft: rect.left,\n\t\t\ttop: rect.top,\n\t\t\tright: window.innerWidth - (rect.left + rect.width),\n\t\t\tbottom: window.innerHeight - (rect.top + rect.height),\n\t\t};\n\t}\n\n\t#animate(start: Inset, finish: Inset): Promise<void>\n\t{\n\t\treturn new Promise((complete) => new BX.easing({\n\t\t\tduration,\n\t\t\tstart,\n\t\t\tfinish,\n\t\t\tstep: ({ top, right, bottom, left }: Inset) => {\n\t\t\t\tDom.style(this.#appContainer, 'inset', `${top}px ${right}px ${bottom}px ${left}px`);\n\t\t\t},\n\t\t\tcomplete,\n\t\t}).animate());\n\t}\n\n\t#applyMaximizedStyles(): void\n\t{\n\t\tDom.removeClass(this.#counterPanel, counterPanelScopeClass);\n\t\tDom.addClass(this.#appContainer, darkThemeClass);\n\t\tDom.style(this.#appContainer, 'height', 'initial');\n\t\tDom.style(this.#appContainer, 'position', 'fixed');\n\t\tDom.style(this.#appContainer, 'clip-path', `inset(0 ${this.#imBarWidth}px 0 0)`);\n\t\tDom.style(this.#appContainer, 'background', 'var(--ui-color-palette-white-base)');\n\n\t\tif (isAirTemplate)\n\t\t{\n\t\t\tDom.style(this.#appHeader, 'padding-left', '12px');\n\t\t\tDom.style(this.#appHeader, 'padding-right', '12px');\n\t\t}\n\n\t\tDom.style(this.#appHeader, 'border-bottom', '1px solid var(--ui-color-base-10)');\n\t\tDom.style(this.#appHeader, 'max-width', '100%');\n\t\tDom.style(this.#appHeader.parentElement, 'padding-right', `${this.#imBarWidth}px`);\n\t\tDom.style(this.#appContent, 'margin', 0);\n\t\tDom.style(this.#appContent, 'border-radius', 0);\n\n\t\tif (isAirTemplate)\n\t\t{\n\t\t\tDom.style(this.#contentPaddingElement, 'padding', 0);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tDom.style(this.#contentPaddingElement, 'padding-bottom', 0);\n\t\t\tDom.style(this.#contentPaddingElement, 'padding-right', `${this.#imBarWidth}px`);\n\t\t}\n\n\t\tDom.style(this.#overlay, '--right', `${this.#imBarWidth}px`);\n\t\tBX.ZIndexManager.register(this.#appContainer, { overlay: this.#overlay });\n\t}\n\n\t#applyMinimizedStyles(): void\n\t{\n\t\tDom.addClass(this.#counterPanel, counterPanelScopeClass);\n\t\tDom.removeClass(this.#appContainer, darkThemeClass);\n\t\tDom.style(this.#appContainer, 'position', null);\n\t\tDom.style(this.#appContainer, 'clip-path', null);\n\t\tDom.style(this.#appContainer, 'background', null);\n\t\tDom.style(this.#appHeader, 'border-bottom', null);\n\t\tDom.style(this.#appHeader, 'max-width', null);\n\t\tDom.style(this.#appHeader.parentElement, 'padding-right', null);\n\t\tDom.style(this.#appContent, 'margin', null);\n\t\tDom.style(this.#appContent, 'border-radius', null);\n\n\t\tif (isAirTemplate)\n\t\t{\n\t\t\tDom.style(this.#contentPaddingElement, 'padding', null);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tDom.style(this.#contentPaddingElement, 'padding-bottom', null);\n\t\t\tDom.style(this.#contentPaddingElement, 'padding-right', null);\n\t\t}\n\n\t\tBX.ZIndexManager.unregister(this.#appContainer);\n\t}\n\n\tget #appContainer(): HTMLElement\n\t{\n\t\tif (isAirTemplate)\n\t\t{\n\t\t\treturn document.querySelector('.app__page');\n\t\t}\n\n\t\treturn BX('content-table');\n\t}\n\n\tget #appHeader(): HTMLElement\n\t{\n\t\tif (isAirTemplate)\n\t\t{\n\t\t\treturn document.querySelector('.page__toolbar');\n\t\t}\n\n\t\treturn document.querySelector('.page-header');\n\t}\n\n\tget #counterPanel(): HTMLElement\n\t{\n\t\treturn Core.getParams().counterPanelContainer.firstElementChild;\n\t}\n\n\tget #appContent(): HTMLElement\n\t{\n\t\tif (isAirTemplate)\n\t\t{\n\t\t\treturn BX('air-workarea-content');\n\t\t}\n\n\t\treturn BX('workarea-content');\n\t}\n\n\tget #contentPaddingElement(): HTMLElement\n\t{\n\t\tif (isAirTemplate)\n\t\t{\n\t\t\treturn document.querySelector('.app__page');\n\t\t}\n\n\t\treturn BX('workarea')?.parentElement;\n\t}\n\n\tget #imBarWidth(): number\n\t{\n\t\tif (isAirTemplate)\n\t\t{\n\t\t\treturn 0;\n\t\t}\n\n\t\tconst imBar = isAirTemplate ? BX('right-bar') : BX('bx-im-bar');\n\n\t\treturn window.innerWidth - imBar.getBoundingClientRect().left;\n\t}\n}\n","import { Dom, Event } from 'main.core';\nimport { mapGetters } from 'ui.vue3.vuex';\n\nimport { Core } from 'booking.core';\nimport { AhaMoment, HelpDesk } from 'booking.const';\nimport { ahaMoments } from 'booking.lib.aha-moments';\nimport { Maximize } from '../../../lib/maximize/maximize';\nimport './scale-panel.css';\n\nexport const ScalePanel = {\n\tprops: {\n\t\tgetColumnsContainer: Function,\n\t},\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tisSlider: Core.getParams().isSlider,\n\t\t\tmaximize: new Maximize({\n\t\t\t\tonOverlayClick: () => this.collapse(),\n\t\t\t}),\n\t\t\tdesiredZoom: this.$store.getters['interface/zoom'],\n\t\t\tminZoom: 0.5,\n\t\t\tmaxZoom: 1,\n\t\t};\n\t},\n\tmounted(): void\n\t{\n\t\tif (location.hash === '#maximize')\n\t\t{\n\t\t\tvoid this.maximize.maximize();\n\t\t}\n\t},\n\tcomputed: {\n\t\t...mapGetters({\n\t\t\tzoom: 'interface/zoom',\n\t\t\texpanded: 'interface/expanded',\n\t\t}),\n\t\tzoomFormatted(): string\n\t\t{\n\t\t\treturn this.loc('BOOKING_BOOKING_ZOOM_PERCENT', {\n\t\t\t\t'#PERCENT#': Math.round(this.zoom * 100),\n\t\t\t});\n\t\t},\n\t},\n\tmethods: {\n\t\texpand(event: MouseEvent): void\n\t\t{\n\t\t\tif (location.hash === '#maximize' || this.isAnyModifierKeyPressed(event))\n\t\t\t{\n\t\t\t\tvoid this.maximize.maximize();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\twindow.open(`${location.href}#maximize`, '_blank').focus();\n\t\t\t}\n\t\t},\n\t\tisAnyModifierKeyPressed(event: MouseEvent): boolean\n\t\t{\n\t\t\treturn event.altKey || event.shiftKey || event.ctrlKey || event.metaKey;\n\t\t},\n\t\tcollapse(): void\n\t\t{\n\t\t\tvoid this.maximize.minimize();\n\t\t},\n\t\tfitToScreen(): void\n\t\t{\n\t\t\tconst sidebarPadding = 260;\n\t\t\tconst view = this.getColumnsContainer();\n\t\t\tconst zoomCoefficient = (view.offsetWidth - sidebarPadding) / (view.scrollWidth - sidebarPadding);\n\t\t\tconst newZoom = Math.floor(this.zoom * zoomCoefficient * 10) / 10;\n\n\t\t\tthis.zoomInto(newZoom);\n\t\t},\n\t\tzoomInto(zoomInto: number): void\n\t\t{\n\t\t\tif (Number.isNaN(zoomInto))\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst noTransitionClass = '--booking-booking-no-transition';\n\t\t\tconst container = Core.getParams().container;\n\t\t\tconst maxAnimationDuration = 400;\n\n\t\t\tthis.desiredZoom = Math.max(this.minZoom, Math.min(this.maxZoom, zoomInto));\n\n\t\t\tif (this.zoom === this.desiredZoom)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.animation?.stop();\n\t\t\tDom.addClass(container, noTransitionClass);\n\t\t\tthis.animation = new BX.easing({\n\t\t\t\tduration: Math.abs(this.zoom - this.desiredZoom) / this.minZoom * maxAnimationDuration,\n\t\t\t\tstart: { zoom: this.zoom * 100 },\n\t\t\t\tfinish: { zoom: this.desiredZoom * 100 },\n\t\t\t\tstep: ({ zoom }) => this.$store.dispatch('interface/setZoom', zoom / 100),\n\t\t\t\tcomplete: () => Dom.removeClass(container, noTransitionClass),\n\t\t\t});\n\t\t\tthis.animation.animate();\n\t\t},\n\t\tasync onMouseDown(direction: 1 | -1): Promise<void>\n\t\t{\n\t\t\tEvent.unbind(window, 'mouseup', this.onMouseUp);\n\t\t\tEvent.bind(window, 'mouseup', this.onMouseUp);\n\t\t\tthis.mouseDown = true;\n\t\t\tawait new Promise((resolve) => setTimeout(resolve, 50));\n\t\t\tif (this.mouseDown)\n\t\t\t{\n\t\t\t\tclearInterval(this.zoomInterval);\n\t\t\t\tthis.zoomInterval = setInterval(() => this.zoomInto(this.desiredZoom + direction * 0.1), 40);\n\t\t\t}\n\t\t},\n\t\tonMouseUp(): void\n\t\t{\n\t\t\tthis.mouseDown = false;\n\t\t\tif (this.desiredZoom > this.zoom)\n\t\t\t{\n\t\t\t\tthis.desiredZoom = Math.ceil(this.zoom * 10) / 10;\n\t\t\t}\n\n\t\t\tif (this.desiredZoom < this.zoom)\n\t\t\t{\n\t\t\t\tthis.desiredZoom = Math.floor(this.zoom * 10) / 10;\n\t\t\t}\n\n\t\t\tthis.zoomInto(this.desiredZoom);\n\t\t\tclearInterval(this.zoomInterval);\n\t\t\tEvent.unbind(window, 'mouseup', this.onMouseUp);\n\t\t},\n\t\tasync showAhaMoment(): Promise<void>\n\t\t{\n\t\t\tahaMoments.setPopupShown(AhaMoment.ExpandGrid);\n\n\t\t\tawait ahaMoments.show({\n\t\t\t\tid: 'booking-expand-grid',\n\t\t\t\ttitle: this.loc('BOOKING_AHA_EXPAND_GRID_TITLE_MSGVER_1'),\n\t\t\t\ttext: this.loc('BOOKING_AHA_EXPAND_GRID_TEXT_MSGVER_1'),\n\t\t\t\ttarget: this.$refs.expand,\n\t\t\t\ttop: true,\n\t\t\t});\n\n\t\t\tahaMoments.setShown(AhaMoment.ExpandGrid);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"booking-booking-grid-scale-panel\">\n\t\t\t<div v-if=\"!isSlider\" class=\"booking-booking-grid-scale-panel-full-screen\" ref=\"expand\">\n\t\t\t\t<div v-if=\"expanded\" class=\"ui-icon-set --collapse-diagonal\" @click=\"collapse\"></div>\n\t\t\t\t<div v-else class=\"ui-icon-set --expand-diagonal\" @click=\"expand\"></div>\n\t\t\t</div>\n\t\t\t<div class=\"booking-booking-grid-scale-panel-fit-to-screen\">\n\t\t\t\t<div class=\"booking-booking-grid-scale-panel-fit-to-screen-text\" @click=\"fitToScreen\">\n\t\t\t\t\t{{ loc('BOOKING_BOOKING_SHOW_ALL') }}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div class=\"booking-booking-grid-scale-panel-change\">\n\t\t\t\t<div\n\t\t\t\t\tclass=\"ui-icon-set --minus-30\"\n\t\t\t\t\t:class=\"{'--disabled': zoom <= minZoom}\"\n\t\t\t\t\t@click=\"zoomInto(desiredZoom - 0.1)\"\n\t\t\t\t\t@mousedown=\"onMouseDown(-1)\"\n\t\t\t\t></div>\n\t\t\t\t<div v-html=\"zoomFormatted\" class=\"booking-booking-grid-scale-panel-zoom\"></div>\n\t\t\t\t<div\n\t\t\t\t\tclass=\"ui-icon-set --plus-30\"\n\t\t\t\t\t:class=\"{'--disabled': zoom >= maxZoom}\"\n\t\t\t\t\t@click=\"zoomInto(desiredZoom + 0.1)\"\n\t\t\t\t\t@mousedown=\"onMouseDown(1)\"\n\t\t\t\t></div>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import { DateTimeFormat } from 'main.date';\nimport { DatePicker, DatePickerEvent, getNextDate, createDate } from 'ui.date-picker';\nimport { createNamespacedHelpers, mapGetters } from 'ui.vue3.vuex';\nimport { BIcon as Icon, Set as IconSet } from 'ui.icon-set.api.vue';\nimport 'ui.icon-set.main';\nimport 'ui.icon-set.actions';\n\nimport { DateFormat, Model, Option } from 'booking.const';\nimport { optionService } from 'booking.provider.service.option-service';\nimport { CounterFloating } from 'booking.component.counter-floating';\n\nimport './calendar.css';\n\nconst { mapGetters: mapInterfaceGetters } = createNamespacedHelpers(Model.Interface);\nconst { mapGetters: mapFilterGetters } = createNamespacedHelpers(Model.Filter);\n\n// @vue/component\nexport const Calendar = {\n\tcomponents: {\n\t\tIcon,\n\t\tCounterFloating,\n\t},\n\tprops: {\n\t\tcalendarClass: {\n\t\t\ttype: [String, Object, Array],\n\t\t\tdefault: '',\n\t\t},\n\t},\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tIconSet,\n\t\t};\n\t},\n\tcomputed: {\n\t\t...mapGetters({\n\t\t\tcalendarExpanded: `${Model.Interface}/calendarExpanded`,\n\t\t\tdatesCount: `${Model.Filter}/datesCount`,\n\t\t}),\n\t\t...mapInterfaceGetters({\n\t\t\tfreeMarks: 'freeMarks',\n\t\t\tgetCounterMarks: 'getCounterMarks',\n\t\t\toffset: 'offset',\n\t\t}),\n\t\t...mapFilterGetters({\n\t\t\tfilteredMarks: 'filteredMarks',\n\t\t\tisFilterMode: 'isFilterMode',\n\t\t\tisDeletingResourceFilterMode: 'isDeletingResourceFilterMode',\n\t\t}),\n\t\tselectedDateTs(): number\n\t\t{\n\t\t\treturn this.$store.getters[`${Model.Interface}/selectedDateTs`] + this.offset;\n\t\t},\n\t\tviewDateTs(): number\n\t\t{\n\t\t\treturn this.$store.getters[`${Model.Interface}/viewDateTs`] + this.offset;\n\t\t},\n\t\tcounterMarks(): string[]\n\t\t{\n\t\t\tif (this.isFilterMode || this.isDeletingResourceFilterMode)\n\t\t\t{\n\t\t\t\treturn this.getCounterMarks(this.filteredMarks);\n\t\t\t}\n\n\t\t\treturn this.getCounterMarks();\n\t\t},\n\t\tformattedDate(): string\n\t\t{\n\t\t\tconst format = this.calendarExpanded\n\t\t\t\t? this.loc('BOOKING_MONTH_YEAR_FORMAT')\n\t\t\t\t: DateTimeFormat.getFormat('LONG_DATE_FORMAT')\n\t\t\t;\n\n\t\t\tconst timestamp = this.calendarExpanded\n\t\t\t\t? this.viewDateTs / 1000\n\t\t\t\t: this.selectedDateTs / 1000\n\t\t\t;\n\n\t\t\treturn DateTimeFormat.format(format, timestamp);\n\t\t},\n\t\tisShowCounterFloating(): boolean\n\t\t{\n\t\t\treturn (this.isDeletingResourceFilterMode || this.isFilterMode) && (this.datesCount.count > 0);\n\t\t},\n\t},\n\twatch: {\n\t\tselectedDateTs(selectedDateTs: number): void\n\t\t{\n\t\t\tthis.datePicker.selectDate(createDate(selectedDateTs));\n\t\t\tthis.updateMarks();\n\t\t},\n\t\tfilteredMarks(): void\n\t\t{\n\t\t\tthis.updateMarks();\n\t\t},\n\t\tfreeMarks(): void\n\t\t{\n\t\t\tthis.updateMarks();\n\t\t},\n\t\tcounterMarks(): void\n\t\t{\n\t\t\tthis.setCounterMarks();\n\t\t},\n\t\tisFilterMode(): void\n\t\t{\n\t\t\tthis.updateMarks();\n\t\t},\n\t},\n\tcreated(): void\n\t{\n\t\tthis.datePicker = new DatePicker({\n\t\t\tselectedDates: [this.selectedDateTs],\n\t\t\tinline: true,\n\t\t\thideHeader: true,\n\t\t});\n\n\t\tthis.setViewDate();\n\n\t\tthis.datePicker.subscribe(DatePickerEvent.SELECT, (event) => {\n\t\t\tconst date = event.getData().date;\n\t\t\tconst selectedDate = this.createDateFromUtc(date);\n\t\t\tvoid this.$store.dispatch(`${Model.Interface}/setSelectedDateTs`, selectedDate.getTime());\n\t\t\tthis.setViewDate();\n\t\t});\n\t},\n\tmounted(): void\n\t{\n\t\tthis.datePicker.setTargetNode(this.$refs.datePicker);\n\t\tthis.datePicker.show();\n\t},\n\tbeforeUnmount(): void\n\t{\n\t\tthis.datePicker.destroy();\n\t},\n\tmethods: {\n\t\tonPreviousClick(): void\n\t\t{\n\t\t\tif (this.calendarExpanded)\n\t\t\t{\n\t\t\t\tthis.previousMonth();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.previousDate();\n\t\t\t}\n\t\t},\n\t\tonNextClick(): void\n\t\t{\n\t\t\tif (this.calendarExpanded)\n\t\t\t{\n\t\t\t\tthis.nextMonth();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.nextDate();\n\t\t\t}\n\t\t},\n\t\tpreviousDate(): void\n\t\t{\n\t\t\tconst selectedDate = this.datePicker.getSelectedDate() || this.datePicker.getToday();\n\t\t\tthis.datePicker.selectDate(getNextDate(selectedDate, 'day', -1));\n\t\t\tthis.setViewDate();\n\t\t},\n\t\tnextDate(): void\n\t\t{\n\t\t\tconst selectedDate = this.datePicker.getSelectedDate() || this.datePicker.getToday();\n\t\t\tthis.datePicker.selectDate(getNextDate(selectedDate, 'day'));\n\t\t\tthis.setViewDate();\n\t\t},\n\t\tpreviousMonth(): void\n\t\t{\n\t\t\tconst viewDate = this.datePicker.getViewDate();\n\t\t\tthis.datePicker.setViewDate(getNextDate(viewDate, 'month', -1));\n\t\t\tthis.setViewDate();\n\t\t},\n\t\tnextMonth(): void\n\t\t{\n\t\t\tconst viewDate = this.datePicker.getViewDate();\n\t\t\tthis.datePicker.setViewDate(getNextDate(viewDate, 'month'));\n\t\t\tthis.setViewDate();\n\t\t},\n\t\tsetViewDate(): void\n\t\t{\n\t\t\tconst viewDate = this.createDateFromUtc(this.datePicker.getViewDate());\n\t\t\tconst viewDateTs = viewDate.setDate(1);\n\n\t\t\tvoid this.$store.dispatch(`${Model.Interface}/setViewDateTs`, viewDateTs);\n\t\t},\n\t\tcreateDateFromUtc(date: Date): Date\n\t\t{\n\t\t\treturn new Date(date.getUTCFullYear(), date.getUTCMonth(), date.getUTCDate());\n\t\t},\n\t\tupdateMarks(): void\n\t\t{\n\t\t\tif (this.isFilterMode || this.isDeletingResourceFilterMode)\n\t\t\t{\n\t\t\t\tthis.setFilterMarks();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.setFreeMarks();\n\t\t\t}\n\n\t\t\tthis.setCounterMarks();\n\t\t},\n\t\tsetFreeMarks(): void\n\t\t{\n\t\t\tconst bgColorFree = 'rgba(var(--ui-color-background-success-rgb), 0.7)';\n\t\t\tconst dates = this.prepareDates(this.freeMarks);\n\n\t\t\tthis.datePicker.setDayColors([\n\t\t\t\t{\n\t\t\t\t\tmatcher: dates,\n\t\t\t\t\tbgColor: bgColorFree,\n\t\t\t\t},\n\t\t\t]);\n\t\t},\n\t\tgetFilterMarks(): string[]\n\t\t{\n\t\t\tif (!this.isDeletingResourceFilterMode)\n\t\t\t{\n\t\t\t\treturn this.filteredMarks;\n\t\t\t}\n\n\t\t\tconst today = new Date();\n\t\t\tconst todayTs = today.setHours(0, 0, 0, 0);\n\n\t\t\treturn this.filteredMarks.filter((freeMarkTs) => new Date(freeMarkTs).getTime() >= todayTs);\n\t\t},\n\t\tsetFilterMarks(): void\n\t\t{\n\t\t\tconst bgColorFilter = 'rgba(var(--ui-color-primary-rgb), 0.20)';\n\t\t\tconst dates = this.prepareDates(this.getFilterMarks());\n\n\t\t\tthis.datePicker.setDayColors([\n\t\t\t\t{\n\t\t\t\t\tmatcher: dates,\n\t\t\t\t\tbgColor: bgColorFilter,\n\t\t\t\t},\n\t\t\t]);\n\t\t},\n\t\tsetCounterMarks(): void\n\t\t{\n\t\t\tconst dates = this.prepareDates(this.counterMarks);\n\n\t\t\tthis.datePicker.setDayMarks([\n\t\t\t\t{\n\t\t\t\t\tmatcher: dates,\n\t\t\t\t\tbgColor: 'red',\n\t\t\t\t},\n\t\t\t]);\n\t\t},\n\t\tprepareDates(dates: string[]): string[]\n\t\t{\n\t\t\treturn dates.map((markDate: string): string => {\n\t\t\t\tconst date = DateTimeFormat.parse(markDate, false, DateFormat.ServerParse);\n\n\t\t\t\treturn this.prepareTimestamp(date.getTime());\n\t\t\t});\n\t\t},\n\t\tprepareTimestamp(timestamp: number): string\n\t\t{\n\t\t\tconst dateFormat = DateTimeFormat.getFormat('FORMAT_DATE');\n\n\t\t\treturn DateTimeFormat.format(dateFormat, timestamp / 1000);\n\t\t},\n\t\tasync collapseToggle(): Promise<void>\n\t\t{\n\t\t\tawait Promise.all([\n\t\t\t\tthis.$store.dispatch(`${Model.Interface}/setCalendarExpanded`, !this.calendarExpanded),\n\t\t\t\toptionService.setBool(Option.CalendarExpanded, this.calendarExpanded),\n\t\t\t]);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div \n\t\t\tclass=\"booking-sidebar-calendar-container\"\n\t\t\t:class=\"[calendarClass, {\n\t\t\t\t'--expanded': calendarExpanded,\n\t\t\t\t'--counter': isShowCounterFloating,\n\t\t\t}].flat(1)\"\n\t\t>\n\t\t\t<div class=\"booking-booking-sidebar-calendar\">\n\t\t\t\t<div class=\"booking-booking-sidebar-calendar-header\">\n\t\t\t\t\t<div class=\"booking-sidebar-button\" @click=\"onPreviousClick\">\n\t\t\t\t\t\t<div class=\"ui-icon-set --chevron-left\"></div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"booking-booking-sidebar-calendar-title\">\n\t\t\t\t\t\t{{ formattedDate }}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"booking-sidebar-button --right\" @click=\"onNextClick\">\n\t\t\t\t\t\t<div class=\"ui-icon-set --chevron-right\"></div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"booking-sidebar-button\" @click=\"collapseToggle\">\n\t\t\t\t\t\t<Icon :name=\"calendarExpanded ? IconSet.COLLAPSE : IconSet.EXPAND_1\"/>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"booking-booking-sidebar-calendar-date-picker\" ref=\"datePicker\"></div>\n\t\t\t</div>\n\t\t\t<CounterFloating\n\t\t\t\tv-if=\"isShowCounterFloating\"\n\t\t\t\t:count=\"datesCount.count\"\n\t\t\t/>\n\t\t</div>\n\t`,\n};\n","import { HelpDesk } from 'booking.const';\n\nimport './wait-list-layout.css';\n\n// @vue/component\nexport const WaitListLayout = {\n\tname: 'WaitListLayout',\n\tprops: {\n\t\twaitListItemsCount: {\n\t\t\ttype: Number,\n\t\t\tdefault: 0,\n\t\t},\n\t\twaitListClass: {\n\t\t\ttype: [String, Object, Array],\n\t\t\tdefault: '',\n\t\t},\n\t\tshowEmptyState: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t\tdragging: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t\texpanded: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t},\n\temits: ['mouseUp'],\n\tmethods: {\n\t\tshowHelpDesk(): void\n\t\t{\n\t\t\tif (!top.BX.Helper)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst anchor = HelpDesk.WaitListDescription.anchorCode || null;\n\t\t\tconst params = {\n\t\t\t\tredirect: 'detail',\n\t\t\t\tcode: HelpDesk.WaitListDescription.code,\n\t\t\t\t...(anchor !== null && { anchor }),\n\t\t\t};\n\n\t\t\tconst queryString = Object.entries(params)\n\t\t\t\t.map(([key, value]) => `${key}=${value}`)\n\t\t\t\t.join('&');\n\n\t\t\ttop.BX.Helper.show(queryString);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div\n\t\t\tclass=\"booking-wait-list\"\n\t\t\t:class=\"waitListClass\"\n\t\t\t@mouseup.capture=\"$emit('mouseUp', $event)\"\n\t\t>\n\t\t\t<div class=\"booking-wait-list-header\">\n\t\t\t\t<div class=\"booking-wait-list-title\">{{ loc('BOOKING_BOOKING_WAIT_LIST') }}</div>\n\t\t\t\t<div v-if=\"waitListItemsCount > 0\" class=\"booking--wait-list-title-count\">{{ waitListItemsCount }}</div>\n\t\t\t\t<div class=\"booking-wait-list-buttons\">\n\t\t\t\t\t<slot name=\"header\" />\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div\n\t\t\t\tv-if=\"expanded\"\n\t\t\t\tclass=\"booking--wait-list-content\"\n\t\t\t>\n\t\t\t\t<div v-if=\"showEmptyState\" class=\"booking-wait-list-empty\">\n\t\t\t\t\t<div class=\"booking-wait-list-empty-icon\"></div>\n\t\t\t\t\t<div class=\"booking-wait-list-empty-title\">{{ loc('BOOKING_BOOKING_WAIT_LIST') }}</div>\n\t\t\t\t\t<div class=\"booking-wait-list-empty-subtitle\">{{ loc('BOOKING_BOOKING_WAIT_LIST_DESCRIPTION') }}</div>\n\t\t\t\t\t<div\n\t\t\t\t\t\tclass=\"booking-wait-list-empty-help\"\n\t\t\t\t\t\t@click=\"showHelpDesk\"\n\t\t\t\t\t>\n\t\t\t\t\t\t{{ loc('BOOKING_BOOKING_WAIT_LIST_HOW') }}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div v-if=\"dragging\" class=\"booking-wait-list-drag-area\">\n\t\t\t\t\t{{ loc('BOOKING_BOOKING_WAIT_LIST_DRAG_AREA') }}\n\t\t\t\t</div>\n\t\t\t\t<template v-else>\n\t\t\t\t\t<slot name=\"waitlist\" />\n\t\t\t\t</template>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import { Loc } from 'main.core';\nimport { MessageBox, MessageBoxButtons } from 'ui.dialogs.messagebox';\n\nimport { waitListService } from 'booking.provider.service.wait-list-service';\n\nexport const useDeleteWaitListGroup = () => {\n\tconst confirmDelete = async (): Promise<boolean> => {\n\t\treturn new Promise((resolve): boolean => {\n\t\t\tconst messageBox = MessageBox.create({\n\t\t\t\tmessage: Loc.getMessage('BOOKING_BOOKING_WAIT_LIST_GROUP_CONFIRM_DELETE'),\n\t\t\t\tyesCaption: Loc.getMessage('BOOKING_BOOKING_WAIT_LIST_GROUP_CONFIRM_DELETE_YES'),\n\t\t\t\tmodal: true,\n\t\t\t\tbuttons: MessageBoxButtons.YES_CANCEL,\n\t\t\t\tonYes: () => {\n\t\t\t\t\tmessageBox.close();\n\t\t\t\t\tresolve(true);\n\t\t\t\t},\n\t\t\t\tonCancel: () => {\n\t\t\t\t\tmessageBox.close();\n\t\t\t\t\tresolve(false);\n\t\t\t\t},\n\t\t\t});\n\n\t\t\tmessageBox.show();\n\t\t});\n\t};\n\n\tconst deleteWaitListGroup = async (waitListItemsIds: number[]): Promise<void> => {\n\t\t// eslint-disable-next-line @bitrix24/bitrix24-rules/no-native-dialogs\n\t\tif (await confirmDelete())\n\t\t{\n\t\t\tawait waitListService.deleteList(waitListItemsIds);\n\t\t}\n\t};\n\n\treturn {\n\t\tdeleteWaitListGroup,\n\t};\n};\n","// @vue/component\n\nimport { Event, Text } from 'main.core';\nimport { MenuManager, Menu } from 'main.popup';\n\nimport { useDeleteWaitListGroup } from './composables/use-delete-wait-list-group';\n\nexport const WaitListGroupMenu = {\n\tname: 'WaitListGroupMenu',\n\tprops: {\n\t\twaitListGroup: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tsetup(): { menuPopup: Menu | null, deleteWaitListGroup: (number[]) => Promise<void> }\n\t{\n\t\tconst menuPopup = null;\n\t\tconst { deleteWaitListGroup } = useDeleteWaitListGroup();\n\n\t\treturn {\n\t\t\tmenuPopup,\n\t\t\tdeleteWaitListGroup,\n\t\t};\n\t},\n\tcomputed: {\n\t\tpopupId(): string\n\t\t{\n\t\t\treturn `wait-list-group-menu-${Text.getRandom(4)}`;\n\t\t},\n\t},\n\tunmounted(): void\n\t{\n\t\tif (this.menuPopup)\n\t\t{\n\t\t\tthis.destroy();\n\t\t}\n\t},\n\tmethods: {\n\t\topenMenu(): void\n\t\t{\n\t\t\tif (this.menuPopup?.popupWindow?.isShown())\n\t\t\t{\n\t\t\t\tthis.destroy();\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst menuButton = this.$refs['menu-button'];\n\t\t\tthis.menuPopup = MenuManager.create(\n\t\t\t\tthis.popupId,\n\t\t\t\tmenuButton,\n\t\t\t\tthis.getMenuItems(),\n\t\t\t\t{\n\t\t\t\t\tclassName: 'booking--wait-list--wait-list-group-menu-popup',\n\t\t\t\t\tcloseByEsc: true,\n\t\t\t\t\tautoHide: true,\n\t\t\t\t\toffsetTop: -3,\n\t\t\t\t\toffsetLeft: menuButton.offsetWidth - 6,\n\t\t\t\t\tangle: true,\n\t\t\t\t\tcacheable: true,\n\t\t\t\t\tevents: {\n\t\t\t\t\t\tonDestroy: () => this.unbindScrollEvent(),\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t);\n\t\t\tthis.menuPopup.show();\n\t\t\tthis.bindScrollEvent();\n\t\t},\n\t\tgetMenuItems(): Array<Object>\n\t\t{\n\t\t\treturn [\n\t\t\t\t{\n\t\t\t\t\thtml: `<span>${this.loc('BOOKING_BOOKING_WAIT_LIST_GROUP_DELETE')}</span>`,\n\t\t\t\t\tonclick: async () => {\n\t\t\t\t\t\tthis.destroy();\n\t\t\t\t\t\tawait this.deleteWaitListGroup(\n\t\t\t\t\t\t\tthis.waitListGroup.items.map(({ id }) => id),\n\t\t\t\t\t\t);\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t];\n\t\t},\n\t\t// async deleteWaitListGroup(): Promise<void>\n\t\t// {\n\t\t// \tconst waitListItemsIds = this.waitListGroup.items.map(({ id }) => id);\n\t\t// \tawait waitListService.deleteList(waitListItemsIds);\n\t\t// },\n\t\tdestroy(): void\n\t\t{\n\t\t\tMenuManager.destroy(this.popupId);\n\t\t\tthis.unbindScrollEvent();\n\t\t},\n\t\tbindScrollEvent(): void\n\t\t{\n\t\t\tEvent.bind(document, 'scroll', this.adjustPosition, { capture: true });\n\t\t},\n\t\tunbindScrollEvent(): void\n\t\t{\n\t\t\tEvent.unbind(document, 'scroll', this.adjustPosition, { capture: true });\n\t\t},\n\t\tadjustPosition(): void\n\t\t{\n\t\t\tthis.menuPopup?.popupWindow?.adjustPosition();\n\t\t},\n\t},\n\ttemplate: `\n\t\t<button ref=\"menu-button\" class=\"ui-icon-set --more\" @click=\"openMenu\"></button>\n\t`,\n};\n","// @vue/component\n\nimport { mapGetters } from 'ui.vue3.vuex';\nimport { BIcon as Icon, Set as IconSet } from 'ui.icon-set.api.vue';\n\nimport { Model } from 'booking.const';\nimport { Duration } from 'booking.lib.duration';\n\nimport { WaitListGroupMenu } from './wait-list-group-menu/wait-list-group-menu';\nimport type { WaitListItemModel, WaitListGroup } from './types';\nimport './wait-list-groups.css';\n\nexport const WaitListGroups = {\n\tname: 'WaitListGroups',\n\tcomponents: {\n\t\tIcon,\n\t\tWaitListGroupMenu,\n\t},\n\tsetup(): { dragManager: ?DragManager, IconSet: Object }\n\t{\n\t\tconst dragManager = null;\n\n\t\treturn {\n\t\t\tdragManager,\n\t\t\tIconSet,\n\t\t};\n\t},\n\tcomputed: {\n\t\t...mapGetters({\n\t\t\teditingWaitListItemId: `${Model.Interface}/editingWaitListItemId`,\n\t\t\tisFeatureEnabled: `${Model.Interface}/isFeatureEnabled`,\n\t\t\tanimationPause: `${Model.Interface}/animationPause`,\n\t\t\twaitListItems: `${Model.WaitList}/get`,\n\t\t}),\n\t\twaitListGroups(): WaitListGroup[]\n\t\t{\n\t\t\tconst groups: { title: string, items: WaitListItemModel[]}[] = [\n\t\t\t\t{\n\t\t\t\t\ttitle: this.loc('BOOKING_BOOKING_WAIT_LIST_ADDED_TODAY'),\n\t\t\t\t\titems: [],\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\ttitle: this.loc('BOOKING_BOOKING_WAIT_LIST_ADDED_THIS_WEEK'),\n\t\t\t\t\titems: [],\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\ttitle: this.loc('BOOKING_BOOKING_WAIT_LIST_ADDED_THIS_MONTH'),\n\t\t\t\t\titems: [],\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\ttitle: this.loc('BOOKING_BOOKING_WAIT_LIST_ADDED_OVER_MONTH'),\n\t\t\t\t\titems: [],\n\t\t\t\t},\n\t\t\t];\n\n\t\t\tconst today = new Date().setHours(0, 0, 0, 0);\n\t\t\tconst { d: dayDuration, w: weekDuration, m: monthDuration } = Duration.getUnitDurations();\n\n\t\t\t[...this.waitListItems]\n\t\t\t\t.sort((a, b) => b.createdAt - a.createdAt)\n\t\t\t\t.forEach((waitListItem) => {\n\t\t\t\t\tconst duration = today - new Date(waitListItem.createdAt).setHours(0, 0, 0, 0);\n\n\t\t\t\t\tif (duration < dayDuration)\n\t\t\t\t\t{\n\t\t\t\t\t\tgroups[0].items.push(waitListItem);\n\t\t\t\t\t}\n\t\t\t\t\telse if (duration < weekDuration)\n\t\t\t\t\t{\n\t\t\t\t\t\tgroups[1].items.push(waitListItem);\n\t\t\t\t\t}\n\t\t\t\t\telse if (duration < monthDuration)\n\t\t\t\t\t{\n\t\t\t\t\t\tgroups[2].items.push(waitListItem);\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tgroups[3].items.push(waitListItem);\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\treturn groups.filter(({ items }) => items.length > 0);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"booking-wait-list-groups\">\n\t\t\t<div v-for=\"group of waitListGroups\" :key=\"group.title\" class=\"booking-wait-list-group\">\n\t\t\t\t<div class=\"booking-wait-list-group-header\">\n\t\t\t\t\t<div class=\"booking-wait-list-group-title\">{{ group.title }}</div>\n\t\t\t\t\t<div class=\"booking-sidebar-button\">\n\t\t\t\t\t\t<WaitListGroupMenu :waitListGroup=\"group\"/>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<TransitionGroup :name=\"animationPause ? 'none' : 'wait-list'\" tag=\"div\">\n\t\t\t\t\t<template v-for=\"item of group.items\" :key=\"item.id\">\n\t\t\t\t\t\t<slot name=\"item\" :item=\"item\"/>\n\t\t\t\t\t</template>\n\t\t\t\t</TransitionGroup>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import { Model } from 'booking.const';\nimport { Name } from 'booking.component.booking';\nimport type { ClientData, ClientModel } from 'booking.model.clients';\nimport type { WaitListItemModel } from 'booking.model.wait-list';\n\n// @vue/component\nexport const WaitListItemName = {\n\tname: 'WaitListItemName',\n\tcomponents: {\n\t\tName,\n\t},\n\tprops: {\n\t\t/**\n\t\t * @type {WaitListItemModel}\n\t\t */\n\t\twaitListItem: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tcomputed: {\n\t\tclient(): ClientModel\n\t\t{\n\t\t\tconst clientData: ClientData = this.waitListItem.clients?.[0] || null;\n\n\t\t\treturn clientData ? this.$store.getters[`${Model.Clients}/getByClientData`](clientData) : null;\n\t\t},\n\t\titemName(): string\n\t\t{\n\t\t\treturn this.client?.name || this.waitListItem.name || this.loc('BOOKING_BOOKING_DEFAULT_BOOKING_NAME');\n\t\t},\n\t},\n\ttemplate: `\n\t\t<Name\n\t\t\t:name=\"itemName\"\n\t\t\t:dataAttributes=\"{\n\t\t\t\t'data-element': 'wait-list-item-name',\n\t\t\t\t'data-id': waitListItem.id,\n\t\t\t}\"\n\t\t/>\n\t`,\n};\n","import { Note } from 'booking.component.booking';\nimport { waitListService } from 'booking.provider.service.wait-list-service';\nimport type { NotePopupSavePayload } from 'booking.component.booking';\nimport type { WaitListItemModel } from 'booking.model.wait-list';\n\nimport './note.css';\n\n// @vue/component\nexport const WaitListItemNote = {\n\tname: 'WaitListItemNote',\n\tcomponents: {\n\t\tNote,\n\t},\n\tprops: {\n\t\t/**\n\t\t * @type {WaitListItemModel}\n\t\t */\n\t\twaitListItem: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t\tbindElement: {\n\t\t\ttype: Function,\n\t\t\trequired: true,\n\t\t},\n\t\tvisiblePopup: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t},\n\twatch: {\n\t\tvisiblePopup(visible: boolean): void\n\t\t{\n\t\t\tif (visible)\n\t\t\t{\n\t\t\t\tthis.$refs.note?.showViewPopup();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.$refs.note?.closeViewPopup();\n\t\t\t}\n\t\t},\n\t},\n\tmethods: {\n\t\tasync saveWaitListItemNote({ note }: NotePopupSavePayload): Promise<void>\n\t\t{\n\t\t\tconst id = this.waitListItem.id;\n\t\t\tawait waitListService.update({\n\t\t\t\tid,\n\t\t\t\tnote,\n\t\t\t});\n\t\t},\n\t},\n\ttemplate: `\n\t\t<Note\n\t\t\tref=\"note\"\n\t\t\t:id=\"waitListItem.id\"\n\t\t\t:note=\"waitListItem.note\"\n\t\t\t:bindElement\n\t\t\tclassName=\"booking--wait-list-item-note\"\n\t\t\t:dataId=\"waitListItem.id\"\n\t\t\tdataElementPrefix=\"wait-list-item\"\n\t\t\t:dataAttributes=\"{\n\t\t\t\t'data-id': waitListItem.id,\n\t\t\t\t'data-element': 'booking-wait-list-item-note-button',\n\t\t\t}\"\n\t\t\t@save=\"saveWaitListItemNote\"\n\t\t/>\n\t`,\n};\n","import { CrmEntity } from 'booking.const';\nimport { Profit } from 'booking.component.booking';\nimport type { DealData } from 'booking.model.bookings';\nimport type { WaitListItemModel } from 'booking.model.wait-list';\n\n// @vue/component\nexport const WaitListItemProfit = {\n\tname: 'WaitListItemProfit',\n\tcomponents: {\n\t\tProfit,\n\t},\n\tprops: {\n\t\t/**\n\t\t * @type {WaitListItemModel}\n\t\t */\n\t\twaitListItem: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tcomputed: {\n\t\tdeal(): DealData | null\n\t\t{\n\t\t\treturn this.waitListItem.externalData?.find((data) => data.entityTypeId === CrmEntity.Deal) ?? null;\n\t\t},\n\t},\n\ttemplate: `\n\t\t<Profit\n\t\t\t:deal\n\t\t\t:dataAttributes=\"{\n\t\t\t\t'data-id': waitListItem.id,\n\t\t\t\t'data-element': 'booking-wait-list-item-profit'\n\t\t\t}\"\n\t\t/>\n\t`,\n};\n","import { Client } from 'booking.component.actions-popup';\nimport { Model } from 'booking.const';\nimport { waitListService } from 'booking.provider.service.wait-list-service';\nimport type { WaitListItemModel } from 'booking.model.wait-list';\nimport type {\n\tAddClientsPayload,\n\tUpdateClientsPayload,\n\tUpdateNotePayload,\n} from 'booking.component.actions-popup';\n\n// @vue/component\nexport const WaitListItemClient = {\n\tname: 'WaitListItemClient',\n\tcomponents: {\n\t\tClient,\n\t},\n\tprops: {\n\t\twaitListItemId: {\n\t\t\ttype: Number,\n\t\t\trequired: true,\n\t\t},\n\t},\n\temits: ['freeze', 'unfreeze'],\n\tcomputed: {\n\t\twaitListItem(): WaitListItemModel\n\t\t{\n\t\t\treturn this.$store.getters[`${Model.WaitList}/getById`](this.waitListItemId);\n\t\t},\n\t},\n\tmethods: {\n\t\tasync addClients({ clients }: AddClientsPayload): Promise<void>\n\t\t{\n\t\t\tawait waitListService.update({\n\t\t\t\tid: this.waitListItem.id,\n\t\t\t\tclients,\n\t\t\t});\n\t\t},\n\t\tasync updateClients({ clients }: UpdateClientsPayload): Promise<void>\n\t\t{\n\t\t\tawait waitListService.update({\n\t\t\t\tid: this.waitListItem.id,\n\t\t\t\tclients,\n\t\t\t});\n\t\t},\n\t\tasync updateNote({ note }: UpdateNotePayload): Promise<void>\n\t\t{\n\t\t\tawait waitListService.update({\n\t\t\t\tid: this.waitListItem.id,\n\t\t\t\tnote,\n\t\t\t});\n\t\t},\n\t},\n\ttemplate: `\n\t\t<Client\n\t\t\t:id=\"waitListItemId\"\n\t\t\t:primaryClientData=\"waitListItem.clients?.[0] || null\"\n\t\t\t:clients=\"waitListItem.clients\"\n\t\t\t:note=\"waitListItem.note\"\n\t\t\t:dataId=\"waitListItemId\"\n\t\t\tdataElementPrefix=\"wait-list-item\"\n\t\t\t:dataAttributes=\"{\n\t\t\t\t'data-wait-list-item-id': waitListItemId,\n\t\t\t}\"\n\t\t\t@freeze=\"$emit('freeze')\"\n\t\t\t@unfreeze=\"$emit('unfreeze')\"\n\t\t\t@addClients=\"addClients\"\n\t\t\t@updateClients=\"updateClients\"\n\t\t\t@updateNote=\"updateNote\"\n\t\t/>\n\t`,\n};\n","import { Confirmation } from 'booking.component.actions-popup';\n\n// @vue/component\nexport const WaitListItemConfirmation = {\n\tname: 'WaitListItemConfirmation',\n\tcomponents: {\n\t\tConfirmation,\n\t},\n\tprops: {\n\t\twaitListItemId: {\n\t\t\ttype: Number,\n\t\t\trequired: true,\n\t\t},\n\t},\n\temits: ['freeze', 'unfreeze'],\n\ttemplate: `\n\t\t<Confirmation\n\t\t\t:id=\"waitListItemId\"\n\t\t\t:isConfirmed=\"false\"\n\t\t\t:counters=\"[]\"\n\t\t\tdisabled\n\t\t\t:dataId=\"waitListItemId\"\n\t\t\tdataPre\n\t\t/>\n\t`,\n};\n","import { CrmEntity, Model } from 'booking.const';\nimport { WaitListDealHelper } from 'booking.lib.deal-helper';\nimport { Deal } from 'booking.component.actions-popup';\nimport type { DealData, WaitListItemModel } from 'booking.model.wait-list';\n\ntype WaitListItemDealData = {\n\tdealHelper: WaitListDealHelper;\n}\n\n// @vue/component\nexport const WaitListItemDeal = {\n\tname: 'WaitListItemDeal',\n\tcomponents: {\n\t\tDeal,\n\t},\n\tprops: {\n\t\twaitListItemId: {\n\t\t\ttype: Number,\n\t\t\trequired: true,\n\t\t},\n\t},\n\temits: ['freeze', 'unfreeze'],\n\tsetup(props): WaitListItemDealData\n\t{\n\t\tconst dealHelper = new WaitListDealHelper(props.waitListItemId);\n\n\t\treturn {\n\t\t\tdealHelper,\n\t\t};\n\t},\n\tcomputed: {\n\t\twaitListItem(): WaitListItemModel\n\t\t{\n\t\t\treturn this.$store.getters[`${Model.WaitList}/getById`](this.waitListItemId);\n\t\t},\n\t\tdeal(): DealData | null\n\t\t{\n\t\t\treturn this.waitListItem?.externalData?.find((data) => data.entityTypeId === CrmEntity.Deal) ?? null;\n\t\t},\n\t},\n\ttemplate: `\n\t\t<Deal\n\t\t\t:deal=\"deal\"\n\t\t\t:dealHelper=\"dealHelper\"\n\t\t\t:dataId=\"waitListItemId\"\n\t\t\t:dataAttributes=\"{\n\t\t\t\t'data-wait-list-item-id': waitListItemId,\n\t\t\t}\"\n\t\t\tdataElementPrefix=\"wait-list\"\n\t\t\t@freeze=\"$emit('freeze')\"\n\t\t\t@unfreeze=\"$emit('unfreeze')\"\n\t\t/>\n\t`,\n};\n","import { ref, onMounted } from 'ui.vue3';\nimport type { VueRefValue } from 'ui.vue3';\nimport { Document } from 'booking.component.actions-popup';\n\ntype WaitListItemDocumentData = {\n\tisLoading: VueRefValue<boolean>;\n}\n\n// @vue/component\nexport const WaitListItemDocument = {\n\tname: 'WaitListItemDocument',\n\tcomponents: {\n\t\tDocument,\n\t},\n\tprops: {\n\t\twaitListItemId: {\n\t\t\ttype: Number,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tsetup(): WaitListItemDocumentData\n\t{\n\t\tconst isLoading = ref(true);\n\n\t\tonMounted((): void => {\n\t\t\tisLoading.value = false;\n\t\t});\n\n\t\treturn {\n\t\t\tisLoading,\n\t\t};\n\t},\n\ttemplate: `\n\t\t<Document\n\t\t\t:id=\"waitListItemId\"\n\t\t\t:loading=\"isLoading\"\n\t\t\tdisabled\n\t\t/>\n\t`,\n};\n","import { Message } from 'booking.component.actions-popup';\n\n// @vue/component\nexport const WaitListItemMessage = {\n\tname: 'WaitListItemMessage',\n\tcomponents: {\n\t\tMessage,\n\t},\n\tprops: {\n\t\twaitListItemId: {\n\t\t\ttype: Number,\n\t\t\trequired: true,\n\t\t},\n\t},\n\ttemplate: `\n\t\t<Message\n\t\t\t:id=\"waitListItemId\"\n\t\t\t:clientData=\"null\"\n\t\t\t:loading=\"false\"\n\t\t\tdisabled\n\t\t\t:dataId=\"waitListItemId\"\n\t\t\tdataElementPrefix=\"wait-list\"\n\t\t/>\n\t`,\n};\n","import { RemoveButton } from 'booking.component.actions-popup';\nimport { RemoveWaitListItem } from 'booking.lib.remove-wait-list-item';\n\n// @vue/component\nexport const WaitListItemRemove = {\n\tname: 'WaitListItemRemove',\n\tcomponents: {\n\t\tRemoveButton,\n\t},\n\tprops: {\n\t\twaitListItemId: {\n\t\t\ttype: Number,\n\t\t\trequired: true,\n\t\t},\n\t},\n\temits: ['close'],\n\tmethods: {\n\t\tremove(): void\n\t\t{\n\t\t\tnew RemoveWaitListItem(this.waitListItemId);\n\t\t\tthis.$emit('close');\n\t\t},\n\t},\n\ttemplate: `\n\t\t<RemoveButton\n\t\t\tshowLabel\n\t\t\t:dataAttributes=\"{\n\t\t\t\t'data-id': waitListItemId,\n\t\t\t\t'data-element': 'booking-wait-list-item-menu-remove-button'\n\t\t\t}\"\n\t\t\t@remove=\"remove\"\n\t\t/>\n\t`,\n};\n","import { Model } from 'booking.const';\nimport { Visit } from 'booking.component.actions-popup';\nimport type { WaitListItemModel } from 'booking.model.wait-list';\n\n// @vue/component\nexport const WaitListItemVisit = {\n\tname: 'WaitListItemVisit',\n\tcomponents: {\n\t\tVisit,\n\t},\n\tprops: {\n\t\twaitListItemId: {\n\t\t\ttype: Number,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tcomputed: {\n\t\twaitListItem(): WaitListItemModel\n\t\t{\n\t\t\treturn this.$store.getters[`${Model.WaitList}/getById`](this.waitListItemId);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<Visit\n\t\t\t:id=\"waitListItem.id\"\n\t\t\t:hasClients=\"waitListItem.clients.length > 0\"\n\t\t\tvisitStatus=\"0\"\n\t\t\tdisabled\n\t\t\t:dataId=\"waitListItem.id\"\n\t\t\tdataElementPrefix=\"wait-list\"\n\t\t/>\n\t`,\n};\n","import { ActionsPopup, FullForm, Info } from 'booking.component.actions-popup';\nimport type { PopupMakerItem, PopupOptions } from 'booking.component.actions-popup';\nimport type { WaitListItemModel } from 'booking.model.wait-list';\n\nimport { WaitListItemClient } from './components/client';\nimport { WaitListItemConfirmation } from './components/confirmation';\nimport { WaitListItemDeal } from './components/deal';\nimport { WaitListItemDocument } from './components/document';\nimport { WaitListItemMessage } from './components/message';\nimport { WaitListItemRemove } from './components/remove';\nimport { WaitListItemVisit } from './components/visit';\n\nconst ActionsPopupActionEnum = Object.freeze({\n\tclient: 'client',\n\tconfirmation: 'confirmation',\n\tdeal: 'deal',\n\tdocument: 'document',\n\tfullForm: 'fullForm',\n\tmessage: 'message',\n\tvisit: 'visit',\n\toverbooking: 'overbooking',\n\tremove: 'remove',\n\twaitList: 'waitList',\n});\n\n// @vue/component\nexport const WaitListItemActionsPopup = {\n\tname: 'WaitListItemActionsPopup',\n\tcomponents: {\n\t\tActionsPopup,\n\t\tFullForm,\n\t\tWaitListItemClient,\n\t\tWaitListItemConfirmation,\n\t\tWaitListItemDeal,\n\t\tWaitListItemDocument,\n\t\tWaitListItemMessage,\n\t\tWaitListItemRemove,\n\t\tWaitListItemVisit,\n\t},\n\tprops: {\n\t\t/**\n\t\t * @type {WaitListItemModel}\n\t\t */\n\t\twaitListItem: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t\tbindElement: {\n\t\t\ttype: HTMLElement,\n\t\t\trequired: true,\n\t\t},\n\t},\n\temits: ['close'],\n\tcomputed: {\n\t\tconfig(): PopupOptions\n\t\t{\n\t\t\treturn {\n\t\t\t\toffsetTop: -100,\n\t\t\t\toffsetLeft: -500,\n\t\t\t\tclassName: 'booking--wait-list--wait-list-item--sticky-popup',\n\t\t\t};\n\t\t},\n\t\tcontentStructure(): Array<PopupMakerItem | Array<PopupMakerItem>>\n\t\t{\n\t\t\tconst waitListItemId = this.waitListItem.id;\n\n\t\t\treturn [\n\t\t\t\t{\n\t\t\t\t\tid: ActionsPopupActionEnum.client,\n\t\t\t\t\tprops: {\n\t\t\t\t\t\twaitListItemId,\n\t\t\t\t\t},\n\t\t\t\t\tcomponent: WaitListItemClient,\n\t\t\t\t},\n\t\t\t\t[\n\t\t\t\t\t{\n\t\t\t\t\t\tid: ActionsPopupActionEnum.deal,\n\t\t\t\t\t\tprops: {\n\t\t\t\t\t\t\twaitListItemId,\n\t\t\t\t\t\t},\n\t\t\t\t\t\tcomponent: WaitListItemDeal,\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tid: ActionsPopupActionEnum.document,\n\t\t\t\t\t\tprops: {\n\t\t\t\t\t\t\twaitListItemId,\n\t\t\t\t\t\t},\n\t\t\t\t\t\tcomponent: WaitListItemDocument,\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t\t[\n\t\t\t\t\t{\n\t\t\t\t\t\tid: ActionsPopupActionEnum.fullForm,\n\t\t\t\t\t\tprops: {\n\t\t\t\t\t\t\twaitListItemId,\n\t\t\t\t\t\t},\n\t\t\t\t\t\tcomponent: FullForm,\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tid: ActionsPopupActionEnum.info,\n\t\t\t\t\t\tclass: '--shrink',\n\t\t\t\t\t\tprops: {\n\t\t\t\t\t\t\twaitListItemId,\n\t\t\t\t\t\t},\n\t\t\t\t\t\tcomponent: Info,\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t];\n\t\t},\n\t},\n\t// language=Vue\n\ttemplate: `\n\t\t<ActionsPopup\n\t\t\t:popupId=\"waitListItem.id\"\n\t\t\t:bindElement=\"bindElement\"\n\t\t\t:contentStructure=\"contentStructure\"\n\t\t\t:popupOptions=\"config\"\n\t\t\t@close=\"$emit('close')\"\n\t\t>\n\t\t\t<template #footer>\n\t\t\t\t<WaitListItemRemove\n\t\t\t\t\t:waitListItemId=\"waitListItem.id\"\n\t\t\t\t\t@close=\"$emit('close')\"\n\t\t\t\t/>\n\t\t\t</template>\n\t\t</ActionsPopup>\n\t`,\n};\n","import { mapGetters } from 'ui.vue3.vuex';\n\nimport { Model } from 'booking.const';\n// eslint-disable-next-line no-unused-vars\nimport type { WaitListItemModel } from 'booking.model.wait-list';\n\nimport { WaitListItemActionsPopup } from './actions-popup/actions-popup';\nimport './actions.css';\n\n// @vue/component\nexport const WaitListItemActions = {\n\tname: 'WaitListItemActions',\n\tcomponents: {\n\t\tWaitListItemActionsPopup,\n\t},\n\tprops: {\n\t\t/**\n\t\t * @type {WaitListItemModel}\n\t\t */\n\t\twaitListItem: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tdata(): { showPopup: boolean }\n\t{\n\t\treturn {\n\t\t\tshowPopup: false,\n\t\t};\n\t},\n\tcomputed: {\n\t\t...mapGetters({\n\t\t\teditingWaitListItemId: `${Model.Interface}/editingWaitListItemId`,\n\t\t\tisEditingBookingMode: `${Model.Interface}/isEditingBookingMode`,\n\t\t}),\n\t},\n\tmounted(): void\n\t{\n\t\tif (this.isEditingBookingMode && this.editingWaitListItemId === this.waitListItem.id)\n\t\t{\n\t\t\tthis.showPopup = true;\n\t\t}\n\t},\n\tmethods: {\n\t\tclickHandler(): void\n\t\t{\n\t\t\tthis.showPopup = !this.showPopup;\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div\n\t\t\tref=\"node\"\n\t\t\tclass=\"booking-booking-booking-actions booking--wait-list-item-actions\"\n\t\t\tdata-element=\"booking-wait-list-item-actions-button\"\n\t\t\t:data-id=\"waitListItem.id\"\n\t\t\t@click=\"clickHandler\"\n\t\t>\n\t\t\t<div class=\"booking-booking-booking-actions-inner\">\n\t\t\t\t<div class=\"ui-icon-set --chevron-down\"></div>\n\t\t\t</div>\n\t\t</div>\n\t\t<WaitListItemActionsPopup\n\t\t\tv-if=\"showPopup\"\n\t\t\t:waitListItem\n\t\t\t:bindElement=\"this.$refs.node\"\n\t\t\t@close=\"showPopup = false\"\n\t\t/>\n\t`,\n};\n","import { AddClient } from 'booking.component.booking';\nimport { waitListService } from 'booking.provider.service.wait-list-service';\nimport type { ClientData } from 'booking.model.clients';\n// eslint-disable-next-line no-unused-vars\nimport type { WaitListItemModel } from 'booking.model.wait-list';\n\nimport './add-client.css';\n\n// @vue/component\nexport const WaitListItemAddClient = {\n\tname: 'WaitListItemAddClient',\n\tcomponents: {\n\t\tAddClient,\n\t},\n\tprops: {\n\t\t/**\n\t\t * @type {WaitListItemModel}\n\t\t */\n\t\twaitListItem: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tmethods: {\n\t\tasync addClient(clients: ClientData[]): Promise<void>\n\t\t{\n\t\t\tconst id = this.waitListItem.id;\n\t\t\tawait waitListService.update({\n\t\t\t\tid,\n\t\t\t\tclients,\n\t\t\t});\n\t\t},\n\t},\n\ttemplate: `\n\t\t<AddClient\n\t\t\t:dataAttributes=\"{\n\t\t\t\t'data-id': waitListItem.id,\n\t\t\t\t'data-element': 'booking-wait-list-item-add-client-button',\n\t\t\t}\"\n\t\t\t:popupOffsetLeft=\"-300\"\n\t\t\t@add=\"addClient\"\n\t\t/>\n\t`,\n};\n","import { CrmButton } from 'booking.component.booking';\nimport { WaitListDealHelper } from 'booking.lib.deal-helper';\nimport type { WaitListItemModel } from 'booking.model.wait-list';\n\n// @vue/component\nexport const WaitListItemCrmButton = {\n\tname: 'WaitListItemCrmButton',\n\tcomponents: {\n\t\tCrmButton,\n\t},\n\tprops: {\n\t\t/**\n\t\t * @type {WaitListItemModel}\n\t\t */\n\t\twaitListItem: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tsetup(props): { dealHelper: WaitListDealHelper }\n\t{\n\t\tconst dealHelper = new WaitListDealHelper(props.waitListItem.id);\n\n\t\treturn {\n\t\t\tdealHelper,\n\t\t};\n\t},\n\ttemplate: `\n\t\t<CrmButton\n\t\t\t:dealHelper\n\t\t\t:dataAttributes=\"{\n\t\t\t\t'data-wait-list-item-id': waitListItem.id,\n\t\t\t\t'data-element': 'wait-list-item-crm-button'\n\t\t\t}\"\n\t\t/>\n\t`,\n};\n","import { mapGetters } from 'ui.vue3.vuex';\n\nimport {\n\tBookingBase,\n\tCommunication,\n\tDisabledPopup,\n} from 'booking.component.booking';\nimport { Model, DraggedElementKind } from 'booking.const';\n// eslint-disable-next-line no-unused-vars\nimport type { WaitListItemModel } from 'booking.model.wait-list';\n\nimport { WaitListItemName } from './name/name';\nimport { WaitListItemNote } from './note/note';\nimport { WaitListItemProfit } from './profit/profit';\nimport { WaitListItemActions } from './actions/actions';\nimport { WaitListItemAddClient } from './add-client/add-client';\nimport { WaitListItemCrmButton } from './crm-button/crm-button';\n\nimport './wait-list-item.css';\n\n// @vue/component\nexport const WaitListItem = {\n\tname: 'WaitListItem',\n\tcomponents: {\n\t\tBookingBase,\n\t\tCommunication,\n\t\tDisabledPopup,\n\t\tWaitListItemName,\n\t\tWaitListItemNote,\n\t\tWaitListItemProfit,\n\t\tWaitListItemActions,\n\t\tWaitListItemAddClient,\n\t\tWaitListItemCrmButton,\n\t},\n\tprops: {\n\t\t/**\n\t\t * @type {WaitListItemModel}\n\t\t */\n\t\titem: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tdata(): { isDisabledPopupShown: boolean }\n\t{\n\t\treturn {\n\t\t\tisDisabledPopupShown: false,\n\t\t\tvisibleNotePopup: false,\n\t\t};\n\t},\n\tcomputed: {\n\t\t...mapGetters({\n\t\t\teditingWaitListItemId: `${Model.Interface}/editingWaitListItemId`,\n\t\t\tisEditingBookingMode: `${Model.Interface}/isEditingBookingMode`,\n\t\t\tisWaitListItemCreatedFromEmbed: `${Model.Interface}/isWaitListItemCreatedFromEmbed`,\n\t\t\tanimationPause: `${Model.Interface}/animationPause`,\n\t\t}),\n\t\thasClient(): boolean\n\t\t{\n\t\t\treturn this.item.clients.length > 0;\n\t\t},\n\t\tdisabled(): boolean\n\t\t{\n\t\t\treturn this.isEditingBookingMode && this.editingWaitListItemId !== this.item.id;\n\t\t},\n\t\tdataAttributes(): {[key: string]: string}\n\t\t{\n\t\t\treturn {\n\t\t\t\t'data-id': this.item.id,\n\t\t\t\t'data-kind': DraggedElementKind.WaitListItem,\n\t\t\t\t'data-element': 'booking-wait-list-item',\n\t\t\t};\n\t\t},\n\t\thasAccent(): boolean\n\t\t{\n\t\t\treturn this.editingWaitListItemId === this.item.id || this.isWaitListItemCreatedFromEmbed(this.item.id);\n\t\t},\n\t},\n\tmethods: {\n\t\tonClick(): void\n\t\t{\n\t\t\tif (this.disabled)\n\t\t\t{\n\t\t\t\tthis.isDisabledPopupShown = true;\n\t\t\t}\n\t\t},\n\t\tonNoteMouseEnter(): void\n\t\t{\n\t\t\tthis.showNoteTimeout = setTimeout((): void => {\n\t\t\t\tthis.visibleNotePopup = true;\n\t\t\t}, 100);\n\t\t},\n\t\tonNoteMouseLeave(): void\n\t\t{\n\t\t\tclearTimeout(this.showNoteTimeout);\n\t\t\tthis.visibleNotePopup = false;\n\t\t},\n\t},\n\ttemplate: `\n\t\t<BookingBase\n\t\t\t:disabled\n\t\t\t:bookingClass=\"{\n\t\t\t\t'booking--draggable-item': true,\n\t\t\t\t'booking-wait-list-item': true,\n\t\t\t\t'--disabled': disabled,\n\t\t\t\t'--accent': hasAccent,\n\t\t\t\t'no-transition': animationPause,\n\t\t\t}\"\n\t\t\t:dataAttributes=\"dataAttributes\"\n\t\t\t@click=\"onClick\"\n\t\t>\n\t\t\t<template #upper-content-row>\n\t\t\t\t<div\n\t\t\t\t\tclass=\"booking-booking-booking-name-container\"\n\t\t\t\t\t@mouseenter=\"onNoteMouseEnter\"\n\t\t\t\t\t@mouseleave=\"onNoteMouseLeave\"\n\t\t\t\t>\n\t\t\t\t\t<WaitListItemName :waitListItem=\"item\"/>\n\t\t\t\t\t<WaitListItemNote\n\t\t\t\t\t\t:waitListItem=\"item\"\n\t\t\t\t\t\t:bindElement=\"() => $el\"\n\t\t\t\t\t\t:visiblePopup=\"visibleNotePopup\"\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t\t<WaitListItemProfit :waitListItem=\"item\"/>\n\t\t\t</template>\n\t\t\t<template #lower-content-row>\n\t\t\t\t<div class=\"booking--wait-list-item--space\"></div>\n\t\t\t\t<div v-if=\"hasClient\" class=\"booking--booking-base-buttons\">\n\t\t\t\t\t<Communication/>\n\t\t\t\t\t<WaitListItemCrmButton :waitListItem=\"item\"/>\n\t\t\t\t</div>\n\t\t\t\t<WaitListItemAddClient\n\t\t\t\t\tv-else\n\t\t\t\t\t:waitListItem=\"item\"\n\t\t\t\t/>\n\t\t\t</template>\n\t\t\t<template #end>\n\t\t\t\t<DisabledPopup\n\t\t\t\t\tv-if=\"isDisabledPopupShown\"\n\t\t\t\t\t:popupId=\"'booking-wait-list-item-disabled-popup-' + item.id\"\n\t\t\t\t\t:bindElement=\"() => $el\"\n\t\t\t\t\t@close=\"isDisabledPopupShown = false\"\n\t\t\t\t/>\n\t\t\t</template>\n\t\t\t<template #actions>\n\t\t\t\t<WaitListItemActions :waitListItem=\"item\"/>\n\t\t\t</template>\n\t\t</BookingBase>\n\t`,\n};\n","import { Text } from 'main.core';\nimport { mapGetters } from 'ui.vue3.vuex';\n\nimport { Model } from 'booking.const';\nimport { DealData } from 'booking.model.bookings';\nimport { ClientData } from 'booking.model.clients';\nimport { WaitListAnalytics } from 'booking.lib.analytics';\nimport { Button, ButtonColor, ButtonSize } from 'booking.component.button';\nimport { waitListService } from 'booking.provider.service.wait-list-service';\n\nimport './button-add-wait-list-item.css';\n\n// @vue/component\nexport const ButtonAddWaitListItem = {\n\tname: 'ButtonAddWaitListItem',\n\tcomponents: {\n\t\tButton,\n\t},\n\tsetup(): Object\n\t{\n\t\treturn {\n\t\t\tButtonColor,\n\t\t\tButtonSize,\n\t\t};\n\t},\n\tcomputed: {\n\t\t...mapGetters({\n\t\t\tembedItems: `${Model.Interface}/embedItems`,\n\t\t\tisLoaded: `${Model.Interface}/isLoaded`,\n\t\t\tisEditingBookingMode: `${Model.Interface}/isEditingBookingMode`,\n\t\t\twaitListItems: `${Model.WaitList}/get`,\n\t\t\twaitListExpanded: `${Model.Interface}/waitListExpanded`,\n\t\t}),\n\t\taddButtonText(): string\n\t\t{\n\t\t\treturn this.isLoaded && this.waitListItems.length === 0\n\t\t\t\t? this.loc('BOOKING_BOOKING_WAIT_LIST_ADD').replace('[plus]', '+')\n\t\t\t\t: '+';\n\t\t},\n\t\tdisabled(): boolean\n\t\t{\n\t\t\treturn this.isEditingBookingMode || !this.isLoaded;\n\t\t},\n\t\tclients(): ClientData[]\n\t\t{\n\t\t\tconst clients = this.embedItems.filter((item: DealData) => {\n\t\t\t\treturn item.entityTypeId === 'CONTACT' || item.entityTypeId === 'COMPANY';\n\t\t\t});\n\n\t\t\treturn clients.map((item: DealData) => {\n\t\t\t\treturn {\n\t\t\t\t\tid: item.value,\n\t\t\t\t\ttype: {\n\t\t\t\t\t\tcode: item.entityTypeId,\n\t\t\t\t\t\tmodule: item.moduleId,\n\t\t\t\t\t},\n\t\t\t\t};\n\t\t\t});\n\t\t},\n\t},\n\tmethods: {\n\t\tasync addWaitListItem(): Promise<void>\n\t\t{\n\t\t\tif (this.disabled || !this.isLoaded)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (!this.waitListExpanded)\n\t\t\t{\n\t\t\t\tawait this.expandWaitListWidget();\n\t\t\t}\n\n\t\t\tconst now = Date.now();\n\t\t\tconst id = `tmp-id-${now}-${Text.getRandom(4)}`;\n\t\t\tawait this.addCreatedFromEmbedWaitListItem(id);\n\t\t\tconst result = await waitListService.add({\n\t\t\t\tid,\n\t\t\t\tclients: this.clients,\n\t\t\t\texternalData: this.embedItems,\n\t\t\t\tcreatedAt: now,\n\t\t\t\tupdatedAt: now,\n\t\t\t});\n\n\t\t\tif (result.success && result.waitListItem)\n\t\t\t{\n\t\t\t\tWaitListAnalytics.sendAddBooking();\n\t\t\t\tawait this.addCreatedFromEmbedWaitListItem(result.waitListItem.id);\n\t\t\t}\n\t\t},\n\t\tasync addCreatedFromEmbedWaitListItem(id: number | string): Promise<void>\n\t\t{\n\t\t\tawait this.$store.dispatch(`${Model.Interface}/addCreatedFromEmbedWaitListItem`, id);\n\t\t},\n\t\tasync expandWaitListWidget(): Promise<void>\n\t\t{\n\t\t\tawait this.$store.commit('interface/setWaitListExpanded', true);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<Button\n\t\t\tclass=\"booking-wait-list-add\"\n\t\t\t:text=\"addButtonText\"\n\t\t\t:size=\"ButtonSize.EXTRA_SMALL\"\n\t\t\t:color=\"ButtonColor.SECONDARY_LIGHT\"\n\t\t\t:disabled\n\t\t\t:round=\"true\"\n\t\t\t@click=\"addWaitListItem\"\n\t\t/>\n\t`,\n};\n","import { mapGetters } from 'ui.vue3.vuex';\nimport { BIcon as Icon, Set as IconSet } from 'ui.icon-set.api.vue';\nimport 'ui.icon-set.actions';\n\nimport { Model, Option } from 'booking.const';\nimport { BookingAnalytics } from 'booking.lib.analytics';\nimport { Button, ButtonColor, ButtonSize } from 'booking.component.button';\nimport { waitListService } from 'booking.provider.service.wait-list-service';\nimport { isRealId } from 'booking.lib.is-real-id';\nimport { optionService } from 'booking.provider.service.option-service';\n\nimport { WaitListLayout } from './components/wait-list-layout/wait-list-layout';\nimport { WaitListGroups } from './components/wait-list-groups/wait-list-groups';\nimport { WaitListItem } from './components/wait-list-item/wait-list-item';\nimport { ButtonAddWaitListItem } from './components/button-add-wait-list-item/button-add-wait-list-item';\nimport './wait-list.css';\n\n// @vue/component\nexport const WaitList = {\n\tname: 'WaitList',\n\tcomponents: {\n\t\tButton,\n\t\tIcon,\n\t\tButtonAddWaitListItem,\n\t\tWaitListLayout,\n\t\tWaitListGroups,\n\t\tWaitListItem,\n\t},\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tIconSet,\n\t\t\tButtonColor,\n\t\t\tButtonSize,\n\t\t};\n\t},\n\tcomputed: {\n\t\t...mapGetters({\n\t\t\tgetBookingById: `${Model.Bookings}/getById`,\n\t\t\twaitListItems: `${Model.WaitList}/get`,\n\t\t\twaitListExpanded: `${Model.Interface}/waitListExpanded`,\n\t\t\tdraggedBookingId: `${Model.Interface}/draggedBookingId`,\n\t\t\tdraggedBookingResourceId: `${Model.Interface}/draggedBookingResourceId`,\n\t\t\teditingBookingId: `${Model.Interface}/editingBookingId`,\n\t\t\teditingWaitListItemId: `${Model.Interface}/editingWaitListItemId`,\n\t\t\tisFeatureEnabled: `${Model.Interface}/isFeatureEnabled`,\n\t\t\tisBookingCreatedFromEmbed: `${Model.Interface}/isBookingCreatedFromEmbed`,\n\t\t\tembedItems: `${Model.Interface}/embedItems`,\n\t\t\tgetResourceById: `${Model.Resources}/getById`,\n\t\t}),\n\t\tisEmpty(): boolean\n\t\t{\n\t\t\treturn this.waitListItems.length === 0;\n\t\t},\n\t\tisAvailableToDrop(): boolean\n\t\t{\n\t\t\treturn Boolean((\n\t\t\t\tthis.draggedBookingId\n\t\t\t\t&& !this.getResourceById(this.draggedBookingResourceId)?.isDeleted\n\t\t\t));\n\t\t},\n\t\tshowEmptyState(): boolean\n\t\t{\n\t\t\treturn this.isEmpty && !this.draggedBookingId;\n\t\t},\n\t\tembedEditingMode(): boolean\n\t\t{\n\t\t\treturn (\n\t\t\t\tthis.isFeatureEnabled\n\t\t\t\t&& (\n\t\t\t\t\tthis.editingBookingId > 0\n\t\t\t\t\t|| this.editingWaitListItemId > 0\n\t\t\t\t\t|| (this.embedItems?.length ?? 0) > 0\n\t\t\t\t)\n\t\t\t);\n\t\t},\n\t},\n\twatch: {\n\t\t// wait list can be expanded externally (currently in ButtonAddWaitListItem)\n\t\tasync waitListExpanded(newValue, oldValue): void\n\t\t{\n\t\t\tif (newValue !== oldValue)\n\t\t\t{\n\t\t\t\tawait optionService.setBool(Option.WaitListExpanded, newValue);\n\t\t\t}\n\t\t},\n\t},\n\tmethods: {\n\t\tasync onMouseUp(): Promise<void>\n\t\t{\n\t\t\tif (!this.draggedBookingId)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst bookingId = this.draggedBookingId;\n\t\t\tawait this.$store.dispatch(`${Model.Interface}/addDeletingBooking`, bookingId);\n\n\t\t\tif (isRealId(bookingId))\n\t\t\t{\n\t\t\t\tif (this.editingBookingId === bookingId)\n\t\t\t\t{\n\t\t\t\t\tawait this.setEditingWaitListItemId(bookingId);\n\t\t\t\t}\n\n\t\t\t\tconst booking = this.getBookingById(bookingId);\n\t\t\t\tconst result = await waitListService.createFromBooking(\n\t\t\t\t\tbookingId,\n\t\t\t\t\t{\n\t\t\t\t\t\tid: bookingId,\n\t\t\t\t\t\tclients: booking.clients,\n\t\t\t\t\t\tprimaryClient: booking.primaryClient,\n\t\t\t\t\t\texternalData: booking.externalData,\n\t\t\t\t\t\tcreatedAt: Date.now(),\n\t\t\t\t\t\tupdatedAt: Date.now(),\n\t\t\t\t\t},\n\t\t\t\t);\n\n\t\t\t\tif (result.success && result.waitListItem)\n\t\t\t\t{\n\t\t\t\t\tBookingAnalytics.sendAddWaitListItem();\n\t\t\t\t\tif (this.editingWaitListItemId === bookingId)\n\t\t\t\t\t{\n\t\t\t\t\t\tawait this.setEditingWaitListItemId(result.waitListItem.id);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tif (this.isBookingCreatedFromEmbed(bookingId))\n\t\t\t\t{\n\t\t\t\t\tawait this.addCreatedFromEmbedWaitListItem(bookingId);\n\t\t\t\t}\n\n\t\t\t\tconst result = await waitListService.add({\n\t\t\t\t\tid: bookingId,\n\t\t\t\t\tclients: [],\n\t\t\t\t\tcreatedAt: Date.now(),\n\t\t\t\t\tupdatedAt: Date.now(),\n\t\t\t\t});\n\n\t\t\t\tif (result.success && result.waitListItem)\n\t\t\t\t{\n\t\t\t\t\tawait this.addCreatedFromEmbedWaitListItem(result.waitListItem.id);\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\tasync addCreatedFromEmbedWaitListItem(id: number | string): Promise<void>\n\t\t{\n\t\t\tawait this.$store.dispatch(`${Model.Interface}/addCreatedFromEmbedWaitListItem`, id);\n\t\t},\n\t\tasync setEditingWaitListItemId(id: number | string): Promise<void>\n\t\t{\n\t\t\tawait Promise.all([\n\t\t\t\tthis.$store.dispatch(`${Model.Interface}/setEditingWaitListItemId`, id),\n\t\t\t\tthis.$store.dispatch(`${Model.Interface}/setEditingBookingId`, null),\n\t\t\t]);\n\t\t},\n\t\tasync collapseToggle(): Promise<void>\n\t\t{\n\t\t\tawait this.$store.dispatch(`${Model.Interface}/setWaitListExpanded`, !this.waitListExpanded);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<WaitListLayout\n\t\t\t:dragging=\"isAvailableToDrop\"\n\t\t\t:showEmptyState\n\t\t\t:expanded=\"waitListExpanded\"\n\t\t\t:waitListItemsCount=\"waitListItems.length\"\n\t\t\t:waitListClass=\"{\n\t\t\t\t'--expand': waitListExpanded,\n\t\t\t\t'embed-editing-mode': embedEditingMode,\n\t\t\t}\"\n\t\t\t@mouseUp=\"onMouseUp\"\n\t\t>\n\t\t\t<template #header>\n\t\t\t\t<ButtonAddWaitListItem/>\n\t\t\t\t<div class=\"booking-sidebar-button\" @click=\"collapseToggle\">\n\t\t\t\t\t<Icon :name=\"waitListExpanded ? IconSet.COLLAPSE : IconSet.EXPAND_1\"/>\n\t\t\t\t</div>\n\t\t\t</template>\n\t\t\t<template #waitlist>\n\t\t\t\t<WaitListGroups>\n\t\t\t\t\t<template #item=\"{ item }\">\n\t\t\t\t\t\t<WaitListItem :item/>\n\t\t\t\t\t</template>\n\t\t\t\t</WaitListGroups>\n\t\t\t</template>\n\t\t</WaitListLayout>\n\t`,\n};\n","import { Calendar } from './calendar/calendar';\nimport { WaitList } from './wait-list/wait-list';\nimport './sidebar.css';\n\nexport const Sidebar = {\n\tcomponents: {\n\t\tCalendar,\n\t\tWaitList,\n\t},\n\ttemplate: `\n\t\t<div class=\"booking-booking-sidebar\">\n\t\t\t<Calendar/>\n\t\t\t<WaitList/>\n\t\t</div>\n\t`,\n};\n","import { mapGetters } from 'ui.vue3.vuex';\nimport { BIcon as Icon, Set as IconSet } from 'ui.icon-set.api.vue';\nimport 'ui.icon-set.main';\n\nimport { Model, DraggedElementKind } from 'booking.const';\nimport { RemoveBooking } from 'booking.lib.remove-booking';\nimport { RemoveWaitListItem } from 'booking.lib.remove-wait-list-item';\nimport './drag-delete.css';\n\nexport const DragDelete = {\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tIconSet,\n\t\t};\n\t},\n\tcomputed: {\n\t\t...mapGetters({\n\t\t\tdraggedDataTransfer: `${Model.Interface}/draggedDataTransfer`,\n\t\t}),\n\t},\n\tmethods: {\n\t\tonMouseUp(): void\n\t\t{\n\t\t\tif (this.draggedDataTransfer.kind === DraggedElementKind.Booking)\n\t\t\t{\n\t\t\t\tnew RemoveBooking(this.draggedDataTransfer.id);\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (this.draggedDataTransfer.kind === DraggedElementKind.WaitListItem)\n\t\t\t{\n\t\t\t\tnew RemoveWaitListItem(this.draggedDataTransfer.id);\n\t\t\t}\n\t\t},\n\t},\n\tcomponents: {\n\t\tIcon,\n\t},\n\ttemplate: `\n\t\t<div v-if=\"draggedDataTransfer.id > 0\" class=\"booking-booking-drag-delete\">\n\t\t\t<div\n\t\t\t\tclass=\"booking-booking-drag-delete-button\"\n\t\t\t\tdata-element=\"booking-drag-delete\"\n\t\t\t\t@mouseup.capture=\"onMouseUp\"\n\t\t\t>\n\t\t\t\t<Icon :name=\"IconSet.TRASH_BIN\"/>\n\t\t\t\t<div class=\"booking-booking-drag-delete-button-text\">\n\t\t\t\t\t{{ loc('BOOKING_BOOKING_DRAG_DELETE') }}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import { Dom, Event } from 'main.core';\nimport { EventEmitter } from 'main.core.events';\nimport { mapGetters } from 'ui.vue3.vuex';\nimport { Ears } from 'ui.ears';\n\nimport { AhaMoment, DraggedElementKind, Model } from 'booking.const';\nimport { ahaMoments } from 'booking.lib.aha-moments';\nimport { Drag } from 'booking.lib.drag';\nimport { grid } from 'booking.lib.grid';\nimport type { BookingModel } from 'booking.model.bookings';\n\nimport { LeftPanel } from './left-panel/left-panel';\nimport { NowLine } from './now-line/now-line';\nimport { Bookings } from './bookings/bookings';\nimport { Column } from './column/column';\nimport { ScalePanel } from './scale-panel/scale-panel';\nimport { Sidebar } from './sidebar/sidebar';\nimport { DragDelete } from './drag-delete/drag-delete';\nimport './grid.css';\n\ntype GridData = {\n\tscrolledToBooking: boolean,\n};\n\n// @vue/component\nexport const Grid = {\n\tname: 'BookingsGrid',\n\tcomponents: {\n\t\tLeftPanel,\n\t\tNowLine,\n\t\tColumn,\n\t\tBookings,\n\t\tScalePanel,\n\t\tSidebar,\n\t\tDragDelete,\n\t},\n\tdata(): GridData\n\t{\n\t\treturn {\n\t\t\tscrolledToBooking: false,\n\t\t};\n\t},\n\tcomputed: {\n\t\t...mapGetters({\n\t\t\tresourcesIds: `${Model.Interface}/resourcesIds`,\n\t\t\tscroll: `${Model.Interface}/scroll`,\n\t\t\teditingBookingId: `${Model.Interface}/editingBookingId`,\n\t\t\teditingWaitListItemId: `${Model.Interface}/editingWaitListItemId`,\n\t\t\tisFeatureEnabled: `${Model.Interface}/isFeatureEnabled`,\n\t\t\tisLoaded: `${Model.Interface}/isLoaded`,\n\t\t\tselectedDateTs: `${Model.Interface}/selectedDateTs`,\n\t\t\tfilteredBookingsIds: `${Model.Filter}/filteredBookingsIds`,\n\t\t\tisFilterMode: `${Model.Filter}/isFilterMode`,\n\t\t}),\n\t\teditingBooking(): BookingModel | null\n\t\t{\n\t\t\treturn this.$store.getters['bookings/getById'](this.editingBookingId) ?? null;\n\t\t},\n\t},\n\twatch: {\n\t\tscroll(value): void\n\t\t{\n\t\t\tthis.$refs.columnsContainer.scrollLeft = value;\n\t\t},\n\t\teditingBooking(): void\n\t\t{\n\t\t\tthis.scrollToEditingBooking();\n\t\t},\n\t\tisLoaded(isLoaded): void\n\t\t{\n\t\t\tif (isLoaded)\n\t\t\t{\n\t\t\t\tlet dataId = null;\n\t\t\t\tlet dataKind = null;\n\t\t\t\tif (this.editingBookingId)\n\t\t\t\t{\n\t\t\t\t\tdataId = this.editingBookingId;\n\t\t\t\t\tdataKind = DraggedElementKind.Booking;\n\t\t\t\t}\n\n\t\t\t\tif (this.editingWaitListItemId)\n\t\t\t\t{\n\t\t\t\t\tdataId = this.editingWaitListItemId;\n\t\t\t\t\tdataKind = DraggedElementKind.WaitListItem;\n\t\t\t\t}\n\n\t\t\t\tthis.initDragManager(dataId, dataKind);\n\t\t\t}\n\t\t},\n\t\teditingBookingId(id: number | string): void\n\t\t{\n\t\t\tif (id)\n\t\t\t{\n\t\t\t\tthis.initDragManager(id, DraggedElementKind.Booking);\n\t\t\t}\n\t\t},\n\t\teditingWaitListItemId(id: number | string): void\n\t\t{\n\t\t\tif (id)\n\t\t\t{\n\t\t\t\tthis.initDragManager(id, DraggedElementKind.WaitListItem);\n\t\t\t}\n\t\t},\n\t\tfilteredBookingsIds(ids: number[]): void\n\t\t{\n\t\t\tif (!this.isFilterMode || ids.length === 0)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst booking: BookingModel | null = this.$store.getters['bookings/getById'](ids[0]) ?? null;\n\t\t\tif (booking !== null)\n\t\t\t{\n\t\t\t\tthis.scrollToBooking(booking);\n\t\t\t}\n\t\t},\n\t},\n\tmounted(): void\n\t{\n\t\tthis.ears = new Ears({\n\t\t\tcontainer: this.$refs.columnsContainer,\n\t\t\tsmallSize: true,\n\t\t\tclassName: 'booking-booking-grid-columns-ears',\n\t\t}).init();\n\n\t\tEventEmitter.subscribe('BX.Main.Popup:onAfterClose', this.tryShowAhaMoment);\n\t\tEventEmitter.subscribe('BX.Main.Popup:onDestroy', this.tryShowAhaMoment);\n\t},\n\tbeforeUnmount(): void\n\t{\n\t\tthis.dragManager?.destroy();\n\t},\n\tunmounted()\n\t{\n\t\tEventEmitter.unsubscribe('BX.Main.Popup:onAfterClose', this.tryShowAhaMoment);\n\t\tEventEmitter.unsubscribe('BX.Main.Popup:onDestroy', this.tryShowAhaMoment);\n\t},\n\tmethods: {\n\t\tupdateEars(): void\n\t\t{\n\t\t\tthis.ears.toggleEars();\n\n\t\t\tthis.tryShowAhaMoment();\n\t\t},\n\t\tareEarsShown(): boolean\n\t\t{\n\t\t\tconst shownClass = 'ui-ear-show';\n\n\t\t\treturn (\n\t\t\t\tDom.hasClass(this.ears.getRightEar(), shownClass)\n\t\t\t\t|| Dom.hasClass(this.ears.getLeftEar(), shownClass)\n\t\t\t);\n\t\t},\n\t\tscrollToEditingBooking(): void\n\t\t{\n\t\t\tif (!this.editingBooking || this.scrolledToBooking)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.scrollToBooking(this.editingBooking);\n\t\t},\n\t\tscrollToBooking(booking: BookingModel): void\n\t\t{\n\t\t\tconst top = grid.calculateTop(booking.dateFromTs);\n\t\t\tconst height = grid.calculateHeight(booking.dateFromTs, booking.dateToTs);\n\t\t\tthis.$refs.inner.scrollTop = top + height / 2 + this.$refs.inner.offsetHeight / 2;\n\t\t\tthis.scrolledToBooking = true;\n\t\t},\n\t\ttryShowAhaMoment(): void\n\t\t{\n\t\t\tif (this.areEarsShown() && ahaMoments.shouldShow(AhaMoment.ExpandGrid))\n\t\t\t{\n\t\t\t\tEvent.EventEmitter.unsubscribe('BX.Main.Popup:onAfterClose', this.tryShowAhaMoment);\n\t\t\t\tEvent.EventEmitter.unsubscribe('BX.Main.Popup:onDestroy', this.tryShowAhaMoment);\n\t\t\t\tvoid this.$refs.scalePanel.showAhaMoment();\n\t\t\t}\n\t\t},\n\t\tinitDragManager(id: number | string = '', kind: $Values<typeof DraggedElementKind> = null): void\n\t\t{\n\t\t\tif (this.isFeatureEnabled)\n\t\t\t{\n\t\t\t\tconst dataId = id ? `[data-id=\"${id}\"]` : '';\n\t\t\t\tconst dataKind = kind ? `[data-kind=\"${kind}\"]` : '';\n\n\t\t\t\tthis.dragManager = new Drag({\n\t\t\t\t\tcontainer: this.$el.parentElement,\n\t\t\t\t\tdraggable: `.booking--draggable-item${dataId}${dataKind}`,\n\t\t\t\t});\n\t\t\t}\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div ref=\"bookingContainer\" class=\"booking-booking-grid\">\n\t\t\t<div\n\t\t\t\tid=\"booking-booking-grid-wrap\"\n\t\t\t\tclass=\"booking-booking-grid-inner --vertical-scroll-bar\"\n\t\t\t\tref=\"inner\"\n\t\t\t>\n\t\t\t\t<LeftPanel/>\n\t\t\t\t<NowLine/>\n\t\t\t\t<div\n\t\t\t\t\tid=\"booking-booking-grid-columns\"\n\t\t\t\t\tclass=\"booking-booking-grid-columns --horizontal-scroll-bar\"\n\t\t\t\t\tref=\"columnsContainer\"\n\t\t\t\t\t@scroll=\"$store.dispatch('interface/setScroll', $refs.columnsContainer.scrollLeft)\"\n\t\t\t\t>\n\t\t\t\t\t<Bookings/>\n\t\t\t\t\t<TransitionGroup\n\t\t\t\t\t\tname=\"booking-transition-resource\"\n\t\t\t\t\t\t@after-leave=\"updateEars\"\n\t\t\t\t\t\t@after-enter=\"updateEars\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<template v-for=\"resourceId of resourcesIds\" :key=\"resourceId\">\n\t\t\t\t\t\t\t<Column :resourceId=\"resourceId\"/>\n\t\t\t\t\t\t</template>\n\t\t\t\t\t</TransitionGroup>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<ScalePanel\n\t\t\t\t:getColumnsContainer=\"() => $refs.columnsContainer\"\n\t\t\t\tref=\"scalePanel\"\n\t\t\t/>\n\t\t\t<DragDelete/>\n\t\t</div>\n\t\t<Sidebar/>\n\t`,\n};\n","import './battery-icon.css';\n\nconst MIN_CHARGE = 0;\nconst MAX_CHARGE = 12;\nconst CHARGE_COLOR = 'var(--ui-color-primary-alt)';\nconst EMPTY_COLOR = 'var(--ui-color-background-secondary)';\n\nexport const BATTERY_ICON_HEIGHT = 14;\nexport const BATTERY_ICON_WIDTH = 27;\n\nexport const BatteryIcon = {\n\tname: 'BatteryIcon',\n\tprops: {\n\t\tpercent: {\n\t\t\ttype: Number,\n\t\t\tdefault: 0,\n\t\t},\n\t\tdataId: {\n\t\t\ttype: [String, Number],\n\t\t\tdefault: '',\n\t\t},\n\t\theight: {\n\t\t\ttype: Number,\n\t\t\tdefault: BATTERY_ICON_HEIGHT,\n\t\t},\n\t\twidth: {\n\t\t\ttype: Number,\n\t\t\tdefault: BATTERY_ICON_WIDTH,\n\t\t},\n\t},\n\tmounted(): void {\n\t\tthis.repaint();\n\t},\n\tmethods: {\n\t\tgetCharge(percent: number): number\n\t\t{\n\t\t\tif (percent <= 0)\n\t\t\t{\n\t\t\t\treturn MIN_CHARGE;\n\t\t\t}\n\t\t\tif (percent >= 100)\n\t\t\t{\n\t\t\t\treturn MAX_CHARGE;\n\t\t\t}\n\n\t\t\treturn Math.round(percent * MAX_CHARGE * 0.01);\n\t\t},\n\t\trepaint(): void\n\t\t{\n\t\t\tconst rects: SVGRectElement[] = this.$refs['icon-battery-charge']?.children || [];\n\t\t\tconst charge: number = this.getCharge(this.percent);\n\t\t\tlet index = 1;\n\n\t\t\tfor (const rect: SVGRectElement of rects)\n\t\t\t{\n\t\t\t\trect.setAttribute('fill', index > charge ? EMPTY_COLOR : CHARGE_COLOR);\n\t\t\t\tindex++;\n\t\t\t}\n\t\t},\n\t},\n\twatch: {\n\t\tpercent: {\n\t\t\thandler(): void\n\t\t\t{\n\t\t\t\tthis.repaint();\n\t\t\t},\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div :data-id=\"dataId\" :data-percent=\"percent\" data-element=\"booking-resource-workload-percent\">\n\t\t\t<svg id=\"booking--battery-icon\" :width=\"width\" :height=\"height\" viewBox=\"0 0 27 14\" fill=\"none\"\n\t\t\t\t xmlns=\"http://www.w3.org/2000/svg\">\n\t\t\t\t<rect width=\"23.2875\" height=\"13.8\" rx=\"4\" fill=\"white\"/>\n\t\t\t\t<rect x=\"22.6871\" y=\"0.6\" width=\"12.6\" height=\"22.0875\" rx=\"3.4\" transform=\"rotate(90 22.6871 0.6)\" stroke=\"#C9CCD0\" stroke-width=\"1.2\"/>\n\t\t\t\t<g ref=\"icon-battery-charge\" id=\"booking--battery-icon-charge\" clip-path=\"url(#clip0_5003_187951)\">\n\t\t\t\t\t<rect x=\"2.58789\" y=\"2.5875\" width=\"1.50917\" height=\"10\" fill=\"#EDEEF0\"/>\n\t\t\t\t\t<rect x=\"4.09766\" y=\"2.5875\" width=\"1.50917\" height=\"10\" fill=\"#EDEEF0\"/>\n\t\t\t\t\t<rect x=\"5.60547\" y=\"2.5875\" width=\"1.50917\" height=\"10\" fill=\"#EDEEF0\"/>\n\t\t\t\t\t<rect x=\"7.11523\" y=\"2.5875\" width=\"1.50917\" height=\"10\" fill=\"#EDEEF0\"/>\n\t\t\t\t\t<rect x=\"8.625\" y=\"2.5875\" width=\"1.50917\" height=\"10\" fill=\"#EDEEF0\"/>\n\t\t\t\t\t<rect x=\"10.1328\" y=\"2.5875\" width=\"1.50917\" height=\"10\" fill=\"#EDEEF0\"/>\n\t\t\t\t\t<rect x=\"11.6426\" y=\"2.5875\" width=\"1.50917\" height=\"10\" fill=\"#EDEEF0\"/>\n\t\t\t\t\t<rect x=\"13.1523\" y=\"2.5875\" width=\"1.50917\" height=\"10\" fill=\"#EDEEF0\"/>\n\t\t\t\t\t<rect x=\"14.6621\" y=\"2.5875\" width=\"1.50917\" height=\"10\" fill=\"#EDEEF0\"/>\n\t\t\t\t\t<rect x=\"16.1699\" y=\"2.5875\" width=\"1.50917\" height=\"10\" fill=\"#EDEEF0\"/>\n\t\t\t\t\t<rect x=\"17.6797\" y=\"2.5875\" width=\"1.50917\" height=\"10\" fill=\"#EDEEF0\"/>\n\t\t\t\t\t<rect x=\"19.1895\" y=\"2.5875\" width=\"1.50917\" height=\"10\" fill=\"#EDEEF0\"/>\n\t\t\t\t</g>\n\t\t\t\t<g clip-path=\"url(#clip1_5003_187951)\">\n\t\t\t\t\t<ellipse cx=\"23.102\" cy=\"6.89999\" rx=\"2.9\" ry=\"3.48\" transform=\"rotate(90 23.102 6.89999)\" fill=\"#C9CCD0\"/>\n\t\t\t\t</g>\n\t\t\t\t<defs>\n\t\t\t\t\t<clipPath id=\"clip0_5003_187951\">\n\t\t\t\t\t\t<rect x=\"2.58789\" y=\"2.5875\" width=\"18.1125\" height=\"8.625\" rx=\"1.5\" fill=\"white\"/>\n\t\t\t\t\t</clipPath>\n\t\t\t\t\t<clipPath id=\"clip1_5003_187951\">\n\t\t\t\t\t\t<rect width=\"6.9\" height=\"2.15625\" fill=\"white\" transform=\"translate(26.7383 3.45) rotate(90)\"/>\n\t\t\t\t\t</clipPath>\n\t\t\t\t</defs>\n\t\t\t</svg>\n\t\t</div>\n\t`,\n};\n","import { StatisticsPopup } from 'booking.component.statistics-popup';\n\nexport const WorkloadPopup = {\n\temits: ['close'],\n\tprops: {\n\t\tresourceId: {\n\t\t\ttype: Number,\n\t\t\trequired: true,\n\t\t},\n\t\tslotsCount: {\n\t\t\ttype: Number,\n\t\t\trequired: true,\n\t\t},\n\t\tbookingCount: {\n\t\t\ttype: Number,\n\t\t\trequired: true,\n\t\t},\n\t\tworkLoadPercent: {\n\t\t\ttype: Number,\n\t\t\trequired: true,\n\t\t},\n\t\tbindElement: {\n\t\t\ttype: HTMLElement,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tcomputed: {\n\t\tpopupId(): string\n\t\t{\n\t\t\treturn 'booking-booking-resource-workload-popup';\n\t\t},\n\t\ttitle(): string\n\t\t{\n\t\t\treturn this.loc('BOOKING_BOOKING_RESOURCE_WORKLOAD_POPUP_TITLE');\n\t\t},\n\t\trows(): { title: string, value: string }[]\n\t\t{\n\t\t\treturn [\n\t\t\t\t{\n\t\t\t\t\ttitle: this.loc('BOOKING_BOOKING_RESOURCE_WORKLOAD_SLOTS_BOOKED'),\n\t\t\t\t\tvalue: this.slotsBookedFormatted,\n\t\t\t\t\tdataset: {\n\t\t\t\t\t\telement: 'booking-resource-workload-popup-count',\n\t\t\t\t\t\tresourceId: this.resourceId,\n\t\t\t\t\t\tbookedCount: this.bookingCount,\n\t\t\t\t\t\ttotalCount: this.slotsCount,\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\ttitle: this.loc('BOOKING_BOOKING_RESOURCE_WORKLOAD'),\n\t\t\t\t\tvalue: this.workLoadPercentFormatted,\n\t\t\t\t\tdataset: {\n\t\t\t\t\t\telement: 'booking-resource-workload-popup-percent',\n\t\t\t\t\t\tresourceId: this.resourceId,\n\t\t\t\t\t\tpercent: this.workLoadPercent,\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t];\n\t\t},\n\t\tslotsBookedFormatted(): string\n\t\t{\n\t\t\treturn this.loc('BOOKING_BOOKING_RESOURCE_WORKLOAD_BOOKED_FROM_SLOTS_COUNT', {\n\t\t\t\t'#BOOKED#': this.bookingCount,\n\t\t\t\t'#SLOTS_COUNT#': this.slotsCount,\n\t\t\t});\n\t\t},\n\t\tworkLoadPercentFormatted(): string\n\t\t{\n\t\t\treturn this.loc('BOOKING_BOOKING_RESOURCE_WORKLOAD_PERCENT', {\n\t\t\t\t'#PERCENT#': this.workLoadPercent,\n\t\t\t});\n\t\t},\n\t},\n\tcomponents: {\n\t\tStatisticsPopup,\n\t},\n\ttemplate: `\n\t\t<StatisticsPopup\n\t\t\t:popupId=\"popupId\"\n\t\t\t:bindElement=\"bindElement\"\n\t\t\t:title=\"title\"\n\t\t\t:rows=\"rows\"\n\t\t\t:dataset=\"{\n\t\t\t\tid: resourceId,\n\t\t\t\telement: 'booking-resource-workload-popup',\n\t\t\t}\"\n\t\t\t@close=\"$emit('close')\"\n\t\t/>\n\t`,\n};\n","import { mapGetters } from 'ui.vue3.vuex';\n\nimport { AhaMoment, DateFormat, HelpDesk, Model } from 'booking.const';\nimport { ahaMoments } from 'booking.lib.aha-moments';\nimport { busySlots } from 'booking.lib.busy-slots';\nimport type { ResourceModel } from 'booking.model.resources';\nimport type { BookingModel } from 'booking.model.bookings';\n\nimport { BatteryIcon, BATTERY_ICON_HEIGHT, BATTERY_ICON_WIDTH } from './battery-icon/battery-icon';\nimport { WorkloadPopup } from './workload-popup/workload-popup';\nimport './resource-workload.css';\n\ntype BookingDuration = {\n\tdateFromTs: number,\n\tdateToTs: number,\n\tduration: number,\n};\n\n// @vue/component\nexport const ResourceWorkload = {\n\tname: 'ResourceWorkload',\n\tcomponents: {\n\t\tBatteryIcon,\n\t\tWorkloadPopup,\n\t},\n\tprops: {\n\t\tresourceId: {\n\t\t\ttype: Number,\n\t\t\trequired: true,\n\t\t},\n\t\tscale: {\n\t\t\ttype: Number,\n\t\t\tdefault: 1,\n\t\t},\n\t\tisGrid: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t},\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tisPopupShown: false,\n\t\t};\n\t},\n\tcomputed: {\n\t\t...mapGetters({\n\t\t\tselectedDateTs: 'interface/selectedDateTs',\n\t\t\tfromHour: 'interface/fromHour',\n\t\t\ttoHour: 'interface/toHour',\n\t\t}),\n\t\tworkLoadPercent(): number\n\t\t{\n\t\t\tif (this.slotsCount === 0)\n\t\t\t{\n\t\t\t\treturn 0;\n\t\t\t}\n\n\t\t\tconst slotsDuration = this.slotSize * this.slotsCount;\n\t\t\tconst percent = this.bookings.reduce((acc, booking: BookingDuration) => {\n\t\t\t\treturn acc + booking.duration * 100 / slotsDuration;\n\t\t\t}, 0);\n\n\t\t\treturn Math.round(percent);\n\t\t},\n\t\tslotSize(): number\n\t\t{\n\t\t\treturn this.resource.slotRanges[0].slotSize ?? 60;\n\t\t},\n\t\tslotsCount(): number\n\t\t{\n\t\t\tconst selectedDate = new Date(this.selectedDateTs);\n\t\t\tconst selectedWeekDay = DateFormat.WeekDays[selectedDate.getDay()];\n\t\t\tconst slotRanges = busySlots.filterSlotRanges(\n\t\t\t\tthis.resource.slotRanges.filter((slotRange) => {\n\t\t\t\t\treturn slotRange.weekDays.includes(selectedWeekDay);\n\t\t\t\t}),\n\t\t\t);\n\n\t\t\treturn Math.floor(slotRanges.reduce((sum, slotRange) => {\n\t\t\t\treturn sum + Math.round((slotRange.to - slotRange.from) / this.slotSize);\n\t\t\t}, 0));\n\t\t},\n\t\tbookings(): BookingDuration[]\n\t\t{\n\t\t\tconst dateTs = this.selectedDateTs;\n\n\t\t\treturn this.$store.getters[`${Model.Bookings}/getByDateAndResources`](dateTs, [this.resourceId])\n\t\t\t\t.map((booking: BookingModel) => {\n\t\t\t\t\treturn {\n\t\t\t\t\t\tdateFromTs: booking.dateFromTs,\n\t\t\t\t\t\tdateToTs: booking.dateToTs,\n\t\t\t\t\t\tduration: (booking.dateToTs - booking.dateFromTs) / 60000,\n\t\t\t\t\t};\n\t\t\t\t});\n\t\t},\n\t\tbookingsDuration(): number\n\t\t{\n\t\t\treturn this.bookings.reduce((acc, booking: BookingDuration) => {\n\t\t\t\treturn acc + booking.duration;\n\t\t\t}, 0);\n\t\t},\n\t\tresource(): ResourceModel\n\t\t{\n\t\t\treturn this.$store.getters['resources/getById'](this.resourceId);\n\t\t},\n\t\tbatteryIconOptions(): { height: number, width: number }\n\t\t{\n\t\t\treturn {\n\t\t\t\theight: Math.round(BATTERY_ICON_HEIGHT * this.scale),\n\t\t\t\twidth: Math.round(BATTERY_ICON_WIDTH * this.scale),\n\t\t\t};\n\t\t},\n\t\tbookingsCount(): number\n\t\t{\n\t\t\treturn this.bookings.length;\n\t\t},\n\t},\n\twatch: {\n\t\tbookingsCount(newCount: number, previousCount: number): void\n\t\t{\n\t\t\tif (this.isGrid && newCount > previousCount && ahaMoments.shouldShow(AhaMoment.ResourceWorkload))\n\t\t\t{\n\t\t\t\tvoid this.showAhaMoment();\n\t\t\t}\n\t\t},\n\t},\n\tmethods: {\n\t\tonMouseEnter(): void\n\t\t{\n\t\t\tthis.showTimeout = setTimeout(() => this.showPopup(), 100);\n\t\t},\n\t\tonMouseLeave(): void\n\t\t{\n\t\t\tclearTimeout(this.showTimeout);\n\t\t\tthis.closePopup();\n\t\t},\n\t\tshowPopup(): void\n\t\t{\n\t\t\tthis.isPopupShown = true;\n\t\t},\n\t\tclosePopup(): void\n\t\t{\n\t\t\tthis.isPopupShown = false;\n\t\t},\n\t\tasync showAhaMoment(): Promise<void>\n\t\t{\n\t\t\tahaMoments.setPopupShown(AhaMoment.ResourceWorkload);\n\t\t\tawait ahaMoments.show({\n\t\t\t\tid: 'booking-resource-workload',\n\t\t\t\ttitle: this.loc('BOOKING_AHA_RESOURCE_WORKLOAD_TITLE'),\n\t\t\t\ttext: this.loc('BOOKING_AHA_RESOURCE_WORKLOAD_TEXT'),\n\t\t\t\tarticle: HelpDesk.AhaResourceWorkload,\n\t\t\t\ttarget: this.$refs.container,\n\t\t\t});\n\n\t\t\tahaMoments.setShown(AhaMoment.ResourceWorkload);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div\n\t\t\tclass=\"booking-booking-header-resource-workload\"\n\t\t\tdata-element=\"booking-resource-workload\"\n\t\t\t:data-id=\"resourceId\"\n\t\t\tref=\"container\"\n\t\t\t@click=\"showPopup\"\n\t\t\t@mouseenter=\"onMouseEnter\"\n\t\t\t@mouseleave=\"onMouseLeave\"\n\t\t>\n\t\t\t<BatteryIcon\n\t\t\t\t:percent=\"workLoadPercent\"\n\t\t\t\t:data-id=\"resourceId\"\n\t\t\t\t:height=\"batteryIconOptions.height\"\n\t\t\t\t:width=\"batteryIconOptions.width\"\n\t\t\t/>\n\t\t</div>\n\t\t<WorkloadPopup\n\t\t\tv-if=\"isPopupShown\"\n\t\t\t:resourceId=\"resourceId\"\n\t\t\t:slotsCount=\"slotsCount\"\n\t\t\t:bookingCount=\"Math.ceil(bookingsDuration / slotSize)\"\n\t\t\t:workLoadPercent=\"workLoadPercent\"\n\t\t\t:bindElement=\"$refs.container\"\n\t\t\t@close=\"closePopup\"\n\t\t/>\n\t`,\n};\n","import { Event } from 'main.core';\nimport { MenuManager, Menu } from 'main.popup';\nimport { mapGetters } from 'ui.vue3.vuex';\nimport 'ui.hint';\n\nimport { Model } from 'booking.const';\nimport { limit } from 'booking.lib.limit';\nimport { hideResources } from 'booking.lib.resources';\nimport { ResourceCreationWizard } from 'booking.resource-creation-wizard';\nimport { RemoveResource } from 'booking.lib.remove-resource';\n\nimport './resource-menu.css';\n\n// @vue/component\nexport const ResourceMenu = {\n\tname: 'ResourceMenu',\n\tprops: {\n\t\tresourceId: {\n\t\t\ttype: Number,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tdata(): { menuPopup: Menu | null }\n\t{\n\t\treturn {\n\t\t\tmenuPopup: null,\n\t\t};\n\t},\n\tcomputed: {\n\t\t...mapGetters({\n\t\t\tfavoritesIds: `${Model.Favorites}/get`,\n\t\t\tisEditingBookingMode: `${Model.Interface}/isEditingBookingMode`,\n\t\t\tisFeatureEnabled: `${Model.Interface}/isFeatureEnabled`,\n\t\t\tisFilterMode: `${Model.Filter}/isFilterMode`,\n\t\t}),\n\t\tpopupId(): string\n\t\t{\n\t\t\treturn `resource-menu-${this.resourceId || 'new'}`;\n\t\t},\n\t},\n\tcreated(): void\n\t{\n\t\tthis.hint = BX.UI.Hint.createInstance({\n\t\t\tpopupParameters: {},\n\t\t});\n\t},\n\tunmounted(): void\n\t{\n\t\tif (this.menuPopup)\n\t\t{\n\t\t\tthis.destroy();\n\t\t}\n\t},\n\tmethods: {\n\t\topenMenu(): void\n\t\t{\n\t\t\tif (this.menuPopup?.popupWindow?.isShown())\n\t\t\t{\n\t\t\t\tthis.destroy();\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (this.isFilterMode)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst menuButton = this.$refs['menu-button'];\n\t\t\tthis.menuPopup = MenuManager.create(\n\t\t\t\tthis.popupId,\n\t\t\t\tmenuButton,\n\t\t\t\tthis.getMenuItems(),\n\t\t\t\t{\n\t\t\t\t\tclassName: 'booking-resource-menu-popup',\n\t\t\t\t\tcloseByEsc: true,\n\t\t\t\t\tautoHide: true,\n\t\t\t\t\toffsetTop: -3,\n\t\t\t\t\toffsetLeft: menuButton.offsetWidth - 6,\n\t\t\t\t\tangle: true,\n\t\t\t\t\tcacheable: true,\n\t\t\t\t\tevents: {\n\t\t\t\t\t\tonDestroy: () => this.unbindScrollEvent(),\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t);\n\t\t\tthis.menuPopup.show();\n\t\t\tthis.bindScrollEvent();\n\t\t},\n\t\tgetMenuItems(): Array\n\t\t{\n\t\t\treturn [\n\t\t\t\t// {\n\t\t\t\t// \thtml: `<span>${this.loc('BOOKING_RESOURCE_MENU_ADD_BOOKING')}</span>`,\n\t\t\t\t// \tonclick: () => this.destroy(),\n\t\t\t\t// },\n\t\t\t\t{\n\t\t\t\t\thtml: `<span>${this.loc('BOOKING_RESOURCE_MENU_EDIT_RESOURCE')}</span>`,\n\t\t\t\t\tclassName: (\n\t\t\t\t\t\tthis.isFeatureEnabled\n\t\t\t\t\t\t\t? 'menu-popup-item menu-popup-no-icon'\n\t\t\t\t\t\t\t: 'menu-popup-item --lock'\n\t\t\t\t\t),\n\t\t\t\t\tonclick: async () => {\n\t\t\t\t\t\tif (!this.isFeatureEnabled)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tlimit.show();\n\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tconst wizard = new ResourceCreationWizard();\n\t\t\t\t\t\tthis.editResource(this.resourceId, wizard);\n\t\t\t\t\t\tthis.destroy();\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\t// {\n\t\t\t\t// \thtml: `<span>${this.loc('BOOKING_RESOURCE_MENU_EDIT_NOTIFY')}</span>`,\n\t\t\t\t// \tonclick: () => this.destroy(),\n\t\t\t\t// },\n\t\t\t\t// {\n\t\t\t\t// \thtml: `<span>${this.loc('BOOKING_RESOURCE_MENU_CREATE_COPY')}</span>`,\n\t\t\t\t// \tonclick: () => this.destroy(),\n\t\t\t\t// },\n\t\t\t\t// {\n\t\t\t\t// \thtml: '<span></span>',\n\t\t\t\t// \tdisabled: true,\n\t\t\t\t// \tclassName: 'menu-item-divider',\n\t\t\t\t// },\n\t\t\t\t{\n\t\t\t\t\thtml: `<span>${this.loc('BOOKING_RESOURCE_MENU_HIDE')}</span>`,\n\t\t\t\t\tonclick: async () => {\n\t\t\t\t\t\tthis.destroy();\n\t\t\t\t\t\tawait this.hideResource(this.resourceId);\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\thtml: `<span class=\"alert-text\">${this.loc('BOOKING_RESOURCE_MENU_DELETE')}</span>`,\n\t\t\t\t\tonclick: async () => {\n\t\t\t\t\t\tthis.destroy();\n\t\t\t\t\t\tawait this.removeResource(this.resourceId);\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t];\n\t\t},\n\t\tdestroy(): void\n\t\t{\n\t\t\tMenuManager.destroy(this.popupId);\n\t\t\tthis.unbindScrollEvent();\n\t\t},\n\t\tbindScrollEvent(): void\n\t\t{\n\t\t\tEvent.bind(document, 'scroll', this.adjustPosition, { capture: true });\n\t\t},\n\t\tunbindScrollEvent(): void\n\t\t{\n\t\t\tEvent.unbind(document, 'scroll', this.adjustPosition, { capture: true });\n\t\t},\n\t\tadjustPosition(): void\n\t\t{\n\t\t\tthis.menuPopup?.popupWindow?.adjustPosition();\n\t\t},\n\t\tasync editResource(resourceId: number, wizard: ResourceCreationWizard): void\n\t\t{\n\t\t\twizard.open(resourceId);\n\t\t},\n\t\tasync removeResource(resourceId: number): Promise<void>\n\t\t{\n\t\t\tawait (new RemoveResource(resourceId)).run();\n\t\t},\n\t\tasync hideResource(resourceId: number): Promise<void>\n\t\t{\n\t\t\tconst ids = [...this.favoritesIds];\n\t\t\tconst index = this.favoritesIds.indexOf(resourceId);\n\t\t\tif (index === -1)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tids.splice(index, 1);\n\n\t\t\tawait hideResources(ids);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<button ref=\"menu-button\" class=\"ui-icon-set --more\" @click=\"openMenu\"></button>\n\t`,\n};\n","import { mapGetters } from 'ui.vue3.vuex';\n\nimport { Label, LabelSize } from 'ui.label';\n\nimport { CrmEntity, Model } from 'booking.const';\nimport { currencyFormat } from 'booking.lib.currency-format';\nimport type { BookingModel, DealData } from 'booking.model.bookings';\nimport type { ResourceModel } from 'booking.model.resources';\nimport type { ResourceTypeModel } from 'booking.model.resource-types';\n\nimport { ResourceWorkload } from './resource-workload/resource-workload';\nimport { ResourceMenu } from './resource-menu/resource-menu';\nimport './resource.css';\n\nexport const Resource = {\n\tprops: {\n\t\tresourceId: {\n\t\t\ttype: Number,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tvisible: true,\n\t\t};\n\t},\n\tmounted(): void\n\t{\n\t\tthis.updateVisibility();\n\t\tthis.updateVisibilityDuringTransition();\n\t},\n\tcomputed: {\n\t\t...mapGetters({\n\t\t\tresourcesIds: `${Model.Interface}/resourcesIds`,\n\t\t\tzoom: `${Model.Interface}/zoom`,\n\t\t\tscroll: `${Model.Interface}/scroll`,\n\t\t\tselectedDateTs: `${Model.Interface}/selectedDateTs`,\n\t\t}),\n\t\tresource(): ResourceModel\n\t\t{\n\t\t\treturn this.$store.getters[`${Model.Resources}/getById`](this.resourceId);\n\t\t},\n\t\tresourceType(): ResourceTypeModel\n\t\t{\n\t\t\treturn this.$store.getters[`${Model.ResourceTypes}/getById`](this.resource.typeId);\n\t\t},\n\t\tprofit(): string\n\t\t{\n\t\t\tconst currencyId = currencyFormat.getBaseCurrencyId();\n\t\t\tconst deals = this.bookings\n\t\t\t\t.map(({ externalData }) => externalData?.find((data) => data.entityTypeId === CrmEntity.Deal) ?? null)\n\t\t\t\t.filter((deal: DealData | null) => deal?.data?.currencyId === currencyId)\n\t\t\t;\n\n\t\t\tif (deals.length === 0)\n\t\t\t{\n\t\t\t\treturn '';\n\t\t\t}\n\n\t\t\tconst uniqueDeals: DealData[] = [...new Map(deals.map((it) => [it.value, it])).values()];\n\n\t\t\tconst profit = uniqueDeals.reduce((sum: number, deal: DealData) => sum + deal.data.opportunity, 0);\n\n\t\t\treturn currencyFormat.format(currencyId, profit);\n\t\t},\n\t\tbookings(): BookingModel[]\n\t\t{\n\t\t\treturn this.$store.getters[`${Model.Bookings}/getByDateAndResources`](this.selectedDateTs, [this.resourceId]);\n\t\t},\n\t\tlabelHTML(): string {\n\t\t\tconst label = new Label({\n\t\t\t\tsize: LabelSize.SM,\n\t\t\t\ttext: this.loc('BOOKING_BOOKING_RESOURCE_DELETED'),\n\t\t\t\tfill: true,\n\t\t\t});\n\n\t\t\treturn label.render().outerHTML;\n\t\t},\n\t},\n\tmethods: {\n\t\tupdateVisibilityDuringTransition(): void\n\t\t{\n\t\t\tthis.animation?.stop();\n\t\t\tthis.animation = new BX.easing({\n\t\t\t\tduration: 200,\n\t\t\t\tstart: {},\n\t\t\t\tfinish: {},\n\t\t\t\tstep: this.updateVisibility,\n\t\t\t});\n\t\t\tthis.animation.animate();\n\t\t},\n\t\tupdateVisibility(): void\n\t\t{\n\t\t\tif (!this.$refs.container)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst rect = this.$refs.container.getBoundingClientRect();\n\t\t\tthis.visible = rect.right > 0 && rect.left < window.innerWidth;\n\t\t},\n\t},\n\twatch: {\n\t\tscroll(): void\n\t\t{\n\t\t\tthis.updateVisibility();\n\t\t},\n\t\tzoom(): void\n\t\t{\n\t\t\tthis.updateVisibility();\n\t\t},\n\t\tresourcesIds(): void\n\t\t{\n\t\t\tthis.updateVisibilityDuringTransition();\n\t\t},\n\t},\n\tcomponents: {\n\t\tResourceMenu,\n\t\tResourceWorkload,\n\t},\n\ttemplate: `\n\t\t<div\n\t\t\tclass=\"booking-booking-header-resource\"\n\t\t\tdata-element=\"booking-resource\"\n\t\t\t:data-id=\"resourceId\"\n\t\t\tref=\"container\"\n\t\t>\n\t\t\t<template v-if=\"visible\">\n\t\t\t\t<ResourceWorkload\n\t\t\t\t\tv-if=\"!resource.isDeleted\"\n\t\t\t\t\t:resourceId=\"resourceId\"\n\t\t\t\t\t:scale=\"zoom\"\n\t\t\t\t\t:isGrid=\"true\"\n\t\t\t\t/>\n\t\t\t\t<div class=\"booking-booking-header-resource-title\">\n\t\t\t\t\t<div class=\"booking-booking-header-resource-name\" :title=\"resource.name\">\n\t\t\t\t\t\t{{ resource.name }}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"booking-booking-header-resource-type\" :title=\"resourceType.name\">\n\t\t\t\t\t\t{{ resourceType.name }}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div\n\t\t\t\t\tv-if=\"resource.isDeleted\"\n\t\t\t\t\tv-html=\"labelHTML\"\n\t\t\t\t></div>\n\t\t\t\t<div\n\t\t\t\t\tclass=\"booking-booking-header-resource-profit\"\n\t\t\t\t\tv-else\n\t\t\t\t\tv-html=\"profit\"\n\t\t\t\t></div>\n\t\t\t\t<div class=\"booking-booking-header-resource-actions\" v-if=\"!resource.isDeleted\">\n\t\t\t\t\t<ResourceMenu :resource-id/>\n\t\t\t\t</div>\n\t\t\t</template>\n\t\t</div>\n\t`,\n};\n","import { mapGetters } from 'ui.vue3.vuex';\nimport { BIcon as Icon, Set as IconSet } from 'ui.icon-set.api.vue';\nimport 'ui.icon-set.actions';\n\nimport { AhaMoment, HelpDesk, Model } from 'booking.const';\nimport { ahaMoments } from 'booking.lib.aha-moments';\nimport { limit } from 'booking.lib.limit';\nimport { RcwAnalytics } from 'booking.lib.analytics';\nimport { SidePanelInstance } from 'booking.lib.side-panel-instance';\nimport { ResourceCreationWizard } from 'booking.resource-creation-wizard';\n\nimport './add-resource-button.css';\n\n// @vue/component\nexport const AddResourceButton = {\n\tname: 'AddResourceButton',\n\tcomponents: {\n\t\tIcon,\n\t},\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tIconSet,\n\t\t\thovered: false,\n\t\t};\n\t},\n\tcomputed: mapGetters({\n\t\tisLoaded: `${Model.Interface}/isLoaded`,\n\t\tisFeatureEnabled: `${Model.Interface}/isFeatureEnabled`,\n\t}),\n\twatch: {\n\t\tisLoaded(): void\n\t\t{\n\t\t\tif (ahaMoments.shouldShow(AhaMoment.AddResource))\n\t\t\t{\n\t\t\t\tvoid this.showAhaMoment();\n\t\t\t}\n\t\t},\n\t},\n\tmethods: {\n\t\tasync addResource(): void\n\t\t{\n\t\t\tif (!this.isFeatureEnabled)\n\t\t\t{\n\t\t\t\tawait limit.show();\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tnew ResourceCreationWizard().open();\n\t\t\tRcwAnalytics.sendClickAddResource();\n\t\t},\n\t\tasync showAhaMoment(): Promise<void>\n\t\t{\n\t\t\tawait ahaMoments.show({\n\t\t\t\tid: 'booking-add-resource',\n\t\t\t\ttitle: this.loc('BOOKING_AHA_ADD_RESOURCES_TITLE'),\n\t\t\t\ttext: this.loc('BOOKING_AHA_ADD_RESOURCES_TEXT_MSGVER_1'),\n\t\t\t\tarticle: {\n\t\t\t\t\t...HelpDesk.AhaAddResource,\n\t\t\t\t\ttitle: this.loc('BOOKING_AHA_ARTICLE_LINK_TITLE'),\n\t\t\t\t},\n\t\t\t\ttarget: this.$refs.button,\n\t\t\t});\n\n\t\t\tahaMoments.setShown(AhaMoment.AddResource);\n\n\t\t\tif (SidePanelInstance.openSliders.every(({ url }) => url !== ResourceCreationWizard.makeName()))\n\t\t\t{\n\t\t\t\tvoid this.addResource();\n\t\t\t}\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div\n\t\t\tclass=\"booking-booking-header-add-resource-icon-container\"\n\t\t\t:class=\"{ '--hover': hovered }\"\n\t\t\t@click=\"addResource\"\n\t\t\t@mouseenter=\"hovered = true\"\n\t\t\t@mouseleave=\"hovered = false\"\n\t\t>\n\t\t\t<div\n\t\t\t\tclass=\"booking-booking-header-add-resource-icon\"\n\t\t\t\t:class=\"{'--lock': !isFeatureEnabled}\"\n\t\t\t>\n\t\t\t\t<Icon v-if=\"isFeatureEnabled\" :name=\"IconSet.PLUS_20\"/>\n\t\t\t\t<Icon v-else :name=\"IconSet.LOCK\" :size=\"16\"/>\n\t\t\t</div>\n\t\t</div>\n\t\t<div\n\t\t\tclass=\"booking-booking-header-add-resource\"\n\t\t\t:class=\"{ '--hover': hovered }\"\n\t\t\tref=\"button\"\n\t\t\t@click=\"addResource\"\n\t\t\t@mouseenter=\"hovered = true\"\n\t\t\t@mouseleave=\"hovered = false\"\n\t\t>\n\t\t\t<div class=\"booking-booking-header-add-resource-text\">\n\t\t\t\t{{ loc('BOOKING_BOOKING_ADD_RESOURCE') }}\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import { BaseHeader } from 'ui.entity-selector';\n\nexport class ContentHeader extends BaseHeader\n{\n\tconstructor(...props)\n\t{\n\t\tsuper(...props);\n\n\t\tthis.getContainer();\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\treturn this.options.content;\n\t}\n}\n","import { mapGetters } from 'ui.vue3.vuex';\nimport type { ResourceTypeModel } from 'booking.model.resource-types';\nimport './resource-types.css';\n\nexport const ResourceTypes = {\n\temits: ['update:modelValue'],\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tselectedTypes: {},\n\t\t};\n\t},\n\tcomputed: {\n\t\t...mapGetters({\n\t\t\tresourceTypes: 'resourceTypes/get',\n\t\t}),\n\t\tvisibleResourceTypes(): []\n\t\t{\n\t\t\treturn this.resourceTypes.filter((item) => item.resourcesCnt > 0);\n\t\t},\n\t\tisResourceTypesSectionVisible(): boolean\n\t\t{\n\t\t\treturn this.visibleResourceTypes.length > 0;\n\t\t},\n\t},\n\tmethods: {\n\t\tselectAll(): void\n\t\t{\n\t\t\tObject.keys(this.selectedTypes).forEach((typeId) => {\n\t\t\t\tthis.selectedTypes[typeId] = true;\n\t\t\t});\n\t\t},\n\t\tdeselectAll(): void\n\t\t{\n\t\t\tObject.keys(this.selectedTypes).forEach((typeId) => {\n\t\t\t\tthis.selectedTypes[typeId] = false;\n\t\t\t});\n\t\t},\n\t},\n\twatch: {\n\t\tresourceTypes(resourceTypes: ResourceTypeModel[]): void\n\t\t{\n\t\t\tresourceTypes.forEach((resourceType: ResourceTypeModel) => {\n\t\t\t\tthis.selectedTypes[resourceType.id] ??= true;\n\t\t\t});\n\t\t},\n\t\tselectedTypes: {\n\t\t\thandler(): void\n\t\t\t{\n\t\t\t\tthis.$emit('update:modelValue', this.selectedTypes);\n\t\t\t},\n\t\t\tdeep: true,\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div v-if=\"isResourceTypesSectionVisible\" class=\"booking-booking-resources-dialog-header-types\">\n\t\t\t<div class=\"booking-booking-resources-dialog-header-header\">\n\t\t\t\t<div class=\"booking-booking-resources-dialog-header-title\">\n\t\t\t\t\t{{ loc('BOOKING_BOOKING_RESOURCES_DIALOG_RESOURCE_TYPES') }}\n\t\t\t\t</div>\n\t\t\t\t<div\n\t\t\t\t\tclass=\"booking-booking-resources-dialog-header-button\"\n\t\t\t\t\tdata-element=\"booking-resources-dialog-select-all-types-button\"\n\t\t\t\t\t@click=\"selectAll\"\n\t\t\t\t>\n\t\t\t\t\t{{ loc('BOOKING_BOOKING_RESOURCES_DIALOG_SELECT_ALL') }}\n\t\t\t\t</div>\n\t\t\t\t<div\n\t\t\t\t\tclass=\"booking-booking-resources-dialog-header-button\"\n\t\t\t\t\tdata-element=\"booking-resources-dialog-deselect-all-types-button\"\n\t\t\t\t\t@click=\"deselectAll\"\n\t\t\t\t>\n\t\t\t\t\t{{ loc('BOOKING_BOOKING_RESOURCES_DIALOG_DESELECT_ALL') }}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div class=\"booking-booking-resources-dialog-header-items\">\n\t\t\t\t<template v-for=\"resourceType of visibleResourceTypes\" :key=\"resourceType.id\">\n\t\t\t\t\t<label\n\t\t\t\t\t\tclass=\"booking-booking-resources-dialog-header-item\"\n\t\t\t\t\t\tdata-element=\"booking-resources-dialog-type\"\n\t\t\t\t\t\t:data-id=\"resourceType.id\"\n\t\t\t\t\t\t:data-selected=\"selectedTypes[resourceType.id]\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<span\n\t\t\t\t\t\t\tclass=\"booking-booking-resources-dialog-header-item-text\"\n\t\t\t\t\t\t\tdata-element=\"booking-resources-dialog-type-name\"\n\t\t\t\t\t\t\t:data-id=\"resourceType.id\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{{ resourceType.name }}\n\t\t\t\t\t\t</span>\n\t\t\t\t\t\t<input type=\"checkbox\" v-model=\"selectedTypes[resourceType.id]\">\n\t\t\t\t\t</label>\n\t\t\t\t</template>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import { Dom, Event } from 'main.core';\nimport './resize.css';\n\nexport const Resize = {\n\temits: ['startResize', 'endResize'],\n\tprops: {\n\t\tgetNode: {\n\t\t\ttype: Function,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tisResized: false,\n\t\t\tstartMouseY: 0,\n\t\t\tstartHeight: 0,\n\t\t};\n\t},\n\tmethods: {\n\t\tstartResize(event: MouseEvent): void\n\t\t{\n\t\t\tthis.$emit('startResize');\n\t\t\tDom.style(document.body, 'user-select', 'none');\n\t\t\tEvent.bind(window, 'mouseup', this.endResize);\n\t\t\tEvent.bind(window, 'pointermove', this.resize);\n\t\t\tthis.isResized = true;\n\t\t\tthis.startMouseY = event.clientY;\n\t\t\tthis.startHeight = this.getNode().offsetHeight;\n\t\t},\n\t\tresize(event: MouseEvent): void\n\t\t{\n\t\t\tif (!this.isResized)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tevent.preventDefault();\n\n\t\t\tconst minHeight = 110;\n\t\t\tconst maxHeight = 180;\n\t\t\tconst height = this.startHeight + event.clientY - this.startMouseY;\n\t\t\tconst newHeight = Math.min(maxHeight, Math.max(height, minHeight));\n\n\t\t\tDom.style(this.getNode(), 'max-height', `${newHeight}px`);\n\t\t},\n\t\tendResize(): void\n\t\t{\n\t\t\tthis.$emit('endResize');\n\t\t\tDom.style(document.body, 'user-select', '');\n\t\t\tEvent.unbind(window, 'mouseup', this.endResize);\n\t\t\tEvent.unbind(window, 'pointermove', this.resize);\n\t\t\tthis.isResized = false;\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div\n\t\t\tclass=\"booking-booking-resources-dialog-header-resize\"\n\t\t\t@mousedown=\"startResize\"\n\t\t></div>\n\t`,\n};\n","import { Runtime, Type } from 'main.core';\nimport { BIcon as Icon, Set as IconSet } from 'ui.icon-set.api.vue';\nimport './search.css';\n\nexport const Search = {\n\temits: ['search'],\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tsearchDebounced: Runtime.debounce(this.search, 200, this),\n\t\t\tquery: '',\n\t\t};\n\t},\n\tcomputed: {\n\t\tsearchIcon(): string\n\t\t{\n\t\t\treturn IconSet.SEARCH_2;\n\t\t},\n\t},\n\tmethods: {\n\t\tonInput(event: InputEvent): void\n\t\t{\n\t\t\tconst query = event.target.value;\n\t\t\tthis.query = query;\n\n\t\t\tif (Type.isStringFilled(query))\n\t\t\t{\n\t\t\t\tthis.searchDebounced(query);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.search(query);\n\t\t\t}\n\t\t},\n\t\tsearch(query: string): void\n\t\t{\n\t\t\tif (this.query === query)\n\t\t\t{\n\t\t\t\tthis.$emit('search', query);\n\t\t\t}\n\t\t},\n\t},\n\tcomponents: {\n\t\tIcon,\n\t},\n\ttemplate: `\n\t\t<div class=\"booking-booking-resources-dialog-header-input-container\">\n\t\t\t<input\n\t\t\t\tclass=\"booking-booking-resources-dialog-header-input\"\n\t\t\t\t:placeholder=\"loc('BOOKING_BOOKING_RESOURCES_DIALOG_SEARCH')\"\n\t\t\t\tdata-element=\"booking-resources-dialog-search-input\"\n\t\t\t\t@input=\"onInput\"\n\t\t\t>\n\t\t\t<div class=\"booking-booking-resources-dialog-header-input-icon\">\n\t\t\t\t<Icon :name=\"searchIcon\"/>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import { mapGetters } from 'ui.vue3.vuex';\nimport { ResourceTypes } from './resource-types/resource-types';\nimport { Resize } from './resize/resize';\nimport { Search } from './search/search';\nimport './dialog-header.css';\n\nexport const DialogHeader = {\n\temits: ['update:modelValue', 'search', 'startResize', 'endResize', 'selectAll', 'deselectAll'],\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tselectedTypes: {},\n\t\t};\n\t},\n\tcomputed: mapGetters({\n\t\tresources: 'resources/get',\n\t}),\n\twatch: {\n\t\tselectedTypes: {\n\t\t\thandler(): void\n\t\t\t{\n\t\t\t\tthis.$emit('update:modelValue', this.selectedTypes);\n\t\t\t},\n\t\t\tdeep: true,\n\t\t},\n\t},\n\tcomponents: {\n\t\tResourceTypes,\n\t\tResize,\n\t\tSearch,\n\t},\n\ttemplate: `\n\t\t<div class=\"booking-booking-resources-dialog-header\" ref=\"header\">\n\t\t\t<ResourceTypes\n\t\t\t\tref=\"resourceTypes\"\n\t\t\t\tv-model=\"selectedTypes\"\n\t\t\t/>\n\t\t\t<Resize\n\t\t\t\t:getNode=\"() => this.$refs.resourceTypes.$el\"\n\t\t\t\t@startResize=\"$emit('startResize')\"\n\t\t\t\t@endResize=\"$emit('endResize')\"\n\t\t\t/>\n\t\t\t<div class=\"booking-booking-resources-dialog-header-resources\">\n\t\t\t\t<div class=\"booking-booking-resources-dialog-header-header\">\n\t\t\t\t\t<div class=\"booking-booking-resources-dialog-header-title\">\n\t\t\t\t\t\t{{ loc('BOOKING_BOOKING_RESOURCES_DIALOG_RESOURCES') }}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div\n\t\t\t\t\t\tclass=\"booking-booking-resources-dialog-header-button\"\n\t\t\t\t\t\tdata-element=\"booking-resources-dialog-select-all-button\"\n\t\t\t\t\t\t@click=\"$emit('selectAll')\"\n\t\t\t\t\t>\n\t\t\t\t\t\t{{ loc('BOOKING_BOOKING_RESOURCES_DIALOG_SELECT_ALL') }}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div\n\t\t\t\t\t\tclass=\"booking-booking-resources-dialog-header-button\"\n\t\t\t\t\t\tdata-element=\"booking-resources-dialog-deselect-all-button\"\n\t\t\t\t\t\t@click=\"$emit('deselectAll')\"\n\t\t\t\t\t>\n\t\t\t\t\t\t{{ loc('BOOKING_BOOKING_RESOURCES_DIALOG_DESELECT_ALL') }}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<Search @search=\"(query) => this.$emit('search', query)\"/>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import { BaseFooter } from 'ui.entity-selector';\nimport './dialog-footer.css';\n\nexport class ContentFooter extends BaseFooter\n{\n\tconstructor(...props)\n\t{\n\t\tsuper(...props);\n\n\t\tthis.getContainer();\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\treturn this.options.content;\n\t}\n}\n","import { Button as UiButton, ButtonSize, ButtonColor } from 'booking.component.button';\nimport './dialog-footer.css';\n\nexport const DialogFooter = {\n\tname: 'DialogFooter',\n\temits: ['reset'],\n\tcomputed: {\n\t\tbuttonSettings(): { size: string, color: string }\n\t\t{\n\t\t\treturn Object.freeze({\n\t\t\t\tsize: ButtonSize.SMALL,\n\t\t\t\tcolor: ButtonColor.LINK,\n\t\t\t});\n\t\t},\n\t\tbuttonLabel(): string\n\t\t{\n\t\t\treturn this.loc('BOOKING_BOOKING_RESOURCES_DIALOG_RESET');\n\t\t},\n\t},\n\tcomponents: {\n\t\tUiButton,\n\t},\n\ttemplate: `\n\t\t<div class=\"booking--booking--select-resources-dialog-footer\">\n\t\t\t<UiButton\n\t\t\t\t:size=\"buttonSettings.size\"\n\t\t\t\t:color=\"buttonSettings.color\"\n\t\t\t\t:text=\"buttonLabel\"\n\t\t\t\tbutton-class=\"booking--booking--select-resources-dialog-footer__button\"\n\t\t\t\t@click=\"$emit('reset')\"\n\t\t\t/>\n\t\t</div>\n\t`,\n};\n","import { ahaMoments } from 'booking.lib.aha-moments';\nimport { Dom, Event, Runtime, Type } from 'main.core';\nimport { mapGetters } from 'ui.vue3.vuex';\nimport { Dialog, Item, type ItemOptions } from 'ui.entity-selector';\n\nimport { AhaMoment, EntitySelectorEntity, EntitySelectorTab, HelpDesk, Limit, Model } from 'booking.const';\nimport { resourceDialogService } from 'booking.provider.service.resource-dialog-service';\nimport { hideResources } from 'booking.lib.resources';\nimport { resourcesDateCache } from 'booking.lib.resources-date-cache';\nimport type { ResourceModel } from 'booking.model.resources';\nimport type { ResourceTypeModel } from 'booking.model.resource-types';\n\nimport { ContentHeader } from './dialog-header/content-header';\nimport { DialogHeader } from './dialog-header/dialog-header';\nimport { ContentFooter } from './dialog-footer/content-footer';\nimport { DialogFooter } from './dialog-footer/dialog-footer';\nimport { ResourceWorkload } from '../resource/resource-workload/resource-workload';\nimport './select-resources.css';\n\n// @vue/component\nexport const SelectResources = {\n\tname: 'SelectResources',\n\tcomponents: {\n\t\tDialogHeader,\n\t\tDialogFooter,\n\t\tResourceWorkload,\n\t},\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tdialogFilled: false,\n\t\t\tquery: '',\n\t\t\tsaveItemsDebounce: Runtime.debounce(this.saveItems, 10, this),\n\t\t\tworkloadRefs: {},\n\t\t\tselectedTypes: {},\n\t\t};\n\t},\n\tcomputed: {\n\t\t...mapGetters({\n\t\t\tselectedDateTs: `${Model.Interface}/selectedDateTs`,\n\t\t\tfavoritesIds: `${Model.Favorites}/get`,\n\t\t\tresources: `${Model.Resources}/get`,\n\t\t\tisFilterMode: `${Model.Filter}/isFilterMode`,\n\t\t\tisEditingBookingMode: `${Model.Interface}/isEditingBookingMode`,\n\t\t\tisLoaded: `${Model.Interface}/isLoaded`,\n\t\t\tmainResources: `${Model.MainResources}/resources`,\n\t\t\tresourceTypes: `${Model.ResourceTypes}/get`,\n\t\t}),\n\t\tmainResourceIds(): Set<number>\n\t\t{\n\t\t\treturn new Set(this.mainResources);\n\t\t},\n\t\tisDefaultState(): boolean\n\t\t{\n\t\t\treturn this.mainResourceIds.size === this.favoritesIds.length\n\t\t\t\t&& this.favoritesIds.every((id: number) => this.mainResourceIds.has(id));\n\t\t},\n\t\tvisibleResourceTypes(): number[]\n\t\t{\n\t\t\treturn this.resourceTypes\n\t\t\t\t.filter((item) => item.resourcesCnt > 0)\n\t\t\t\t.map(({ id }) => id);\n\t\t},\n\t},\n\twatch: {\n\t\tfavoritesIds(): void\n\t\t{\n\t\t\tthis.updateItems();\n\t\t},\n\t\tresources: {\n\t\t\thandler(resources: ResourceModel[]): void\n\t\t\t{\n\t\t\t\tsetTimeout(() => this.addItems(resources));\n\t\t\t\tresourceDialogService.clearMainResourcesCache();\n\t\t\t},\n\t\t\tdeep: true,\n\t\t},\n\t\tselectedTypes: {\n\t\t\thandler(): void\n\t\t\t{\n\t\t\t\tvoid this.updateItemsByType();\n\t\t\t},\n\t\t\tdeep: true,\n\t\t},\n\t\tisLoaded(): void\n\t\t{\n\t\t\tthis.tryShowAhaMoment();\n\t\t},\n\t},\n\tmounted(): void\n\t{\n\t\tthis.dialog = new Dialog({\n\t\t\tcontext: 'BOOKING',\n\t\t\ttargetNode: this.$refs.button,\n\t\t\twidth: 340,\n\t\t\theight: Math.min(window.innerHeight - 280, 600),\n\t\t\toffsetLeft: 4,\n\t\t\tdropdownMode: true,\n\t\t\tpreselectedItems: this.favoritesIds.map((resourceId) => [EntitySelectorEntity.Resource, resourceId]),\n\t\t\titems: this.resources.map((resource) => this.getItemOptions(resource)),\n\t\t\tentities: [\n\t\t\t\t{\n\t\t\t\t\tid: EntitySelectorEntity.Resource,\n\t\t\t\t},\n\t\t\t],\n\t\t\tevents: {\n\t\t\t\tonShow: this.onShow,\n\t\t\t\t'Item:onSelect': this.saveItemsDebounce,\n\t\t\t\t'Item:onDeselect': this.saveItemsDebounce,\n\t\t\t},\n\t\t\theader: ContentHeader,\n\t\t\theaderOptions: {\n\t\t\t\tcontent: this.$refs.dialogHeader.$el,\n\t\t\t},\n\t\t\tfooter: ContentFooter,\n\t\t\tfooterOptions: {\n\t\t\t\tcontent: this.$refs.dialogFooter.$el,\n\t\t\t},\n\t\t});\n\n\t\tEvent.bind(this.dialog.getRecentTab().getContainer(), 'scroll', this.loadOnScroll);\n\t\tEvent.EventEmitter.subscribe('BX.Main.Popup:onAfterClose', this.tryShowAhaMoment);\n\t\tEvent.EventEmitter.subscribe('BX.Main.Popup:onDestroy', this.tryShowAhaMoment);\n\t},\n\tmethods: {\n\t\tshowDialog(): void\n\t\t{\n\t\t\tthis.updateItems();\n\t\t\tvoid this.loadMainResources();\n\n\t\t\tthis.dialog.show();\n\t\t},\n\t\tasync onShow(): Promise<void>\n\t\t{\n\t\t\tif (this.dialogFilled)\n\t\t\t{\n\t\t\t\tvoid this.loadOnScroll();\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.dialogFilled = true;\n\n\t\t\tawait resourceDialogService.fillDialog(this.selectedDateTs / 1000);\n\t\t},\n\t\tasync loadOnScroll(): Promise<void>\n\t\t{\n\t\t\tconst container = this.dialog.getRecentTab().getContainer();\n\t\t\tconst scrollTop = container.scrollTop;\n\t\t\tconst maxScroll = container.scrollHeight - container.offsetHeight;\n\n\t\t\tif (scrollTop + 10 >= maxScroll)\n\t\t\t{\n\t\t\t\tconst loadedResourcesIds = resourcesDateCache.getIdsByDateTs(this.selectedDateTs / 1000);\n\t\t\t\tconst activeResources = this.resources.filter((resource: ResourceModel) => !resource.isDeleted);\n\t\t\t\tconst resourcesIds = activeResources.map((resource: ResourceModel) => resource.id);\n\t\t\t\tconst idsToLoad = resourcesIds\n\t\t\t\t\t.filter((id: number) => !loadedResourcesIds.includes(id))\n\t\t\t\t\t.slice(0, Limit.ResourcesDialog)\n\t\t\t\t;\n\n\t\t\t\tawait resourceDialogService.loadByIds(idsToLoad, this.selectedDateTs / 1000);\n\n\t\t\t\tthis.updateItems();\n\t\t\t}\n\t\t},\n\t\tasync loadMainResources(): Promise<void>\n\t\t{\n\t\t\tawait resourceDialogService.getMainResources();\n\t\t},\n\t\tupdateItems(): void\n\t\t{\n\t\t\tthis.dialog.getItems().forEach((item: Item) => {\n\t\t\t\tconst id = item.getId();\n\t\t\t\tconst workload = this.workloadRefs[id];\n\t\t\t\tconst isHidden = this.isItemHidden(id);\n\t\t\t\tconst isSelected = this.isItemSelected(id);\n\n\t\t\t\titem.getNodes().forEach((node) => {\n\t\t\t\t\tconst avatarContainer = node.getAvatarContainer();\n\t\t\t\t\tDom.style(avatarContainer, 'width', 'max-content');\n\t\t\t\t\tDom.style(avatarContainer, 'height', 'max-content');\n\t\t\t\t\tDom.append(workload, avatarContainer);\n\t\t\t\t});\n\n\t\t\t\titem.setHidden(isHidden);\n\n\t\t\t\tif (!item.isSelected() && isSelected)\n\t\t\t\t{\n\t\t\t\t\titem.select();\n\t\t\t\t}\n\n\t\t\t\tif (item.isSelected() && !isSelected)\n\t\t\t\t{\n\t\t\t\t\titem.deselect();\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\t\tsaveItems(): void\n\t\t{\n\t\t\tvoid hideResources(this.dialog.getSelectedItems().map((item) => item.id));\n\t\t},\n\t\taddItems(resources: ResourceModel[]): void\n\t\t{\n\t\t\tconst itemsOptions: { [id: number]: ItemOptions } = resources.reduce((acc, resource: ResourceModel) => ({\n\t\t\t\t...acc,\n\t\t\t\t[resource.id]: this.getItemOptions(resource),\n\t\t\t}), {});\n\n\t\t\tObject.values(itemsOptions).forEach((itemOptions: ItemOptions) => this.dialog.addItem(itemOptions));\n\n\t\t\tconst itemsIds = this.dialog.getItems().map((item: Item) => item.getId())\n\t\t\t\t.filter((id: number) => itemsOptions[id])\n\t\t\t;\n\n\t\t\tthis.dialog.removeItems();\n\t\t\titemsIds.forEach((id: number) => this.dialog.addItem(itemsOptions[id]));\n\n\t\t\t// I don't know why, but tab is being removed after this.dialog.removeItems();\n\t\t\tconst tab = this.dialog.getActiveTab();\n\t\t\tif (tab)\n\t\t\t{\n\t\t\t\ttab.getContainer().append(tab.getRootNode().getChildrenContainer());\n\t\t\t\ttab.render();\n\t\t\t}\n\n\t\t\tthis.updateItems();\n\n\t\t\tif (Type.isStringFilled(this.query))\n\t\t\t{\n\t\t\t\tvoid this.search(this.query);\n\t\t\t}\n\t\t},\n\t\tgetItemOptions(resource: ResourceModel): ItemOptions\n\t\t{\n\t\t\treturn {\n\t\t\t\tid: resource.id,\n\t\t\t\tentityId: EntitySelectorEntity.Resource,\n\t\t\t\ttitle: resource.name,\n\t\t\t\tsubtitle: this.getResourceType(resource.typeId).name,\n\t\t\t\tavatarOptions: {\n\t\t\t\t\tbgImage: 'none',\n\t\t\t\t\tborderRadius: '0',\n\t\t\t\t},\n\t\t\t\ttabs: EntitySelectorTab.Recent,\n\t\t\t\tselected: this.isItemSelected(resource.id),\n\t\t\t\thidden: this.isItemHidden(resource.id),\n\t\t\t\tnodeAttributes: {\n\t\t\t\t\t'data-id': resource.id,\n\t\t\t\t\t'data-element': 'booking-select-resources-dialog-item',\n\t\t\t\t},\n\t\t\t};\n\t\t},\n\t\tisItemSelected(id: number): boolean\n\t\t{\n\t\t\treturn this.favoritesIds.includes(id);\n\t\t},\n\t\tisItemHidden(id: number): boolean\n\t\t{\n\t\t\tconst loadedResourcesIds = resourcesDateCache.getIdsByDateTs(this.selectedDateTs / 1000);\n\t\t\tconst resource = this.getResource(id);\n\n\t\t\tconst visible = loadedResourcesIds.includes(id)\n\t\t\t\t&& resource\n\t\t\t\t&& !resource.isDeleted\n\t\t\t\t&& this.selectedTypes[resource.typeId]\n\t\t\t;\n\n\t\t\treturn !visible;\n\t\t},\n\t\tgetResource(id: number): ResourceModel\n\t\t{\n\t\t\treturn this.$store.getters['resources/getById'](id);\n\t\t},\n\t\tgetResourceType(id: number): ResourceTypeModel\n\t\t{\n\t\t\treturn this.$store.getters['resourceTypes/getById'](id);\n\t\t},\n\t\tasync search(query: string): Promise<void>\n\t\t{\n\t\t\tthis.query = query;\n\n\t\t\tthis.dialog.search(this.query);\n\t\t\tthis.updateItems();\n\t\t\tthis.dialog.getSearchTab().getStub().hide();\n\t\t\tthis.dialog.getSearchTab().getSearchLoader().show();\n\n\t\t\tawait resourceDialogService.doSearch(this.query, this.selectedDateTs / 1000, this.visibleResourceTypes);\n\n\t\t\tthis.dialog.search(this.query);\n\t\t\tthis.updateItems();\n\t\t\tthis.dialog.getSearchTab().getSearchLoader().hide();\n\t\t\tif (this.dialog.getSearchTab().isEmptyResult())\n\t\t\t{\n\t\t\t\tthis.dialog.getSearchTab().getStub().show();\n\t\t\t}\n\t\t},\n\t\tstartResize(): void\n\t\t{\n\t\t\tthis.dialog.freeze();\n\t\t},\n\t\tendResize(): void\n\t\t{\n\t\t\tsetTimeout(() => this.dialog.unfreeze());\n\t\t},\n\t\tselectAll(): void\n\t\t{\n\t\t\tthis.dialog.getItems().forEach((item: Item) => {\n\t\t\t\tif (!item.isHidden())\n\t\t\t\t{\n\t\t\t\t\titem.select();\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\t\tdeselectAll(): void\n\t\t{\n\t\t\tthis.dialog.getItems().forEach((item: Item) => {\n\t\t\t\tif (!item.isHidden())\n\t\t\t\t{\n\t\t\t\t\titem.deselect();\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\t\tsetWorkloadRef(element: HTMLElement, id: number): void\n\t\t{\n\t\t\tthis.workloadRefs[id] = element;\n\t\t},\n\t\ttryShowAhaMoment(): void\n\t\t{\n\t\t\tif (ahaMoments.shouldShow(AhaMoment.SelectResources))\n\t\t\t{\n\t\t\t\tEvent.EventEmitter.unsubscribe('BX.Main.Popup:onAfterClose', this.tryShowAhaMoment);\n\t\t\t\tEvent.EventEmitter.unsubscribe('BX.Main.Popup:onDestroy', this.tryShowAhaMoment);\n\t\t\t\tvoid this.showAhaMoment();\n\t\t\t}\n\t\t},\n\t\tasync showAhaMoment(): Promise<void>\n\t\t{\n\t\t\tawait ahaMoments.show({\n\t\t\t\tid: 'booking-select-resources',\n\t\t\t\ttitle: this.loc('BOOKING_AHA_SELECT_RESOURCES_TITLE_MSGVER_1'),\n\t\t\t\ttext: this.loc('BOOKING_AHA_SELECT_RESOURCES_TEXT_MSGVER_1'),\n\t\t\t\tarticle: {\n\t\t\t\t\t...HelpDesk.AhaSelectResources,\n\t\t\t\t\ttitle: this.loc('BOOKING_AHA_ARTICLE_LINK_TITLE'),\n\t\t\t\t},\n\t\t\t\ttarget: this.$refs.button,\n\t\t\t});\n\n\t\t\tahaMoments.setShown(AhaMoment.SelectResources);\n\t\t},\n\t\treset(): void\n\t\t{\n\t\t\tconst mainResourceIds: Set<number> = this.mainResourceIds;\n\n\t\t\tthis.dialog.getItems().forEach((item: Item) => {\n\t\t\t\tif (mainResourceIds.has(item.id))\n\t\t\t\t{\n\t\t\t\t\titem.select();\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\titem.deselect();\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\t\tgetSelectedTypes(): number[]\n\t\t{\n\t\t\treturn this.visibleResourceTypes.filter((id) => this.selectedTypes[id]);\n\t\t},\n\t\tasync updateItemsByType(): Promise<void>\n\t\t{\n\t\t\tif (\n\t\t\t\tthis.query\n\t\t\t\t|| this.visibleResourceTypes.every((id) => this.selectedTypes[id])\n\t\t\t\t|| this.visibleResourceTypes.every((id) => !this.selectedTypes[id])\n\t\t\t)\n\t\t\t{\n\t\t\t\tthis.updateItems();\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tawait resourceDialogService.doSearch(this.query, this.selectedDateTs / 1000, this.getSelectedTypes());\n\n\t\t\tthis.updateItems();\n\t\t\tthis.dialog.getSearchTab().getSearchLoader().hide();\n\t\t\tif (this.dialog.getSearchTab().isEmptyResult())\n\t\t\t{\n\t\t\t\tthis.dialog.getSearchTab().getStub().show();\n\t\t\t}\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div\n\t\t\tclass=\"booking-booking-select-resources\"\n\t\t\t:class=\"{'--disabled': isFilterMode}\"\n\t\t\tdata-element=\"booking-select-resources\"\n\t\t\tref=\"button\"\n\t\t\t@click=\"showDialog\"\n\t\t>\n\t\t\t<div class=\"ui-icon-set --funnel\"></div>\n\t\t</div>\n\t\t<DialogHeader\n\t\t\tref=\"dialogHeader\"\n\t\t\tv-model=\"selectedTypes\"\n\t\t\t@search=\"search\"\n\t\t\t@startResize=\"startResize\"\n\t\t\t@endResize=\"endResize\"\n\t\t\t@selectAll=\"selectAll\"\n\t\t\t@deselectAll=\"deselectAll\"\n\t\t/>\n\t\t<DialogFooter\n\t\t\tv-show=\"dialogFilled && !isDefaultState\"\n\t\t\tref=\"dialogFooter\"\n\t\t\t@reset=\"reset\"\n\t\t/>\n\t\t<div class=\"booking-booking-select-resources-workload-container\">\n\t\t\t<template v-for=\"resource of resources\">\n\t\t\t\t<span class=\"booking-booking-select-resources-workload\" :ref=\"(el) => setWorkloadRef(el, resource.id)\">\n\t\t\t\t\t<ResourceWorkload :resourceId=\"resource.id\"/>\n\t\t\t\t</span>\n\t\t\t</template>\n\t\t</div>\n\t`,\n};\n","import { mapGetters } from 'ui.vue3.vuex';\nimport { Model } from 'booking.const';\nimport { Resource } from './resource/resource';\nimport { AddResourceButton } from './add-resource-button/add-resource-button';\nimport { SelectResources } from './select-resources/select-resources';\nimport './header.css';\n\nexport const Header = {\n\tcomputed: mapGetters({\n\t\tresourcesIds: `${Model.Interface}/resourcesIds`,\n\t\tscroll: `${Model.Interface}/scroll`,\n\t\tisEditingBookingMode: `${Model.Interface}/isEditingBookingMode`,\n\t}),\n\twatch: {\n\t\tscroll(value): void\n\t\t{\n\t\t\tthis.$refs.inner.scrollLeft = value;\n\t\t},\n\t},\n\tcomponents: {\n\t\tResource,\n\t\tAddResourceButton,\n\t\tSelectResources,\n\t},\n\ttemplate: `\n\t\t<div class=\"booking-booking-header\">\n\t\t\t<SelectResources/>\n\t\t\t<div\n\t\t\t\tclass=\"booking-booking-header-inner\"\n\t\t\t\tref=\"inner\"\n\t\t\t\t@scroll=\"$store.dispatch('interface/setScroll', $refs.inner.scrollLeft)\"\n\t\t\t>\n\t\t\t\t<TransitionGroup name=\"booking-transition-resource\">\n\t\t\t\t\t<template v-for=\"resourceId of resourcesIds\" :key=\"resourceId\">\n\t\t\t\t\t\t<Resource :resourceId=\"resourceId\"/>\n\t\t\t\t\t</template>\n\t\t\t\t</TransitionGroup>\n\t\t\t\t<AddResourceButton v-if=\"!isEditingBookingMode\"/>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import { mapGetters } from 'ui.vue3.vuex';\nimport { Dialog, Item } from 'ui.entity-selector';\n\nimport { EntitySelectorEntity, EntitySelectorTab, Model } from 'booking.const';\nimport { limit } from 'booking.lib.limit';\nimport type { ResourceTypeModel } from 'booking.model.resource-types';\nimport type { ResourceModel } from 'booking.model.resources';\nimport './multiple.css';\n\nexport const Multiple = {\n\temits: [\n\t\t'change',\n\t],\n\tprops: {\n\t\tresourceId: {\n\t\t\ttype: Number,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tisSelected: false,\n\t\t\tselectedItems: [],\n\t\t};\n\t},\n\tmounted(): void\n\t{\n\t\tthis.selector = this.createSelector();\n\t},\n\tunmounted(): void\n\t{\n\t\tthis.selector.destroy();\n\t\tthis.selector = null;\n\t},\n\tmethods: {\n\t\tcreateSelector(): Dialog\n\t\t{\n\t\t\tconst selectedIds = this.intersections[this.resourceId] ?? [];\n\n\t\t\treturn new Dialog({\n\t\t\t\tid: `booking-intersection-selector-resource-${this.resourceId}`,\n\t\t\t\ttargetNode: this.$refs.intersectionField,\n\t\t\t\tpreselectedItems: selectedIds.map((id: number) => [EntitySelectorEntity.Resource, id]),\n\t\t\t\twidth: 400,\n\t\t\t\tenableSearch: true,\n\t\t\t\tdropdownMode: true,\n\t\t\t\tcontext: 'bookingResourceIntersection',\n\t\t\t\tmultiple: true,\n\t\t\t\tcacheable: true,\n\t\t\t\tshowAvatars: false,\n\t\t\t\tentities: [\n\t\t\t\t\t{\n\t\t\t\t\t\tid: EntitySelectorEntity.Resource,\n\t\t\t\t\t\tdynamicLoad: true,\n\t\t\t\t\t\tdynamicSearch: true,\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t\tsearchOptions: {\n\t\t\t\t\tallowCreateItem: false,\n\t\t\t\t\tfooterOptions: {\n\t\t\t\t\t\tlabel: this.loc('BOOKING_BOOKING_ADD_INTERSECTION_DIALOG_SEARCH_FOOTER'),\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\tevents: {\n\t\t\t\t\tonHide: this.changeSelected.bind(this),\n\t\t\t\t\tonLoad: this.changeSelected.bind(this),\n\t\t\t\t},\n\t\t\t});\n\t\t},\n\t\tshowSelector(): void\n\t\t{\n\t\t\tif (this.isFeatureEnabled)\n\t\t\t{\n\t\t\t\tthis.selector.show();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tvoid limit.show();\n\t\t\t}\n\t\t},\n\t\tchangeSelected(): void\n\t\t{\n\t\t\tthis.selectedItems = this.selector.getSelectedItems();\n\n\t\t\tthis.isSelected = this.selectedItems.length > 0;\n\n\t\t\tconst selectedIds = this.selectedItems.map((item) => item.id);\n\n\t\t\tthis.$emit('change', selectedIds, this.resourceId);\n\t\t},\n\t\thandleRemove(itemId: number): void\n\t\t{\n\t\t\tthis.selector.getItem([EntitySelectorEntity.Resource, itemId]).deselect();\n\n\t\t\tthis.changeSelected();\n\t\t},\n\t},\n\tcomputed: {\n\t\t...mapGetters({\n\t\t\tintersections: `${Model.Interface}/intersections`,\n\t\t\tisFeatureEnabled: `${Model.Interface}/isFeatureEnabled`,\n\t\t\tresources: `${Model.Resources}/get`,\n\t\t}),\n\t\tresourcesIds(): number[]\n\t\t{\n\t\t\treturn this.resources.map(({ id }) => id);\n\t\t},\n\t\tfirstItemTitle(): string\n\t\t{\n\t\t\treturn this.selectedItems.length > 0 ? this.selectedItems[0].title : '';\n\t\t},\n\t\tremainingItemsCount(): number\n\t\t{\n\t\t\treturn this.selectedItems.length > 1 ? this.selectedItems.length - 1 : 0;\n\t\t},\n\t},\n\twatch: {\n\t\tresourcesIds(resourcesIds: number[], previousResourcesIds: number[]): void\n\t\t{\n\t\t\tif (resourcesIds.join(',') === previousResourcesIds.join(','))\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst removedIds = previousResourcesIds.filter((id: number) => !resourcesIds.includes(id));\n\t\t\tconst newIds = resourcesIds.filter((id: number) => !previousResourcesIds.includes(id));\n\n\t\t\tremovedIds.forEach((id: number) => {\n\t\t\t\tconst item: Item = this.selector.getItem([EntitySelectorEntity.Resource, id]);\n\t\t\t\tthis.selector.removeItem(item);\n\t\t\t});\n\n\t\t\tnewIds.forEach((id: number) => {\n\t\t\t\tconst resource: ResourceModel = this.$store.getters[`${Model.Resources}/getById`](id);\n\t\t\t\tif (!resource || resource.isDeleted)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tconst resourceType: ResourceTypeModel = this.$store.getters[`${Model.ResourceTypes}/getById`](resource.typeId);\n\n\t\t\t\tthis.selector.addItem({\n\t\t\t\t\tid,\n\t\t\t\t\tentityId: EntitySelectorEntity.Resource,\n\t\t\t\t\ttitle: resource.name,\n\t\t\t\t\tsubtitle: resourceType.name,\n\t\t\t\t\ttabs: EntitySelectorTab.Recent,\n\t\t\t\t});\n\t\t\t});\n\n\t\t\tthis.changeSelected();\n\t\t},\n\t\tresources: {\n\t\t\thandler(): void\n\t\t\t{\n\t\t\t\tthis.selector.getItems().forEach((item: Item) => {\n\t\t\t\t\tconst resource: ResourceModel = this.$store.getters[`${Model.Resources}/getById`](item.getId());\n\t\t\t\t\tif (!resource)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tconst resourceType: ResourceTypeModel = this.$store.getters[`${Model.ResourceTypes}/getById`](resource.typeId);\n\n\t\t\t\t\titem.setTitle(resource.name);\n\t\t\t\t\titem.setSubtitle(resourceType.name);\n\t\t\t\t});\n\n\t\t\t\tthis.selector.getTagSelector().getTags().forEach((tag) => {\n\t\t\t\t\tconst resource: ResourceModel = this.$store.getters[`${Model.Resources}/getById`](tag.getId());\n\t\t\t\t\tif (!resource)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\ttag.setTitle(resource.name);\n\t\t\t\t\ttag.render();\n\t\t\t\t});\n\n\t\t\t\tthis.selectedItems = this.selector.getSelectedItems();\n\t\t\t},\n\t\t\tdeep: true,\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div\n\t\t\tref=\"intersectionField\"\n\t\t\tclass=\"booking-booking-intersections-resource\"\n\t\t\t:data-id=\"'booking-booking-intersections-resource-' + resourceId\"\n\t\t>\n\t\t\t<template v-if=\"isSelected\">\n\t\t\t\t<div\n\t\t\t\t\tref=\"selectorItemContainer\"\n\t\t\t\t\tclass=\"booking-booking-intersections-resource-container\"\n\t\t\t\t>\n\t\t\t\t\t<div\n\t\t\t\t\t\tv-if=\"selectedItems.length > 0\"\n\t\t\t\t\t\tclass=\"bbi-resource-selector-item bbi-resource-selector-tag\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<div class=\"bbi-resource-selector-tag-content\" :title=\"firstItemTitle\">\n\t\t\t\t\t\t\t<div class=\"bbi-resource-selector-tag-title\">{{ firstItemTitle }}</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div \n\t\t\t\t\t\t\tclass=\"bbi-resource-selector-tag-remove\"\n\t\t\t\t\t\t\t@click=\"handleRemove(selectedItems[0].id)\"\n\t\t\t\t\t\t\t:data-id=\"'bbi-resource-selector-tag-remove-' + resourceId\"\n\t\t\t\t\t\t></div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div\n\t\t\t\t\t\tv-if=\"remainingItemsCount > 0\"\n\t\t\t\t\t\tclass=\"bbi-resource-selector-item bbi-resource-selector-tag --count\"\n\t\t\t\t\t\t@click=\"showSelector\"\n\t\t\t\t\t\t:data-id=\"'bbi-resource-selector-tag-count-' + resourceId\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<div class=\"bbi-resource-selector-tag-content\">\n\t\t\t\t\t\t\t<div class=\"bbi-resource-selector-tag-title --count\">+{{ remainingItemsCount }}</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div>\n\t\t\t\t\t\t<span\n\t\t\t\t\t\t\tclass=\"bbi-resource-selector-item bbi-resource-selector-add-button\"\n\t\t\t\t\t\t\t@click=\"showSelector\"\n\t\t\t\t\t\t\t:data-id=\"'bbi-resource-selector-add-button' + resourceId\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<span class=\"bbi-resource-selector-add-button-caption\">\n\t\t\t\t\t\t\t\t{{ loc('BOOKING_BOOKING_INTERSECTION_BUTTON_MORE') }}\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t</span>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</template>\n\t\t\t<template v-else>\n\t\t\t\t<span\n\t\t\t\t\tref=\"selectorButton\"\n\t\t\t\t\tclass=\"bbi-resource-selector-item bbi-resource-selector-add-button\"\n\t\t\t\t\t@click=\"showSelector\"\n\t\t\t\t\t:data-id=\"'bbi-resource-selector-add-button' + resourceId\"\n\t\t\t\t>\n\t\t\t\t\t<span class=\"bbi-resource-selector-add-button-caption\">\n\t\t\t\t\t\t{{ loc('BOOKING_BOOKING_INTERSECTION_BUTTON_MSGVER_1') }}\n\t\t\t\t\t</span>\n\t\t\t\t</span>\n\t\t\t</template>\n\t\t</div>\n\t`,\n};\n","import { Event } from 'main.core';\nimport { mapGetters } from 'ui.vue3.vuex';\nimport { Item, TagSelector } from 'ui.entity-selector';\n\nimport { AhaMoment, EntitySelectorEntity, EntitySelectorTab, HelpDesk, Model } from 'booking.const';\nimport { ahaMoments } from 'booking.lib.aha-moments';\nimport { limit } from 'booking.lib.limit';\nimport type { ResourceModel } from 'booking.model.resources';\nimport type { ResourceTypeModel } from 'booking.model.resource-types';\nimport './single.css';\n\nexport const Single = {\n\temits: ['change'],\n\tcreated(): void\n\t{\n\t\tthis.selector = this.createSelector();\n\n\t\tif (!this.isFeatureEnabled)\n\t\t{\n\t\t\tthis.selector.lock();\n\t\t}\n\t},\n\tmounted(): void\n\t{\n\t\tthis.mountSelector();\n\n\t\tEvent.EventEmitter.subscribe('BX.Main.Popup:onAfterClose', this.tryShowAhaMoment);\n\t\tEvent.EventEmitter.subscribe('BX.Main.Popup:onDestroy', this.tryShowAhaMoment);\n\t},\n\tbeforeUnmount(): void\n\t{\n\t\tthis.destroySelector();\n\t},\n\tcomputed: {\n\t\t...mapGetters({\n\t\t\tisEditingBookingMode: `${Model.Interface}/isEditingBookingMode`,\n\t\t\tintersections: `${Model.Interface}/intersections`,\n\t\t\tisLoaded: `${Model.Interface}/isLoaded`,\n\t\t\tisFeatureEnabled: `${Model.Interface}/isFeatureEnabled`,\n\t\t\tresources: `${Model.Resources}/get`,\n\t\t}),\n\t\tresourcesIds(): number[]\n\t\t{\n\t\t\treturn this.resources.map(({ id }) => id);\n\t\t},\n\t},\n\tmethods: {\n\t\tcreateSelector(): TagSelector\n\t\t{\n\t\t\treturn new TagSelector({\n\t\t\t\tmultiple: true,\n\t\t\t\taddButtonCaption: this.loc('BOOKING_BOOKING_ADD_INTERSECTION_MSGVER_1'),\n\t\t\t\tshowCreateButton: false,\n\t\t\t\tmaxHeight: 50,\n\t\t\t\tdialogOptions: {\n\t\t\t\t\tcontext: 'bookingResourceIntersection',\n\t\t\t\t\twidth: 290,\n\t\t\t\t\theight: 340,\n\t\t\t\t\tdropdownMode: true,\n\t\t\t\t\tenableSearch: true,\n\t\t\t\t\tcacheable: true,\n\t\t\t\t\tshowAvatars: false,\n\t\t\t\t\tentities: [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tid: EntitySelectorEntity.Resource,\n\t\t\t\t\t\t\tdynamicLoad: true,\n\t\t\t\t\t\t\tdynamicSearch: true,\n\t\t\t\t\t\t},\n\t\t\t\t\t],\n\t\t\t\t\tsearchOptions: {\n\t\t\t\t\t\tallowCreateItem: false,\n\t\t\t\t\t\tfooterOptions: {\n\t\t\t\t\t\t\tlabel: this.loc('BOOKING_BOOKING_ADD_INTERSECTION_DIALOG_SEARCH_FOOTER'),\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\tevents: {\n\t\t\t\t\tonAfterTagAdd: this.onSelectorChange,\n\t\t\t\t\tonAfterTagRemove: this.onSelectorChange,\n\t\t\t\t},\n\t\t\t});\n\t\t},\n\t\tonSelectorChange(): void\n\t\t{\n\t\t\tconst selectedIds = this.selector.getDialog().getSelectedItems().map(({ id }) => id);\n\n\t\t\tthis.$emit('change', selectedIds);\n\t\t},\n\t\tmountSelector(): void\n\t\t{\n\t\t\tthis.selector.renderTo(this.$refs.intersectionField);\n\t\t},\n\t\tdestroySelector(): void\n\t\t{\n\t\t\tthis.selector.getDialog().destroy();\n\t\t\tthis.selector = null;\n\t\t\tthis.$refs.intersectionField.innerHTML = '';\n\t\t},\n\t\tgetResource(id: number): ResourceModel\n\t\t{\n\t\t\treturn this.$store.getters['resources/getById'](id);\n\t\t},\n\t\tgetResourceType(id: number): ResourceTypeModel\n\t\t{\n\t\t\treturn this.$store.getters['resourceTypes/getById'](id);\n\t\t},\n\t\ttryShowAhaMoment(): void\n\t\t{\n\t\t\tif (\n\t\t\t\tahaMoments.shouldShow(AhaMoment.ResourceIntersection)\n\t\t\t\t&& this.selector\n\t\t\t)\n\t\t\t{\n\t\t\t\tEvent.EventEmitter.unsubscribe('BX.Main.Popup:onAfterClose', this.tryShowAhaMoment);\n\t\t\t\tEvent.EventEmitter.unsubscribe('BX.Main.Popup:onDestroy', this.tryShowAhaMoment);\n\t\t\t\tvoid this.showAhaMoment();\n\t\t\t}\n\t\t},\n\t\tasync showAhaMoment(): Promise<void>\n\t\t{\n\t\t\tawait ahaMoments.show({\n\t\t\t\tid: 'booking-resource-intersection',\n\t\t\t\ttitle: this.loc('BOOKING_AHA_RESOURCE_INTERSECTION_TITLE'),\n\t\t\t\ttext: this.loc('BOOKING_AHA_RESOURCE_INTERSECTION_TEXT'),\n\t\t\t\tarticle: HelpDesk.AhaResourceIntersection,\n\t\t\t\ttarget: this.selector.getAddButton(),\n\t\t\t});\n\n\t\t\tahaMoments.setShown(AhaMoment.ResourceIntersection);\n\t\t},\n\t\tclick(): void\n\t\t{\n\t\t\tif (!this.isFeatureEnabled)\n\t\t\t{\n\t\t\t\tvoid limit.show();\n\t\t\t}\n\t\t},\n\t},\n\twatch: {\n\t\tintersections(intersections: Object): void\n\t\t{\n\t\t\tif (!this.isEditingBookingMode)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst resourcesIds = intersections[0] ?? [];\n\n\t\t\tresourcesIds.forEach((id: number): void => {\n\t\t\t\tconst resource = this.getResource(id);\n\n\t\t\t\tthis.selector.getDialog().addItem({\n\t\t\t\t\tid: resource.id,\n\t\t\t\t\tentityId: EntitySelectorEntity.Resource,\n\t\t\t\t\ttitle: resource.name,\n\t\t\t\t\tsubtitle: this.getResourceType(resource.typeId).name,\n\t\t\t\t\tselected: true,\n\t\t\t\t});\n\t\t\t});\n\t\t},\n\t\tisLoaded(): void\n\t\t{\n\t\t\tthis.tryShowAhaMoment();\n\t\t},\n\t\tresourcesIds(resourcesIds: number[], previousResourcesIds: number[]): void\n\t\t{\n\t\t\tif (resourcesIds.join(',') === previousResourcesIds.join(','))\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst removedIds = previousResourcesIds.filter((id: number) => !resourcesIds.includes(id));\n\t\t\tconst newIds = resourcesIds.filter((id: number) => !previousResourcesIds.includes(id));\n\n\t\t\tremovedIds.forEach((id: number) => {\n\t\t\t\tconst item: Item = this.selector.getDialog().getItem([EntitySelectorEntity.Resource, id]);\n\t\t\t\tthis.selector.getDialog().removeItem(item);\n\n\t\t\t\tconst tag = this.selector.getTags().find((it) => it.getId() === id);\n\t\t\t\ttag?.remove();\n\t\t\t});\n\n\t\t\tnewIds.forEach((id: number) => {\n\t\t\t\tconst resource: ResourceModel = this.$store.getters[`${Model.Resources}/getById`](id);\n\t\t\t\tif (!resource || resource.isDeleted)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tconst resourceType: ResourceTypeModel = this.$store.getters[`${Model.ResourceTypes}/getById`](resource.typeId);\n\n\t\t\t\tthis.selector.getDialog().addItem({\n\t\t\t\t\tid,\n\t\t\t\t\tentityId: EntitySelectorEntity.Resource,\n\t\t\t\t\ttitle: resource.name,\n\t\t\t\t\tsubtitle: resourceType.name,\n\t\t\t\t\ttabs: EntitySelectorTab.Recent,\n\t\t\t\t});\n\t\t\t});\n\n\t\t\tthis.onSelectorChange();\n\n\t\t\tthis.tryShowAhaMoment();\n\t\t},\n\t\tresources: {\n\t\t\thandler(): void\n\t\t\t{\n\t\t\t\tthis.selector.getDialog().getItems().forEach((item: Item) => {\n\t\t\t\t\tconst resource: ResourceModel = this.$store.getters[`${Model.Resources}/getById`](item.getId());\n\t\t\t\t\tif (!resource)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tconst resourceType: ResourceTypeModel = this.$store.getters[`${Model.ResourceTypes}/getById`](resource.typeId);\n\n\t\t\t\t\titem.setTitle(resource.name);\n\t\t\t\t\titem.setSubtitle(resourceType.name);\n\t\t\t\t});\n\n\t\t\t\tthis.selector.getTags().forEach((tag) => {\n\t\t\t\t\tconst resource: ResourceModel = this.$store.getters[`${Model.Resources}/getById`](tag.getId());\n\t\t\t\t\tif (!resource)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\ttag.setTitle(resource.name);\n\t\t\t\t\ttag.render();\n\t\t\t\t});\n\t\t\t},\n\t\t\tdeep: true,\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div\n\t\t\tref=\"intersectionField\"\n\t\t\tclass=\"booking-booking-intersections-line\"\n\t\t\tdata-id=\"booking-booking-intersections-line\"\n\t\t\t@click=\"click\"\n\t\t></div>\n\t`,\n};\n","import { Dom } from 'main.core';\nimport { MenuManager, MenuItem, MenuItemOptions } from 'main.popup';\n\nimport { mapGetters } from 'ui.vue3.vuex';\nimport { BIcon as Icon, Set as IconSet } from 'ui.icon-set.api.vue';\nimport 'ui.icon-set.main';\n\nimport { HelpDesk, Model, Option } from 'booking.const';\nimport { optionService } from 'booking.provider.service.option-service';\nimport { limit } from 'booking.lib.limit';\nimport { helpDesk } from 'booking.lib.help-desk';\nimport { busySlots } from 'booking.lib.busy-slots';\n\nimport { Multiple } from './multiple/multiple';\nimport { Single } from './single/single';\nimport './intersections.css';\n\nexport const Intersections = {\n\tcomponents: {\n\t\tIcon,\n\t\tMultiple,\n\t\tSingle,\n\t},\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tIconSet,\n\t\t\tintersectionModeMenuItemId: 'booking-intersection-menu-mode',\n\t\t};\n\t},\n\tmounted(): void\n\t{\n\t\tthis.menu = MenuManager.create(\n\t\t\t'booking-intersection-menu',\n\t\t\tthis.$refs.intersectionMenu,\n\t\t\tthis.getMenuItems(),\n\t\t\t{\n\t\t\t\tcloseByEsc: true,\n\t\t\t\tautoHide: true,\n\t\t\t\tcacheable: true,\n\t\t\t},\n\t\t);\n\t},\n\tunmounted(): void\n\t{\n\t\tthis.menu.destroy();\n\t\tthis.menu = null;\n\t},\n\tmethods: {\n\t\tshowMenu(): void\n\t\t{\n\t\t\tif (this.isFeatureEnabled)\n\t\t\t{\n\t\t\t\tthis.menu.show();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tvoid limit.show();\n\t\t\t}\n\t\t},\n\t\tgetMenuItems(): MenuItemOptions[]\n\t\t{\n\t\t\treturn [\n\t\t\t\tthis.getIntersectionForAllItem(),\n\t\t\t\t{\n\t\t\t\t\tdelimiter: true,\n\t\t\t\t},\n\t\t\t\tthis.getHelpDeskItem(),\n\t\t\t];\n\t\t},\n\t\tgetIntersectionForAllItem(): MenuItemOptions\n\t\t{\n\t\t\treturn {\n\t\t\t\tid: this.intersectionModeMenuItemId,\n\t\t\t\tdataset: {\n\t\t\t\t\tid: this.intersectionModeMenuItemId,\n\t\t\t\t},\n\t\t\t\ttext: this.loc('BOOKING_BOOKING_INTERSECTION_MENU_ALL'),\n\t\t\t\tclassName: this.isIntersectionForAll\n\t\t\t\t\t? 'menu-popup-item menu-popup-item-accept'\n\t\t\t\t\t: 'menu-popup-item menu-popup-no-icon',\n\t\t\t\tonclick: () => {\n\t\t\t\t\tthis.menu.close();\n\n\t\t\t\t\tconst value = !this.isIntersectionForAll;\n\n\t\t\t\t\tvoid this.$store.dispatch(`${Model.Interface}/setIntersectionMode`, value);\n\t\t\t\t\tvoid optionService.setBool(Option.IntersectionForAll, value);\n\t\t\t\t},\n\t\t\t};\n\t\t},\n\t\tgetHelpDeskItem(): MenuItemOptions\n\t\t{\n\t\t\treturn {\n\t\t\t\tid: 'booking-intersection-menu-info',\n\t\t\t\tdataset: {\n\t\t\t\t\tid: 'booking-intersection-menu-info',\n\t\t\t\t},\n\t\t\t\ttext: this.loc('BOOKING_BOOKING_INTERSECTION_MENU_HOW'),\n\t\t\t\tonclick: () => {\n\t\t\t\t\thelpDesk.show(\n\t\t\t\t\t\tHelpDesk.Intersection.code,\n\t\t\t\t\t\tHelpDesk.Intersection.anchorCode,\n\t\t\t\t\t);\n\t\t\t\t},\n\t\t\t};\n\t\t},\n\t\tasync showIntersections(selectedResourceIds: number[], resourceId: number = 0): void\n\t\t{\n\t\t\tconst intersections = {\n\t\t\t\t...(resourceId === 0 ? {} : this.intersections),\n\t\t\t\t[resourceId]: selectedResourceIds,\n\t\t\t};\n\n\t\t\tawait this.$store.dispatch(`${Model.Interface}/setIntersections`, intersections);\n\n\t\t\tawait busySlots.loadBusySlots();\n\t\t},\n\t\ttoggleMenuItemActivityState(item: MenuItem): void\n\t\t{\n\t\t\tDom.toggleClass(item.getContainer(), 'menu-popup-item-accept');\n\t\t\tDom.toggleClass(item.getContainer(), 'menu-popup-no-icon');\n\t\t},\n\t\tupdateScroll(): void\n\t\t{\n\t\t\tif (this.$refs.inner)\n\t\t\t{\n\t\t\t\tthis.$refs.inner.scrollLeft = this.scroll;\n\t\t\t}\n\t\t},\n\t},\n\twatch: {\n\t\tasync isIntersectionForAll(): void\n\t\t{\n\t\t\tawait this.$store.dispatch(`${Model.Interface}/setIntersections`, {});\n\n\t\t\tthis.updateScroll();\n\n\t\t\tawait busySlots.loadBusySlots();\n\n\t\t\tthis.toggleMenuItemActivityState(\n\t\t\t\tthis.menu.getMenuItem(this.intersectionModeMenuItemId),\n\t\t\t);\n\t\t},\n\t\tscroll(): void\n\t\t{\n\t\t\tthis.updateScroll();\n\t\t},\n\t},\n\tcomputed: {\n\t\t...mapGetters({\n\t\t\tresourcesIds: `${Model.Interface}/resourcesIds`,\n\t\t\tisFilterMode: `${Model.Filter}/isFilterMode`,\n\t\t\tisEditingBookingMode: `${Model.Interface}/isEditingBookingMode`,\n\t\t\tintersections: `${Model.Interface}/intersections`,\n\t\t\tisIntersectionForAll: `${Model.Interface}/isIntersectionForAll`,\n\t\t\tscroll: `${Model.Interface}/scroll`,\n\t\t\tisLoaded: `${Model.Interface}/isLoaded`,\n\t\t\tisFeatureEnabled: `${Model.Interface}/isFeatureEnabled`,\n\t\t}),\n\t\thasIntersections(): boolean\n\t\t{\n\t\t\treturn Object.values(this.intersections).some((resourcesIds: number[]) => resourcesIds.length > 0);\n\t\t},\n\t\tdisabled(): boolean\n\t\t{\n\t\t\treturn !this.isLoaded || this.isFilterMode || this.isEditingBookingMode;\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"booking-booking-intersections\" :class=\"{'--disabled': disabled}\">\n\t\t\t<div\n\t\t\t\tref=\"intersectionMenu\"\n\t\t\t\tclass=\"booking-booking-intersections-left-panel\"\n\t\t\t\t:class=\"{'--active': hasIntersections}\"\n\t\t\t\t@click=\"showMenu\"\n\t\t\t\tdata-id=\"booking-intersections-left-panel-menu\"\n\t\t\t>\n\t\t\t\t<div class=\"ui-icon-set --double-rhombus\"></div>\n\t\t\t\t<div v-if=\"!isFeatureEnabled\" class=\"booking-lock-icon-container\">\n\t\t\t\t\t<Icon :name=\"IconSet.LOCK\"/>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<Single v-if=\"isIntersectionForAll\" @change=\"showIntersections\"/>\n\t\t\t<template v-else>\n\t\t\t\t<div\n\t\t\t\t\tref=\"inner\"\n\t\t\t\t\tclass=\"booking-booking-intersections-inner\"\n\t\t\t\t\t@scroll=\"$store.dispatch('interface/setScroll', $refs.inner.scrollLeft)\"\n\t\t\t\t>\n\t\t\t\t\t<div class=\"booking-booking-intersections-row\">\n\t\t\t\t\t\t<div class=\"booking-booking-intersections-row-inner\">\n\t\t\t\t\t\t\t<template v-for=\"resourceId of resourcesIds\" :key=\"resourceId\">\n\t\t\t\t\t\t\t\t<Multiple :resourceId=\"resourceId\" @change=\"showIntersections\"/>\n\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"booking-booking-intersections-inner-blank\"></div>\n\t\t\t\t</div>\n\t\t\t</template>\n\t\t</div>\n\t`,\n};\n","import { DateTimeFormat } from 'main.date';\nimport { mapGetters } from 'ui.vue3.vuex';\n\nimport { Grid } from '../grid/grid';\nimport { Header } from '../header/header';\nimport { Intersections } from '../intersections/intersections';\nimport './base-component.css';\n\nconst timeFormat = DateTimeFormat.getFormat('SHORT_TIME_FORMAT');\n\n// @vue/component\nexport const BaseComponent = {\n\tname: 'BaseComponent',\n\tcomponents: {\n\t\tHeader,\n\t\tIntersections,\n\t\tGrid,\n\t},\n\tcomputed: {\n\t\t...mapGetters({\n\t\t\tfromHour: 'interface/fromHour',\n\t\t\ttoHour: 'interface/toHour',\n\t\t\tzoom: 'interface/zoom',\n\t\t}),\n\t\tisAmPmMode(): boolean\n\t\t{\n\t\t\tif (DateTimeFormat.isAmPmMode())\n\t\t\t{\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\tconst now: string = DateTimeFormat.format(timeFormat, Date.now());\n\n\t\t\treturn now.endsWith('am') || now.endsWith('pm');\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div\n\t\t\tid=\"booking-content\"\n\t\t\tclass=\"booking --ui-context-content-light\"\n\t\t\t:style=\"{\n\t\t\t\t'--from-hour': fromHour,\n\t\t\t\t'--to-hour': toHour,\n\t\t\t\t'--zoom': zoom,\n\t\t\t}\"\n\t\t\t:class=\"{\n\t\t\t\t'--zoom-is-less-than-07': zoom < 0.7,\n\t\t\t\t'--zoom-is-less-than-08': zoom < 0.8,\n\t\t\t\t'--am-pm-mode': isAmPmMode,\n\t\t\t}\"\n\t\t>\n\t\t\t<Header/>\n\t\t\t<Intersections/>\n\t\t\t<Grid/>\n\t\t</div>\n\t`,\n};\n","import { Button as UiButton, ButtonSize, ButtonColor } from 'booking.component.button';\n\nexport const BookingMultipleButton = {\n\tname: 'BookingMultipleButton',\n\temits: ['book'],\n\tprops: {\n\t\tfetching: Boolean,\n\t},\n\tcomputed: {\n\t\ttext(): string\n\t\t{\n\t\t\treturn this.loc('BOOKING_MULTI_BUTTON_LABEL');\n\t\t},\n\t\tsize(): string\n\t\t{\n\t\t\treturn ButtonSize.SMALL;\n\t\t},\n\t\tcolor(): string\n\t\t{\n\t\t\treturn ButtonColor.SUCCESS;\n\t\t},\n\t},\n\tcomponents: {\n\t\tUiButton,\n\t},\n\ttemplate: `\n\t\t<UiButton\n\t\t\t:text\n\t\t\t:size\n\t\t\t:color\n\t\t\t:waiting=\"fetching\"\n\t\t\t@click=\"$emit('book')\"\n\t\t/>\n\t`,\n};\n","// @vue/component\n\nimport { DateTimeFormat } from 'main.date';\nimport { mapGetters } from 'ui.vue3.vuex';\n\nimport { Model } from 'booking.const';\nimport { Button as UiButton, ButtonSize, ButtonColor } from 'booking.component.button';\nimport { Duration } from 'booking.lib.duration';\n\nexport const MultiBookingItem = {\n\tname: 'MultiBookingItem',\n\tcomponents: {\n\t\tUiButton,\n\t},\n\temits: ['remove-selected'],\n\tprops: {\n\t\tid: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t\tfromTs: {\n\t\t\ttype: Number,\n\t\t\trequired: true,\n\t\t},\n\t\ttoTs: {\n\t\t\ttype: Number,\n\t\t\trequired: true,\n\t\t},\n\t\tresourceId: {\n\t\t\ttype: Number,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tcomputed: {\n\t\t...mapGetters({\n\t\t\toffset: `${Model.Interface}/offset`,\n\t\t}),\n\t\tlabel(): string\n\t\t{\n\t\t\treturn this.loc('BOOKING_MULTI_ITEM_TITLE', {\n\t\t\t\t'#DATE#': DateTimeFormat.format('d M H:i', (this.fromTs + this.offset) / 1000),\n\t\t\t\t'#DURATION#': new Duration(this.toTs - this.fromTs).format(),\n\t\t\t});\n\t\t},\n\t\tbuttonColor(): string\n\t\t{\n\t\t\treturn ButtonColor.LINK;\n\t\t},\n\t\tbuttonSize(): string\n\t\t{\n\t\t\treturn ButtonSize.EXTRA_SMALL;\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"booking--multi-booking--book\">\n\t\t\t<label>\n\t\t\t\t{{ label }}\n\t\t\t</label>\n\t\t\t<button\n\t\t\t\t:class=\"[buttonSize, buttonColor, 'ui-btn ui-icon-set --cross-20']\"\n\t\t\t\ttype=\"button\"\n\t\t\t\t@click=\"$emit('remove-selected', this.id)\">\n\t\t\t</button>\n\t\t</div>\n\t`,\n};\n","// @vue/component\n\nimport { Ears } from 'ui.ears';\nimport { Model } from 'booking.const';\nimport { MultiBookingItem } from './multi-booking-item';\nimport './multi-booking-items-list.css';\n\nexport const MultiBookingItemsList = {\n\tname: 'MultiBookingItemsList',\n\tcomponents: {\n\t\tMultiBookingItem,\n\t},\n\temits: ['remove-selected'],\n\tcomputed: {\n\t\tselectedCells(): Object\n\t\t{\n\t\t\treturn this.$store.getters[`${Model.Interface}/selectedCells`];\n\t\t},\n\t\tselectedCellsCount(): number\n\t\t{\n\t\t\treturn Object.keys(this.selectedCells).length;\n\t\t},\n\t},\n\tmounted()\n\t{\n\t\tthis.ears = new Ears({\n\t\t\tcontainer: this.$refs.wrapper,\n\t\t\tsmallSize: true,\n\t\t\tclassName: 'booking--multi-booking--items-ears',\n\t\t\tnoScrollbar: true,\n\t\t}).init();\n\t},\n\twatch: {\n\t\tselectedCellsCount: {\n\t\t\thandler(): void\n\t\t\t{\n\t\t\t\tsetTimeout(() => this.ears.toggleEars(), 0);\n\t\t\t},\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"booking--multi-booking--book-list\">\n\t\t\t<div ref=\"wrapper\" class=\"booking--multi-booking--books-wrapper\">\n\t\t\t\t<MultiBookingItem\n\t\t\t\t\tv-for=\"cell in selectedCells\"\n\t\t\t\t\t:key=\"cell.id\"\n\t\t\t\t\t:id=\"cell.id\"\n\t\t\t\t\t:from-ts=\"cell.fromTs\"\n\t\t\t\t\t:to-ts=\"cell.toTs\"\n\t\t\t\t\t:resource-id=\"cell.resourceId\"\n\t\t\t\t\t@remove-selected=\"$emit('remove-selected', $event)\"/>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import { mapGetters } from 'ui.vue3.vuex';\nimport { ButtonSize, ButtonColor } from 'booking.component.button';\nimport { ClientPopup } from 'booking.component.client-popup';\nimport type { CurrentClient } from 'booking.component.client-popup';\nimport { CrmEntity, Model } from 'booking.const';\nimport type { ClientModel } from 'booking.model.clients';\n\nexport const AddClientButton = {\n\tname: 'AddClientButton',\n\temits: ['update:model-value'],\n\tprops: {\n\t\tmodelValue: {\n\t\t\ttype: Array,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tdata(): { isPopupShown: boolean }\n\t{\n\t\treturn {\n\t\t\tisPopupShown: false,\n\t\t};\n\t},\n\tcomputed:\n\t\t{\n\t\t\t...mapGetters({\n\t\t\t\tgetByClientData: `${Model.Clients}/getByClientData`,\n\t\t\t}),\n\t\t\tcolor(): string\n\t\t\t{\n\t\t\t\treturn ButtonColor.LINK;\n\t\t\t},\n\t\t\tsize(): string\n\t\t\t{\n\t\t\t\treturn ButtonSize.EXTRA_SMALL;\n\t\t\t},\n\t\t\tlabel(): string\n\t\t\t{\n\t\t\t\tif (this.modelValue.length === 0)\n\t\t\t\t{\n\t\t\t\t\treturn this.loc('BOOKING_MULTI_CLIENT');\n\t\t\t\t}\n\n\t\t\t\treturn this.loc('BOOKING_MULTI_CLIENT_WHIT_NAME', {\n\t\t\t\t\t'#NAME#': this.modelValue.find((client) => client.name)?.name || '',\n\t\t\t\t});\n\t\t\t},\n\t\t\tcurrentClient(): CurrentClient | null\n\t\t\t{\n\t\t\t\tif (this.modelValue.length === 0)\n\t\t\t\t{\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\n\t\t\t\treturn {\n\t\t\t\t\tcontact: this.findClientByType(CrmEntity.Contact),\n\t\t\t\t\tcompany: this.findClientByType(CrmEntity.Company),\n\t\t\t\t};\n\t\t\t},\n\t\t},\n\tmethods: {\n\t\tcreateClients(clients: Object[])\n\t\t{\n\t\t\tconst clientsData = clients.map((client) => this.getByClientData(client));\n\t\t\tthis.$emit('update:model-value', clientsData);\n\t\t},\n\t\tfindClientByType(clientTypeCode: string): ClientModel\n\t\t{\n\t\t\treturn this.modelValue.find(({ type }) => type.code === clientTypeCode);\n\t\t},\n\t},\n\tcomponents: {\n\t\tClientPopup,\n\t},\n\ttemplate: `\n\t\t<button\n\t\t\t:class=\"['ui-btn', 'booking--multi-booking--client-button', color, size]\"\n\t\t\ttype=\"button\"\n\t\t\tref=\"button\"\n\t\t\t@click=\"isPopupShown = !isPopupShown\"\n\t\t>\n\t\t\t<i class=\"ui-icon-set --customer-card\"></i>\n\t\t\t<span>{{ label }}</span>\n\t\t</button>\n\t\t<ClientPopup\n\t\t\tv-if=\"isPopupShown\"\n\t\t\t:bind-element=\"$refs.button\"\n\t\t\t:currentClient\n\t\t\t@create=\"createClients\"\n\t\t\t@close=\"isPopupShown = false\"/>\n\t`,\n};\n","import { ButtonSize, ButtonColor } from 'booking.component.button';\nimport './cancel-button.css';\n\ntype CancelButtonOptions = {\n\tcolor: string,\n\tsize: string,\n};\n\nexport const CancelButton = {\n\tname: 'CancelButton',\n\temits: ['click'],\n\tsetup(): CancelButtonOptions\n\t{\n\t\treturn {\n\t\t\tcolor: ButtonColor.LINK,\n\t\t\tsize: ButtonSize.EXTRA_SMALL,\n\t\t};\n\t},\n\ttemplate: `\n\t\t<button\n\t\t\t:class=\"['ui-btn', 'booking--multi-booking--cancel-button', color, size]\"\n\t\t\ttype=\"button\"\n\t\t\tref=\"button\"\n\t\t\t@click=\"$emit('click')\"\n\t\t>\n\t\t\t<i\n\t\t\t\tclass=\"ui-icon-set --cross-25\"\n\t\t\t\tstyle=\"--ui-icon-set__icon-base-color: rgba(var(--ui-color-palette-white-base-rgb), 0.3);--ui-icon-set__icon-size: var(--ui-size-2xl)\"></i>\n\t\t</button>\n\t`,\n};\n","import { Loc, Text } from 'main.core';\nimport { mapGetters } from 'ui.vue3.vuex';\n\nimport { Model, CrmEntity } from 'booking.const';\nimport { bookingService } from 'booking.provider.service.booking-service';\nimport { clientService } from 'booking.provider.service.client-service';\nimport { BookingAnalytics } from 'booking.lib.analytics';\nimport type { BookingModel, DealData } from 'booking.model.bookings';\nimport type { ClientModel } from 'booking.model.clients';\n\nimport { BookingMultipleButton } from './booking-multiple-button/booking-multiple-button';\nimport { MultiBookingItemsList } from './multi-booking-items-list/multi-booking-items-list';\nimport { AddClientButton } from './add-client-button/add-client-button';\nimport { CancelButton } from './cancel-button/cancel-button';\nimport './multi-booking.css';\n\nexport const MultiBooking = {\n\tname: 'MultiBooking',\n\tdata(): { fetching: boolean, clients: ClientModel[] }\n\t{\n\t\treturn {\n\t\t\tfetching: false,\n\t\t\tclients: [],\n\t\t\texternalData: [],\n\t\t};\n\t},\n\tasync beforeMount()\n\t{\n\t\tthis.clients = [];\n\t\tthis.externalData = [];\n\n\t\tif (this.embedItems.length === 0)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst embedContact = this.embedItems.find((item: DealData) => item.entityTypeId === CrmEntity.Contact);\n\t\tconst embedCompany = this.embedItems.find((item: DealData) => item.entityTypeId === CrmEntity.Company);\n\t\tconst embedDeal = this.embedItems.find((item: DealData) => item.entityTypeId === CrmEntity.Deal);\n\n\t\tif (embedContact)\n\t\t{\n\t\t\tconst contact = await clientService.getContactById(Number(embedContact.value));\n\n\t\t\tif (contact)\n\t\t\t{\n\t\t\t\tthis.clients.push(contact);\n\t\t\t}\n\t\t}\n\n\t\tif (embedCompany)\n\t\t{\n\t\t\tconst company = await clientService.getCompanyById(Number(embedCompany.value));\n\n\t\t\tif (company)\n\t\t\t{\n\t\t\t\tthis.clients.push(company);\n\t\t\t}\n\t\t}\n\n\t\tif (embedDeal)\n\t\t{\n\t\t\tthis.externalData.push(embedDeal);\n\t\t}\n\t},\n\tcomputed: {\n\t\t...mapGetters({\n\t\t\tselectedCells: `${Model.Interface}/selectedCells`,\n\t\t\ttimezone: `${Model.Interface}/timezone`,\n\t\t\tembedItems: `${Model.Interface}/embedItems`,\n\t\t\tintersections: `${Model.Interface}/intersections`,\n\t\t}),\n\t},\n\tmethods: {\n\t\tremoveSelected(id: string): void\n\t\t{\n\t\t\tif (Object.hasOwnProperty.call(this.selectedCells, id))\n\t\t\t{\n\t\t\t\tthis.$store.dispatch(`${Model.Interface}/removeSelectedCell`, this.selectedCells[id]);\n\t\t\t}\n\t\t},\n\t\tasync book(): void\n\t\t{\n\t\t\tconst bookings = this.getBookings();\n\t\t\tif (bookings.length === 0)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.fetching = true;\n\t\t\tconst bookingList = await bookingService.addList(bookings);\n\t\t\tBookingAnalytics.sendAddMultiBookings(bookingList.map(({ id }) => id));\n\t\t\tthis.fetching = false;\n\n\t\t\tthis.showNotification(bookingList);\n\n\t\t\tawait this.closeMultiBooking();\n\t\t},\n\t\tgetBookings(): BookingModel[]\n\t\t{\n\t\t\treturn Object.values(this.selectedCells).map((cell) => ({\n\t\t\t\tid: `tmp-id-${Date.now()}-${Math.random()}`,\n\t\t\t\tdateFromTs: cell.fromTs,\n\t\t\t\tdateToTs: cell.toTs,\n\t\t\t\tresourcesIds: [...new Set([\n\t\t\t\t\tcell.resourceId,\n\t\t\t\t\t...(this.intersections[0] ?? []),\n\t\t\t\t\t...(this.intersections[cell.resourceId] ?? []),\n\t\t\t\t])],\n\t\t\t\ttimezoneFrom: this.timezone,\n\t\t\t\ttimezoneTo: this.timezone,\n\t\t\t\texternalData: this.externalData,\n\t\t\t\tclients: this.clients,\n\t\t\t}));\n\t\t},\n\t\tshowNotification(bookingList)\n\t\t{\n\t\t\tconst bookingQuantity = bookingList.length;\n\n\t\t\tconst balloon = BX.UI.Notification.Center.notify({\n\t\t\t\tid: Text.getRandom(),\n\t\t\t\tcontent: Loc.getMessagePlural('BOOKING_MULTI_CREATED', bookingQuantity, {\n\t\t\t\t\t'#QUANTITY#': bookingQuantity,\n\t\t\t\t}),\n\t\t\t\tactions: [\n\t\t\t\t\t{\n\t\t\t\t\t\ttitle: this.loc('BOOKING_MULTI_CREATED_CANCEL'),\n\t\t\t\t\t\tevents: {\n\t\t\t\t\t\t\tclick: () => this.reset(bookingList, balloon),\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t});\n\t\t},\n\t\tasync reset(bookingList, balloon): Promise<void>\n\t\t{\n\t\t\tawait bookingService.deleteList(bookingList.map(({ id }) => id));\n\t\t\tballoon?.close();\n\t\t},\n\t\tasync closeMultiBooking()\n\t\t{\n\t\t\tawait this.$store.dispatch(`${Model.Interface}/clearSelectedCells`);\n\t\t},\n\t},\n\tcomponents: {\n\t\tBookingMultipleButton,\n\t\tMultiBookingItemsList,\n\t\tAddClientButton,\n\t\tCancelButton,\n\t},\n\ttemplate: `\n\t\t<Teleport to=\"#uiToolbarContainer\" defer>\n\t\t\t<div class=\"booking--multi-booking--bar\">\n\t\t\t\t<BookingMultipleButton :fetching @book=\"book\"/>\n\t\t\t\t<MultiBookingItemsList @remove-selected=\"removeSelected\"/>\n\t\t\t\t<div class=\"booking--multi-booking--divider-vertical\"></div>\n\t\t\t\t<AddClientButton v-model=\"clients\"/>\n\t\t\t\t<div class=\"booking--multi-booking--space\"></div>\n\t\t\t\t<div class=\"booking--multi-booking--close\">\n\t\t\t\t\t<div class=\"booking--multi-booking--divider-vertical\"></div>\n\t\t\t\t\t<CancelButton @click=\"closeMultiBooking\"/>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</Teleport>\n\t`,\n};\n","import { Runtime } from 'main.core';\nimport { shallowRef } from 'ui.vue3';\nimport { mapGetters } from 'ui.vue3.vuex';\nimport { BannerDispatcher } from 'ui.banner-dispatcher';\n\nimport { AhaMoment, Model } from 'booking.const';\nimport { Resolvable } from 'booking.lib.resolvable';\nimport { ahaMoments } from 'booking.lib.aha-moments';\nimport { BannerAnalytics } from 'booking.lib.analytics';\n\nexport const Banner = {\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tisBannerShown: false,\n\t\t\tbannerComponent: null,\n\t\t};\n\t},\n\tcomputed: {\n\t\t...mapGetters({\n\t\t\tcanTurnOnDemo: `${Model.Interface}/canTurnOnDemo`,\n\t\t}),\n\t},\n\tmounted(): void\n\t{\n\t\tif (ahaMoments.shouldShow(AhaMoment.Banner))\n\t\t{\n\t\t\tvoid this.showBanner();\n\t\t}\n\t},\n\tmethods: {\n\t\tasync showBanner(): Promise<void>\n\t\t{\n\t\t\tBannerDispatcher.critical.toQueue(async (onDone) => {\n\t\t\t\tconst { PromoBanner } = await Runtime.loadExtension('booking.component.promo-banner');\n\n\t\t\t\tthis.bannerComponent = shallowRef(PromoBanner);\n\t\t\t\tthis.isBannerShown = true;\n\t\t\t\tthis.setShown();\n\n\t\t\t\tthis.bannerClosed = new Resolvable();\n\t\t\t\tawait this.bannerClosed;\n\n\t\t\t\tonDone();\n\t\t\t});\n\t\t},\n\t\tcloseBanner(): void\n\t\t{\n\t\t\tthis.isBannerShown = false;\n\t\t\tthis.bannerClosed.resolve();\n\t\t},\n\t\tsetShown(): void\n\t\t{\n\t\t\tahaMoments.setShown(AhaMoment.Banner);\n\t\t\tBannerAnalytics.sendShowPopup();\n\t\t},\n\t\tbuttonClick(): void\n\t\t{\n\t\t\tBannerAnalytics.sendClickEnable();\n\t\t},\n\t},\n\ttemplate: `\n\t\t<component\n\t\t\tv-if=\"isBannerShown\"\n\t\t\t:is=\"bannerComponent\"\n\t\t\t:canTurnOnDemo=\"canTurnOnDemo\"\n\t\t\t@buttonClick=\"buttonClick\"\n\t\t\t@close=\"closeBanner\"\n\t\t/>\n\t`,\n};\n","import { AutoLauncher } from 'ui.auto-launch';\nimport { mapGetters } from 'ui.vue3.vuex';\nimport { Runtime } from 'main.core';\nimport { shallowRef } from 'ui.vue3';\nimport { BannerDispatcher } from 'ui.banner-dispatcher';\n\nimport { Resolvable } from 'booking.lib.resolvable';\nimport { AhaMoment, Model } from 'booking.const';\nimport { ahaMoments } from 'booking.lib.aha-moments';\n\nexport const Trial = {\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tisBannerShown: false,\n\t\t\tbannerComponent: null,\n\t\t};\n\t},\n\twatch: {\n\t\tisShownTrialPopup(): void\n\t\t{\n\t\t\tif (ahaMoments.shouldShow(AhaMoment.TrialBanner))\n\t\t\t{\n\t\t\t\tif (!AutoLauncher.isEnabled())\n\t\t\t\t{\n\t\t\t\t\tAutoLauncher.enable();\n\t\t\t\t}\n\n\t\t\t\tvoid this.showBanner();\n\t\t\t}\n\t\t},\n\t},\n\tcomputed: {\n\t\t...mapGetters({\n\t\t\tisShownTrialPopup: `${Model.Interface}/isShownTrialPopup`,\n\t\t}),\n\t},\n\tmethods: {\n\t\tasync showBanner(): Promise<void>\n\t\t{\n\t\t\tBannerDispatcher.critical.toQueue(async (onDone) => {\n\t\t\t\tconst { TrialBanner } = await Runtime.loadExtension('booking.component.trial-banner');\n\n\t\t\t\tthis.bannerComponent = shallowRef(TrialBanner);\n\t\t\t\tthis.isBannerShown = true;\n\n\t\t\t\tthis.bannerClosed = new Resolvable();\n\t\t\t\tawait this.bannerClosed;\n\n\t\t\t\tonDone();\n\t\t\t});\n\t\t},\n\t\tcloseBanner(): void\n\t\t{\n\t\t\tthis.isBannerShown = false;\n\n\t\t\tahaMoments.setShown(AhaMoment.TrialBanner);\n\n\t\t\tthis.bannerClosed.resolve();\n\t\t},\n\t},\n\ttemplate: `\n\t\t<component v-if=\"isBannerShown\" :is=\"bannerComponent\" @close=\"closeBanner\"/>\n\t`,\n};\n","import { HelpDeskLoc } from 'booking.component.help-desk-loc';\nimport { HelpDesk } from 'booking.const';\nimport './crm-forms-popup-layout.css';\n\n// @vue/component\nexport const CrmFormsPopupLayout = {\n\tname: 'CrmFormsPopupLayout',\n\tcomponents: {\n\t\tHelpDeskLoc,\n\t},\n\tsetup(): Object\n\t{\n\t\tconst helpDesk = HelpDesk.CrmFormsPopup;\n\n\t\treturn {\n\t\t\thelpDesk,\n\t\t};\n\t},\n\ttemplate: `\n\t\t<div class=\"booking--booking--crm-forms-popup__wrapper\">\n\t\t\t<div class=\"booking--booking--crm-forms-popup__header\">\n\t\t\t\t<span class=\"booking--booking--crm-forms-popup__header-title\">\n\t\t\t\t\t{{ loc('BOOKING_OPEN_CRM_FORMS_POPUP_TITLE') }}\n\t\t\t\t</span>\n\t\t\t\t<div class=\"booking--booking--crm-forms-popup__header-description\">\n\t\t\t\t\t<HelpDeskLoc\n\t\t\t\t\t\t:message=\"loc('BOOKING_OPEN_CRM_FORMS_POPUP_DESCRIPTION')\"\n\t\t\t\t\t\t:code=\"helpDesk.code\"\n\t\t\t\t\t\t:anchor=\"helpDesk.anchorCode\"\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div class=\"booking--booking--crm-forms-popup__toolbar\">\n\t\t\t\t<slot name=\"toolbar\"/>\n\t\t\t</div>\n\t\t\t<div class=\"booking--booking-crm-forms-popup__list-wrapper\">\n\t\t\t\t<slot/>\n\t\t\t</div>\n\t\t\t<div class=\"booking--booking-crm-forms-popup__footer\">\n\t\t\t\t<slot name=\"footer\"/>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import './crm-form-item-skeleton.css';\n\n// @vue/component\nexport const CrmFormItemSkeleton = {\n\tname: 'CrmFormItemSkeleton',\n\ttemplate: `\n\t\t<div class=\"booking--booking--crm-forms-popup--item-skeleton\">\n\t\t\t<div class=\"booking--booking--crm-forms-popup--item-skeleton__circle\"></div>\n\t\t\t<div class=\"booking--booking--crm-forms-popup--item-skeleton__line\"></div>\n\t\t\t<div class=\"booking--booking--crm-forms-popup--item-skeleton__space\"></div>\n\t\t\t<div class=\"booking--booking--crm-forms-popup--item-skeleton__line --thin\"></div>\n\t\t\t<div class=\"booking--booking--crm-forms-popup--item-skeleton__circle\"></div>\n\t\t</div>\n\t`,\n};\n","import { CrmFormItemSkeleton } from './crm-form-item-skeleton/crm-form-item-skeleton';\nimport './crm-form-list-empty.css';\n\n// @vue/component\nexport const CrmFormListEmpty = {\n\tname: 'CrmFormListEmpty',\n\tcomponents: {\n\t\tCrmFormItemSkeleton,\n\t},\n\ttemplate: `\n\t\t<CrmFormItemSkeleton v-for=\"i in 4\" :key=\"i\"/>\n\t\t<div class=\"booking--booking--crm-forms-popup--list__placeholder-bg\"></div>\n\t\t<div class=\"booking--booking--crm-forms-popup--list__placeholder\">\n\t\t\t<span>{{ loc('BOOKING_OPEN_CRM_FORMS_POPUP_FORMS_LIST_PLACEHOLDER') }}</span>\n\t\t</div>\n\t`,\n};\n","import { h } from 'ui.vue3';\n\nfunction CrmFormsListItemNameLink(props: CrmFormsListItemNameLinkProps, { slots }): Object\n{\n\tif (props.canEdit && props.editUrl)\n\t{\n\t\treturn h(\n\t\t\t'a',\n\t\t\t{\n\t\t\t\thref: props.editUrl,\n\t\t\t\ttarget: '_blank',\n\t\t\t},\n\t\t\tslots.default(),\n\t\t);\n\t}\n\n\treturn slots.default();\n}\n\ntype CrmFormsListItemNameLinkProps = {\n\tcanEdit: boolean;\n\teditUrl: string;\n}\n\nconst props: Array<$Keys<CrmFormsListItemNameLinkProps>> = ['canEdit', 'editUrl'];\n\nCrmFormsListItemNameLink.props = props;\n\nexport { CrmFormsListItemNameLink };\n","// eslint-disable-next-line no-unused-vars\nimport type { FormsMenuItem } from 'booking.model.forms-menu';\nimport { AirButtonStyle } from 'booking.component.button';\n\nimport { CrmFormsListItemNameLink } from './crm-forms-list-item-name-link';\nimport './crm-forms-list-item.css';\n\n// @vue/component\nexport const CrmFormsListItem = {\n\tname: 'CrmFormsListItem',\n\tcomponents: {\n\t\tCrmFormsListItemNameLink,\n\t},\n\tprops: {\n\t\t/**\n\t\t * @type {FormsMenuItem}\n\t\t */\n\t\titem: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t\tcanEdit: Boolean,\n\t},\n\tsetup(): Object\n\t{\n\t\treturn {\n\t\t\tAirButtonStyle,\n\t\t};\n\t},\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tcopedPopupTimeoutId: null,\n\t\t};\n\t},\n\tmethods: {\n\t\tcopyLink(): void\n\t\t{\n\t\t\tif (!BX.clipboard.isCopySupported())\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tBX.clipboard.copy(this.item.publicUrl);\n\t\t\tthis.showCopedPopup();\n\t\t},\n\t\tshowCopedPopup(): void\n\t\t{\n\t\t\tthis.popup?.destroy();\n\t\t\tthis.popup = new BX.PopupWindow(\n\t\t\t\t`booking_open_crm_forms_popup_item_${this.item.id}_clipboard_copy`,\n\t\t\t\tthis.$refs.copy,\n\t\t\t\t{\n\t\t\t\t\tcontent: this.loc('BOOKING_OPEN_CRM_FORMS_POPUP_FORMS_LIST_ITEM_LINK_COPED'),\n\t\t\t\t\tdarkMode: true,\n\t\t\t\t\tautoHide: true,\n\t\t\t\t\tzIndex: 1000,\n\t\t\t\t\tangle: true,\n\t\t\t\t\toffsetLeft: 20,\n\t\t\t\t\tbindOptions: {\n\t\t\t\t\t\tposition: 'top',\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t);\n\t\t\tthis.popup.show();\n\t\t\tthis.copedPopupTimeoutId = setTimeout(() => {\n\t\t\t\tthis.popup.close();\n\t\t\t\tthis.popup?.destroy();\n\t\t\t}, 1200);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"booking--booking--crm-forms-popup--item\">\n\t\t\t<div class=\"ui-icon-set --o-form booking--booking--crm-forms-popup--item__icon\"></div>\n\t\t\t<div\n\t\t\t\tclass=\"booking--booking--crm-forms-popup--item__name\"\n\t\t\t\t:title=\"item.name\"\n\t\t\t>\n\t\t\t\t<CrmFormsListItemNameLink :canEdit :editUrl=\"item.editUrl\">\n\t\t\t\t\t<span>{{ item.name }}</span>\n\t\t\t\t</CrmFormsListItemNameLink>\n\t\t\t</div>\n\t\t\t<div\n\t\t\t\tref=\"copy\"\n\t\t\t\t:class=\"['booking--booking--crm-forms-popup--item__copy-btn', AirButtonStyle.OUTLINE_NO_ACCENT]\"\n\t\t\t\trole=\"button\"\n\t\t\t\ttabindex=\"0\"\n\t\t\t\t@click=\"copyLink\"\n\t\t\t>\n\t\t\t\t{{ loc('BOOKING_OPEN_CRM_FORMS_POPUP_FORMS_LIST_ITEM_COPY_LINK_BUTTON_LABEL') }}\n\t\t\t\t<div class=\"ui-icon-set --o-copy booking--booking--crm-forms-popup--item__copy-btn-icon\"></div>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import { Model } from 'booking.const';\nimport type { FormsMenuItem } from 'booking.model.forms-menu';\n\nimport { CrmFormListEmpty } from './crm-form-list-empty/crm-form-list-empty';\nimport { CrmFormsListItem } from './crm-forms-list-item/crm-forms-list-item';\n\nimport './crm-forms-list.css';\n\n// @vue/component\nexport const CrmFormsList = {\n\tname: 'CrmFormsList',\n\tcomponents: {\n\t\tCrmFormListEmpty,\n\t\tCrmFormsListItem,\n\t},\n\tcomputed: {\n\t\tcanEdit(): boolean\n\t\t{\n\t\t\treturn this.$store.state[Model.FormsMenu].canEdit;\n\t\t},\n\t\tformList(): FormsMenuItem[]\n\t\t{\n\t\t\treturn this.$store.getters[`${Model.FormsMenu}/formList`];\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"booking--booking--crm-forms-popup--list__container\">\n\t\t\t<div class=\"booking--booking--crm-forms-popup--list-items\">\n\t\t\t\t<template v-if=\"formList.length === 0\">\n\t\t\t\t\t<CrmFormListEmpty />\n\t\t\t\t</template>\n\t\t\t\t<template v-else>\n\t\t\t\t\t<CrmFormsListItem\n\t\t\t\t\t\tv-for=\"item in formList\"\n\t\t\t\t\t\t:key=\"item.id\"\n\t\t\t\t\t\t:item=\"item\"\n\t\t\t\t\t\t:canEdit\n\t\t\t\t\t/>\n\t\t\t\t</template>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import './crm-forms-toolbar.css';\n\n// @vue/component\nexport const CrmFormsToolbar = {\n\tname: 'CrmFormsToolbar',\n\ttemplate: `\n\t\t<div class=\"booking--booking--crm-forms-popup-sort\">\n\t\t\t<span>{{ loc('BOOKING_OPEN_CRM_FORMS_POPUP_SORT_LATEST_CREATED_LABEL') }}</span>\n\t\t\t<div class=\"ui-icon-set --o-change-order-2 booking--booking--crm-forms-popup--sort-icon\"></div>\n\t\t</div>\n\t`,\n};\n","import { Button as UiButton, ButtonColor, ButtonSize, ButtonStyle } from 'booking.component.button';\nimport { Model } from 'booking.const';\n\n// @vue/component\nexport const AddCrmFormButton = {\n\tname: 'AddCrmFormButton',\n\tcomponents: {\n\t\tUiButton,\n\t},\n\tsetup(): Object\n\t{\n\t\treturn {\n\t\t\tButtonColor,\n\t\t\tButtonSize,\n\t\t\tButtonStyle,\n\t\t};\n\t},\n\tcomputed: {\n\t\tcreateFormLink(): string\n\t\t{\n\t\t\treturn this.$store.state[Model.FormsMenu].createFormLink;\n\t\t},\n\t\taddBtnLabel(): string\n\t\t{\n\t\t\treturn this.loc('BOOKING_OPEN_CRM_FORMS_POPUP_ADD_FORM_BUTTON_LABEL').replace('[plus]', '+');\n\t\t},\n\t},\n\ttemplate: `\n\t\t<a :href=\"createFormLink\" target=\"_blank\">\n\t\t\t<UiButton\n\t\t\t\t:text=\"addBtnLabel\"\n\t\t\t\t:color=\"ButtonColor.LIGHT_BORDER\"\n\t\t\t\t:size=\"ButtonSize.SMALL\"\n\t\t\t\t:buttonClass=\"['--air', ButtonStyle.NO_CAPS]\"\n\t\t\t/>\n\t\t</a>\n\t`,\n};\n","import { Button as UiButton, AirButtonStyle, ButtonColor, ButtonSize, ButtonStyle } from 'booking.component.button';\n\n// @vue/component\nexport const AllCrmFormsButton = {\n\tname: 'AllCrmFormsButton',\n\tcomponents: {\n\t\tUiButton,\n\t},\n\tsetup(): Object\n\t{\n\t\treturn {\n\t\t\tAirButtonStyle,\n\t\t\tButtonColor,\n\t\t\tButtonSize,\n\t\t\tButtonStyle,\n\t\t};\n\t},\n\ttemplate: `\n\t\t<a href=\"/crm/webform/\" target=\"_blank\">\n\t\t\t<UiButton\n\t\t\t\t:text=\"loc('BOOKING_OPEN_CRM_FORMS_POPUP_ALL_FORMS_BUTTON_LABEL')\"\n\t\t\t\t:color=\"ButtonColor.LIGHT_BORDER\"\n\t\t\t\t:size=\"ButtonSize.SMALL\"\n\t\t\t\t:buttonClass=\"['--air', AirButtonStyle.OUTLINE_NO_ACCENT, ButtonStyle.NO_CAPS]\"\n\t\t\t/>\n\t\t</a>\n\t`,\n};\n","import { PopupOptions } from 'main.popup';\n\nimport { Popup } from 'booking.component.popup';\nimport { HelpDeskLoc } from 'booking.component.help-desk-loc';\n\nimport { CrmFormsPopupLayout } from './layout/crm-forms-popup-layout';\nimport { CrmFormsList } from './crm-forms-list/crm-forms-list';\nimport { CrmFormsToolbar } from './toolbar/crm-forms-toolbar';\nimport { AddCrmFormButton } from './add-crm-form-button/add-crm-form-button';\nimport { AllCrmFormsButton } from './all-crm-forms-button/all-crm-forms-button';\n\nimport './crm-forms-popup.css';\n\n// @vue/component\nexport const CrmFormsPopup = {\n\tname: 'CrmFormsPopup',\n\tcomponents: {\n\t\tHelpDeskLoc,\n\t\tPopup,\n\t\tCrmFormsList,\n\t\tCrmFormsPopupLayout,\n\t\tCrmFormsToolbar,\n\t\tAddCrmFormButton,\n\t\tAllCrmFormsButton,\n\t},\n\tprops: {\n\t\tvisible: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t\tbindElement: {\n\t\t\ttype: HTMLElement,\n\t\t\trequired: true,\n\t\t},\n\t},\n\temits: ['update:visible'],\n\tcomputed: {\n\t\tconfig(): PopupOptions\n\t\t{\n\t\t\treturn {\n\t\t\t\tclassName: 'booking--booking--crm-forms-popup',\n\t\t\t\tbindElement: this.bindElement,\n\t\t\t\toffsetTop: 10,\n\t\t\t\tpadding: 24,\n\t\t\t\tminHeight: 376,\n\t\t\t\tminWidth: 488,\n\t\t\t\tmaxWidth: 500,\n\t\t\t\tbindOptions: {\n\t\t\t\t\tforceBindPosition: true,\n\t\t\t\t\tposition: 'bottom',\n\t\t\t\t},\n\t\t\t\tangle: {\n\t\t\t\t\toffset: this.bindElement.offsetWidth / 2,\n\t\t\t\t},\n\t\t\t};\n\t\t},\n\t},\n\tmethods: {\n\t\tclosePopup(): void\n\t\t{\n\t\t\tthis.$emit('update:visible', false);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<Popup\n\t\t\tref=\"popup\"\n\t\t\tid=\"booking-crm-forms-popup\"\n\t\t\t:config\n\t\t\t@close=\"closePopup\"\n\t\t>\n\t\t\t<CrmFormsPopupLayout>\n\t\t\t\t<template #toolbar>\n\t\t\t\t\t<CrmFormsToolbar />\n\t\t\t\t</template>\n\t\t\t\t<CrmFormsList />\n\t\t\t\t<template #footer>\n\t\t\t\t\t<div class=\"booking--booking--crm-forms-popup--footer-buttons-bar\">\n\t\t\t\t\t\t<AllCrmFormsButton />\n\t\t\t\t\t\t<AddCrmFormButton />\n\t\t\t\t\t</div>\n\t\t\t\t</template>\n\t\t\t</CrmFormsPopupLayout>\n\t\t</Popup>\n\t`,\n};\n","import { ref } from 'ui.vue3';\nimport { Button as UiButton, AirButtonStyle, ButtonColor, ButtonSize, ButtonStyle } from 'booking.component.button';\nimport { CrmFormsPopup } from './crm-forms-popup/crm-forms-popup';\n\n// @vue/component\nexport const CrmFormsButton = {\n\tname: 'CrmFormsButton',\n\tcomponents: {\n\t\tCrmFormsPopup,\n\t\tUiButton,\n\t},\n\tprops: {\n\t\tcontainer: {\n\t\t\ttype: HTMLElement,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tsetup(): Object\n\t{\n\t\tconst isPopupShown = ref(false);\n\n\t\tconst openMenu = (): void => {\n\t\t\tisPopupShown.value = true;\n\t\t};\n\n\t\treturn {\n\t\t\tisPopupShown,\n\t\t\tAirButtonStyle,\n\t\t\tButtonColor,\n\t\t\tButtonSize,\n\t\t\tButtonStyle,\n\t\t\topenMenu,\n\t\t};\n\t},\n\tcomputed: {\n\t\tlabel(): string\n\t\t{\n\t\t\treturn this.loc('BOOKING_OPEN_CRM_FORMS_BUTTON_LABEL');\n\t\t},\n\t},\n\tmounted()\n\t{\n\t\tthis.container.replaceWith(this.$refs.button.$el);\n\t},\n\ttemplate: `\n\t\t<UiButton\n\t\t\tref=\"button\"\n\t\t\t:buttonClass=\"['--air', ButtonStyle.NO_CAPS, AirButtonStyle.OUTLINE_NO_ACCENT]\"\n\t\t\t:text=\"label\"\n\t\t\t:color=\"ButtonColor.LIGHT_BORDER\"\n\t\t\t:size=\"ButtonSize.SMALL\"\n\t\t\t@click=\"openMenu\"\n\t\t/>\n\t\t<CrmFormsPopup\n\t\t\tv-if=\"isPopupShown\"\n\t\t\tv-model:visible=\"isPopupShown\"\n\t\t\t:bindElement=\"$refs.button.$el\"\n\t\t/>\n\t`,\n};\n","import { Loader } from 'main.loader';\nimport { mapGetters } from 'ui.vue3.vuex';\n\nimport { Model } from 'booking.const';\nimport { EmptyFilterResultsPopup } from 'booking.component.empty-filter-results-popup';\nimport { mainPageService } from 'booking.provider.service.main-page-service';\nimport { dictionaryService } from 'booking.provider.service.dictionary-service';\nimport { bookingService } from 'booking.provider.service.booking-service';\nimport { calendarService } from 'booking.provider.service.calendar-service';\nimport { resourceDialogService } from 'booking.provider.service.resource-dialog-service';\nimport { SectionAnalytics } from 'booking.lib.analytics';\nimport { mousePosition } from 'booking.lib.mouse-position';\nimport {\n\tfilterResultNavigator,\n\tdeletingResourceFilterResultCountActualizer,\n} from 'booking.lib.filter-result-navigator';\nimport type { BookingModel } from 'booking.model.bookings';\nimport type { ResourceModel } from 'booking.model.resources';\nimport type { BookingUIFilter } from 'booking.lib.booking-filter';\nimport type { FilterFields } from 'booking.model.filter';\n\nimport { expandOffHours } from '../lib/expand-off-hours/expand-off-hours';\nimport { Filter as BookingFilter, RequireAttention } from './filter/filter';\nimport { CountersPanel, CounterItem } from './counters-panel/counters-panel';\nimport { AfterTitle } from './after-title/after-title';\nimport { BaseComponent } from './base-component/base-component';\nimport { MultiBooking } from './multi-booking/multi-booking';\nimport { Banner } from './banner/banner';\nimport { Trial } from './trial/trial';\nimport { CrmFormsButton } from './crm-forms-button/crm-forms-button';\n\n// @vue/component\nexport const App = {\n\tname: 'BookingApp',\n\tcomponents: {\n\t\tBaseComponent,\n\t\tAfterTitle,\n\t\tBookingFilter,\n\t\tCountersPanel,\n\t\tMultiBooking,\n\t\tBanner,\n\t\tTrial,\n\t\tCrmFormsButton,\n\t\tEmptyFilterResultsPopup,\n\t},\n\tprops: {\n\t\tafterTitleContainer: HTMLElement,\n\t\tcounterPanelContainer: HTMLElement,\n\t\tsettingsButtonContainer: HTMLElement,\n\t\tfilterId: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tloadingFilter: false,\n\t\t\tloader: new Loader(),\n\t\t};\n\t},\n\tcomputed: {\n\t\t...mapGetters({\n\t\t\tselectedDateTs: `${Model.Interface}/selectedDateTs`,\n\t\t\tviewDateTs: `${Model.Interface}/viewDateTs`,\n\t\t\tisFilterMode: `${Model.Filter}/isFilterMode`,\n\t\t\tisDeletingResourceFilterMode: `${Model.Filter}/isDeletingResourceFilterMode`,\n\t\t\tdeletingResource: `${Model.Filter}/deletingResource`,\n\t\t\tfilteredBookingsIds: `${Model.Filter}/filteredBookingsIds`,\n\t\t\tselectedCells: `${Model.Interface}/selectedCells`,\n\t\t\tresourcesIds: `${Model.Favorites}/get`,\n\t\t\textraResourcesIds: `${Model.Interface}/extraResourcesIds`,\n\t\t\tbookings: `${Model.Bookings}/get`,\n\t\t\tgetBookingsByIds: `${Model.Bookings}/getByIds`,\n\t\t\tgetFutureBookingsByResourceId: `${Model.Bookings}/getFutureByResourceId`,\n\t\t\tintersections: `${Model.Interface}/intersections`,\n\t\t\teditingBookingId: `${Model.Interface}/editingBookingId`,\n\t\t\tfetchingNextDate: `${Model.Filter}/fetchingNextDate`,\n\t\t\tdatesCount: `${Model.Filter}/datesCount`,\n\t\t\trequestFields: `${Model.Filter}/requestFields`,\n\t\t}),\n\t\thasSelectedCells(): boolean\n\t\t{\n\t\t\treturn Object.keys(this.selectedCells).length > 0;\n\t\t},\n\t\teditingBooking(): BookingModel | null\n\t\t{\n\t\t\treturn this.$store.getters['bookings/getById'](this.editingBookingId) ?? null;\n\t\t},\n\t},\n\twatch: {\n\t\tselectedDateTs(): void\n\t\t{\n\t\t\tif (this.isFilterMode)\n\t\t\t{\n\t\t\t\tvoid this.applyFilter();\n\t\t\t}\n\t\t\telse if (this.isDeletingResourceFilterMode)\n\t\t\t{\n\t\t\t\tvoid this.applyDeletingResourceFilter(this.deletingResource);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tvoid this.fetchPage(this.selectedDateTs / 1000);\n\t\t\t}\n\t\t},\n\t\tfilteredBookingsIds(): void\n\t\t{\n\t\t\tif (this.isFilterMode)\n\t\t\t{\n\t\t\t\tthis.showResourcesWithBookings();\n\t\t\t}\n\t\t},\n\t\tisFilterMode(isFilterMode: boolean): void\n\t\t{\n\t\t\tif (!isFilterMode)\n\t\t\t{\n\t\t\t\tvoid this.fetchPage(this.selectedDateTs / 1000);\n\t\t\t}\n\t\t},\n\t\tisDeletingResourceFilterMode(isDeletingResourceFilterMode: boolean): void\n\t\t{\n\t\t\tif (isDeletingResourceFilterMode)\n\t\t\t{\n\t\t\t\tdeletingResourceFilterResultCountActualizer.subscribe();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tdeletingResourceFilterResultCountActualizer.unsubscribe();\n\t\t\t\tvoid this.clearDeletingResourceFilter();\n\t\t\t\tvoid this.fetchPage(this.selectedDateTs / 1000);\n\t\t\t}\n\t\t},\n\t\tviewDateTs(): void\n\t\t{\n\t\t\tvoid this.updateMarks();\n\t\t},\n\t\tresourcesIds(resourcesIds: number[]): void\n\t\t{\n\t\t\tif (this.isDeletingResourceFilterMode)\n\t\t\t{\n\t\t\t\tif (resourcesIds.includes(this.deletingResource.id))\n\t\t\t\t{\n\t\t\t\t\tthis.$store.dispatch(`${Model.Interface}/setPinnedResourceIds`, [...resourcesIds]);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tvoid this.clearDeletingResourceFilter();\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tvoid this.updateMarks();\n\t\t},\n\t\tintersections(): void\n\t\t{\n\t\t\tvoid this.updateMarks();\n\t\t},\n\t\teditingBooking(booking: BookingModel | null): void\n\t\t{\n\t\t\tconst additionalResourcesIds = booking?.resourcesIds?.slice(1) ?? [];\n\t\t\tif (additionalResourcesIds.length > 0)\n\t\t\t{\n\t\t\t\tvoid this.$store.dispatch(`${Model.Interface}/setIntersections`, {\n\t\t\t\t\t0: additionalResourcesIds,\n\t\t\t\t});\n\t\t\t}\n\t\t},\n\t\tfetchingNextDate(fetching: boolean): void\n\t\t{\n\t\t\tif (fetching)\n\t\t\t{\n\t\t\t\tthis.showLoader();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.hideLoader();\n\t\t\t}\n\t\t},\n\t\tdeletingResource(resource: ResourceModel | null): void\n\t\t{\n\t\t\tif (resource !== null)\n\t\t\t{\n\t\t\t\tvoid this.applyDeletingResourceFilter(resource, true);\n\t\t\t}\n\t\t},\n\t},\n\tbeforeMount(): void\n\t{\n\t\tmousePosition.init();\n\t},\n\tasync mounted(): Promise<void>\n\t{\n\t\tthis.showLoader();\n\t\texpandOffHours.setExpanded(true);\n\t\tthis.addAfterTitle();\n\n\t\tSectionAnalytics.sendOpenSection();\n\n\t\tawait Promise.all([\n\t\t\tdictionaryService.fetchData(),\n\t\t\tthis.fetchPage(this.editingBookingId > 0 ? 0 : this.selectedDateTs / 1000),\n\t\t]);\n\n\t\tvoid this.$store.dispatch(`${Model.Interface}/setIsLoaded`, true);\n\t},\n\tbeforeUnmount(): void\n\t{\n\t\tmousePosition.destroy();\n\t},\n\tmethods: {\n\t\tasync fetchPage(dateTs: number = 0): Promise<void>\n\t\t{\n\t\t\tthis.showLoader();\n\n\t\t\tawait mainPageService.fetchData(dateTs);\n\n\t\t\tif (this.extraResourcesIds.length > 0)\n\t\t\t{\n\t\t\t\tawait resourceDialogService.loadByIds(\n\t\t\t\t\tthis.extraResourcesIds,\n\t\t\t\t\tthis.selectedDateTs / 1000,\n\t\t\t\t);\n\t\t\t}\n\n\t\t\tthis.hideLoader();\n\t\t},\n\t\tonActiveItem(counterItem: string | null): void\n\t\t{\n\t\t\tif (this.ignoreConterPanel)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst fields = this.getFilterFieldsByCounterItem(counterItem);\n\t\t\tthis.$refs.filter.setFields(fields);\n\t\t},\n\t\tgetFilterFields(): BookingUIFilter\n\t\t{\n\t\t\tconst fields = this.$refs.filter.getFields();\n\n\t\t\tif (this.isDeletingResourceFilterMode && 'RESOURCE' in fields && Object.keys(fields).length === 1)\n\t\t\t{\n\t\t\t\treturn {\n\t\t\t\t\tRESOURCE: this.$store.getters[`${Model.Interface}/resourcesIds`],\n\t\t\t\t};\n\t\t\t}\n\n\t\t\treturn this.$refs.filter.getFields();\n\t\t},\n\t\tasync applyFilter({ fromFilter = false }: ApplyFilterParams = {}): Promise<void>\n\t\t{\n\t\t\tconst fields = this.$refs.filter.getFields();\n\n\t\t\tthis.setCounterItem(this.getCounterItemByFilterFields(fields));\n\t\t\tthis.showLoader();\n\n\t\t\tawait this.$store.dispatch(`${Model.Filter}/setFilterFields`, this.$refs.filter.getFields());\n\t\t\tawait Promise.all([\n\t\t\t\tthis.$store.dispatch(`${Model.Filter}/setFilterMode`, true),\n\t\t\t\tthis.updateMarks(),\n\t\t\t\t// eslint-disable-next-line unicorn/no-array-callback-reference\n\t\t\t\tbookingService.filter(this.requestFields),\n\t\t\t]);\n\n\t\t\tif (fromFilter && (this.filteredBookingsIds.length === 0 || Date.now() > this.selectedDateTs))\n\t\t\t{\n\t\t\t\tawait this.tryNavigateToOptimalFilterResult();\n\t\t\t}\n\n\t\t\tthis.hideLoader();\n\t\t},\n\t\tasync applyDeletingResourceFilter(resource: ResourceModel, force = false): Promise<void>\n\t\t{\n\t\t\tif (\n\t\t\t\t!force\n\t\t\t\t&& this.isDeletingResourceFilterMode\n\t\t\t\t&& !this.isDeletionResourceFilterFields(this.$refs.filter.getFields())\n\t\t\t)\n\t\t\t{\n\t\t\t\tawait this.$store.dispatch(`${Model.Filter}/setFilterMode`, true);\n\t\t\t\tawait this.clearDeletingResourceFilter(true);\n\t\t\t\tawait this.applyFilter({ fromFilter: true });\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst fields: BookingUIFilter = {\n\t\t\t\tRESOURCE: [resource.id.toString()],\n\t\t\t\tRESOURCE_label: [resource.name],\n\t\t\t};\n\t\t\tif (force)\n\t\t\t{\n\t\t\t\tthis.$refs.filter.setFields(fields);\n\t\t\t}\n\n\t\t\tconst requestFields = this.getFilterFields();\n\n\t\t\tthis.showLoader();\n\n\t\t\tawait Promise.all([\n\t\t\t\tthis.$store.dispatch(`${Model.Filter}/setFilterFields`, fields),\n\t\t\t\tthis.$store.dispatch(`${Model.Filter}/setDeletionResourceFilterFields`, requestFields),\n\t\t\t\tthis.$store.dispatch(`${Model.Interface}/setPinnedResourceIds`, requestFields.RESOURCE),\n\t\t\t]);\n\t\t\tawait Promise.all([\n\t\t\t\tthis.updateMarks(),\n\t\t\t\t// eslint-disable-next-line unicorn/no-array-callback-reference\n\t\t\t\tbookingService.filter(this.requestFields),\n\t\t\t]);\n\n\t\t\tif (force && this.getFutureBookingsByResourceId(resource.id).length === 0)\n\t\t\t{\n\t\t\t\tawait this.tryNavigateToOptimalFilterResult(true);\n\t\t\t}\n\n\t\t\tthis.hideLoader();\n\t\t},\n\t\tisDeletionResourceFilterFields(fields: FilterFields): boolean\n\t\t{\n\t\t\treturn (\n\t\t\t\tObject.keys(fields).length === 1\n\t\t\t\t&& 'RESOURCE' in fields\n\t\t\t\t&& fields.RESOURCE.length === 1\n\t\t\t\t&& fields.RESOURCE[0] === this.deletingResource.id.toString()\n\t\t\t);\n\t\t},\n\t\tsetCounterItem(item: string | null): void\n\t\t{\n\t\t\tthis.ignoreConterPanel = true;\n\t\t\tsetTimeout(() => {\n\t\t\t\tthis.ignoreConterPanel = false;\n\t\t\t}, 0);\n\n\t\t\tthis.$refs.countersPanel.setItem(item);\n\t\t},\n\t\tgetCounterItemByFilterFields(filterFields: BookingUIFilter): string | null\n\t\t{\n\t\t\treturn {\n\t\t\t\t[RequireAttention.AwaitConfirmation]: CounterItem.AwaitConfirmation,\n\t\t\t\t[RequireAttention.Delayed]: CounterItem.Delayed,\n\t\t\t}[filterFields.REQUIRE_ATTENTION];\n\t\t},\n\t\tasync tryNavigateToOptimalFilterResult(inFuture = false): Promise<void>\n\t\t{\n\t\t\tconst dateTs = await filterResultNavigator.getOptimalFilterDateTs(inFuture);\n\n\t\t\tif (dateTs && dateTs !== this.selectedDateTs)\n\t\t\t{\n\t\t\t\tawait this.$store.dispatch(`${Model.Interface}/setSelectedDateTs`, dateTs);\n\t\t\t}\n\t\t},\n\t\tgetFilterFieldsByCounterItem(counterItem: string | null): BookingUIFilter\n\t\t{\n\t\t\tconst fields = this.$refs.filter.getFields();\n\n\t\t\tfields.REQUIRE_ATTENTION = {\n\t\t\t\t[CounterItem.AwaitConfirmation]: RequireAttention.AwaitConfirmation,\n\t\t\t\t[CounterItem.Delayed]: RequireAttention.Delayed,\n\t\t\t}[counterItem];\n\n\t\t\treturn fields;\n\t\t},\n\t\tasync clearFilter(): Promise<void>\n\t\t{\n\t\t\tthis.setCounterItem(null);\n\n\t\t\tcalendarService.clearFilterCache();\n\t\t\tbookingService.clearFilterCache();\n\n\t\t\tawait Promise.all([\n\t\t\t\tthis.$store.dispatch(`${Model.Interface}/setResourcesIds`, this.resourcesIds),\n\t\t\t\tthis.$store.dispatch(`${Model.Filter}/setFilterMode`, false),\n\t\t\t\tthis.$store.dispatch(`${Model.Filter}/setFilteredBookingsIds`, []),\n\t\t\t\tthis.$store.dispatch(`${Model.Filter}/setFilteredMarks`, []),\n\t\t\t\tthis.$store.dispatch(`${Model.Filter}/clearFilter`, {}),\n\t\t\t\tthis.$store.dispatch(`${Model.Interface}/setPinnedResourceIds`, []),\n\t\t\t]);\n\n\t\t\tthis.hideLoader();\n\t\t},\n\t\tasync clearDeletingResourceFilter(modeOnly = false): Promise<void>\n\t\t{\n\t\t\tawait Promise.all([\n\t\t\t\tthis.$store.dispatch(`${Model.Filter}/setDeletingResourceFilter`, null),\n\t\t\t\tthis.$store.dispatch(`${Model.Interface}/setPinnedResourceIds`, []),\n\t\t\t]);\n\n\t\t\tif (this.isFilterMode || modeOnly)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.$refs.filter.setFields({\n\t\t\t\tRESOURCE: [],\n\t\t\t\tRESOURCE_label: [],\n\t\t\t});\n\t\t\tawait this.clearFilter();\n\t\t},\n\t\tclearDeletingResourceFilterFields(): void\n\t\t{\n\t\t\tif (this.isDeletionResourceFilterFields(this.$refs.filter.getFields()))\n\t\t\t{\n\t\t\t\tthis.$refs.filter.setFields({\n\t\t\t\t\tRESOURCE: [],\n\t\t\t\t\tRESOURCE_label: [],\n\t\t\t\t});\n\t\t\t}\n\t\t},\n\t\taddAfterTitle(): void\n\t\t{\n\t\t\tthis.afterTitleContainer.append(this.$refs.afterTitle.$el);\n\t\t},\n\t\tshowResourcesWithBookings(): void\n\t\t{\n\t\t\tconst resourcesIds = this.$store.getters[`${Model.Bookings}/getByDateAndIds`](\n\t\t\t\tthis.selectedDateTs,\n\t\t\t\tthis.filteredBookingsIds,\n\t\t\t)\n\t\t\t\t.map((booking: BookingModel) => booking.resourcesIds[0])\n\t\t\t\t.filter((value, index, array) => array.indexOf(value) === index);\n\n\t\t\tvoid this.$store.dispatch(`${Model.Interface}/setResourcesIds`, resourcesIds);\n\t\t},\n\t\tasync updateMarks(): Promise<void>\n\t\t{\n\t\t\tif (this.isFilterMode || this.isDeletingResourceFilterMode)\n\t\t\t{\n\t\t\t\tawait Promise.all([\n\t\t\t\t\tthis.updateFilterBookingsCount(),\n\t\t\t\t\tthis.updateFilterMarks(),\n\t\t\t\t]);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tawait Promise.all([\n\t\t\t\t\tthis.updateFreeMarks(),\n\t\t\t\t\tthis.updateCounterMarks(),\n\t\t\t\t]);\n\t\t\t}\n\t\t},\n\t\tasync updateFreeMarks(): Promise<void>\n\t\t{\n\t\t\tconst resources = this.resourcesIds.map((id: number) => [\n\t\t\t\tid,\n\t\t\t\t...(this.intersections[0] ?? []),\n\t\t\t\t...(this.intersections[id] ?? []),\n\t\t\t]);\n\n\t\t\tawait this.$store.dispatch(`${Model.Interface}/setFreeMarks`, []);\n\n\t\t\tawait calendarService.loadMarks(this.viewDateTs, resources);\n\t\t},\n\t\tasync updateFilterMarks(): Promise<void>\n\t\t{\n\t\t\tconst fields = this.$refs.filter.getFields();\n\n\t\t\tawait this.$store.dispatch(`${Model.Filter}/setFilteredMarks`, []);\n\n\t\t\tawait calendarService.loadFilterMarks(fields, this.isDeletingResourceFilterMode);\n\t\t},\n\t\tasync updateCounterMarks(): Promise<void>\n\t\t{\n\t\t\tawait calendarService.loadCounterMarks(this.viewDateTs);\n\t\t},\n\t\tasync updateFilterBookingsCount(): Promise<void>\n\t\t{\n\t\t\tconst fields = this.$refs.filter.getFields();\n\n\t\t\tawait calendarService.loadBookingsDateCount(fields, this.isDeletingResourceFilterMode);\n\t\t},\n\t\tshowLoader(): void\n\t\t{\n\t\t\tthis.loadingFilter = true;\n\t\t\tvoid this.loader.show(this.$refs.baseComponent.$el);\n\t\t},\n\t\thideLoader(): void\n\t\t{\n\t\t\tthis.loadingFilter = false;\n\t\t\tvoid this.loader.hide();\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div>\n\t\t\t<MultiBooking v-if=\"hasSelectedCells\"/>\n\t\t\t<AfterTitle ref=\"afterTitle\"/>\n\t\t\t<CrmFormsButton :container=\"settingsButtonContainer\"/>\n\t\t\t<BookingFilter\n\t\t\t\t:filterId=\"filterId\"\n\t\t\t\tref=\"filter\"\n\t\t\t\t@apply=\"isDeletingResourceFilterMode ? applyDeletingResourceFilter(deletingResource) : applyFilter({ fromFilter: true })\"\n\t\t\t\t@clear=\"clearFilter\"\n\t\t\t/>\n\t\t\t<EmptyFilterResultsPopup\n\t\t\t\tv-if=\"isFilterMode && !isDeletingResourceFilterMode && !loadingFilter && !fetchingNextDate && datesCount.count === 0\"\n\t\t\t/>\n\t\t\t<CountersPanel\n\t\t\t\t:target=\"counterPanelContainer\"\n\t\t\t\tref=\"countersPanel\"\n\t\t\t\t@activeItem=\"onActiveItem\"\n\t\t\t/>\n\t\t\t<BaseComponent ref=\"baseComponent\"/>\n\t\t\t<Banner/>\n\t\t\t<Trial/>\n\t\t</div>\n\t`,\n};\n\ntype ApplyFilterParams = {\n\tfromFilter?: boolean,\n};\n","import { BitrixVue } from 'ui.vue3';\nimport { Core, type BookingParams } from 'booking.core';\nimport { locMixin } from 'booking.component.mixin.loc-mixin';\nimport { App } from './components/app';\n\nexport class Booking\n{\n\tconstructor(params: BookingParams)\n\t{\n\t\tCore.setParams(params);\n\n\t\tvoid this.#mountApplication();\n\t}\n\n\tasync #mountApplication(): Promise<void>\n\t{\n\t\tawait Core.init();\n\n\t\tconst application = BitrixVue.createApp(App, Core.getParams());\n\n\t\tapplication.mixin(locMixin);\n\t\tapplication.use(Core.getStore());\n\t\tapplication.mount(Core.getParams().container);\n\t}\n}\n"],"names":["cellHeight","cellHeightProperty","classCollapse","classExpand","ExpandOffHours","expand","keepScroll","Dom","removeClass","addClass","animate","collapse","fromHeight","toHeight","savedScrollTop","scrollTop","savedScrollHeight","scrollHeight","topCellsCoefficient","stop","BX","easing","duration","start","height","finish","step","style","heightChange","setExpanded","isExpanded","className","Core","getStore","dispatch","Model","Interface","getParams","container","getters","expandOffHours","FilterPreset","Object","freeze","CreatedByMe","FilterField","CreatedBy","Contact","Company","Resource","ResourceLabel","Confirmed","RequireAttention","Delayed","AwaitConfirmation","Filter","emits","props","filterId","type","String","required","data","filter","created","Main","filterManager","getById","EventEmitter","subscribe","onBeforeApply","methods","event","getData","isFilterEmpty","$emit","setFields","fields","preparedFields","getFilterFieldsValues","REQUIRE_ATTENTION","RESOURCE","RESOURCE_label","getApi","apply","keys","getFields","length","booleanFields","arrayFields","stringFields","filterFields","field","includes","reduce","acc","forEach","template","CounterItem","CountersPanel","target","HTMLElement","mounted","addCounterPanel","onActiveItem","computed","mapGetters","counters","setItem","itemId","getActiveItem","values","id","counterPanel","getItemById","deactivate","item","activate","CounterPanel","items","title","loc","value","unConfirmed","color","getFieldName","CounterColor","THEME","delayed","init","getItems","find","isActive","watch","updateColor","DANGER","updateValue","obj","entries","Statistics","Number","valueFormatted","increasedValue","increasedValueFormatted","popupId","rows","Array","button","isPopupShown","onMouseEnter","clearTimeouts","showTimeout","setTimeout","showPopup","onMouseLeave","Event","unbind","document","updateHoverElement","bind","closePopup","closeTimeout","popupContainer","getElementById","contains","hoverElement","$refs","clearTimeout","close","animation","replaceWith","components","StatisticsPopup","Clients","totalNewClientsToday","totalClients","click","SidePanel","Instance","open","clientsProfitFormatted","Loc","getMessagePlural","newValue","previousValue","Profit","moneyStatistics","otherCurrencies","month","currencyId","baseCurrencyId","map","getTodayRow","getMonthRow","todayProfit","getTodayProfit","todayProfitFormatted","formatTodayProfit","currencyFormat","getBaseCurrencyId","getTodayProfitFormatted","DateTimeFormat","format","getMonthProfitFormatted","currency","statistics","today","profit","opportunity","statistic","AfterTitle","dateFormatted","getFormat","Date","now","OffHours","bottom","Boolean","default","offHoursHover","offHoursExpanded","fromHour","toHour","fromFormatted","formatHour","toFormatted","hour","timeFormat","timestamp","setHours","animateOffHours","$store","HelpPopup","name","RichLoc","StickyPopup","bindElement","config","offsetLeft","offsetWidth","offsetTop","offsetHeight","maxWidth","QuickFilter","IconSet","isHelpPopupShown","active","hovered","onClick","closeHelpPopup","hover","helpPopupTimeout","showHelpPopup","flee","Icon","LeftPanel","panelHours","lastHour","range","formatted","offHours","last","NowLine","visible","updateNowLine","setInterval","zoom","selectedDateTs","offset","setVisible","hourHeight","fromMinutes","nowMinutes","getHours","getMinutes","toMinutes","Math","min","top","nowLine","timeFormatted","getTime","nowText","innerText","date","UTC","getFullYear","getMonth","getDate","BookingClient","bookingId","booking","addClients","clients","bookingService","update","updateClients","updateNote","note","Client","BookingDeal","Deal","setup","dealHelper","BookingDealHelper","Bookings","deal","externalData","entityTypeId","CrmEntity","BookingDocument","isLoading","bookingActionsService","getDocData","Document","BookingExtraResourcesInfo","ExtraResourcesInfo","BookingMessage","isPrimaryClientIdUpdated","fetchMessageData","isCurrentSenderAvailable","client","clientData","primaryClient","clientId","updatedAt","sendMessage","notificationType","result","Type","isArrayFilled","errors","Notifier","notify","text","message","getMessageData","Message","BookingConfirmation","updateConfirmationStatus","isConfirmed","Confirmation","BookingVisit","updateVisitStatus","visitStatus","Loader","Visit","Overbooking","directives","hint","resourceId","disabled","plusIcon","PLUS_20","plusIconSize","plusIconColor","getBookingById","dictionary","Dictionary","isFeatureEnabled","timezone","embedItems","hasOverbookingHint","undefined","code","module","moduleId","addOverbooking","limit","show","overbooking","Text","getRandom","counter","createdAt","resourcesIds","rrule","timezoneFrom","timezoneTo","Unknown","add","success","BookingAnalytics","sendAddBooking","isOverbooking","Waitlist","clockIcon","BLACK_CLOCK","isRealId","toWaitList","waitListService","createFromBooking","waitListItem","sendAddWaitListItem","BookingRemoveBtn","emit","removeBooking","RemoveBooking","h","RemoveButton","dataAttributes","onRemove","bookingRemoveBtnProps","ActionsPopupActionEnum","confirmation","extraResourcesInfo","fullForm","visit","remove","waitList","BookingActionsPopup","ActionsPopup","options","soonTmp","getOffsetLeft","contentStructure","component","FullForm","info","class","Info","left","getBoundingClientRect","window","innerWidth","Actions","actionsPopupOptions","isEditingBookingMode","editingBookingId","clickHandler","BookingAddClient","expired","ahaMoments","setBookingForAhaMoment","shouldShow","AhaMoment","AddClient","showAhaMoment","addClientsToBook","bookingAddClientBtn","setShown","ChangeTimePopup","targetNode","ButtonSize","ButtonColor","ButtonIcon","fromTs","toTs","dateFromTs","dateToTs","adjustPosition","beforeUnmount","bindOptions","forceBindPosition","position","angle","isBusy","bookings","overbookingMap","has","get","resourceIntersections","intersections","intersection","popup","timeFrom","adjustMenuPosition","timeTo","tsChanged","getPopupInstance","setAutoHide","unfreeze","Popup","TimeSelector","Button","BookingTime","BookingName","Name","bookingName","BookingNote","Note","NotePopup","Function","visiblePopup","showViewPopup","closeViewPopup","saveBookingNote","BookingProfit","BookingCrmButton","CrmButton","Counter","BIcon","UiCounter","nowTs","Animated","CounterSize","notificationTypes","showClocking","showCounter","isExpiredBooking","hasVisitStatus","isNotVisited","fromEntries","confirmationSent","messages","some","showConfirmed","VisitStatus","Visited","NotVisited","started","statusUnknown","statusNotVisited","ResizeDirection","From","None","To","minDuration","Duration","getUnitDurations","i","minInitialDuration","Resize","tooltipTop","tooltipBottom","resizeDirection","resizeFromTs","resizeToTs","limits","initialHeight","grid","calculateHeight","initialDuration","max","dateFromTsRounded","roundTimestamp","dateToTsRounded","closestOnFrom","colliding","closest","closestOnTo","Infinity","excludeBookings","every","hasIntersections","createPopup","autoHide","cacheable","darkMode","showTooltipTop","bookingResizeTop","content","setContent","showTooltipBottom","bookingResizeBottom","hideTooltips","onMouseDown","direction","hasClass","startResize","body","endResize","resize","updateIds","resizeHeight","clientY","$el","newDuration","manageToLimitNotification","manageFromLimitNotification","resizeBooking","checkClosestByIntersection","coll","Promise","all","busySlots","loadBusySlots","resource","Resources","isDeleted","fiveMinutes","round","BookingWidth","BookingBase","width","leftOffset","bookingClass","bookingStyle","isDisabledPopupShown","visibleNotePopup","updateVisibility","updateVisibilityDuringTransition","isReal","mousePosition","isMousePressed","deletingBookings","scroll","draggedBookingId","draggedDataTransfer","calculateLeft","calculateTop","realHeight","calculateRealHeight","bookingOffset","disabledHover","kind","DraggedElementKind","Booking","rect","right","onNoteMouseEnter","showNoteTimeout","onNoteMouseLeave","stopPropagation","resizeUpdate","Communication","DisabledPopup","getOverbookingFreeSpace","draggedBookingResourcesIds","minTs","maxTs","freeSpace","bookingColliding","findTimeForDroppedBooking","droppedBooking","countBookingWidth","overlappingBookings","overlappingBookingsCount","countBookingLeftOffset","bookingWidth","index","indexOf","bookingUiGroups","dropArea","animationPause","isBookingCreatedFromEmbed","getWaitListItemById","WaitList","getResourceById","isDeletingResourceFilterMode","deletingResource","overbookingInResource","hasOverbooking","isShifted","isPlainObject","shifted","overbookingDependencies","bookingIds","hidden","isDeletedResource","realBooking","isNumber","hasAccent","isShaded","handler","stopDropHandler","startDropHandler","deep","dragMouseEnter","WaitListItem","draggedBooking","bookingDuration","draggedBookingDuration","excludeBookingFn","dragMouseLeave","dropElement","dropBooking","dropWaitListItem","Set","slice","droppedWaitListItem","slotRanges","createFromWaitListItem","capture","BusyPopup","busySlot","BusySlot","Intersection","intersectingResourceId","angleLeft","MainPopup","getOption","angleOffset","background","angleBorderRadius","textFormatted","messageId","getPopupMessageId","slotType","IntersectionOverbooking","setBindElement","mapInterfaceGetters","createNamespacedHelpers","mapFilterGetters","BookingBusySlotClassName","BusySlotType","disabledBusySlots","isDragMode","isFilterMode","isDisabled","isDragOffHours","isDragOverbooking","onMouseMove","cursorInsideContainer","updatePopup","relatedTarget","querySelector","eventTarget","isNull","clientX","BaseCell","cell","selectedCells","selected","hasSelectedCells","onCellSelected","checked","creatingBookingId","random","addBooking","creatingBooking","Cell","overbookingPositionsInCell","overbookingPositions","calculateWidth","calcOverbookingPositionsInCell","cellTimespan","positions","resourceOverbooking","checkBookingIntersection","push","QuickFilterLine","MinUiBookingDurationMs","getBookingUiSlot","createBookingModelUi","overbookingMapItem","uiSlot","splitBookingsByResourceId","resourceBookingsMap","Map","resourceBookings","set","groupBookingUis","groups","group","slot","sort","a","b","inInterval","getResourceBookingUiGroups","resourceBookingUiGroups","bookingGroups","mapBookingsGetters","hoveredCell","filteredBookingsIds","quickFilter","resourcesHash","resources","JSON","stringify","bookingsHash","dateTs","flatMap","cells","setDate","quickFilterHours","activeHours","resourceBookingsUiGroupsMap","embedEditingMode","startInterval","generateBookingKey","getBookingUiGroupsByResourceId","halfHour","halfOffset","resizedBookingId","draggedElementId","isAvailable","cellFromTs","cellHalfTs","maxFrom","minTo","excludeBookingColliding","quickFilterHovered","minutes","quickFilterActive","mouseEnterHandler","updateHalfHour","mouseLeaveHandler","nextHoveredCell","dataset","mouseMoveHandler","scrollY","bottomHalf","canSubtractHalfHour","canAddHalfHour","offsetNotMatchesHalf","clearCell","hoverCell","boundedToBottom","Column","slotSize","offHoursTopCells","it","workTimeCells","offHoursBottomCells","from","to","isAirTemplate","Extension","getSettings","counterPanelScopeClass","darkThemeClass","Maximize","constructor","onOverlayClick","applyHacks","disablePageScrollbar","Manager","getSliderClass","maximize","append","minimize","resetHacks","enablePageScrollbar","Tag","render","innerHeight","complete","parentElement","ZIndexManager","register","overlay","unregister","counterPanelContainer","firstElementChild","imBar","ScalePanel","getColumnsContainer","isSlider","desiredZoom","minZoom","maxZoom","location","hash","expanded","zoomFormatted","isAnyModifierKeyPressed","href","focus","altKey","shiftKey","ctrlKey","metaKey","fitToScreen","sidebarPadding","view","zoomCoefficient","scrollWidth","newZoom","floor","zoomInto","isNaN","noTransitionClass","maxAnimationDuration","abs","onMouseUp","mouseDown","resolve","clearInterval","zoomInterval","ceil","setPopupShown","ExpandGrid","Calendar","CounterFloating","calendarClass","calendarExpanded","datesCount","freeMarks","getCounterMarks","filteredMarks","viewDateTs","counterMarks","formattedDate","isShowCounterFloating","count","datePicker","selectDate","createDate","updateMarks","setCounterMarks","DatePicker","selectedDates","inline","hideHeader","setViewDate","DatePickerEvent","SELECT","selectedDate","createDateFromUtc","setTargetNode","destroy","onPreviousClick","previousMonth","previousDate","onNextClick","nextMonth","nextDate","getSelectedDate","getToday","getNextDate","viewDate","getViewDate","getUTCFullYear","getUTCMonth","getUTCDate","setFilterMarks","setFreeMarks","bgColorFree","dates","prepareDates","setDayColors","matcher","bgColor","getFilterMarks","todayTs","freeMarkTs","bgColorFilter","setDayMarks","markDate","parse","DateFormat","ServerParse","prepareTimestamp","dateFormat","collapseToggle","optionService","setBool","Option","CalendarExpanded","WaitListLayout","waitListItemsCount","waitListClass","showEmptyState","dragging","showHelpDesk","Helper","anchor","HelpDesk","WaitListDescription","anchorCode","params","redirect","queryString","key","join","useDeleteWaitListGroup","confirmDelete","messageBox","MessageBox","create","getMessage","yesCaption","modal","buttons","MessageBoxButtons","YES_CANCEL","onYes","onCancel","deleteWaitListGroup","waitListItemsIds","deleteList","WaitListGroupMenu","waitListGroup","menuPopup","unmounted","openMenu","popupWindow","isShown","menuButton","MenuManager","getMenuItems","closeByEsc","events","onDestroy","unbindScrollEvent","bindScrollEvent","html","onclick","WaitListGroups","dragManager","editingWaitListItemId","waitListItems","waitListGroups","d","dayDuration","w","weekDuration","m","monthDuration","WaitListItemName","itemName","WaitListItemNote","saveWaitListItemNote","WaitListItemProfit","WaitListItemClient","waitListItemId","WaitListItemConfirmation","WaitListItemDeal","WaitListDealHelper","WaitListItemDocument","ref","onMounted","WaitListItemMessage","WaitListItemRemove","RemoveWaitListItem","WaitListItemVisit","WaitListItemActionsPopup","WaitListItemActions","WaitListItemAddClient","addClient","WaitListItemCrmButton","isWaitListItemCreatedFromEmbed","hasClient","ButtonAddWaitListItem","isLoaded","waitListExpanded","addButtonText","replace","addWaitListItem","expandWaitListWidget","addCreatedFromEmbedWaitListItem","WaitListAnalytics","commit","draggedBookingResourceId","isEmpty","isAvailableToDrop","oldValue","WaitListExpanded","setEditingWaitListItemId","Sidebar","DragDelete","Grid","scrolledToBooking","editingBooking","columnsContainer","scrollLeft","scrollToEditingBooking","dataId","dataKind","initDragManager","ids","scrollToBooking","ears","Ears","smallSize","tryShowAhaMoment","unsubscribe","updateEars","toggleEars","areEarsShown","shownClass","getRightEar","getLeftEar","inner","scalePanel","Drag","draggable","MIN_CHARGE","MAX_CHARGE","CHARGE_COLOR","EMPTY_COLOR","BATTERY_ICON_HEIGHT","BATTERY_ICON_WIDTH","BatteryIcon","percent","repaint","getCharge","rects","children","charge","setAttribute","WorkloadPopup","slotsCount","bookingCount","workLoadPercent","slotsBookedFormatted","element","bookedCount","totalCount","workLoadPercentFormatted","ResourceWorkload","scale","isGrid","slotsDuration","selectedWeekDay","WeekDays","getDay","filterSlotRanges","slotRange","weekDays","sum","bookingsDuration","batteryIconOptions","bookingsCount","newCount","previousCount","article","AhaResourceWorkload","ResourceMenu","favoritesIds","Favorites","UI","Hint","createInstance","popupParameters","wizard","ResourceCreationWizard","editResource","hideResource","removeResource","RemoveResource","run","splice","hideResources","resourceType","ResourceTypes","typeId","deals","uniqueDeals","labelHTML","label","Label","size","LabelSize","SM","fill","outerHTML","AddResourceButton","AddResource","addResource","RcwAnalytics","sendClickAddResource","AhaAddResource","SidePanelInstance","openSliders","url","makeName","ContentHeader","BaseHeader","getContainer","selectedTypes","resourceTypes","visibleResourceTypes","resourcesCnt","isResourceTypesSectionVisible","selectAll","deselectAll","getNode","isResized","startMouseY","startHeight","preventDefault","minHeight","maxHeight","newHeight","Search","searchDebounced","Runtime","debounce","search","query","searchIcon","SEARCH_2","onInput","isStringFilled","DialogHeader","ContentFooter","BaseFooter","DialogFooter","buttonSettings","SMALL","LINK","buttonLabel","UiButton","SelectResources","dialogFilled","saveItemsDebounce","saveItems","workloadRefs","mainResources","MainResources","mainResourceIds","isDefaultState","updateItems","addItems","resourceDialogService","clearMainResourcesCache","updateItemsByType","dialog","Dialog","context","dropdownMode","preselectedItems","EntitySelectorEntity","getItemOptions","entities","onShow","header","headerOptions","dialogHeader","footer","footerOptions","dialogFooter","getRecentTab","loadOnScroll","showDialog","loadMainResources","fillDialog","maxScroll","loadedResourcesIds","resourcesDateCache","getIdsByDateTs","activeResources","idsToLoad","Limit","ResourcesDialog","loadByIds","getMainResources","getId","workload","isHidden","isItemHidden","isSelected","isItemSelected","getNodes","node","avatarContainer","getAvatarContainer","setHidden","select","deselect","getSelectedItems","itemsOptions","itemOptions","addItem","itemsIds","removeItems","tab","getActiveTab","getRootNode","getChildrenContainer","entityId","subtitle","getResourceType","avatarOptions","bgImage","borderRadius","tabs","EntitySelectorTab","Recent","nodeAttributes","getResource","getSearchTab","getStub","hide","getSearchLoader","doSearch","isEmptyResult","setWorkloadRef","AhaSelectResources","reset","getSelectedTypes","Header","Multiple","selectedItems","selector","createSelector","selectedIds","intersectionField","enableSearch","multiple","showAvatars","dynamicLoad","dynamicSearch","searchOptions","allowCreateItem","onHide","changeSelected","onLoad","showSelector","handleRemove","getItem","firstItemTitle","remainingItemsCount","previousResourcesIds","removedIds","newIds","removeItem","setTitle","setSubtitle","getTagSelector","getTags","tag","Single","lock","mountSelector","destroySelector","TagSelector","addButtonCaption","showCreateButton","dialogOptions","onAfterTagAdd","onSelectorChange","onAfterTagRemove","getDialog","renderTo","innerHTML","ResourceIntersection","AhaResourceIntersection","getAddButton","Intersections","intersectionModeMenuItemId","menu","intersectionMenu","showMenu","getIntersectionForAllItem","delimiter","getHelpDeskItem","isIntersectionForAll","IntersectionForAll","helpDesk","showIntersections","selectedResourceIds","toggleMenuItemActivityState","toggleClass","updateScroll","getMenuItem","BaseComponent","isAmPmMode","endsWith","BookingMultipleButton","fetching","SUCCESS","MultiBookingItem","buttonColor","buttonSize","EXTRA_SMALL","MultiBookingItemsList","selectedCellsCount","wrapper","noScrollbar","AddClientButton","modelValue","getByClientData","currentClient","contact","findClientByType","company","createClients","clientsData","clientTypeCode","ClientPopup","CancelButton","MultiBooking","beforeMount","embedContact","embedCompany","embedDeal","clientService","getContactById","getCompanyById","removeSelected","hasOwnProperty","call","book","getBookings","bookingList","addList","sendAddMultiBookings","showNotification","closeMultiBooking","bookingQuantity","balloon","Notification","Center","actions","Banner","isBannerShown","bannerComponent","canTurnOnDemo","showBanner","BannerDispatcher","critical","toQueue","onDone","PromoBanner","loadExtension","shallowRef","bannerClosed","Resolvable","closeBanner","BannerAnalytics","sendShowPopup","buttonClick","sendClickEnable","Trial","isShownTrialPopup","TrialBanner","AutoLauncher","isEnabled","enable","CrmFormsPopupLayout","HelpDeskLoc","CrmFormsPopup","CrmFormItemSkeleton","CrmFormListEmpty","CrmFormsListItemNameLink","slots","canEdit","editUrl","CrmFormsListItem","AirButtonStyle","copedPopupTimeoutId","copyLink","clipboard","isCopySupported","copy","publicUrl","showCopedPopup","PopupWindow","zIndex","CrmFormsList","state","FormsMenu","formList","CrmFormsToolbar","AddCrmFormButton","ButtonStyle","createFormLink","addBtnLabel","AllCrmFormsButton","padding","minWidth","CrmFormsButton","App","BookingFilter","EmptyFilterResultsPopup","afterTitleContainer","settingsButtonContainer","loadingFilter","loader","extraResourcesIds","getBookingsByIds","getFutureBookingsByResourceId","fetchingNextDate","requestFields","applyFilter","applyDeletingResourceFilter","fetchPage","showResourcesWithBookings","deletingResourceFilterResultCountActualizer","clearDeletingResourceFilter","additionalResourcesIds","showLoader","hideLoader","addAfterTitle","SectionAnalytics","sendOpenSection","dictionaryService","fetchData","mainPageService","counterItem","ignoreConterPanel","getFilterFieldsByCounterItem","getFilterFields","fromFilter","setCounterItem","getCounterItemByFilterFields","tryNavigateToOptimalFilterResult","force","isDeletionResourceFilterFields","toString","countersPanel","inFuture","filterResultNavigator","getOptimalFilterDateTs","clearFilter","calendarService","clearFilterCache","modeOnly","clearDeletingResourceFilterFields","afterTitle","array","updateFilterBookingsCount","updateFilterMarks","updateFreeMarks","updateCounterMarks","loadMarks","loadFilterMarks","loadCounterMarks","loadBookingsDateCount","baseComponent","setParams","application","BitrixVue","createApp","mixin","locMixin","use","mount"],"mappings":"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"}