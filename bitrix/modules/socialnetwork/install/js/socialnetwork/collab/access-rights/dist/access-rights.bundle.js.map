{"version":3,"file":"access-rights.bundle.js","sources":["../src/form.js","../src/add-form.js","../src/edit-form.js","../src/access-rights.js"],"sourcesContent":["import { ajax, Event, Loc, Tag, Text, Type } from 'main.core';\nimport { EventEmitter } from 'main.core.events';\n\nimport { Selector, UserSelector } from 'ui.form-elements.view';\n\nimport { Params } from './access-rights';\n\nimport 'ui.forms';\nimport 'ui.hint';\n\ntype FormData = {\n\tid: number,\n\townerId: number,\n\tmoderators: Array<number>,\n\tpermissions: { [string]: { [string]: string } },\n\toptions: { [string]: { [string]: string } },\n\tpermissionsLabels: { [string]: string },\n\trightsPermissionsLabels: { [string]: string },\n\toptionsLabels: { [string]: string },\n\tisAllowedInviteCollabers: boolean,\n};\n\nexport type Data = {\n\tid: number,\n\townerId: number,\n\tmoderators: Array<number>,\n\tpermissions: { [string]: { [string]: string } },\n}\n\nexport class Form extends EventEmitter\n{\n\t#params: Params;\n\n\t#layout: {\n\t\townerField: UserSelector,\n\t\tmoderatorsField: UserSelector,\n\t\tshowHistory: Selector,\n\t\twhoCanInvite: Selector,\n\t\tallowGuestsInvitation: Selector,\n\t\tmanageMessages: Selector,\n\t\ttasksViewUsersField: Selector,\n\t\ttasksSortTasksField: Selector,\n\t\ttasksCreateTasksField: Selector,\n\t\ttasksEditTasksField: Selector,\n\t\ttasksDeleteTasksField: Selector,\n\t};\n\n\t#hintManager = null;\n\t#sidePanel: BX.SidePanel.Manager;\n\n\tsidePanelId: string;\n\n\tconstructor(params: Params)\n\t{\n\t\tsuper(params);\n\n\t\tthis.#params = params;\n\n\t\tthis.setEventNamespace('BX.Socialnetwork.Collab.Form');\n\n\t\tthis.#layout = {};\n\n\t\tthis.sidePanelId = 'sn-collab-access-rights';\n\t}\n\n\topen(): void {}\n\n\tprepareFormData(data: Object): FormData\n\t{\n\t\treturn {\n\t\t\tid: Number(data.id),\n\t\t\townerId: Number(data.ownerId),\n\t\t\tmoderators: Type.isArray(data.moderatorMembers) ? data.moderatorMembers : [],\n\t\t\tpermissions: Type.isPlainObject(data.permissions) ? data.permissions : {},\n\t\t\toptions: Type.isPlainObject(data.options) ? data.options : {},\n\t\t\tpermissionsLabels: Type.isPlainObject(data.permissionsLabels) ? data.permissionsLabels : {},\n\t\t\trightsPermissionsLabels: Type.isPlainObject(data.rightsPermissionsLabels) ? data.rightsPermissionsLabels : {},\n\t\t\toptionsLabels: Type.isPlainObject(data.optionsLabels) ? data.optionsLabels : {},\n\t\t\tisAllowedInviteCollabers: Type.isBoolean(data.isAllowedInviteCollabers) ? data.isAllowedInviteCollabers : false,\n\t\t};\n\t}\n\n\trender(formData: FormData): HTMLElement\n\t{\n\t\tconst uiStyles = 'ui-sidepanel-layout-content ui-sidepanel-layout-content-margin';\n\n\t\tthis.#prepareFields(formData);\n\n\t\tconst { content, form } = Tag.render`\n\t\t\t<div ref=\"content\" class=\"sn-collab__access-right-side-panel ui-sidepanel-layout\">\n\t\t\t\t<div class=\"ui-sidepanel-layout-header\">\n\t\t\t\t\t<div class=\"ui-sidepanel-layout-title\">\n\t\t\t\t\t\t${Loc.getMessage('SN_COLLAB_ACCESS_RIGHTS')}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<form ref=\"form\" class=\"${uiStyles} sn-collab__access-right-form\">\n\t\t\t\t\t<div class=\"sn-collab__access-right-form-box\">\n\t\t\t\t\t\t<div class=\"sn-collab__access-right-form-box-label\">\n\t\t\t\t\t\t\t${Loc.getMessage('SN_COLLAB_ACCESS_RIGHTS_MANAGEMENT_LABEL_MSGVER_1')}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t${this.#layout.ownerField.render()}\n\t\t\t\t\t\t${this.#layout.moderatorsField.render()}\n\t\t\t\t\t\t${this.#layout.showHistory.render()}\n\t\t\t\t\t\t${this.#layout.whoCanInvite.render()}\n\t\t\t\t\t\t${this.#layout.allowGuestsInvitation.render()}\n\t\t\t\t\t\t${this.#layout.manageMessages.render()}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"sn-collab__access-right-form-box --selectors\">\n\t\t\t\t\t\t<div class=\"sn-collab__access-right-form-box-label\">\n\t\t\t\t\t\t\t${Loc.getMessage('SN_COLLAB_ACCESS_RIGHTS_TASKS_LABEL')}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t${this.#layout.tasksViewUsersField.render()}\n\t\t\t\t\t\t${this.#layout.tasksSortTasksField.render()}\n\t\t\t\t\t\t${this.#layout.tasksCreateTasksField.render()}\n\t\t\t\t\t\t${this.#layout.tasksEditTasksField.render()}\n\t\t\t\t\t\t${this.#layout.tasksDeleteTasksField.render()}\n\t\t\t\t\t</div>\n\t\t\t\t</form>\n\t\t\t\t<div class=\"ui-sidepanel-layout-footer-anchor\"></div>\n\t\t\t\t<div class=\"ui-sidepanel-layout-footer\">\n\t\t\t\t<div class=\"ui-sidepanel-layout-buttons\">\n\t\t\t\t\t${this.#renderButtons(formData)}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\n\t\tEvent.bind(form, 'change', () => {\n\t\t\tthis.#checkFormData();\n\t\t});\n\n\t\treturn content;\n\t}\n\n\t#renderButtons(formData: FormData): HTMLElement\n\t{\n\t\tconst { buttons, save, cancel } = Tag.render`\n\t\t\t<div ref=\"buttons\">\n\t\t\t\t<button ref=\"save\" class=\"ui-btn ui-btn-success\">\n\t\t\t\t\t${Loc.getMessage('SN_COLLAB_ACCESS_RIGHTS_BUTTON_SAVE')}\n\t\t\t\t</button>\n\t\t\t\t<button ref=\"cancel\" class=\"ui-btn ui-btn-link\">\n\t\t\t\t\t${Loc.getMessage('SN_COLLAB_ACCESS_RIGHTS_BUTTON_CANCEL')}\n\t\t\t\t</button>\n\t\t\t</div>\n\t\t`;\n\n\t\tEvent.bind(save, 'click', () => {\n\t\t\tif (this.#checkFormData())\n\t\t\t{\n\t\t\t\tif (this.#params.enableServerSave === true)\n\t\t\t\t{\n\t\t\t\t\tajax.runAction(\n\t\t\t\t\t\t'socialnetwork.collab.AccessRights.saveRights',\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tdata: this.#collectFormData(formData),\n\t\t\t\t\t\t},\n\t\t\t\t\t)\n\t\t\t\t\t\t.then(() => {\n\t\t\t\t\t\t\tthis.#sidePanel.close();\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.catch((error) => {\n\t\t\t\t\t\t\tconsole.error(error);\n\t\t\t\t\t\t})\n\t\t\t\t\t;\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.emit('save', this.#collectFormData(formData));\n\n\t\t\t\t\tthis.#sidePanel.close();\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\tEvent.bind(cancel, 'click', () => {\n\t\t\tthis.emit('cancel');\n\n\t\t\tthis.#sidePanel.close();\n\t\t});\n\n\t\treturn buttons;\n\t}\n\n\tonLoad(event)\n\t{\n\t\tthis.#hintManager = BX.UI.Hint.createInstance({\n\t\t\tid: this.sidePanelId,\n\t\t\tpopupParameters: {\n\t\t\t\ttargetContainer: window.top.document.body,\n\t\t\t},\n\t\t});\n\t\tthis.#hintManager.init(event.slider.getContainer());\n\n\t\tthis.#sidePanel = event.slider;\n\t}\n\n\tonClose()\n\t{\n\t\tthis.#hintManager.hide();\n\t}\n\n\t#checkFormData(): boolean\n\t{\n\t\tconst ownerIds = this.#layout.ownerField?.getSelector().getTags().map((tag) => tag.id);\n\t\tif (ownerIds.length === 0)\n\t\t{\n\t\t\tthis.#layout.ownerField.setErrors([Loc.getMessage('SN_COLLAB_ACCESS_RIGHTS_ERROR_REQUIRED_OWNER')]);\n\n\t\t\treturn false;\n\t\t}\n\t\tthis.#layout.ownerField.cleanError();\n\n\t\treturn true;\n\t}\n\n\t#collectFormData(formData: FormData): Data\n\t{\n\t\tlet ownerId = formData.ownerId;\n\t\tif (this.#layout.ownerField?.getSelector().getDialog().isLoaded())\n\t\t{\n\t\t\townerId = this.#layout.ownerField?.getSelector().getTags().map((tag) => tag.id);\n\t\t}\n\n\t\tlet moderators = formData.moderators;\n\t\tif (this.#layout.moderatorsField?.getSelector().getDialog().isLoaded())\n\t\t{\n\t\t\tmoderators = this.#layout.moderatorsField?.getSelector().getTags().map((tag) => tag.id);\n\t\t}\n\n\t\treturn {\n\t\t\tid: formData.id,\n\t\t\townerId: ownerId[0],\n\t\t\tmoderators,\n\t\t\toptions: {\n\t\t\t\tshowHistory: this.#layout.showHistory.getValue(),\n\t\t\t\tmanageMessages: this.#layout.manageMessages.getValue(),\n\t\t\t\twhoCanInvite: this.#layout.whoCanInvite.getValue(),\n\t\t\t\tallowGuestsInvitation: this.#layout.allowGuestsInvitation.getValue(),\n\t\t\t},\n\t\t\tpermissions: {\n\t\t\t\ttasks: {\n\t\t\t\t\tview_all: this.#layout.tasksViewUsersField.getValue(),\n\t\t\t\t\tsort: this.#layout.tasksSortTasksField.getValue(),\n\t\t\t\t\tcreate_tasks: this.#layout.tasksCreateTasksField.getValue(),\n\t\t\t\t\tedit_tasks: this.#layout.tasksEditTasksField.getValue(),\n\t\t\t\t\tdelete_tasks: this.#layout.tasksDeleteTasksField.getValue(),\n\t\t\t\t},\n\t\t\t},\n\t\t};\n\t}\n\n\t#prepareFields(formData: FormData): void\n\t{\n\t\tthis.#prepareParams(formData);\n\t\tthis.#prepareBaseFields(formData);\n\t\tthis.#prepareTasksFields(formData);\n\t}\n\n\t#prepareBaseFields(formData: FormData): void\n\t{\n\t\tthis.#layout.ownerField = this.#getOwnerField(formData.ownerId);\n\t\tthis.#layout.moderatorsField = this.#getModeratorsField(formData.moderators);\n\n\t\tthis.#layout.showHistory = this.#getShowHistoryField(\n\t\t\tformData.optionsLabels,\n\t\t\tformData.options?.showHistory,\n\t\t);\n\n\t\tthis.#layout.whoCanInvite = this.#getWhoCanInviteField(\n\t\t\tformData.permissionsLabels,\n\t\t\tformData.options?.whoCanInvite,\n\t\t);\n\n\t\tthis.#layout.allowGuestsInvitation = this.#getAllowGuestsInvitationField(\n\t\t\tformData.optionsLabels,\n\t\t\tformData.options?.allowGuestsInvitation,\n\t\t);\n\n\t\tthis.#layout.manageMessages = this.#getManageMessagesField(\n\t\t\tformData.permissionsLabels,\n\t\t\tformData.options?.manageMessages,\n\t\t);\n\t}\n\n\t#prepareTasksFields(formData: FormData): void\n\t{\n\t\tconst tasks = Type.isPlainObject(formData.permissions?.tasks) ? formData.permissions.tasks : {};\n\n\t\tthis.#layout.tasksViewUsersField = this.#getTasksViewUsersField(\n\t\t\tformData.rightsPermissionsLabels,\n\t\t\ttasks?.view_all,\n\t\t);\n\t\tthis.#layout.tasksSortTasksField = this.#getTasksSortTasksField(\n\t\t\tformData.rightsPermissionsLabels,\n\t\t\ttasks?.sort,\n\t\t);\n\t\tthis.#layout.tasksCreateTasksField = this.#getTasksCreateTasksField(\n\t\t\tformData.rightsPermissionsLabels,\n\t\t\ttasks?.create_tasks,\n\t\t);\n\t\tthis.#layout.tasksEditTasksField = this.#getTasksEditTasksField(\n\t\t\tformData.rightsPermissionsLabels,\n\t\t\ttasks?.edit_tasks,\n\t\t);\n\t\tthis.#layout.tasksDeleteTasksField = this.#getTasksDeleteTasksField(\n\t\t\tformData.rightsPermissionsLabels,\n\t\t\ttasks?.delete_tasks,\n\t\t);\n\t}\n\n\t#prepareParams(formData: FormData): void\n\t{\n\t\tthis.#params.isAllowedInviteCollabers = formData.isAllowedInviteCollabers;\n\t}\n\n\t#getOwnerField(ownerId: number): UserSelector\n\t{\n\t\tconst label = this.#getFieldLabel(\n\t\t\t'OwnerHint',\n\t\t\tLoc.getMessage('SN_COLLAB_ACCESS_RIGHTS_OWNER_LABEL'),\n\t\t\tLoc.getMessage('SN_COLLAB_ACCESS_RIGHTS_OWNER_LABEL_HINT'),\n\t\t);\n\n\t\treturn new UserSelector({\n\t\t\tid: 'sn-collab-form-field-owner',\n\t\t\tlabel,\n\t\t\tenableAll: false,\n\t\t\tenableDepartments: false,\n\t\t\tmultiple: false,\n\t\t\tvalues: [['user', ownerId]],\n\t\t});\n\t}\n\n\t#getModeratorsField(moderators: Array<number>): UserSelector\n\t{\n\t\tconst label = this.#getFieldLabel(\n\t\t\t'ModeratorsHint',\n\t\t\tLoc.getMessage('SN_COLLAB_ACCESS_RIGHTS_MODERATORS_LABEL'),\n\t\t\tLoc.getMessage('SN_COLLAB_ACCESS_RIGHTS_MODERATORS_LABEL_HINT'),\n\t\t);\n\n\t\treturn new UserSelector({\n\t\t\tid: 'sn-collab-form-field-moderators',\n\t\t\tlabel,\n\t\t\tenableAll: false,\n\t\t\tenableDepartments: false,\n\t\t\tmultiple: true,\n\t\t\tvalues: moderators.map((moderatorId) => ['user', moderatorId]),\n\t\t});\n\t}\n\n\t#getShowHistoryField(options: { [string]: string }, selectedValue: ?string): Selector\n\t{\n\t\tconst label = this.#getFieldLabel(\n\t\t\t'ShowHistoryHint',\n\t\t\tLoc.getMessage('SN_COLLAB_ACCESS_RIGHTS_SHOW_HISTORY_LABEL'),\n\t\t);\n\n\t\treturn this.#getSelector('showHistory', label, options, selectedValue);\n\t}\n\n\t#getWhoCanInviteField(options: { [string]: string }, selectedValue: ?string): Selector\n\t{\n\t\tconst label = this.#getFieldLabel(\n\t\t\t'InitiateHint',\n\t\t\tLoc.getMessage('SN_COLLAB_ACCESS_RIGHTS_INITIATE_LABEL'),\n\t\t\tLoc.getMessage('SN_COLLAB_ACCESS_RIGHTS_INITIATE_LABEL_HINT'),\n\t\t);\n\n\t\treturn this.#getSelector('whoCanInvite', label, options, selectedValue);\n\t}\n\n\t#getAllowGuestsInvitationField(options: { [string]: string }, selectedValue: ?string): Selector\n\t{\n\t\t// is collabers invitation enabled at the portal level\n\t\tconst isFieldDisabled = !this.#params.isAllowedInviteCollabers;\n\n\t\tconst label = this.#getFieldLabel(\n\t\t\t'AllowGuestsInvitationHint',\n\t\t\tLoc.getMessage('SN_COLLAB_ACCESS_RIGHTS_ALLOW_GUESTS_INVITATION_LABEL'),\n\t\t);\n\n\t\treturn this.#getSelector('allowGuestsInvitation', label, options, selectedValue, isFieldDisabled);\n\t}\n\n\t#getManageMessagesField(options: { [string]: string }, selectedValue: ?string): Selector\n\t{\n\t\tconst label = this.#getFieldLabel(\n\t\t\t'ChatHint',\n\t\t\tLoc.getMessage('SN_COLLAB_ACCESS_RIGHTS_CHAT_LABEL'),\n\t\t\tLoc.getMessage('SN_COLLAB_ACCESS_RIGHTS_CHAT_LABEL_HINT'),\n\t\t);\n\n\t\treturn this.#getSelector('manageMessages', label, options, selectedValue);\n\t}\n\n\t#getTasksViewUsersField(options: { [string]: string }, selectedValue: ?string): Selector\n\t{\n\t\tconst label = this.#getFieldLabel(\n\t\t\t'TasksViewUsersHint',\n\t\t\tLoc.getMessage('SN_COLLAB_ACCESS_RIGHTS_TVU_LABEL'),\n\t\t);\n\n\t\treturn this.#getSelector('initiate', label, options, selectedValue);\n\t}\n\n\t#getTasksSortTasksField(options: { [string]: string }, selectedValue: ?string): Selector\n\t{\n\t\tconst label = this.#getFieldLabel(\n\t\t\t'TasksSortTasksHint',\n\t\t\tLoc.getMessage('SN_COLLAB_ACCESS_RIGHTS_TST_LABEL'),\n\t\t);\n\n\t\treturn this.#getSelector('initiate', label, options, selectedValue);\n\t}\n\n\t#getTasksCreateTasksField(options: { [string]: string }, selectedValue: ?string): Selector\n\t{\n\t\tconst label = this.#getFieldLabel(\n\t\t\t'TasksCreateTasksHint',\n\t\t\tLoc.getMessage('SN_COLLAB_ACCESS_RIGHTS_TCT_LABEL'),\n\t\t);\n\n\t\treturn this.#getSelector('initiate', label, options, selectedValue);\n\t}\n\n\t#getTasksEditTasksField(options: { [string]: string }, selectedValue: ?string): Selector\n\t{\n\t\tconst label = this.#getFieldLabel(\n\t\t\t'TasksEditTasksHint',\n\t\t\tLoc.getMessage('SN_COLLAB_ACCESS_RIGHTS_TET_LABEL'),\n\t\t);\n\n\t\treturn this.#getSelector('initiate', label, options, selectedValue);\n\t}\n\n\t#getTasksDeleteTasksField(options: { [string]: string }, selectedValue: ?string): Selector\n\t{\n\t\tconst label = this.#getFieldLabel(\n\t\t\t'TasksDeleteTasksHint',\n\t\t\tLoc.getMessage('SN_COLLAB_ACCESS_RIGHTS_TDT_LABEL'),\n\t\t);\n\n\t\treturn this.#getSelector('initiate', label, options, selectedValue);\n\t}\n\n\t#getFieldLabel(id: string, label: string, hint: ?string = null): string\n\t{\n\t\tif (hint === null)\n\t\t{\n\t\t\treturn `\n\t\t\t\t<div class=\"tasks-flow__create-title-with-hint\">\n\t\t\t\t\t${label}\n\t\t\t\t</div>\n\t\t\t`;\n\t\t}\n\n\t\treturn `\n\t\t\t<div class=\"tasks-flow__create-title-with-hint\">\n\t\t\t\t${label}\n\t\t\t\t<span\n\t\t\t\t\tdata-id=\"${id}\"\n\t\t\t\t\tclass=\"ui-hint\"\n\t\t\t\t\tdata-hint=\"${hint}\" \n\t\t\t\t\tdata-hint-no-icon\n\t\t\t\t><span class=\"ui-hint-icon\"></span></span>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\t#getSelector(\n\t\tid: string,\n\t\tlabel: HTMLElement,\n\t\toptions: { [string]: string },\n\t\tselectedValue: string = 'K',\n\t\tisFieldDisabled: boolean = false,\n\t): Selector\n\t{\n\t\tconst items = [];\n\n\t\tObject.entries(options).forEach(([value, name]) => {\n\t\t\titems.push({\n\t\t\t\tvalue,\n\t\t\t\tname,\n\t\t\t\tselected: value === selectedValue,\n\t\t\t});\n\t\t});\n\n\t\treturn new Selector({\n\t\t\tid: `sn-collab-form-field-${id}`,\n\t\t\tlabel,\n\t\t\titems,\n\t\t\tisFieldDisabled,\n\t\t\tcurrent: selectedValue,\n\t\t});\n\t}\n}\n","import { ajax, Loc } from 'main.core';\nimport { Params } from './access-rights';\nimport { Form } from './form';\n\nexport class AddForm extends Form\n{\n\t#params: Params;\n\n\tconstructor(params: Params)\n\t{\n\t\tsuper(params);\n\n\t\tthis.#params = params;\n\t}\n\n\topen()\n\t{\n\t\tconst slider = BX.SidePanel.Instance.getSlider(this.sidePanelId);\n\n\t\tif (slider?.isOpen())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tBX.SidePanel.Instance.open(this.sidePanelId, {\n\t\t\tcacheable: false,\n\t\t\ttitle: Loc.getMessage('SN_COLLAB_ACCESS_RIGHTS'),\n\t\t\tcontentCallback: async (sidePanel) => {\n\t\t\t\ttry\n\t\t\t\t{\n\t\t\t\t\tconst { data } = await ajax.runAction(\n\t\t\t\t\t\t'socialnetwork.collab.AccessRights.getAddForm',\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tdata: {},\n\t\t\t\t\t\t},\n\t\t\t\t\t);\n\n\t\t\t\t\tconst formData = this.#params?.formData ?? {};\n\n\t\t\t\t\treturn this.render({ ...this.prepareFormData(data), ...formData });\n\t\t\t\t}\n\t\t\t\tcatch (e)\n\t\t\t\t{\n\t\t\t\t\tconsole.error(e);\n\n\t\t\t\t\treturn Promise.reject();\n\t\t\t\t}\n\t\t\t},\n\t\t\twidth: 661,\n\t\t\tevents: {\n\t\t\t\tonLoad: this.onLoad.bind(this),\n\t\t\t\tonClose: this.onClose.bind(this),\n\t\t\t},\n\t\t});\n\t}\n}\n","import { ajax, Loc, Type } from 'main.core';\nimport { Params } from './access-rights';\nimport { Form } from './form';\n\nexport class EditForm extends Form\n{\n\t#params: Params;\n\n\tconstructor(params: Params)\n\t{\n\t\tsuper(params);\n\n\t\tthis.#params = params;\n\n\t\tif (!Type.isNumber(this.#params.collabId))\n\t\t{\n\t\t\tthrow new TypeError('Collab id is required');\n\t\t}\n\t}\n\n\topen()\n\t{\n\t\tconst sidePanelId = `sn-collab-access-rights-${this.#params.collabId}`;\n\n\t\tconst slider = BX.SidePanel.Instance.getSlider(sidePanelId);\n\n\t\tif (slider?.isOpen())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tBX.SidePanel.Instance.open(sidePanelId, {\n\t\t\tcacheable: false,\n\t\t\ttitle: Loc.getMessage('SN_COLLAB_ACCESS_RIGHTS'),\n\t\t\tcontentCallback: async (sidePanel) => {\n\t\t\t\ttry\n\t\t\t\t{\n\t\t\t\t\tconst { data } = await ajax.runAction(\n\t\t\t\t\t\t'socialnetwork.collab.AccessRights.getEditForm',\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\t\tcollabId: this.#params.collabId,\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t},\n\t\t\t\t\t);\n\t\t\t\t\tconst formData = this.#params?.formData ?? {};\n\n\t\t\t\t\treturn this.render({ ...this.prepareFormData(data), ...formData });\n\t\t\t\t}\n\t\t\t\tcatch (e)\n\t\t\t\t{\n\t\t\t\t\tconsole.error(e);\n\n\t\t\t\t\treturn Promise.reject();\n\t\t\t\t}\n\t\t\t},\n\t\t\twidth: 661,\n\t\t\tevents: {\n\t\t\t\tonLoad: this.onLoad.bind(this),\n\t\t\t\tonClose: this.onClose.bind(this),\n\t\t\t},\n\t\t});\n\t}\n}\n","import type { JsonObject } from 'main.core';\nimport { Form } from './form';\nimport { AddForm } from './add-form';\nimport { EditForm } from './edit-form';\n\nimport 'ui.design-tokens';\nimport 'ui.sidepanel-content';\n\nimport './css/base.css';\n\nexport type AccessRightsFormData = {\n\tmoderators: number[],\n\townerId: number,\n\toptions: JsonObject,\n\tpermissions: JsonObject\n};\n\nexport type Params = {\n\tcollabId?: number,\n\tenableServerSave?: boolean,\n\tformData: AccessRightsFormData,\n\tisAllowedInviteCollabers: boolean,\n};\n\nexport class AccessRights\n{\n\tstatic async openForm(params: Params): Promise<Form>\n\t{\n\t\tawait top.BX.Runtime.loadExtension(\n\t\t\t'socialnetwork.collab.access-rights',\n\t\t);\n\n\t\tconst isEditMode = Number(params?.collabId) > 0;\n\t\tif (isEditMode)\n\t\t{\n\t\t\tconst form = new EditForm(params);\n\t\t\tform.open();\n\n\t\t\treturn form;\n\t\t}\n\n\t\tconst form = new AddForm(params);\n\t\tform.open();\n\n\t\treturn form;\n\t}\n}\n"],"names":["Form","params","setEventNamespace","sidePanelId","data","id","Number","ownerId","moderators","Type","isArray","moderatorMembers","permissions","isPlainObject","options","permissionsLabels","rightsPermissionsLabels","optionsLabels","isAllowedInviteCollabers","isBoolean","formData","uiStyles","Tag","render","Loc","getMessage","ownerField","moderatorsField","showHistory","whoCanInvite","allowGuestsInvitation","manageMessages","tasksViewUsersField","tasksSortTasksField","tasksCreateTasksField","tasksEditTasksField","tasksDeleteTasksField","content","form","Event","bind","event","BX","UI","Hint","createInstance","popupParameters","targetContainer","window","top","document","body","init","slider","getContainer","hide","EventEmitter","buttons","save","cancel","enableServerSave","ajax","runAction","then","close","error","console","emit","ownerIds","getSelector","getTags","map","tag","length","setErrors","cleanError","getDialog","isLoaded","getValue","tasks","view_all","sort","create_tasks","edit_tasks","delete_tasks","label","UserSelector","enableAll","enableDepartments","multiple","values","moderatorId","selectedValue","isFieldDisabled","hint","items","Object","entries","forEach","value","name","push","selected","Selector","current","AddForm","_classPrivateFieldInitSpec","SidePanel","Instance","getSlider","isOpen","open","cacheable","title","contentCallback","sidePanel","prepareFormData","Promise","reject","width","events","onLoad","onClose","EditForm","isNumber","collabId","TypeError","AccessRights","Runtime","loadExtension","isEditMode"],"mappings":"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"}