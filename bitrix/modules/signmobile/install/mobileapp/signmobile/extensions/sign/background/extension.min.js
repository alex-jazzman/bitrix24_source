(()=>{const e=e=>jn.require(e);const{Push:n}=e("native/app");const{SignOpener:s}=e("sign/opener");const{PushListener:t}=e("push/listeners");const i="SIGN_MOBILE_FOUND_DOCUMENT_FOR_SIGNING";const r="SIGN_MOBILE_REQUEST_FOR_SIGN_CONFIRMATION";class a{constructor(){s.clearCacheSomeBannerIsAlreadyOpen();this.bindEvents()}unpackJsonEventParams(e){let n=null;const s=JSON.parse(e);if(s.message){const e=JSON.parse(s.message);n=this.unpackEventParams(e)}return n}unpackEventParams(e){let n=null;const s=e.payload;if(s){const{role:t,memberId:i=0,forcedBannerOpening:r=false,isGoskey:a=false,isExternal:o=false,initiatedByType:c}=s;n={type:e.type,role:t,memberId:Number(i),forcedBannerOpening:r,title:"",url:"",isGoskey:a,isExternal:o,initiatedByType:c};const l=s.document;if(l){const{title:e="",url:s=""}=l;n.title=e;n.url=s}}return n}processEvent(e){if(e!==null){const{url:n,title:t,memberId:a,role:o,forcedBannerOpening:c,isGoskey:l,isExternal:p,initiatedByType:u}=e;switch(e.type){case i:s.openSigning({url:n,title:t,memberId:a,role:o,goWithoutConfirmation:false,isGoskey:l,isExternal:p,initiatedByType:u});break;case r:s.openConfirmation({role:o,memberId:a,title:t,forcedBannerOpening:c,initiatedByType:u});break;default:break}}}bindEvents(){n.on("receivedPush",(({params:e})=>{this.processEvent(this.unpackJsonEventParams(e))}));t.subscribe(i,(e=>{this.processEvent(this.unpackEventParams(e))}));t.subscribe(r,(e=>{this.processEvent(this.unpackEventParams(e))}));BX.addCustomEvent("signbackground::router",(e=>{s.openSigning({memberId:e})}))}}this.SignBackground=new a})();
//# sourceMappingURL=extension.map.js