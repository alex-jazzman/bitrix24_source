jn.define("sign/grid/item-factory/document",((e,t,s)=>{const{ChipStatus:i,ChipStatusDesign:r,ChipStatusMode:n}=e("ui-system/blocks/chips/chip-status");const{Button:o,ButtonSize:a,ButtonDesign:d}=e("ui-system/form/buttons/button");const{BadgeCounter:u,BadgeCounterDesign:m}=e("ui-system/blocks/badges/counter");const{makeLibraryImagePath:S}=e("ui-system/blocks/status-block");const{Base:g}=e("layout/ui/simple-list/items/base");const{IconView:c,Icon:I}=e("ui-system/blocks/icon");const{H5:l}=e("ui-system/typography/heading");const{Text6:D}=e("ui-system/typography/text");const{Avatar:h}=e("ui-system/blocks/avatar");const{InitiatedByType:p}=e("sign/type/initiated-by-type");const{ActionStatus:_}=e("sign/type/action-status");const{MemberStatus:E}=e("sign/type/member-status");const{DocumentStatus:b}=e("sign/type/document-status");const{MemberRole:M}=e("sign/type/member-role");const{downloadFile:T}=e("sign/download-file");const{SignOpener:y}=e("sign/opener");const{FriendlyDate:N}=e("layout/ui/friendly-date");const{date:C}=e("utils/date/formats");const{Moment:B}=e("utils/date");const{Indent:U,Color:G,Component:A}=e("tokens");const{useCallback:O}=e("utils/function");const{Loc:R}=e("loc");const{UserProfile:f}=e("user-profile");const w={default:"sign-doc.svg",pdf:"pdf-doc.svg",zip:"zip-doc.svg"};class k extends g{renderItemContent(){return View({style:{position:"relative",paddingLeft:A.cardPaddingLr.toNumber(),paddingRight:A.cardPaddingLr.toNumber(),paddingBottom:A.cardPaddingB.toNumber(),paddingTop:A.cardPaddingT.toNumber(),borderRadius:A.cardCorner.toNumber(),borderColor:G.bgSeparatorPrimary.toHex(),marginBottom:15,marginLeft:15,marginRight:13,borderWidth:1}},View({style:{flexDirection:"row"}},this.renderImage(),this.renderBody(),this.renderDownloadButton()),this.renderActionButton(),this.renderBadge())}renderImage(){const e=_.isDownloadStatus(this.getAction())?w[this.getFileExtension()]??w.default:w.default;return Image({svg:{uri:S(e,"empty-states","sign")},style:{width:40,height:40}})}renderBody(){return View({style:{flex:1,paddingLeft:U.XL.toNumber(),paddingBottom:U.M.toNumber()}},this.renderTitle(),this.renderDescription(),this.renderSecondSide())}renderTitle(){return this.renderText({type:"title",text:this.getDocumentTitle(),typography:l,style:{marginBottom:U.XS.toNumber(),marginRight:15}})}renderDescription(){if(p.isInitiatedByEmployee(this.getDocumentInitiatedType())&&!b.isFinalStatus(this.getDocumentStatus())&&this.isInitiatorCurrentUser()&&!_.isActionStatus(this.getAction())){return this.renderText({type:"description",text:R.getMessage("SIGN_MOBILE_GRID_DOCUMENT_DATE_SEND",{"#DATE#":this.getDocumentSendDate()}),typography:D,style:{marginTop:U.M.toNumber(),marginBottom:U.M.toNumber()}})}return View()}renderSecondSide(){if(!_.isActionStatus(this.getAction())){const{secondSideText:e,SecondSideDesign:t,secondSideMemberId:s}=this.prepareSecondSideData();return View({style:{flexDirection:"row",marginTop:10},onClick:O((()=>this.#e(s)),[s])},h({id:s,testId:`document-${this.getMemberId(0)}-userAvatar`,size:24,withRedux:true,onClick:O((()=>this.#e(s)),[s])}),i({text:e,design:t,mode:n.OUTLINE,testId:`document-${this.getMemberId(0)}-chipStatus`,style:{marginLeft:10}}))}return View()}renderDownloadButton(){if(_.isDownloadStatus(this.getAction())&&this.getFileUrl()){return View({style:{display:"flex",align:"center",justifyContent:"center"}},c({size:{height:40,width:40},testId:`document-${this.getMemberId(0)}-downloadButton`,icon:I.CHEVRON_TO_THE_RIGHT_SIZE_S,color:G.base1,opacity:.5,onClick:this.#t}))}return View()}renderBadge(){if(!_.isActionStatus(this.getAction())){return View()}return View({style:{position:"absolute",top:U.S.toNumber(),right:U.S.toNumber()}},u({value:1,design:m.ALERT,testId:`documentAction-${this.getMemberId(0)}-badge`}))}renderActionButton(){let e="";switch(this.getAction()){case _.SIGN.value:e=R.getMessage("SIGN_MOBILE_GRID_SIGN_BUTTON_TEXT");break;case _.APPROVE.value:e=R.getMessage("SIGN_MOBILE_GRID_APPROVE_BUTTON_TEXT");break;case _.EDIT.value:e=R.getMessage("SIGN_MOBILE_GRID_EDIT_BUTTON_TEXT");break;default:return View()}return o({text:e,testId:`document-${this.getMemberId(0)}-actionButton`,size:a.M,design:d.OUTLINE_ACCENT_2,stretched:true,onClick:this.#s,style:{width:"50%",marginTop:10}})}prepareSecondSideData(){let e="";let t=r.NEUTRAL;let s=this.getMemberUserId(0);if(p.isInitiatedByEmployee(this.getDocumentInitiatedType())&&this.isInitiatorCurrentUser()&&this.isMemberCurrentUser()&&!b.isFinalStatus(this.getDocumentStatus())&&!E.isDoneStatus(this.getMemberStatus(0))){switch(this.getMemberRole(0)){case M.ASSIGNEE.value:case M.SIGNER.value:e=R.getMessage("SIGN_MOBILE_GRID_SECOND_SIDE_STATUS_SIGNING");break;case M.EDITOR.value:e=R.getMessage("SIGN_MOBILE_GRID_SECOND_SIDE_STATUS_EDITING");break;case M.REVIEWER.value:e=R.getMessage("SIGN_MOBILE_GRID_SECOND_SIDE_STATUS_APPROVING");break;default:break}return{secondSideText:e,SecondSideDesign:t,secondSideMemberId:s}}if(E.isCanceledStatus(this.getMemberStatus(0))||b.isStopped(this.getDocumentStatus())){if(this.isCurrentUserCanceled()){return{secondSideText:R.getMessage("SIGN_MOBILE_GRID_SECOND_SIDE_STATUS_REFUSED_BY_YOU",{"#DATE#":String(this.getDocumentCancelledDate())}),SecondSideDesign:r.WARNING,secondSideMemberId:this.getInitiatorUserId()}}if(p.isInitiatedByEmployee(this.getDocumentInitiatedType())&&(this.isInitiatorCurrentUser()&&!this.isMemberCurrentUser()||this.isSecondSideStopped(0))){return{secondSideText:R.getMessage("SIGN_MOBILE_GRID_SECOND_SIDE_STATUS_REFUSED",{"#DATE#":String(this.getDocumentCancelledDate())}),SecondSideDesign:r.WARNING,secondSideMemberId:s}}}switch(this.getMemberRole(0)){case M.ASSIGNEE.value:case M.SIGNER.value:if(E.isDoneStatus(this.getMemberStatus(0))){t=r.SUCCESS;e=R.getMessage(this.isMemberCurrentUser()?"SIGN_MOBILE_GRID_SECOND_SIDE_STATUS_SIGN_BY_YOU":"SIGN_MOBILE_GRID_SECOND_SIDE_STATUS_SIGN",{"#DATE#":String(this.getDocumentSignDate())})}else{e=R.getMessage("SIGN_MOBILE_GRID_SECOND_SIDE_STATUS_SIGNING")}break;case M.EDITOR.value:if(E.isDoneStatus(this.getMemberStatus(0))){e=R.getMessage(this.isMemberCurrentUser()?"SIGN_MOBILE_GRID_SECOND_SIDE_STATUS_EDIT_BY_YOU":"SIGN_MOBILE_GRID_SECOND_SIDE_STATUS_EDIT",{"#DATE#":String(this.getDocumentEditDate())})}else{e=R.getMessage("SIGN_MOBILE_GRID_SECOND_SIDE_STATUS_EDITING")}break;case M.REVIEWER.value:if(E.isDoneStatus(this.getMemberStatus(0))){e=R.getMessage(this.isMemberCurrentUser()?"SIGN_MOBILE_GRID_SECOND_SIDE_STATUS_APPROVE_BY_YOU":"SIGN_MOBILE_GRID_SECOND_SIDE_STATUS_APPROVE",{"#DATE#":String(this.getDocumentApprovedDate())})}else{e=R.getMessage("SIGN_MOBILE_GRID_SECOND_SIDE_STATUS_APPROVING")}break;default:break}s=this.isMemberCurrentUser()&&E.isDoneStatus(this.getMemberStatus(0))?this.getInitiatorUserId():s;return{secondSideText:e,SecondSideDesign:t,secondSideMemberId:s}}renderText({text:e,typography:t,style:s}){return typeof e==="string"?t({text:e,style:s}):View({style:s},e)}isCurrentUserCanceled(){if(this.isMemberCurrentUser()&&E.isCanceledStatus(this.getMemberStatus(0))){return true}else if(this.isMyMemberCurrentUser()&&E.isCanceledStatus(this.getMyMemberStatus())){return true}return false}isMyMemberCurrentUser(){return Number(env.userId)===this.getMyMemberUserId()&&this.getMemberUserId(0)===this.getMyMemberUserId()}isMemberCurrentUser(){return Number(env.userId)===this.getMemberUserId(0)}isInitiatorCurrentUser(){return Number(env.userId)===this.getInitiatorUserId()}isSecondSideStopped(e){return this.props.item?.members[e]?.isStopped}#e=e=>{void f.open({ownerId:e})};#t=()=>T(currentDomain+String(this.getFileUrl()));#s=()=>{y.openSigning({memberId:this.getMemberId(0)})};getFileExtension(){return this.props.item?.file?.ext}getDocumentTitle(){return this.props.item?.document?.title}getDocumentInitiatedType(){return this.props.item?.document?.initiatedByType}getDocumentSendDate(){return this.getFormattedDate(this.props.item?.document?.sendDate)}getDocumentCancelledDate(){return this.getFormattedDate(this.props.item?.document?.cancelledDate)}getDocumentSignDate(){return this.getFormattedDate(this.props.item?.document?.signDate)}getDocumentEditDate(){return this.getFormattedDate(this.props.item?.document?.editDate)}getDocumentApprovedDate(){return this.getFormattedDate(this.props.item?.document?.approvedDate)}getFormattedDate(e){if(!e){return""}const t=new B(e);return new N({moment:t,defaultFormat:C(),useTimeAgo:true}).makeText(t)}getAction(){return this.props.item?.action}getDocumentStatus(){return this.props.item?.document?.status}getFileUrl(){return this.props.item?.file?.url}getMemberStatus(e){return this.props.item?.members[e]?.status}getMyMemberStatus(){return this.props.item?.myMemberInProcess?.status}getMyMemberUserId(){return this.props.item?.myMemberInProcess?.userId}getMemberRole(e){return this.props.item?.members[e]?.role}getMemberUserId(e){return this.props.item?.members[e]?.userId}getMemberId(e){return this.props.item?.members[e]?.id}getInitiatorUserId(){return this.props.item?.document?.initiator?.userId}}s.exports={Document:k}}));
//# sourceMappingURL=extension.map.js