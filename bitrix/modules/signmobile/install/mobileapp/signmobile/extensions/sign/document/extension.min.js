jn.define("sign/document",((e,t,i)=>{const{Card:o}=e("ui-system/layout/card");const{ButtonSize:s,ButtonDesign:n,Button:r}=e("ui-system/form/buttons/button");const{Indent:l,Color:a}=e("tokens");const{Icon:c}=e("assets/icons");const{Loc:_}=e("loc");const{ResponseMobile:I}=e("sign/dialog/banners/responsemobile");const{InitiatedByType:d}=e("sign/type/initiated-by-type");const{External:E}=e("sign/dialog/banners/external");const{NotifyManager:T}=e("notify-manager");const{showConfirm:N}=e("sign/dialog/banners/template");const{rejectConfirmation:u,reviewAccept:C}=e("sign/connector");const{showToast:g,showErrorToast:O,Position:h}=e("toast");const{MemberRole:R}=e("sign/type/member-role");const B=Application.getPlatform()==="ios";const M="https://www.gosuslugi.ru/select-app-goskey";class m extends LayoutComponent{constructor(e){super(e);const{url:t,widget:i,memberId:o,title:s,isGoskey:n,isExternal:r,initiatedByType:l,role:a}=e;this.layout=i;const c=t.indexOf("?")!==-1?"&":"?";this.url=t+c+"hide_reviewer_buttons=1";this.memberId=o;this.isGoskey=n;this.isExternal=r;this.title=s;this.initiatedByType=l;this.role=a}clearHeader(){this.layout.setTitle({text:""});this.layout.setRightButtons([]);this.layout.setLeftButtons([])}render(){return View({style:{backgroundColor:a.bgPrimary.toHex(),flex:1}},WebView({style:{flex:1},scrollDisabled:true,zoomEnabled:true,data:{url:this.url}}),View({style:{paddingBottom:B?device.screen.safeArea.bottom:0}},R.isReviewerRole(this.role)?this.renderReviewButtons():this.renderSignButtons()))}renderSignButtons(){return o({testId:`signButtons-card`},r({testId:`signDocument-button-confirm`,text:_.getMessage("SIGN_MOBILE_DOCUMENT_CONFIRM_SIGNING_BUTTON_TITLE"),size:s.XL,design:n.FILLED,disabled:false,badge:false,stretched:true,onClick:this.#e,style:{marginBottom:l.L.toNumber()}}),this.renderRejectButton())}renderReviewButtons(){return o({testId:`reviewButtons-card`},r({testId:`signDocument-button-review`,text:_.getMessage("SIGN_MOBILE_DOCUMENT_CONFIRM_REVIEW_BUTTON_TITLE"),size:s.XL,design:n.FILLED,disabled:false,badge:false,stretched:true,onClick:this.#t,style:{marginBottom:l.L.toNumber()}}),this.renderRejectButton())}renderRejectButton(){const{titleCode:e}=this.#i();return r({testId:`signDocument-button-Reject`,text:_.getMessage(e),size:s.XL,design:n.PLAN_ACCENT,disabled:false,badge:false,stretched:true,onClick:this.#o})}#e=()=>{if(this.isGoskey){if(Application.canOpenUrl(M)){Application.openUrl(M)}return}this.clearHeader();if(this.isExternal){this.layout.showComponent(new E({documentTitle:this.title,memberId:this.memberId,layoutWidget:this.layout}));return}this.layout.showComponent(new I({documentTitle:this.title,memberId:this.memberId,layoutWidget:this.layout,initiatedByType:this.initiatedByType}))};#t=()=>{T.showLoadingIndicator();C(this.memberId).then((()=>{T.hideLoadingIndicatorWithoutFallback();this.layout.close();g({message:_.getMessage("SIGN_MOBILE_DOCUMENT_CONFIRM_REVIEW_SUCCESS_TITLE"),icon:c.CHECK,position:h.BOTTOM,offset:120})})).catch((()=>{this.layout.close();O({message:_.getMessage("SIGN_MOBILE_DOCUMENT_UNKNOWN_ERROR_TEXT"),position:h.BOTTOM,offset:120})}))};#o=()=>{if(this.isGoskey&&!R.isReviewerRole(this.role)){if(Application.canOpenUrl(M)){Application.openUrl(M)}return}const{titleCode:e,confirmTitleCode:t,descriptionCode:i,cancelTitleCode:o}=this.#i();N({title:_.getMessage(e),description:_.getMessage(i),confirmTitle:_.getMessage(t),cancelTitle:_.getMessage(o),onConfirm:this.#s})};#s=()=>{T.showLoadingIndicator();u(this.memberId).then((()=>{T.hideLoadingIndicatorWithoutFallback();this.layout.close();g({message:_.getMessage("SIGN_MOBILE_DOCUMENT_REFUSED_REVIEW_TITLE"),icon:c.CROSS,position:h.BOTTOM,offset:120})})).catch((()=>{this.layout.close();O({message:_.getMessage("SIGN_MOBILE_DOCUMENT_UNKNOWN_ERROR_TEXT"),position:h.BOTTOM,offset:120})}))};#i(){const e=d.isInitiatedByEmployee(this.initiatedByType);const t=R.isReviewerRole(this.role);const i=R.isSignerRole(this.role);const o=e||t?"SIGN_MOBILE_DOCUMENT_CONFIRM_SIGNING_REJECT_BY_EMPLOYEE_TITLE":"SIGN_MOBILE_DOCUMENT_CONFIRM_SIGNING_REJECT_TITLE";const s=e||t?"SIGN_MOBILE_DOCUMENT_CONFIRM_SIGNING_ALERT_BY_EMPLOYEE_REJECT_BUTTON_TITLE":"SIGN_MOBILE_DOCUMENT_CONFIRM_SIGNING_ALERT_REJECT_BUTTON_TITLE";let n=e&&i?"SIGN_MOBILE_DOCUMENT_CONFIRM_SIGNING_ALERT_BY_EMPLOYEE_DESCRIPTION":t?"SIGN_MOBILE_DOCUMENT_CONFIRM_SIGNING_ALERT_BY_REVIEWER_DESCRIPTION":"SIGN_MOBILE_DOCUMENT_CONFIRM_SIGNING_ALERT_DESCRIPTION";const r=t?"SIGN_MOBILE_DOCUMENT_CONFIRM_SIGNING_ALERT_CANCEL_BY_REVIEWER_BUTTON_TITLE":"SIGN_MOBILE_DOCUMENT_CONFIRM_SIGNING_ALERT_CANCEL_BUTTON_TITLE";return{titleCode:o,confirmTitleCode:s,descriptionCode:n,cancelTitleCode:r}}}i.exports={SignDocument:m}}));
//# sourceMappingURL=extension.map.js