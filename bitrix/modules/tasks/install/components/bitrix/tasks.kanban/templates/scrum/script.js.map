{"version":3,"file":"script.js","sources":["src/pull.item.js","src/kanban.component.js","src/kanban.manager.js"],"sourcesContent":["import {EventEmitter} from 'main.core.events';\n\nexport type UpdateParams = {\n\tid: number,\n\tgroupId: number,\n\tsourceId: number,\n\ttmpId?: string\n}\n\nexport class PullItem extends EventEmitter\n{\n\tconstructor()\n\t{\n\t\tsuper();\n\n\t\tthis.setEventNamespace('BX.Tasks.Scrum.KanbanManager.PullItem');\n\t}\n\n\tgetModuleId(): string\n\t{\n\t\treturn 'tasks';\n\t}\n\n\tgetMap(): Object\n\t{\n\t\treturn {\n\t\t\titemUpdated: this.onItemUpdated.bind(this),\n\t\t};\n\t}\n\n\tonItemUpdated(params: UpdateParams)\n\t{\n\t\tthis.emit('itemUpdated', params);\n\t}\n}","export type AjaxComponentParams = {\n\tUSER_ID: number,\n\tGROUP_ID: number,\n\tGROUP_ID_FORCED: number,\n\tSPRINT_ID: number,\n\tPERSONAL: string,\n\tTIMELINE_MODE: string\n}\n\ntype Params = {\n\tfilterId: string,\n\tdefaultPresetId: string,\n\tajaxComponentPath: string,\n\tajaxComponentParams: AjaxComponentParams\n}\n\nexport class KanbanComponent\n{\n\tconstructor(params: Params)\n\t{\n\t\tthis.filterId = params.filterId;\n\t\tthis.defaultPresetId = params.defaultPresetId;\n\t\tthis.ajaxComponentPath = params.ajaxComponentPath;\n\t\tthis.ajaxComponentParams = params.ajaxComponentParams;\n\t}\n\n\tonClickSort(item: HTMLElement, order?: string)\n\t{\n\t\tif (!Dom.hasClass(item, 'menu-popup-item-accept'))\n\t\t{\n\t\t\tthis.refreshIcons(item);\n\t\t\tthis.saveSelection(order);\n\t\t}\n\t}\n\n\trefreshIcons(item: HTMLElement)\n\t{\n\t\titem.parentElement.childNodes.forEach((element) => {\n\t\t\tDom.removeClass(element, 'menu-popup-item-accept');\n\t\t})\n\n\t\tDom.addClass(item, 'menu-popup-item-accept');\n\t}\n\n\tsaveSelection(order?: string)\n\t{\n\t\tBX.ajax.runComponentAction('bitrix:tasks.kanban', 'setNewTaskOrder', {\n\t\t\tmode: 'class',\n\t\t\tdata: {\n\t\t\t\torder: (order ? order : 'desc'),\n\t\t\t\tparams: this.ajaxComponentParams,\n\t\t\t},\n\t\t}).then(\n\t\t\t(response) => {\n\t\t\t\tconst data = response.data;\n\t\t\t\tBX.onCustomEvent(this, 'onTaskSortChanged', [data]);\n\t\t\t},\n\t\t);\n\t}\n}","import {Loc, Dom, Tag, Type, Text, Event, Runtime} from 'main.core';\nimport {BaseEvent, EventEmitter} from 'main.core.events';\n\nimport {PULL as Pull} from 'pull.client';\n\nimport {PullItem, UpdateParams} from './pull.item';\n\nimport {KanbanComponent, AjaxComponentParams} from './kanban.component';\n\nimport './css/base.css';\n\ntype Column = {\n\tid: number,\n\tname: string,\n\tsort: number,\n\tcolor: string,\n\ttotal: number,\n\ttype: string\n}\n\ntype Item = {\n\tid: number,\n\tparentId: number,\n\tcolumnId: number\n}\n\ntype ParentTask = {\n\tid: number,\n\tname: string,\n\tcompleted: 'Y' | 'N',\n\tstoryPoints: string,\n\tisVisibilitySubtasks: 'Y' | 'N',\n\tparentId: number,\n\tcolumnId: number,\n\tcolumns: Array<Column>,\n\titems: Array<Item>\n}\n\ntype Params = {\n\tsignedParameters: string,\n\tfilterId: string,\n\tdefaultPresetId: string,\n\tajaxComponentPath: string,\n\tajaxComponentParams: AjaxComponentParams,\n\tsiteTemplateId: string,\n\tsprintSelected: boolean,\n\tisActiveSprint: boolean,\n\tparentTasks: {\n\t\t[id: number]: ParentTask\n\t}\n}\n\ntype KanbanParams = {\n\tcolumns: Object,\n\titems: Object,\n\tcustomSectionsFields: Object,\n\tpathToTask: string,\n\tpathToTaskCreate: string,\n\tpathToUser: string,\n\taddItemInSlider: boolean,\n\tnewTaskOrder: string,\n\tsetClientDate: boolean,\n\tadmins: Object,\n\townerId: number,\n\tgroupId: number,\n\tkanbanHeader: boolean,\n\tparentTaskId?: number,\n\tparentTaskName?: string,\n\tparentTaskCompleted?: boolean\n}\n\ntype Response = {\n\tcolumns: Object,\n\titems: Object,\n\tparentTasks: {\n\t\t[id: number]: ParentTask\n\t}\n}\n\nexport class KanbanManager\n{\n\tconstructor(params: Params)\n\t{\n\t\tthis.groupId = parseInt(params.groupId, 10);\n\t\tthis.filterId = params.filterId;\n\t\tthis.siteTemplateId = params.siteTemplateId;\n\t\tthis.ajaxComponentPath = params.ajaxComponentPath;\n\t\tthis.ajaxComponentParams = params.ajaxComponentParams;\n\t\tthis.sprintSelected = params.sprintSelected;\n\t\tthis.isActiveSprint = params.isActiveSprint;\n\n\t\tthis.kanbanHeader = null;\n\t\tthis.kanban = null;\n\t\tthis.kanbanGroupedByParentTasks = new Map();\n\n\t\tthis.parentTasks = params.parentTasks;\n\n\t\tthis.kanbanComponent = new KanbanComponent({\n\t\t\tfilterId: params.filterId,\n\t\t\tdefaultPresetId: params.defaultPresetId,\n\t\t\tajaxComponentPath: params.ajaxComponentPath,\n\t\t\tajaxComponentParams: params.ajaxComponentParams\n\t\t});\n\n\t\tthis.pullItem = new PullItem({\n\t\t\tgroupId: this.groupId\n\t\t});\n\t\tthis.pullItem.subscribe('itemUpdated', this.onItemUpdated.bind(this));\n\n\t\tEventEmitter.subscribe('BX.Main.Filter:apply', (event: BaseEvent) => {\n\t\t\tconst [filterId, values, filterInstance, promise, params] = event.getCompatData();\n\t\t\tthis.onApplyFilter(filterId, values, filterInstance, promise, params);\n\t\t});\n\n\t\tEventEmitter.subscribe('onTasksGroupSelectorChange', this.onChangeSprint.bind(this));\n\n\t\tEventEmitter.subscribe('tasks-kanban-settings-fields-view', () => this.kanban.showFieldsSelectPopup());\n\n\t\tPull.subscribe(this.pullItem);\n\t}\n\n\tdrawKanban(renderTo: HTMLElement, params: KanbanParams)\n\t{\n\t\tif (!this.sprintSelected)\n\t\t{\n\t\t\tthis.showNotSprintMessage(renderTo);\n\n\t\t\treturn;\n\t\t}\n\n\t\tthis.inputRenderTo = renderTo;\n\t\tthis.inputKanbanParams = params;\n\n\t\tthis.drawKanbanHeader(renderTo, params);\n\t\tthis.drawKanbanWithoutGrouping(renderTo, params);\n\t\tthis.drawKanbanInGroupingMode(renderTo, params);\n\t\tthis.fillNeighborKanbans();\n\t\tthis.updateHeaderColumns();\n\n\t\tthis.adjustGroupHeadersWidth();\n\t\tEventEmitter.subscribe(this.kanbanHeader, 'Kanban.Grid:onColumnAddedAsync', () => {\n\t\t\tthis.adjustGroupHeadersWidth();\n\t\t});\n\t\tEventEmitter.subscribe(this.kanbanHeader, 'Kanban.Grid:onColumnRemovedAsync', () => {\n\t\t\tsetTimeout(() => {\n\t\t\t\tthis.adjustGroupHeadersWidth();\n\t\t\t}, 200);\n\t\t});\n\t}\n\n\tgetKanbanHeader()\n\t{\n\t\treturn this.kanbanHeader;\n\t}\n\n\tgetKanban()\n\t{\n\t\treturn this.kanban;\n\t}\n\n\tgetKanbansGroupedByParentTasks(): Map\n\t{\n\t\treturn this.kanbanGroupedByParentTasks;\n\t}\n\n\tdrawKanbanInGroupingMode(renderTo: HTMLElement, params: KanbanParams)\n\t{\n\t\tDom.addClass(renderTo, 'tasks-scrum-kanban');\n\n\t\tif (this.isParentTaskGrouping())\n\t\t{\n\t\t\tfor (const parentTaskId in this.parentTasks)\n\t\t\t{\n\t\t\t\tif (this.parentTasks[parentTaskId]['isVisibilitySubtasks'] === 'N')\n\t\t\t\t{\n\t\t\t\t\tdelete this.parentTasks[parentTaskId];\n\n\t\t\t\t\tif (!this.kanban.getItem(parentTaskId))\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.kanban.refreshTask(parentTaskId);\n\t\t\t\t\t}\n\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tconst kanbanNode = this.createParentTaskKanbanNode(this.parentTasks[parentTaskId]);\n\t\t\t\tconst parentTaskCompleted = (this.parentTasks[parentTaskId]['completed'] === 'Y');\n\t\t\t\tif (parentTaskCompleted)\n\t\t\t\t{\n\t\t\t\t\tthis.setTextDecorationToParentTaskName(kanbanNode);\n\t\t\t\t}\n\t\t\t\tDom.append(kanbanNode, renderTo);\n\n\t\t\t\tconst tickButtonNode = kanbanNode.querySelector('.tasks-scrum-kanban-group-header-tick');\n\t\t\t\tEvent.bind(tickButtonNode, 'click', () => {\n\t\t\t\t\tthis.toggleGroupingVisibility(kanbanNode);\n\t\t\t\t});\n\n\t\t\t\tconst container = kanbanNode.querySelector('.tasks-scrum-kanban-container');\n\t\t\t\tthis.drawKanbanGroupedByParentTasks(this.parentTasks[parentTaskId], container, params);\n\t\t\t}\n\t\t}\n\t}\n\n\tdrawKanbanHeader(renderTo: HTMLElement, params: KanbanParams)\n\t{\n\t\tconst headerParams = Runtime.clone(params);\n\n\t\theaderParams.kanbanHeader = true;\n\t\theaderParams.items = [];\n\n\t\tthis.kanbanHeader = new BX.Tasks.Kanban.Grid(this.getKanbanParams(renderTo, headerParams));\n\n\t\tthis.kanbanHeader.draw();\n\t}\n\n\tdrawKanbanWithoutGrouping(renderTo: HTMLElement, params: KanbanParams)\n\t{\n\t\tthis.kanban = new BX.Tasks.Kanban.Grid(this.getKanbanParams(renderTo, params));\n\n\t\tEventEmitter.subscribe(\n\t\t\tthis.kanban,\n\t\t\t'Kanban.Grid:onAddParentTask',\n\t\t\t(baseEvent: BaseEvent) => {\n\t\t\t\tconst parentTask: ParentTask = baseEvent.getData();\n\t\t\t\tthis.createParentTaskKanban(parentTask);\n\t\t\t\tthis.fillNeighborKanbans();\n\t\t\t\tthis.adjustGroupHeadersWidth();\n\t\t\t\tthis.kanban.addItemsFromQueue();\n\t\t\t}\n\t\t);\n\n\t\tthis.kanban.draw();\n\t}\n\n\tdrawKanbanGroupedByParentTasks(parentTask: ParentTask, renderTo: HTMLElement, params: KanbanParams)\n\t{\n\t\tconst parentTaskId = parseInt(parentTask.id, 10);\n\n\t\tconst headerParams = Runtime.clone(params);\n\n\t\theaderParams.columns = parentTask.columns;\n\t\theaderParams.items = parentTask.items;\n\t\theaderParams.parentTaskId = parentTaskId;\n\t\theaderParams.parentTaskName = parentTask.name;\n\t\theaderParams.parentTaskCompleted = (parentTask.completed === 'Y');\n\n\t\tconst kanban = new BX.Tasks.Kanban.Grid(this.getKanbanParams(renderTo, headerParams));\n\n\t\tkanban.draw();\n\n\t\tif (headerParams.parentTaskCompleted && !kanban.hasItemInProgress())\n\t\t{\n\t\t\tconst container = kanban.getRenderToContainer().closest('.tasks-scrum-parent-task-kanban');\n\t\t\tthis.downGroupingVisibility(container);\n\t\t}\n\n\t\tEventEmitter.subscribe(\n\t\t\tkanban,\n\t\t\t'Kanban.Grid:onCompleteParentTask',\n\t\t\t() => {\n\t\t\t\tthis.onCompleteParentTask(kanban);\n\t\t\t}\n\t\t);\n\n\t\tEventEmitter.subscribe(\n\t\t\tkanban,\n\t\t\t'Kanban.Grid:onRenewParentTask',\n\t\t\t() => {\n\t\t\t\tthis.onRenewParentTask(kanban);\n\t\t\t}\n\t\t);\n\n\t\tEventEmitter.subscribe(\n\t\t\tkanban,\n\t\t\t'Kanban.Grid:onProceedParentTask',\n\t\t\t() => {\n\t\t\t\tthis.onProceedParentTask(kanban);\n\t\t\t}\n\t\t);\n\n\t\tEventEmitter.subscribe(\n\t\t\tkanban,\n\t\t\t'Kanban.Grid:onAddItemInProgress',\n\t\t\t(baseEvent: BaseEvent) => {\n\t\t\t\tconst container = kanban.getRenderToContainer().closest('.tasks-scrum-parent-task-kanban');\n\t\t\t\tthis.upGroupingVisibility(container);\n\t\t\t}\n\t\t);\n\n\t\tthis.kanbanGroupedByParentTasks.set(parentTaskId, kanban);\n\t}\n\n\tfillNeighborKanbans()\n\t{\n\t\tthis.addNeighborKanban(this.kanbanHeader);\n\n\t\tthis.addNeighborKanban(this.kanban);\n\n\t\tthis.kanbanGroupedByParentTasks.forEach((parentTaskKanban) => {\n\t\t\tthis.addNeighborKanban(parentTaskKanban);\n\t\t});\n\t}\n\n\tcleanNeighborKanbans()\n\t{\n\t\tthis.kanbanHeader.cleanNeighborGrids();\n\n\t\tthis.kanban.cleanNeighborGrids();\n\n\t\tthis.kanbanGroupedByParentTasks\n\t\t\t.forEach((parentTaskKanban) => {\n\t\t\t\tthis.removeParentTaskKanban(parentTaskKanban);\n\t\t\t\tparentTaskKanban.cleanNeighborGrids();\n\t\t\t})\n\t\t;\n\n\t\tthis.kanbanGroupedByParentTasks.clear();\n\t}\n\n\tupdateHeaderColumns()\n\t{\n\t\tthis.kanbanHeader.updateTotals();\n\t}\n\n\taddNeighborKanban(kanban)\n\t{\n\t\tthis.kanbanHeader.addNeighborGrid(kanban);\n\n\t\tthis.kanban.addNeighborGrid(kanban);\n\n\t\tthis.kanbanGroupedByParentTasks.forEach((parentTaskKanban) => {\n\t\t\tparentTaskKanban.addNeighborGrid(kanban);\n\t\t});\n\t}\n\n\tgetKanbanParams(renderTo: HTMLElement, params: KanbanParams): Object\n\t{\n\t\treturn {\n\t\t\tisGroupingMode: true,\n\t\t\tgridHeader: params.kanbanHeader,\n\t\t\tparentTaskId: (params.parentTaskId ? params.parentTaskId : 0),\n\t\t\tparentTaskName: (params.parentTaskName ? params.parentTaskName : ''),\n\t\t\tparentTaskCompleted: (params.parentTaskCompleted ? params.parentTaskCompleted : false),\n\t\t\trenderTo: renderTo,\n\t\t\titemType: 'BX.Tasks.Kanban.Item',\n\t\t\tcolumnType: 'BX.Tasks.Kanban.Column',\n\t\t\tcanAddColumn: this.isActiveSprint,\n\t\t\tcanEditColumn: this.isActiveSprint,\n\t\t\tcanRemoveColumn: this.isActiveSprint,\n\t\t\tcanSortColumn: this.isActiveSprint,\n\t\t\tcanAddItem: (!params.addItemInSlider && this.isActiveSprint),\n\t\t\tcanSortItem: this.isActiveSprint,\n\t\t\tbgColor: this.siteTemplateId,\n\t\t\tcolumns: params.columns,\n\t\t\titems: params.items,\n\t\t\taddItemTitleText: Loc.getMessage('KANBAN_QUICK_TASK'),\n\t\t\taddDraftItemInfo: Loc.getMessage('KANBAN_QUICK_TASK_ITEM_INFO'),\n\t\t\tdata: {\n\t\t\t\tkanbanType: 'K',\n\t\t\t\tajaxHandlerPath: this.ajaxComponentPath,\n\t\t\t\tpathToTask: params.pathToTask,\n\t\t\t\tpathToTaskCreate: params.pathToTaskCreate,\n\t\t\t\tpathToUser: params.pathToUser,\n\t\t\t\taddItemInSlider: params.addItemInSlider,\n\t\t\t\tparams: this.ajaxComponentParams,\n\t\t\t\tgridId: this.filterId,\n\t\t\t\tnewTaskOrder: params.newTaskOrder,\n\t\t\t\tsetClientDate: params.setClientDate,\n\t\t\t\tclientDate: BX.date.format(BX.date.convertBitrixFormat(Loc.getMessage('FORMAT_DATE'))),\n\t\t\t\tclientTime: BX.date.format(BX.date.convertBitrixFormat(Loc.getMessage('FORMAT_DATETIME'))),\n\t\t\t\trights: {\n\t\t\t\t\tcanAddColumn: this.isActiveSprint,\n\t\t\t\t\tcanEditColumn: this.isActiveSprint,\n\t\t\t\t\tcanRemoveColumn: this.isActiveSprint,\n\t\t\t\t\tcanSortColumn: this.isActiveSprint,\n\t\t\t\t\tcanAddItem: this.isActiveSprint,\n\t\t\t\t\tcanSortItem: this.isActiveSprint\n\t\t\t\t},\n\t\t\t\tadmins: params.admins,\n\t\t\t\tcustomSectionsFields: (params.customSectionsFields ? params.customSectionsFields : {})\n\t\t\t},\n\t\t\tmessages: {\n\t\t\t\tITEM_TITLE_PLACEHOLDER: Loc.getMessage('KANBAN_ITEM_TITLE_PLACEHOLDER'),\n\t\t\t\tCOLUMN_TITLE_PLACEHOLDER: Loc.getMessage('KANBAN_COLUMN_TITLE_PLACEHOLDER')\n\t\t\t},\n\t\t\townerId: params.ownerId,\n\t\t\tgroupId: params.groupId,\n\t\t\tisSprintView: 'Y'\n\t\t};\n\t}\n\n\tonClickSort(item: HTMLElement, order?: string)\n\t{\n\t\tthis.kanbanComponent.onClickSort(item, order);\n\t}\n\n\tonApplyFilter(filterId, values, filterInstance, promise, params)\n\t{\n\t\tthis.fadeOutKanbans();\n\n\t\tthis.kanban.ajax('applyFilter', {}).then(\n\t\t\t(response) => {\n\t\t\t\tconst data = response.data;\n\n\t\t\t\tif (this.kanban.differentColumnCount(data))\n\t\t\t\t{\n\t\t\t\t\tthis.kanbanHeader.getColumns().forEach((column) => this.kanbanHeader.removeColumn(column));\n\t\t\t\t\tthis.kanban.getColumns().forEach((column) => this.kanban.removeColumn(column));\n\t\t\t\t\tthis.refreshKanban(this.kanbanHeader, data);\n\t\t\t\t}\n\n\t\t\t\tthis.refreshKanban(this.kanban, data);\n\t\t\t\tthis.cleanNeighborKanbans();\n\t\t\t\tif (this.existsTasksGroupedBySubTasks(data))\n\t\t\t\t{\n\t\t\t\t\tObject.entries(data.parentTasks)\n\t\t\t\t\t\t.forEach((parentTask) => {\n\t\t\t\t\t\t\tconst [, parentTaskData] = parentTask;\n\t\t\t\t\t\t\tthis.createParentTaskKanban(parentTaskData);\n\t\t\t\t\t\t})\n\t\t\t\t\t;\n\t\t\t\t}\n\t\t\t\tthis.fillNeighborKanbans();\n\t\t\t\tthis.adjustGroupHeadersWidth();\n\t\t\t\tthis.fadeInKanbans();\n\t\t\t},\n\t\t\t(response) => {\n\t\t\t\tthis.fadeInKanbans();\n\t\t\t});\n\t}\n\n\tonChangeSprint(baseEvent: BaseEvent)\n\t{\n\t\tconst [currentGroup] = baseEvent.getCompatData();\n\n\t\tconst gridData = this.kanban.getData();\n\t\tgridData.params.SPRINT_ID = currentGroup.sprintId;\n\n\t\tthis.kanban.setData(gridData);\n\n\t\tthis.kanban.ajax('changeSprint', {}).then(\n\t\t\t(response) => {\n\t\t\t\tconst data = response.data;\n\t\t\t\tthis.cleanNeighborKanbans();\n\t\t\t\tthis.kanbanHeader.getColumns().forEach((column) => this.kanbanHeader.removeColumn(column));\n\t\t\t\tthis.kanban.getColumns().forEach((column) => this.kanban.removeColumn(column));\n\n\t\t\t\tthis.refreshKanban(this.kanbanHeader, data);\n\t\t\t\tthis.refreshKanban(this.kanban, data);\n\n\t\t\t\tif (this.existsTasksGroupedBySubTasks(data))\n\t\t\t\t{\n\t\t\t\t\tObject.entries(data.parentTasks)\n\t\t\t\t\t\t.forEach((parentTask) => {\n\t\t\t\t\t\t\tconst [, parentTaskData] = parentTask;\n\t\t\t\t\t\t\tthis.createParentTaskKanban(parentTaskData);\n\t\t\t\t\t\t})\n\t\t\t\t\t;\n\t\t\t\t}\n\t\t\t\tthis.fillNeighborKanbans();\n\t\t\t\tthis.adjustGroupHeadersWidth();\n\t\t\t}, (error) => {}\n\t\t);\n\t}\n\n\tonItemUpdated(baseEvent: BaseEvent)\n\t{\n\t\tconst data: UpdateParams = baseEvent.getData();\n\n\t\tif (this.groupId !== data.groupId)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst taskId = data.sourceId;\n\n\t\tif (this.kanban.hasItem(taskId))\n\t\t{\n\t\t\tthis.kanban.refreshTask(taskId);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.kanbanGroupedByParentTasks.forEach(\n\t\t\t\t(parentTaskKanban) => {\n\t\t\t\t\tif (parentTaskKanban.hasItem(taskId))\n\t\t\t\t\t{\n\t\t\t\t\t\tparentTaskKanban.refreshTask(taskId);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t}\n\n\trefreshKanban(kanban, data)\n\t{\n\t\tkanban.resetPaginationPage();\n\t\tkanban.removeItems();\n\t\tkanban.loadData(data);\n\t}\n\n\trefreshParentTasksKanbans(data: Response)\n\t{\n\t\tconst parentTasksToRefresh = [];\n\t\tconst parentTasksToCreate = [];\n\n\t\tObject.entries(data.parentTasks).forEach((parentTask) => {\n\t\t\tconst [parentTaskId, parentTaskData] = parentTask;\n\t\t\tif (this.kanbanGroupedByParentTasks.has(parseInt(parentTaskId, 10)))\n\t\t\t{\n\t\t\t\tparentTasksToRefresh.push(parentTaskData);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tparentTasksToCreate.push(parentTaskData);\n\t\t\t}\n\t\t});\n\n\t\tthis.kanbanGroupedByParentTasks.forEach((parentTaskKanban, parentTaskId) => {\n\t\t\tif (!data.parentTasks[parentTaskId])\n\t\t\t{\n\t\t\t\tthis.hideParentTaskKanban(parentTaskKanban);\n\t\t\t}\n\t\t});\n\n\t\tparentTasksToRefresh.forEach((parentTaskData: ParentTask) => {\n\t\t\tconst parentTaskKanban = this.kanbanGroupedByParentTasks.get(parseInt(parentTaskData.id, 10));\n\t\t\tthis.refreshParentTaskKanban(parentTaskKanban, parentTaskData);\n\t\t});\n\n\t\tparentTasksToCreate.forEach((parentTaskData: ParentTask) => {\n\t\t\tthis.createParentTaskKanban(parentTaskData);\n\t\t});\n\t}\n\n\trefreshParentTaskKanban(kanban, data: ParentTask)\n\t{\n\t\tkanban.resetPaginationPage();\n\t\tkanban.removeItems();\n\n\t\tconst container = kanban.getInnerContainer().closest('.tasks-scrum-parent-task-kanban');\n\t\tthis.showElement(container);\n\t\tthis.upGroupingVisibility(container);\n\n\t\tkanban.loadData(data);\n\n\t\tif (data['completed'] === 'Y')\n\t\t{\n\t\t\tthis.downGroupingVisibility(container);\n\t\t}\n\t}\n\n\tcreateParentTaskKanban(parentTaskData: ParentTask)\n\t{\n\t\tif (parentTaskData.isVisibilitySubtasks === 'N')\n\t\t{\n\t\t\tif (!this.kanban.getItem(parentTaskData.id))\n\t\t\t{\n\t\t\t\tthis.kanban.refreshTask(parentTaskData.id);\n\t\t\t}\n\n\t\t\treturn;\n\t\t}\n\n\t\tthis.parentTasks[parentTaskData.id] = parentTaskData;\n\n\t\tconst kanbanNode = this.createParentTaskKanbanNode(parentTaskData);\n\t\tconst parentTaskCompleted = (parentTaskData['completed'] === 'Y');\n\t\tif (parentTaskCompleted)\n\t\t{\n\t\t\tthis.setTextDecorationToParentTaskName(kanbanNode);\n\t\t}\n\t\tDom.append(kanbanNode, this.inputRenderTo);\n\n\t\tconst tickButtonNode = kanbanNode.querySelector('.tasks-scrum-kanban-group-header-tick');\n\t\tEvent.bind(tickButtonNode, 'click', () => {\n\t\t\tthis.toggleGroupingVisibility(kanbanNode);\n\t\t});\n\n\t\tconst container = kanbanNode.querySelector('.tasks-scrum-kanban-container');\n\t\tthis.drawKanbanGroupedByParentTasks(parentTaskData, container, this.inputKanbanParams);\n\t}\n\n\thideParentTaskKanban(kanban)\n\t{\n\t\tkanban.removeItems();\n\n\t\tconst container = kanban.getInnerContainer().closest('.tasks-scrum-parent-task-kanban');\n\n\t\tthis.hideElement(container);\n\t}\n\n\tremoveParentTaskKanban(kanban)\n\t{\n\t\tDom.remove(kanban.getInnerContainer().closest('.tasks-scrum-parent-task-kanban'));\n\t}\n\n\tfadeOutKanbans()\n\t{\n\t\tthis.kanban.fadeOut();\n\n\t\tthis.kanbanGroupedByParentTasks.forEach((parentTaskKanban) => {\n\t\t\tparentTaskKanban.fadeOut();\n\t\t});\n\t}\n\n\tfadeInKanbans()\n\t{\n\t\tthis.kanban.fadeIn();\n\n\t\tthis.kanbanGroupedByParentTasks.forEach((parentTaskKanban) => {\n\t\t\tparentTaskKanban.fadeIn();\n\t\t});\n\t}\n\n\tshowNotSprintMessage(renderTo: HTMLElement)\n\t{\n\t\tconst message = this.isActiveSprint\n\t\t\t? Loc.getMessage('KANBAN_NO_ACTIVE_SPRINT')\n\t\t\t: Loc.getMessage('KANBAN_NO_COMPLETED_SPRINT')\n\t\t;\n\n\t\tDom.append(Tag.render`\n\t\t\t<div class=\"tasks-kanban__start\">\n\t\t\t\t\t${message}\n\t\t\t</div>\n\t\t`, renderTo);\n\t}\n\n\tisParentTaskGrouping(): boolean\n\t{\n\t\treturn (!Type.isArray(this.parentTasks));\n\t}\n\n\texistsTasksGroupedBySubTasks(response: Response): boolean\n\t{\n\t\treturn (!Type.isArray(response.parentTasks));\n\t}\n\n\tshowElement(element: HTMLElement)\n\t{\n\t\tDom.style(element, 'display', 'block');\n\t}\n\n\thideElement(element: HTMLElement)\n\t{\n\t\tDom.style(element, 'display', 'none');\n\t}\n\n\tcreateParentTaskKanbanNode(parentTaskData: ParentTask): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-scrum-parent-task-kanban\">\n\t\t\t\t<div class=\"tasks-scrum-kanban-group-header\" style=\"background-color: #eaeaea;\">\n\t\t\t\t\t<div class=\"tasks-scrum-kanban-group-header-tick\">\n\t\t\t\t\t\t<div class=\"ui-btn ui-btn-sm ui-btn-light ui-btn-icon-angle-up\"></div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"tasks-scrum-kanban-group-header-name\">\n\t\t\t\t\t\t<a href=\"${this.getTaskUrl(parentTaskData.id)}\">${Text.encode(parentTaskData.name)}</a>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"tasks-scrum-kanban-group-header-story-points\" title=\"Story Points\">\n\t\t\t\t\t\t${Text.encode(parentTaskData.storyPoints)}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-scrum-kanban-container\"></div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tadjustGroupHeadersWidth()\n\t{\n\t\tconst groupHeaders = this.inputRenderTo.querySelectorAll('.tasks-scrum-kanban-group-header');\n\t\tgroupHeaders.forEach((groupHeader) => {\n\t\t\tDom.style(groupHeader, 'width', this.kanbanHeader.getColumnsWidth());\n\t\t});\n\t}\n\n\tupGroupingVisibility(baseContainer: HTMLElement)\n\t{\n\t\tconst tickButtonNode = baseContainer.querySelector('.tasks-scrum-kanban-group-header-tick');\n\t\tconst container = baseContainer.querySelector('.tasks-scrum-kanban-container');\n\n\t\tDom.removeClass(tickButtonNode.firstElementChild, 'ui-btn-icon-angle-down');\n\t\tDom.addClass(tickButtonNode.firstElementChild, 'ui-btn-icon-angle-up');\n\n\t\tthis.showElement(container);\n\t}\n\n\tdownGroupingVisibility(baseContainer: HTMLElement)\n\t{\n\t\tconst tickButtonNode = baseContainer.querySelector('.tasks-scrum-kanban-group-header-tick');\n\t\tconst container = baseContainer.querySelector('.tasks-scrum-kanban-container');\n\n\t\tDom.removeClass(tickButtonNode.firstElementChild, 'ui-btn-icon-angle-up');\n\t\tDom.addClass(tickButtonNode.firstElementChild, 'ui-btn-icon-angle-down');\n\n\t\tthis.hideElement(container);\n\t}\n\n\ttoggleGroupingVisibility(baseContainer: HTMLElement)\n\t{\n\t\tconst tickButtonNode = baseContainer.querySelector('.tasks-scrum-kanban-group-header-tick');\n\t\tconst container = baseContainer.querySelector('.tasks-scrum-kanban-container');\n\n\t\tDom.toggleClass(tickButtonNode.firstElementChild, 'ui-btn-icon-angle-up');\n\t\tDom.toggleClass(tickButtonNode.firstElementChild, 'ui-btn-icon-angle-down');\n\n\t\tif (Dom.style(container, 'display') !== 'none')\n\t\t{\n\t\t\tthis.hideElement(container);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.showElement(container);\n\t\t}\n\n\t\tconst gridContainer = baseContainer.querySelector('.main-kanban-grid');\n\t\tgridContainer.scrollLeft = this.kanban.getGridContainer().scrollLeft;\n\t}\n\n\tonCompleteParentTask(kanban)\n\t{\n\t\tconst container = kanban.getRenderToContainer().closest('.tasks-scrum-parent-task-kanban');\n\n\t\tthis.setTextDecorationToParentTaskName(container);\n\t}\n\n\tonRenewParentTask(kanban)\n\t{\n\t\tconst container = kanban.getRenderToContainer().closest('.tasks-scrum-parent-task-kanban');\n\n\t\tthis.unsetTextDecorationToParentTaskName(container);\n\t}\n\n\tonProceedParentTask(kanban)\n\t{\n\t\tif (this.kanbanGroupedByParentTasks.has(kanban.getParentTaskId()))\n\t\t{\n\t\t\tthis.removeParentTaskKanban(kanban);\n\n\t\t\tthis.kanbanGroupedByParentTasks.delete(kanban.getParentTaskId());\n\t\t}\n\t}\n\n\tsetTextDecorationToParentTaskName(kanbanNode: HTMLElement)\n\t{\n\t\tconst parentTaskNameNode = kanbanNode.querySelector('.tasks-scrum-kanban-group-header-name');\n\t\tDom.style(parentTaskNameNode, 'text-decoration', 'line-through');\n\t}\n\n\tunsetTextDecorationToParentTaskName(kanbanNode: HTMLElement)\n\t{\n\t\tconst parentTaskNameNode = kanbanNode.querySelector('.tasks-scrum-kanban-group-header-name');\n\t\tDom.style(parentTaskNameNode, 'text-decoration', null);\n\t}\n\n\tgetTaskUrl(taskId: number): string\n\t{\n\t\treturn this.inputKanbanParams.pathToTask.replace('#task_id#', taskId);\n\t}\n}\n"],"names":["PullItem","setEventNamespace","itemUpdated","onItemUpdated","bind","params","emit","EventEmitter","KanbanComponent","filterId","defaultPresetId","ajaxComponentPath","ajaxComponentParams","item","order","Dom","hasClass","refreshIcons","saveSelection","parentElement","childNodes","forEach","element","removeClass","addClass","BX","ajax","runComponentAction","mode","data","then","response","onCustomEvent","KanbanManager","groupId","parseInt","siteTemplateId","sprintSelected","isActiveSprint","kanbanHeader","kanban","kanbanGroupedByParentTasks","Map","parentTasks","kanbanComponent","pullItem","subscribe","event","getCompatData","values","filterInstance","promise","onApplyFilter","onChangeSprint","showFieldsSelectPopup","Pull","renderTo","showNotSprintMessage","inputRenderTo","inputKanbanParams","drawKanbanHeader","drawKanbanWithoutGrouping","drawKanbanInGroupingMode","fillNeighborKanbans","updateHeaderColumns","adjustGroupHeadersWidth","setTimeout","isParentTaskGrouping","parentTaskId","getItem","refreshTask","kanbanNode","createParentTaskKanbanNode","parentTaskCompleted","setTextDecorationToParentTaskName","append","tickButtonNode","querySelector","Event","toggleGroupingVisibility","container","drawKanbanGroupedByParentTasks","headerParams","Runtime","clone","items","Tasks","Kanban","Grid","getKanbanParams","draw","baseEvent","parentTask","getData","createParentTaskKanban","addItemsFromQueue","id","columns","parentTaskName","name","completed","hasItemInProgress","getRenderToContainer","closest","downGroupingVisibility","onCompleteParentTask","onRenewParentTask","onProceedParentTask","upGroupingVisibility","set","addNeighborKanban","parentTaskKanban","cleanNeighborGrids","removeParentTaskKanban","clear","updateTotals","addNeighborGrid","isGroupingMode","gridHeader","itemType","columnType","canAddColumn","canEditColumn","canRemoveColumn","canSortColumn","canAddItem","addItemInSlider","canSortItem","bgColor","addItemTitleText","Loc","getMessage","addDraftItemInfo","kanbanType","ajaxHandlerPath","pathToTask","pathToTaskCreate","pathToUser","gridId","newTaskOrder","setClientDate","clientDate","date","format","convertBitrixFormat","clientTime","rights","admins","customSectionsFields","messages","ITEM_TITLE_PLACEHOLDER","COLUMN_TITLE_PLACEHOLDER","ownerId","isSprintView","onClickSort","fadeOutKanbans","differentColumnCount","getColumns","column","removeColumn","refreshKanban","cleanNeighborKanbans","existsTasksGroupedBySubTasks","Object","entries","parentTaskData","fadeInKanbans","currentGroup","gridData","SPRINT_ID","sprintId","setData","error","taskId","sourceId","hasItem","resetPaginationPage","removeItems","loadData","parentTasksToRefresh","parentTasksToCreate","has","push","hideParentTaskKanban","get","refreshParentTaskKanban","getInnerContainer","showElement","isVisibilitySubtasks","hideElement","remove","fadeOut","fadeIn","message","Tag","render","Type","isArray","style","getTaskUrl","Text","encode","storyPoints","groupHeaders","querySelectorAll","groupHeader","getColumnsWidth","baseContainer","firstElementChild","toggleClass","gridContainer","scrollLeft","getGridContainer","unsetTextDecorationToParentTaskName","getParentTaskId","parentTaskNameNode","replace"],"mappings":"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"}