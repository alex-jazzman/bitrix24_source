this.BX=this.BX||{};this.BX.Tasks=this.BX.Tasks||{};(function(e,s,t,a,i,l,o,r,n,c,d){"use strict";var b=babelHelpers.classPrivateFieldLooseKey("EVENT_NAMESPACE");var v=babelHelpers.classPrivateFieldLooseKey("calendar");var p=babelHelpers.classPrivateFieldLooseKey("datePicker");var u=babelHelpers.classPrivateFieldLooseKey("input");var h=babelHelpers.classPrivateFieldLooseKey("matchWorkTime");var P=babelHelpers.classPrivateFieldLooseKey("init");var L=babelHelpers.classPrivateFieldLooseKey("getDefaultTime");var F=babelHelpers.classPrivateFieldLooseKey("onSelect");var f=babelHelpers.classPrivateFieldLooseKey("onHide");var B=babelHelpers.classPrivateFieldLooseKey("setInputValue");var H=babelHelpers.classPrivateFieldLooseKey("getDateFormatByDate");class y extends l.EventEmitter{constructor(e){super();Object.defineProperty(this,H,{value:k});Object.defineProperty(this,B,{value:S});Object.defineProperty(this,f,{value:T});Object.defineProperty(this,F,{value:D});Object.defineProperty(this,L,{value:_});Object.defineProperty(this,P,{value:m});Object.defineProperty(this,b,{writable:true,value:"BX.Tasks.Deadline.Notification.Layout.DeadlinePicker"});Object.defineProperty(this,v,{writable:true,value:void 0});Object.defineProperty(this,p,{writable:true,value:void 0});Object.defineProperty(this,u,{writable:true,value:void 0});Object.defineProperty(this,h,{writable:true,value:void 0});this.setEventNamespace(babelHelpers.classPrivateFieldLooseBase(this,b)[b]);this.subscribeFromOptions(e.events);babelHelpers.classPrivateFieldLooseBase(this,P)[P](e)}getSelectedDate(){return babelHelpers.classPrivateFieldLooseBase(this,p)[p].getSelectedDate()}getToday(){return babelHelpers.classPrivateFieldLooseBase(this,p)[p].getToday()}formatDate(e,s){return babelHelpers.classPrivateFieldLooseBase(this,p)[p].formatDate(e,s)}}function m(e){const s=e.calendar;if(s instanceof BX.Tasks.Calendar){babelHelpers.classPrivateFieldLooseBase(this,v)[v]=s}const t=babelHelpers.classPrivateFieldLooseBase(this,L)[L]();const a=e.input;if(a instanceof HTMLInputElement){babelHelpers.classPrivateFieldLooseBase(this,u)[u]=a}const l=e.matchWorkTime;babelHelpers.classPrivateFieldLooseBase(this,h)[h]=n.Type.isBoolean(l)?l:false;const o=e=>`0${e}`.slice(-2);const r={defaultTime:`${o(t.getHours())}:${o(t.getMinutes())}`,targetNode:babelHelpers.classPrivateFieldLooseBase(this,u)[u],enableTime:true,cutZeroTime:false,events:{onSelect:babelHelpers.classPrivateFieldLooseBase(this,F)[F].bind(this),onHide:babelHelpers.classPrivateFieldLooseBase(this,f)[f].bind(this)}};babelHelpers.classPrivateFieldLooseBase(this,p)[p]=new i.DatePicker({...e,...r});n.Event.bind(babelHelpers.classPrivateFieldLooseBase(this,u)[u],"click",babelHelpers.classPrivateFieldLooseBase(this,p)[p].show.bind(babelHelpers.classPrivateFieldLooseBase(this,p)[p]))}function _(){const e=new Date;const s=babelHelpers.classPrivateFieldLooseBase(this,v)[v].getWorkIntervals(e).pop();return new Date(s.endDate.toLocaleString("en-US",{timeZone:"UTC"}))}function D(e){const{date:s}=e.getData();if(!babelHelpers.classPrivateFieldLooseBase(this,h)[h]){babelHelpers.classPrivateFieldLooseBase(this,B)[B](s);this.emit("onSelect");return}const t=babelHelpers.classPrivateFieldLooseBase(this,v)[v].getClosestWorkTime(s,true);if(s.getTime()!==t.getTime()){babelHelpers.classPrivateFieldLooseBase(this,p)[p].selectDate(new Date(t.toLocaleString("en-US",{timeZone:"UTC"})));babelHelpers.classPrivateFieldLooseBase(this,p)[p].hide();this.emit("onMoveDateToWorkTime")}babelHelpers.classPrivateFieldLooseBase(this,B)[B](t);this.emit("onSelect")}function T(){const e=this.getSelectedDate();const s=this.getToday();if(n.Type.isDate(e)&&e<s){this.emit("onLessCurrentDateSelect")}}function S(e){const s=babelHelpers.classPrivateFieldLooseBase(this,H)[H](e);babelHelpers.classPrivateFieldLooseBase(this,u)[u].value=babelHelpers.classPrivateFieldLooseBase(this,p)[p].formatDate(e,s)}function k(e){const s=a.DateTimeFormat.getFormat("SHORT_TIME_FORMAT");const t=new Date;let i=a.DateTimeFormat.getFormat("DAY_OF_WEEK_MONTH_FORMAT");if(n.Type.isDate(e)&&t.getFullYear()!==e.getFullYear()){i=a.DateTimeFormat.getFormat("FULL_DATE_FORMAT")}return`${i}, ${s}`}class g extends o.Popup{constructor(e){const s=`\n\t\t\t<div class="tasks-deadline-notification-form__content_deadline-selector_moved-toolbar">\n\t\t\t\t${n.Loc.getMessage("TASKS_DEADLINE_NOTIFICATION_MOVED_DEADLINE_TOOLTIP")}\n\t\t\t</div>\n\t\t`;const t={id:"deadline-notification-moved-deadline-popup",offsetLeft:30,offsetTop:5,angle:true,autoHide:true,closeByEsc:false,closeIcon:true,content:s};super({...e,...t})}}class E extends o.Popup{constructor(e){const s=`\n\t\t\t<div class="tasks-deadline-notification-form__content_deadline-selector_overdue-toolbar">\n\t\t\t\t${n.Loc.getMessage("TASKS_DEADLINE_NOTIFICATION_OVERDUE_DEADLINE_TOOLTIP")}\n\t\t\t</div>\n\t\t`;const t={id:"deadline-notification-overdue-deadline-popup",offsetLeft:30,offsetTop:5,angle:true,autoHide:true,closeByEsc:false,closeIcon:true,content:s};super({...e,...t})}}let O=e=>e,I,K;const N=7;var A=babelHelpers.classPrivateFieldLooseKey("EVENT_NAMESPACE");var C=babelHelpers.classPrivateFieldLooseKey("calendar");var j=babelHelpers.classPrivateFieldLooseKey("deadlinePicker");var w=babelHelpers.classPrivateFieldLooseKey("input");var M=babelHelpers.classPrivateFieldLooseKey("matchWorkTime");var x=babelHelpers.classPrivateFieldLooseKey("movedDeadlinePopup");var $=babelHelpers.classPrivateFieldLooseKey("overdueDeadlinePopup");var X=babelHelpers.classPrivateFieldLooseKey("init");var W=babelHelpers.classPrivateFieldLooseKey("initMatchWorkTime");var R=babelHelpers.classPrivateFieldLooseKey("initCalendar");var U=babelHelpers.classPrivateFieldLooseKey("initDeadlinePicker");var V=babelHelpers.classPrivateFieldLooseKey("onMoveDateToWorkTime");var Y=babelHelpers.classPrivateFieldLooseKey("onLessCurrentDateSelect");var z=babelHelpers.classPrivateFieldLooseKey("getOverdueDeadlinePopup");var Z=babelHelpers.classPrivateFieldLooseKey("getMovedDeadlinePopup");var G=babelHelpers.classPrivateFieldLooseKey("getPortalSettings");class q extends l.EventEmitter{constructor(e){super();Object.defineProperty(this,G,{value:oe});Object.defineProperty(this,Z,{value:le});Object.defineProperty(this,z,{value:ie});Object.defineProperty(this,Y,{value:ae});Object.defineProperty(this,V,{value:te});Object.defineProperty(this,U,{value:se});Object.defineProperty(this,R,{value:ee});Object.defineProperty(this,W,{value:Q});Object.defineProperty(this,X,{value:J});Object.defineProperty(this,A,{writable:true,value:"BX.Tasks.Deadline.Notification.Layout.DeadlineSelector"});Object.defineProperty(this,C,{writable:true,value:void 0});Object.defineProperty(this,j,{writable:true,value:void 0});Object.defineProperty(this,w,{writable:true,value:void 0});Object.defineProperty(this,M,{writable:true,value:void 0});Object.defineProperty(this,x,{writable:true,value:void 0});Object.defineProperty(this,$,{writable:true,value:void 0});this.setEventNamespace(babelHelpers.classPrivateFieldLooseBase(this,A)[A]);this.subscribeFromOptions(e.events);babelHelpers.classPrivateFieldLooseBase(this,X)[X](e)}render(){return n.Tag.render(I||(I=O`
			<div class="tasks-deadline-notification-form__content_deadline-selector">
				<div class="ui-ctl ui-ctl-after-icon ui-ctl-datetime ui-ctl-w75">
					<div class="ui-ctl-after ui-ctl-icon-calendar"></div>
					${0}
				</div>
			</div>
		`),babelHelpers.classPrivateFieldLooseBase(this,w)[w])}getInputValue(){return babelHelpers.classPrivateFieldLooseBase(this,w)[w].value}getDeadline(){return babelHelpers.classPrivateFieldLooseBase(this,j)[j].getSelectedDate()}getToday(){return babelHelpers.classPrivateFieldLooseBase(this,j)[j].getToday()}getFormattedDeadline(e){return babelHelpers.classPrivateFieldLooseBase(this,j)[j].formatDate(this.getDeadline(),e)}}function J(e){babelHelpers.classPrivateFieldLooseBase(this,w)[w]=n.Tag.render(K||(K=O`
			<input class="ui-ctl-element" data-id="tasks-deadline-notification-deadline" readonly>
		`));const s=babelHelpers.classPrivateFieldLooseBase(this,G)[G]();babelHelpers.classPrivateFieldLooseBase(this,R)[R](s);babelHelpers.classPrivateFieldLooseBase(this,W)[W](e,s);babelHelpers.classPrivateFieldLooseBase(this,U)[U](babelHelpers.classPrivateFieldLooseBase(this,w)[w],babelHelpers.classPrivateFieldLooseBase(this,C)[C],babelHelpers.classPrivateFieldLooseBase(this,M)[M])}function Q(e,s){babelHelpers.classPrivateFieldLooseBase(this,M)[M]=e.matchWorkTime;const t=s.WEEKEND;if(!n.Type.isArray(t)){return}const a=t.length;if(a===N){babelHelpers.classPrivateFieldLooseBase(this,M)[M]=false}}function ee(e){const s=BX.Tasks.Calendar.adaptSettings(e);babelHelpers.classPrivateFieldLooseBase(this,C)[C]=new BX.Tasks.Calendar(s)}function se(e,s,t){babelHelpers.classPrivateFieldLooseBase(this,j)[j]=new y({events:{onMoveDateToWorkTime:babelHelpers.classPrivateFieldLooseBase(this,V)[V].bind(this),onLessCurrentDateSelect:babelHelpers.classPrivateFieldLooseBase(this,Y)[Y].bind(this),onSelect:()=>this.emit("onSelect")},input:e,calendar:s,matchWorkTime:t})}function te(){const e=babelHelpers.classPrivateFieldLooseBase(this,z)[z]();if(e.isShown()){return}const s=babelHelpers.classPrivateFieldLooseBase(this,Z)[Z]();s.show()}function ae(){const e=babelHelpers.classPrivateFieldLooseBase(this,z)[z]();e.show()}function ie(){if(!babelHelpers.classPrivateFieldLooseBase(this,$)[$]){babelHelpers.classPrivateFieldLooseBase(this,$)[$]=new E({bindElement:babelHelpers.classPrivateFieldLooseBase(this,w)[w]})}return babelHelpers.classPrivateFieldLooseBase(this,$)[$]}function le(){if(!babelHelpers.classPrivateFieldLooseBase(this,x)[x]){babelHelpers.classPrivateFieldLooseBase(this,x)[x]=new g({bindElement:babelHelpers.classPrivateFieldLooseBase(this,w)[w]})}return babelHelpers.classPrivateFieldLooseBase(this,x)[x]}function oe(){const e=n.Extension.getSettings("tasks.deadline.notification");return e.get("portalSettings")}var re=babelHelpers.classPrivateFieldLooseKey("EVENT_NAMESPACE");var ne=babelHelpers.classPrivateFieldLooseKey("ACCEPTED_ITEM_CLASS");var ce=babelHelpers.classPrivateFieldLooseKey("ITEMS_CLASSES");var de=babelHelpers.classPrivateFieldLooseKey("button");var be=babelHelpers.classPrivateFieldLooseKey("items");var ve=babelHelpers.classPrivateFieldLooseKey("period");var pe=babelHelpers.classPrivateFieldLooseKey("onMenuItemClick");var ue=babelHelpers.classPrivateFieldLooseKey("refreshMenuItemsIcons");var he=babelHelpers.classPrivateFieldLooseKey("init");class Pe extends l.EventEmitter{constructor(e={}){super();Object.defineProperty(this,he,{value:fe});Object.defineProperty(this,ue,{value:Fe});Object.defineProperty(this,pe,{value:Le});Object.defineProperty(this,re,{writable:true,value:"BX.Tasks.Deadline.Notification.Layout.SkipButtonMenu"});Object.defineProperty(this,ne,{writable:true,value:"menu-popup-item-accept"});Object.defineProperty(this,ce,{writable:true,value:"menu-popup-icon menu-popup-item-none"});Object.defineProperty(this,de,{writable:true,value:void 0});Object.defineProperty(this,be,{writable:true,value:void 0});Object.defineProperty(this,ve,{writable:true,value:void 0});this.setEventNamespace(babelHelpers.classPrivateFieldLooseBase(this,re)[re]);this.subscribeFromOptions(e.events);babelHelpers.classPrivateFieldLooseBase(this,he)[he]()}getMenu(){return{closeByEsc:true,items:babelHelpers.classPrivateFieldLooseBase(this,be)[be],minWidth:180}}getPeriod(){return babelHelpers.classPrivateFieldLooseBase(this,ve)[ve]}setButton(e){babelHelpers.classPrivateFieldLooseBase(this,de)[de]=e}}function Le(e){var s,t;const a=(s=babelHelpers.classPrivateFieldLooseBase(this,de)[de])==null?void 0:s.getMenuWindow();if(!a){return}const i=e.id;const o=e.text;if(babelHelpers.classPrivateFieldLooseBase(this,ve)[ve]===i){babelHelpers.classPrivateFieldLooseBase(this,ve)[ve]="";babelHelpers.classPrivateFieldLooseBase(this,ue)[ue](a.getMenuItems(),babelHelpers.classPrivateFieldLooseBase(this,ve)[ve]);const e=new l.BaseEvent({data:{buttonMenu:a}});this.emit("onMenuItemDeselect",e);return}babelHelpers.classPrivateFieldLooseBase(this,ve)[ve]=i;babelHelpers.classPrivateFieldLooseBase(this,ue)[ue](a.getMenuItems(),babelHelpers.classPrivateFieldLooseBase(this,ve)[ve]);const r=new l.BaseEvent({data:{buttonMenu:a,text:o}});this.emit("onMenuItemSelect",r);d.sendData({tool:"tasks",category:"task_operations",event:"period_click_type",type:"popup",c_section:"tasks",c_sub_section:"deadline_popup",c_element:(t=e.dataset)==null?void 0:t.analytics})}function Fe(e,s){e.forEach((e=>{const t=e.getLayout().item;if(!t){return}if(e.getId()===s){n.Dom.addClass(t,babelHelpers.classPrivateFieldLooseBase(this,ne)[ne]);return}n.Dom.removeClass(t,babelHelpers.classPrivateFieldLooseBase(this,ne)[ne])}))}function fe(){babelHelpers.classPrivateFieldLooseBase(this,be)[be]=[{dataset:{id:"tasks-deadline-notification-skip-day",analytics:"today_button"},id:"day",text:n.Loc.getMessage("TASKS_DEADLINE_NOTIFICATION_DAY"),className:babelHelpers.classPrivateFieldLooseBase(this,ce)[ce]},{dataset:{id:"tasks-deadline-notification-skip-week",analytics:"current_week_button"},id:"week",text:n.Loc.getMessage("TASKS_DEADLINE_NOTIFICATION_WEEK"),className:babelHelpers.classPrivateFieldLooseBase(this,ce)[ce]},{dataset:{id:"tasks-deadline-notification-skip-month",analytics:"current_month_button"},id:"month",text:n.Loc.getMessage("TASKS_DEADLINE_NOTIFICATION_MONTH"),className:babelHelpers.classPrivateFieldLooseBase(this,ce)[ce]},{dataset:{id:"tasks-deadline-notification-skip-forever",analytics:"never_button"},id:"forever",text:n.Loc.getMessage("TASKS_DEADLINE_NOTIFICATION_FOREVER"),className:babelHelpers.classPrivateFieldLooseBase(this,ce)[ce]}];babelHelpers.classPrivateFieldLooseBase(this,be)[be].forEach((e=>{e.onclick=babelHelpers.classPrivateFieldLooseBase(this,pe)[pe].bind(this,e)}))}let Be=e=>e,He;var ye=babelHelpers.classPrivateFieldLooseKey("EVENT_NAMESPACE");var me=babelHelpers.classPrivateFieldLooseKey("submitButton");var _e=babelHelpers.classPrivateFieldLooseKey("cancelButton");var De=babelHelpers.classPrivateFieldLooseKey("skipButton");var Te=babelHelpers.classPrivateFieldLooseKey("skipButtonMenu");var Se=babelHelpers.classPrivateFieldLooseKey("init");var ke=babelHelpers.classPrivateFieldLooseKey("onSubmitButtonClick");var ge=babelHelpers.classPrivateFieldLooseKey("onCancelButtonClick");var Ee=babelHelpers.classPrivateFieldLooseKey("onSkipButtonClick");var Oe=babelHelpers.classPrivateFieldLooseKey("onSkipMenuItemSelect");var Ie=babelHelpers.classPrivateFieldLooseKey("onSkipMenuItemDeselect");class Ke extends l.EventEmitter{constructor(e={}){super();Object.defineProperty(this,Ie,{value:Me});Object.defineProperty(this,Oe,{value:we});Object.defineProperty(this,Ee,{value:je});Object.defineProperty(this,ge,{value:Ce});Object.defineProperty(this,ke,{value:Ae});Object.defineProperty(this,Se,{value:Ne});Object.defineProperty(this,ye,{writable:true,value:"BX.Tasks.Deadline.Notification.Layout.Footer"});Object.defineProperty(this,me,{writable:true,value:void 0});Object.defineProperty(this,_e,{writable:true,value:void 0});Object.defineProperty(this,De,{writable:true,value:void 0});Object.defineProperty(this,Te,{writable:true,value:void 0});this.setEventNamespace(babelHelpers.classPrivateFieldLooseBase(this,ye)[ye]);this.subscribeFromOptions(e.events);babelHelpers.classPrivateFieldLooseBase(this,Se)[Se]()}render(){return n.Tag.render(He||(He=Be`
			<div class="tasks-deadline-notification-form__footer">
				<div class="tasks-deadline-notification-form__footer_buttons-container">
					${0}
					${0}
				</div>
				${0}
			</div>
		`),babelHelpers.classPrivateFieldLooseBase(this,me)[me].render(),babelHelpers.classPrivateFieldLooseBase(this,_e)[_e].render(),babelHelpers.classPrivateFieldLooseBase(this,De)[De].render())}getSkipPeriod(){return babelHelpers.classPrivateFieldLooseBase(this,Te)[Te].getPeriod()}updateSkipButtonText(e){const s=n.Loc.getMessage("TASKS_DEADLINE_NOTIFICATION_SKIP_BUTTON");const t=e===""?s:`${s}, ${e}`;babelHelpers.classPrivateFieldLooseBase(this,De)[De].setText(t)}enableButtons(){this.enableSubmitButton();this.enableCancelButton();this.enableSkipButton()}disableButtons(){this.disableSubmitButton();this.disableCancelButton();this.disableSkipButton()}enableSubmitButton(){babelHelpers.classPrivateFieldLooseBase(this,me)[me].setDisabled(false);babelHelpers.classPrivateFieldLooseBase(this,me)[me].setColor(r.ButtonColor.PRIMARY)}disableSubmitButton(){babelHelpers.classPrivateFieldLooseBase(this,me)[me].setDisabled();babelHelpers.classPrivateFieldLooseBase(this,me)[me].setColor()}enableCancelButton(){babelHelpers.classPrivateFieldLooseBase(this,_e)[_e].setDisabled(false)}disableCancelButton(){babelHelpers.classPrivateFieldLooseBase(this,_e)[_e].setDisabled()}enableSkipButton(){babelHelpers.classPrivateFieldLooseBase(this,De)[De].setDisabled(false)}disableSkipButton(){babelHelpers.classPrivateFieldLooseBase(this,De)[De].setDisabled()}}function Ne(){babelHelpers.classPrivateFieldLooseBase(this,me)[me]=new r.Button({dataset:{id:"tasks-deadline-notification-submit"},text:n.Loc.getMessage("TASKS_DEADLINE_NOTIFICATION_SAVE_BUTTON"),size:r.ButtonSize.SMALL,state:r.ButtonState.DISABLED,noCaps:true,round:true,onclick:babelHelpers.classPrivateFieldLooseBase(this,ke)[ke].bind(this)});babelHelpers.classPrivateFieldLooseBase(this,_e)[_e]=new r.Button({dataset:{id:"tasks-deadline-notification-cancel"},text:n.Loc.getMessage("TASKS_DEADLINE_NOTIFICATION_CANCEL_BUTTON_MSGVER_1"),color:r.ButtonColor.LINK,size:r.ButtonSize.SMALL,state:r.ButtonState.ACTIVE,noCaps:true,round:true,onclick:babelHelpers.classPrivateFieldLooseBase(this,ge)[ge].bind(this)});babelHelpers.classPrivateFieldLooseBase(this,Te)[Te]=new Pe({events:{onMenuItemSelect:babelHelpers.classPrivateFieldLooseBase(this,Oe)[Oe].bind(this),onMenuItemDeselect:babelHelpers.classPrivateFieldLooseBase(this,Ie)[Ie].bind(this)}});babelHelpers.classPrivateFieldLooseBase(this,De)[De]=new r.Button({dataset:{id:"tasks-deadline-notification-skip"},text:n.Loc.getMessage("TASKS_DEADLINE_NOTIFICATION_SKIP_BUTTON"),className:"tasks-deadline-notification-form__footer_skip-button",color:r.ButtonColor.LINK,noCaps:true,dropdown:true,menu:babelHelpers.classPrivateFieldLooseBase(this,Te)[Te].getMenu(),onclick:babelHelpers.classPrivateFieldLooseBase(this,Ee)[Ee].bind(this)});babelHelpers.classPrivateFieldLooseBase(this,Te)[Te].setButton(babelHelpers.classPrivateFieldLooseBase(this,De)[De])}function Ae(){if(babelHelpers.classPrivateFieldLooseBase(this,me)[me].isDisabled()){return}this.emit("onSubmitButtonClick");d.sendData({tool:"tasks",category:"task_operations",event:"click_save_button",type:"popup",c_section:"tasks",c_sub_section:"deadline_field",c_element:"save_button"})}function Ce(){if(babelHelpers.classPrivateFieldLooseBase(this,_e)[_e].isDisabled()){return}this.emit("onCancelButtonClick");d.sendData({tool:"tasks",category:"task_operations",event:"click_no_deadline_button",type:"popup",c_section:"tasks",c_sub_section:"deadline_popup",c_element:"no_deadline_button"})}function je(){d.sendData({tool:"tasks",category:"task_operations",event:"click_no_remind_button",type:"popup",c_section:"tasks",c_sub_section:"deadline_popup",c_element:"no_remind_button"})}function we(e){const{buttonMenu:s,text:t}=e.getData();s.close();this.updateSkipButtonText(t.toLowerCase());this.emit("onSkipMenuItemSelect",e)}function Me(e){const{buttonMenu:s}=e.getData();s.close();this.updateSkipButtonText("");this.emit("onSkipMenuItemDeselect",e)}let xe=e=>e,$e,Xe;function We(e){return e.replaceAll(/\D/g,"")}function Re(e,s,t){let a=Math.max(e,s);a=Math.min(a,t);return a}const Ue=2**32/2-1;const Ve=60*60*24*31;var Ye=babelHelpers.classPrivateFieldLooseKey("intervalSelector");var ze=babelHelpers.classPrivateFieldLooseKey("input");var Ze=babelHelpers.classPrivateFieldLooseKey("onInput");class Ge{constructor(){Object.defineProperty(this,Ze,{value:qe});Object.defineProperty(this,Ye,{writable:true,value:void 0});Object.defineProperty(this,ze,{writable:true,value:void 0});babelHelpers.classPrivateFieldLooseBase(this,ze)[ze]=n.Tag.render($e||($e=xe`
			<input class="ui-ctl-element" placeholder="0" data-id="tasks-deadline-notification-default-deadline">
		`));n.Event.bind(babelHelpers.classPrivateFieldLooseBase(this,ze)[ze],"input",babelHelpers.classPrivateFieldLooseBase(this,Ze)[Ze].bind(this));babelHelpers.classPrivateFieldLooseBase(this,Ye)[Ye]=new c.IntervalSelector({showDropdownIcon:true})}render(){return n.Tag.render(Xe||(Xe=xe`
			<div hidden>
				<div class="tasks-deadline-notification-form__content_default-deadline-container">
					<div class="ui-ctl ui-ctl-w25">
						${0}
					</div>
					<div
						class="tasks-deadline-notification-form__content_default-deadline-container_interval-selector"
						data-id="tasks-deadline-notification-interval-selector"
					>
						${0}
					</div>
				</div>
			</div>
		`),babelHelpers.classPrivateFieldLooseBase(this,ze)[ze],babelHelpers.classPrivateFieldLooseBase(this,Ye)[Ye].render())}isExactDeadlineTime(){return["minutes","hours"].includes(babelHelpers.classPrivateFieldLooseBase(this,Ye)[Ye].getInterval())}getDeadlineInSeconds(){return Number(babelHelpers.classPrivateFieldLooseBase(this,ze)[ze].value)*babelHelpers.classPrivateFieldLooseBase(this,Ye)[Ye].getDuration()}focus(){babelHelpers.classPrivateFieldLooseBase(this,ze)[ze].focus()}clear(){babelHelpers.classPrivateFieldLooseBase(this,ze)[ze].value=""}select(e){babelHelpers.classPrivateFieldLooseBase(this,ze)[ze].value=e}}function qe(){let e=We(babelHelpers.classPrivateFieldLooseBase(this,ze)[ze].value);e=parseInt(e,10);const s=1;const t=Math.floor(Ue/Ve);e=Re(e,s,t);babelHelpers.classPrivateFieldLooseBase(this,ze)[ze].value=e||""}let Je=e=>e,Qe,es,ss,ts,as;var is=babelHelpers.classPrivateFieldLooseKey("EVENT_NAMESPACE");var ls=babelHelpers.classPrivateFieldLooseKey("popup");var os=babelHelpers.classPrivateFieldLooseKey("targetForm");var rs=babelHelpers.classPrivateFieldLooseKey("targetInput");var ns=babelHelpers.classPrivateFieldLooseKey("targetButton");var cs=babelHelpers.classPrivateFieldLooseKey("matchWorkTime");var ds=babelHelpers.classPrivateFieldLooseKey("layout");var bs=babelHelpers.classPrivateFieldLooseKey("getPopupContent");var vs=babelHelpers.classPrivateFieldLooseKey("getTitleContainer");var ps=babelHelpers.classPrivateFieldLooseKey("getErrorsContainer");var us=babelHelpers.classPrivateFieldLooseKey("getDeadlineContainer");var hs=babelHelpers.classPrivateFieldLooseKey("getDefaultDeadlineCheckerTitle");var Ps=babelHelpers.classPrivateFieldLooseKey("saveTargetButtonStateInForm");var Ls=babelHelpers.classPrivateFieldLooseKey("onSubmitButtonClick");var Fs=babelHelpers.classPrivateFieldLooseKey("onCancelButtonClick");var fs=babelHelpers.classPrivateFieldLooseKey("onSkipMenuItemSelect");var Bs=babelHelpers.classPrivateFieldLooseKey("onDefaultDeadlineCheckerChange");var Hs=babelHelpers.classPrivateFieldLooseKey("onDeadlineSelect");var ys=babelHelpers.classPrivateFieldLooseKey("onPopupFirstShow");var ms=babelHelpers.classPrivateFieldLooseKey("onPromiseError");var _s=babelHelpers.classPrivateFieldLooseKey("setDefaultDeadline");var Ds=babelHelpers.classPrivateFieldLooseKey("setSkipNotificationPeriod");var Ts=babelHelpers.classPrivateFieldLooseKey("submit");var Ss=babelHelpers.classPrivateFieldLooseKey("setTargetInputValue");var ks=babelHelpers.classPrivateFieldLooseKey("init");class gs extends l.EventEmitter{constructor(e){super();Object.defineProperty(this,ks,{value:Ys});Object.defineProperty(this,Ss,{value:Vs});Object.defineProperty(this,Ts,{value:Us});Object.defineProperty(this,Ds,{value:Rs});Object.defineProperty(this,_s,{value:Ws});Object.defineProperty(this,ms,{value:Xs});Object.defineProperty(this,ys,{value:$s});Object.defineProperty(this,Hs,{value:xs});Object.defineProperty(this,Bs,{value:Ms});Object.defineProperty(this,fs,{value:ws});Object.defineProperty(this,Fs,{value:js});Object.defineProperty(this,Ls,{value:Cs});Object.defineProperty(this,Ps,{value:As});Object.defineProperty(this,hs,{value:Ns});Object.defineProperty(this,us,{value:Ks});Object.defineProperty(this,ps,{value:Is});Object.defineProperty(this,vs,{value:Os});Object.defineProperty(this,bs,{value:Es});Object.defineProperty(this,is,{writable:true,value:"BX.Tasks.Deadline.Notification"});Object.defineProperty(this,ls,{writable:true,value:void 0});Object.defineProperty(this,os,{writable:true,value:void 0});Object.defineProperty(this,rs,{writable:true,value:void 0});Object.defineProperty(this,ns,{writable:true,value:void 0});Object.defineProperty(this,cs,{writable:true,value:void 0});Object.defineProperty(this,ds,{writable:true,value:void 0});this.setEventNamespace(babelHelpers.classPrivateFieldLooseBase(this,is)[is]);babelHelpers.classPrivateFieldLooseBase(this,ks)[ks](e)}show(){babelHelpers.classPrivateFieldLooseBase(this,ls)[ls].show();d.sendData({tool:"tasks",category:"task_operations",event:"deadline_popup_show",type:"popup",c_section:"tasks"})}close(){babelHelpers.classPrivateFieldLooseBase(this,ls)[ls].close()}}function Es(){const e=n.Tag.render(Qe||(Qe=Je`
			<form class="tasks-deadline__notification-form">
				${0}
				${0}
				${0}
				${0}
			</form>
		`),babelHelpers.classPrivateFieldLooseBase(this,vs)[vs](),babelHelpers.classPrivateFieldLooseBase(this,ps)[ps](),babelHelpers.classPrivateFieldLooseBase(this,us)[us](),babelHelpers.classPrivateFieldLooseBase(this,ds)[ds].footer.render());n.Event.bind(e,"submit",(e=>{e.preventDefault()}));return e}function Os(){return n.Tag.render(es||(es=Je`
			<div class="tasks-deadline-notification-form__title">
				<div class="tasks-deadline-notification-form__title_icon"></div>
				<div class="tasks-deadline-notification-form__title_text">
					${0}
				</div>
			</div>
			<div class="tasks-deadline-notification-form__subtitle">
				${0}
			</div>
		`),n.Loc.getMessage("TASKS_DEADLINE_NOTIFICATION_TITLE"),n.Loc.getMessage("TASKS_DEADLINE_NOTIFICATION_DESCRIPTION"))}function Is(){babelHelpers.classPrivateFieldLooseBase(this,ds)[ds].errorContainer=n.Tag.render(ss||(ss=Je`
			<div class="tasks-deadline-notification-form__errors" hidden>
				<div class="ui-alert ui-alert-danger">
					<span class="ui-alert-message">${0}</span>
				</div>
			</div>
		`),n.Loc.getMessage("TASKS_DEADLINE_NOTIFICATION_ERROR_MESSAGE"));return babelHelpers.classPrivateFieldLooseBase(this,ds)[ds].errorContainer}function Ks(){babelHelpers.classPrivateFieldLooseBase(this,ds)[ds].defaultDeadlineChecker=new s.Checker({id:"tasks-deadline-notification-default-deadline-checker",inputName:"defaultDeadlineChecker",checked:false,title:babelHelpers.classPrivateFieldLooseBase(this,hs)[hs](),hideSeparator:true,size:"extra-small"});const e=babelHelpers.classPrivateFieldLooseBase(this,ds)[ds].defaultDeadlineSelector.render();l.EventEmitter.subscribe(babelHelpers.classPrivateFieldLooseBase(this,ds)[ds].defaultDeadlineChecker,"change",babelHelpers.classPrivateFieldLooseBase(this,Bs)[Bs].bind(this,e));return n.Tag.render(ts||(ts=Je`
			<div class="tasks-deadline-notification-form__content">
				<div class="tasks-deadline-notification-form__content_title">
					${0}
				</div>
				${0}
				<div class="tasks-deadline-notification-form__content_default-deadline-checker">
					${0}
				</div>
				${0}
			</div>
		`),n.Loc.getMessage("TASKS_DEADLINE_NOTIFICATION_DEADLINE_TITLE"),babelHelpers.classPrivateFieldLooseBase(this,ds)[ds].deadlineSelector.render(),babelHelpers.classPrivateFieldLooseBase(this,ds)[ds].defaultDeadlineChecker.render(),e)}function Ns(){return`\n\t\t\t<div>\n\t\t\t\t${n.Loc.getMessage("TASKS_DEADLINE_NOTIFICATION_DEFAULT_DEADLINE_CHECKER")}\n\t\t\t</div>\n\t\t\t<span\n\t\t\t\tdata-id="defaultDeadlineHint"\n\t\t\t\tclass="ui-hint"\n\t\t\t\tdata-hint="${n.Loc.getMessage("TASKS_DEADLINE_NOTIFICATION_DEFAULT_DEADLINE_HINT")}"\n\t\t\t\tdata-hint-no-icon\n\t\t\t>\n\t\t\t\t<span class="ui-hint-icon">\n\t\t\t\t</span>\n\t\t\t</span>\n\t\t`}function As(){if(!babelHelpers.classPrivateFieldLooseBase(this,ns)[ns]||!babelHelpers.classPrivateFieldLooseBase(this,ns)[ns].name||!babelHelpers.classPrivateFieldLooseBase(this,ns)[ns].value){return}const e=n.Tag.render(as||(as=Je`
			<input name="${0}" value="${0}" hidden>
		`),babelHelpers.classPrivateFieldLooseBase(this,ns)[ns].name,babelHelpers.classPrivateFieldLooseBase(this,ns)[ns].value);n.Dom.append(e,babelHelpers.classPrivateFieldLooseBase(this,os)[os])}function Cs(){babelHelpers.classPrivateFieldLooseBase(this,ds)[ds].footer.disableButtons();const e=babelHelpers.classPrivateFieldLooseBase(this,ds)[ds].defaultDeadlineSelector.getDeadlineInSeconds();const s=babelHelpers.classPrivateFieldLooseBase(this,ds)[ds].defaultDeadlineSelector.isExactDeadlineTime();const t=babelHelpers.classPrivateFieldLooseBase(this,ds)[ds].footer.getSkipPeriod();babelHelpers.classPrivateFieldLooseBase(this,_s)[_s](e,s).then((()=>babelHelpers.classPrivateFieldLooseBase(this,Ds)[Ds](t))).then((()=>{babelHelpers.classPrivateFieldLooseBase(this,Ss)[Ss]();babelHelpers.classPrivateFieldLooseBase(this,Ts)[Ts]()})).catch((()=>babelHelpers.classPrivateFieldLooseBase(this,ms)[ms]()))}function js(){babelHelpers.classPrivateFieldLooseBase(this,ds)[ds].footer.disableButtons();babelHelpers.classPrivateFieldLooseBase(this,Ts)[Ts]()}function ws(){if(babelHelpers.classPrivateFieldLooseBase(this,ds)[ds].deadlineSelector.getInputValue()){return}babelHelpers.classPrivateFieldLooseBase(this,ds)[ds].footer.disableButtons();const e=babelHelpers.classPrivateFieldLooseBase(this,ds)[ds].footer.getSkipPeriod();babelHelpers.classPrivateFieldLooseBase(this,Ds)[Ds](e).then((()=>{babelHelpers.classPrivateFieldLooseBase(this,Ts)[Ts]()})).catch((()=>babelHelpers.classPrivateFieldLooseBase(this,ms)[ms]()))}function Ms(e,s){const a=s.getData();if(!a){n.Dom.hide(e);return}n.Dom.show(e);if(!babelHelpers.classPrivateFieldLooseBase(this,ds)[ds].deadlineSelector.getInputValue()){babelHelpers.classPrivateFieldLooseBase(this,ds)[ds].defaultDeadlineSelector.clear();babelHelpers.classPrivateFieldLooseBase(this,ds)[ds].defaultDeadlineSelector.focus();return}const i=babelHelpers.classPrivateFieldLooseBase(this,ds)[ds].deadlineSelector.getToday();const l=babelHelpers.classPrivateFieldLooseBase(this,ds)[ds].deadlineSelector.getDeadline();const o=(l-i)/1e3;const r=t.DateRounder.roundToDays(o);if(r<=0){babelHelpers.classPrivateFieldLooseBase(this,ds)[ds].defaultDeadlineSelector.clear();babelHelpers.classPrivateFieldLooseBase(this,ds)[ds].defaultDeadlineSelector.focus();return}babelHelpers.classPrivateFieldLooseBase(this,ds)[ds].defaultDeadlineSelector.select(r)}function xs(){const e=babelHelpers.classPrivateFieldLooseBase(this,ds)[ds].deadlineSelector.getDeadline();if(e===null){babelHelpers.classPrivateFieldLooseBase(this,ds)[ds].footer.disableSubmitButton();return}babelHelpers.classPrivateFieldLooseBase(this,ds)[ds].footer.enableSubmitButton()}function $s(e){BX.UI.Hint.init(e.getTarget().contentContainer)}function Xs(){babelHelpers.classPrivateFieldLooseBase(this,ds)[ds].footer.enableCancelButton();babelHelpers.classPrivateFieldLooseBase(this,ds)[ds].footer.enableSkipButton();const e=babelHelpers.classPrivateFieldLooseBase(this,ds)[ds].deadlineSelector.getDeadline();if(!n.Type.isNull(e)){babelHelpers.classPrivateFieldLooseBase(this,ds)[ds].footer.enableSubmitButton()}n.Dom.show(babelHelpers.classPrivateFieldLooseBase(this,ds)[ds].errorContainer)}function Ws(e,s){if(!babelHelpers.classPrivateFieldLooseBase(this,ds)[ds].defaultDeadlineChecker.isChecked()){return new Promise((e=>{e()}))}const t={default:e,isExactTime:s?"Y":"N"};return n.ajax.runAction("tasks.deadline.Deadline.setDefault",{data:{deadlineData:t}})}function Rs(e){if(!babelHelpers.classPrivateFieldLooseBase(this,ds)[ds].footer.getSkipPeriod()){return new Promise((e=>{e()}))}const s={skipPeriod:e};return n.ajax.runAction("tasks.deadline.Notification.skip",{data:{notificationData:s}})}function Us(){this.close();babelHelpers.classPrivateFieldLooseBase(this,Ps)[Ps]();this.emit("onBeforeSubmit");babelHelpers.classPrivateFieldLooseBase(this,os)[os].submit()}function Vs(){const e=a.DateTimeFormat.getFormat("FORMAT_DATETIME");babelHelpers.classPrivateFieldLooseBase(this,rs)[rs].value=babelHelpers.classPrivateFieldLooseBase(this,ds)[ds].deadlineSelector.getFormattedDeadline(e)}function Ys(e){babelHelpers.classPrivateFieldLooseBase(this,os)[os]=e.targetForm;babelHelpers.classPrivateFieldLooseBase(this,rs)[rs]=e.targetInput;babelHelpers.classPrivateFieldLooseBase(this,ns)[ns]=e.targetButton;babelHelpers.classPrivateFieldLooseBase(this,cs)[cs]=e.matchWorkTime;babelHelpers.classPrivateFieldLooseBase(this,ds)[ds]={};babelHelpers.classPrivateFieldLooseBase(this,ds)[ds].deadlineSelector=new q({matchWorkTime:babelHelpers.classPrivateFieldLooseBase(this,cs)[cs],events:{onSelect:babelHelpers.classPrivateFieldLooseBase(this,Hs)[Hs].bind(this)}});babelHelpers.classPrivateFieldLooseBase(this,ds)[ds].defaultDeadlineSelector=new Ge;babelHelpers.classPrivateFieldLooseBase(this,ds)[ds].footer=new Ke({events:{onSubmitButtonClick:babelHelpers.classPrivateFieldLooseBase(this,Ls)[Ls].bind(this),onCancelButtonClick:babelHelpers.classPrivateFieldLooseBase(this,Fs)[Fs].bind(this),onSkipMenuItemSelect:babelHelpers.classPrivateFieldLooseBase(this,fs)[fs].bind(this)}});babelHelpers.classPrivateFieldLooseBase(this,ls)[ls]=new o.Popup({id:"deadline-notification",content:babelHelpers.classPrivateFieldLooseBase(this,bs)[bs](),className:"tasks__deadline-notification-popup",overlay:{opacity:40},width:600,autoHide:false,closeIcon:false,events:{onFirstShow:babelHelpers.classPrivateFieldLooseBase(this,ys)[ys].bind(this)}})}e.Notification=gs})(this.BX.Tasks.Deadline=this.BX.Tasks.Deadline||{},BX.UI.FormElements,BX.Tasks,BX.Main,BX.UI.DatePicker,BX.Event,BX.Main,BX.UI,BX,BX.Tasks,BX.UI.Analytics);
//# sourceMappingURL=notification.bundle.map.js