{"version":3,"file":"edit-form.bundle.js","sources":["../src/pages/form-page.js","../src/value-checker.js","../src/bind-filter-number-input.js","../src/pages/about-page.js","../src/pull-requests.js","../src/pages/settings-page.js","../src/pages/control-page.js","../src/edit-form.js"],"sourcesContent":["import type { Flow } from '../edit-form';\nimport { BaseEvent } from 'main.core.events';\n\nexport class FormPage\n{\n\tgetId(): string {}\n\tgetTitle(): string {}\n\tsetFlow(flow: Flow): void {}\n\tgetFlowId(): ?number {}\n\trender(): HTMLElement {}\n\tgetFields(flowData: Flow): any {}\n\tgetRequiredData(): string[] { return []; }\n\tupdate(): void { this.cleanErrors(); }\n\tcleanErrors(): void {}\n\tshowErrors(incorrectData: string[]): void {}\n\tonContinueClick(flowData: Flow = {}): Promise<boolean> {\n\t\treturn Promise.resolve(true);\n\t}\n\n\tonDialogLoad(event: BaseEvent): void {\n\t\tconst dialog = event.getTarget();\n\t\tconst tagSelector = dialog.getTagSelector();\n\n\t\t// set all unavailable items deselectable\n\t\tconst selectedItems = tagSelector.getTags();\n\t\tselectedItems.forEach((item) => {\n\t\t\tif (!item.deselectable)\n\t\t\t{\n\t\t\t\titem.setDeselectable(true);\n\t\t\t\titem.render();\n\t\t\t}\n\t\t});\n\t}\n}\n","import { Dom, Event, Loc, Runtime, Tag } from 'main.core';\nimport { BaseEvent, EventEmitter } from 'main.core.events';\nimport { Dialog } from 'ui.entity-selector';\nimport { Checker } from 'ui.form-elements.view';\n\nimport 'main.polyfill.intersectionobserver';\n\ntype Params = {\n\tid: string,\n\ttitle: string,\n\tplaceholder: ?string,\n\tvalue: ?string,\n\tentitySelector: ?Dialog,\n\tunit: ?string,\n\tsize: ?string,\n\tisFieldDisabled: ?boolean,\n\thintText?: string,\n\thintOnDisabled?: boolean,\n};\n\nexport class ValueChecker extends EventEmitter\n{\n\t#params: Params;\n\n\t#layout: {\n\t\twrap: HTMLElement,\n\t\tchecker: Checker,\n\t\tcheckerValue: ?HTMLInputElement,\n\t\tdisabledValue: ?HTMLElement,\n\t\tentitySelector: ?HTMLElement,\n\t\tcheckerContentField: HTMLElement;\n\t};\n\n\tconstructor(params: Params)\n\t{\n\t\tsuper(params);\n\n\t\tthis.setEventNamespace('BX.Tasks.Flow.EditForm.ValueChecker');\n\n\t\tthis.#params = params;\n\t\tthis.#layout = {};\n\n\t\tif (this.#params.entitySelector)\n\t\t{\n\t\t\tthis.#params.value = this.#params.entitySelector.getPreselectedItems()[0]?.[1];\n\t\t}\n\t}\n\n\tisChecked(): boolean\n\t{\n\t\treturn this.#layout.checker.isChecked();\n\t}\n\n\tgetValue(): string\n\t{\n\t\tconst entitySelectorValue = this.#getSelectedItem()?.id;\n\n\t\treturn this.#layout.checkerValue?.value || entitySelectorValue || this.#params.placeholder;\n\t}\n\n\tsetValue(value: boolean): void\n\t{\n\t\tthis.#layout.checker.switcher.check(value);\n\t}\n\n\tsetErrors(errors: string[])\n\t{\n\t\tthis.#layout.checker?.setErrors(errors);\n\t}\n\n\tcleanError()\n\t{\n\t\tthis.#layout.checker?.cleanError();\n\t}\n\n\tgetInputNode(): HTMLInputElement\n\t{\n\t\treturn this.#renderInput();\n\t}\n\n\tgetChecker(): Checker\n\t{\n\t\treturn this.#layout.checker;\n\t}\n\n\tdisable(disabled: boolean)\n\t{\n\t\tif (disabled)\n\t\t{\n\t\t\tthis.#layout.checker.switcher.check(true);\n\t\t}\n\n\t\tthis.#layout.checker.switcher.disable(disabled);\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\tthis.#layout.wrap = Tag.render`\n\t\t\t<div\n\t\t\t\tclass=\"tasks-flow__create-value-checker ${this.#params.value ? '' : '--off'}\"\n\t\t\t\tdata-id=\"tasks-flow-value-checker-${this.#params.id}\"\n\t\t\t>\n\t\t\t\t${this.#renderChecker()}\n\t\t\t\t${this.#renderValue()}\n\t\t\t\t${this.#renderEntitySelectorValue()}\n\t\t\t</div>\n\t\t`;\n\n\t\tthis.update();\n\n\t\tconst observer = new IntersectionObserver(() => {\n\t\t\tif (this.#layout.wrap.offsetWidth > 0)\n\t\t\t{\n\t\t\t\tthis.update();\n\n\t\t\t\tobserver.disconnect();\n\t\t\t}\n\t\t});\n\t\tobserver.observe(this.#layout.wrap);\n\n\t\treturn this.#layout.wrap;\n\t}\n\n\t#renderChecker(): HTMLElement\n\t{\n\t\tthis.#layout.checker = new Checker({\n\t\t\tchecked: Boolean(this.#params.value),\n\t\t\ttitle: this.#params.title,\n\t\t\thideSeparator: true,\n\t\t\tsize: this.#params.size ?? 'small',\n\t\t\tisFieldDisabled: this.#params.isFieldDisabled ?? false,\n\t\t});\n\n\t\tthis.#layout.checker.subscribe('change', (baseEvent: BaseEvent) => {\n\t\t\tconst isChecked = baseEvent.getData();\n\n\t\t\tthis.update();\n\n\t\t\tif (isChecked && this.#layout.checkerValue)\n\t\t\t{\n\t\t\t\tconst length = this.#layout.checkerValue.value.length;\n\n\t\t\t\tthis.#layout.checkerValue.focus();\n\t\t\t\tthis.#layout.checkerValue.setSelectionRange(length, length);\n\t\t\t}\n\t\t});\n\t\tEventEmitter.subscribe(this.#layout.checker.switcher, 'lock', () => {\n\t\t\tthis.#setHint(true);\n\t\t\tthis.emit('lock', this.#layout.checkerContentField);\n\t\t});\n\t\tEventEmitter.subscribe(this.#layout.checker.switcher, 'unlock', () => {\n\t\t\tthis.#setHint(false);\n\t\t\tthis.emit('unlock', this.#layout.checkerContentField);\n\t\t});\n\n\t\tthis.#layout.checkerContentField = this.#layout.checker.render();\n\n\t\tthis.#setHint(this.#params.isFieldDisabled ?? false);\n\n\t\treturn this.#layout.checkerContentField;\n\t}\n\n\t#setHint(isDisabled: boolean): void\n\t{\n\t\tif (!this.#params.hintText)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (\n\t\t\tthis.#params.hintOnDisabled === true\n\t\t\t&& isDisabled === false\n\t\t)\n\t\t{\n\t\t\tDom.attr(this.#layout.checkerContentField, 'data-hint', null);\n\t\t\tDom.attr(this.#layout.checkerContentField, 'data-hint-no-icon', null);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tDom.attr(this.#layout.checkerContentField, 'data-hint', this.#params.hintText);\n\t\t\tDom.attr(this.#layout.checkerContentField, 'data-hint-no-icon', true);\n\t\t}\n\t}\n\n\t#renderValue(): HTMLElement | string\n\t{\n\t\tif (!this.#params.placeholder)\n\t\t{\n\t\t\treturn '';\n\t\t}\n\n\t\tthis.#layout.disabledValue = Tag.render`\n\t\t\t<span class=\"tasks-flow__create-value-checker_text\">${this.getValue()}</span>\n\t\t`;\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-flow__create-value-checker_input\">\n\t\t\t\t${this.#renderInput()}\n\t\t\t\t<span>${this.#params.unit ?? ''}</span>\n\t\t\t\t${this.#layout.disabledValue}\n\t\t\t</div>\n\t\t`;\n\t}\n\n\t#renderInput(): HTMLElement\n\t{\n\t\tif (this.#layout.checkerValue)\n\t\t{\n\t\t\treturn this.#layout.checkerValue;\n\t\t}\n\n\t\tthis.#layout.checkerValue = Tag.render`\n\t\t\t<input class=\"ui-ctl-element\" placeholder=\"${this.#params.placeholder}\" value=\"${this.#params.value ?? this.#params.placeholder}\">\n\t\t`;\n\n\t\tEvent.bind(this.#layout.checkerValue, 'input', () => this.update());\n\n\t\treturn this.#layout.checkerValue;\n\t}\n\n\t#renderEntitySelectorValue(): HTMLElement|string\n\t{\n\t\tif (!this.#params.entitySelector)\n\t\t{\n\t\t\treturn '';\n\t\t}\n\n\t\tthis.#layout.entitySelector = Tag.render`\n\t\t\t<div class=\"tasks-flow-template-selector\">\n\t\t\t\t${Loc.getMessage('TASKS_FLOW_EDIT_FORM_SELECT')}\n\t\t\t</div>\n\t\t`;\n\n\t\tthis.#params.entitySelector.subscribe('Item:onSelect', this.#onEntitySelectorItemSelectedHandler.bind(this));\n\t\tthis.#params.entitySelector.subscribe('Item:onDeselect', () => this.update());\n\t\tthis.#params.entitySelector.subscribe('onLoad', () => this.update());\n\t\tthis.#params.entitySelector.setTargetNode(this.#layout.entitySelector);\n\n\t\tEvent.bind(this.#layout.entitySelector, 'click', () => {\n\t\t\tif (this.isChecked())\n\t\t\t{\n\t\t\t\tthis.#params.entitySelector.show();\n\n\t\t\t\tif (this.#params.id === 'task-template')\n\t\t\t\t{\n\t\t\t\t\tvoid this.#sendAnalytics();\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\treturn this.#layout.entitySelector;\n\t}\n\n\tasync #sendAnalytics(): Promise<void>\n\t{\n\t\tconst { sendData } = await Runtime.loadExtension('ui.analytics');\n\n\t\tsendData({\n\t\t\ttool: 'tasks',\n\t\t\tcategory: 'flows',\n\t\t\tevent: 'flow_template_select',\n\t\t\tc_section: 'tasks',\n\t\t\tc_sub_section: 'flows_grid',\n\t\t\tc_element: 'template_selection_button',\n\t\t});\n\t}\n\n\t#onEntitySelectorItemSelectedHandler()\n\t{\n\t\tthis.update();\n\t\tthis.#params.entitySelector.hide();\n\t}\n\n\tupdate(): void\n\t{\n\t\tthis.#layout.wrap.closest('form')?.dispatchEvent(new window.Event('change'));\n\n\t\tDom.addClass(this.#layout.wrap, '--off');\n\t\tif (this.isChecked())\n\t\t{\n\t\t\tDom.removeClass(this.#layout.wrap, '--off');\n\t\t}\n\n\t\tif (this.#params.entitySelector)\n\t\t{\n\t\t\tthis.#layout.entitySelector.innerText = this.#getSelectedItem()?.title.text ?? Loc.getMessage('TASKS_FLOW_EDIT_FORM_SELECT');\n\t\t}\n\n\t\tif (!this.#params.placeholder)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.#layout.disabledValue.innerText = this.getValue();\n\t\tDom.style(this.#layout.disabledValue, 'display', '');\n\t\tthis.#layout.checkerValue.style.width = `${this.#layout.disabledValue.offsetWidth + 7}px`;\n\t\tconst checkerField = this.#layout.wrap.querySelector('.ui-section__field');\n\t\tthis.#layout.checkerValue.style.height = `${checkerField.offsetHeight}px`;\n\t}\n\n\t#getSelectedItem(): any\n\t{\n\t\treturn this.#params.entitySelector?.getSelectedItems()[0];\n\t}\n}","type Params = {\n\tinput: HTMLInputElement,\n\tmin: ?number,\n\tmax: ?number,\n};\n\nclass BindFilterNumberInput\n{\n\t#params: Params;\n\n\tconstructor(params: Params)\n\t{\n\t\tthis.#params = params;\n\n\t\tthis.#bind(params.input);\n\t}\n\n\t#bind(input: HTMLInputElement): void\n\t{\n\t\tlet dispatchedProgrammatically = false;\n\t\tinput.addEventListener('input', () => {\n\t\t\tif (dispatchedProgrammatically)\n\t\t\t{\n\t\t\t\tdispatchedProgrammatically = false;\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst textBeforeCursor = this.#getTextBeforeCursor(input);\n\n\t\t\tinput.value = this.#normalizeNumber(input.value) || '';\n\n\t\t\tthis.#setCursorToFormattedPosition(input, textBeforeCursor);\n\n\t\t\tdispatchedProgrammatically = true;\n\t\t\tinput.dispatchEvent(new Event('input'));\n\t\t});\n\t}\n\n\t#getTextBeforeCursor(input: HTMLInputElement): string\n\t{\n\t\tconst selectionStart = input.selectionStart;\n\t\tconst text = input.value.slice(0, selectionStart);\n\n\t\treturn this.#normalizeNumber(text);\n\t}\n\n\t#normalizeNumber(value: string): string\n\t{\n\t\tlet normalizedValue = value.replace(/\\D/g, '');\n\t\tnormalizedValue = parseInt(normalizedValue, 10);\n\t\tnormalizedValue = Math.max(this.#params.min ?? 1, normalizedValue);\n\t\tnormalizedValue = Math.min(this.#params.max ?? 9999, normalizedValue);\n\n\t\treturn `${normalizedValue || ''}`;\n\t}\n\n\t#setCursorToFormattedPosition(input: HTMLInputElement, textBeforeCursor: string): void\n\t{\n\t\tconst firstPart = textBeforeCursor.slice(0, -1);\n\t\tconst lastCharacter = textBeforeCursor.slice(-1);\n\t\tconst matches = input.value.match(`${firstPart}.*?${lastCharacter}`);\n\t\tif (!matches)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst match = matches[0];\n\t\tconst formattedPosition = input.value.indexOf(match) + match.length;\n\t\tinput.setSelectionRange(formattedPosition, formattedPosition);\n\t}\n}\n\nconst bindFilterNumberInput = (params: Params) => new BindFilterNumberInput(params);\n\nexport { bindFilterNumberInput };","import { ajax, Event, Loc, Extension, Tag, Text, Type } from 'main.core';\nimport { BaseEvent } from 'main.core.events';\nimport { TextInput, TextArea, UserSelector } from 'ui.form-elements.view';\nimport { Interval, IntervalSelector } from 'tasks.interval-selector';\nimport { FormPage } from './form-page';\nimport { ValueChecker } from '../value-checker';\nimport { bindFilterNumberInput } from '../bind-filter-number-input';\n\nimport type { Flow } from '../edit-form';\n\ntype Params = {\n\tonChangeHandler: Function,\n};\n\nexport class AboutPage extends FormPage\n{\n\t#params: Params;\n\n\t#layout: {\n\t\taboutPageForm: HTMLFormElement,\n\n\t\tflowName: TextInput,\n\t\tflowDescription: TextInput,\n\t\ttaskCreatorsSelector: UserSelector,\n\t\tplannedCompletionTime: TextInput,\n\t\tplannedCompletionTimeIntervalSelector: IntervalSelector,\n\t\tskipWeekends: ValueChecker,\n\t};\n\n\t#flow: Flow;\n\n\tconstructor(params: Params)\n\t{\n\t\tsuper();\n\t\tthis.#params = params;\n\t\tthis.#layout = {};\n\t\tthis.#flow = {};\n\t}\n\n\tsetFlow(flow: Flow): void\n\t{\n\t\tthis.#flow = flow;\n\t}\n\n\tgetFlowId(): ?number\n\t{\n\t\treturn this.#flow.id ?? null;\n\t}\n\n\tgetId(): string\n\t{\n\t\treturn 'about-flow';\n\t}\n\n\tgetTitle(): string\n\t{\n\t\treturn Loc.getMessage('TASKS_FLOW_EDIT_FORM_ABOUT_FLOW');\n\t}\n\n\tgetRequiredData(): string[]\n\t{\n\t\treturn ['name', 'plannedCompletionTime', 'taskCreators'];\n\t}\n\n\tshowErrors(incorrectData: string[]): void\n\t{\n\t\tif (incorrectData.includes('name'))\n\t\t{\n\t\t\tthis.#layout.flowName.setErrors([Loc.getMessage('TASKS_FLOW_EDIT_FORM_FLOW_NAME_ERROR')]);\n\t\t}\n\n\t\tif (incorrectData.includes('plannedCompletionTime'))\n\t\t{\n\t\t\tthis.#layout.plannedCompletionTime.setErrors(\n\t\t\t\t[Loc.getMessage('TASKS_FLOW_EDIT_FORM_PLANNED_COMPLETION_TIME_ERROR')],\n\t\t\t);\n\t\t\tthis.#layout.plannedCompletionTime.emit('onSetErrors');\n\t\t}\n\n\t\tif (incorrectData.includes('taskCreators'))\n\t\t{\n\t\t\tthis.#layout.taskCreatorsSelector.setErrors(\n\t\t\t\t[Loc.getMessage('TASKS_FLOW_EDIT_FORM_TASKS_CREATORS_ERROR')],\n\t\t\t);\n\t\t}\n\t}\n\n\tcleanErrors(): void\n\t{\n\t\tthis.#layout.flowName.cleanError();\n\t\tthis.#layout.plannedCompletionTime.cleanError();\n\t\tthis.#layout.taskCreatorsSelector.cleanError();\n\n\t\tthis.#layout.plannedCompletionTime.emit('onCleanErrors');\n\t}\n\n\tgetFields(flowData: Flow = {}): Flow\n\t{\n\t\tconst plannedCompletionTimeValue = parseInt(this.#layout.plannedCompletionTime?.getValue(), 10);\n\t\tconst intervalDuration = this.#layout.plannedCompletionTimeIntervalSelector?.getDuration();\n\t\tconst interval = this.#layout.plannedCompletionTimeIntervalSelector?.getInterval();\n\n\t\treturn {\n\t\t\tname: flowData.name ?? this.#layout.flowName?.getValue().trim(),\n\t\t\tdescription: flowData.description ?? this.#layout.flowDescription?.getValue(),\n\t\t\ttaskCreators: flowData.taskCreators ?? this.#getTasksCreatorsFromSelector(),\n\t\t\tplannedCompletionTime: flowData.plannedCompletionTime ?? (plannedCompletionTimeValue * intervalDuration || 0),\n\t\t\tmatchSchedule: flowData.matchSchedule ?? this.#isShortInterval(interval),\n\t\t\tmatchWorkTime: flowData.matchWorkTime ?? (this.#layout.skipWeekends?.isChecked() ?? true),\n\t\t};\n\t}\n\n\t#getTasksCreatorsFromSelector()\n\t{\n\t\tlet taskCreators = this.#layout.taskCreatorsSelector\n\t\t\t?.getSelector()\n\t\t\t.getTags()\n\t\t\t.map((tag) => [tag.entityId, tag.id])\n\t\t;\n\n\t\tif (Type.isUndefined(taskCreators) || taskCreators.length === 0)\n\t\t{\n\t\t\ttaskCreators = this.#layout.taskCreatorsSelector\n\t\t\t\t?.getSelector()\n\t\t\t\t?.getDialog()\n\t\t\t\t.getPreselectedItems()\n\t\t\t;\n\t\t}\n\n\t\treturn taskCreators;\n\t}\n\n\t#isShortInterval(interval: Interval): boolean\n\t{\n\t\tconst shortIntervals = ['minutes', 'hours'];\n\n\t\treturn shortIntervals.includes(interval);\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\tthis.#layout.flowName = new TextInput({\n\t\t\tid: 'tasks-flow-edit-form-field-name',\n\t\t\tlabel: Loc.getMessage('TASKS_FLOW_EDIT_FORM_FLOW_NAME'),\n\t\t\tplaceholder: Loc.getMessage('TASKS_FLOW_EDIT_FORM_FLOW_NAME_PLACEHOLDER'),\n\t\t\tvalue: this.#flow.name,\n\t\t});\n\n\t\tthis.#layout.flowDescription = new TextArea({\n\t\t\tid: 'tasks-flow-edit-form-field-description',\n\t\t\tlabel: Loc.getMessage('TASKS_FLOW_EDIT_FORM_DESCRIPTION'),\n\t\t\tplaceholder: Loc.getMessage('TASKS_FLOW_EDIT_FORM_DESCRIPTION_PLACEHOLDER'),\n\t\t\tvalue: this.#flow.description,\n\t\t\tresizeOnlyY: true,\n\t\t});\n\n\t\tthis.#layout.taskCreatorsSelector = new UserSelector({\n\t\t\tid: 'tasks-flow-edit-form-field-creators',\n\t\t\tlabel: Loc.getMessage('TASKS_FLOW_EDIT_FORM_WHO_CAN_ADD_TASKS'),\n\t\t\tenableDepartments: true,\n\t\t\tvalues: this.#flow.taskCreators,\n\t\t\tdialogEvents: {\n\t\t\t\tonLoad: this.onDialogLoad,\n\t\t\t},\n\t\t});\n\n\t\tthis.#layout.aboutPageForm = Tag.render`\n\t\t\t<form class=\"tasks-flow__create-about\">\n\t\t\t\t${this.#layout.flowName.render()}\n\t\t\t\t${this.#layout.flowDescription.render()}\n\t\t\t\t<div class=\"tasks-flow__create-separator --empty\"></div>\n\t\t\t\t${this.#layout.taskCreatorsSelector.render()}\n\t\t\t\t<div class=\"tasks-flow__create-separator --empty\"></div>\n\t\t\t\t${this.#renderPlannedCompletionTime()}\n\t\t\t</form>\n\t\t`;\n\n\t\tEvent.bind(this.#layout.aboutPageForm, 'change', this.#params.onChangeHandler);\n\n\t\treturn this.#layout.aboutPageForm;\n\t}\n\n\tfocusToEmptyName()\n\t{\n\t\tconst isEmpty = this.#layout.flowName.getValue().trim().length === 0;\n\n\t\tif (isEmpty)\n\t\t{\n\t\t\tthis.#layout.flowName.getInputNode().focus();\n\t\t}\n\t}\n\n\t#renderPlannedCompletionTime(): HTMLElement\n\t{\n\t\tconst value = this.#flow.plannedCompletionTime;\n\t\tthis.#layout.plannedCompletionTimeIntervalSelector = new IntervalSelector({ value });\n\n\t\tthis.#layout.plannedCompletionTimeIntervalSelector.subscribe('intervalChanged', (event) => {\n\t\t\tconst interval = event.getData().interval;\n\t\t\tconst isSkipWeekendsDisabled = this.#isShortInterval(interval);\n\n\t\t\tthis.#layout.skipWeekends.disable(isSkipWeekendsDisabled);\n\t\t});\n\n\t\tconst duration = this.#layout.plannedCompletionTimeIntervalSelector.getDuration();\n\n\t\tconst plannedCompletionTimeLabel = `\n\t\t\t<div class=\"tasks-flow__create-title-with-hint\">\n\t\t\t\t${Loc.getMessage('TASKS_FLOW_EDIT_FORM_PLANNED_COMPLETION_TIME')}\n\t\t\t\t<span\n\t\t\t\t\tdata-id=\"plannedCompletionTimeHint\"\n\t\t\t\t\tclass=\"ui-hint\"\n\t\t\t\t\tdata-hint=\"${Loc.getMessage('TASKS_FLOW_EDIT_FORM_PLANNED_COMPLETION_TIME_HINT')}\" \n\t\t\t\t\tdata-hint-no-icon\n\t\t\t\t>\n\t\t\t\t\t<span class=\"ui-hint-icon\"></span>\n\t\t\t\t</span>\n\t\t\t</div>\n\t\t`;\n\n\t\tthis.#layout.plannedCompletionTime = new TextInput({\n\t\t\tlabel: plannedCompletionTimeLabel,\n\t\t\tplaceholder: '5',\n\t\t\tinputDefaultWidth: true,\n\t\t\tvalue: String(value / duration || ''),\n\t\t});\n\n\t\tconst maxInt = (2 ** 32) / 2 - 1;\n\t\tconst monthDuration = 60 * 60 * 24 * 31;\n\n\t\tbindFilterNumberInput({\n\t\t\tinput: this.#layout.plannedCompletionTime.getInputNode(),\n\t\t\tmax: Math.floor(maxInt / monthDuration),\n\t\t});\n\n\t\tconst interval = this.#layout.plannedCompletionTimeIntervalSelector.getInterval();\n\t\tconst isSkipWeekendsDisabled = this.#isShortInterval(interval);\n\n\t\tthis.#layout.skipWeekends = new ValueChecker({\n\t\t\tid: 'planned-completion-time-skip-weekends',\n\t\t\ttitle: Loc.getMessage('TASKS_FLOW_EDIT_FORM_SKIP_WEEKENDS'),\n\t\t\tvalue: isSkipWeekendsDisabled ? true : this.#flow.id === 0 || this.#flow.matchWorkTime,\n\t\t\tsize: 'extra-small',\n\t\t\tisFieldDisabled: isSkipWeekendsDisabled,\n\t\t\thintText: Loc.getMessage('TASKS_FLOW_EDIT_FORM_DISABLED_SKIP_WEEKENDS_HINT'),\n\t\t\thintOnDisabled: true,\n\t\t});\n\t\tthis.#layout.skipWeekends.subscribe('lock', (baseEvent: BaseEvent) => {\n\t\t\trequestAnimationFrame(() => {\n\t\t\t\tconst hintManager = top.BX.UI.Hint.createInstance({\n\t\t\t\t\tid: `tasks-flow-edit-form-about-page-${Text.getRandom()}`,\n\t\t\t\t\tclassName: 'skipInitByClassName',\n\t\t\t\t\tpopupParameters: {\n\t\t\t\t\t\ttargetContainer: this.#layout.aboutPageForm.closest('.tasks-wizard__step'),\n\t\t\t\t\t},\n\t\t\t\t});\n\t\t\t\thintManager.initNode(baseEvent.getData());\n\t\t\t});\n\t\t});\n\n\t\tconst root = Tag.render`\n\t\t\t<div data-id=\"tasks-flow-edit-form-field-planned-time\">\n\t\t\t\t<div class=\"tasks-flow__create-planned_completion-time\">\n\t\t\t\t\t${this.#layout.plannedCompletionTime.render()}\n\t\t\t\t\t<div class=\"tasks-flow__create-planned_completion-time-interval\">\n\t\t\t\t\t\t${this.#layout.plannedCompletionTimeIntervalSelector.render()}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t${this.#layout.skipWeekends.render()}\n\t\t\t</div>\n\t\t`;\n\n\t\treturn root;\n\t}\n\n\tasync onContinueClick(flowData: Flow = {}): Promise<boolean>\n\t{\n\t\tconst { data: response } = await ajax.runAction('tasks.flow.Flow.isExists', {\n\t\t\tdata: {\n\t\t\t\tflowData: flowData,\n\t\t\t},\n\t\t});\n\n\t\tif (response.exists)\n\t\t{\n\t\t\tthis.#layout.flowName.setErrors([Loc.getMessage('TASKS_FLOW_EDIT_FORM_FLOW_DUPLICATE_ERROR')]);\n\n\t\t\treturn false;\n\t\t}\n\n\t\treturn true;\n\t}\n}\n","import { EventEmitter } from 'main.core.events';\n\nexport class PullRequests extends EventEmitter\n{\n\t#userId: number;\n\n\tconstructor(userId: number)\n\t{\n\t\tsuper();\n\n\t\tthis.setEventNamespace('BX.Tasks.Flow.EditForm.PullRequests');\n\n\t\tthis.#userId = parseInt(userId, 10);\n\t}\n\n\tgetModuleId(): string\n\t{\n\t\treturn 'tasks';\n\t}\n\n\tgetMap(): Object\n\t{\n\t\treturn {\n\t\t\ttemplate_add: this.#onTemplateAdded.bind(this),\n\t\t\ttemplate_update: this.#onTemplateUpdated.bind(this),\n\t\t};\n\t}\n\n\t#onTemplateAdded(data): void\n\t{\n\t\tthis.emit('templateAdded', {\n\t\t\ttemplate: {\n\t\t\t\tid: data.TEMPLATE_ID,\n\t\t\t\ttitle: data.TEMPLATE_TITLE,\n\t\t\t},\n\t\t});\n\t}\n\n\t#onTemplateUpdated(data): void\n\t{\n\t\tthis.emit('templateUpdated', {\n\t\t\ttemplate: {\n\t\t\t\tid: data.TEMPLATE_ID,\n\t\t\t\ttitle: data.TEMPLATE_TITLE,\n\t\t\t},\n\t\t});\n\t}\n}\n","import { Dom, Event, Extension, Loc, Tag, Type, ajax } from 'main.core';\nimport { PULL as Pull } from 'pull.client';\nimport { Dialog, TagItem, TagSelector } from 'ui.entity-selector';\nimport { UserSelector } from 'ui.form-elements.view';\nimport { PullRequests } from '../pull-requests';\nimport { FormPage } from './form-page';\nimport { ValueChecker } from '../value-checker';\n\nimport type { DistributionType, Flow } from '../edit-form';\n\ntype Params = {\n\tonChangeHandler: Function,\n};\n\nconst BIG_DEPARTMENT_USER_COUNT = 30;\n\nconst HINT_MESSAGES_BY_COUNT = [\n\t{ condition: (count) => count === 0, message: 'TASKS_FLOW_EDIT_FORM_THIS_IS_EMPTY_DEPARTMENT_HINT' },\n\t{ condition: (count) => count > BIG_DEPARTMENT_USER_COUNT, message: 'TASKS_FLOW_EDIT_FORM_THIS_IS_BIG_DEPARTMENT_HINT' },\n];\n\nexport class SettingsPage extends FormPage\n{\n\t#params: Params;\n\n\t#layout: {\n\t\tsettingsPageForm: HTMLFormElement,\n\n\t\tqueueDistribution: HTMLElement,\n\t\tqueueRadio: HTMLInputElement,\n\t\tresponsiblesQueueSelector: UserSelector,\n\t\tresponsiblesHimselfSelector: UserSelector,\n\t\tresponsiblesImmutableSelector: UserSelector,\n\t\tmanuallyDistribution: HTMLElement,\n\t\tmanuallyRadio: HTMLInputElement,\n\t\thimselfDistribution: HTMLElement,\n\t\thimselfRadio: HTMLInputElement,\n\t\timmutableDistribution: HTMLElement,\n\t\timmutableRadio: HTMLInputElement,\n\t\tmoderatorSelector: UserSelector,\n\t\tresponsibleCanChangeDeadline: ValueChecker,\n\t\tnotifyAtHalfTime: ValueChecker,\n\t\ttaskControl: ValueChecker,\n\t\tprojectSelector: UserSelector,\n\t\ttaskTemplate: ValueChecker,\n\t\ttaskTemplateDialog: Dialog,\n\t};\n\n\t#flow: Flow;\n\n\tconstructor(params: Params)\n\t{\n\t\tsuper();\n\t\tthis.#params = params;\n\t\tthis.#layout = {};\n\t\tthis.#flow = {};\n\n\t\tthis.#init();\n\t}\n\n\tget #currentUser(): number\n\t{\n\t\tconst settings = Extension.getSettings('tasks.flow.edit-form');\n\n\t\treturn settings.currentUser;\n\t}\n\n\t#init()\n\t{\n\t\tthis.#subscribeToPull();\n\t}\n\n\t#subscribeToPull(): void\n\t{\n\t\tconst pullRequests = new PullRequests(this.#currentUser);\n\t\tpullRequests.subscribe('templateAdded', this.#onTemplateAddedHandler.bind(this));\n\t\tpullRequests.subscribe('templateUpdated', this.#onTemplateUpdatedHandler.bind(this));\n\n\t\tPull.subscribe(pullRequests);\n\t}\n\n\t#onTemplateAddedHandler({ data })\n\t{\n\t\tconst template = data.template;\n\t\tconst templateItem = {\n\t\t\tid: template.id,\n\t\t\tentityId: 'task-template',\n\t\t\ttitle: template.title,\n\t\t\ttabs: 'recents',\n\t\t};\n\n\t\tthis.#layout.taskTemplateDialog.addItem(templateItem);\n\n\t\tthis.#layout.taskTemplateDialog.getItems().find((item) => item.id === templateItem.id).select();\n\t}\n\n\t#onTemplateUpdatedHandler({ data })\n\t{\n\t\tconst template = data.template;\n\t\tconst templateItem = this.#layout.taskTemplateDialog.getItem({ id: template.id, entityId: 'task-template' });\n\n\t\tif (Type.isStringFilled(template.title))\n\t\t{\n\t\t\ttemplateItem?.setTitle(template.title);\n\t\t\tthis.#layout.taskTemplate?.update();\n\t\t}\n\n\t\tif (!Type.isArrayFilled(this.#layout.taskTemplateDialog.getSelectedItems()))\n\t\t{\n\t\t\ttemplateItem?.select();\n\t\t}\n\t}\n\n\tsetFlow(flow: Flow): void\n\t{\n\t\tthis.#flow = flow;\n\t}\n\n\tgetFlowId(): ?number\n\t{\n\t\treturn this.#flow.id ?? null;\n\t}\n\n\tgetId(): string\n\t{\n\t\treturn 'settings';\n\t}\n\n\tgetTitle(): string\n\t{\n\t\treturn Loc.getMessage('TASKS_FLOW_EDIT_FORM_SETTINGS');\n\t}\n\n\tgetRequiredData(): string[]\n\t{\n\t\tconst requiredData = [\n\t\t\t'groupId',\n\t\t\t'responsibleList',\n\t\t];\n\n\t\tif (this.#layout.taskTemplate.isChecked())\n\t\t{\n\t\t\trequiredData.push('templateId');\n\t\t}\n\n\t\treturn requiredData;\n\t}\n\n\tupdate(): void\n\t{\n\t\tsuper.update();\n\n\t\tDom.removeClass(this.#layout.queueDistribution, '--active');\n\t\tDom.removeClass(this.#layout.manuallyDistribution, '--active');\n\t\tDom.removeClass(this.#layout.himselfDistribution, '--active');\n\t\tDom.removeClass(this.#layout.immutableDistribution, '--active');\n\n\t\tif (this.#layout.queueRadio.checked)\n\t\t{\n\t\t\tDom.addClass(this.#layout.queueDistribution, '--active');\n\t\t}\n\n\t\tif (this.#layout.manuallyRadio.checked)\n\t\t{\n\t\t\tDom.addClass(this.#layout.manuallyDistribution, '--active');\n\t\t}\n\n\t\tif (this.#layout.himselfRadio.checked)\n\t\t{\n\t\t\tDom.addClass(this.#layout.himselfDistribution, '--active');\n\t\t}\n\n\t\tif (this.#layout.immutableRadio.checked)\n\t\t{\n\t\t\tDom.addClass(this.#layout.immutableDistribution, '--active');\n\t\t}\n\t}\n\n\tshowErrors(incorrectData: string[]): void\n\t{\n\t\tif (incorrectData.includes('responsibleList'))\n\t\t{\n\t\t\tthis.#showResponsibleListError();\n\t\t}\n\n\t\tif (incorrectData.includes('groupId'))\n\t\t{\n\t\t\tthis.#layout.projectSelector.setErrors([Loc.getMessage('TASKS_FLOW_EDIT_FORM_PROJECT_FOR_TASKS_ERROR')]);\n\t\t}\n\n\t\tif (incorrectData.includes('templateId'))\n\t\t{\n\t\t\tthis.#layout.taskTemplate.setErrors([Loc.getMessage('TASKS_FLOW_EDIT_FORM_TEMPLATE_FOR_TASKS_ERROR')]);\n\t\t}\n\t}\n\n\t#showResponsibleListError(): void\n\t{\n\t\tconst distributionType = new FormData(this.#layout.settingsPageForm).get('distribution');\n\n\t\t// eslint-disable-next-line default-case\n\t\tswitch (distributionType)\n\t\t{\n\t\t\tcase 'manually':\n\t\t\t\tthis.#layout.moderatorSelector.setErrors([Loc.getMessage('TASKS_FLOW_EDIT_FORM_TASKS_MODERATOR_ERROR')]);\n\t\t\t\tbreak;\n\t\t\tcase 'queue':\n\t\t\t\tthis.#layout.responsiblesQueueSelector.setErrors([Loc.getMessage('TASKS_FLOW_EDIT_FORM_TASKS_RESPONSIBLES_ERROR')]);\n\t\t\t\tbreak;\n\t\t\tcase 'himself':\n\t\t\t\tthis.#layout.responsiblesHimselfSelector.setErrors([Loc.getMessage('TASKS_FLOW_EDIT_FORM_TASKS_RESPONSIBLES_ERROR')]);\n\t\t\t\tbreak;\n\t\t\tcase 'immutable':\n\t\t\t\tthis.#layout.responsiblesImmutableSelector.setErrors([Loc.getMessage('TASKS_FLOW_EDIT_FORM_TASKS_RESPONSIBLES_ERROR')]);\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\tcleanErrors(): void\n\t{\n\t\tthis.#layout.projectSelector.cleanError();\n\t\tthis.#layout.responsiblesQueueSelector.cleanError();\n\t\tthis.#layout.responsiblesHimselfSelector.cleanError();\n\t\tthis.#layout.responsiblesImmutableSelector.cleanError();\n\t\tthis.#layout.moderatorSelector.cleanError();\n\t\tthis.#layout.taskTemplate.cleanError();\n\t}\n\n\tgetFields(flowData: Flow = {}): Flow\n\t{\n\t\tconst selectedDistributionType = new FormData(this.#layout.settingsPageForm).get('distribution');\n\t\tconst distributionType: DistributionType = flowData.distributionType ?? (selectedDistributionType || 'queue');\n\n\t\tconst responsibleList = this.#getResponsiblesByDistributionType(distributionType, flowData);\n\n\t\tlet groupId = this.#flow.groupId;\n\t\tif (this.#layout.projectSelector?.getSelector().getDialog().isLoaded())\n\t\t{\n\t\t\tgroupId = this.#layout.projectSelector.getSelector().getTags()[0]?.id;\n\t\t}\n\n\t\treturn {\n\t\t\tdistributionType,\n\t\t\tresponsibleList,\n\t\t\tresponsibleCanChangeDeadline: flowData.responsibleCanChangeDeadline ?? (this.#layout.responsibleCanChangeDeadline?.isChecked() ?? false),\n\t\t\tnotifyAtHalfTime: flowData.notifyAtHalfTime ?? (this.#layout.notifyAtHalfTime?.isChecked() ?? false),\n\t\t\ttaskControl: flowData.taskControl ?? (this.#layout.taskControl?.isChecked() ?? false),\n\t\t\tgroupId: flowData.groupId ?? (groupId || 0),\n\t\t\ttemplateId: flowData.templateId ?? (this.#layout.taskTemplate?.isChecked() ? this.#layout.taskTemplate.getValue() : 0),\n\t\t};\n\t}\n\n\t#getResponsiblesByDistributionType(distributionType: DistributionType, flowData: Flow = {}): Array\n\t{\n\t\tlet responsibleList = [];\n\n\t\tconst isConsiderFlowResponsible = this.#flow.distributionType === distributionType;\n\t\tif (isConsiderFlowResponsible)\n\t\t{\n\t\t\tresponsibleList = this.#flow.responsibleList;\n\t\t}\n\n\t\tconst responsibleListFromSelector = this.#getResponsiblesFromSelectorByDistributionType(distributionType);\n\t\tif (!Type.isNull(responsibleListFromSelector))\n\t\t{\n\t\t\tresponsibleList = responsibleListFromSelector;\n\t\t}\n\n\t\tconst isConsiderFlowDataResponsible = flowData.distributionType === distributionType;\n\t\tif (isConsiderFlowDataResponsible)\n\t\t{\n\t\t\treturn flowData.responsibleList ?? responsibleList;\n\t\t}\n\n\t\treturn responsibleList;\n\t}\n\n\t#getResponsiblesFromSelectorByDistributionType(distributionType: DistributionType): ?Array\n\t{\n\t\tswitch (distributionType)\n\t\t{\n\t\t\tcase 'manually':\n\t\t\t\treturn this.#getResponsiblesFromSelector(this.#layout.moderatorSelector);\n\n\t\t\tcase 'queue':\n\t\t\t\treturn this.#getResponsiblesFromSelector(this.#layout.responsiblesQueueSelector);\n\n\t\t\tcase 'himself':\n\t\t\t\treturn this.#getResponsiblesFromSelector(this.#layout.responsiblesHimselfSelector);\n\n\t\t\tcase 'immutable':\n\t\t\t\treturn this.#getResponsiblesFromSelector(this.#layout.responsiblesImmutableSelector);\n\n\t\t\tdefault:\n\t\t\t\treturn null;\n\t\t}\n\t}\n\n\t#getResponsiblesFromSelector(selector: UserSelector): ?Array\n\t{\n\t\tif (selector?.getSelector().getDialog().isLoaded())\n\t\t{\n\t\t\treturn selector\n\t\t\t\t?.getSelector()\n\t\t\t\t.getTags()\n\t\t\t\t.map((tag) => [tag.entityId, tag.id])\n\t\t\t;\n\t\t}\n\n\t\treturn null;\n\t}\n\n\t#addFlowTeamTooltip(): void\n\t{\n\t\tconst immutableFieldLabel = this.#layout.immutableDistribution.querySelector('.ui-section__field-label');\n\t\tif (Type.isDomNode(immutableFieldLabel))\n\t\t{\n\t\t\tconst immutableDistributionTooltip = this.#renderImmutableFlowTeamTooltip();\n\t\t\tDom.append(immutableDistributionTooltip, immutableFieldLabel);\n\t\t}\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\tthis.#layout.responsibleCanChangeDeadline = new ValueChecker({\n\t\t\tid: 'responsible-can-change-deadline',\n\t\t\ttitle: Loc.getMessage('TASKS_FLOW_EDIT_FORM_RESPONSIBLE_CAN_CHANGE_DEADLINE'),\n\t\t\tvalue: this.#flow.responsibleCanChangeDeadline,\n\t\t});\n\n\t\tconst notifyAtHalfTimeTitle = `\n\t\t\t<div class=\"tasks-flow__create-title-with-hint\">\n\t\t\t\t<span>${Loc.getMessage('TASKS_FLOW_EDIT_FORM_NOTIFY_AT_HALF_TIME')}</span>\n\t\t\t\t<span\n\t\t\t\t\tdata-id=\"notifyAtHalfTimeHint\"\n\t\t\t\t\tclass=\"ui-hint ui-hint-flow-value-checker\"\n\t\t\t\t\tdata-hint=\"${Loc.getMessage('TASKS_FLOW_EDIT_FORM_NOTIFY_AT_HALF_TIME_HINT')}\" \n\t\t\t\t\tdata-hint-no-icon\n\t\t\t\t>\n\t\t\t\t\t<span class=\"ui-hint-icon ui-hint-icon-flow-value-checker\"></span>\n\t\t\t\t</span>\n\t\t\t</div>\n\t\t`;\n\n\t\tthis.#layout.notifyAtHalfTime = new ValueChecker({\n\t\t\tid: 'notify-at-half-time',\n\t\t\ttitle: notifyAtHalfTimeTitle,\n\t\t\tvalue: this.#flow.notifyAtHalfTime,\n\t\t});\n\n\t\tthis.#layout.taskControl = new ValueChecker({\n\t\t\tid: 'task-control',\n\t\t\ttitle: Loc.getMessage('TASKS_FLOW_EDIT_FORM_TASK_CONTROL'),\n\t\t\tvalue: this.#flow.taskControl,\n\t\t});\n\n\t\tthis.#layout.projectSelector = new UserSelector({\n\t\t\tlabel: this.#getProjectLabel(),\n\t\t\tenableUsers: false,\n\t\t\tenableDepartments: false,\n\t\t\tmultiple: false,\n\t\t\tentities: [\n\t\t\t\t{\n\t\t\t\t\tid: 'project',\n\t\t\t\t\toptions: {\n\t\t\t\t\t\tfeatures: {\n\t\t\t\t\t\t\ttasks: [],\n\t\t\t\t\t\t},\n\t\t\t\t\t\tflow: true,\n\t\t\t\t\t\tcheckFeatureForCreate: true,\n\t\t\t\t\t\t'!type': ['collab'],\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t],\n\t\t\tvalues: this.#flow.groupId ? [['project', this.#flow.groupId]] : [],\n\t\t\tdialogEvents: {\n\t\t\t\tonLoad: this.onDialogLoad,\n\t\t\t},\n\t\t});\n\n\t\tthis.#layout.taskTemplate = new ValueChecker({\n\t\t\tid: 'task-template',\n\t\t\ttitle: Loc.getMessage('TASKS_FLOW_EDIT_FORM_ACCEPT_TASKS_BY_TEMPLATE_TITLE'),\n\t\t\tentitySelector: this.#getTaskTemplateDialog(),\n\t\t\tisFieldDisabled: this.#flow.distributionType === 'immutable',\n\t\t});\n\n\t\tthis.#layout.settingsPageForm = Tag.render`\n\t\t\t<form class=\"tasks-flow__create-settings\">\n\t\t\t\t${this.#renderDistribution()}\n\t\t\t\t<div class=\"tasks-flow__create-separator --empty\"></div>\n\t\t\t\t${this.#layout.responsibleCanChangeDeadline.render()}\n\t\t\t\t${this.#layout.notifyAtHalfTime.render()}\n\t\t\t\t${this.#layout.taskControl.render()}\n\t\t\t\t<div class=\"tasks-flow__create-separator\"></div>\n\t\t\t\t${this.#layout.projectSelector.render()}\n\t\t\t\t<div class=\"tasks-flow__create-separator --empty\"></div>\n\t\t\t\t${this.#layout.taskTemplate.render()}\n\t\t\t</form>\n\t\t`;\n\n\t\tEvent.bind(this.#layout.settingsPageForm, 'change', this.#params.onChangeHandler);\n\n\t\treturn this.#layout.settingsPageForm;\n\t}\n\n\t#renderDistribution(): HTMLElement\n\t{\n\t\tthis.#layout.responsiblesQueueSelector = this.#getResponsiblesSelector(\n\t\t\tthis.#flow.distributionType === 'queue' ? this.#flow.responsibleList : [],\n\t\t\tfalse,\n\t\t);\n\n\t\tthis.#layout.responsiblesHimselfSelector = this.#getResponsiblesSelector(\n\t\t\tthis.#flow.distributionType === 'himself' ? this.#flow.responsibleList : [],\n\t\t);\n\n\t\tthis.#layout.responsiblesImmutableSelector = this.#getResponsiblesSelector(\n\t\t\t(\n\t\t\t\tthis.#flow.distributionType === 'immutable'\n\t\t\t\t&& Type.isArrayFilled(this.#flow.responsibleList)\n\t\t\t)\n\t\t\t\t? this.#flow.responsibleList\n\t\t\t\t: [['user', this.#currentUser]],\n\t\t);\n\n\t\tthis.#layout.moderatorSelector = new UserSelector({\n\t\t\tenableAll: false,\n\t\t\tenableDepartments: false,\n\t\t\tmultiple: false,\n\t\t\tvalues: [[\n\t\t\t\t'user',\n\t\t\t\tthis.#flow.distributionType === 'manually' && Type.isArrayFilled(this.#flow.responsibleList)\n\t\t\t\t\t? this.#flow.responsibleList[0][1]\n\t\t\t\t\t: this.#currentUser,\n\t\t\t]],\n\t\t\tdialogEvents: {\n\t\t\t\tonLoad: this.onDialogLoad,\n\t\t\t},\n\t\t});\n\n\t\tconst { root: queueDistribution, radio: queueRadio } = this.#renderDistributionType({\n\t\t\ttype: 'queue',\n\t\t\tselector: this.#layout.responsiblesQueueSelector,\n\t\t});\n\t\tthis.#layout.queueDistribution = queueDistribution;\n\t\tthis.#layout.queueRadio = queueRadio;\n\n\t\tconst { root: manuallyDistribution, radio: manuallyRadio } = this.#renderDistributionType({\n\t\t\ttype: 'manually',\n\t\t\tselector: this.#layout.moderatorSelector,\n\t\t});\n\t\tthis.#layout.manuallyDistribution = manuallyDistribution;\n\t\tthis.#layout.manuallyRadio = manuallyRadio;\n\n\t\tconst { root: himselfDistribution, radio: himselfRadio } = this.#renderDistributionType({\n\t\t\ttype: 'himself',\n\t\t\tselector: this.#layout.responsiblesHimselfSelector,\n\t\t});\n\t\tthis.#layout.himselfDistribution = himselfDistribution;\n\t\tthis.#layout.himselfRadio = himselfRadio;\n\n\t\tconst { root: immutableDistribution, radio: immutableRadio } = this.#renderDistributionType({\n\t\t\ttype: 'immutable',\n\t\t\tselector: this.#layout.responsiblesImmutableSelector,\n\t\t});\n\t\tthis.#layout.immutableDistribution = immutableDistribution;\n\t\tthis.#layout.immutableRadio = immutableRadio;\n\n\t\tthis.#layout.queueRadio.checked = this.#flow.distributionType === 'queue';\n\t\tthis.#layout.manuallyRadio.checked = this.#flow.distributionType === 'manually';\n\t\tthis.#layout.himselfRadio.checked = this.#flow.distributionType === 'himself';\n\t\tthis.#layout.immutableRadio.checked = this.#flow.distributionType === 'immutable';\n\t\tthis.update();\n\n\t\tEvent.bind(this.#layout.queueRadio, 'change', this.#onDistributionChange.bind(this));\n\t\tEvent.bind(this.#layout.manuallyRadio, 'change', this.#onDistributionChange.bind(this));\n\t\tEvent.bind(this.#layout.himselfRadio, 'change', this.#onDistributionChange.bind(this));\n\t\tEvent.bind(this.#layout.immutableRadio, 'change', this.#onDistributionChange.bind(this));\n\n\t\tconst selector = this.#layout.responsiblesHimselfSelector.getSelector();\n\t\tselector.getDialog().subscribe('onHide', this.checkDepartmentUsersCount.bind(this, selector));\n\n\t\tthis.#addFlowTeamTooltip();\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"ui-section__field-container\">\n\t\t\t\t<div class=\"ui-section__field-label_box\">\n\t\t\t\t\t<label class=\"ui-section__field-label\">\n\t\t\t\t\t\t${Loc.getMessage('TASKS_FLOW_EDIT_FORM_DISTRIBUTION_TYPE')}\n\t\t\t\t\t</label>\n\t\t\t\t</div>\n\t\t\t\t${this.#layout.queueDistribution}\n\t\t\t\t${this.#layout.manuallyDistribution}\n\t\t\t\t${this.#layout.himselfDistribution}\n\t\t\t\t${this.#layout.immutableDistribution}\n\t\t\t</div>\n\t\t`;\n\t}\n\n\t#onDistributionChange(): void\n\t{\n\t\tif (this.#layout.immutableRadio.checked)\n\t\t{\n\t\t\tthis.#layout.taskTemplate?.disable(true);\n\t\t\tthis.#layout.taskTemplate?.setValue(false);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.#layout.taskTemplate?.disable(false);\n\t\t}\n\n\t\tthis.#layout.taskTemplate?.update();\n\t}\n\n\t#getResponsiblesSelector(\n\t\tresponsibleValues: string[],\n\t\tenableDepartments: boolean = true,\n\t\tmultiple: boolean = true,\n\t): UserSelector\n\t{\n\t\treturn new UserSelector({\n\t\t\tenableAll: false,\n\t\t\tmultiple,\n\t\t\tenableDepartments,\n\t\t\tvalues: responsibleValues,\n\t\t\tlabel: Loc.getMessage('TASKS_FLOW_EDIT_FORM_DISTRIBUTION_QUEUE_SELECTOR_LABEL'),\n\t\t\tclassName: 'tasks-flow__responsible-selector',\n\t\t\tdialogEvents: {\n\t\t\t\tonLoad: this.onDialogLoad,\n\t\t\t},\n\t\t});\n\t}\n\n\t#renderDistributionType({ type, selector }): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-flow__create-distribution-type --${type}\" data-id=\"tasks-flow-distribution-${type}\">\n\t\t\t\t<label class=\"ui-ctl ui-ctl-radio ui-ctl-wa\">\n\t\t\t\t\t<input type=\"radio\" name=\"distribution\" value=\"${type}\" class=\"ui-ctl-element\" ref=\"radio\">\n\t\t\t\t\t<div class=\"tasks-flow__create-distribution-type_title-container\">\n\t\t\t\t\t\t<div class=\"tasks-flow__create-distribution-type_content\">\n\t\t\t\t\t\t<div class=\"tasks-flow__create-distribution-type_title\">\n\t\t\t\t\t\t\t\t<div class=\"tasks-flow__create-distribution-type_title-text\">\n\t\t\t\t\t\t\t\t\t${Loc.getMessage(`TASKS_FLOW_EDIT_FORM_DISTRIBUTION_${type.toUpperCase()}`)}\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<span class=\"tasks-flow__create-distribution-type_label ui-label ui-label-primary ui-label-fill\">\n\t\t\t\t\t\t\t\t\t<span class=\"ui-label-inner\">\n\t\t\t\t\t\t\t\t\t\t${Loc.getMessage('TASKS_FLOW_EDIT_FORM_ANALYTICS_STUB_BUTTON')}\n\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class=\"tasks-flow__create-distribution-type_hint\">\n\t\t\t\t\t\t\t\t${Loc.getMessage(`TASKS_FLOW_EDIT_FORM_DISTRIBUTION_${type.toUpperCase()}_HINT`)}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"tasks-flow__create-distribution-type_icon --${type}\"></div>\n\t\t\t\t\t</div>\n\t\t\t\t</label>\n\t\t\t\t<div class=\"tasks-flow__create-distribution-type_selector\">\n\t\t\t\t\t${selector?.render()}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\t#renderImmutableFlowTeamTooltip(): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<span\n\t\t\t\tdata-id=\"immutableDistributionTooltip\"\n\t\t\t\tclass=\"ui-hint ui-hint-flow-value-checker\"\n\t\t\t\tdata-hint=\"${Loc.getMessage('TASKS_FLOW_EDIT_FORM_DISTRIBUTION_IMMUTABLE_TOOLTIP')}\" \n\t\t\t\tdata-hint-no-icon\n\t\t\t>\n\t\t\t\t<span class=\"ui-hint-icon ui-hint-icon-flow-value-checker\"></span>\n\t\t\t</span>\n\t\t`;\n\t}\n\n\t#getTaskTemplateDialog(): Dialog\n\t{\n\t\tthis.#layout.taskTemplateDialog = new Dialog({\n\t\t\twidth: 500,\n\t\t\tcontext: 'flow',\n\t\t\tpreselectedItems: this.#flow.templateId ? [['task-template', this.#flow.templateId]] : '',\n\t\t\tenableSearch: true,\n\t\t\tmultiple: false,\n\t\t\tentities: [\n\t\t\t\t{\n\t\t\t\t\tid: 'task-template',\n\t\t\t\t},\n\t\t\t],\n\t\t});\n\n\t\treturn this.#layout.taskTemplateDialog;\n\t}\n\n\t#getProjectLabel(): string\n\t{\n\t\tconst notifyEmptyProject = `\n\t\t\t<span\n\t\t\t\tdata-id=\"notifyEmptyProjectHint\"\n\t\t\t\tclass=\"ui-hint ui-hint-flow-value-checker\"\n\t\t\t\tdata-hint=\"${Loc.getMessage('TASKS_FLOW_EDIT_FORM_NOTIFY_EMPTY_PROJECT_HINT')}\" \n\t\t\t\tdata-hint-no-icon\n\t\t\t>\n\t\t\t\t<span class=\"ui-hint-icon ui-hint-icon-flow-value-checker\"></span>\n\t\t\t</span>\n\t\t`;\n\n\t\treturn `\n\t\t\t<div class=\"tasks-flow-field-label-container\">\n\t\t\t\t<span>${Loc.getMessage('TASKS_FLOW_EDIT_FORM_PROJECT_FOR_TASKS')}</span>\n\t\t\t\t${this.#flow.id ? '' : notifyEmptyProject}\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tcheckDepartmentUsersCount(selector: TagSelector): void\n\t{\n\t\tconst selectedTags = selector.getTags();\n\n\t\tconst selectedDepartments = selectedTags.filter(\n\t\t\t(tag) => tag.getEntityId() === 'department',\n\t\t);\n\n\t\tlet addedDepartments = [];\n\t\tif (Type.isUndefined(this.selectedDepartments) || this.selectedDepartments.length === 0)\n\t\t{\n\t\t\taddedDepartments = selectedDepartments;\n\t\t}\n\t\telse\n\t\t{\n\t\t\taddedDepartments = selectedDepartments.filter(\n\t\t\t\t(departmentTag) => !this.selectedDepartments.includes(departmentTag),\n\t\t\t);\n\t\t}\n\n\t\tthis.selectedDepartments = selectedDepartments;\n\n\t\tif (addedDepartments.length === 0)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.#getDepartmentsUsersCount(addedDepartments).then((countArray) => {\n\t\t\tconst departmentForHint = countArray.find(\n\t\t\t\t(departmentData) => departmentData.count > BIG_DEPARTMENT_USER_COUNT\n\t\t\t\t|| departmentData.count === 0,\n\t\t\t);\n\n\t\t\tif (departmentForHint)\n\t\t\t{\n\t\t\t\tconst tag = addedDepartments.find(\n\t\t\t\t\t(item) => item.getId().toString() === departmentForHint.departmentId,\n\t\t\t\t);\n\n\t\t\t\tif (tag)\n\t\t\t\t{\n\t\t\t\t\tthis.#showDepartmentHint(tag, this.#getHintMessageCodeByCount(departmentForHint.count));\n\t\t\t\t}\n\t\t\t}\n\t\t}).catch((error) => {\n\t\t\tconsole.error(error);\n\t\t});\n\t}\n\n\t#getHintMessageCodeByCount(count: number): string\n\t{\n\t\tconst hintMessage = HINT_MESSAGES_BY_COUNT.find(\n\t\t\t(hint) => hint.condition(count),\n\t\t);\n\n\t\treturn hintMessage ? hintMessage.message : '';\n\t}\n\n\t#showDepartmentHint(tag: TagItem, code: string): void\n\t{\n\t\tconst popup = new BX.PopupWindow({\n\t\t\tcontent: BX.Loc.getMessage(code),\n\t\t\tdarkMode: true,\n\t\t\tbindElement: tag.getContainer(),\n\t\t\tangle: true,\n\t\t\tcontentPadding: 5,\n\t\t\tmaxWidth: 400,\n\t\t\toffsetLeft: (tag.getContainer().offsetWidth / 2),\n\t\t\tautoHide: true,\n\t\t\tcloseByEsc: true,\n\t\t});\n\n\t\tpopup.show();\n\t}\n\n\t#getDepartmentsUsersCount(departments): ?Array\n\t{\n\t\tconst departmentsToBackend = departments.map(\n\t\t\t(department) => [department.getEntityId(), department.getId()],\n\t\t);\n\n\t\treturn ajax.runAction('tasks.flow.Flow.getDepartmentsMemberCount', {\n\t\t\tdata: { departments: departmentsToBackend },\n\t\t}).then((result) => {\n\t\t\treturn Type.isArrayFilled(result.errors) ? null : result.data;\n\t\t}).catch((errors) => {\n\t\t\tconsole.error(errors);\n\t\t});\n\t}\n}\n","import { Event, Extension, Loc, Tag } from 'main.core';\nimport { UserSelector } from 'ui.form-elements.view';\nimport { FormPage } from './form-page';\nimport { ValueChecker } from '../value-checker';\nimport { bindFilterNumberInput } from '../bind-filter-number-input';\n\nimport type { Flow } from '../edit-form';\n\ntype Params = {\n\tonChangeHandler: Function,\n};\n\nexport class ControlPage extends FormPage\n{\n\t#params: Params;\n\n\t#layout: {\n\t\tcontrolPageForm: HTMLFormElement,\n\n\t\tflowOwnerSelector: UserSelector,\n\t\tnotifyOnQueueOverflow: ValueChecker,\n\t\tnotifyOnTasksInProgressOverflow: ValueChecker,\n\t\tnotifyWhenEfficiencyDecreases: ValueChecker,\n\t\tanalyticsPermissionsSelector: UserSelector,\n\t};\n\n\t#flow: Flow;\n\n\tconstructor(params: Params)\n\t{\n\t\tsuper();\n\t\tthis.#params = params;\n\t\tthis.#layout = {};\n\t\tthis.#flow = {};\n\t}\n\n\tget #currentUser(): number\n\t{\n\t\tconst settings = Extension.getSettings('tasks.flow.edit-form');\n\n\t\treturn settings.currentUser;\n\t}\n\n\tsetFlow(flow: Flow): void\n\t{\n\t\tthis.#flow = flow;\n\t}\n\n\tgetFlowId(): ?number\n\t{\n\t\treturn this.#flow.id ?? null;\n\t}\n\n\tgetId(): string\n\t{\n\t\treturn 'control';\n\t}\n\n\tgetTitle(): string\n\t{\n\t\treturn Loc.getMessage('TASKS_FLOW_EDIT_FORM_CONTROL');\n\t}\n\n\tgetRequiredData(): string[]\n\t{\n\t\treturn this.#getCheckerValues().filter((checker) => this.#layout[checker].isChecked());\n\t}\n\n\tshowErrors(incorrectData: string[]): void\n\t{\n\t\tif (incorrectData.includes('ownerId'))\n\t\t{\n\t\t\tthis.#layout.flowOwnerSelector.setErrors([Loc.getMessage('TASKS_FLOW_EDIT_FORM_FLOW_OWNER_ERROR')]);\n\t\t}\n\n\t\tthis.#getCheckerValues().forEach((checker) => {\n\t\t\tif (incorrectData.includes(checker))\n\t\t\t{\n\t\t\t\tthis.#layout[checker].setErrors([Loc.getMessage('TASKS_FLOW_EDIT_FORM_VALUE_ERROR')]);\n\t\t\t}\n\t\t});\n\t}\n\n\tcleanErrors(): void\n\t{\n\t\tthis.#layout.flowOwnerSelector.cleanError();\n\t\tthis.#getCheckerValues().forEach((checker) => this.#layout[checker].cleanError());\n\t}\n\n\t#getCheckerValues(): string[]\n\t{\n\t\treturn ['notifyOnQueueOverflow', 'notifyOnTasksInProgressOverflow', 'notifyWhenEfficiencyDecreases'];\n\t}\n\n\tgetFields(flowData: Flow = {}): Flow\n\t{\n\t\tlet ownerId = this.#currentUser;\n\t\tif (this.#layout.flowOwnerSelector?.getSelector().getDialog().isLoaded())\n\t\t{\n\t\t\townerId = this.#layout.flowOwnerSelector.getSelector().getTags()[0]?.id;\n\t\t}\n\n\t\treturn {\n\t\t\townerId: flowData.ownerId || (ownerId || 0),\n\n\t\t\tnotifyOnQueueOverflow: flowData.notifyOnQueueOverflow ?? this.#getCheckerNumericValue(this.#layout.notifyOnQueueOverflow),\n\t\t\tnotifyOnTasksInProgressOverflow: flowData.notifyOnTasksInProgressOverflow ?? this.#getCheckerNumericValue(this.#layout.notifyOnTasksInProgressOverflow),\n\t\t\tnotifyWhenEfficiencyDecreases: flowData.notifyWhenEfficiencyDecreases ?? this.#getCheckerNumericValue(this.#layout.notifyWhenEfficiencyDecreases),\n\t\t}\n\t}\n\n\t#getCheckerNumericValue(checker: ?ValueChecker)\n\t{\n\t\treturn checker?.isChecked() ? this.#getInteger(checker.getValue()) : null;\n\t}\n\n\t#getInteger(value: string): boolean\n\t{\n\t\treturn /^\\d+$/.test(value) ? parseInt(value, 10) : 0;\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\tconst flowOwnerLabel = `\n\t\t\t<div class=\"tasks-flow__create-title-with-hint\">\n\t\t\t\t${Loc.getMessage('TASKS_FLOW_EDIT_FORM_FLOW_OWNER')}\n\t\t\t\t<span\n\t\t\t\t\tdata-id=\"flowOwnerHint\"\n\t\t\t\t\tclass=\"ui-hint\"\n\t\t\t\t\tdata-hint=\"${Loc.getMessage('TASKS_FLOW_EDIT_FORM_FLOW_OWNER_HINT')}\" \n\t\t\t\t\tdata-hint-no-icon\n\t\t\t\t><span class=\"ui-hint-icon\"></span></span>\n\t\t\t</div>\n\t\t`;\n\n\t\tthis.#layout.flowOwnerSelector = new UserSelector({\n\t\t\tid: 'tasks-flow-edit-form-field-owner',\n\t\t\tlabel: flowOwnerLabel,\n\t\t\tenableAll: false,\n\t\t\tenableDepartments: false,\n\t\t\tmultiple: false,\n\t\t\tvalues: [['user', this.#flow.ownerId]],\n\t\t\tdialogEvents: {\n\t\t\t\tonLoad: this.onDialogLoad,\n\t\t\t},\n\t\t});\n\n\t\tthis.#layout.notifyOnQueueOverflow = new ValueChecker({\n\t\t\tid: 'notify-on-queue-overflow',\n\t\t\ttitle: Loc.getMessage('TASKS_FLOW_EDIT_FORM_NOTIFY_ON_QUEUE_OVERFLOW'),\n\t\t\tplaceholder: 50,\n\t\t\tvalue: this.#flow.notifyOnQueueOverflow,\n\t\t\tsize: 'extra-small',\n\t\t});\n\n\t\tbindFilterNumberInput({\n\t\t\tinput: this.#layout.notifyOnQueueOverflow.getInputNode(),\n\t\t\tmax: 99999,\n\t\t});\n\n\t\tthis.#layout.notifyOnTasksInProgressOverflow = new ValueChecker({\n\t\t\tid: 'notify-on-tasks-in-progress-overflow',\n\t\t\ttitle: Loc.getMessage('TASKS_FLOW_EDIT_FORM_NOTIFY_ON_TASKS_IN_PROGRESS_OVERFLOW'),\n\t\t\tplaceholder: 50,\n\t\t\tvalue: this.#flow.notifyOnTasksInProgressOverflow,\n\t\t\tsize: 'extra-small',\n\t\t});\n\n\t\tbindFilterNumberInput({\n\t\t\tinput: this.#layout.notifyOnTasksInProgressOverflow.getInputNode(),\n\t\t\tmax: 99999,\n\t\t});\n\n\t\tthis.#layout.notifyWhenEfficiencyDecreases = new ValueChecker({\n\t\t\tid: 'notify-when-efficiency-decreases',\n\t\t\ttitle: Loc.getMessage('TASKS_FLOW_EDIT_FORM_NOTIFY_WHEN_EFFICIENCY_DECREASES'),\n\t\t\tplaceholder: 70,\n\t\t\tunit: '%',\n\t\t\tvalue: this.#flow.notifyWhenEfficiencyDecreases,\n\t\t\tsize: 'extra-small',\n\t\t});\n\n\t\tbindFilterNumberInput({\n\t\t\tinput: this.#layout.notifyWhenEfficiencyDecreases.getInputNode(),\n\t\t\tmax: 100,\n\t\t});\n\n\t\tthis.#layout.analyticsPermissionsSelector = new UserSelector({\n\t\t\tid: 'tasks-flow-edit-form-field-analytics',\n\t\t\tlabel: Loc.getMessage('TASKS_FLOW_EDIT_FORM_ANALYTICS_PERMISSIONS'),\n\t\t\tenableAll: true,\n\t\t\tenableDepartments: true,\n\t\t\tclassName: '',\n\t\t\tdialogEvents: {\n\t\t\t\tonLoad: this.onDialogLoad,\n\t\t\t},\n\t\t});\n\n\t\tthis.#layout.controlPageForm = Tag.render`\n\t\t\t<form class=\"tasks-flow__create-control\">\n\t\t\t\t${this.#layout.flowOwnerSelector.render()}\n\t\t\t\t${this.#layout.notifyOnQueueOverflow.render()}\n\t\t\t\t${this.#layout.notifyOnTasksInProgressOverflow.render()}\n\t\t\t\t${this.#layout.notifyWhenEfficiencyDecreases.render()}\n\t\t\t\t<div class=\"tasks-flow__create-separator\"></div>\n\t\t\t\t${this.#renderAnalyticsStub()}\n\t\t\t</form>\n\t\t`;\n\n\t\tEvent.bind(this.#layout.controlPageForm, 'change', this.#params.onChangeHandler);\n\n\t\treturn this.#layout.controlPageForm;\n\t}\n\n\t#renderAnalyticsStub(): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-flow__create_analytics-stub\">\n\t\t\t\t<span>${Loc.getMessage('TASKS_FLOW_EDIT_FORM_ANALYTICS_STUB_LABEL')}</span>\n\t\t\t\t<span class=\"tasks-flow__create_analytics-stub-label ui-label ui-label-primary ui-label-fill\">\n\t\t\t\t\t<span class=\"ui-label-inner\">\n\t\t\t\t\t\t${Loc.getMessage('TASKS_FLOW_EDIT_FORM_ANALYTICS_STUB_BUTTON')}\n\t\t\t\t\t</span>\n\t\t\t\t</span>\n\t\t\t</div>\n\t\t`;\n\t}\n}\n","import { ajax, Event, Loc, Tag, Text, Type, Runtime } from 'main.core';\nimport { BaseEvent, EventEmitter } from 'main.core.events';\nimport { Popup } from 'main.popup';\nimport { Button, ButtonState } from 'ui.buttons';\nimport { Wizard } from 'tasks.wizard';\nimport { FormPage } from './pages/form-page';\nimport { AboutPage } from './pages/about-page';\nimport { SettingsPage } from './pages/settings-page';\nimport { ControlPage } from './pages/control-page';\nimport { Lottie } from 'ui.lottie';\nimport flowfLottieIconInfo from '../lottie/tasks-flow-info-icon.json';\nimport 'ui.sidepanel-content';\nimport 'ui.forms';\nimport 'ui.hint';\nimport './style.css';\n\ntype Context = 'flows_grid' | 'copilot_advice' | 'flow_guide';\n\ntype FeatureParams = {\n\tisFeatureTrialable: boolean,\n}\n\ntype Params = {\n\tflowId?: number,\n\tflowName?: string,\n\tdemoFlow?: 'Y' | 'N',\n\tguideFlow?: 'Y' | 'N',\n\n\tcontext?: Context,\n\tisFeatureTrialable?: boolean,\n};\n\nexport type DistributionType = 'manually' | 'queue' | 'himself' | 'immutable';\n\nexport type Flow = {\n\tid: ?number,\n\tname: string,\n\tdescription: string,\n\ttaskCreators: string[],\n\tplannedCompletionTime: number,\n\tmatchSchedule: boolean,\n\tmatchWorkTime: boolean,\n\ttemplateId: number,\n\tresponsibleList: string[],\n\tresponsibleCanChangeDeadline: boolean,\n\tdistributionType: DistributionType,\n\tgroupId: number,\n\townerId: number,\n\tdemo: boolean,\n\tnotifyOnQueueOverflow: ?number,\n\tnotifyOnTasksInProgressOverflow: ?number,\n\tnotifyWhenEfficiencyDecreases: ?number,\n\tnotifyAtHalfTime: boolean,\n\ttaskControl: boolean,\n\ttrialFeatureEnabled: boolean;\n};\n\nconst SLIDER_WIDTH = 692;\nconst HELPDESK_ARTICLE = 21272066;\n\nexport class EditForm extends EventEmitter\n{\n\t#params: Params;\n\n\t#layout: {};\n\n\t#wizard: Wizard;\n\t#pages: FormPage[];\n\t#finishButton: Button;\n\t#saveChangesButton: Button;\n\n\t#flow: Flow;\n\n\t#flowLottieAnimation: any = null;\n\t#lottieIconContainer: HTMLElement;\n\n\t#pageChanging: boolean = false;\n\n\tconstructor(params: Params = {})\n\t{\n\t\tsuper(params);\n\n\t\tthis.setEventNamespace('BX.Tasks.Flow.EditForm');\n\n\t\tthis.#params = params;\n\t\tthis.#layout = {};\n\t\tthis.#flowLottieAnimation = null;\n\t\tthis.#lottieIconContainer = null;\n\n\t\tconst onChangeHandler = this.#onChangeHandler.bind(this);\n\t\tthis.#pages = [\n\t\t\tnew AboutPage({ onChangeHandler }),\n\t\t\tnew SettingsPage({ onChangeHandler }),\n\t\t\tnew ControlPage({ onChangeHandler }),\n\t\t];\n\n\t\tconst initFlowData = {\n\t\t\tnotifyAtHalfTime: true,\n\t\t\tresponsibleCanChangeDeadline: false,\n\t\t\ttaskControl: true,\n\t\t\tnotifyOnQueueOverflow: 50,\n\t\t\tnotifyOnTasksInProgressOverflow: 50,\n\t\t\tnotifyWhenEfficiencyDecreases: 70,\n\t\t\ttaskCreators: [\n\t\t\t\t['meta-user', 'all-users'],\n\t\t\t],\n\t\t};\n\t\tif (this.#params.flowName)\n\t\t{\n\t\t\tinitFlowData.name = this.#params.flowName;\n\t\t}\n\n\t\tthis.#flow = this.#getFlow(initFlowData);\n\t}\n\n\tstatic async createInstance(params: Params = {}): EditForm\n\t{\n\t\tconst { EditForm } = await top.BX.Runtime.loadExtension('tasks.flow.edit-form');\n\n\t\tconst instance = new EditForm(params);\n\t\tinstance.openInSlider();\n\n\t\treturn instance;\n\t}\n\n\topenInSlider()\n\t{\n\t\tconst sidePanelId = `tasks-flow-create-slider-${Text.getRandom()}`;\n\n\t\tBX.SidePanel.Instance.open(sidePanelId, {\n\t\t\tcacheable: true,\n\t\t\tcontentCallback: async (slider) => {\n\t\t\t\tthis.slider = slider;\n\n\t\t\t\tconst { data: noAccess } = await ajax.runAction('tasks.flow.View.Access.check', {\n\t\t\t\t\tdata: {\n\t\t\t\t\t\tflowId: this.#flow.id > 0 ? this.#flow.id : 0,\n\t\t\t\t\t\tcontext: this.#params.context ?? 'flows_grid',\n\t\t\t\t\t\tdemoFlow: this.#params.demoFlow,\n\t\t\t\t\t\tguideFlow: this.#params.guideFlow,\n\t\t\t\t\t},\n\t\t\t\t});\n\n\t\t\t\tif (noAccess !== null)\n\t\t\t\t{\n\t\t\t\t\treturn Tag.render`${noAccess.html}`;\n\t\t\t\t}\n\n\t\t\t\tif (this.#flow.id > 0)\n\t\t\t\t{\n\t\t\t\t\tconst { data: flowData } = await ajax.runAction('tasks.flow.Flow.get', {\n\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\tflowId: this.#flow.id,\n\t\t\t\t\t\t},\n\t\t\t\t\t});\n\n\t\t\t\t\tthis.#flow = this.#getFlow(flowData);\n\t\t\t\t}\n\n\t\t\t\tthis.#pages.forEach((page) => page.setFlow(this.#flow));\n\n\t\t\t\treturn this.#render();\n\t\t\t},\n\t\t\twidth: SLIDER_WIDTH,\n\t\t\tevents: {\n\t\t\t\tonLoad: (event) => {\n\t\t\t\t\tconst aboutPage = this.#pages\n\t\t\t\t\t\t.find((page) => page.getId() === 'about-flow')\n\t\t\t\t\t;\n\t\t\t\t\taboutPage.focusToEmptyName();\n\t\t\t\t\trequestAnimationFrame(() => {\n\t\t\t\t\t\tthis.#wizard.initHints();\n\t\t\t\t\t});\n\t\t\t\t},\n\t\t\t\tonClose: () => {\n\t\t\t\t\tthis.#wizard.hideHints();\n\t\t\t\t\tthis.emit('afterClose');\n\t\t\t\t},\n\t\t\t},\n\t\t});\n\t}\n\n\t#render(): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-flow__create\">\n\t\t\t\t${this.#renderHeader()}\n\t\t\t\t${this.#renderWizard()}\n\t\t\t</div>\n\t\t`;\n\t}\n\n\t#renderHeader(): HTMLElement\n\t{\n\t\tconst title = (\n\t\t\tLoc.getMessage(this.#flow.id\n\t\t\t\t? 'TASKS_FLOW_EDIT_FORM_HEADER_TITLE_EDIT'\n\t\t\t\t: 'TASKS_FLOW_EDIT_FORM_HEADER_TITLE')\n\t\t);\n\n\t\tconst subTitle = (\n\t\t\tLoc.getMessage(this.#flow.id\n\t\t\t\t? 'TASKS_FLOW_EDIT_FORM_HEADER_SUBTITLE'\n\t\t\t\t: 'TASKS_FLOW_EDIT_FORM_HEADER_SUBTITLE_CREATE')\n\t\t);\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"ui-slider-section ui-slider-section-icon-center --rounding --icon-sm\">\n\t\t\t\t<span class=\"tasks-flow__create-header_icon ui-icon ui-slider-icon\"></span>\n\t\t\t\t<div class=\"ui-slider-content-box\">\n\t\t\t\t\t<div class=\"ui-slider-heading-2\">${title}</div>\n\t\t\t\t\t<div class=\"ui-slider-inner-box\">\n\t\t\t\t\t\t<p class=\"ui-slider-paragraph-2\">\n\t\t\t\t\t\t\t${subTitle}\n\t\t\t\t\t\t</p>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\t#renderWizard(): HTMLElement\n\t{\n\t\tthis.#wizard = new Wizard({\n\t\t\tsteps: this.#pages.map((page) => ({\n\t\t\t\tid: page.getId(),\n\t\t\t\ttitle: page.getTitle(),\n\t\t\t\tcontent: page.render(),\n\t\t\t\tisFilled: () => !this.#hasIncorrectData(page.getRequiredData()),\n\t\t\t})),\n\t\t\tonCancel: () => this.slider.close(false, () => this.slider.destroy()),\n\t\t\tonDisabledContinueButtonClick: this.#showErrors.bind(this),\n\t\t\tonContinueHandler: this.#onContinueHandler.bind(this),\n\t\t\tfinishButton: this.#getFinishButton(),\n\t\t\tsaveChangesButton: this.#getSaveChangesButton(),\n\t\t\tarticle: HELPDESK_ARTICLE,\n\t\t});\n\n\t\treturn this.#wizard.render();\n\t}\n\n\t#saveChangesAction(): ?Function\n\t{\n\t\tconst isEdit = this.#flow.id > 0;\n\n\t\tif (!isEdit || this.#flow.demo)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\treturn this.#saveFlowAction();\n\t}\n\n\t#getFinishButton(): Button\n\t{\n\t\tthis.#finishButton ??= new Button({\n\t\t\ttext: Loc.getMessage(this.#flow.id ? 'TASKS_FLOW_EDIT_FORM_SAVE_FLOW' : 'TASKS_FLOW_EDIT_FORM_CREATE_FLOW'),\n\t\t\tcolor: Button.Color.PRIMARY,\n\t\t\tround: true,\n\t\t\tsize: Button.Size.LARGE,\n\t\t\tonclick: () => this.#saveFlowAction(),\n\t\t});\n\n\t\treturn this.#finishButton;\n\t}\n\n\t#getSaveChangesButton(): ?Button\n\t{\n\t\tif (!this.#flow.id || this.#flow.demo)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tthis.#saveChangesButton ??= new Button({\n\t\t\ttext: Loc.getMessage('TASKS_FLOW_EDIT_FORM_SAVE_CHANGES'),\n\t\t\tcolor: Button.Color.SUCCESS,\n\t\t\tround: true,\n\t\t\tsize: BX.UI.Button.Size.LARGE,\n\t\t\tonclick: () => this.#saveChangesAction(),\n\t\t});\n\n\t\treturn this.#saveChangesButton;\n\t}\n\n\t#onChangeHandler(): void\n\t{\n\t\tthis.#flow = this.#getFlow();\n\t\tthis.#pages.forEach((page) => page.update());\n\t\tthis.#wizard.update();\n\t}\n\n\t#saveFlowAction(): void\n\t{\n\t\tif (this.#hasIncorrectData())\n\t\t{\n\t\t\tthis.#showErrors();\n\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.#saveChangesButton?.isDisabled() || this.#finishButton?.isDisabled())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.#saveChangesButton?.setState(ButtonState.DISABLED);\n\t\tthis.#finishButton?.setState(ButtonState.DISABLED);\n\n\t\tconst flowData = Object.fromEntries(Object.entries(this.#getFlow()).map(([key, value]) => [\n\t\t\tkey,\n\t\t\tType.isBoolean(value) ? (value ? 1 : 0) : value,\n\t\t]));\n\n\t\tconst action = flowData.id ? 'update' : 'create';\n\t\tconst textNotification = flowData.id ? 'TASKS_FLOW_EDIT_FORM_FLOW_UPDATE' : 'TASKS_FLOW_EDIT_FORM_FLOW_CREATE';\n\n\t\tajax.runAction(\n\t\t\t`tasks.flow.Flow.${flowData.demo ? 'activateDemo' : action}`,\n\t\t\t{\n\t\t\t\tdata: {\n\t\t\t\t\tflowData,\n\t\t\t\t\tanalyticsParams: {\n\t\t\t\t\t\tguideFlow: this.#params.guideFlow ?? 'N',\n\t\t\t\t\t\tcontext: this.#params.context ?? 'flows_grid',\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t},\n\t\t).then((response) => {\n\t\t\tif (response.status === 'success')\n\t\t\t{\n\t\t\t\tconst flowData: Flow = response.data;\n\n\t\t\t\tthis.emit('afterSave', flowData);\n\n\t\t\t\tthis.slider.close(false, () => {\n\t\t\t\t\tif (flowData.trialFeatureEnabled)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.#showDemoInfo();\n\t\t\t\t\t}\n\t\t\t\t\tthis.slider.destroy();\n\t\t\t\t});\n\n\t\t\t\tBX.UI.Notification.Center.notify({\n\t\t\t\t\tcontent: Loc.getMessage(textNotification),\n\t\t\t\t\twidth: 'auto',\n\t\t\t\t});\n\t\t\t}\n\t\t}, (error) => {\n\t\t\tthis.#saveChangesButton?.setState(null);\n\t\t\tthis.#finishButton?.setState(null);\n\t\t\talert(error.errors.map((e) => e.message).join('\\n'));\n\t\t});\n\t}\n\n\t#showErrors(): void\n\t{\n\t\tconst incorrectData = this.#getIncorrectData();\n\t\tthis.#pages.forEach((page) => page.showErrors(incorrectData));\n\t}\n\n\t#showDemoInfo(): void\n\t{\n\t\tconst popup: Popup = new Popup({\n\t\t\tid: 'tasks-flow-task-demo-info',\n\t\t\tclassName: 'tasks-flow__task-demo-info',\n\t\t\twidth: 620,\n\t\t\toverlay: true,\n\t\t\tpadding: 48,\n\t\t\tcloseIcon: true,\n\t\t\tcontent: this.#renderDemoInfoContent(),\n\t\t\tevents: {\n\t\t\t\tonFirstShow: (baseEvent: BaseEvent) => {\n\t\t\t\t\tthis.#bindStartWorkBtn(baseEvent.getTarget());\n\t\t\t\t},\n\t\t\t},\n\t\t});\n\n\t\tpopup.show();\n\t}\n\n\t#renderDemoInfoContent(): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"tasks-flow__task-demo-info_wrapper\">\n\t\t\t\t<div class=\"tasks-flow__task-demo-info_content\">\n\t\t\t\t\t<div class=\"tasks-flow__task-demo-info_title\">\n\t\t\t\t\t\t${Loc.getMessage('TASKS_FLOW_EDIT_FORM_DEMO_INFO_TITLE_1')}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"tasks-flow__task-demo-info_text\">\n\t\t\t\t\t\t${Loc.getMessage('TASKS_FLOW_EDIT_FORM_DEMO_INFO_TEXT_1')}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"tasks-flow__task-demo-info_text-trial\">\n\t\t\t\t\t\t${Loc.getMessage('TASKS_FLOW_EDIT_FORM_DEMO_INFO_TEXT_TRIAL_1')}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"ui-btn ui-btn-sm ui-btn-primary ui-btn-round ui-btn-no-caps\">\n\t\t\t\t\t\t${Loc.getMessage('TASKS_FLOW_EDIT_FORM_DEMO_INFO_BTN_1')}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t${this.#getLottieIconContainer()}\n\t\t\t</div>\n\t\t`;\n\t}\n\n\t#getLottieIconContainer(): HTMLElement\n\t{\n\t\tif (!this.#lottieIconContainer)\n\t\t{\n\t\t\tthis.#lottieIconContainer = Tag.render`\n\t\t\t\t<div class=\"tasks-flow__task-demo-info_image\"></div>\n\t\t\t`;\n\n\t\t\tthis.#flowLottieAnimation = Lottie.loadAnimation({\n\t\t\t\tcontainer: this.#lottieIconContainer,\n\t\t\t\trenderer: 'svg',\n\t\t\t\tloop: false,\n\t\t\t\tanimationData: flowfLottieIconInfo,\n\t\t\t});\n\t\t}\n\n\t\treturn this.#lottieIconContainer;\n\t}\n\n\t#bindStartWorkBtn(popup: Popup)\n\t{\n\t\tconst popupContainer = popup.getContentContainer();\n\t\tif (Type.isDomNode(popupContainer))\n\t\t{\n\t\t\tconst btnNode = popup.getContentContainer().querySelector('.ui-btn');\n\t\t\tif (Type.isDomNode(popupContainer))\n\t\t\t{\n\t\t\t\tEvent.bind(btnNode, 'click', () => popup.close());\n\t\t\t}\n\t\t}\n\t}\n\n\t#hasIncorrectData(fields: string[] = []): boolean\n\t{\n\t\tconst incorrectData = this.#getIncorrectData();\n\n\t\tfor (const field of fields)\n\t\t{\n\t\t\tif (incorrectData.includes(field))\n\t\t\t{\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\n\t\treturn !Type.isArrayFilled(fields) && Type.isArrayFilled(incorrectData);\n\t}\n\n\t#getIncorrectData(): string[]\n\t{\n\t\tconst flowData = this.#flow;\n\n\t\tconst incorrectData = [];\n\t\tif (!Type.isStringFilled(flowData.name))\n\t\t{\n\t\t\tincorrectData.push('name');\n\t\t}\n\n\t\tif (flowData.plannedCompletionTime <= 0)\n\t\t{\n\t\t\tincorrectData.push('plannedCompletionTime');\n\t\t}\n\n\t\tif (!Type.isArrayFilled(flowData.taskCreators))\n\t\t{\n\t\t\tincorrectData.push('taskCreators');\n\t\t}\n\n\t\tif (\n\t\t\t!Type.isArrayFilled(flowData.responsibleList)\n\t\t\t|| (flowData.distributionType === 'manually' && flowData.responsibleList[0] <= 0)\n\t\t)\n\t\t{\n\t\t\tincorrectData.push('responsibleList');\n\t\t}\n\n\t\tif (flowData.id > 0 && flowData.groupId <= 0 && flowData.demo === false)\n\t\t{\n\t\t\tincorrectData.push('groupId');\n\t\t}\n\n\t\tif (!Type.isNumber(flowData.templateId))\n\t\t{\n\t\t\tincorrectData.push('templateId');\n\t\t}\n\n\t\tif (flowData.id > 0 && flowData.ownerId <= 0 && flowData.demo === false)\n\t\t{\n\t\t\tincorrectData.push('ownerId');\n\t\t}\n\n\t\tif (Type.isNumber(flowData.notifyOnQueueOverflow) && flowData.notifyOnQueueOverflow <= 0)\n\t\t{\n\t\t\tincorrectData.push('notifyOnQueueOverflow');\n\t\t}\n\n\t\tif (Type.isNumber(flowData.notifyOnTasksInProgressOverflow) && flowData.notifyOnTasksInProgressOverflow <= 0)\n\t\t{\n\t\t\tincorrectData.push('notifyOnTasksInProgressOverflow');\n\t\t}\n\n\t\tif (\n\t\t\tType.isNumber(flowData.notifyWhenEfficiencyDecreases)\n\t\t\t&& (\n\t\t\t\tflowData.notifyWhenEfficiencyDecreases <= 0\n\t\t\t\t|| flowData.notifyWhenEfficiencyDecreases > 100\n\t\t\t)\n\t\t)\n\t\t{\n\t\t\tincorrectData.push('notifyWhenEfficiencyDecreases');\n\t\t}\n\n\t\treturn incorrectData;\n\t}\n\n\t#getFlow(flowData: Flow = {}): Flow\n\t{\n\t\treturn {\n\t\t\tid: this.#params.flowId,\n\t\t\tdemo: ('demo' in flowData) ? flowData.demo === true : this.#flow?.demo === true,\n\t\t\t...this.#pages.reduce((fields, page) => ({ ...fields, ...page.getFields(flowData) }), {}),\n\t\t};\n\t}\n\n\tasync #onContinueHandler(): Promise<boolean>\n\t{\n\t\tif (this.#pageChanging === true)\n\t\t{\n\t\t\treturn Promise.resolve(false);\n\t\t}\n\n\t\tthis.#pageChanging = true;\n\n\t\tconst stepId = this.#wizard.getCurrentStep().id;\n\t\tconst currentPage = this.#pages.find((page) => page.getId() === stepId);\n\n\t\tconst canContinue = await currentPage?.onContinueClick(this.#flow)\n\t\t\t.then((result: Boolean) => {\n\t\t\t\tthis.#pageChanging = false;\n\n\t\t\t\treturn result;\n\t\t\t})\n\t\t;\n\n\t\tconst isNewFlow = Type.isNil(currentPage.getFlowId());\n\t\tconst isNeedSendAnalytics = isNewFlow && canContinue;\n\n\t\tif (isNeedSendAnalytics)\n\t\t{\n\t\t\tawait this.#sendStepAnalytics();\n\t\t}\n\n\t\treturn canContinue;\n\t}\n\n\tasync #sendStepAnalytics(): Promise<void>\n\t{\n\t\tconst { sendData } = await Runtime.loadExtension('ui.analytics');\n\t\tconst stepNumber = this.#wizard.getCurrentStepIndex() + 1;\n\t\tconst demoSuffix = await this.#isFeatureTrialable() ? 'Y' : 'N';\n\n\t\tsendData({\n\t\t\ttool: 'tasks',\n\t\t\tcategory: 'flows',\n\t\t\tevent: `flow_create_step${stepNumber}`,\n\t\t\tc_section: 'tasks',\n\t\t\tc_sub_section: this.#params.context ?? 'flows_grid',\n\t\t\tc_element: 'continue_button',\n\t\t\tp1: `isDemo_${demoSuffix}`,\n\t\t});\n\t}\n\n\tasync #isFeatureTrialable(): Promise<Boolean>\n\t{\n\t\tif (Type.isNil(this.#params.isFeatureTrialable))\n\t\t{\n\t\t\tconst { data }: FeatureParams = await ajax.runAction('tasks.flow.Flow.getFeatureParams');\n\n\t\t\tthis.#params.isFeatureTrialable = data.isFeatureTrialable;\n\t\t}\n\n\t\treturn this.#params.isFeatureTrialable;\n\t}\n}\n"],"names":["FormPage","getId","getTitle","setFlow","flow","getFlowId","render","getFields","flowData","getRequiredData","update","cleanErrors","showErrors","incorrectData","onContinueClick","Promise","resolve","onDialogLoad","event","dialog","getTarget","tagSelector","getTagSelector","selectedItems","getTags","forEach","item","deselectable","setDeselectable","ValueChecker","EventEmitter","constructor","params","setEventNamespace","entitySelector","value","getPreselectedItems","isChecked","checker","getValue","entitySelectorValue","id","checkerValue","placeholder","setValue","switcher","check","setErrors","errors","cleanError","getInputNode","getChecker","disable","disabled","wrap","Tag","observer","IntersectionObserver","offsetWidth","disconnect","observe","closest","dispatchEvent","window","Event","Dom","addClass","removeClass","innerText","title","text","Loc","getMessage","disabledValue","style","width","checkerField","querySelector","height","offsetHeight","Checker","checked","Boolean","hideSeparator","size","isFieldDisabled","subscribe","baseEvent","getData","length","focus","setSelectionRange","emit","checkerContentField","isDisabled","hintText","hintOnDisabled","attr","unit","bind","setTargetNode","show","sendData","Runtime","loadExtension","tool","category","c_section","c_sub_section","c_element","hide","getSelectedItems","BindFilterNumberInput","input","dispatchedProgrammatically","addEventListener","textBeforeCursor","selectionStart","slice","normalizedValue","replace","parseInt","Math","max","min","firstPart","lastCharacter","matches","match","formattedPosition","indexOf","bindFilterNumberInput","AboutPage","includes","flowName","plannedCompletionTime","taskCreatorsSelector","plannedCompletionTimeValue","intervalDuration","plannedCompletionTimeIntervalSelector","getDuration","interval","getInterval","name","trim","description","flowDescription","taskCreators","matchSchedule","matchWorkTime","skipWeekends","TextInput","label","TextArea","resizeOnlyY","UserSelector","enableDepartments","values","dialogEvents","onLoad","aboutPageForm","onChangeHandler","focusToEmptyName","isEmpty","data","response","ajax","runAction","exists","getSelector","map","tag","entityId","Type","isUndefined","getDialog","shortIntervals","IntervalSelector","isSkipWeekendsDisabled","duration","plannedCompletionTimeLabel","inputDefaultWidth","String","maxInt","monthDuration","floor","requestAnimationFrame","hintManager","top","BX","UI","Hint","createInstance","Text","getRandom","className","popupParameters","targetContainer","initNode","root","PullRequests","userId","getModuleId","getMap","template_add","template_update","template","TEMPLATE_ID","TEMPLATE_TITLE","BIG_DEPARTMENT_USER_COUNT","HINT_MESSAGES_BY_COUNT","condition","count","message","SettingsPage","requiredData","taskTemplate","push","queueDistribution","manuallyDistribution","himselfDistribution","immutableDistribution","queueRadio","manuallyRadio","himselfRadio","immutableRadio","projectSelector","responsiblesQueueSelector","responsiblesHimselfSelector","responsiblesImmutableSelector","moderatorSelector","selectedDistributionType","FormData","settingsPageForm","get","distributionType","responsibleList","groupId","isLoaded","responsibleCanChangeDeadline","notifyAtHalfTime","taskControl","templateId","notifyAtHalfTimeTitle","enableUsers","multiple","entities","options","features","tasks","checkFeatureForCreate","checkDepartmentUsersCount","selector","selectedTags","selectedDepartments","filter","getEntityId","addedDepartments","departmentTag","then","countArray","departmentForHint","find","departmentData","toString","departmentId","catch","error","console","settings","Extension","getSettings","currentUser","pullRequests","Pull","templateItem","tabs","taskTemplateDialog","addItem","getItems","select","getItem","isStringFilled","setTitle","isArrayFilled","isConsiderFlowResponsible","responsibleListFromSelector","isNull","isConsiderFlowDataResponsible","immutableFieldLabel","isDomNode","immutableDistributionTooltip","append","enableAll","radio","type","responsibleValues","toUpperCase","Dialog","context","preselectedItems","enableSearch","notifyEmptyProject","hintMessage","hint","code","popup","PopupWindow","content","darkMode","bindElement","getContainer","angle","contentPadding","maxWidth","offsetLeft","autoHide","closeByEsc","departments","departmentsToBackend","department","result","ControlPage","flowOwnerSelector","ownerId","notifyOnQueueOverflow","notifyOnTasksInProgressOverflow","notifyWhenEfficiencyDecreases","flowOwnerLabel","analyticsPermissionsSelector","controlPageForm","test","SLIDER_WIDTH","HELPDESK_ARTICLE","EditForm","initFlowData","instance","openInSlider","sidePanelId","SidePanel","Instance","open","cacheable","contentCallback","slider","noAccess","flowId","demoFlow","guideFlow","html","page","events","aboutPage","initHints","onClose","hideHints","subTitle","Wizard","steps","isFilled","onCancel","close","destroy","onDisabledContinueButtonClick","onContinueHandler","finishButton","saveChangesButton","article","isEdit","demo","Button","color","Color","PRIMARY","round","Size","LARGE","onclick","SUCCESS","setState","ButtonState","DISABLED","Object","fromEntries","entries","key","isBoolean","action","textNotification","analyticsParams","status","trialFeatureEnabled","Notification","Center","notify","alert","e","join","Popup","overlay","padding","closeIcon","onFirstShow","Lottie","loadAnimation","container","renderer","loop","animationData","flowfLottieIconInfo","popupContainer","getContentContainer","btnNode","fields","field","isNumber","reduce","stepId","getCurrentStep","currentPage","canContinue","isNewFlow","isNil","isNeedSendAnalytics","stepNumber","getCurrentStepIndex","demoSuffix","p1","isFeatureTrialable"],"mappings":"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;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;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"}