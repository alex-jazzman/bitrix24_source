{"version":3,"file":"relation-service.bundle.js","sources":["../src/relation-service.js","../src/sub-tasks-service.js","../src/meta.js","../src/index.js"],"sourcesContent":["import { Core } from 'tasks.v2.core';\nimport { Limit, Model } from 'tasks.v2.const';\nimport { apiClient } from 'tasks.v2.lib.api-client';\nimport { taskService } from 'tasks.v2.provider.service.task-service';\nimport type { TaskDto } from 'tasks.v2.provider.service.task-service';\nimport type { RelationMeta } from './types';\n\nconst limit = Limit.RelationList;\n\nexport class RelationService\n{\n\t#meta: RelationMeta;\n\t#addPromises: Promise[] = [];\n\n\tconstructor(meta: RelationMeta)\n\t{\n\t\tthis.#meta = meta;\n\t}\n\n\tasync list(taskId: number, withIds: boolean = false): Promise<void>\n\t{\n\t\tawait Promise.all(this.#addPromises);\n\n\t\tconst { tasks, ids } = await this.#requestTasks(taskId, withIds);\n\n\t\tif (withIds)\n\t\t{\n\t\t\tthis.#updateStoreRelationTasks(taskId, ids);\n\t\t}\n\n\t\ttasks.forEach((taskDto: TaskDto) => {\n\t\t\tif (!taskService.hasStoreTask(taskDto.id))\n\t\t\t{\n\t\t\t\ttaskService.extractTask({ ...taskDto, [this.#meta.relationToField]: taskId });\n\t\t\t\tvoid Core.getStore().dispatch(`${Model.Tasks}/addPartiallyLoaded`, taskDto.id);\n\t\t\t}\n\t\t});\n\t}\n\n\tasync setParent(taskId: number, parentId: number): Promise<?string>\n\t{\n\t\treturn this.add(parentId, [taskId]);\n\t}\n\n\tasync add(taskId: number, taskIds: number[]): Promise<?string>\n\t{\n\t\tthis.addStore(taskId, taskIds);\n\n\t\tif (!taskService.isRealId(taskId) || taskIds.length === 0)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\ttry\n\t\t{\n\t\t\tconst promise = apiClient.post(`${this.#meta.controller}.add`, { taskId, taskIds });\n\t\t\tthis.#addPromises.push(promise);\n\t\t\tawait promise;\n\t\t\tthis.#addPromises = this.#addPromises.filter((it) => it !== promise);\n\t\t}\n\t\tcatch (error)\n\t\t{\n\t\t\tconst failedIds = Object.entries(error.data)\n\t\t\t\t.filter(([, success]) => !success)\n\t\t\t\t.map(([id]) => Number(id))\n\t\t\t;\n\n\t\t\tthis.deleteStore(taskId, failedIds);\n\n\t\t\tconsole.error(`${this.#meta.controller}.add error`, error);\n\n\t\t\treturn error.errors?.[0]?.message;\n\t\t}\n\n\t\treturn null;\n\t}\n\n\taddStore(taskId: number, taskIds: number[]): void\n\t{\n\t\tconst meta = this.#meta;\n\t\tconst task = taskService.getStoreTask(taskId);\n\t\tthis.#updateStoreRelationTasks(taskId, [...(task?.[meta.idsField] || []), ...taskIds]);\n\t\ttaskIds.forEach((it) => taskService.updateStoreTask(it, { [meta.relationToField]: taskId }));\n\t}\n\n\tasync delete(taskId: number, taskIds: number[]): Promise<void>\n\t{\n\t\tthis.deleteStore(taskId, taskIds);\n\n\t\tif (!taskService.isRealId(taskId) || taskIds.length === 0)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\ttry\n\t\t{\n\t\t\tawait apiClient.post(`${this.#meta.controller}.delete`, { taskId, taskIds });\n\t\t}\n\t\tcatch (error)\n\t\t{\n\t\t\tthis.addStore(taskId, taskIds);\n\n\t\t\tconsole.error(`${this.#meta.controller}.delete error`, error);\n\t\t}\n\t}\n\n\tdeleteStore(taskId: number, taskIds: number[]): void\n\t{\n\t\tconst meta = this.#meta;\n\t\tconst task = taskService.getStoreTask(taskId);\n\t\tthis.#updateStoreRelationTasks(taskId, task?.[meta.idsField].filter((it) => !taskIds.includes(it)));\n\t\ttaskIds.forEach((it) => taskService.updateStoreTask(it, { [meta.relationToField]: 0 }));\n\t}\n\n\tareIdsLoaded(taskId: number): boolean\n\t{\n\t\tconst meta = this.#meta;\n\t\tconst task = taskService.getStoreTask(taskId);\n\t\tif (!task || !taskService.isRealId(taskId))\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\treturn !task[meta.containsField] || (task[meta.containsField] && task[meta.idsField].length > 0);\n\t}\n\n\thasUnloadedIds(taskId: number): boolean\n\t{\n\t\tconst ids = taskService.getStoreTask(taskId)[this.#meta.idsField];\n\n\t\treturn this.#getVisibleIds(ids).some((it) => !taskService.hasStoreTask(it));\n\t}\n\n\tasync #requestTasks(taskId: number, withIds: boolean = false): Promise<{ tasks: TaskDto[], ids?: number[] }>\n\t{\n\t\tif (!taskService.isRealId(taskId))\n\t\t{\n\t\t\tconst ids = taskService.getStoreTask(taskId)[this.#meta.idsField];\n\n\t\t\tconst { tasks } = await apiClient.post(`${this.#meta.controller}.listByIds`, {\n\t\t\t\ttaskIds: this.#getVisibleIds(ids),\n\t\t\t});\n\n\t\t\treturn { tasks, ids };\n\t\t}\n\n\t\tconst { tasks, ids } = await apiClient.post(`${this.#meta.controller}.list`, {\n\t\t\ttaskId,\n\t\t\trelationTaskSelect: ['id', 'title', 'creator', 'responsible', 'deadline', 'rights'],\n\t\t\twithIds,\n\t\t\tnavigation: {\n\t\t\t\tsize: limit,\n\t\t\t},\n\t\t});\n\n\t\treturn { tasks, ids };\n\t}\n\n\t#getVisibleIds(ids: number[]): number[]\n\t{\n\t\treturn [...ids].sort((a, b) => b - a).slice(0, limit);\n\t}\n\n\t#updateStoreRelationTasks(taskId: number, taskIds: number[]): void\n\t{\n\t\tconst meta = this.#meta;\n\t\tconst relationIds = [...new Set(taskIds)];\n\t\tconst contains = relationIds.length > 0;\n\t\tvoid taskService.updateStoreTask(taskId, { [meta.idsField]: relationIds, [meta.containsField]: contains });\n\t}\n}\n","import { Loc } from 'main.core';\nimport { taskService } from 'tasks.v2.provider.service.task-service';\nimport { RelationService } from './relation-service';\n\nexport class SubTasksService extends RelationService\n{\n\tasync setParent(taskId: number, parentId: number): Promise<?string>\n\t{\n\t\tif (parentId === taskId)\n\t\t{\n\t\t\treturn Loc.getMessage('TASKS_V2_RELATION_PARENT_CANNOT_BE_PARENT');\n\t\t}\n\n\t\tif (taskService.getStoreTask(taskId)?.subTaskIds.includes(parentId))\n\t\t{\n\t\t\treturn Loc.getMessage('TASKS_V2_RELATION_SUB_TASK_CANNOT_BE_PARENT');\n\t\t}\n\n\t\tif (!taskService.isRealId(taskId))\n\t\t{\n\t\t\treturn this.addStore(parentId, [taskId]);\n\t\t}\n\n\t\tconst currentParentId = taskService.getStoreTask(taskId).parentId;\n\n\t\tconst error = await this.add(parentId, [taskId]);\n\n\t\tif (error)\n\t\t{\n\t\t\tthis.addStore(currentParentId, [taskId]);\n\t\t}\n\n\t\treturn error;\n\t}\n\n\tasync add(taskId: number, taskIds: number[]): Promise<?string>\n\t{\n\t\tlet error = null;\n\n\t\tif (taskIds.includes(taskId))\n\t\t{\n\t\t\terror ??= Loc.getMessage('TASKS_V2_RELATION_SELF_CANNOT_BE_SUB_TASK');\n\t\t}\n\n\t\tconst parentId = taskService.getStoreTask(taskId)?.parentId;\n\t\tif (taskIds.includes(parentId))\n\t\t{\n\t\t\terror ??= Loc.getMessage('TASKS_V2_RELATION_PARENT_CANNOT_BE_SUB_TASK');\n\t\t}\n\n\t\terror ??= super.add(taskId, taskIds.filter((id: number) => id !== taskId && id !== parentId));\n\n\t\treturn error;\n\t}\n\n\taddStore(id: number, ids: number[]): void\n\t{\n\t\tids.forEach((it) => this.deleteStore(taskService.getStoreTask(it)?.parentId, [it]));\n\n\t\tsuper.addStore(id, ids);\n\t}\n}\n","import { RelationMeta } from './types';\n\nexport const subTasksMeta: RelationMeta = Object.freeze({\n\tidsField: 'subTaskIds',\n\tcontainsField: 'containsSubTasks',\n\trelationToField: 'parentId',\n\tcontroller: 'Task.Relation.Child',\n});\n\nexport const relatedTasksMeta: RelationMeta = Object.freeze({\n\tidsField: 'relatedTaskIds',\n\tcontainsField: 'containsRelatedTasks',\n\trelationToField: 'relatedToTaskId',\n\tcontroller: 'Task.Relation.Related',\n});\n","import { SubTasksService } from './sub-tasks-service';\nimport { RelationService } from './relation-service';\nimport { relatedTasksMeta, subTasksMeta } from './meta';\n\nexport const subTasksService = new SubTasksService(subTasksMeta);\nexport const relatedTasksService = new RelationService(relatedTasksMeta);\nexport type { RelationService };\n"],"names":["limit","Limit","RelationList","RelationService","constructor","meta","list","taskId","withIds","Promise","all","tasks","ids","forEach","taskDto","taskService","hasStoreTask","id","extractTask","relationToField","Core","getStore","dispatch","Model","Tasks","setParent","parentId","add","taskIds","addStore","isRealId","length","promise","apiClient","post","controller","push","filter","it","error","failedIds","Object","entries","data","success","map","Number","deleteStore","console","errors","message","task","getStoreTask","idsField","updateStoreTask","delete","includes","areIdsLoaded","containsField","hasUnloadedIds","some","relationTaskSelect","navigation","size","sort","a","b","slice","relationIds","Set","contains","SubTasksService","Loc","getMessage","subTaskIds","currentParentId","subTasksMeta","freeze","relatedTasksMeta","subTasksService","relatedTasksService"],"mappings":";;;;;;;;CAOA,MAAMA,KAAK,GAAGC,oBAAK,CAACC,YAAY;CAAC;CAAA;CAAA;CAAA;CAAA;AAEjC,CAAO,MAAMC,eAAe,CAC5B;GAICC,WAAW,CAACC,MAAkB,EAC9B;KAAA;OAAA;;KAAA;OAAA;;KAAA;OAAA;;KAAA;OAAA;OAAA;;KAAA;OAAA;OAAA,OAH0B;;KAIzB,4CAAI,kBAASA,MAAI;;GAGlB,MAAMC,IAAI,CAACC,MAAc,EAAEC,OAAgB,GAAG,KAAK,EACnD;KACC,MAAMC,OAAO,CAACC,GAAG,yCAAC,IAAI,8BAAc;KAEpC,MAAM;OAAEC,KAAK;OAAEC;MAAK,GAAG,8CAAM,IAAI,gCAAeL,MAAM,EAAEC,OAAO,CAAC;KAEhE,IAAIA,OAAO,EACX;OACC,4CAAI,wDAA2BD,MAAM,EAAEK,GAAG;;KAG3CD,KAAK,CAACE,OAAO,CAAEC,OAAgB,IAAK;OACnC,IAAI,CAACC,iDAAW,CAACC,YAAY,CAACF,OAAO,CAACG,EAAE,CAAC,EACzC;SACCF,iDAAW,CAACG,WAAW,CAAC;WAAE,GAAGJ,OAAO;WAAE,CAAC,4CAAI,gBAAOK,eAAe,GAAGZ;UAAQ,CAAC;SAC7E,KAAKa,kBAAI,CAACC,QAAQ,EAAE,CAACC,QAAQ,CAAE,GAAEC,oBAAK,CAACC,KAAM,qBAAoB,EAAEV,OAAO,CAACG,EAAE,CAAC;;MAE/E,CAAC;;GAGH,MAAMQ,SAAS,CAAClB,MAAc,EAAEmB,QAAgB,EAChD;KACC,OAAO,IAAI,CAACC,GAAG,CAACD,QAAQ,EAAE,CAACnB,MAAM,CAAC,CAAC;;GAGpC,MAAMoB,GAAG,CAACpB,MAAc,EAAEqB,OAAiB,EAC3C;KACC,IAAI,CAACC,QAAQ,CAACtB,MAAM,EAAEqB,OAAO,CAAC;KAE9B,IAAI,CAACb,iDAAW,CAACe,QAAQ,CAACvB,MAAM,CAAC,IAAIqB,OAAO,CAACG,MAAM,KAAK,CAAC,EACzD;OACC,OAAO,IAAI;;KAGZ,IACA;OACC,MAAMC,OAAO,GAAGC,gCAAS,CAACC,IAAI,CAAE,GAAE,4CAAI,gBAAOC,UAAW,MAAK,EAAE;SAAE5B,MAAM;SAAEqB;QAAS,CAAC;OACnF,4CAAI,8BAAcQ,IAAI,CAACJ,OAAO,CAAC;OAC/B,MAAMA,OAAO;OACb,4CAAI,gCAAgB,4CAAI,8BAAcK,MAAM,CAAEC,EAAE,IAAKA,EAAE,KAAKN,OAAO,CAAC;MACpE,CACD,OAAOO,KAAK,EACZ;OAAA;OACC,MAAMC,SAAS,GAAGC,MAAM,CAACC,OAAO,CAACH,KAAK,CAACI,IAAI,CAAC,CAC1CN,MAAM,CAAC,CAAC,GAAGO,OAAO,CAAC,KAAK,CAACA,OAAO,CAAC,CACjCC,GAAG,CAAC,CAAC,CAAC5B,EAAE,CAAC,KAAK6B,MAAM,CAAC7B,EAAE,CAAC,CAAC;OAG3B,IAAI,CAAC8B,WAAW,CAACxC,MAAM,EAAEiC,SAAS,CAAC;OAEnCQ,OAAO,CAACT,KAAK,CAAE,GAAE,4CAAI,gBAAOJ,UAAW,YAAW,EAAEI,KAAK,CAAC;OAE1D,wBAAOA,KAAK,CAACU,MAAM,uCAAZ,cAAe,CAAC,CAAC,qBAAjB,eAAmBC,OAAO;;KAGlC,OAAO,IAAI;;GAGZrB,QAAQ,CAACtB,MAAc,EAAEqB,OAAiB,EAC1C;KACC,MAAMvB,IAAI,2CAAG,IAAI,eAAM;KACvB,MAAM8C,IAAI,GAAGpC,iDAAW,CAACqC,YAAY,CAAC7C,MAAM,CAAC;KAC7C,4CAAI,wDAA2BA,MAAM,EAAE,CAAC,IAAI,CAAA4C,IAAI,oBAAJA,IAAI,CAAG9C,IAAI,CAACgD,QAAQ,CAAC,KAAI,EAAE,CAAC,EAAE,GAAGzB,OAAO,CAAC;KACrFA,OAAO,CAACf,OAAO,CAAEyB,EAAE,IAAKvB,iDAAW,CAACuC,eAAe,CAAChB,EAAE,EAAE;OAAE,CAACjC,IAAI,CAACc,eAAe,GAAGZ;MAAQ,CAAC,CAAC;;GAG7F,MAAMgD,MAAM,CAAChD,MAAc,EAAEqB,OAAiB,EAC9C;KACC,IAAI,CAACmB,WAAW,CAACxC,MAAM,EAAEqB,OAAO,CAAC;KAEjC,IAAI,CAACb,iDAAW,CAACe,QAAQ,CAACvB,MAAM,CAAC,IAAIqB,OAAO,CAACG,MAAM,KAAK,CAAC,EACzD;OACC;;KAGD,IACA;OACC,MAAME,gCAAS,CAACC,IAAI,CAAE,GAAE,4CAAI,gBAAOC,UAAW,SAAQ,EAAE;SAAE5B,MAAM;SAAEqB;QAAS,CAAC;MAC5E,CACD,OAAOW,KAAK,EACZ;OACC,IAAI,CAACV,QAAQ,CAACtB,MAAM,EAAEqB,OAAO,CAAC;OAE9BoB,OAAO,CAACT,KAAK,CAAE,GAAE,4CAAI,gBAAOJ,UAAW,eAAc,EAAEI,KAAK,CAAC;;;GAI/DQ,WAAW,CAACxC,MAAc,EAAEqB,OAAiB,EAC7C;KACC,MAAMvB,IAAI,2CAAG,IAAI,eAAM;KACvB,MAAM8C,IAAI,GAAGpC,iDAAW,CAACqC,YAAY,CAAC7C,MAAM,CAAC;KAC7C,4CAAI,wDAA2BA,MAAM,EAAE4C,IAAI,oBAAJA,IAAI,CAAG9C,IAAI,CAACgD,QAAQ,CAAC,CAAChB,MAAM,CAAEC,EAAE,IAAK,CAACV,OAAO,CAAC4B,QAAQ,CAAClB,EAAE,CAAC,CAAC;KAClGV,OAAO,CAACf,OAAO,CAAEyB,EAAE,IAAKvB,iDAAW,CAACuC,eAAe,CAAChB,EAAE,EAAE;OAAE,CAACjC,IAAI,CAACc,eAAe,GAAG;MAAG,CAAC,CAAC;;GAGxFsC,YAAY,CAAClD,MAAc,EAC3B;KACC,MAAMF,IAAI,2CAAG,IAAI,eAAM;KACvB,MAAM8C,IAAI,GAAGpC,iDAAW,CAACqC,YAAY,CAAC7C,MAAM,CAAC;KAC7C,IAAI,CAAC4C,IAAI,IAAI,CAACpC,iDAAW,CAACe,QAAQ,CAACvB,MAAM,CAAC,EAC1C;OACC,OAAO,KAAK;;KAGb,OAAO,CAAC4C,IAAI,CAAC9C,IAAI,CAACqD,aAAa,CAAC,IAAKP,IAAI,CAAC9C,IAAI,CAACqD,aAAa,CAAC,IAAIP,IAAI,CAAC9C,IAAI,CAACgD,QAAQ,CAAC,CAACtB,MAAM,GAAG,CAAE;;GAGjG4B,cAAc,CAACpD,MAAc,EAC7B;KACC,MAAMK,GAAG,GAAGG,iDAAW,CAACqC,YAAY,CAAC7C,MAAM,CAAC,CAAC,4CAAI,gBAAO8C,QAAQ,CAAC;KAEjE,OAAO,4CAAI,kCAAgBzC,GAAG,EAAEgD,IAAI,CAAEtB,EAAE,IAAK,CAACvB,iDAAW,CAACC,YAAY,CAACsB,EAAE,CAAC,CAAC;;CAwC7E;CAAC,8BArCoB/B,MAAc,EAAEC,OAAgB,GAAG,KAAK,EAC5D;GACC,IAAI,CAACO,iDAAW,CAACe,QAAQ,CAACvB,MAAM,CAAC,EACjC;KACC,MAAMK,GAAG,GAAGG,iDAAW,CAACqC,YAAY,CAAC7C,MAAM,CAAC,CAAC,4CAAI,gBAAO8C,QAAQ,CAAC;KAEjE,MAAM;OAAE1C;MAAO,GAAG,MAAMsB,gCAAS,CAACC,IAAI,CAAE,GAAE,4CAAI,gBAAOC,UAAW,YAAW,EAAE;OAC5EP,OAAO,0CAAE,IAAI,kCAAgBhB,GAAG;MAChC,CAAC;KAEF,OAAO;OAAED,KAAK;OAAEC;MAAK;;GAGtB,MAAM;KAAED,KAAK;KAAEC;IAAK,GAAG,MAAMqB,gCAAS,CAACC,IAAI,CAAE,GAAE,4CAAI,gBAAOC,UAAW,OAAM,EAAE;KAC5E5B,MAAM;KACNsD,kBAAkB,EAAE,CAAC,IAAI,EAAE,OAAO,EAAE,SAAS,EAAE,aAAa,EAAE,UAAU,EAAE,QAAQ,CAAC;KACnFrD,OAAO;KACPsD,UAAU,EAAE;OACXC,IAAI,EAAE/D;;IAEP,CAAC;GAEF,OAAO;KAAEW,KAAK;KAAEC;IAAK;CACtB;CAAC,yBAEcA,GAAa,EAC5B;GACC,OAAO,CAAC,GAAGA,GAAG,CAAC,CAACoD,IAAI,CAAC,CAACC,CAAC,EAAEC,CAAC,KAAKA,CAAC,GAAGD,CAAC,CAAC,CAACE,KAAK,CAAC,CAAC,EAAEnE,KAAK,CAAC;CACtD;CAAC,oCAEyBO,MAAc,EAAEqB,OAAiB,EAC3D;GACC,MAAMvB,IAAI,2CAAG,IAAI,eAAM;GACvB,MAAM+D,WAAW,GAAG,CAAC,GAAG,IAAIC,GAAG,CAACzC,OAAO,CAAC,CAAC;GACzC,MAAM0C,QAAQ,GAAGF,WAAW,CAACrC,MAAM,GAAG,CAAC;GACvC,KAAKhB,iDAAW,CAACuC,eAAe,CAAC/C,MAAM,EAAE;KAAE,CAACF,IAAI,CAACgD,QAAQ,GAAGe,WAAW;KAAE,CAAC/D,IAAI,CAACqD,aAAa,GAAGY;IAAU,CAAC;CAC3G;;CCrKM,MAAMC,eAAe,SAASpE,eAAe,CACpD;GACC,MAAMsB,SAAS,CAAClB,MAAc,EAAEmB,QAAgB,EAChD;KAAA;KACC,IAAIA,QAAQ,KAAKnB,MAAM,EACvB;OACC,OAAOiE,aAAG,CAACC,UAAU,CAAC,2CAA2C,CAAC;;KAGnE,6BAAI1D,iDAAW,CAACqC,YAAY,CAAC7C,MAAM,CAAC,aAAhC,sBAAkCmE,UAAU,CAAClB,QAAQ,CAAC9B,QAAQ,CAAC,EACnE;OACC,OAAO8C,aAAG,CAACC,UAAU,CAAC,6CAA6C,CAAC;;KAGrE,IAAI,CAAC1D,iDAAW,CAACe,QAAQ,CAACvB,MAAM,CAAC,EACjC;OACC,OAAO,IAAI,CAACsB,QAAQ,CAACH,QAAQ,EAAE,CAACnB,MAAM,CAAC,CAAC;;KAGzC,MAAMoE,eAAe,GAAG5D,iDAAW,CAACqC,YAAY,CAAC7C,MAAM,CAAC,CAACmB,QAAQ;KAEjE,MAAMa,KAAK,GAAG,MAAM,IAAI,CAACZ,GAAG,CAACD,QAAQ,EAAE,CAACnB,MAAM,CAAC,CAAC;KAEhD,IAAIgC,KAAK,EACT;OACC,IAAI,CAACV,QAAQ,CAAC8C,eAAe,EAAE,CAACpE,MAAM,CAAC,CAAC;;KAGzC,OAAOgC,KAAK;;GAGb,MAAMZ,GAAG,CAACpB,MAAc,EAAEqB,OAAiB,EAC3C;KAAA;KACC,IAAIW,KAAK,GAAG,IAAI;KAEhB,IAAIX,OAAO,CAAC4B,QAAQ,CAACjD,MAAM,CAAC,EAC5B;OAAA;OACC,UAAAgC,KAAK,qBAALA,KAAK,GAAKiC,aAAG,CAACC,UAAU,CAAC,2CAA2C,CAAC;;KAGtE,MAAM/C,QAAQ,6BAAGX,iDAAW,CAACqC,YAAY,CAAC7C,MAAM,CAAC,qBAAhC,uBAAkCmB,QAAQ;KAC3D,IAAIE,OAAO,CAAC4B,QAAQ,CAAC9B,QAAQ,CAAC,EAC9B;OAAA;OACC,WAAAa,KAAK,sBAALA,KAAK,GAAKiC,aAAG,CAACC,UAAU,CAAC,6CAA6C,CAAC;;KAGxE,WAAAlC,KAAK,sBAALA,KAAK,GAAK,KAAK,CAACZ,GAAG,CAACpB,MAAM,EAAEqB,OAAO,CAACS,MAAM,CAAEpB,EAAU,IAAKA,EAAE,KAAKV,MAAM,IAAIU,EAAE,KAAKS,QAAQ,CAAC,CAAC;KAE7F,OAAOa,KAAK;;GAGbV,QAAQ,CAACZ,EAAU,EAAEL,GAAa,EAClC;KACCA,GAAG,CAACC,OAAO,CAAEyB,EAAE;OAAA;OAAA,OAAK,IAAI,CAACS,WAAW,2BAAChC,iDAAW,CAACqC,YAAY,CAACd,EAAE,CAAC,qBAA5B,uBAA8BZ,QAAQ,EAAE,CAACY,EAAE,CAAC,CAAC;OAAC;KAEnF,KAAK,CAACT,QAAQ,CAACZ,EAAE,EAAEL,GAAG,CAAC;;CAEzB;;CC3DO,MAAMgE,YAA0B,GAAGnC,MAAM,CAACoC,MAAM,CAAC;GACvDxB,QAAQ,EAAE,YAAY;GACtBK,aAAa,EAAE,kBAAkB;GACjCvC,eAAe,EAAE,UAAU;GAC3BgB,UAAU,EAAE;CACb,CAAC,CAAC;AAEF,CAAO,MAAM2C,gBAA8B,GAAGrC,MAAM,CAACoC,MAAM,CAAC;GAC3DxB,QAAQ,EAAE,gBAAgB;GAC1BK,aAAa,EAAE,sBAAsB;GACrCvC,eAAe,EAAE,iBAAiB;GAClCgB,UAAU,EAAE;CACb,CAAC,CAAC;;OCVW4C,eAAe,GAAG,IAAIR,eAAe,CAACK,YAAY,CAAC;AAChE,OAAaI,mBAAmB,GAAG,IAAI7E,eAAe,CAAC2E,gBAAgB,CAAC;;;;;;;;;"}