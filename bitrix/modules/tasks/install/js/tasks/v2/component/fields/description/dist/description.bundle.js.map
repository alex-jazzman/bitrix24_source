{"version":3,"file":"description.bundle.js","sources":["../src/default-editor-options.js","../src/description-text-editor.js","../src/description-text-area.js","../src/actions/action-button.js","../src/actions/copilot.js","../src/actions/attach.js","../src/actions/mention.js","../src/description-editor.js","../src/mini-form-button.js","../src/actions/full-description.js","../src/mini-form.js","../src/description-preview.js","../src/description-field.js","../src/description-sheet.js","../src/description-popup.js","../src/description-inline.js"],"sourcesContent":["import { EntitySelectorEntity } from 'tasks.v2.const';\nimport type { TextEditorOptions } from 'ui.text-editor';\n\nexport const DefaultEditorOptions: TextEditorOptions = Object.freeze({\n\ttoolbar: [],\n\tfloatingToolbar: [\n\t\t'bold', 'italic', 'underline', 'strikethrough', '|',\n\t\t'numbered-list', 'bulleted-list', '|',\n\t\t'link',\n\t],\n\tremovePlugins: ['BlockToolbar'],\n\tvisualOptions: {\n\t\tborderWidth: 0,\n\t\tblockSpaceInline: 0,\n\t\tcolorBackground: 'transparent',\n\t},\n\tmention: {\n\t\tdialogOptions: {\n\t\t\tentities: [\n\t\t\t\t{\n\t\t\t\t\tid: EntitySelectorEntity.User,\n\t\t\t\t\toptions: {\n\t\t\t\t\t\temailUsers: true,\n\t\t\t\t\t\tinviteEmployeeLink: false,\n\t\t\t\t\t},\n\t\t\t\t\titemOptions: {\n\t\t\t\t\t\tdefault: {\n\t\t\t\t\t\t\tlink: '',\n\t\t\t\t\t\t\tlinkTitle: '',\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tid: EntitySelectorEntity.StructureNode,\n\t\t\t\t\toptions: {\n\t\t\t\t\t\tselectMode: 'usersOnly',\n\t\t\t\t\t\tallowFlatDepartments: false,\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t],\n\t\t},\n\t},\n\tcopilot: {\n\t\tcopilotOptions: {},\n\t},\n\tparagraphPlaceholder: 'auto',\n});\n","import { Runtime, Type, Loc } from 'main.core';\nimport { BaseEvent, EventEmitter } from 'main.core.events';\nimport { Model } from 'tasks.v2.const';\n\nimport { FileEvent, getFilesFromDataTransfer, isFilePasted } from 'ui.uploader.core';\nimport { COMMAND_PRIORITY_NORMAL, PASTE_COMMAND } from 'ui.lexical.core';\nimport { TextEditor, TextEditorOptions, Plugins } from 'ui.text-editor';\nimport type { UploaderFile, UploaderFileInfo } from 'ui.uploader.core';\nimport type { VueUploaderAdapter } from 'ui.uploader.vue';\nimport type { Store } from 'ui.vue3.vuex';\n\nimport { Core } from 'tasks.v2.core';\nimport { fileService, type FileService } from 'tasks.v2.provider.service.file-service';\n\nimport { DefaultEditorOptions } from './default-editor-options';\n\nexport type DescriptionTextEditorOptions = {\n\tcontent: string | null,\n};\n\nexport class DescriptionTextEditor extends EventEmitter\n{\n\t#editor: TextEditor;\n\t#fileService: FileService;\n\t#uploaderAdapter: VueUploaderAdapter;\n\t#syncHighlightsDebounced: Function;\n\n\tconstructor(taskId: number | string, options: DescriptionTextEditorOptions)\n\t{\n\t\tsuper();\n\n\t\tthis.setEventNamespace('Tasks.V2.Component.Description-Text-Editor');\n\n\t\tthis.initService(taskId);\n\t\tthis.initEditor(taskId, options);\n\t\tthis.#subscribeToEvents();\n\t\tthis.#registerCommands();\n\n\t\tthis.#syncHighlightsDebounced = Runtime.debounce(this.#syncHighlights, 500, this);\n\t}\n\n\tgetEditor(): TextEditor\n\t{\n\t\treturn this.#editor;\n\t}\n\n\tinitService(taskId: number | string): void\n\t{\n\t\tthis.#fileService = fileService.get(taskId);\n\t\tthis.#uploaderAdapter = fileService.get(taskId).getAdapter();\n\t}\n\n\tinitEditor(taskId: number | string, options: DescriptionTextEditorOptions): void\n\t{\n\t\tconst content = this.initDescription(taskId, options.content);\n\n\t\tconst additionalEditorOptions: TextEditorOptions = {\n\t\t\tcontent,\n\t\t\tminHeight: 118,\n\t\t\tplaceholder: Loc.getMessage('TASKS_V2_CHANGE_DESCRIPTION'),\n\t\t\tnewLineMode: 'paragraph',\n\t\t\tevents: {\n\t\t\t\tonChange: this.handleEditorChange,\n\t\t\t},\n\t\t\tfile: {\n\t\t\t\tmode: 'disk',\n\t\t\t\tfiles: this.getFiles(),\n\t\t\t},\n\t\t\tvisualOptions: {\n\t\t\t\tborderWidth: 0,\n\t\t\t\tblockSpaceInline: 'var(--ui-space-stack-md2)',\n\t\t\t\tcolorBackground: 'transparent',\n\t\t\t},\n\t\t};\n\n\t\tthis.#editor = new TextEditor({ ...DefaultEditorOptions, ...additionalEditorOptions });\n\t}\n\n\tinitDescription(taskId: number | string, originalDescription: string | null): string | null\n\t{\n\t\tif (!Type.isStringFilled(originalDescription))\n\t\t{\n\t\t\treturn originalDescription;\n\t\t}\n\n\t\tconst mapping = this.getTempToServerFileIdMap();\n\t\tconst changedDescription = originalDescription.replaceAll(/(\\[disk file id=)(n\\d+)/gi, (match, prefix, nId) => {\n\t\t\treturn prefix + (mapping[nId] === undefined ? nId : mapping[nId]);\n\t\t});\n\n\t\tif (originalDescription !== changedDescription)\n\t\t{\n\t\t\tconst fields = { description: changedDescription };\n\n\t\t\tvoid this.$store.dispatch(`${Model.Tasks}/update`, { id: taskId, fields });\n\t\t}\n\n\t\treturn changedDescription;\n\t}\n\n\tsetEditorText(taskId, content): void\n\t{\n\t\tconst text = this.initDescription(taskId, content);\n\n\t\tthis.#editor.setText(text);\n\t}\n\n\tgetFiles(): UploaderFileInfo[]\n\t{\n\t\treturn this.#uploaderAdapter.getItems();\n\t}\n\n\tgetTempToServerFileIdMap(): Object\n\t{\n\t\tconst filesMap = {};\n\n\t\tthis.getFiles().forEach((file: UploaderFileInfo): void => {\n\t\t\tconst key = `n${file.customData.objectId}`;\n\n\t\t\tfilesMap[key] = file.serverFileId;\n\t\t});\n\n\t\treturn filesMap;\n\t}\n\n\tdestroy(): void\n\t{\n\t\tthis.#unsubscribeToEvents();\n\t\tthis.#editor.destroy();\n\t\tthis.#editor = null;\n\t}\n\n\t#subscribeToEvents(): void\n\t{\n\t\tthis.#fileService.subscribe('onFileComplete', this.onFileComplete);\n\t\tthis.#fileService.subscribe('onFileRemove', this.onFileRemove);\n\t}\n\n\t#unsubscribeToEvents(): void\n\t{\n\t\tthis.#fileService.unsubscribe('onFileComplete', this.onFileComplete);\n\t\tthis.#fileService.unsubscribe('onFileRemove', this.onFileRemove);\n\t}\n\n\t#registerCommands(): void\n\t{\n\t\tthis.#editor.registerCommand(\n\t\t\tPASTE_COMMAND,\n\t\t\t(clipboardEvent: ClipboardEvent) => {\n\t\t\t\tconst clipboardData: DataTransfer = clipboardEvent.clipboardData;\n\t\t\t\tif (!clipboardData || !isFilePasted(clipboardData))\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tclipboardEvent.preventDefault();\n\n\t\t\t\tgetFilesFromDataTransfer(clipboardData)\n\t\t\t\t\t.then((files: File[]): void => {\n\t\t\t\t\t\tfiles.forEach((file: File): void => {\n\t\t\t\t\t\t\tthis.#uploaderAdapter.getUploader().addFile(file, {\n\t\t\t\t\t\t\t\tevents: {\n\t\t\t\t\t\t\t\t\t[FileEvent.LOAD_ERROR]: () => {},\n\t\t\t\t\t\t\t\t\t[FileEvent.UPLOAD_ERROR]: () => {},\n\t\t\t\t\t\t\t\t\t[FileEvent.UPLOAD_COMPLETE]: (event: BaseEvent): void => {\n\t\t\t\t\t\t\t\t\t\tconst uploaderFile: UploaderFile = event.getTarget();\n\n\t\t\t\t\t\t\t\t\t\tthis.insertFile(uploaderFile.toJSON());\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t});\n\t\t\t\t\t})\n\t\t\t\t\t.catch((): void => {\n\t\t\t\t\t\tconsole.error('clipboard pasting error');\n\t\t\t\t\t})\n\t\t\t\t;\n\n\t\t\t\treturn true;\n\t\t\t},\n\t\t\tCOMMAND_PRIORITY_NORMAL,\n\t\t);\n\t}\n\n\t#syncHighlights(): void\n\t{\n\t\tif (!this.#editor)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.#editor.dispatchCommand(Plugins.File.GET_INSERTED_FILES_COMMAND, (nodes) => {\n\t\t\tconst inserted: Set<number | string> = new Set();\n\t\t\tfor (const node of nodes)\n\t\t\t{\n\t\t\t\tconst { serverFileId } = node.getInfo();\n\t\t\t\tif (Type.isStringFilled(serverFileId) || Type.isNumber(serverFileId))\n\t\t\t\t{\n\t\t\t\t\tinserted.add(serverFileId);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.#uploaderAdapter.getUploader().getFiles().forEach((file: UploaderFile) => {\n\t\t\t\tif (inserted.has(file.getServerFileId()))\n\t\t\t\t{\n\t\t\t\t\tfile.setCustomData('tileSelected', true);\n\t\t\t\t\tinserted.delete(file.getServerFileId());\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tfile.setCustomData('tileSelected', false);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tfor (const serverFileId: number | string of inserted)\n\t\t\t{\n\t\t\t\tthis.handleRemoveFile(serverFileId);\n\t\t\t}\n\t\t});\n\t}\n\n\tonFileComplete = (event: BaseEvent): void => {\n\t\tconst file = event.getData();\n\n\t\tthis.#editor.dispatchCommand(Plugins.File.ADD_FILE_COMMAND, file);\n\n\t\tthis.emit('filesChanged');\n\t};\n\n\tonFileRemove = (event: BaseEvent): void => {\n\t\tconst { file } = event.getData();\n\n\t\tthis.handleRemoveFile(file.serverFileId);\n\n\t\tthis.emit('filesChanged');\n\t};\n\n\thandleEditorChange = (): void => {\n\t\tthis.#syncHighlightsDebounced();\n\n\t\tthis.emit('editorChanged');\n\t};\n\n\thandleRemoveFile(serverFileId): void\n\t{\n\t\tthis.#editor.dispatchCommand(Plugins.File.REMOVE_FILE_COMMAND, {\n\t\t\tserverFileId,\n\t\t\tskipHistoryStack: true,\n\t\t});\n\n\t\tthis.#syncHighlights();\n\t}\n\n\tinsertFile(fileInfo): void\n\t{\n\t\tthis.#editor.dispatchCommand(Plugins.File.INSERT_FILE_COMMAND, {\n\t\t\tserverFileId: fileInfo.serverFileId,\n\t\t\twidth: 600,\n\t\t\theight: 600,\n\t\t\tinfo: fileInfo,\n\t\t\tinline: true,\n\t\t});\n\t}\n\n\tget $store(): Store\n\t{\n\t\treturn Core.getStore();\n\t}\n}\n\nconst instances = {};\n\nexport const descriptionTextEditor = {\n\tget(taskId: number | string, options: DescriptionTextEditorOptions = {}): DescriptionTextEditor\n\t{\n\t\tinstances[taskId] ??= new DescriptionTextEditor(taskId, options);\n\n\t\tif (Type.isStringFilled(options?.content))\n\t\t{\n\t\t\tinstances[taskId].setEditorText(taskId, options.content);\n\t\t}\n\n\t\treturn instances[taskId];\n\t},\n\treplace(tempId: number | string, taskId: number): void\n\t{\n\t\tinstances[taskId] = instances[tempId];\n\t\tinstances[taskId].initService(taskId);\n\n\t\tdelete instances[tempId];\n\t},\n\tdelete(taskId: number | string): void\n\t{\n\t\tinstances[taskId]?.destroy();\n\n\t\tdelete instances[taskId];\n\t},\n};\n","import { BaseEvent } from 'main.core.events';\nimport { Type } from 'main.core';\n\nimport type { UserFieldWidgetOptions } from 'disk.uploader.user-field-widget';\nimport { UserFieldWidgetComponent } from 'disk.uploader.user-field-widget';\n\nimport { TextEditorComponent, type TextEditor } from 'ui.text-editor';\nimport type { VueUploaderAdapter } from 'ui.uploader.vue';\n\nimport { Model } from 'tasks.v2.const';\nimport { TaskModel } from 'tasks.v2.model.tasks';\nimport { fileService } from 'tasks.v2.provider.service.file-service';\nimport type { FileService } from 'tasks.v2.provider.service.file-service';\n\nimport { type DescriptionTextEditor, descriptionTextEditor } from './description-text-editor';\n\n// @vue/component\nexport const DescriptionTextArea = {\n\tname: 'TaskDescriptionTextArea',\n\tcomponents: {\n\t\tTextEditorComponent,\n\t\tUserFieldWidgetComponent,\n\t},\n\tprops: {\n\t\ttaskId: {\n\t\t\ttype: [Number, String],\n\t\t\trequired: true,\n\t\t},\n\t},\n\temits: ['change', 'filesChange'],\n\tsetup(props): {\n\t\teditor: TextEditor,\n\t\tdescriptionTextEditor: DescriptionTextEditor,\n\t\tuploaderAdapter: VueUploaderAdapter,\n\t\tfileService: FileService,\n\t}\n\t{\n\t\treturn {\n\t\t\t/** @type TextEditor */\n\t\t\teditor: null,\n\t\t\tdescriptionTextEditor: descriptionTextEditor.get(props.taskId),\n\t\t\tfileService: fileService.get(props.taskId),\n\t\t\tuploaderAdapter: fileService.get(props.taskId).getAdapter(),\n\t\t};\n\t},\n\tdata(): { files: Array<Object> }\n\t{\n\t\treturn {\n\t\t\tfiles: this.fileService.getFiles(),\n\t\t};\n\t},\n\tcomputed: {\n\t\ttask(): TaskModel\n\t\t{\n\t\t\treturn this.$store.getters[`${Model.Tasks}/getById`](this.taskId);\n\t\t},\n\t\treadonly(): boolean\n\t\t{\n\t\t\treturn !this.task.rights.edit;\n\t\t},\n\t\tisEdit(): boolean\n\t\t{\n\t\t\treturn Type.isNumber(this.taskId) && this.taskId > 0;\n\t\t},\n\t\twidgetOptions(): UserFieldWidgetOptions\n\t\t{\n\t\t\treturn {\n\t\t\t\tisEmbedded: true,\n\t\t\t\twithControlPanel: false,\n\t\t\t\tcanCreateDocuments: false,\n\t\t\t\tinsertIntoText: true,\n\t\t\t\ttileWidgetOptions: {\n\t\t\t\t\tcompact: true,\n\t\t\t\t\thideDropArea: true,\n\t\t\t\t\treadonly: this.readonly,\n\t\t\t\t\tautoCollapse: false,\n\t\t\t\t\tremoveFromServer: !this.isEdit,\n\t\t\t\t\tevents: {\n\t\t\t\t\t\tonInsertIntoText: this.handleInsertFile,\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t};\n\t\t},\n\t\tfilesCount(): number\n\t\t{\n\t\t\treturn this.files.length;\n\t\t},\n\t},\n\tcreated(): Promise<void>\n\t{\n\t\tthis.editor = this.descriptionTextEditor.getEditor();\n\t},\n\tmounted(): void\n\t{\n\t\tthis.fileService.subscribe('onFileAdd', this.onFileAdd);\n\t\tthis.fileService.subscribe('onFileRemove', this.onFileRemove);\n\t\tthis.descriptionTextEditor.subscribe('editorChanged', this.onEditorChange);\n\t},\n\tunmounted(): void\n\t{\n\t\tthis.fileService.unsubscribe('onFileAdd', this.onFileAdd);\n\t\tthis.fileService.unsubscribe('onFileRemove', this.onFileRemove);\n\t\tthis.descriptionTextEditor.unsubscribe('editorChanged', this.onEditorChange);\n\t},\n\tmethods: {\n\t\tonFileAdd(): void\n\t\t{\n\t\t\tthis.$emit('filesChange');\n\t\t},\n\t\tonFileRemove(): void\n\t\t{\n\t\t\tthis.$emit('filesChange');\n\t\t},\n\t\tonEditorChange(): void\n\t\t{\n\t\t\tthis.$emit('change');\n\t\t},\n\t\thandleInsertFile(event: BaseEvent): void\n\t\t{\n\t\t\tconst fileInfo = event.getData().item;\n\n\t\t\tthis.descriptionTextEditor.insertFile(fileInfo);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"tasks-card-description-text-area-wrapper\" ref=\"editorWrapper\">\n\t\t\t<TextEditorComponent :editorInstance=\"editor\">\n\t\t\t\t<template v-if=\"filesCount > 0\" #footer>\n\t\t\t\t\t<div id=\"descriptionEditorFiles\" class=\"tasks-card-description-editor-files\" ref=\"filesWrapper\">\n\t\t\t\t\t\t<UserFieldWidgetComponent\n\t\t\t\t\t\t\t:uploaderAdapter=\"uploaderAdapter\"\n\t\t\t\t\t\t\t:widgetOptions=\"widgetOptions\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t</template>\n\t\t\t</TextEditorComponent>\n\t\t</div>\n\t`,\n};\n","import { BIcon, Outline } from 'ui.icon-set.api.vue';\nimport { hint, type HintParams } from 'ui.vue3.directives.hint';\n\nimport { tooltip } from 'tasks.v2.component.elements.hint';\n\n// @vue/component\nexport const ActionButton = {\n\tcomponents: {\n\t\tBIcon,\n\t},\n\tdirectives: { hint },\n\tprops: {\n\t\ttitle: {\n\t\t\ttype: String,\n\t\t\tdefault: '',\n\t\t},\n\t\ticonName: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t\ticonColor: {\n\t\t\ttype: String,\n\t\t\tdefault: '',\n\t\t},\n\t},\n\tsetup(): Object\n\t{\n\t\treturn {\n\t\t\tOutline,\n\t\t};\n\t},\n\tcomputed: {\n\t\ttooltip(): Function\n\t\t{\n\t\t\treturn (): HintParams => tooltip({\n\t\t\t\ttext: this.title,\n\t\t\t\tpopupOptions: {\n\t\t\t\t\toffsetLeft: this.$el.offsetWidth / 2,\n\t\t\t\t},\n\t\t\t});\n\t\t},\n\t},\n\ttemplate: `\n\t\t<button class=\"tasks-card-description-action-button\" type=\"button\" v-hint=\"tooltip\">\n\t\t\t<BIcon\n\t\t\t\t:name=\"iconName\"\n\t\t\t\t:color=\"iconColor\"\n\t\t\t\t:hoverable=\"true\"\n\t\t\t\tclass=\"tasks-card-description-field-icon\"\n\t\t\t/>\n\t\t</button>\n\t`,\n};\n","import { Outline } from 'ui.icon-set.api.vue';\n\nimport { ActionButton } from './action-button';\n\n// @vue/component\nexport const Copilot = {\n\tname: 'TaskDescriptionCopilot',\n\tcomponents: {\n\t\tActionButton,\n\t\tOutline,\n\t},\n\tsetup(): Object\n\t{\n\t\treturn {\n\t\t\tOutline,\n\t\t};\n\t},\n\tcomputed: {\n\t\tbuttonColor(): String\n\t\t{\n\t\t\treturn 'var(--ui-color-copilot-primary)';\n\t\t},\n\t},\n\tmethods: {\n\t\thandleClick()\n\t\t{\n\t\t\talert('Not implemented yet');\n\t\t},\n\t},\n\ttemplate: `\n\t\t<ActionButton\n\t\t\t:iconName=\"Outline.COPILOT\"\n\t\t\t:title=\"loc('TASKS_V2_DESCRIPTION_ACTION_COPILOT_TITLE')\"\n\t\t\t:iconColor=\"buttonColor\"\n\t\t\t@click=\"handleClick\"\n\t\t/>\n\t`,\n};\n","import { Outline } from 'ui.icon-set.api.vue';\n\nimport { ActionButton } from './action-button';\n\n// @vue/component\nexport const Attach = {\n\tname: 'TaskDescriptionMention',\n\tcomponents: {\n\t\tActionButton,\n\t\tOutline,\n\t},\n\tsetup(): Object\n\t{\n\t\treturn {\n\t\t\tOutline,\n\t\t};\n\t},\n\ttemplate: `\n\t\t<ActionButton\n\t\t\t:iconName=\"Outline.ATTACH\"\n\t\t\t:title=\"loc('TASKS_V2_DESCRIPTION_ACTION_ATTACH_TITLE')\"\n\t\t/>\n\t`,\n};\n","import { Outline } from 'ui.icon-set.api.vue';\n\nimport { ActionButton } from './action-button';\n\n// @vue/component\nexport const Mention = {\n\tname: 'TaskDescriptionMention',\n\tcomponents: {\n\t\tActionButton,\n\t\tOutline,\n\t},\n\tsetup(): Object\n\t{\n\t\treturn {\n\t\t\tOutline,\n\t\t};\n\t},\n\ttemplate: `\n\t\t<ActionButton\n\t\t\t:iconName=\"Outline.MENTION\"\n\t\t\t:title=\"loc('TASKS_V2_DESCRIPTION_ACTION_MENTION_TITLE')\"\n\t\t/>\n\t`,\n};\n","import { Type } from 'main.core';\n\nimport { BIcon, Outline } from 'ui.icon-set.api.vue';\nimport { TextEditor } from 'ui.text-editor';\nimport { Button as UiButton, ButtonColor, ButtonSize } from 'ui.vue3.components.button';\n\nimport { TaskModel } from 'tasks.v2.model.tasks';\nimport { Model } from 'tasks.v2.const';\nimport { fileService, type FileService } from 'tasks.v2.provider.service.file-service';\nimport { descriptionTextEditor, type DescriptionTextEditor } from './description-text-editor';\n\nimport { DescriptionTextArea } from './description-text-area';\nimport { Copilot } from './actions/copilot';\nimport { Attach } from './actions/attach';\nimport { Mention } from './actions/mention';\n\nimport './description.css';\n\n// @vue/component\nexport const DescriptionEditor = {\n\tname: 'TaskDescriptionContent',\n\tcomponents: {\n\t\tBIcon,\n\t\tUiButton,\n\t\tCopilot,\n\t\tAttach,\n\t\tMention,\n\t\tDescriptionTextArea,\n\t},\n\tprops: {\n\t\ttaskId: {\n\t\t\ttype: [Number, String],\n\t\t\trequired: true,\n\t\t},\n\t},\n\temits: ['close', 'show'],\n\tsetup(props): { fileService: FileService, descriptionTextEditor: DescriptionTextEditor }\n\t{\n\t\treturn {\n\t\t\tButtonSize,\n\t\t\tButtonColor,\n\t\t\tOutline,\n\t\t\tfileService: fileService.get(props.taskId),\n\t\t\tdescriptionTextEditor: descriptionTextEditor.get(props.taskId),\n\t\t};\n\t},\n\tcomputed: {\n\t\ttask(): TaskModel\n\t\t{\n\t\t\treturn this.$store.getters[`${Model.Tasks}/getById`](this.taskId);\n\t\t},\n\t\treadonly(): boolean\n\t\t{\n\t\t\treturn !this.task.rights.edit;\n\t\t},\n\t\teditor(): TextEditor\n\t\t{\n\t\t\treturn this.descriptionTextEditor.getEditor();\n\t\t},\n\t},\n\tmounted(): void\n\t{\n\t\tthis.$emit('show');\n\n\t\tif (!Type.isStringFilled(this.task.description) || this.taskId === 0)\n\t\t{\n\t\t\tsetTimeout(this.focusToEnd, 500);\n\t\t}\n\t},\n\tmethods: {\n\t\thandleClose(): void\n\t\t{\n\t\t\tthis.$emit('close');\n\t\t},\n\t\tfocusToEnd(): void\n\t\t{\n\t\t\tthis.editor.focus(null, { defaultSelection: 'rootEnd' });\n\t\t},\n\t\thandleMentionButtonClick(): void\n\t\t{\n\t\t\tthis.editor.focus(\n\t\t\t\t() => {\n\t\t\t\t\tthis.editor.dispatchCommand(\n\t\t\t\t\t\tBX.UI.TextEditor.Plugins.Mention.INSERT_MENTION_DIALOG_COMMAND,\n\t\t\t\t\t);\n\t\t\t\t},\n\t\t\t\t{ defaultSelection: 'rootEnd' },\n\t\t\t);\n\t\t},\n\t\thandleAttachButtonClick(): void\n\t\t{\n\t\t\tthis.fileService.browse({\n\t\t\t\tbindElement: this.$refs.attach.$el,\n\t\t\t\tonHideCallback: this.onFileBrowserClose,\n\t\t\t});\n\t\t},\n\t\tonFileBrowserClose(): void\n\t\t{\n\t\t\tthis.fileService.setFileBrowserClosed(false);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"tasks-card-description-wrapper\" ref=\"wrapper\">\n\t\t\t<div class=\"tasks-card-description-header\" ref=\"descriptionHeader\">\n\t\t\t\t<div class=\"tasks-card-description-title\">\n\t\t\t\t\t{{ loc('TASKS_V2_CHANGE_DESCRIPTION') }}\n\t\t\t\t</div>\n\t\t\t\t<BIcon\n\t\t\t\t\t:name=\"Outline.CROSS_L\"\n\t\t\t\t\t:hoverable=\"true\"\n\t\t\t\t\tclass=\"tasks-card-description-field-icon\"\n\t\t\t\t\t@click=\"handleClose\"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t\t<div class=\"tasks-card-description-editor-wrapper\" id=\"descriptionTextAreaDestination\"/>\n\t\t\t<div v-if=\"!readonly\" class=\"tasks-card-description-footer\" ref=\"descriptionActions\">\n\t\t\t\t<div class=\"tasks-card-description-action-list\">\n\t\t\t\t\t<Copilot />\n\t\t\t\t\t<Attach ref=\"attach\" @click=\"handleAttachButtonClick\"/>\n\t\t\t\t\t<Mention @click=\"handleMentionButtonClick\"/>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-card-description-footer-buttons\">\n\t\t\t\t\t<UiButton\n\t\t\t\t\t\t:text=\"loc('TASKS_V2_DESCRIPTION_BUTTON_SAVE')\"\n\t\t\t\t\t\t:size=\"ButtonSize.MEDIUM\"\n\t\t\t\t\t\t:color=\"ButtonColor.PRIMARY\"\n\t\t\t\t\t\t@click=\"handleClose\"\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import { BIcon, Outline } from 'ui.icon-set.api.vue';\n\nimport './description.css';\n\n// @vue/component\nexport const MiniFormButton = {\n\tname: 'TaskDescriptionMiniFormButton',\n\tcomponents: {\n\t\tBIcon,\n\t},\n\tprops: {\n\t\tfilesCount: {\n\t\t\ttype: Number,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tsetup(): void\n\t{\n\t\treturn {\n\t\t\tOutline,\n\t\t};\n\t},\n\tcomputed: {\n\t\ticonSize(): number\n\t\t{\n\t\t\treturn 20;\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"tasks-card-change-description-mini-btn\">\n\t\t\t<div class=\"tasks-full-card-field-container --small-vertical-padding\">\n\t\t\t\t<div class=\"tasks-card-change-description\" :class=\"{ '--no-hover': filesCount }\">\n\t\t\t\t\t<template v-if=\"filesCount\">\n\t\t\t\t\t\t<BIcon\n\t\t\t\t\t\t\t:name=\"Outline.ATTACH\"\n\t\t\t\t\t\t\t:size=iconSize\n\t\t\t\t\t\t\tclass=\"tasks-card-description-field-icon-link\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<div class=\"tasks-card-change-description-mini-text-files\">\n\t\t\t\t\t\t\t{{ loc('TASKS_V2_DESCRIPTION_FILES_COUNT', { '#COUNT#': String(filesCount) }) }}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</template>\n\t\t\t\t\t<template v-else>\n\t\t\t\t\t\t<div class=\"tasks-card-change-description-mini-text\">\n\t\t\t\t\t\t\t{{ loc('TASKS_V2_CHANGE_DESCRIPTION') }}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<BIcon\n\t\t\t\t\t\t\t:name=\"Outline.CREATE_CHAT\"\n\t\t\t\t\t\t\t:size=iconSize\n\t\t\t\t\t\t\t:hoverable=\"true\"\n\t\t\t\t\t\t\tclass=\"tasks-card-description-field-icon\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</template>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import { Outline } from 'ui.icon-set.api.core';\n\nimport { ActionButton } from './action-button';\n\n// @vue/component\nexport const FullDescription = {\n\tname: 'TaskFullDescription',\n\tcomponents: {\n\t\tActionButton,\n\t\tOutline,\n\t},\n\tsetup(): Object\n\t{\n\t\treturn {\n\t\t\tOutline,\n\t\t};\n\t},\n\ttemplate: `\n\t\t<ActionButton\n\t\t\t:icon-name=\"Outline.GO_TO_L\"\n\t\t\t:title=\"loc('TASKS_V2_DESCRIPTION_BUTTON_EXPAND')\"\n\t\t/>\n\t`,\n};\n","import { Runtime, Event, Type } from 'main.core';\nimport { Outline } from 'ui.icon-set.api.vue';\nimport { TextEditor, TextEditorComponent } from 'ui.text-editor';\n\nimport { TaskModel } from 'tasks.v2.model.tasks';\nimport { Model } from 'tasks.v2.const';\nimport { taskService } from 'tasks.v2.provider.service.task-service';\nimport { fileService, type FileService } from 'tasks.v2.provider.service.file-service';\nimport { descriptionTextEditor, type DescriptionTextEditor } from './description-text-editor';\n\nimport { DescriptionTextArea } from './description-text-area';\nimport { Copilot } from './actions/copilot';\nimport { Attach } from './actions/attach';\nimport { Mention } from './actions/mention';\nimport { FullDescription } from './actions/full-description';\n\nimport './description.css';\n\n// @vue/component\nexport const MiniForm = {\n\tname: 'TaskDescriptionMiniForm',\n\tcomponents: {\n\t\tTextEditorComponent,\n\t\tCopilot,\n\t\tAttach,\n\t\tMention,\n\t\tFullDescription,\n\t\tDescriptionTextArea,\n\t},\n\tprops: {\n\t\ttaskId: {\n\t\t\ttype: [Number, String],\n\t\t\trequired: true,\n\t\t},\n\t\tisSlotShown: {\n\t\t\ttype: Boolean,\n\t\t\trequired: true,\n\t\t},\n\t},\n\temits: ['expand', 'closeEdit'],\n\tsetup(props): { fileService: FileService, descriptionTextEditor: DescriptionTextEditor }\n\t{\n\t\treturn {\n\t\t\tOutline,\n\t\t\tfileService: fileService.get(props.taskId),\n\t\t\tdescriptionTextEditor: descriptionTextEditor.get(props.taskId),\n\t\t};\n\t},\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tisNeedTeleport: false,\n\t\t\thasChanges: false,\n\t\t\tclosed: false,\n\t\t};\n\t},\n\tcomputed: {\n\t\ttask(): TaskModel\n\t\t{\n\t\t\treturn this.$store.getters[`${Model.Tasks}/getById`](this.taskId);\n\t\t},\n\t\ttaskDescription(): string\n\t\t{\n\t\t\treturn this.task.description ?? '';\n\t\t},\n\t\teditor(): TextEditor\n\t\t{\n\t\t\treturn this.descriptionTextEditor.getEditor();\n\t\t},\n\t},\n\twatch: {\n\t\tisSlotShown(newValue): void\n\t\t{\n\t\t\tthis.handleTeleport(newValue);\n\t\t},\n\t},\n\tasync created(): Promise<void>\n\t{\n\t\tthis.saveDebounced = Runtime.debounce(this.handleSave, 30000, this);\n\n\t\tEvent.bind(window, 'beforeunload', this.handleSave);\n\t},\n\tmounted(): void\n\t{\n\t\tif (!Type.isStringFilled(this.taskDescription))\n\t\t{\n\t\t\tthis.focusToEnd();\n\t\t}\n\t},\n\tasync beforeUnmount(): Promise<void>\n\t{\n\t\tEvent.unbind(window, 'beforeunload', this.handleSave);\n\n\t\tawait this.handleSave();\n\n\t\tthis.closed = true;\n\t},\n\tmethods: {\n\t\tfocusToEnd(): void\n\t\t{\n\t\t\tthis.editor.focus(null, { defaultSelection: 'rootEnd' });\n\t\t},\n\t\thandleExpand(): void\n\t\t{\n\t\t\tthis.$emit('expand');\n\t\t},\n\t\thandleMentionButtonClick(): void\n\t\t{\n\t\t\tthis.editor.focus(\n\t\t\t\t() => {\n\t\t\t\t\tthis.editor.dispatchCommand(\n\t\t\t\t\t\tBX.UI.TextEditor.Plugins.Mention.INSERT_MENTION_DIALOG_COMMAND,\n\t\t\t\t\t);\n\t\t\t\t},\n\t\t\t\t{ defaultSelection: 'rootEnd' },\n\t\t\t);\n\t\t},\n\t\thandleAttachButtonClick(): void\n\t\t{\n\t\t\tthis.fileService.browse({\n\t\t\t\tbindElement: this.$refs.attach.$el,\n\t\t\t\tonHideCallback: this.onFileBrowserClose,\n\t\t\t});\n\t\t},\n\t\thandleEditorChange(): void\n\t\t{\n\t\t\tthis.hasChanges = this.taskDescription !== this.getEditorText();\n\n\t\t\tvoid this.saveDebounced();\n\t\t},\n\t\tasync handleAddButtonClick(): Promise<void>\n\t\t{\n\t\t\tawait this.save();\n\t\t},\n\t\tgetEditorText(): string | null\n\t\t{\n\t\t\treturn this.editor?.getText()\n\t\t\t\t.replaceAll(/\\[p]\\n|\\[p]\\[\\/p]|\\[\\/p]/gi, '')\n\t\t\t\t.trim()\n\t\t\t;\n\t\t},\n\t\tasync handleSave(): Promise<void>\n\t\t{\n\t\t\tif (this.closed || !this.hasChanges || !this.editor)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tawait this.save();\n\n\t\t\tthis.hasChanges = false;\n\t\t},\n\t\tasync save(): Promise<void>\n\t\t{\n\t\t\tawait taskService.update(\n\t\t\t\tthis.taskId,\n\t\t\t\t{ description: this.editor.getText() },\n\t\t\t);\n\t\t},\n\t\thandleTeleport(isSlotShown): void\n\t\t{\n\t\t\tif (isSlotShown === true)\n\t\t\t{\n\t\t\t\tsetTimeout(() => {\n\t\t\t\t\tthis.isNeedTeleport = true;\n\t\t\t\t}, 100);\n\n\t\t\t\tthis.editor.setVisualOptions({ blockSpaceInline: 0 });\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.isNeedTeleport = false;\n\t\t\t\tthis.editor.setMaxHeight(null);\n\t\t\t\tthis.editor.setVisualOptions({ blockSpaceInline: 'var(--ui-space-stack-md2)' });\n\t\t\t}\n\t\t},\n\t\tonFileBrowserClose(): void\n\t\t{\n\t\t\tthis.fileService.setFileBrowserClosed(false);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"tasks-card-change-description-mini-container\">\n\t\t\t<div\n\t\t\t\tclass=\"tasks-full-card-field-container --description-preview\"\n\t\t\t\tref=\"container\"\n\t\t\t\ttabindex=\"-1\"\n\t\t\t>\n\t\t\t\t<Teleport :to=\"isNeedTeleport ? '#descriptionTextAreaDestination' : undefined\" :disabled=\"!isNeedTeleport\">\n\t\t\t\t\t<DescriptionTextArea\n\t\t\t\t\t\t:taskId=\"taskId\"\n\t\t\t\t\t\tref=\"descriptionTextArea\"\n\t\t\t\t\t\t@change=\"handleEditorChange\"\n\t\t\t\t\t\t@filesChange=\"handleEditorChange\"\n\t\t\t\t\t/>\n\t\t\t\t</Teleport>\n\t\t\t\t<div class=\"tasks-card-description-footer-container\">\n\t\t\t\t\t<div class=\"tasks-card-description-footer\">\n\t\t\t\t\t\t<div class=\"tasks-card-description-action-list\">\n\t\t\t\t\t\t\t<Copilot />\n\t\t\t\t\t\t\t<Attach ref=\"attach\" @click=\"handleAttachButtonClick\"/>\n\t\t\t\t\t\t\t<Mention @click=\"handleMentionButtonClick\"/>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div\n\t\t\t\t\t\t\tclass=\"tasks-card-description-footer-buttons\"\n\t\t\t\t\t\t\tref=\"fullDescriptionArea\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<FullDescription @click=\"handleExpand\"/>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import { Dom, Type } from 'main.core';\nimport { HtmlFormatterComponent } from 'ui.bbcode.formatter.html-formatter';\nimport { BIcon } from 'ui.icon-set.api.vue';\nimport { Outline } from 'ui.icon-set.api.core';\nimport type { VueUploaderAdapter } from 'ui.uploader.vue';\nimport 'ui.icon-set.outline';\n\nimport type { UserFieldWidgetOptions } from 'disk.uploader.user-field-widget';\nimport { UserFieldWidgetComponent } from 'disk.uploader.user-field-widget';\n\nimport { Model } from 'tasks.v2.const';\nimport { fileService } from 'tasks.v2.provider.service.file-service';\nimport type { TaskModel } from 'tasks.v2.model.tasks';\n\nimport './description.css';\n\n// @vue/component\nexport const DescriptionPreview = {\n\tname: 'TaskDescriptionPreview',\n\tcomponents: {\n\t\tUserFieldWidgetComponent,\n\t\tHtmlFormatterComponent,\n\t\tBIcon,\n\t},\n\tprops: {\n\t\ttaskId: {\n\t\t\ttype: [Number, String],\n\t\t\trequired: true,\n\t\t},\n\t\tfiles: {\n\t\t\ttype: Array,\n\t\t\trequired: true,\n\t\t},\n\t\tfilesCount: {\n\t\t\ttype: Number,\n\t\t\trequired: true,\n\t\t},\n\t\tisMiniFormShown: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t},\n\temits: ['previewButtonClick'],\n\tsetup(props): { uploaderAdapter: VueUploaderAdapter }\n\t{\n\t\treturn {\n\t\t\tBIcon,\n\t\t\tOutline,\n\t\t\tuploaderAdapter: fileService.get(props.taskId).getAdapter(),\n\t\t};\n\t},\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tisOverflowing: false,\n\t\t\topened: false,\n\t\t\tisMouseDown: false,\n\t\t\tselectionMade: false,\n\t\t\tshowRightShadow: null,\n\t\t};\n\t},\n\tcomputed: {\n\t\ttask(): TaskModel\n\t\t{\n\t\t\treturn this.$store.getters[`${Model.Tasks}/getById`](this.taskId);\n\t\t},\n\t\ttaskDescription(): string\n\t\t{\n\t\t\treturn this.task.description ?? '';\n\t\t},\n\t\treadonly(): boolean\n\t\t{\n\t\t\treturn !this.task.rights.edit;\n\t\t},\n\t\tisEdit(): boolean\n\t\t{\n\t\t\treturn Type.isNumber(this.taskId) && this.taskId > 0;\n\t\t},\n\t\twidgetOptions(): UserFieldWidgetOptions\n\t\t{\n\t\t\treturn {\n\t\t\t\tisEmbedded: true,\n\t\t\t\twithControlPanel: false,\n\t\t\t\tcanCreateDocuments: false,\n\t\t\t\ttileWidgetOptions: {\n\t\t\t\t\tcompact: true,\n\t\t\t\t\thideDropArea: true,\n\t\t\t\t\treadonly: this.readonly,\n\t\t\t\t\tenableDropzone: false,\n\t\t\t\t\tautoCollapse: false,\n\t\t\t\t\tremoveFromServer: !this.isEdit,\n\t\t\t\t},\n\t\t\t};\n\t\t},\n\t\thidden(): boolean\n\t\t{\n\t\t\tif (this.opened)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\treturn this.filesCount || this.isOverflowing;\n\t\t},\n\t\ticonSize(): number\n\t\t{\n\t\t\treturn 20;\n\t\t},\n\t},\n\twatch: {\n\t\tasync taskDescription(): void\n\t\t{\n\t\t\tawait this.$nextTick();\n\n\t\t\tthis.updateIsOverflowing();\n\t\t},\n\t},\n\tasync mounted(): Promise<void>\n\t{\n\t\tsetTimeout(this.updateIsOverflowing, 400);\n\n\t\tif (this.isMiniFormShown)\n\t\t{\n\t\t\tthis.openPreview();\n\t\t}\n\t},\n\tmethods: {\n\t\tupdateIsOverflowing(): void\n\t\t{\n\t\t\tif (this.opened || !this.$refs.htmlFormatter)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.showRightShadow = this.$refs.htmlFormatter.$el.offsetHeight < 50;\n\t\t\tthis.isOverflowing = this.$refs.preview.offsetHeight - 20 < this.$refs.htmlFormatter.$el.offsetHeight;\n\t\t},\n\t\tonPreviewClick(): void\n\t\t{\n\t\t\tif (this.readonly && this.hidden)\n\t\t\t{\n\t\t\t\tthis.openPreview();\n\t\t\t}\n\n\t\t\tif (!this.readonly)\n\t\t\t{\n\t\t\t\tthis.$emit('previewButtonClick', { doOpenInEditMode: false });\n\t\t\t}\n\t\t},\n\t\topenPreview(): void\n\t\t{\n\t\t\tif (this.$refs.htmlFormatter)\n\t\t\t{\n\t\t\t\tDom.style(this.$refs.preview, 'maxHeight', `${this.$refs.htmlFormatter.$el.offsetHeight + 32}px`);\n\t\t\t}\n\n\t\t\tthis.opened = true;\n\t\t},\n\t\tonHideClick(): void\n\t\t{\n\t\t\tDom.style(this.$refs.preview, 'maxHeight', '120px');\n\n\t\t\tthis.opened = false;\n\t\t},\n\t\tonMouseDown(event): void\n\t\t{\n\t\t\tif (event.button === 0)\n\t\t\t{\n\t\t\t\tthis.isMouseDown = true;\n\t\t\t\tthis.selectionMade = false;\n\t\t\t}\n\t\t},\n\t\tonMouseMove(): void\n\t\t{\n\t\t\tif (this.selectionMade)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (this.isMouseDown)\n\t\t\t{\n\t\t\t\tconst selection = window.getSelection();\n\t\t\t\tif (selection.toString().length > 0)\n\t\t\t\t{\n\t\t\t\t\tthis.selectionMade = true;\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\tonMouseUp(): void\n\t\t{\n\t\t\tthis.isMouseDown = false;\n\t\t\tif (!this.selectionMade)\n\t\t\t{\n\t\t\t\tthis.onPreviewClick();\n\t\t\t}\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"tasks-full-card-field-container\">\n\t\t\t<div\n\t\t\t\tv-if=\"taskDescription.length > 0\"\n\t\t\t\tclass=\"tasks-card-description-preview\"\n\t\t\t\tref=\"preview\"\n\t\t\t>\n\t\t\t\t<HtmlFormatterComponent\n\t\t\t\t\t:bbcode=\"taskDescription\"\n\t\t\t\t\t:options=\"{ fileMode: 'disk' }\"\n\t\t\t\t\t:formatData=\"{ files }\"\n\t\t\t\t\tref=\"htmlFormatter\"\n\t\t\t\t\t@mousedown=\"onMouseDown\"\n\t\t\t\t\t@mousemove=\"onMouseMove\"\n\t\t\t\t\t@mouseup=\"onMouseUp\"\n\t\t\t\t/>\n\t\t\t\t<template v-if=\"hidden\">\n\t\t\t\t\t<div class=\"tasks-card-description-shadow\">\n\t\t\t\t\t\t<div v-if=\"showRightShadow === true\" class=\"tasks-card-description-shadow-white-right\"/>\n\t\t\t\t\t\t<div v-else-if=\"showRightShadow === false\" class=\"tasks-card-description-shadow-white-bottom\"/>\n\t\t\t\t\t</div>\n\t\t\t\t</template>\n\t\t\t\t<div\n\t\t\t\t\tv-if=\"hidden\"\n\t\t\t\t\tclass=\"tasks-card-description-preview-button\"\n\t\t\t\t\t:style=\"{ 'bottom': showRightShadow ? '16px' : '12px' }\"\n\t\t\t\t\t@click=\"onPreviewClick\"\n\t\t\t\t>\n\t\t\t\t\t<span class=\"tasks-card-description-preview-button-files\" v-if=\"filesCount\">\n\t\t\t\t\t\t<BIcon\n\t\t\t\t\t\t\t:name=\"Outline.ATTACH\"\n\t\t\t\t\t\t\t:size=\"iconSize\"\n\t\t\t\t\t\t\tclass=\"tasks-card-description-field-icon-link\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<span class=\"tasks-card-description-preview-button-text\">\n\t\t\t\t\t\t\t{{ filesCount }}\n\t\t\t\t\t\t</span>\n\t\t\t\t\t</span>\n\t\t\t\t\t<span v-if=\"isOverflowing\" class=\"tasks-card-description-preview-button-text\">\n\t\t\t\t\t\t{{ loc('TASKS_V2_DESCRIPTION_PREVIEW_BUTTON_MORE') }}\n\t\t\t\t\t</span>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div\n\t\t\t\tv-if=\"opened && filesCount\"\n\t\t\t\tclass=\"tasks-card-description-editor-files --read-only\"\n\t\t\t\t:class=\"{ '--with-description': taskDescription.length > 0 }\"\n\t\t\t\tref=\"filesWrapper\"\n\t\t\t>\n\t\t\t\t<UserFieldWidgetComponent\n\t\t\t\t\t:uploaderAdapter=\"uploaderAdapter\"\n\t\t\t\t\t:widgetOptions=\"widgetOptions\"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t\t<div\n\t\t\t\tv-if=\"opened && !isMiniFormShown\"\n\t\t\t\tclass=\"tasks-card-description-preview-button --hide\"\n\t\t\t\t@click=\"onHideClick\"\n\t\t\t>\n\t\t\t\t<div class=\"tasks-card-description-preview-button-more\">\n\t\t\t\t\t<span class=\"tasks-card-description-preview-button-text\">\n\t\t\t\t\t\t{{ loc('TASKS_V2_DESCRIPTION_BUTTON_COLLAPSE') }}\n\t\t\t\t\t</span>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import { Type } from 'main.core';\n\nimport type { VueUploaderAdapter } from 'ui.uploader.vue';\n\nimport { TaskModel } from 'tasks.v2.model.tasks';\nimport { Model } from 'tasks.v2.const';\nimport { fileService } from 'tasks.v2.provider.service.file-service';\nimport type { FileService } from 'tasks.v2.provider.service.file-service';\n\nimport { MiniFormButton } from './mini-form-button.js';\nimport { MiniForm } from './mini-form.js';\nimport { DescriptionPreview } from './description-preview';\n\nimport './description.css';\n\n// @vue/component\nexport const DescriptionField = {\n\tname: 'TaskDescriptionField',\n\tcomponents: {\n\t\tMiniFormButton,\n\t\tMiniForm,\n\t\tDescriptionPreview,\n\t},\n\tprops: {\n\t\ttaskId: {\n\t\t\ttype: [Number, String],\n\t\t\trequired: true,\n\t\t},\n\t},\n\tsetup(props): { fileService: FileService, uploaderAdapter: VueUploaderAdapter }\n\t{\n\t\treturn {\n\t\t\tfileService: fileService.get(props.taskId),\n\t\t\tuploaderAdapter: fileService.get(props.taskId).getAdapter(),\n\t\t};\n\t},\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tisMiniFormShown: false,\n\t\t\tisSlotShown: false,\n\t\t\tdoOpenInEditMode: false,\n\t\t\tfiles: this.fileService.getFiles(),\n\t\t};\n\t},\n\tcomputed: {\n\t\ttask(): TaskModel\n\t\t{\n\t\t\treturn this.$store.getters[`${Model.Tasks}/getById`](this.taskId);\n\t\t},\n\t\tisEdit(): boolean\n\t\t{\n\t\t\treturn Type.isNumber(this.taskId) && this.taskId > 0;\n\t\t},\n\t\treadonly(): boolean\n\t\t{\n\t\t\treturn !this.task.rights.edit;\n\t\t},\n\t\tfilesCount(): number\n\t\t{\n\t\t\treturn this.files.length;\n\t\t},\n\t},\n\tmethods: {\n\t\topenSlotInEditMode(): void\n\t\t{\n\t\t\tthis.doOpenInEditMode = true;\n\t\t\tthis.isSlotShown = true;\n\t\t},\n\t\tcloseMiniForm(): void\n\t\t{\n\t\t\tthis.isMiniFormShown = false;\n\t\t},\n\t\tonPreviewButtonClick(eventData): void\n\t\t{\n\t\t\tthis.doOpenInEditMode = eventData.doOpenInEditMode === true;\n\t\t\tthis.isMiniFormShown = true;\n\t\t},\n\t\tcloseSlot(): void\n\t\t{\n\t\t\tthis.isSlotShown = false;\n\t\t},\n\t\tasync save(): Promise<void>\n\t\t{\n\t\t\tawait this.$refs?.miniForm?.handleAddButtonClick();\n\t\t},\n\t},\n\ttemplate: `\n\t\t<slot\n\t\t\t:isShown=\"isSlotShown\"\n\t\t\t:doOpenInEditMode=\"doOpenInEditMode\"\n\t\t\t:close=\"closeSlot\"\n\t\t/>\n\t\t<div\n\t\t\tv-if=\"!readonly || task.description.length > 0 || filesCount > 0\"\n\t\t\tclass=\"tasks-card-description-field\"\n\t\t\t:data-task-id=\"taskId\"\n\t\t\t:data-task-field-id=\"'description'\"\n\t\t>\n\t\t\t<MiniFormButton\n\t\t\t\tv-if=\"(task.description.length === 0) && !isMiniFormShown\"\n\t\t\t\t:filesCount=\"filesCount\"\n\t\t\t\t@click=\"isMiniFormShown = true\"\n\t\t\t/>\n\t\t\t<MiniForm\n\t\t\t\tv-else-if=\"!readonly && (isMiniFormShown || (task.description.length > 0 && !isEdit))\"\n\t\t\t\t:taskId=\"taskId\"\n\t\t\t\t:isSlotShown=\"isSlotShown\"\n\t\t\t\t@expand=\"openSlotInEditMode\"\n\t\t\t\t@closeEdit=\"closeMiniForm\"\n\t\t\t\tref=\"miniForm\"\n\t\t\t/>\n\t\t\t<DescriptionPreview\n\t\t\t\tv-else-if=\"isMiniFormShown || isEdit\"\n\t\t\t\t:taskId=\"taskId\"\n\t\t\t\t:files=\"files\"\n\t\t\t\t:filesCount=\"filesCount\"\n\t\t\t\t:isMiniFormShown=\"isMiniFormShown\"\n\t\t\t\t@previewButtonClick=\"onPreviewButtonClick\"\n\t\t\t/>\n\t\t</div>\n\t`,\n};\n","import { mapGetters } from 'ui.vue3.vuex';\nimport { BottomSheet } from 'tasks.v2.component.elements.bottom-sheet';\nimport { Model } from 'tasks.v2.const';\nimport { DropZone } from 'tasks.v2.component.drop-zone';\n\nimport { DescriptionEditor } from './description-editor';\n\nimport './description.css';\n\n// @vue/component\nexport const DescriptionSheet = {\n\tname: 'TaskDescriptionSheet',\n\tcomponents: {\n\t\tBottomSheet,\n\t\tDescriptionEditor,\n\t\tDropZone,\n\t},\n\tprops: {\n\t\ttaskId: {\n\t\t\ttype: [Number, String],\n\t\t\trequired: true,\n\t\t},\n\t\tisShown: {\n\t\t\ttype: Boolean,\n\t\t\trequired: true,\n\t\t},\n\t\tdoOpenInEditMode: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t\tgetBindElement: {\n\t\t\ttype: Function,\n\t\t\tdefault: null,\n\t\t},\n\t\tgetTargetContainer: {\n\t\t\ttype: Function,\n\t\t\tdefault: null,\n\t\t},\n\t},\n\temits: ['show', 'close'],\n\tcomputed: {\n\t\t...mapGetters({\n\t\t\ttitleFieldOffsetHeight: `${Model.Interface}/titleFieldOffsetHeight`,\n\t\t}),\n\t},\n\twatch: {\n\t\ttitleFieldOffsetHeight(): void\n\t\t{\n\t\t\tthis.$refs.bottomSheet?.adjustPosition();\n\t\t},\n\t},\n\tmethods: {\n\t\thandleShow(): void\n\t\t{\n\t\t\tthis.$emit('show');\n\t\t},\n\t},\n\ttemplate: `\n\t\t<BottomSheet\n\t\t\tv-if=\"isShown\"\n\t\t\t:isExpanded=\"true\"\n\t\t\t:getBindElement=\"getBindElement\"\n\t\t\t:getTargetContainer=\"getTargetContainer\"\n\t\t\tref=\"bottomSheet\"\n\t\t>\n\t\t\t<DescriptionEditor\n\t\t\t\tref=\"editorComponent\"\n\t\t\t\t:taskId=\"taskId\"\n\t\t\t\t:doOpenInEditMode=\"doOpenInEditMode\"\n\t\t\t\t:isExpanded=\"true\"\n\t\t\t\t@show=\"handleShow\"\n\t\t\t\t@close=\"$emit('close')\"\n\t\t\t/>\n\t\t\t<DropZone :taskId=\"taskId\"/>\n\t\t</BottomSheet>\n\t`,\n};\n","import { Dom, Event } from 'main.core';\nimport type { PopupOptions } from 'main.popup';\n\nimport { Popup } from 'ui.vue3.components.popup';\nimport { mapGetters } from 'ui.vue3.vuex';\n\nimport { Model } from 'tasks.v2.const';\nimport { TaskModel } from 'tasks.v2.model.tasks';\nimport { DescriptionEditor } from './description-editor';\n\nimport './description.css';\n\n// @vue/component\nexport const DescriptionPopup = {\n\tname: 'TaskDescriptionPopup',\n\tcomponents: {\n\t\tPopup,\n\t\tDescriptionEditor,\n\t},\n\tprops: {\n\t\ttaskId: {\n\t\t\ttype: [Number, String],\n\t\t\trequired: true,\n\t\t},\n\t\tisShown: {\n\t\t\ttype: Boolean,\n\t\t\trequired: true,\n\t\t},\n\t\tdoOpenInEditMode: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t},\n\temits: ['show', 'close', 'resize'],\n\tsetup(): Object\n\t{\n\t\treturn {\n\t\t\tresizeObserver: null,\n\t\t};\n\t},\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tpopupHeight: 0,\n\t\t};\n\t},\n\tcomputed: {\n\t\tpopupId(): string\n\t\t{\n\t\t\treturn `tasks-field-description-popup-${this.taskId}`;\n\t\t},\n\t\tpopupOptions(): PopupOptions\n\t\t{\n\t\t\treturn {\n\t\t\t\tclassName: 'tasks-card-description-popup',\n\t\t\t\tminHeight: 360,\n\t\t\t\tmaxHeight: this.popupMaxHeight,\n\t\t\t\twidth: 580,\n\t\t\t\toffsetTop: 0,\n\t\t\t\tpadding: 0,\n\t\t\t\tautoHide: false,\n\t\t\t\tcloseByEsc: false,\n\t\t\t\tanimation: {\n\t\t\t\t\tshowClassName: 'tasks-description-popup-show',\n\t\t\t\t\tcloseClassName: 'tasks-description-popup-close',\n\t\t\t\t\tcloseAnimationType: 'animation',\n\t\t\t\t},\n\t\t\t\tevents: {\n\t\t\t\t\tonAfterShow: () => this.$refs.editorComponent.focusToEnd(),\n\t\t\t\t},\n\t\t\t};\n\t\t},\n\t\tpopupMaxHeight(): number\n\t\t{\n\t\t\treturn document.body.offsetHeight - 120 - this.titleFieldOffsetHeight;\n\t\t},\n\t\ttask(): TaskModel\n\t\t{\n\t\t\treturn this.$store.getters[`${Model.Tasks}/getById`](this.taskId);\n\t\t},\n\t\t...mapGetters({\n\t\t\ttitleFieldOffsetHeight: `${Model.Interface}/titleFieldOffsetHeight`,\n\t\t}),\n\t},\n\twatch: {\n\t\tasync titleFieldOffsetHeight(): Promise<void>\n\t\t{\n\t\t\tif (!this.$refs.popupComponent)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.resizeEditor();\n\t\t\tawait this.$nextTick();\n\t\t\tthis.onResize();\n\t\t},\n\t},\n\tcreated(): void\n\t{\n\t\tthis.resizeObserver = new ResizeObserver((entries) => {\n\t\t\tfor (const entry of entries)\n\t\t\t{\n\t\t\t\tif (entry.target === this.$refs.popupWrapper)\n\t\t\t\t{\n\t\t\t\t\tthis.onResize();\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t},\n\tmounted(): void\n\t{\n\t\tEvent.bind(window, 'resize', this.onResize);\n\t},\n\tbeforeUnmount(): void\n\t{\n\t\tEvent.unbind(window, 'resize', this.onResize);\n\t},\n\tmethods: {\n\t\tonShow(): void\n\t\t{\n\t\t\tthis.resizeEditor();\n\t\t\tthis.$emit('show', { popupInstance: this.$refs.popupComponent.getPopupInstance() });\n\t\t\tthis.$refs.popupComponent?.getPopupInstance().adjustPosition();\n\t\t\tsetTimeout(() => this.resizeObserver.observe(this.$refs.popupWrapper), 300);\n\t\t},\n\t\tresizeEditor(): void\n\t\t{\n\t\t\tconst popupInstance = this.$refs.popupComponent?.getPopupInstance();\n\t\t\tconst popupContainer = popupInstance.getPopupContainer();\n\t\t\tthis.$refs.editorComponent.hideEditor();\n\t\t\tDom.style(popupContainer, 'min-height', 0);\n\t\t\tconst popupWithoutEditorHeight = popupContainer.clientHeight;\n\t\t\tconst additionalOffset = 240;\n\t\t\tconst maxHeight = document.body.clientHeight\n\t\t\t\t- popupWithoutEditorHeight\n\t\t\t\t- additionalOffset\n\t\t\t\t- this.titleFieldOffsetHeight\n\t\t\t;\n\t\t\tDom.style(popupContainer, 'min-height', '360px');\n\t\t\tthis.$refs.editorComponent.showEditor();\n\n\t\t\tthis.$refs.editorComponent.setMaxHeight(maxHeight);\n\n\t\t\tpopupInstance.setOffset();\n\t\t},\n\t\tonResize(): void\n\t\t{\n\t\t\tconst popupInstance = this.$refs.popupComponent?.getPopupInstance();\n\t\t\tif (popupInstance)\n\t\t\t{\n\t\t\t\tthis.$emit('resize');\n\t\t\t\tpopupInstance.adjustPosition();\n\t\t\t}\n\t\t},\n\t\tonClose(): void\n\t\t{\n\t\t\tthis.resizeObserver.disconnect();\n\t\t\tthis.$emit('close');\n\t\t},\n\t},\n\ttemplate: `\n\t\t<Popup v-if=\"isShown\" :options=\"popupOptions\" ref=\"popupComponent\">\n\t\t\t<div class=\"tasks-card-description-popup-wrapper\" ref=\"popupWrapper\">\n\t\t\t\t<DescriptionEditor\n\t\t\t\t\tref=\"editorComponent\"\n\t\t\t\t\t:taskId=\"taskId\"\n\t\t\t\t\t:doOpenInEditMode=\"doOpenInEditMode\"\n\t\t\t\t\t@show=\"onShow\"\n\t\t\t\t\t@close=\"onClose\"\n\t\t\t\t></DescriptionEditor>\n\t\t\t</div>\n\t\t</Popup>\n\t`,\n};\n","import { Event } from 'main.core';\nimport type { TextEditorOptions } from 'ui.text-editor';\nimport { TextEditor, TextEditorComponent } from 'ui.text-editor';\n\nimport { TaskModel } from 'tasks.v2.model.tasks';\nimport { Model } from 'tasks.v2.const';\nimport { taskService } from 'tasks.v2.provider.service.task-service';\nimport { type FileService, fileService } from 'tasks.v2.provider.service.file-service';\n\nimport { DefaultEditorOptions } from './default-editor-options';\n\nimport './description.css';\n\n// @vue/component\nexport const DescriptionInline = {\n\tname: 'TaskDescriptionInline',\n\tcomponents: {\n\t\tTextEditorComponent,\n\t},\n\tprops: {\n\t\ttaskId: {\n\t\t\ttype: [Number, String],\n\t\t\trequired: true,\n\t\t},\n\t},\n\tsetup(): Object\n\t{\n\t\treturn {\n\t\t\teditor: null,\n\t\t\tDefaultEditorOptions,\n\t\t};\n\t},\n\tdata(props): { filesService: FileService }\n\t{\n\t\treturn {\n\t\t\tisFocused: false,\n\t\t\tisScrolledToTop: true,\n\t\t\tisScrolledToBottom: true,\n\t\t\tfileService: fileService.get(props.taskId),\n\t\t};\n\t},\n\tcomputed: {\n\t\ttask(): TaskModel\n\t\t{\n\t\t\treturn this.$store.getters[`${Model.Tasks}/getById`](this.taskId);\n\t\t},\n\t\ttaskDescription(): string\n\t\t{\n\t\t\treturn this.task.description;\n\t\t},\n\t},\n\tcreated(): void\n\t{\n\t\tconst additionalEditorOptions: TextEditorOptions = {\n\t\t\tminHeight: 20,\n\t\t\tmaxHeight: 112,\n\t\t\tplaceholder: this.loc('TASKS_V2_DESCRIPTION_INLINE_EDITOR_PLACEHOLDER'),\n\t\t\tcontent: this.taskDescription,\n\t\t\tnewLineMode: 'paragraph',\n\t\t\tevents: {\n\t\t\t\tonFocus: this.handleEditorFocus,\n\t\t\t\tonBlur: this.handleEditorBlur,\n\t\t\t\tonChange: this.handleEditorChange,\n\t\t\t},\n\t\t};\n\n\t\tthis.editor = new TextEditor({ ...DefaultEditorOptions, ...additionalEditorOptions });\n\t},\n\tmounted(): void\n\t{\n\t\tEvent.bind(this.editor.getScrollerContainer(), 'scroll', this.handleScroll);\n\n\t\tthis.fileService.getAdapter().getUploader().assignPaste(this.$refs.description);\n\t},\n\tbeforeUnmount(): void\n\t{\n\t\tEvent.unbind(this.editor.getScrollerContainer(), 'scroll', this.handleScroll);\n\n\t\tthis.fileService.getAdapter().getUploader().unassignPaste(this.$refs.description);\n\t},\n\tmethods: {\n\t\thasScroll(): boolean\n\t\t{\n\t\t\treturn !this.isScrolledToTop || !this.isScrolledToBottom;\n\t\t},\n\t\tasync handleEditorFocus(): void\n\t\t{\n\t\t\tthis.isFocused = true;\n\t\t},\n\t\tasync handleEditorBlur(): void\n\t\t{\n\t\t\tthis.isFocused = false;\n\n\t\t\tconst description = this.editor.getText();\n\t\t\tvoid taskService.update(\n\t\t\t\tthis.taskId,\n\t\t\t\t{ description },\n\t\t\t);\n\t\t},\n\t\thandleEditorChange(): void\n\t\t{\n\t\t\tthis.handleScroll();\n\t\t},\n\t\thandleScroll(): void\n\t\t{\n\t\t\tconst container = this.editor.getScrollerContainer();\n\t\t\tthis.isScrolledToTop = container.scrollTop === 0;\n\t\t\tthis.isScrolledToBottom = container.scrollTop + container.clientHeight >= container.scrollHeight - 5;\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div\n\t\t\tclass=\"tasks-card-description-inline\"\n\t\t\t:class=\"{ '--bottom-shadow': !isScrolledToBottom, '--top-shadow': !isScrolledToTop }\"\n\t\t\t:data-task-id=\"taskId\"\n\t\t\t:data-task-field-id=\"'description'\"\n\t\t\tref=\"description\"\n\t\t>\n\t\t\t<div class=\"tasks-card-description-inline-shadow --revert\" :class=\"{'--shown': !isScrolledToTop}\">\n\t\t\t\t<div class=\"tasks-card-description-inline-shadow-white\"/>\n\t\t\t\t<div class=\"tasks-card-description-inline-shadow-black\"/>\n\t\t\t</div>\n\t\t\t<TextEditorComponent :editorInstance=\"editor\"/>\n\t\t\t<div class=\"tasks-card-description-inline-shadow\" :class=\"{'--shown': !isScrolledToBottom}\">\n\t\t\t\t<div class=\"tasks-card-description-inline-shadow-white\"/>\n\t\t\t\t<div class=\"tasks-card-description-inline-shadow-black\"/>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n"],"names":["DefaultEditorOptions","Object","freeze","toolbar","floatingToolbar","removePlugins","visualOptions","borderWidth","blockSpaceInline","colorBackground","mention","dialogOptions","entities","id","EntitySelectorEntity","User","options","emailUsers","inviteEmployeeLink","itemOptions","default","link","linkTitle","StructureNode","selectMode","allowFlatDepartments","copilot","copilotOptions","paragraphPlaceholder","DescriptionTextEditor","EventEmitter","constructor","taskId","onFileComplete","event","file","getData","dispatchCommand","Plugins","File","ADD_FILE_COMMAND","emit","onFileRemove","handleRemoveFile","serverFileId","handleEditorChange","setEventNamespace","initService","initEditor","Runtime","debounce","getEditor","fileService","get","getAdapter","content","initDescription","additionalEditorOptions","minHeight","placeholder","Loc","getMessage","newLineMode","events","onChange","mode","files","getFiles","TextEditor","originalDescription","Type","isStringFilled","mapping","getTempToServerFileIdMap","changedDescription","replaceAll","match","prefix","nId","undefined","fields","description","$store","dispatch","Model","Tasks","setEditorText","text","setText","getItems","filesMap","forEach","key","customData","objectId","destroy","REMOVE_FILE_COMMAND","skipHistoryStack","insertFile","fileInfo","INSERT_FILE_COMMAND","width","height","info","inline","Core","getStore","subscribe","unsubscribe","registerCommand","PASTE_COMMAND","clipboardEvent","clipboardData","isFilePasted","preventDefault","getFilesFromDataTransfer","then","getUploader","addFile","FileEvent","LOAD_ERROR","UPLOAD_ERROR","UPLOAD_COMPLETE","uploaderFile","getTarget","toJSON","catch","console","error","COMMAND_PRIORITY_NORMAL","GET_INSERTED_FILES_COMMAND","nodes","inserted","Set","node","getInfo","isNumber","add","has","getServerFileId","setCustomData","delete","instances","descriptionTextEditor","replace","tempId","DescriptionTextArea","name","components","TextEditorComponent","UserFieldWidgetComponent","props","type","Number","String","required","emits","setup","editor","uploaderAdapter","data","computed","task","getters","readonly","rights","edit","isEdit","widgetOptions","isEmbedded","withControlPanel","canCreateDocuments","insertIntoText","tileWidgetOptions","compact","hideDropArea","autoCollapse","removeFromServer","onInsertIntoText","handleInsertFile","filesCount","length","created","mounted","onFileAdd","onEditorChange","unmounted","methods","$emit","item","template","ActionButton","BIcon","directives","hint","title","iconName","iconColor","Outline","tooltip","popupOptions","offsetLeft","$el","offsetWidth","Copilot","buttonColor","handleClick","alert","Attach","Mention","DescriptionEditor","UiButton","ButtonSize","ButtonColor","setTimeout","focusToEnd","handleClose","focus","defaultSelection","handleMentionButtonClick","BX","UI","INSERT_MENTION_DIALOG_COMMAND","handleAttachButtonClick","browse","bindElement","$refs","attach","onHideCallback","onFileBrowserClose","setFileBrowserClosed","MiniFormButton","iconSize","FullDescription","MiniForm","isSlotShown","Boolean","isNeedTeleport","hasChanges","closed","taskDescription","watch","newValue","handleTeleport","saveDebounced","handleSave","Event","bind","window","beforeUnmount","unbind","handleExpand","getEditorText","handleAddButtonClick","save","getText","trim","taskService","update","setVisualOptions","setMaxHeight","DescriptionPreview","HtmlFormatterComponent","Array","isMiniFormShown","isOverflowing","opened","isMouseDown","selectionMade","showRightShadow","enableDropzone","hidden","$nextTick","updateIsOverflowing","openPreview","htmlFormatter","offsetHeight","preview","onPreviewClick","doOpenInEditMode","Dom","style","onHideClick","onMouseDown","button","onMouseMove","selection","getSelection","toString","onMouseUp","DescriptionField","openSlotInEditMode","closeMiniForm","onPreviewButtonClick","eventData","closeSlot","miniForm","DescriptionSheet","BottomSheet","DropZone","isShown","getBindElement","Function","getTargetContainer","mapGetters","titleFieldOffsetHeight","Interface","bottomSheet","adjustPosition","handleShow","DescriptionPopup","Popup","resizeObserver","popupHeight","popupId","className","maxHeight","popupMaxHeight","offsetTop","padding","autoHide","closeByEsc","animation","showClassName","closeClassName","closeAnimationType","onAfterShow","editorComponent","document","body","popupComponent","resizeEditor","onResize","ResizeObserver","entries","entry","target","popupWrapper","onShow","popupInstance","getPopupInstance","observe","popupContainer","getPopupContainer","hideEditor","popupWithoutEditorHeight","clientHeight","additionalOffset","showEditor","setOffset","onClose","disconnect","DescriptionInline","isFocused","isScrolledToTop","isScrolledToBottom","loc","onFocus","handleEditorFocus","onBlur","handleEditorBlur","getScrollerContainer","handleScroll","assignPaste","unassignPaste","hasScroll","container","scrollTop","scrollHeight"],"mappings":"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"}