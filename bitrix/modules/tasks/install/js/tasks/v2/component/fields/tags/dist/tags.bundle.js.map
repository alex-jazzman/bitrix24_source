{"version":3,"file":"tags.bundle.js","sources":["../src/tags-meta.js","../src/tags-dialog.js","../src/tags.js","../src/tags-chip.js"],"sourcesContent":["import { Loc } from 'main.core';\n\nexport const tagsMeta = Object.freeze({\n\tid: 'tags',\n\ttitle: Loc.getMessage('TASKS_V2_TAGS_TITLE'),\n});\n","import type { BaseEvent } from 'main.core.events';\nimport type { Store } from 'ui.vue3.vuex';\nimport type { Item } from 'ui.entity-selector';\n\nimport { Footer } from 'tasks.entity-selector';\nimport { EntitySelectorDialog, type ItemId } from 'tasks.v2.lib.entity-selector-dialog';\nimport { Core } from 'tasks.v2.core';\nimport { EntitySelectorEntity, Model } from 'tasks.v2.const';\nimport { taskService } from 'tasks.v2.provider.service.task-service';\nimport type { TaskModel } from 'tasks.v2.model.tasks';\n\nconst dialogs: { [key: string]: EntitySelectorDialog } = {};\n\nclass TagsDialog\n{\n\t#taskId: number | string;\n\t#onCloseOnce: Function | null = null;\n\t#onUpdateOnce: Function | null = null;\n\n\tsetTaskId(taskId: number | string): TagsDialog\n\t{\n\t\tthis.#taskId = taskId;\n\n\t\treturn this;\n\t}\n\n\tonCloseOnce(callback: Function): TagsDialog\n\t{\n\t\tthis.#onCloseOnce = callback;\n\n\t\treturn this;\n\t}\n\n\tonUpdateOnce(callback: Function): void\n\t{\n\t\tthis.#onUpdateOnce = callback;\n\t}\n\n\tshowTo(targetNode: HTMLElement): void\n\t{\n\t\tconst dialog = this.#getDialog(this.#taskId);\n\t\tif (dialog.isLoaded() && !dialog.isOpen())\n\t\t{\n\t\t\tdialog.selectItemsByIds(this.#getItems(this.#taskId));\n\t\t}\n\t\tdialog.showTo(targetNode);\n\t}\n\n\tupdateItems(): void\n\t{\n\t\tconst dialog = this.#getDialog(this.#taskId);\n\t\tif (dialog.isLoaded() && dialog.isOpen())\n\t\t{\n\t\t\tdialog.selectItemsByIds(this.#getItems(this.#taskId));\n\t\t}\n\t}\n\n\t#getItems(taskId: number | string): ItemId[]\n\t{\n\t\tconst tags = new Set(this.#getTask(taskId).tags);\n\n\t\treturn this.#getDialog(taskId).getItems()\n\t\t\t.filter((item: Item) => tags.has(item.getTitle()))\n\t\t\t.map((item: Item) => [EntitySelectorEntity.Tag, item.getId()])\n\t\t;\n\t}\n\n\t#getDialog(taskId: number | string): EntitySelectorDialog\n\t{\n\t\tconst userId = this.#currentUserId;\n\t\tconst groupId = this.#getTask(taskId).groupId ?? 0;\n\n\t\tconst key = `${taskId}-${groupId}`;\n\t\tif (dialogs[key])\n\t\t{\n\t\t\treturn dialogs[key];\n\t\t}\n\n\t\tlet changed = false;\n\t\tconst handleChanged = (): void => {\n\t\t\tchanged = true;\n\t\t};\n\n\t\tconst handleClose = (): void => {\n\t\t\tif (changed)\n\t\t\t{\n\t\t\t\tvoid this.#updateTask(taskId);\n\n\t\t\t\tchanged = false;\n\t\t\t}\n\n\t\t\tthis.#onCloseOnce?.();\n\t\t\tthis.#onCloseOnce = null;\n\t\t};\n\n\t\tdialogs[key] = new EntitySelectorDialog({\n\t\t\tmultiple: true,\n\t\t\tenableSearch: true,\n\t\t\tdropdownMode: true,\n\t\t\tcompactView: true,\n\t\t\tentities: [\n\t\t\t\t{\n\t\t\t\t\tid: EntitySelectorEntity.Tag,\n\t\t\t\t\toptions: { taskId, groupId },\n\t\t\t\t},\n\t\t\t],\n\t\t\tsearchOptions: {\n\t\t\t\tallowCreateItem: true,\n\t\t\t},\n\t\t\tfooter: Footer,\n\t\t\tfooterOptions: { userId, groupId },\n\t\t\tclearUnavailableItems: true,\n\t\t\tevents: {\n\t\t\t\t'Item:onSelect': handleChanged,\n\t\t\t\t'Item:onDeselect': handleChanged,\n\t\t\t\t'Search:onItemCreateAsync': (event: BaseEvent): void => {\n\t\t\t\t\tconst tag = event.getData().searchQuery.getQuery();\n\t\t\t\t\tif (this.#getTask(taskId).tags.includes(tag))\n\t\t\t\t\t{\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tdialogs[key].addItem({\n\t\t\t\t\t\tid: tag,\n\t\t\t\t\t\tentityId: EntitySelectorEntity.Tag,\n\t\t\t\t\t\ttitle: tag,\n\t\t\t\t\t\ttabs: 'all',\n\t\t\t\t\t\tselected: true,\n\t\t\t\t\t});\n\n\t\t\t\t\tchanged = true;\n\t\t\t\t},\n\t\t\t},\n\t\t\tpopupOptions: {\n\t\t\t\tevents: {\n\t\t\t\t\tonClose: handleClose,\n\t\t\t\t},\n\t\t\t},\n\t\t});\n\n\t\treturn dialogs[key];\n\t}\n\n\tasync #updateTask(taskId: number | string): Promise<void>\n\t{\n\t\tconst tags = this.#getDialog(taskId).getSelectedItems().map((item: Item) => item.getTitle());\n\n\t\tvoid taskService.update(taskId, { tags });\n\n\t\tthis.#onUpdateOnce?.();\n\t\tthis.#clearOnUpdateOnce();\n\t}\n\n\t#clearOnUpdateOnce = (): void => {\n\t\tthis.#onUpdateOnce = null;\n\t};\n\n\t#getTask(id: number | string): TaskModel\n\t{\n\t\treturn this.$store.getters[`${Model.Tasks}/getById`](id);\n\t}\n\n\tget #currentUserId(): number\n\t{\n\t\treturn this.$store.getters[`${Model.Interface}/currentUserId`];\n\t}\n\n\tget $store(): Store\n\t{\n\t\treturn Core.getStore();\n\t}\n}\n\nexport const tagsDialog = new TagsDialog();\n","import { BIcon } from 'ui.icon-set.api.vue';\nimport { Outline } from 'ui.icon-set.api.core';\nimport 'ui.icon-set.outline';\n\nimport { Model } from 'tasks.v2.const';\nimport { AddBackground } from 'tasks.v2.component.elements.add-background';\nimport { taskService } from 'tasks.v2.provider.service.task-service';\nimport type { TaskModel } from 'tasks.v2.model.tasks';\n\nimport { tagsMeta } from './tags-meta';\nimport { tagsDialog } from './tags-dialog';\nimport './tags.css';\n\n// @vue/component\nexport const Tags = {\n\tcomponents: {\n\t\tBIcon,\n\t\tAddBackground,\n\t},\n\tprops: {\n\t\ttaskId: {\n\t\t\ttype: [Number, String],\n\t\t\trequired: true,\n\t\t},\n\t},\n\tsetup(): Object\n\t{\n\t\treturn {\n\t\t\tOutline,\n\t\t\ttagsMeta,\n\t\t};\n\t},\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tisDialogShown: false,\n\t\t};\n\t},\n\tcomputed: {\n\t\ttask(): TaskModel\n\t\t{\n\t\t\treturn this.$store.getters[`${Model.Tasks}/getById`](this.taskId);\n\t\t},\n\t\ttags(): string[]\n\t\t{\n\t\t\treturn this.task.tags;\n\t\t},\n\t\tisFilled(): boolean\n\t\t{\n\t\t\treturn this.tags.length > 0;\n\t\t},\n\t\treadonly(): boolean\n\t\t{\n\t\t\treturn !this.task.rights.edit;\n\t\t},\n\t},\n\twatch: {\n\t\ttags(): void\n\t\t{\n\t\t\ttagsDialog.setTaskId(this.taskId).updateItems();\n\t\t},\n\t},\n\tmethods: {\n\t\thandleClick(): void\n\t\t{\n\t\t\tif (this.readonly)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\ttagsDialog.setTaskId(this.taskId).onCloseOnce(this.handleClose).showTo(this.$refs.anchor);\n\n\t\t\tthis.isDialogShown = true;\n\t\t},\n\t\thandleClose(): void\n\t\t{\n\t\t\tthis.isDialogShown = false;\n\t\t},\n\t\thandleCrossClick(tag: string): void\n\t\t{\n\t\t\tconst tags = this.tags.filter((it) => it !== tag);\n\t\t\tvoid taskService.update(this.taskId, { tags });\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div\n\t\t\tclass=\"tasks-field-tags\"\n\t\t\t:class=\"{ '--empty': !isFilled }\"\n\t\t\t:data-task-id=\"taskId\"\n\t\t\t:data-task-field-id=\"tagsMeta.id\"\n\t\t\t:data-task-field-value=\"task.tags.join(',')\"\n\t\t\t@click=\"handleClick\"\n\t\t>\n\t\t\t<AddBackground v-if=\"!readonly && isFilled\" :isActive=\"isDialogShown\"/>\n\t\t\t<template v-for=\"tag in tags\" :key=\"tag\">\n\t\t\t\t<div class=\"tasks-field-tag\">\n\t\t\t\t\t<span>{{ tag }}</span>\n\t\t\t\t\t<div v-if=\"!readonly\" class=\"tasks-field-tag-cross\" @click.capture.stop=\"handleCrossClick(tag)\">\n\t\t\t\t\t\t<BIcon :name=\"Outline.CROSS_L\" :hoverable=\"true\"/>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</template>\n\t\t\t<template v-if=\"!isFilled\">\n\t\t\t\t<BIcon class=\"tasks-field-tags-add-icon\" :name=\"Outline.TAG\"/>\n\t\t\t\t<div class=\"tasks-field-tags-add-text\">{{ loc('TASKS_V2_TAGS_ADD') }}</div>\n\t\t\t</template>\n\t\t\t<div class=\"tasks-field-tags-anchor\" ref=\"anchor\"></div>\n\t\t</div>\n\t`,\n};\n","import { Outline } from 'ui.icon-set.api.core';\nimport 'ui.icon-set.outline';\n\nimport { Model } from 'tasks.v2.const';\nimport { Chip, ChipDesign } from 'tasks.v2.component.elements.chip';\nimport { fieldHighlighter } from 'tasks.v2.lib.field-highlighter';\nimport type { TaskModel } from 'tasks.v2.model.tasks';\n\nimport { tagsMeta } from './tags-meta';\nimport { tagsDialog } from './tags-dialog';\n\n// @vue/component\nexport const TagsChip = {\n\tcomponents: {\n\t\tChip,\n\t},\n\tprops: {\n\t\ttaskId: {\n\t\t\ttype: [Number, String],\n\t\t\trequired: true,\n\t\t},\n\t},\n\tsetup(): Object\n\t{\n\t\treturn {\n\t\t\tOutline,\n\t\t\ttagsMeta,\n\t\t};\n\t},\n\tcomputed: {\n\t\ttask(): TaskModel\n\t\t{\n\t\t\treturn this.$store.getters[`${Model.Tasks}/getById`](this.taskId);\n\t\t},\n\t\tdesign(): string\n\t\t{\n\t\t\treturn this.isSelected ? ChipDesign.ShadowAccent : ChipDesign.ShadowNoAccent;\n\t\t},\n\t\tisSelected(): boolean\n\t\t{\n\t\t\treturn this.$store.getters[`${Model.Tasks}/wasFieldFilled`](this.taskId, tagsMeta.id);\n\t\t},\n\t\treadonly(): boolean\n\t\t{\n\t\t\treturn !this.task.rights.edit;\n\t\t},\n\t},\n\tmethods: {\n\t\thandleClick(): void\n\t\t{\n\t\t\tif (this.isSelected)\n\t\t\t{\n\t\t\t\tthis.highlightField();\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\ttagsDialog.setTaskId(this.taskId).showTo(this.$el);\n\n\t\t\tif (!this.isAutonomous)\n\t\t\t{\n\t\t\t\ttagsDialog.onUpdateOnce(this.highlightField);\n\t\t\t}\n\t\t},\n\t\thighlightField(): void\n\t\t{\n\t\t\tvoid fieldHighlighter.setContainer(this.$root.$el).highlight(tagsMeta.id);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<Chip\n\t\t\tv-if=\"isSelected || !readonly\"\n\t\t\t:design=\"design\"\n\t\t\t:icon=\"Outline.TAG\"\n\t\t\t:text=\"loc('TASKS_V2_TAGS_TITLE_CHIP')\"\n\t\t\t:data-task-id=\"taskId\"\n\t\t\t:data-task-chip-id=\"tagsMeta.id\"\n\t\t\t:data-task-chip-value=\"task.tags.join(',')\"\n\t\t\t@click=\"handleClick\"\n\t\t/>\n\t`,\n};\n"],"names":["tagsMeta","Object","freeze","id","title","Loc","getMessage","dialogs","TagsDialog","setTaskId","taskId","onCloseOnce","callback","onUpdateOnce","showTo","targetNode","dialog","isLoaded","isOpen","selectItemsByIds","updateItems","$store","Core","getStore","tags","Set","getItems","filter","item","has","getTitle","map","EntitySelectorEntity","Tag","getId","userId","groupId","key","changed","handleChanged","handleClose","EntitySelectorDialog","multiple","enableSearch","dropdownMode","compactView","entities","options","searchOptions","allowCreateItem","footer","Footer","footerOptions","clearUnavailableItems","events","event","tag","getData","searchQuery","getQuery","includes","addItem","entityId","tabs","selected","popupOptions","onClose","getSelectedItems","taskService","update","getters","Model","Tasks","Interface","tagsDialog","Tags","components","BIcon","AddBackground","props","type","Number","String","required","setup","Outline","data","isDialogShown","computed","task","isFilled","length","readonly","rights","edit","watch","methods","handleClick","$refs","anchor","handleCrossClick","it","template","TagsChip","Chip","design","isSelected","ChipDesign","ShadowAccent","ShadowNoAccent","highlightField","$el","isAutonomous","fieldHighlighter","setContainer","$root","highlight"],"mappings":"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"}