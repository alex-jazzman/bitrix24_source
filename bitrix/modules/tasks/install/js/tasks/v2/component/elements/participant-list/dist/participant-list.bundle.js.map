{"version":3,"file":"participant-list.bundle.js","sources":["../src/participant-meta.js","../src/participant-list.js"],"sourcesContent":["import { Core } from 'tasks.v2.core';\nimport { EntitySelectorEntity } from 'tasks.v2.const';\n\nexport const participantMeta = Object.freeze({\n\tdialogOptions: (taskId: number, idSalt: string) => {\n\t\tconst limits = Core.getParams().limits;\n\n\t\treturn {\n\t\t\tid: `tasks-user-selector-dialog-${idSalt}-${taskId}`,\n\t\t\tcontext: 'tasks-card',\n\t\t\tmultiple: true,\n\t\t\tenableSearch: true,\n\t\t\tentities: [\n\t\t\t\t{\n\t\t\t\t\tid: EntitySelectorEntity.User,\n\t\t\t\t\toptions: {\n\t\t\t\t\t\temailUsers: true,\n\t\t\t\t\t\tinviteGuestLink: true,\n\t\t\t\t\t\tanalyticsSource: 'tasks',\n\t\t\t\t\t\tlockGuestLink: !limits.mailUserIntegration,\n\t\t\t\t\t\tlockGuestLinkFeatureId: limits.mailUserIntegrationFeatureId,\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tid: 'department',\n\t\t\t\t},\n\t\t\t],\n\t\t};\n\t},\n});\n","import { Type } from 'main.core';\nimport type { PopupOptions } from 'main.popup';\n\nimport { Item } from 'ui.entity-selector';\nimport { BMenu, MenuItemDesign, type MenuOptions, type MenuItemOptions } from 'ui.vue3.components.menu';\nimport { Popup } from 'ui.vue3.components.popup';\nimport { BIcon } from 'ui.icon-set.api.vue';\nimport { Outline } from 'ui.icon-set.api.core';\nimport 'ui.icon-set.outline';\n\nimport { EntitySelectorEntity, Model } from 'tasks.v2.const';\nimport { AddBackground } from 'tasks.v2.component.elements.add-background';\nimport { FieldAdd } from 'tasks.v2.component.elements.field-add';\nimport { UserSelectorDialog } from 'tasks.v2.lib.user-selector-dialog';\nimport { heightTransition } from 'tasks.v2.lib.height-transition';\nimport { hrefClick } from 'tasks.v2.lib.href-click';\nimport { userService } from 'tasks.v2.provider.service.user-service';\nimport type { TaskModel } from 'tasks.v2.model.tasks';\nimport type { UserModel } from 'tasks.v2.model.users';\nimport type { ItemId } from 'tasks.v2.lib.entity-selector-dialog';\nimport { UserAvatarListUsers } from 'tasks.v2.component.elements.user-avatar-list';\n\nimport { participantMeta } from './participant-meta';\nimport './participant-list.css';\n\nconst maxUsers = 4;\n\n// @vue/component\nexport const ParticipantList = {\n\tname: 'TaskParticipantList',\n\tcomponents: {\n\t\tBIcon,\n\t\tUserAvatarListUsers,\n\t\tAddBackground,\n\t\tFieldAdd,\n\t\tBMenu,\n\t\tPopup,\n\t},\n\tprops: {\n\t\ttaskId: {\n\t\t\ttype: [Number, String],\n\t\t\trequired: true,\n\t\t},\n\t\tdataset: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t\tcontext: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t\tusers: {\n\t\t\ttype: Array,\n\t\t\trequired: true,\n\t\t},\n\t},\n\temits: ['update'],\n\tsetup(): Object\n\t{\n\t\treturn {\n\t\t\tOutline,\n\t\t};\n\t},\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tmenuUserId: null,\n\t\t\tisDialogShown: false,\n\t\t\tisPopupShown: false,\n\t\t};\n\t},\n\tcomputed: {\n\t\ttask(): TaskModel\n\t\t{\n\t\t\treturn this.$store.getters[`${Model.Tasks}/getById`](this.taskId);\n\t\t},\n\t\twithActionMenu(): boolean\n\t\t{\n\t\t\treturn Type.isNumber(this.taskId) && this.taskId > 0;\n\t\t},\n\t\ttestId(): string\n\t\t{\n\t\t\treturn `${this.$options.name}-${this.context}-${this.taskId}`;\n\t\t},\n\t\tpopupOptions(): Function\n\t\t{\n\t\t\treturn (): PopupOptions => ({\n\t\t\t\tid: 'tasks-participant-list-more-popup',\n\t\t\t\tbindElement: this.$refs.more,\n\t\t\t\tpadding: 18,\n\t\t\t\tmaxWidth: 300,\n\t\t\t\tmaxHeight: window.innerHeight / 2 - 40,\n\t\t\t\toffsetTop: 8,\n\t\t\t\toffsetLeft: -18,\n\t\t\t\ttargetContainer: document.body,\n\t\t\t});\n\t\t},\n\t\tmenuOptions(): MenuOptions\n\t\t{\n\t\t\tconst userId = this.menuUserId;\n\n\t\t\treturn {\n\t\t\t\tid: 'tasks-participant-list-menu-user',\n\t\t\t\tbindElement: this.$refs.userList.getNode(userId) ?? this.$refs.popupUserList.getNode(userId),\n\t\t\t\titems: this.getMenuItems(userId),\n\t\t\t\toffsetTop: 8,\n\t\t\t\ttargetContainer: document.body,\n\t\t\t};\n\t\t},\n\t\tmoreFormatted(): string\n\t\t{\n\t\t\treturn this.loc('TASKS_V2_PARTICIPANT_LIST_MORE_COUNT', {\n\t\t\t\t'#COUNT#': this.popupUsers.length,\n\t\t\t});\n\t\t},\n\t\tdisplayedUsers(): UserModel[]\n\t\t{\n\t\t\treturn this.users.slice(0, maxUsers - (this.usersLength > maxUsers));\n\t\t},\n\t\tpopupUsers(): UserModel[]\n\t\t{\n\t\t\treturn this.users.slice(maxUsers - (this.usersLength > maxUsers));\n\t\t},\n\t\tusersLength(): number\n\t\t{\n\t\t\treturn this.users.length;\n\t\t},\n\t\treadonly(): boolean\n\t\t{\n\t\t\treturn !this.task.rights.edit;\n\t\t},\n\t},\n\twatch: {\n\t\tusersLength(): void\n\t\t{\n\t\t\tif (this.popupUsers.length === 0)\n\t\t\t{\n\t\t\t\tthis.isPopupShown = false;\n\t\t\t}\n\t\t},\n\t},\n\tmounted(): void\n\t{\n\t\theightTransition.animate(this.$el);\n\n\t\t// Load preselected items\n\t\tthis.createDialog();\n\t},\n\tupdated(): void\n\t{\n\t\theightTransition.animate(this.$el);\n\t},\n\tbeforeUnmount(): void\n\t{\n\t\tthis.selector?.destroy();\n\t},\n\tmethods: {\n\t\thandleClickUser(userId: number): void\n\t\t{\n\t\t\tif (this.readonly)\n\t\t\t{\n\t\t\t\threfClick(userService.getUrl(userId));\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (this.withActionMenu)\n\t\t\t{\n\t\t\t\tthis.showMenu(userId);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.showDialog();\n\t\t\t}\n\t\t},\n\t\tshowMenu(userId: number): void\n\t\t{\n\t\t\tif (this.menuUserId !== userId)\n\t\t\t{\n\t\t\t\tsetTimeout((): void => {\n\t\t\t\t\tthis.menuUserId = userId;\n\t\t\t\t});\n\t\t\t}\n\t\t},\n\t\tshowDialog(): void\n\t\t{\n\t\t\tif (this.selector?.getDialog().isOpen())\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.selector ??= this.createDialog();\n\t\t\tthis.selector.selectItemsByIds(this.getPreselected(this.users));\n\n\t\t\tthis.selector.show(window.innerHeight < 700 ? this.$refs.anchor : this.$refs.users);\n\t\t},\n\t\tcreateDialog(): UserSelectorDialog\n\t\t{\n\t\t\tconst dialog = new UserSelectorDialog({\n\t\t\t\ttaskId: this.taskId,\n\t\t\t\tpreselected: this.getPreselected(this.users),\n\t\t\t\tdialogOptions: {\n\t\t\t\t\t...participantMeta.dialogOptions(this.taskId, this.context),\n\t\t\t\t\theight: window.innerHeight / 2 - 80,\n\t\t\t\t},\n\t\t\t});\n\n\t\t\tdialog.getDialog().getPopup().subscribeFromOptions({\n\t\t\t\tonShow: (): void => {\n\t\t\t\t\tthis.isDialogShown = true;\n\t\t\t\t},\n\t\t\t\tonClose: (): void => {\n\t\t\t\t\tthis.isDialogShown = false;\n\t\t\t\t\tif (dialog.getDialog().isLoaded())\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.updateUsers(this.getSelectedUsers());\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t});\n\n\t\t\tdialog.subscribe('selectedUsersLoaded', (event) => {\n\t\t\t\tconst users = event.getData();\n\t\t\t\tthis.updateUsers(users);\n\t\t\t});\n\n\t\t\treturn dialog;\n\t\t},\n\t\tgetSelectedUsers(): UserModel[]\n\t\t{\n\t\t\treturn this.selector.getDialog().getSelectedItems().map((item: Item) => ({\n\t\t\t\tid: item.getId(),\n\t\t\t\tname: item.getTitle(),\n\t\t\t\timage: item.getAvatar(),\n\t\t\t}));\n\t\t},\n\t\tgetMenuItems(userId: number): MenuItemOptions[]\n\t\t{\n\t\t\treturn [\n\t\t\t\t{\n\t\t\t\t\ttitle: this.loc('TASKS_V2_PARTICIPANT_LIST_USER_MENU_PROFILE'),\n\t\t\t\t\ticon: Outline.PERSON,\n\t\t\t\t\tdataset: {\n\t\t\t\t\t\tid: `UserMenuProfile-${this.testId}`,\n\t\t\t\t\t},\n\t\t\t\t\tonClick: (): void => hrefClick(userService.getUrl(userId)),\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tdesign: MenuItemDesign.Alert,\n\t\t\t\t\ttitle: this.loc('TASKS_V2_PARTICIPANT_LIST_USER_MENU_REMOVE'),\n\t\t\t\t\ticon: Outline.TRASHCAN,\n\t\t\t\t\tdataset: {\n\t\t\t\t\t\tid: `UserMenuRemove-${this.testId}`,\n\t\t\t\t\t},\n\t\t\t\t\tonClick: (): void => this.removeUser(userId),\n\t\t\t\t},\n\t\t\t];\n\t\t},\n\t\tremoveUser(userId: number): void\n\t\t{\n\t\t\tconst isSelectorShown = this.selector?.getDialog().isOpen();\n\t\t\tconst users = isSelectorShown ? this.getSelectedUsers() : this.users;\n\t\t\tconst usersWithoutRemoved = users.filter(({ id }) => id !== userId);\n\t\t\tif (isSelectorShown)\n\t\t\t{\n\t\t\t\tthis.selector.selectItemsByIds(this.getPreselected(usersWithoutRemoved));\n\t\t\t}\n\n\t\t\tthis.updateUsers(usersWithoutRemoved);\n\t\t},\n\t\tupdateUsers(users: UserModel[]): void\n\t\t{\n\t\t\tthis.$emit('update', users);\n\t\t},\n\t\tgetPreselected(users: UserModel[]): ItemId[]\n\t\t{\n\t\t\treturn users.map(({ id }) => [EntitySelectorEntity.User, id]);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div v-bind=\"dataset\" ref=\"users\">\n\t\t\t<div v-if=\"usersLength > 0\">\n\t\t\t\t<div class=\"tasks-field-users-container\">\n\t\t\t\t\t<AddBackground v-if=\"!readonly\" :isActive=\"isDialogShown\" @click=\"showDialog\"/>\n\t\t\t\t\t<div class=\"tasks-field-users\">\n\t\t\t\t\t\t<UserAvatarListUsers\n\t\t\t\t\t\t\t:users=\"displayedUsers\"\n\t\t\t\t\t\t\t:withCross=\"!withActionMenu\"\n\t\t\t\t\t\t\t:readonly\n\t\t\t\t\t\t\tref=\"userList\"\n\t\t\t\t\t\t\t@onClick=\"showDialog\"\n\t\t\t\t\t\t\t@onUserClick=\"(userId) => handleClickUser(userId)\"\n\t\t\t\t\t\t\t@onUserCrossClick=\"(userId) => removeUser(userId)\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div\n\t\t\t\t\tv-if=\"popupUsers.length > 0\"\n\t\t\t\t\tclass=\"tasks-field-participant-list-more\"\n\t\t\t\t\tref=\"more\"\n\t\t\t\t\t@click=\"isPopupShown = true\"\n\t\t\t\t>\n\t\t\t\t\t{{ moreFormatted }}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<FieldAdd v-else :icon=\"Outline.PERSON\" @click=\"showDialog\"/>\n\t\t\t<div ref=\"anchor\"></div>\n\t\t</div>\n\t\t<BMenu v-if=\"menuUserId\" :options=\"menuOptions\" @close=\"menuUserId = null\"/>\n\t\t<Popup\n\t\t\tv-if=\"isPopupShown\"\n\t\t\t:options=\"popupOptions()\"\n\t\t\t@close=\"isPopupShown = false\"\n\t\t>\n\t\t\t<div class=\"tasks-field-users --popup\">\n\t\t\t\t<UserAvatarListUsers\n\t\t\t\t\t:users=\"popupUsers\"\n\t\t\t\t\t:withCross=\"!withActionMenu\"\n\t\t\t\t\t:isDialogShown\n\t\t\t\t\tref=\"popupUserList\"\n\t\t\t\t\t@onClick=\"showDialog\"\n\t\t\t\t\t@onUserClick=\"(userId) => handleClickUser(userId)\"\n\t\t\t\t\t@onUserCrossClick=\"(userId) => removeUser(userId)\"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t</Popup>\n\t`,\n};\n"],"names":["participantMeta","Object","freeze","dialogOptions","taskId","idSalt","limits","Core","getParams","id","context","multiple","enableSearch","entities","EntitySelectorEntity","User","options","emailUsers","inviteGuestLink","analyticsSource","lockGuestLink","mailUserIntegration","lockGuestLinkFeatureId","mailUserIntegrationFeatureId","maxUsers","ParticipantList","name","components","BIcon","UserAvatarListUsers","AddBackground","FieldAdd","BMenu","Popup","props","type","Number","String","required","dataset","users","Array","emits","setup","Outline","data","menuUserId","isDialogShown","isPopupShown","computed","task","$store","getters","Model","Tasks","withActionMenu","Type","isNumber","testId","$options","popupOptions","bindElement","$refs","more","padding","maxWidth","maxHeight","window","innerHeight","offsetTop","offsetLeft","targetContainer","document","body","menuOptions","userId","userList","getNode","popupUserList","items","getMenuItems","moreFormatted","loc","popupUsers","length","displayedUsers","slice","usersLength","readonly","rights","edit","watch","mounted","heightTransition","animate","$el","createDialog","updated","beforeUnmount","selector","destroy","methods","handleClickUser","hrefClick","userService","getUrl","showMenu","showDialog","setTimeout","getDialog","isOpen","selectItemsByIds","getPreselected","show","anchor","dialog","UserSelectorDialog","preselected","height","getPopup","subscribeFromOptions","onShow","onClose","isLoaded","updateUsers","getSelectedUsers","subscribe","event","getData","getSelectedItems","map","item","getId","getTitle","image","getAvatar","title","icon","PERSON","onClick","design","MenuItemDesign","Alert","TRASHCAN","removeUser","isSelectorShown","usersWithoutRemoved","filter","$emit","template"],"mappings":"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"}