{"version":3,"file":"check-list.bundle.js","sources":["../src/components/check-list/check-list-stub.js","../src/components/check-list-popup/check-list-popup.js","../src/components/check-list-sheet/check-list-sheet.js","../src/lib/check-list-manager.js","../src/lib/check-list-meta.js","../src/components/check-list-list/check-list-list.js","../src/components/check-list-widget/component/check-list-item-mixin.js","../src/components/check-list-widget/component/check-list-parent-item.js","../src/components/check-list-widget/component/check-list-child-item.js","../src/components/check-list-widget/component/check-list-add-item.js","../src/components/check-list-widget/check-list-widget.js","../src/components/check-list-item-panel/check-list-item-panel-meta.js","../src/components/check-list-item-panel/check-list-item-panel.js","../src/lib/check-list-notifier.js","../src/components/check-list/check-list.js","../src/check-list-chip.js"],"sourcesContent":["import { Button as UiButton, ButtonSize } from 'ui.vue3.components.button';\n\n// @vue/component\nexport const CheckListStub = {\n\tname: 'CheckListStub',\n\tcomponents: {\n\t\tUiButton,\n\t},\n\temits: ['click'],\n\tsetup(): Object\n\t{\n\t\treturn {\n\t\t\tButtonSize,\n\t\t};\n\t},\n\ttemplate: `\n\t\t<div class=\"check-list-stub\">\n\t\t\t<div class=\"check-list-stub-title\">\n\t\t\t\t{{ loc('TASKS_V2_CHECK_LIST_STUB_TITLE') }}\n\t\t\t</div>\n\t\t\t<div class=\"check-list-stub-icon\"></div>\n\t\t\t<div class=\"check-list-stub-btn\">\n\t\t\t\t<UiButton\n\t\t\t\t\t:text=\"loc('TASKS_V2_CHECK_LIST_STUB_BTN')\"\n\t\t\t\t\t:size=\"ButtonSize.MEDIUM\"\n\t\t\t\t\t@click=\"$emit('click')\"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import { Event } from 'main.core';\nimport type { PopupOptions } from 'main.popup';\n\nimport { Popup } from 'ui.vue3.components.popup';\nimport { mapGetters } from 'ui.vue3.vuex';\n\nimport { EventName, Model } from 'tasks.v2.const';\n\nimport './check-list-popup.css';\n\n// @vue/component\nexport const CheckListPopup = {\n\tname: 'TaskCheckListPopup',\n\tcomponents: {\n\t\tPopup,\n\t},\n\tinheritAttrs: false,\n\tprops: {\n\t\ttaskId: {\n\t\t\ttype: [Number, String],\n\t\t\trequired: true,\n\t\t},\n\t},\n\temits: ['show', 'close', 'resize'],\n\tsetup(): Object\n\t{\n\t\treturn {\n\t\t\tresizeObserver: null,\n\t\t};\n\t},\n\tcomputed: {\n\t\tpopupId(): string\n\t\t{\n\t\t\treturn `tasks-check-list-popup-${this.taskId}`;\n\t\t},\n\t\tpopupOptions(): PopupOptions\n\t\t{\n\t\t\treturn {\n\t\t\t\tclassName: 'tasks-check-list-popup',\n\t\t\t\twidth: 580,\n\t\t\t\theight: 500,\n\t\t\t\tborderRadius: '18px',\n\t\t\t\toffsetTop: 0,\n\t\t\t\tpadding: 0,\n\t\t\t\tautoHide: true,\n\t\t\t\tcloseByEsc: true,\n\t\t\t\tanimation: {\n\t\t\t\t\tshowClassName: 'tasks-check-list-popup-show',\n\t\t\t\t\tcloseClassName: 'tasks-check-list-popup-close',\n\t\t\t\t\tcloseAnimationType: 'animation',\n\t\t\t\t},\n\t\t\t\tevents: {\n\t\t\t\t\tonClose: this.handleClose.bind(this),\n\t\t\t\t},\n\t\t\t};\n\t\t},\n\t\t...mapGetters({\n\t\t\ttitleFieldOffsetHeight: `${Model.Interface}/titleFieldOffsetHeight`,\n\t\t}),\n\t},\n\twatch: {\n\t\tasync titleFieldOffsetHeight(): Promise<void>\n\t\t{\n\t\t\tif (!this.$refs.childComponent)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tawait this.$nextTick();\n\n\t\t\tthis.resize();\n\t\t},\n\t},\n\tcreated(): void\n\t{\n\t\tthis.resizeObserver = new ResizeObserver((entries: ResizeObserverEntry[]) => {\n\t\t\tfor (const entry of entries)\n\t\t\t{\n\t\t\t\tif (entry.target === this.$refs.wrapper)\n\t\t\t\t{\n\t\t\t\t\tthis.resize();\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t},\n\tmounted(): void\n\t{\n\t\tEvent.bind(window, 'resize', this.resize);\n\t},\n\tbeforeUnmount(): void\n\t{\n\t\tEvent.unbind(window, 'resize', this.resize);\n\t},\n\tmethods: {\n\t\tresize(): void\n\t\t{\n\t\t\tconst popupInstance = this.$refs.childComponent?.getPopupInstance();\n\t\t\tif (popupInstance)\n\t\t\t{\n\t\t\t\tthis.$emit('resize');\n\n\t\t\t\tpopupInstance.adjustPosition();\n\t\t\t}\n\t\t},\n\t\thandleShow(): void\n\t\t{\n\t\t\tthis.$emit('show', { popupInstance: this.$refs.childComponent.getPopupInstance() });\n\n\t\t\tthis.$refs.childComponent?.getPopupInstance().adjustPosition();\n\t\t\tsetTimeout(() => this.resizeObserver.observe(this.$parent.$refs.wrapper), 300);\n\t\t},\n\t\thandleClose(): void\n\t\t{\n\t\t\tthis.resizeObserver.disconnect();\n\t\t\tthis.$bitrix.eventEmitter.emit(EventName.CloseCheckList);\n\n\t\t\tthis.$emit('close');\n\t\t},\n\t},\n\ttemplate: `\n\t\t<Popup :options=\"popupOptions\" ref=\"childComponent\">\n\t\t\t<slot\n\t\t\t\t:handleShow=\"handleShow\"\n\t\t\t\t:handleClose=\"handleClose\"\n\t\t\t></slot>\n\t\t</Popup>\n\t`,\n};\n","import { Event } from 'main.core';\n\nimport { mapGetters } from 'ui.vue3.vuex';\n\nimport { BottomSheet } from 'tasks.v2.component.elements.bottom-sheet';\nimport { Model } from 'tasks.v2.const';\n\n// @vue/component\nexport const CheckListSheet = {\n\tname: 'TaskCheckListSheet',\n\tcomponents: {\n\t\tBottomSheet,\n\t},\n\tprops: {\n\t\tisShown: {\n\t\t\ttype: Boolean,\n\t\t\trequired: true,\n\t\t},\n\t},\n\temits: ['show', 'close', 'isShown'],\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tisExpanded: false,\n\t\t};\n\t},\n\tcomputed: {\n\t\t...mapGetters({\n\t\t\ttitleFieldOffsetHeight: `${Model.Interface}/titleFieldOffsetHeight`,\n\t\t}),\n\t},\n\twatch: {\n\t\ttitleFieldOffsetHeight(): void\n\t\t{\n\t\t\tthis.$refs.childComponent?.adjustPosition();\n\t\t},\n\t\tasync isShown(value): void\n\t\t{\n\t\t\tawait this.$nextTick();\n\n\t\t\tthis.$emit('isShown', value);\n\t\t},\n\t},\n\tmethods: {\n\t\thandleShow(): void\n\t\t{\n\t\t\tthis.$emit('show');\n\t\t},\n\t\thandleClose(): void\n\t\t{\n\t\t\tthis.$emit('close');\n\t\t},\n\t},\n\ttemplate: `\n\t\t<BottomSheet\n\t\t\t:isShown=\"isShown\"\n\t\t\t:isExpanded=\"isExpanded\"\n\t\t\t:class=\"'--check-list'\"\n\t\t\tref=\"childComponent\"\n\t\t>\n\t\t\t<slot\n\t\t\t\t:handleShow=\"handleShow\"\n\t\t\t\t:handleClose=\"handleClose\"\n\t\t\t></slot>\n\t\t</BottomSheet>\n\t`,\n};\n","import { Model } from 'tasks.v2.const';\nimport type { CheckListModel } from 'tasks.v2.model.check-list';\n\ntype Params = {\n\tcomputed?: {\n\t\tcheckLists: () => CheckListModel[],\n\t},\n};\n\nexport class CheckListManager\n{\n\t#params: Params;\n\n\tconstructor(params: Params)\n\t{\n\t\tthis.#params = params;\n\t}\n\n\tgetItem(itemId: number | string): ?CheckListModel\n\t{\n\t\treturn this.#getCheckLists().find((item: CheckListModel) => item.id === itemId);\n\t}\n\n\tgetItemsOnLevel(parentId: number | string): CheckListModel[]\n\t{\n\t\treturn this.#getCheckLists()\n\t\t\t.filter((item: CheckListModel) => item.parentId === parentId)\n\t\t\t.sort((a: CheckListModel, b: CheckListModel) => a.sortIndex - b.sortIndex);\n\t}\n\n\tgetItemLevel(checkListItem: CheckListModel): number\n\t{\n\t\tlet level = 0;\n\t\tlet current = checkListItem;\n\n\t\tconst visitedIds = new Set();\n\n\t\tconst findParent = (parentId) => this.#getCheckLists().find((item: CheckListModel) => item.id === parentId);\n\n\t\twhile (current.parentId !== 0) {\n\t\t\tif (visitedIds.has(current.id))\n\t\t\t{\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tvisitedIds.add(current.id);\n\n\t\t\tcurrent = findParent(current.parentId);\n\t\t\tif (!current)\n\t\t\t{\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tlevel++;\n\t\t}\n\n\t\treturn level;\n\t}\n\n\tisItemDescendant(potentialAncestor: ?CheckListModel, item?: CheckListModel): boolean\n\t{\n\t\tif (item?.parentId === potentialAncestor?.id)\n\t\t{\n\t\t\treturn true;\n\t\t}\n\n\t\tif (item?.parentId === 0)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tconst parent = this.#getCheckLists().find((i: CheckListModel) => i.id === item?.parentId);\n\t\tif (!parent)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\treturn this.isItemDescendant(potentialAncestor, parent);\n\t}\n\n\tsyncParentCompletionState(\n\t\titemId: number | string,\n\t\tupdateFn: (id: string | number, fields: Partial<CheckListModel>) => void,\n\t\tparentItemId?: number | string,\n\t): void\n\t{\n\t\tconst changedItem = this.#getCheckLists().find((item: CheckListModel) => item.id === itemId);\n\n\t\tif ((!changedItem || !changedItem.parentId) && !parentItemId)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst parentId = parentItemId || changedItem.parentId;\n\n\t\tconst parentItem = this.#getCheckLists().find((item: CheckListModel) => item.id === parentId);\n\t\tif (!parentItem)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst childrenItems = this.#getCheckLists().filter((item: CheckListModel) => item.parentId === parentItem.id);\n\t\tconst isEmptyParent = (childrenItems.length === 0);\n\n\t\tconst allChildrenCompleted = childrenItems.every((child: CheckListModel) => child.isComplete);\n\t\tconst someChildrenIncomplete = childrenItems.some((child: CheckListModel) => !child.isComplete);\n\n\t\tconst shouldUpdateParent = (\n\t\t\tisEmptyParent\n\t\t\t|| (allChildrenCompleted && !parentItem.isComplete)\n\t\t\t|| (someChildrenIncomplete && parentItem.isComplete)\n\t\t);\n\t\tif (!shouldUpdateParent)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tupdateFn(parentItem.id, {\n\t\t\tisComplete: allChildrenCompleted && !isEmptyParent,\n\t\t});\n\n\t\tif (parentItem.parentId)\n\t\t{\n\t\t\tthis.syncParentCompletionState(parentItem.id, updateFn);\n\t\t}\n\t}\n\n\tgetAllGroupModeItems(): CheckListModel[]\n\t{\n\t\treturn this.#getCheckLists().filter((item: CheckListModel) => item.groupMode?.active === true);\n\t}\n\n\tgetAllSelectedItems(): CheckListModel[]\n\t{\n\t\treturn this.#getCheckLists().filter((item: CheckListModel) => {\n\t\t\treturn (item.parentId !== 0 && item.groupMode?.selected === true);\n\t\t});\n\t}\n\n\tgetAllSelectedItemsWithChildren(): CheckListModel[]\n\t{\n\t\tconst result = new Map();\n\n\t\tconst selectedItems = this.getAllSelectedItems();\n\t\tconst allItems = this.#getCheckLists();\n\n\t\tselectedItems.forEach((item: CheckListModel) => result.set(item.id, item));\n\n\t\tconst getChildren = (parentIds: (string | number)[]): void => {\n\t\t\tconst children = allItems.filter((item: CheckListModel) =>\n\t\t\t\tparentIds.includes(item.parentId) && !result.has(item.id)\n\t\t\t);\n\n\t\t\tchildren.forEach((child: CheckListModel) => result.set(child.id, child));\n\n\t\t\tif (children.length > 0)\n\t\t\t{\n\t\t\t\tgetChildren(children.map((child: CheckListModel) => child.id));\n\t\t\t}\n\t\t};\n\n\t\tgetChildren(selectedItems.map((item: CheckListModel) => item.id));\n\n\t\treturn Array.from(result.values());\n\t}\n\n\tgetAllChildren(itemId: number | string): CheckListModel[]\n\t{\n\t\tconst visited = new Set();\n\n\t\tconst result = [];\n\n\t\tconst collectChildren = (currentId: number | string) => {\n\t\t\tif (visited.has(currentId))\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tvisited.add(currentId);\n\n\t\t\tconst children = this.#getCheckLists()\n\t\t\t\t.filter((item: CheckListModel) => item.parentId === currentId)\n\t\t\t\t.sort((a: CheckListModel, b: CheckListModel) => a.sortIndex - b.sortIndex);\n\n\t\t\tchildren.forEach((child: CheckListModel) => {\n\t\t\t\tif (!visited.has(child.id))\n\t\t\t\t{\n\t\t\t\t\tresult.push(child);\n\t\t\t\t\tcollectChildren(child.id);\n\t\t\t\t}\n\t\t\t});\n\t\t};\n\n\t\tcollectChildren(itemId);\n\n\t\treturn result;\n\t}\n\n\tgetAllCompletedChildrenChildren(itemId: number | string): CheckListModel[]\n\t{\n\t\treturn this.getAllChildren(itemId).filter((item: CheckListModel) => item.isComplete === true);\n\t}\n\n\tgetChildren(itemId: number | string): CheckListModel[]\n\t{\n\t\treturn this.#getCheckLists().filter((item: CheckListModel) => {\n\t\t\treturn item.parentId === itemId;\n\t\t});\n\t}\n\n\tgetSiblings(itemId: number | string, parentId: number | string): CheckListModel[]\n\t{\n\t\treturn this.#getCheckLists()\n\t\t\t.filter((sibling: CheckListModel) => sibling.parentId === parentId && sibling.id !== itemId)\n\t\t\t.sort((a: CheckListModel, b: CheckListModel) => a.sortIndex - b.sortIndex);\n\t}\n\n\tresortItemsOnLevel(\n\t\tparentId: number | string,\n\t\tupdateFn: (updates: CheckListModel[]) => void,\n\t): void\n\t{\n\t\tconst allItems = this.#getCheckLists()\n\t\t\t.filter((item: CheckListModel) => item.parentId === parentId);\n\n\t\tconst sortedItems = [...allItems].sort((a: CheckListModel, b: CheckListModel) => a.sortIndex - b.sortIndex);\n\n\t\tconst updates = sortedItems\n\t\t\t.map((item: CheckListModel, newIndex: number) => ({\n\t\t\t\t...item,\n\t\t\t\tsortIndex: newIndex,\n\t\t\t}));\n\n\t\tif (updates.length > 0)\n\t\t{\n\t\t\tupdateFn(updates);\n\t\t}\n\t}\n\n\tresortItemsAfterIndex(\n\t\tparentId: number | string,\n\t\tsortIndex: number,\n\t\tupdateFn: (updates: CheckListModel[]) => void,\n\t): void\n\t{\n\t\tconst allItems = this.#getCheckLists()\n\t\t\t.filter((item: CheckListModel) => item.parentId === parentId);\n\n\t\tconst itemsToResort = allItems\n\t\t\t.filter((item: CheckListModel) => item.sortIndex >= sortIndex)\n\t\t\t.sort((a: CheckListModel, b: CheckListModel) => a.sortIndex - b.sortIndex);\n\n\t\tconst updates = itemsToResort\n\t\t\t.map((item: CheckListModel) => ({\n\t\t\t\t...item,\n\t\t\t\tsortIndex: item.sortIndex + 1\n\t\t\t}));\n\n\t\tif (updates.length > 0)\n\t\t{\n\t\t\tupdateFn(updates);\n\t\t}\n\t}\n\n\tmoveRight(item: CheckListModel, updateFn: (updates: CheckListModel[]) => void): void\n\t{\n\t\tif (item.parentId === 0 || this.getItemLevel(item) > 5)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst itemsOnLevel = this.getItemsOnLevel(item.parentId);\n\n\t\tconst currentIndex = itemsOnLevel.findIndex((sibling: CheckListModel) => sibling.id === item.id);\n\t\tif (currentIndex <= 0)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tlet newParent = null;\n\t\tfor (let i = currentIndex - 1; i >= 0; i--)\n\t\t{\n\t\t\tconst candidate = itemsOnLevel[i];\n\t\t\tif (!this.isItemDescendant(candidate, item))\n\t\t\t{\n\t\t\t\tnewParent = candidate;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\tif (!newParent)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst newParentChildren = this.#getCheckLists()\n\t\t\t.filter((child: CheckListModel) => child.parentId === newParent.id)\n\t\t\t.sort((a: CheckListModel, b: CheckListModel) => a.sortIndex - b.sortIndex);\n\n\t\tconst updates = itemsOnLevel\n\t\t\t.filter((sibling: CheckListModel, index: number) => index > currentIndex)\n\t\t\t.map((sibling: CheckListModel) => ({\n\t\t\t\t...sibling,\n\t\t\t\tsortIndex: sibling.sortIndex - 1,\n\t\t\t}));\n\n\t\tupdates.push({\n\t\t\t...item,\n\t\t\tparentId: newParent.id,\n\t\t\tparentNodeId: newParent.nodeId,\n\t\t\tsortIndex: newParentChildren.length > 0\n\t\t\t\t? newParentChildren[newParentChildren.length - 1].sortIndex + 1\n\t\t\t\t: 0,\n\t\t});\n\n\t\tupdateFn(updates);\n\t}\n\n\tmoveLeft(item: CheckListModel, updateFn: (updates: CheckListModel[]) => void): void\n\t{\n\t\tif (item.parentId === 0 || this.getItemLevel(item) <= 1)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst currentParent = this.#getCheckLists().find((parent: CheckListModel) => parent.id === item.parentId);\n\t\tif (!currentParent)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst itemsOnLevel = this.getItemsOnLevel(currentParent.parentId);\n\n\t\tconst parentInNewListIndex = itemsOnLevel\n\t\t\t.findIndex((sibling: CheckListModel) => sibling.id === currentParent.id);\n\n\t\tconst currentSiblingsUpdates = this.#getCheckLists()\n\t\t\t.filter((sibling: CheckListModel) => (\n\t\t\t\tsibling.parentId === item.parentId\n\t\t\t\t&& sibling.sortIndex > item.sortIndex\n\t\t\t))\n\t\t\t.map((sibling: CheckListModel) => ({\n\t\t\t\t...sibling,\n\t\t\t\tsortIndex: sibling.sortIndex - 1,\n\t\t\t}));\n\n\t\tlet newSortIndex = 0;\n\t\tif (\n\t\t\tparentInNewListIndex === -1\n\t\t\t|| parentInNewListIndex === itemsOnLevel.length - 1\n\t\t)\n\t\t{\n\t\t\tnewSortIndex = itemsOnLevel.length > 0 ? itemsOnLevel[itemsOnLevel.length - 1].sortIndex + 1 : 0;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tnewSortIndex = itemsOnLevel[parentInNewListIndex].sortIndex + 1;\n\n\t\t\tconst shiftUpdates = itemsOnLevel\n\t\t\t\t.filter((sibling: CheckListModel) => sibling.sortIndex >= newSortIndex)\n\t\t\t\t.map((sibling: CheckListModel) => ({\n\t\t\t\t\t...sibling,\n\t\t\t\t\tsortIndex: sibling.sortIndex + 1,\n\t\t\t\t}));\n\n\t\t\tcurrentSiblingsUpdates.push(...shiftUpdates);\n\t\t}\n\n\t\tconst movedItemUpdate = {\n\t\t\t...item,\n\t\t\tparentId: currentParent.parentId,\n\t\t\tparentNodeId: currentParent.parentNodeId || null,\n\t\t\tsortIndex: newSortIndex,\n\t\t};\n\n\t\tupdateFn([...currentSiblingsUpdates, movedItemUpdate]);\n\t}\n\n\tfindNearestItem(\n\t\tinitialItem: CheckListModel,\n\t\tselected: boolean,\n\t\texcludeChildrenOf: CheckListModel[] = []\n\t): ?CheckListModel\n\t{\n\t\tif (!initialItem)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tconst rootParent = this.#getRootParent(initialItem);\n\t\tif (!rootParent)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tconst currentSortIndex = initialItem.sortIndex;\n\n\t\tconst excludedParentIds = new Set(excludeChildrenOf.map((item: CheckListModel) => item.id));\n\n\t\tconst eligibleItems = this.#getCheckLists()\n\t\t\t.sort((a: CheckListModel, b: CheckListModel) => a.sortIndex - b.sortIndex)\n\t\t\t.filter((item: CheckListModel) => {\n\t\t\t\tconst isChildOfExcluded = excludedParentIds.has(item.parentId);\n\n\t\t\t\treturn (\n\t\t\t\t\titem.id !== initialItem.id\n\t\t\t\t\t&& item.parentId !== 0\n\t\t\t\t\t&& item.groupMode?.selected === selected\n\t\t\t\t\t&& this.#getRootParent(item)?.id === rootParent.id\n\t\t\t\t\t&& !isChildOfExcluded\n\t\t\t\t);\n\t\t\t});\n\n\t\tif (eligibleItems.length === 0)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\treturn eligibleItems.reduce((nearest: CheckListModel, item: CheckListModel) => {\n\t\t\treturn (\n\t\t\t\titem.sortIndex > currentSortIndex\n\t\t\t\t&& (\n\t\t\t\t\titem.sortIndex < nearest.sortIndex\n\t\t\t\t\t|| nearest.sortIndex <= currentSortIndex\n\t\t\t\t)\n\t\t\t) ? item : nearest;\n\t\t});\n\t}\n\n\tgetFirstChild(itemId: number | string,): ?CheckListModel\n\t{\n\t\tconst children = this.#getCheckLists()\n\t\t\t.filter((item: CheckListModel) => item.parentId === itemId)\n\t\t\t.sort((a: CheckListModel, b: CheckListModel) => a.sortIndex - b.sortIndex);\n\n\t\treturn children[0] || null;\n\t}\n\n\t#getRootParent(item: CheckListModel): ?CheckListModel\n\t{\n\t\tif (!item || item.parentId === 0)\n\t\t{\n\t\t\treturn item || null;\n\t\t}\n\n\t\tconst parentItem = this.#getCheckLists().find((parent: CheckListModel) => parent.id === item.parentId);\n\t\tif (!parentItem)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\treturn this.#getRootParent(parentItem);\n\t}\n\n\t#getCheckLists(): CheckListModel[]\n\t{\n\t\treturn this.#params?.computed?.checkLists() ?? [];\n\t}\n}\n","import { Loc } from 'main.core';\n\nexport const checkListMeta = Object.freeze({\n\tid: 'checklist',\n\ttitle: Loc.getMessage('TASKS_V2_CHECK_LIST_TITLE'),\n});\n","import { BIcon } from 'ui.icon-set.api.vue';\nimport { Animated, Outline } from 'ui.icon-set.api.core';\n\nimport { Model } from 'tasks.v2.const';\nimport type { TaskModel } from 'tasks.v2.model.tasks';\nimport type { CheckListModel } from 'tasks.v2.model.check-list';\nimport { checkListService } from 'tasks.v2.provider.service.check-list-service';\n\nimport { CheckListManager } from '../../lib/check-list-manager';\nimport { checkListMeta } from '../../lib/check-list-meta';\n\nimport './check-list-list.css';\n\n// @vue/component\nexport const CheckListList = {\n\tname: 'TaskCheckListList',\n\tcomponents: {\n\t\tBIcon,\n\t},\n\tprops: {\n\t\ttaskId: {\n\t\t\ttype: [Number, String],\n\t\t\trequired: true,\n\t\t},\n\t},\n\temits: ['open', 'addFastCheckList'],\n\tsetup(): Object\n\t{\n\t\treturn {\n\t\t\tAnimated,\n\t\t\tOutline,\n\t\t\tcheckListMeta,\n\t\t};\n\t},\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tcheckListManager: null,\n\t\t};\n\t},\n\tcomputed: {\n\t\ttask(): TaskModel\n\t\t{\n\t\t\treturn this.$store.getters[`${Model.Tasks}/getById`](this.taskId);\n\t\t},\n\t\tcheckLists(): CheckListModel[]\n\t\t{\n\t\t\treturn this.$store.getters[`${Model.CheckList}/getByIds`](this.task.checklist);\n\t\t},\n\t\tisLoading(): boolean\n\t\t{\n\t\t\treturn this.checkLists.length === 0;\n\t\t},\n\t\tcontainsChecklist(): boolean\n\t\t{\n\t\t\treturn this.task.containsChecklist;\n\t\t},\n\t},\n\tasync created(): void\n\t{\n\t\tthis.checkListManager = new CheckListManager({\n\t\t\tcomputed: {\n\t\t\t\tcheckLists: () => this.checkLists,\n\t\t\t},\n\t\t});\n\n\t\tif (this.containsChecklist)\n\t\t{\n\t\t\tvoid this.loadData();\n\t\t}\n\t},\n\tmethods: {\n\t\tasync loadData(): Promise<void>\n\t\t{\n\t\t\tawait checkListService.load(this.taskId);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div\n\t\t\t:data-task-field-id=\"checkListMeta.id\"\n\t\t\tclass=\"tasks-check-list-list\"\n\t\t\t:class=\"{ '--default': isLoading }\"\n\t\t>\n\t\t\t<div\n\t\t\t\tclass=\"tasks-check-list-list-content\"\n\t\t\t\t:class=\"{ '--default': isLoading }\"\n\t\t\t>\n\t\t\t\t<template v-if=\"isLoading\">\n\t\t\t\t\t<div class=\"tasks-check-list-list-content-row\">\n\t\t\t\t\t\t<BIcon :name=\"Animated.LOADER_WAIT\"/>\n\t\t\t\t\t\t<div class=\"tasks-check-list-list-content-text\">\n\t\t\t\t\t\t\t{{ loc('TASKS_V2_CHECK_LIST_LOADING') }}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</template>\n\t\t\t\t<template v-else>\n\t\t\t\t\t<slot></slot>\n\t\t\t\t\t<div class=\"tasks-check-list-list-content-row --footer\">\n\t\t\t\t\t\t<div\n\t\t\t\t\t\t\tclass=\"tasks-check-list-list-content-btn\"\n\t\t\t\t\t\t\t@click=\"$emit('addFastCheckList')\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<BIcon :name=\"Outline.PLUS_L\"/>\n\t\t\t\t\t\t\t<div class=\"tasks-check-list-list-content-btn-text\">\n\t\t\t\t\t\t\t\t{{ loc('TASKS_V2_CHECK_LIST_ADD_LABEL') }}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</template>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import { Type } from 'main.core';\nimport { Model } from 'tasks.v2.const';\nimport type { TaskModel } from 'tasks.v2.model.tasks';\nimport type { CheckListModel } from 'tasks.v2.model.check-list';\nimport type { UserModel } from 'tasks.v2.model.users';\n\n// @vue/component\nexport const CheckListItemMixin = {\n\tprops: {\n\t\ttaskId: {\n\t\t\ttype: [Number, String],\n\t\t\trequired: true,\n\t\t},\n\t\tid: {\n\t\t\ttype: [Number, String],\n\t\t\trequired: true,\n\t\t},\n\t\tisPreview: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t},\n\temits: [\n\t\t'update',\n\t\t'addItem',\n\t\t'removeItem',\n\t\t'focus',\n\t\t'blur',\n\t\t'emptyBlur',\n\t\t'show',\n\t\t'hide',\n\t],\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tisHovered: false,\n\t\t\tscrollContainer: null,\n\t\t};\n\t},\n\tcomputed: {\n\t\ttask(): TaskModel\n\t\t{\n\t\t\treturn this.$store.getters[`${Model.Tasks}/getById`](this.taskId);\n\t\t},\n\t\tcheckLists(): CheckListModel[]\n\t\t{\n\t\t\treturn this.$store.getters[`${Model.CheckList}/getByIds`](this.task.checklist);\n\t\t},\n\t\titem(): CheckListModel\n\t\t{\n\t\t\treturn this.$store.getters[`${Model.CheckList}/getById`](this.id);\n\t\t},\n\t\tcanModify(): boolean\n\t\t{\n\t\t\treturn this.item.actions.modify === true;\n\t\t},\n\t\tcanRemove(): boolean\n\t\t{\n\t\t\treturn this.item.actions.remove === true;\n\t\t},\n\t\tcanToggle(): boolean\n\t\t{\n\t\t\treturn this.item.actions.toggle === true;\n\t\t},\n\t\thasAttachments(): boolean\n\t\t{\n\t\t\treturn this.hasUsers;\n\t\t},\n\t\thasUsers(): boolean\n\t\t{\n\t\t\treturn (\n\t\t\t\tthis.hasAccomplices\n\t\t\t\t|| this.hasAuditors\n\t\t\t);\n\t\t},\n\t\thasAccomplices(): boolean\n\t\t{\n\t\t\treturn this.accomplices?.length > 0;\n\t\t},\n\t\thasAuditors(): boolean\n\t\t{\n\t\t\treturn this.auditors?.length > 0;\n\t\t},\n\t\taccomplices(): ?UserModel[]\n\t\t{\n\t\t\treturn this.item.accomplices;\n\t\t},\n\t\tauditors(): ?UserModel[]\n\t\t{\n\t\t\treturn this.item.auditors;\n\t\t},\n\t\tfiles(): ?[]\n\t\t{\n\t\t\treturn this.item.attachments;\n\t\t},\n\t\ttextColor(): string\n\t\t{\n\t\t\treturn this.item.isComplete ? 'var(--ui-color-base-4)' : 'var(--ui-color-base-1)';\n\t\t},\n\t\tgroupMode(): boolean\n\t\t{\n\t\t\treturn this.item.groupMode?.active === true;\n\t\t},\n\t\tgroupModeSelected(): boolean\n\t\t{\n\t\t\treturn this.item.groupMode?.selected === true;\n\t\t},\n\t},\n\tmethods: {\n\t\thandleFocus(): void\n\t\t{\n\t\t\tthis.$emit('focus', this.id);\n\t\t},\n\t\thandleBlur(): void\n\t\t{\n\t\t\tthis.$emit('blur', this.id);\n\t\t},\n\t\thandleEmptyBlur(): void\n\t\t{\n\t\t\tthis.$emit('emptyBlur', this.id);\n\t\t},\n\t\tupdateTitle(title: string = ''): void\n\t\t{\n\t\t\tthis.$store.dispatch(`${Model.CheckList}/update`, {\n\t\t\t\tid: this.id,\n\t\t\t\tfields: { title },\n\t\t\t});\n\n\t\t\tthis.$emit('update');\n\t\t},\n\t\taddItem(sort: ?number): void\n\t\t{\n\t\t\tthis.$emit(\n\t\t\t\t'addItem',\n\t\t\t\t{\n\t\t\t\t\tid: this.id,\n\t\t\t\t\tsort: Type.isNumber(sort) ? sort : null,\n\t\t\t\t},\n\t\t\t);\n\t\t},\n\t\tremoveItem(): void\n\t\t{\n\t\t\tthis.$emit('removeItem', this.id);\n\t\t},\n\t\tgetChildren(itemId: number | string): CheckListModel[]\n\t\t{\n\t\t\treturn this.checkLists.filter((item: CheckListModel) => {\n\t\t\t\treturn item.parentId === itemId;\n\t\t\t});\n\t\t},\n\t},\n};\n","import { Event, Text } from 'main.core';\n\nimport { BIcon } from 'ui.icon-set.api.vue';\nimport { BMenu, type MenuOptions, type MenuItemOptions } from 'ui.vue3.components.menu';\nimport { Actions, Outline } from 'ui.icon-set.api.core';\n\nimport { Model } from 'tasks.v2.const';\nimport { GrowingTextArea } from 'tasks.v2.component.elements.growing-text-area';\nimport { UserAvatarList } from 'tasks.v2.component.elements.user-avatar-list';\nimport { ProgressBar } from 'tasks.v2.component.elements.progress-bar';\nimport type { CheckListModel } from 'tasks.v2.model.check-list';\n\nimport { CheckListItemMixin } from './check-list-item-mixin';\n\n// @vue/component\nexport const CheckListParentItem = {\n\tname: 'CheckListParentItem',\n\tcomponents: {\n\t\tBIcon,\n\t\tBMenu,\n\t\tGrowingTextArea,\n\t\tUserAvatarList,\n\t\tProgressBar,\n\t},\n\tmixins: [\n\t\tCheckListItemMixin,\n\t],\n\tinject: ['setItemsRef'],\n\temits: [\n\t\t'toggleCompleted',\n\t\t'startGroupMode',\n\t\t'openCheckList',\n\t],\n\tsetup(): Object\n\t{\n\t\treturn {\n\t\t\tActions,\n\t\t\tOutline,\n\t\t};\n\t},\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tisSticky: false,\n\t\t\tisMenuShown: false,\n\t\t\tmenuRemoveSectionCode: 'removeSection',\n\t\t\tareCompletedCollapsed: false,\n\t\t};\n\t},\n\tcomputed: {\n\t\tmenuOptions(): MenuOptions\n\t\t{\n\t\t\treturn {\n\t\t\t\tid: `check-list-parent-item-action-menu-${Text.getRandom()}`,\n\t\t\t\tbindElement: this.$refs.more.$el,\n\t\t\t\tminWidth: 250,\n\t\t\t\toffsetLeft: -100,\n\t\t\t\tsections: [\n\t\t\t\t\t{\n\t\t\t\t\t\tcode: this.menuRemoveSectionCode,\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t\titems: this.menuItems,\n\t\t\t\ttargetContainer: document.body,\n\t\t\t\tcloseByEsc: true,\n\t\t\t};\n\t\t},\n\t\tmenuItems(): MenuItemOptions[]\n\t\t{\n\t\t\tconst collapseItem = {\n\t\t\t\ttitle: (this.areCompletedCollapsed\n\t\t\t\t\t\t? this.loc('TASKS_V2_CHECK_LIST_ITEM_MENU_SHOW')\n\t\t\t\t\t\t: this.loc('TASKS_V2_CHECK_LIST_ITEM_MENU_HIDE')\n\t\t\t\t),\n\t\t\t\ticon: this.areCompletedCollapsed ? Outline.OBSERVER : Outline.CROSSED_EYE,\n\t\t\t\tdataset: {\n\t\t\t\t\tid: `MenuProfileHide-${this.id}`,\n\t\t\t\t},\n\t\t\t\tonClick: () => {\n\t\t\t\t\tthis.isMenuShown = false;\n\t\t\t\t\tthis.areCompletedCollapsed = !this.areCompletedCollapsed;\n\t\t\t\t\tthis.$emit('toggleCompleted', {\n\t\t\t\t\t\titemId: this.id,\n\t\t\t\t\t\tcollapsed: this.areCompletedCollapsed,\n\t\t\t\t\t});\n\t\t\t\t},\n\t\t\t};\n\n\t\t\tconst groupActionsItem = {\n\t\t\t\ttitle: this.loc('TASKS_V2_CHECK_LIST_ITEM_MENU_GROUP'),\n\t\t\t\ticon: Outline.MULTICHOICE_ON,\n\t\t\t\tdataset: {\n\t\t\t\t\tid: `MenuProfileGroup-${this.id}`,\n\t\t\t\t},\n\t\t\t\tonClick: () => {\n\t\t\t\t\tif (this.item.collapsed === true)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.collapseChildrenItems(this.id);\n\t\t\t\t\t}\n\t\t\t\t\tthis.$emit('startGroupMode', this.id);\n\t\t\t\t\tthis.isMenuShown = false;\n\t\t\t\t},\n\t\t\t};\n\n\t\t\tconst editItem = {\n\t\t\t\tsectionCode: this.menuRemoveSectionCode,\n\t\t\t\ttitle: this.loc('TASKS_V2_CHECK_LIST_ITEM_MENU_EDIT'),\n\t\t\t\ticon: Outline.EDIT_L,\n\t\t\t\tdataset: {\n\t\t\t\t\tid: `MenuProfileEdit-${this.id}`,\n\t\t\t\t},\n\t\t\t\tonClick: () => this.$emit('openCheckList', this.id),\n\t\t\t};\n\n\t\t\tconst removeItem = {\n\t\t\t\tsectionCode: this.menuRemoveSectionCode,\n\t\t\t\tdesign: 'alert',\n\t\t\t\ttitle: this.loc('TASKS_V2_CHECK_LIST_ITEM_MENU_REMOVE'),\n\t\t\t\ticon: Outline.TRASHCAN,\n\t\t\t\tdataset: {\n\t\t\t\t\tid: `MenuProfileRemove-${this.id}`,\n\t\t\t\t},\n\t\t\t\tonClick: this.removeItem.bind(this),\n\t\t\t};\n\n\t\t\tif (this.isPreview)\n\t\t\t{\n\t\t\t\treturn [\n\t\t\t\t\tcollapseItem,\n\t\t\t\t\teditItem,\n\t\t\t\t\tremoveItem,\n\t\t\t\t];\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\treturn [\n\t\t\t\t\tcollapseItem,\n\t\t\t\t\tgroupActionsItem,\n\t\t\t\t\tremoveItem,\n\t\t\t\t];\n\t\t\t}\n\t\t},\n\t\titemIcon(): string\n\t\t{\n\t\t\treturn this.item.isComplete ? Outline.CHECK_L : Outline.CHECK_LIST;\n\t\t},\n\t\tcheckListStatus(): string\n\t\t{\n\t\t\tconst label = this.loc('TASKS_V2_CHECK_LIST_STATUS_LABEL_NEW');\n\n\t\t\treturn label\n\t\t\t\t.replace('#completed#', this.completedCount)\n\t\t\t\t.replace('#total#', this.totalCount);\n\t\t},\n\t\tcompletedCount(): number\n\t\t{\n\t\t\treturn this.checkLists.filter((checklist: CheckListModel) => {\n\t\t\t\treturn checklist.parentId === this.id && checklist.isComplete;\n\t\t\t}).length;\n\t\t},\n\t\ttotalCount(): number\n\t\t{\n\t\t\treturn this.checkLists.filter((checklist: CheckListModel) => {\n\t\t\t\treturn checklist.parentId === this.id;\n\t\t\t}).length;\n\t\t},\n\t},\n\tmounted(): void\n\t{\n\t\tthis.scrollContainer = this.$parent.$el?.closest('[data-list]');\n\n\t\tif (this.setItemsRef)\n\t\t{\n\t\t\tthis.setItemsRef(this.id, this);\n\t\t}\n\n\t\tif (this.scrollContainer)\n\t\t{\n\t\t\tEvent.bind(this.scrollContainer, 'scroll', this.handleScroll);\n\n\t\t\tvoid this.$nextTick(this.checkSticky);\n\n\t\t\tthis.mutationObserver = new MutationObserver(() => {\n\t\t\t\tthis.checkSticky();\n\t\t\t});\n\t\t\tthis.mutationObserver.observe(\n\t\t\t\tthis.scrollContainer,\n\t\t\t\t{\n\t\t\t\t\tchildList: true,\n\t\t\t\t\tsubtree: true,\n\t\t\t\t},\n\t\t\t);\n\t\t}\n\t},\n\tbeforeUnmount(): void\n\t{\n\t\tif (this.scrollContainer)\n\t\t{\n\t\t\tEvent.unbind(this.scrollContainer, 'scroll', this.handleScroll);\n\t\t}\n\n\t\tif (this.mutationObserver)\n\t\t{\n\t\t\tthis.mutationObserver.disconnect();\n\t\t}\n\n\t\tif (this.setItemsRef)\n\t\t{\n\t\t\tthis.setItemsRef(this.id, null);\n\t\t}\n\t},\n\tmethods: {\n\t\thandleScroll(): void\n\t\t{\n\t\t\tthis.checkSticky();\n\n\t\t\tthis.isMenuShown = false;\n\t\t},\n\t\tcheckSticky(): void\n\t\t{\n\t\t\tif (!this.scrollContainer || !this.$refs.item)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst stickyRect = this.$refs.item.getBoundingClientRect();\n\t\t\tconst containerRect = this.scrollContainer.getBoundingClientRect();\n\n\t\t\tthis.isSticky = stickyRect.top <= (containerRect.top + stickyRect.height / 2);\n\t\t},\n\t\tshowMenu(): void\n\t\t{\n\t\t\tthis.isMenuShown = true;\n\t\t},\n\t\tcollapseChildrenItems(itemId: number | string): void\n\t\t{\n\t\t\tthis.$store.dispatch(`${Model.CheckList}/update`, {\n\t\t\t\tid: itemId,\n\t\t\t\tfields: {\n\t\t\t\t\tcollapsed: !this.item.collapsed && !this.item.previewCollapsed,\n\t\t\t\t\tpreviewCollapsed: false,\n\t\t\t\t},\n\t\t\t});\n\t\t},\n\t\tisCollapsed(item: CheckListModel): boolean\n\t\t{\n\t\t\treturn (\n\t\t\t\titem.collapsed === true\n\t\t\t\t|| (this.isPreview && item.previewCollapsed === true)\n\t\t\t);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div\n\t\t\tref=\"item\"\n\t\t\tclass=\"check-list-widget-parent-item\"\n\t\t\t:class=\"{\n\t\t\t\t'--complete': item.isComplete,\n\t\t\t\t'--collapsed': isCollapsed(item),\n\t\t\t\t'--preview': isPreview,\n\t\t\t}\"\n\t\t\t:data-id=\"id\"\n\t\t\t:data-parent=\"id\"\n\t\t>\n\t\t\t<div class=\"check-list-widget-parent-item-label-container\">\n\t\t\t\t<BIcon :name=\"itemIcon\"/>\n\t\t\t</div>\n\t\t\t<div class=\"check-list-widget-parent-item-title-container\">\n\t\t\t\t<GrowingTextArea\n\t\t\t\t\tclass=\"check-list-widget-parent-item-title\"\n\t\t\t\t\t:data-check-list-id=\"'check-list-parent-item-title-' + id\"\n\t\t\t\t\t:modelValue=\"item.title\"\n\t\t\t\t\t:placeholder=\"loc('TASKS_V2_CHECK_LIST_ITEM_PLACEHOLDER')\"\n\t\t\t\t\t:readonly=\"groupMode || isPreview\"\n\t\t\t\t\t:fontColor=\"textColor\"\n\t\t\t\t\t:fontSize=\"17\"\n\t\t\t\t\t:lineHeight=\"20\"\n\t\t\t\t\t:fontWeight=\"500\"\n\t\t\t\t\t@update:modelValue=\"updateTitle\"\n\t\t\t\t\t@focus=\"handleFocus\"\n\t\t\t\t\t@blur=\"handleBlur\"\n\t\t\t\t\t@emptyBlur=\"handleEmptyBlur\"\n\t\t\t\t/>\n\t\t\t\t<template v-if=\"hasAttachments\">\n\t\t\t\t\t<div class=\"check-list-widget-item-attach --parent\">\n\t\t\t\t\t\t<div v-if=\"hasUsers\" class=\"check-list-widget-item-attach-users\">\n\t\t\t\t\t\t\t<div v-if=\"hasAccomplices\" class=\"check-list-widget-item-attach-users-list\">\n\t\t\t\t\t\t\t\t<BIcon :name=\"Outline.GROUP\"/>\n\t\t\t\t\t\t\t\t<UserAvatarList :users=\"accomplices\"/>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div v-if=\"hasAuditors\" class=\"check-list-widget-item-attach-users-list\">\n\t\t\t\t\t\t\t\t<BIcon :name=\"Outline.OBSERVER\"/>\n\t\t\t\t\t\t\t\t<UserAvatarList :users=\"auditors\"/>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</template>\n\t\t\t\t<div class=\"check-list-widget-parent-item-title-status\">\n\t\t\t\t\t<div class=\"check-list-widget-parent-item-title-status-label\">\n\t\t\t\t\t\t{{ checkListStatus }}\n\t\t\t\t\t</div>\n\t\t\t\t\t<ProgressBar\n\t\t\t\t\t\t:totalValue=\"totalCount\"\n\t\t\t\t\t\t:completedValue=\"completedCount\"\n\t\t\t\t\t\t:width=\"56\"\n\t\t\t\t\t\t:height=\"5\"\n\t\t\t\t\t\tcolor=\"var(--ui-color-accent-main-primary-alt)\"\n\t\t\t\t\t\tbgColor=\"var(--ui-color-base-7)\"\n\t\t\t\t\t\t:borderRadius=\"30\"\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div class=\"check-list-widget-parent-item-action\">\n\t\t\t\t<div class=\"check-list-widget-parent-item-main-action\">\n\t\t\t\t\t<BIcon ref=\"more\" :name=\"Outline.MORE_L\" @click=\"showMenu\" />\n\t\t\t\t\t<BIcon\n\t\t\t\t\t\t:name=\"isCollapsed(item) ? Actions.CHEVRON_DOWN : Actions.CHEVRON_UP\"\n\t\t\t\t\t\t@click=\"collapseChildrenItems(this.id)\"\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t\t<div v-if=\"isSticky && !isPreview\" class=\"check-list-widget-parent-item-empty\"></div>\n\t\t\t</div>\n\t\t\t<BMenu v-if=\"isMenuShown\" :options=\"menuOptions\" @close=\"isMenuShown = false\"/>\n\t\t</div>\n\t`,\n};\n","import { BIcon } from 'ui.icon-set.api.vue';\nimport { Outline } from 'ui.icon-set.api.core';\nimport { FileStatus } from 'ui.uploader.core';\nimport type { VueUploaderAdapter } from 'ui.uploader.vue';\n\nimport { UserFieldWidgetComponent, type UserFieldWidgetOptions } from 'disk.uploader.user-field-widget';\n\nimport { Model } from 'tasks.v2.const';\nimport { GrowingTextArea } from 'tasks.v2.component.elements.growing-text-area';\nimport { UserAvatarList } from 'tasks.v2.component.elements.user-avatar-list';\nimport { fileService, EntityTypes } from 'tasks.v2.provider.service.file-service';\n\nimport { CheckListItemMixin } from './check-list-item-mixin';\n\n// @vue/component\nexport const CheckListChildItem = {\n\tname: 'CheckListChildItem',\n\tcomponents: {\n\t\tBIcon,\n\t\tGrowingTextArea,\n\t\tUserAvatarList,\n\t\tUserFieldWidgetComponent,\n\t},\n\tmixins: [\n\t\tCheckListItemMixin,\n\t],\n\tinject: ['setItemsRef'],\n\tprops: {\n\t\titemOffset: {\n\t\t\ttype: String,\n\t\t\tdefault: '0',\n\t\t},\n\t},\n\temits: [\n\t\t'toggleIsComplete',\n\t\t'toggleGroupModeSelected',\n\t],\n\tsetup(props: Object): { uploaderAdapter: VueUploaderAdapter }\n\t{\n\t\treturn {\n\t\t\tOutline,\n\t\t\tfileService: fileService.get(props.id, EntityTypes.CheckListItem),\n\t\t\tuploaderAdapter: fileService.get(props.id, EntityTypes.CheckListItem).getAdapter(),\n\t\t};\n\t},\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tuploadingFiles: this.fileService.getFiles(),\n\t\t};\n\t},\n\tcomputed: {\n\t\twidgetOptions(): UserFieldWidgetOptions\n\t\t{\n\t\t\treturn {\n\t\t\t\tisEmbedded: true,\n\t\t\t\twithControlPanel: false,\n\t\t\t\tcanCreateDocuments: false,\n\t\t\t\ttileWidgetOptions: {\n\t\t\t\t\tcompact: true,\n\t\t\t\t\thideDropArea: true,\n\t\t\t\t\treadonly: this.isPreview,\n\t\t\t\t},\n\t\t\t};\n\t\t},\n\t\thasAttachments(): boolean\n\t\t{\n\t\t\treturn this.hasUsers || this.hasFilesAttach;\n\t\t},\n\t\thasFilesAttach(): boolean\n\t\t{\n\t\t\treturn this.hasFiles || this.isUploading || this.hasUploadingError;\n\t\t},\n\t\thasFiles(): boolean\n\t\t{\n\t\t\treturn this.files?.length > 0;\n\t\t},\n\t\tisUploading(): boolean\n\t\t{\n\t\t\treturn this.uploadingFiles.some(({ status }) => [\n\t\t\t\tFileStatus.UPLOADING,\n\t\t\t\tFileStatus.LOADING,\n\t\t\t].includes(status));\n\t\t},\n\t\thasUploadingError(): boolean\n\t\t{\n\t\t\treturn this.uploadingFiles.some(({ status }) => [\n\t\t\t\tFileStatus.UPLOAD_FAILED,\n\t\t\t\tFileStatus.LOAD_FAILED,\n\t\t\t].includes(status));\n\t\t},\n\t\thasTrashcanIcon(): boolean\n\t\t{\n\t\t\treturn (\n\t\t\t\tthis.isHovered\n\t\t\t\t&& !this.item.panelIsShown\n\t\t\t\t&& !this.groupMode\n\t\t\t\t&& !this.isPreview\n\t\t\t);\n\t\t},\n\t},\n\tcreated(): void\n\t{\n\t\tif (this.hasFilesAttach)\n\t\t{\n\t\t\tvoid this.loadFiles();\n\t\t}\n\t},\n\tmounted(): void\n\t{\n\t\tif (this.setItemsRef)\n\t\t{\n\t\t\tthis.setItemsRef(this.id, this);\n\t\t}\n\t},\n\tbeforeUnmount(): void\n\t{\n\t\tif (this.setItemsRef)\n\t\t{\n\t\t\tthis.setItemsRef(this.id, null);\n\t\t}\n\t},\n\tmethods: {\n\t\ttoggleIsComplete(): void\n\t\t{\n\t\t\tif (this.canToggle === false)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.$store.dispatch(`${Model.CheckList}/update`, {\n\t\t\t\tid: this.id,\n\t\t\t\tfields: { isComplete: !this.item.isComplete },\n\t\t\t});\n\n\t\t\tthis.$emit('toggleIsComplete', this.id);\n\t\t},\n\t\ttoggleGroupModeSelected(): void\n\t\t{\n\t\t\tthis.$store.dispatch(`${Model.CheckList}/update`, {\n\t\t\t\tid: this.id,\n\t\t\t\tfields: {\n\t\t\t\t\tgroupMode: {\n\t\t\t\t\t\tactive: true,\n\t\t\t\t\t\tselected: !this.groupModeSelected,\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t});\n\n\t\t\tthis.$emit('toggleGroupModeSelected', this.id);\n\t\t},\n\t\tfocusToItem(): void\n\t\t{\n\t\t\tthis.scrollContainer ??= this.$parent.$el?.closest('[data-list]');\n\n\t\t\tconst offset = 200;\n\n\t\t\tthis.scrollContainer.scrollTo({\n\t\t\t\ttop: this.$refs.item.offsetTop - offset,\n\t\t\t\tbehavior: 'smooth',\n\t\t\t});\n\t\t},\n\t\tfocusToTextarea(event: PointerEvent): void\n\t\t{\n\t\t\tconst ignoreList = new Set([this.$refs.checkbox]);\n\n\t\t\tif (!ignoreList.has(event.target))\n\t\t\t{\n\t\t\t\tthis.$refs.growingTextArea?.focusTextarea();\n\t\t\t}\n\t\t},\n\t\tasync loadFiles(): Promise<void>\n\t\t{\n\t\t\tconst ids = this.files?.map((file) => file?.id ?? file);\n\n\t\t\tawait this.fileService.list(ids ?? []);\n\t\t},\n\t\thandleEnter(): void\n\t\t{\n\t\t\tif (!this.item)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.addItem(this.item.sortIndex + 1);\n\t\t},\n\t\thandleClick(event: PointerEvent): void\n\t\t{\n\t\t\tconst filesWidget = this.$refs['files-widget'];\n\n\t\t\tif (this.isClickInsideFilesWidget(filesWidget?.$el, event.target))\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (this.groupMode)\n\t\t\t{\n\t\t\t\tthis.toggleGroupModeSelected();\n\t\t\t}\n\n\t\t\tif (this.isPreview)\n\t\t\t{\n\t\t\t\tthis.toggleIsComplete();\n\t\t\t}\n\t\t},\n\t\tisClickInsideFilesWidget(filesNode: HTMLElement, target: HTMLElement)\n\t\t{\n\t\t\tif (!filesNode || !target)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tconst excludedClasses = ['ui-tile-uploader-items'];\n\n\t\t\tconst isInsideWidget = filesNode.contains(target);\n\t\t\tif (!isInsideWidget)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tconst hasExcludedClass = excludedClasses.some((className: string) =>\n\t\t\t\ttarget.closest(`.${className}`) !== null\n\t\t\t);\n\n\t\t\treturn !hasExcludedClass;\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div\n\t\t\tref=\"item\"\n\t\t\tclass=\"check-list-widget-child-item\"\n\t\t\t:class=\"{\n\t\t\t\t'--extra-indent': hasUsers && !hasFilesAttach,\n\t\t\t\t'--complete': item.isComplete,\n\t\t\t\t'--group-mode': groupMode,\n\t\t\t\t'--group-mode-selected': groupModeSelected,\n\t\t\t\t'--preview': isPreview,\n\t\t\t}\"\n\t\t\t:data-id=\"id\"\n\t\t\t:style=\"{ marginLeft: itemOffset }\"\n\t\t\t@mouseover=\"isHovered = true\"\n\t\t\t@mouseleave=\"isHovered = false\"\n\t\t\t@click=\"handleClick\"\n\t\t>\n\t\t\t<div class=\"check-list-widget-child-item-base\">\n\t\t\t\t<label\n\t\t\t\t\tclass=\"check-list-widget-child-item-checkbox\"\n\t\t\t\t\t:class=\"{'--important': !item.isImportant}\"\n\t\t\t\t>\n\t\t\t\t\t<input\n\t\t\t\t\t\tref=\"checkbox\"\n\t\t\t\t\t\ttype=\"checkbox\"\n\t\t\t\t\t\t:checked=\"item.isComplete\"\n\t\t\t\t\t\t:disabled=\"!canToggle || groupMode\"\n\t\t\t\t\t\t@click.stop=\"toggleIsComplete\"\n\t\t\t\t\t>\n\t\t\t\t</label>\n\t\t\t\t<div\n\t\t\t\t\tv-if=\"item.isImportant\"\n\t\t\t\t\tclass=\"check-list-widget-child-item-important\"\n\t\t\t\t>\n\t\t\t\t\t<BIcon :name=\"Outline.FIRE_SOLID\" :hoverable=\"false\"/>\n\t\t\t\t</div>\n\t\t\t\t<GrowingTextArea\n\t\t\t\t\tref=\"growingTextArea\"\n\t\t\t\t\tclass=\"check-list-widget-child-item-title\"\n\t\t\t\t\t:data-check-list-id=\"'check-list-child-item-title-' + item.id\"\n\t\t\t\t\t:modelValue=\"item.title\"\n\t\t\t\t\t:placeholder=\"loc('TASKS_V2_CHECK_LIST_ITEM_PLACEHOLDER')\"\n\t\t\t\t\t:readonly=\"groupMode || isPreview\"\n\t\t\t\t\t:fontColor=\"textColor\"\n\t\t\t\t\t:fontSize=\"15\"\n\t\t\t\t\t:lineHeight=\"20\"\n\t\t\t\t\t@update:modelValue=\"updateTitle\"\n\t\t\t\t\t@focus=\"handleFocus\"\n\t\t\t\t\t@blur=\"handleBlur\"\n\t\t\t\t\t@emptyBlur=\"handleEmptyBlur\"\n\t\t\t\t\t@emptyFocus=\"focusToItem\"\n\t\t\t\t\t@enterBlur=\"handleEnter\"\n\t\t\t\t/>\n\t\t\t\t<div\n\t\t\t\t\tv-if=\"hasTrashcanIcon\"\n\t\t\t\t\tclass=\"check-list-widget-child-item-action\"\n\t\t\t\t\t@click=\"removeItem\"\n\t\t\t\t>\n\t\t\t\t\t<BIcon :name=\"Outline.TRASHCAN\"/>\n\t\t\t\t</div>\n\t\t\t\t<div v-else-if=\"groupMode\" class=\"check-list-widget-child-item-action-checkbox\">\n\t\t\t\t\t<input\n\t\t\t\t\t\tref=\"checkbox\"\n\t\t\t\t\t\ttype=\"checkbox\"\n\t\t\t\t\t\t:checked=\"groupModeSelected\"\n\t\t\t\t\t>\n\t\t\t\t</div>\n\t\t\t\t<div v-else class=\"check-list-widget-child-item-action-stub\"></div>\n\t\t\t</div>\n\t\t\t<template v-if=\"hasAttachments\">\n\t\t\t\t<div class=\"check-list-widget-item-attach\">\n\t\t\t\t\t<div v-if=\"hasUsers\" class=\"check-list-widget-item-attach-users\">\n\t\t\t\t\t\t<div v-if=\"hasAccomplices\" class=\"check-list-widget-item-attach-users-list\">\n\t\t\t\t\t\t\t<BIcon :name=\"Outline.GROUP\"/>\n\t\t\t\t\t\t\t<UserAvatarList :users=\"accomplices\"/>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div v-if=\"hasAuditors\" class=\"check-list-widget-item-attach-users-list\">\n\t\t\t\t\t\t\t<BIcon :name=\"Outline.OBSERVER\"/>\n\t\t\t\t\t\t\t<UserAvatarList :users=\"auditors\"/>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div v-if=\"hasFilesAttach\" class=\"check-list-widget-item-attach-files\">\n\t\t\t\t\t\t<div class=\"check-list-widget-item-attach-files-list\">\n\t\t\t\t\t\t\t<UserFieldWidgetComponent\n\t\t\t\t\t\t\t\tref=\"files-widget\"\n\t\t\t\t\t\t\t\t:uploaderAdapter=\"uploaderAdapter\"\n\t\t\t\t\t\t\t\t:widgetOptions=\"widgetOptions\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</template>\n\t\t</div>\n\t`,\n};\n","import { BIcon } from 'ui.icon-set.api.vue';\nimport { Outline } from 'ui.icon-set.api.core';\n\n// @vue/component\nexport const CheckListAddItem = {\n\tname: 'CheckListAddItem',\n\tcomponents: {\n\t\tBIcon,\n\t},\n\tprops: {\n\t\tisPreview: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t},\n\temits: ['addItem'],\n\tsetup(): Object\n\t{\n\t\treturn {\n\t\t\tOutline,\n\t\t};\n\t},\n\ttemplate: `\n\t\t<div\n\t\t\tclass=\"check-list-widget-add-item\"\n\t\t\t:class=\"{'--preview': isPreview}\"\n\t\t\t@click=\"$emit('addItem')\"\n\t\t>\n\t\t\t<div class=\"check-list-widget-add-item-icon\">\n\t\t\t\t<BIcon :name=\"Outline.PLUS_L\"/>\n\t\t\t</div>\n\t\t\t<div class=\"check-list-widget-add-item-title\">\n\t\t\t\t{{ loc('TASKS_V2_CHECK_LIST_ITEM_ADD_BTN') }}\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import { Model } from 'tasks.v2.const';\nimport type { TaskModel } from 'tasks.v2.model.tasks';\nimport type { CheckListModel } from 'tasks.v2.model.check-list';\n\nimport { CheckListManager } from '../../lib/check-list-manager';\n\nimport { CheckListParentItem } from './component/check-list-parent-item';\nimport { CheckListChildItem } from './component/check-list-child-item';\nimport { CheckListAddItem } from './component/check-list-add-item';\n\nimport './check-list-widget.css';\n\n// @vue/component\nexport const CheckListWidget = {\n\tname: 'CheckListWidget',\n\tcomponents: {\n\t\tCheckListParentItem,\n\t\tCheckListChildItem,\n\t\tCheckListAddItem,\n\t},\n\tprops: {\n\t\ttaskId: {\n\t\t\ttype: [Number, String],\n\t\t\trequired: true,\n\t\t},\n\t\tcheckListId: {\n\t\t\ttype: [Number, String],\n\t\t\tdefault: 0,\n\t\t},\n\t\tparentId: {\n\t\t\ttype: [Number, String],\n\t\t\tdefault: 0,\n\t\t},\n\t\tisPreview: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t},\n\temits: [\n\t\t'beforeCreated',\n\t\t'show',\n\t\t'update',\n\t\t'addItem',\n\t\t'addItemFromBtn',\n\t\t'removeItem',\n\t\t'toggleIsComplete',\n\t\t'focus',\n\t\t'blur',\n\t\t'emptyBlur',\n\t\t'toggleCompleted',\n\t\t'startGroupMode',\n\t\t'toggleGroupModeSelected',\n\t\t'openCheckList',\n\t],\n\tdata(): Object\n\t{\n\t\treturn {};\n\t},\n\tcomputed: {\n\t\ttask(): TaskModel\n\t\t{\n\t\t\treturn this.$store.getters[`${Model.Tasks}/getById`](this.taskId);\n\t\t},\n\t\tcheckLists(): CheckListModel[]\n\t\t{\n\t\t\treturn this.$store.getters[`${Model.CheckList}/getByIds`](this.task.checklist);\n\t\t},\n\t\tparentCheckLists(): CheckListModel[]\n\t\t{\n\t\t\treturn this.checkLists\n\t\t\t\t.filter((checkList: CheckListModel) => checkList.parentId === 0)\n\t\t\t\t.sort((a: CheckListModel, b: CheckListModel) => a.sortIndex - b.sortIndex);\n\t\t},\n\t\tsiblings(): CheckListModel[]\n\t\t{\n\t\t\treturn this.checkLists\n\t\t\t\t.filter((item: CheckListModel) => item.parentId === this.parentId)\n\t\t\t\t.sort((a: CheckListModel, b: CheckListModel) => a.sortIndex - b.sortIndex);\n\t\t},\n\t},\n\tcreated(): void\n\t{\n\t\tthis.$emit('beforeCreated');\n\n\t\tthis.checkListManager = new CheckListManager({\n\t\t\tcomputed: {\n\t\t\t\tcheckLists: () => this.checkLists,\n\t\t\t},\n\t\t});\n\t},\n\tmounted(): void\n\t{\n\t\tif (this.checkListId)\n\t\t{\n\t\t\tthis.scrollContainer = this.$root.$el?.querySelector(['[data-list]']);\n\n\t\t\tconst targetParentItem = this.scrollContainer.querySelector([`[data-parent=\"${this.checkListId}\"]`]);\n\n\t\t\tsetTimeout(() => {\n\t\t\t\tthis.scrollContainer.scrollTop = targetParentItem.offsetTop;\n\t\t\t}, 0);\n\t\t}\n\n\t\tthis.$emit('show');\n\t},\n\tmethods: {\n\t\tgetItemOffset(item: CheckListModel): string\n\t\t{\n\t\t\tif (item.parentId === 0)\n\t\t\t{\n\t\t\t\treturn '0';\n\t\t\t}\n\n\t\t\tconst level = this.checkListManager.getItemLevel(item);\n\t\t\tif (level === 1)\n\t\t\t{\n\t\t\t\treturn '0';\n\t\t\t}\n\n\t\t\treturn `${(level - 1) * 12}px`;\n\t\t},\n\t\tisFirstVisibleItem(index): boolean\n\t\t{\n\t\t\tif (this.isPreview === true)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tconst siblings = this.siblings;\n\n\t\t\tconst firstVisibleIndex = siblings.findIndex((item) => !item.hidden);\n\n\t\t\treturn firstVisibleIndex !== -1 && firstVisibleIndex === index;\n\t\t},\n\t\tgetChildren(parent: CheckListModel): CheckListModel[]\n\t\t{\n\t\t\tif (this.isCollapsed(parent))\n\t\t\t{\n\t\t\t\treturn [];\n\t\t\t}\n\n\t\t\treturn this.checkListManager.getAllChildren(parent.id);\n\t\t},\n\t\tisCollapsed(item: CheckListModel): boolean\n\t\t{\n\t\t\treturn (\n\t\t\t\titem.collapsed === true\n\t\t\t\t|| (this.isPreview && item.previewCollapsed === true)\n\t\t\t);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"check-list-widget-container\">\n\t\t\t<ul class=\"check-list-widget --parent\" :class=\"{'--preview': isPreview}\">\n\t\t\t\t<template v-for=\"(parentItem, parentItemIndex) in parentCheckLists\" :key=\"parentItem.id\">\n\t\t\t\t\t<li\n\t\t\t\t\t\tclass=\"check-list-widget-item --parent\"\n\t\t\t\t\t\t:class=\"{\n\t\t\t\t\t\t\t'--first-visible': parentId === 0 && isFirstVisibleItem(parentItemIndex),\n\t\t\t\t\t\t\t'--hidden': parentItem.hidden,\n\t\t\t\t\t\t\t'--collapsed': isCollapsed(parentItem),\n\t\t\t\t\t\t\t'--preview': isPreview,\n\t\t\t\t\t\t}\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<CheckListParentItem\n\t\t\t\t\t\t\t:id=\"parentItem.id\"\n\t\t\t\t\t\t\t:taskId=\"taskId\"\n\t\t\t\t\t\t\t:isPreview=\"isPreview\"\n\t\t\t\t\t\t\t@update=\"$emit('update')\"\n\t\t\t\t\t\t\t@removeItem=\"(id) => $emit('removeItem', id)\"\n\t\t\t\t\t\t\t@focus=\"(id) => $emit('focus', id)\"\n\t\t\t\t\t\t\t@blur=\"(id) => $emit('blur', id)\"\n\t\t\t\t\t\t\t@emptyBlur=\"(id) => $emit('emptyBlur', id)\"\n\t\t\t\t\t\t\t@toggleCompleted=\"(data) => $emit('toggleCompleted', data)\"\n\t\t\t\t\t\t\t@startGroupMode=\"(id) => $emit('startGroupMode', id)\"\n\t\t\t\t\t\t\t@openCheckList=\"(id) => $emit('openCheckList', id)\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<TransitionGroup name=\"list\" tag=\"ul\" class=\"check-list-widget\">\n\t\t\t\t\t\t\t<template\n\t\t\t\t\t\t\t\tv-for=\"childItem in getChildren(parentItem)\"\n\t\t\t\t\t\t\t\t:key=\"childItem.id\n\t\t\t\t\t\t\t\">\n\t\t\t\t\t\t\t\t<li\n\t\t\t\t\t\t\t\t\tclass=\"check-list-widget-item\"\n\t\t\t\t\t\t\t\t\t:class=\"{\n\t\t\t\t\t\t\t\t\t\t'--hidden': childItem.hidden,\n\t\t\t\t\t\t\t\t\t}\"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t<CheckListChildItem\n\t\t\t\t\t\t\t\t\t\t:id=\"childItem.id\"\n\t\t\t\t\t\t\t\t\t\t:taskId=\"taskId\"\n\t\t\t\t\t\t\t\t\t\t:itemOffset=\"getItemOffset(childItem)\"\n\t\t\t\t\t\t\t\t\t\t:isPreview=\"isPreview\"\n\t\t\t\t\t\t\t\t\t\t@update=\"$emit('update')\"\n\t\t\t\t\t\t\t\t\t\t@toggleIsComplete=\"(id) => $emit('toggleIsComplete', id)\"\n\t\t\t\t\t\t\t\t\t\t@addItem=\"(data) => $emit('addItem', data)\"\n\t\t\t\t\t\t\t\t\t\t@removeItem=\"(id) => $emit('removeItem', id)\"\n\t\t\t\t\t\t\t\t\t\t@focus=\"(id) => $emit('focus', id)\"\n\t\t\t\t\t\t\t\t\t\t@blur=\"(id) => $emit('blur', id)\"\n\t\t\t\t\t\t\t\t\t\t@emptyBlur=\"(id) => $emit('emptyBlur', id)\"\n\t\t\t\t\t\t\t\t\t\t@toggleGroupModeSelected=\"(id) => $emit('toggleGroupModeSelected', id)\"\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t</TransitionGroup>\n\t\t\t\t\t\t<Transition name=\"addBtn\" tag=\"div\" class=\"check-list-widget-add-container\">\n\t\t\t\t\t\t\t<CheckListAddItem\n\t\t\t\t\t\t\t\tv-if=\"!isCollapsed(parentItem)\"\n\t\t\t\t\t\t\t\t:isPreview=\"isPreview\"\n\t\t\t\t\t\t\t\t@addItem=\"$emit('addItemFromBtn', parentItem.id)\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</Transition>\n\t\t\t\t\t</li>\n\t\t\t\t</template>\n\t\t\t</ul>\n\t\t</div>\n\t`,\n};\n","import { Outline } from 'ui.icon-set.api.core';\n\nexport const PanelSection = Object.freeze({\n\tImportant: 'important',\n\tAttachments: 'attachments',\n\tMovement: 'movement',\n\tAccomplice: 'accomplice',\n\tAuditor: 'auditor',\n\tForward: 'forward',\n\tDelete: 'delete',\n\tCancel: 'cancel',\n});\n\nexport const PanelAction = Object.freeze({\n\tSetImportant: 'setImportant',\n\tAttachFile: 'attachFile',\n\tMoveRight: 'moveRight',\n\tMoveLeft: 'moveLeft',\n\tAssignAccomplice: 'assignAccomplice',\n\tAssignAuditor: 'assignAuditor',\n\tForward: 'forward',\n\tDelete: 'delete',\n\tCancel: 'cancel',\n});\n\nexport const PanelMeta = Object.freeze({\n\tdefaultSections: [\n\t\t{\n\t\t\tname: PanelSection.Important,\n\t\t\titems: [\n\t\t\t\t{\n\t\t\t\t\ticon: Outline.FIRE,\n\t\t\t\t\tactiveIcon: Outline.FIRE_SOLID,\n\t\t\t\t\taction: PanelAction.SetImportant,\n\t\t\t\t\thint: 'TASKS_V2_CHECK_LIST_ITEM_IMPORTANT_HINT',\n\t\t\t\t\tclassName: '--important',\n\t\t\t\t\thoverable: false,\n\t\t\t\t},\n\t\t\t],\n\t\t},\n\t\t{\n\t\t\tname: PanelSection.Attachments,\n\t\t\titems: [\n\t\t\t\t{\n\t\t\t\t\ticon: Outline.ATTACH,\n\t\t\t\t\taction: PanelAction.AttachFile,\n\t\t\t\t\thint: 'TASKS_V2_CHECK_LIST_ITEM_ATTACH_HINT',\n\t\t\t\t},\n\t\t\t],\n\t\t},\n\t\t{\n\t\t\tname: PanelSection.Movement,\n\t\t\titems: [\n\t\t\t\t{\n\t\t\t\t\ticon: Outline.POINT_RIGHT,\n\t\t\t\t\taction: PanelAction.MoveRight,\n\t\t\t\t\thint: 'TASKS_V2_CHECK_LIST_ITEM_MOVE_RIGHT_HINT',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\ticon: Outline.POINT_LEFT,\n\t\t\t\t\taction: PanelAction.MoveLeft,\n\t\t\t\t\thint: 'TASKS_V2_CHECK_LIST_ITEM_MOVE_LEFT_HINT',\n\t\t\t\t},\n\t\t\t],\n\t\t},\n\t\t{\n\t\t\tname: PanelSection.Accomplice,\n\t\t\titems: [\n\t\t\t\t{\n\t\t\t\t\ticon: Outline.PERSON,\n\t\t\t\t\taction: PanelAction.AssignAccomplice,\n\t\t\t\t\thint: 'TASKS_V2_CHECK_LIST_ITEM_ACCOMPLICE_HINT',\n\t\t\t\t},\n\t\t\t],\n\t\t},\n\t\t{\n\t\t\tname: PanelSection.Auditor,\n\t\t\titems: [\n\t\t\t\t{\n\t\t\t\t\ticon: Outline.OBSERVER,\n\t\t\t\t\taction: PanelAction.AssignAuditor,\n\t\t\t\t\thint: 'TASKS_V2_CHECK_LIST_ITEM_AUDITOR_HINT',\n\t\t\t\t},\n\t\t\t],\n\t\t},\n\t\t{\n\t\t\tname: PanelSection.Forward,\n\t\t\titems: [\n\t\t\t\t{\n\t\t\t\t\ticon: Outline.FORWARD,\n\t\t\t\t\taction: PanelAction.Forward,\n\t\t\t\t\thint: 'TASKS_V2_CHECK_LIST_ITEM_FORWARD_HINT',\n\t\t\t\t},\n\t\t\t],\n\t\t},\n\t\t{\n\t\t\tname: PanelSection.Delete,\n\t\t\titems: [\n\t\t\t\t{\n\t\t\t\t\ticon: Outline.TRASHCAN,\n\t\t\t\t\taction: PanelAction.Delete,\n\t\t\t\t\thint: 'TASKS_V2_CHECK_LIST_ITEM_REMOVE_HINT',\n\t\t\t\t},\n\t\t\t],\n\t\t},\n\t\t{\n\t\t\tname: PanelSection.Cancel,\n\t\t\titems: [\n\t\t\t\t{\n\t\t\t\t\ticon: Outline.CROSS_L,\n\t\t\t\t\taction: PanelAction.Cancel,\n\t\t\t\t\thint: 'TASKS_V2_CHECK_LIST_ITEM_CANCEL_HINT',\n\t\t\t\t},\n\t\t\t],\n\t\t},\n\t],\n});\n\nexport type Section = {\n\tname: string,\n\titems: Item[],\n};\n\nexport type Item = {\n\ticon: string,\n\tactiveIcon?: string,\n\taction: string,\n\tlabel?: string,\n\thint?: string,\n\tactive?: boolean,\n\thoverable?: boolean,\n\tdisabled?: boolean,\n\tclassName?: string,\n};\n\nexport type VisibleSections = Section[];\nexport type VisibleActions = string[];\nexport type ActiveActions = string[];\n","import { hint, type HintParams } from 'ui.vue3.directives.hint';\nimport { BIcon } from 'ui.icon-set.api.vue';\nimport 'tasks.v2.component.elements.hint';\n\nimport { PanelMeta } from './check-list-item-panel-meta';\n// eslint-disable-next-line no-unused-vars\nimport type { VisibleSections, VisibleActions, Section, Item } from './check-list-item-panel-meta';\n\nimport './check-list-item-panel.css';\n\n// @vue/component\nexport const CheckListItemPanel = {\n\tname: 'CheckListItemPanel',\n\tcomponents: {\n\t\tBIcon,\n\t},\n\tdirectives: { hint },\n\tprops: {\n\t\t/** @type VisibleActions */\n\t\tvisibleSections: {\n\t\t\ttype: Array,\n\t\t\tdefault: () => PanelMeta.defaultSections.map((section: Section) => section.name),\n\t\t},\n\t\tvisibleActions: {\n\t\t\ttype: Array,\n\t\t\tdefault: () => [],\n\t\t},\n\t\tdisabledActions: {\n\t\t\ttype: Array,\n\t\t\tdefault: () => [],\n\t\t},\n\t\tactiveActions: {\n\t\t\ttype: Array,\n\t\t\tdefault: () => [],\n\t\t},\n\t},\n\temits: ['action'],\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tcurrentHintElement: null,\n\t\t\tcurrentHintText: '',\n\t\t};\n\t},\n\tcomputed: {\n\t\tsections(): VisibleSections\n\t\t{\n\t\t\treturn PanelMeta.defaultSections\n\t\t\t\t.filter((section) => this.visibleSections.includes(section.name))\n\t\t\t\t.map((section) => ({\n\t\t\t\t\t...section,\n\t\t\t\t\titems: section.items\n\t\t\t\t\t\t.filter((item: Item) => this.visibleActions.includes(item.action))\n\t\t\t\t\t\t.map((item: Item) => ({\n\t\t\t\t\t\t\t...item,\n\t\t\t\t\t\t\tdisabled: this.isItemDisabled(item),\n\t\t\t\t\t\t\tactive: this.isItemActive(item),\n\t\t\t\t\t\t\thoverable: item.hoverable ?? true,\n\t\t\t\t\t\t})),\n\t\t\t\t}))\n\t\t\t\t.filter((section) => section.items.length > 0)\n\t\t\t;\n\t\t},\n\t\ttooltip(): Function\n\t\t{\n\t\t\treturn (): HintParams => ({\n\t\t\t\ttext: this.currentHintText,\n\t\t\t\ttimeout: 500,\n\t\t\t\tpopupOptions: {\n\t\t\t\t\tclassName: 'tasks-hint',\n\t\t\t\t\tbackground: 'var(--ui-color-bg-content-inapp)',\n\t\t\t\t\tdarkMode: false,\n\t\t\t\t\toffsetLeft: -(this.currentHintElement?.offsetWidth ?? 0),\n\t\t\t\t\tpadding: 6,\n\t\t\t\t\tbindOptions: {\n\t\t\t\t\t\tforceBindPosition: true,\n\t\t\t\t\t\tforceTop: true,\n\t\t\t\t\t\tposition: 'top',\n\t\t\t\t\t},\n\t\t\t\t\ttargetContainer: document.body,\n\t\t\t\t},\n\t\t\t});\n\t\t},\n\t},\n\tmethods: {\n\t\tisItemDisabled(item: Item): boolean\n\t\t{\n\t\t\treturn item.disabled ?? this.disabledActions.includes(item.action);\n\t\t},\n\t\tisItemActive(item: Item): boolean\n\t\t{\n\t\t\treturn item.active ?? this.activeActions.includes(item.action);\n\t\t},\n\t\tgetItemIcon(item: Item): string\n\t\t{\n\t\t\treturn (item.active && item.activeIcon) ? item.activeIcon : item.icon;\n\t\t},\n\t\thandleItemClick(event: MouseEvent, item: Item): void\n\t\t{\n\t\t\tif (!item.disabled)\n\t\t\t{\n\t\t\t\tthis.$emit('action', {\n\t\t\t\t\taction: item.action,\n\t\t\t\t\tnode: event.currentTarget,\n\t\t\t\t});\n\t\t\t}\n\t\t},\n\t\thandleItemMouseEnter(event: MouseEvent, item: Item): void\n\t\t{\n\t\t\tthis.currentHintElement = event.currentTarget;\n\t\t\tthis.currentHintText = item.hint ? this.loc(item.hint) : null;\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div v-if=\"sections.length > 0\" class=\"check-list-widget-item-panel\" @mousedown.prevent>\n\t\t\t<template v-for=\"section in sections\" :key=\"section.name\">\n\t\t\t\t<div class=\"check-list-widget-item-panel-section\" :class=\"'--' + section.name\">\n\t\t\t\t\t<template v-for=\"item in section.items\" :key=\"item.action\" >\n\t\t\t\t\t\t<div\n\t\t\t\t\t\t\tv-hint=\"tooltip\"\n\t\t\t\t\t\t\tclass=\"check-list-widget-item-panel-section-item\"\n\t\t\t\t\t\t\t:class=\"{\n\t\t\t\t\t\t\t\t'--disabled': item.disabled,\n\t\t\t\t\t\t\t\t'--active': item.active,\n\t\t\t\t\t\t\t\t[item.className]: Boolean(item.className),\n\t\t\t\t\t\t\t}\"\n\t\t\t\t\t\t\t@click=\"handleItemClick($event, item)\"\n\t\t\t\t\t\t\t@mouseenter=\"handleItemMouseEnter($event, item)\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<BIcon :name=\"getItemIcon(item)\" :hoverable=\"item.hoverable\"/>\n\t\t\t\t\t\t\t<span v-if=\"item.label\">{{ loc(item.label) }}</span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</template>\n\t\t\t\t</div>\n\t\t\t</template>\n\t\t</div>\n\t`,\n};\n","import { Loc, Text, Type } from 'main.core';\nimport { EventEmitter } from 'main.core.events';\nimport { UI } from 'ui.notification';\n\ntype Params = {\n\tcontent: string,\n\ttimerValue?: number,\n}\n\nexport class CheckListNotifier extends EventEmitter\n{\n\t#interval: ?number = null;\n\t#timerValue: number = 5;\n\t#counter: number = 5;\n\t#content: string = '';\n\n\t#balloonWithTimer: BX.UI.Notification.Balloon;\n\n\tconstructor(params: Params)\n\t{\n\t\tsuper();\n\n\t\tthis.setEventNamespace('Tasks.V2.CheckList.CheckListNotifier');\n\n\t\tthis.#content = params.content;\n\t\tthis.#timerValue = Type.isUndefined(params.timerValue) ? this.#timerValue : params.timerValue;\n\t}\n\n\tshowBalloonWithTimer(): void\n\t{\n\t\tthis.#counter = this.#timerValue;\n\n\t\tthis.#balloonWithTimer = UI.Notification.Center.notify({\n\t\t\tid: `check-list-balloon-${Text.getRandom()}`,\n\t\t\tcontent: this.#getBalloonContent(),\n\t\t\tactions: [{\n\t\t\t\ttitle: Loc.getMessage('TASKS_V2_CHECK_LIST_BALLOON_CANCEL'),\n\t\t\t\tevents: {\n\t\t\t\t\tmouseup: this.#handleCancelClick.bind(this),\n\t\t\t\t},\n\t\t\t}],\n\t\t\tevents: {\n\t\t\t\tonClose: this.#handleClosingBalloon.bind(this),\n\t\t\t},\n\t\t});\n\n\t\tthis.#startTimer();\n\t}\n\n\t#startTimer(): void\n\t{\n\t\tthis.#interval = setInterval(() => {\n\t\t\tthis.#counter--;\n\n\t\t\tthis.#balloonWithTimer.update({ content: this.#getBalloonContent() });\n\n\t\t\tif (this.#counter <= 0)\n\t\t\t{\n\t\t\t\tthis.#balloonWithTimer.close();\n\n\t\t\t\tthis.emit('complete', true);\n\t\t\t}\n\t\t}, 1000);\n\t}\n\n\t#handleCancelClick()\n\t{\n\t\tthis.#balloonWithTimer.close();\n\t}\n\n\t#handleClosingBalloon()\n\t{\n\t\tclearInterval(this.#interval);\n\n\t\tthis.emit('complete', false);\n\t}\n\n\t#getBalloonContent(): string\n\t{\n\t\treturn this.#content.replace('#countdown#', this.#counter);\n\t}\n}\n","import { Dom, Event, Text, Type } from 'main.core';\nimport { BaseEvent, EventEmitter } from 'main.core.events';\nimport { Popup } from 'main.popup';\n\nimport { Item } from 'ui.entity-selector';\nimport type { MenuItemOptions, MenuOptions } from 'ui.system.menu';\nimport { Button as UiButton, AirButtonStyle, ButtonSize, ButtonIcon } from 'ui.vue3.components.button';\nimport { BIcon } from 'ui.icon-set.api.vue';\nimport { BMenu } from 'ui.vue3.components.menu';\nimport { Outline } from 'ui.icon-set.api.core';\n\nimport { Model } from 'tasks.v2.const';\nimport { participantMeta } from 'tasks.v2.component.elements.participant-list';\nimport { Core } from 'tasks.v2.core';\nimport { EntitySelectorDialog } from 'tasks.v2.lib.entity-selector-dialog';\nimport { checkListService } from 'tasks.v2.provider.service.check-list-service';\nimport { EntityTypes, fileService } from 'tasks.v2.provider.service.file-service';\n\nimport type { UserModel } from 'tasks.v2.model.users';\nimport type { CheckListModel } from 'tasks.v2.model.check-list';\nimport type { TaskModel } from 'tasks.v2.model.tasks';\n\nimport { CheckListStub } from './check-list-stub';\nimport { CheckListPopup } from '../check-list-popup/check-list-popup';\nimport { CheckListSheet } from '../check-list-sheet/check-list-sheet';\nimport { CheckListList } from '../check-list-list/check-list-list';\nimport { CheckListWidget } from '../check-list-widget/check-list-widget';\nimport { CheckListItemPanel } from '../check-list-item-panel/check-list-item-panel';\n\nimport { CheckListManager } from '../../lib/check-list-manager';\nimport { CheckListNotifier } from '../../lib/check-list-notifier';\n\nimport {\n\tPanelAction,\n\ttype VisibleActions,\n\ttype ActiveActions,\n} from '../check-list-item-panel/check-list-item-panel-meta';\n\nimport './check-list.css';\n\n// @vue/component\nexport const CheckList = {\n\tname: 'TaskCheckList',\n\tcomponents: {\n\t\tCheckListWidget,\n\t\tCheckListItemPanel,\n\t\tCheckListStub,\n\t\tUiButton,\n\t\tBIcon,\n\t\tBMenu,\n\t},\n\tprovide(): Object\n\t{\n\t\treturn {\n\t\t\tsetItemsRef: this.setItemsRef,\n\t\t\tgetItemsRef: this.getItemsRef,\n\t\t};\n\t},\n\tprops: {\n\t\ttaskId: {\n\t\t\ttype: [Number, String],\n\t\t\trequired: true,\n\t\t},\n\t\tisAutonomous: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t\tisPreview: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t\tisComponentShown: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: true,\n\t\t},\n\t\tcheckListId: {\n\t\t\ttype: [Number, String],\n\t\t\tdefault: 0,\n\t\t},\n\t\tisShown: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t},\n\temits: ['show', 'close', 'resize', 'open'],\n\tsetup(): Object\n\t{\n\t\treturn {\n\t\t\tresizeObserver: null,\n\t\t\tAirButtonStyle,\n\t\t\tButtonSize,\n\t\t\tButtonIcon,\n\t\t\tOutline,\n\t\t};\n\t},\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tcheckListManager: null,\n\t\t\titemPanelIsShown: false,\n\t\t\tcheckListWasUpdated: false,\n\t\t\titemId: null,\n\t\t\titemPanelStyles: {\n\t\t\t\ttop: '0',\n\t\t\t\tdisplay: 'flex',\n\t\t\t},\n\t\t\tisItemPanelFreeze: false,\n\t\t\titemPanelTopOffset: this.isAutonomous ? 5 : 2,\n\t\t\titemPanelTopLimit: this.isAutonomous ? 450 : 700,\n\t\t\titemsRefs: {},\n\t\t\tisForwardMenuShown: false,\n\t\t\tforwardMenuSectionCode: 'createSection',\n\t\t\tforwardBindElement: null,\n\t\t\titemsToDelete: [],\n\t\t\tcollapsedItems: new Map(),\n\t\t\tshownPopups: new Set(),\n\t\t};\n\t},\n\tcomputed: {\n\t\tcomponentName(): Object\n\t\t{\n\t\t\tif (this.isAutonomous)\n\t\t\t{\n\t\t\t\treturn CheckListPopup;\n\t\t\t}\n\t\t\telse if (this.isPreview)\n\t\t\t{\n\t\t\t\treturn CheckListList;\n\t\t\t}\n\n\t\t\treturn CheckListSheet;\n\t\t},\n\t\tcomponentShown(): boolean\n\t\t{\n\t\t\tif (this.isPreview)\n\t\t\t{\n\t\t\t\treturn this.isComponentShown;\n\t\t\t}\n\n\t\t\treturn true;\n\t\t},\n\t\tisEdit(): boolean\n\t\t{\n\t\t\treturn Type.isNumber(this.taskId) && this.taskId > 0;\n\t\t},\n\t\ttask(): TaskModel\n\t\t{\n\t\t\treturn this.$store.getters[`${Model.Tasks}/getById`](this.taskId);\n\t\t},\n\t\tcheckLists(): CheckListModel[]\n\t\t{\n\t\t\treturn this.$store.getters[`${Model.CheckList}/getByIds`](this.task.checklist);\n\t\t},\n\t\tparentCheckLists(): CheckListModel[]\n\t\t{\n\t\t\treturn this.checkLists.filter((checkList: CheckListModel) => checkList.parentId === 0);\n\t\t},\n\t\thasFewParentCheckLists(): boolean\n\t\t{\n\t\t\treturn this.parentCheckLists.length > 1;\n\t\t},\n\t\titem(): ?CheckListModel\n\t\t{\n\t\t\treturn this.$store.getters[`${Model.CheckList}/getById`](this.itemId);\n\t\t},\n\t\titemGroupModeSelected(): boolean\n\t\t{\n\t\t\tif (!this.item)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\treturn this.item.groupMode?.selected === true;\n\t\t},\n\t\tvisiblePanelActions(): VisibleActions\n\t\t{\n\t\t\tif (!this.item)\n\t\t\t{\n\t\t\t\treturn [];\n\t\t\t}\n\n\t\t\tlet actions = [\n\t\t\t\tPanelAction.SetImportant,\n\t\t\t\tPanelAction.MoveRight,\n\t\t\t\tPanelAction.MoveLeft,\n\t\t\t\tPanelAction.AssignAccomplice,\n\t\t\t\tPanelAction.AssignAuditor,\n\t\t\t\tPanelAction.Forward,\n\t\t\t\tPanelAction.Delete,\n\t\t\t];\n\n\t\t\tif (this.itemGroupModeSelected)\n\t\t\t{\n\t\t\t\tactions.push(PanelAction.Cancel);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tactions.push(PanelAction.AttachFile);\n\t\t\t}\n\n\t\t\tif (this.item.parentId === 0)\n\t\t\t{\n\t\t\t\tactions = [\n\t\t\t\t\tPanelAction.AssignAccomplice,\n\t\t\t\t\tPanelAction.AssignAuditor,\n\t\t\t\t];\n\t\t\t}\n\n\t\t\tconst limits = Core.getParams().limits;\n\t\t\tconst stakeholdersActions = new Set([\n\t\t\t\tPanelAction.AssignAccomplice,\n\t\t\t\tPanelAction.AssignAuditor,\n\t\t\t]);\n\n\t\t\treturn actions.filter((action: string) => {\n\t\t\t\tconst isDisabledStakeholders = stakeholdersActions.has(action) && !limits.stakeholders;\n\n\t\t\t\treturn !isDisabledStakeholders;\n\t\t\t});\n\t\t},\n\t\tdisabledPanelActions(): []\n\t\t{\n\t\t\tif (!this.item)\n\t\t\t{\n\t\t\t\treturn [];\n\t\t\t}\n\n\t\t\tconst disabledActions = [];\n\n\t\t\tconst itemLevel = this.checkListManager.getItemLevel(this.item);\n\t\t\tconst canModify = this.item.actions.modify === true;\n\t\t\tconst canRemove = this.item.actions.remove === true;\n\n\t\t\tconst conditionHandlers = {\n\t\t\t\t[PanelAction.SetImportant]: () => {\n\t\t\t\t\treturn canModify === false;\n\t\t\t\t},\n\t\t\t\t[PanelAction.AttachFile]: () => {\n\t\t\t\t\treturn canModify === false;\n\t\t\t\t},\n\t\t\t\t[PanelAction.MoveLeft]: () => {\n\t\t\t\t\treturn itemLevel === 1 || canModify === false;\n\t\t\t\t},\n\t\t\t\t[PanelAction.MoveRight]: () => {\n\t\t\t\t\treturn (\n\t\t\t\t\t\titemLevel === 5\n\t\t\t\t\t\t|| this.item.sortIndex === 0\n\t\t\t\t\t\t|| canModify === false\n\t\t\t\t\t);\n\t\t\t\t},\n\t\t\t\t[PanelAction.AssignAccomplice]: () => {\n\t\t\t\t\treturn canModify === false;\n\t\t\t\t},\n\t\t\t\t[PanelAction.AssignAuditor]: () => {\n\t\t\t\t\treturn canModify === false;\n\t\t\t\t},\n\t\t\t\t[PanelAction.Forward]: () => {\n\t\t\t\t\treturn (\n\t\t\t\t\t\tcanModify === false\n\t\t\t\t\t\t|| this.item.title === ''\n\t\t\t\t\t);\n\t\t\t\t},\n\t\t\t\t[PanelAction.Delete]: () => {\n\t\t\t\t\treturn (\n\t\t\t\t\t\tcanRemove === false\n\t\t\t\t\t\t|| this.item.title === ''\n\t\t\t\t\t);\n\t\t\t\t},\n\t\t\t};\n\n\t\t\tObject.entries(conditionHandlers)\n\t\t\t\t.forEach(([action: string, condition: function]) => {\n\t\t\t\t\tif (condition())\n\t\t\t\t\t{\n\t\t\t\t\t\tdisabledActions.push(action);\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t;\n\n\t\t\treturn disabledActions;\n\t\t},\n\t\tactivePanelActions(): ActiveActions\n\t\t{\n\t\t\tif (!this.item)\n\t\t\t{\n\t\t\t\treturn [];\n\t\t\t}\n\n\t\t\tconst actions = [];\n\n\t\t\tif (this.item.isImportant)\n\t\t\t{\n\t\t\t\tactions.push(PanelAction.SetImportant);\n\t\t\t}\n\n\t\t\treturn actions;\n\t\t},\n\t\tforwardMenuOptions(): MenuOptions\n\t\t{\n\t\t\treturn {\n\t\t\t\tid: `check-list-item-forward-menu-${this.item.id}`,\n\t\t\t\tbindElement: this.forwardBindElement,\n\t\t\t\tmaxWidth: 400,\n\t\t\t\tmaxHeight: 300,\n\t\t\t\toffsetLeft: -110,\n\t\t\t\tsections: [\n\t\t\t\t\t{\n\t\t\t\t\t\tcode: this.forwardMenuSectionCode,\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t\titems: this.forwardMenuItems,\n\t\t\t\ttargetContainer: document.body,\n\t\t\t};\n\t\t},\n\t\tforwardMenuItems(): MenuItemOptions[]\n\t\t{\n\t\t\tconst checklistItems = this.parentCheckLists\n\t\t\t\t.filter((checkList: CheckListModel) => checkList.id !== this.item.parentId)\n\t\t\t\t.map((checkList: CheckListModel) => ({\n\t\t\t\t\ttitle: checkList.title,\n\t\t\t\t\tdataset: {\n\t\t\t\t\t\tid: `ForwardMenuCheckList-${checkList.id}`,\n\t\t\t\t\t},\n\t\t\t\t\tonClick: () => {\n\t\t\t\t\t\tthis.hideItemPanel();\n\t\t\t\t\t\tif (this.itemGroupModeSelected)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tvoid this.forwardGroupItemsToChecklist(checkList.id);\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.forwardToChecklist(checkList.id);\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t}));\n\n\t\t\treturn [\n\t\t\t\t...checklistItems,\n\t\t\t\t{\n\t\t\t\t\tsectionCode: this.forwardMenuSectionCode,\n\t\t\t\t\ttitle: this.loc('TASKS_V2_CHECK_LIST_ITEM_FORWARD_MENU_CREATE'),\n\t\t\t\t\tdataset: {\n\t\t\t\t\t\tid: `ForwardMenuCreateNew-${this.item.id}`,\n\t\t\t\t\t},\n\t\t\t\t\tonClick: this.forwardToNewChecklist.bind(this),\n\t\t\t\t},\n\t\t\t];\n\t\t},\n\t\tstub(): boolean\n\t\t{\n\t\t\treturn this.checkLists.length === 0 || this.emptyList === true;\n\t\t},\n\t\temptyList(): boolean\n\t\t{\n\t\t\tconst siblings = this.parentCheckLists\n\t\t\t\t.filter((item: CheckListModel) => !this.itemsToDelete.includes(item.id));\n\n\t\t\treturn siblings.length === 0;\n\t\t},\n\t\tcontextClass(): string\n\t\t{\n\t\t\tif (this.isPreview)\n\t\t\t{\n\t\t\t\treturn '--preview';\n\t\t\t}\n\n\t\t\treturn this.isAutonomous ? '--popup' : '--sheet';\n\t\t},\n\t},\n\twatch: {\n\t\tasync titleFieldOffsetHeight(): Promise<void>\n\t\t{\n\t\t\tif (!this.$refs.popupComponent)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tawait this.$nextTick();\n\t\t\tthis.resize();\n\t\t},\n\t\tparentCheckLists(): void\n\t\t{\n\t\t\tif (this.isPreview)\n\t\t\t{\n\t\t\t\tthis.unCollapseFirstParent();\n\t\t\t}\n\t\t},\n\t\tcomponentShown(value: boolean): void\n\t\t{\n\t\t\tif (!this.isPreview)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (value)\n\t\t\t{\n\t\t\t\tthis.subscribeToEvents();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.unsubscribeFromEvents();\n\t\t\t}\n\t\t},\n\t},\n\tcreated(): void\n\t{\n\t\tthis.checkListManager = new CheckListManager({\n\t\t\tcomputed: {\n\t\t\t\tcheckLists: () => this.checkLists,\n\t\t\t},\n\t\t});\n\t},\n\tmounted(): void\n\t{\n\t\tif (this.isAutonomous || this.isPreview)\n\t\t{\n\t\t\tthis.subscribeToEvents();\n\t\t}\n\t},\n\tbeforeUnmount(): void\n\t{\n\t\tif (this.isAutonomous || this.isPreview)\n\t\t{\n\t\t\tthis.unsubscribeFromEvents();\n\t\t}\n\t},\n\tmethods: {\n\t\tsubscribeToEvents(): void\n\t\t{\n\t\t\tEvent.bind(this.$refs.list, 'scroll', this.handleScroll);\n\n\t\t\tEventEmitter.subscribe('BX.Main.Popup:onInit', this.handleInitPopup);\n\t\t\tEventEmitter.subscribe('BX.Main.Popup:onShow', this.handleShowPopup);\n\t\t\tEventEmitter.subscribe('BX.Main.Popup:onClose', this.handleClosePopup);\n\t\t},\n\t\tunsubscribeFromEvents(): void\n\t\t{\n\t\t\tEvent.unbind(this.$refs.list, 'scroll', this.handleScroll);\n\n\t\t\tEventEmitter.unsubscribe('BX.Main.Popup:onInit', this.handleInitPopup);\n\t\t\tEventEmitter.unsubscribe('BX.Main.Popup:onShow', this.handleShowPopup);\n\t\t\tEventEmitter.unsubscribe('BX.Main.Popup:onClose', this.handleClosePopup);\n\t\t},\n\t\thandleBeforeCreated(): void\n\t\t{\n\t\t\tif (this.isPreview)\n\t\t\t{\n\t\t\t\tthis.unCollapseFirstParent();\n\t\t\t}\n\t\t},\n\t\thandleUpdate(): void\n\t\t{\n\t\t\tthis.checkListWasUpdated = true;\n\t\t},\n\t\thandleRemove(itemId: number | string): void\n\t\t{\n\t\t\tthis.itemId = itemId;\n\n\t\t\tthis.freeze();\n\n\t\t\tthis.itemsToDelete = [...this.itemsToDelete, itemId];\n\n\t\t\tthis.hideItem(itemId);\n\n\t\t\tconst messageKey = (\n\t\t\t\tthis.item.parentId === 0\n\t\t\t\t\t? 'TASKS_V2_CHECK_LIST_ITEM_REMOVE_BALLOON_PARENT'\n\t\t\t\t\t: 'TASKS_V2_CHECK_LIST_ITEM_REMOVE_BALLOON_CHILD'\n\t\t\t);\n\n\t\t\tconst notifier = new CheckListNotifier({\n\t\t\t\tcontent: this.loc(messageKey),\n\t\t\t});\n\t\t\tnotifier.subscribeOnce('complete', (baseEvent: BaseEvent) => {\n\t\t\t\tconst timerHasEnded = baseEvent.getData();\n\n\t\t\t\tif (timerHasEnded)\n\t\t\t\t{\n\t\t\t\t\tthis.removeItem(itemId);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.showItem(itemId);\n\t\t\t\t}\n\n\t\t\t\tthis.itemsToDelete = this.itemsToDelete.filter((id) => id !== itemId);\n\n\t\t\t\tthis.unfreeze();\n\t\t\t});\n\n\t\t\tnotifier.showBalloonWithTimer();\n\t\t},\n\t\thandleScroll(): void\n\t\t{\n\t\t\tthis.isForwardMenuShown = false;\n\n\t\t\tthis.updatePanelPosition();\n\t\t},\n\t\thandleShow(data): void\n\t\t{\n\t\t\tthis.$emit('show', data);\n\t\t},\n\t\tasync handleClose(): void\n\t\t{\n\t\t\tthis.cancelGroupMode();\n\n\t\t\tthis.$emit('close');\n\n\t\t\tawait this.saveCheckList();\n\t\t},\n\t\thandleIsShown(isShown: boolean): void\n\t\t{\n\t\t\tif (isShown)\n\t\t\t{\n\t\t\t\tthis.subscribeToEvents();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.unsubscribeFromEvents();\n\t\t\t}\n\t\t},\n\t\thandleInitPopup(baseEvent: BaseEvent): void\n\t\t{\n\t\t\tconst data = baseEvent.getCompatData();\n\n\t\t\tconst bindElement = data[1];\n\t\t\tconst params = data[2];\n\n\t\t\tif (Type.isDomNode(bindElement))\n\t\t\t{\n\t\t\t\tif (this.$refs.list?.contains(bindElement))\n\t\t\t\t{\n\t\t\t\t\tparams.targetContainer = this.$refs.list;\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tparams.targetContainer = document.body;\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\thandleShowPopup(baseEvent: BaseEvent): void\n\t\t{\n\t\t\tconst [popup] = baseEvent.getCompatData();\n\n\t\t\tthis.shownPopups.add(popup.getId());\n\n\t\t\tthis.freeze();\n\t\t},\n\t\thandleClosePopup(baseEvent: BaseEvent): void\n\t\t{\n\t\t\tconst [popup] = baseEvent.getCompatData();\n\n\t\t\tthis.shownPopups.delete(popup.getId());\n\n\t\t\tthis.unfreeze();\n\t\t},\n\t\tasync handleGroupRemove(itemId: number | string): Promise<void>\n\t\t{\n\t\t\tthis.itemId = itemId;\n\n\t\t\tthis.freeze();\n\n\t\t\tthis.itemsToDelete = [...this.itemsToDelete, itemId];\n\n\t\t\tthis.hideItemPanel(itemId);\n\n\t\t\tconst allSelectedItems = this.checkListManager.getAllSelectedItems();\n\n\t\t\tconst nearestItem = this.checkListManager.findNearestItem(this.item, false);\n\t\t\tif (nearestItem)\n\t\t\t{\n\t\t\t\tawait this.updateCheckList(nearestItem.id, {\n\t\t\t\t\tgroupMode: {\n\t\t\t\t\t\tactive: true,\n\t\t\t\t\t\tselected: true,\n\t\t\t\t\t},\n\t\t\t\t});\n\n\t\t\t\tsetTimeout(() => {\n\t\t\t\t\tthis.showItemPanel(nearestItem.id);\n\t\t\t\t}, 0);\n\t\t\t}\n\n\t\t\tallSelectedItems.forEach((item: CheckListModel) => {\n\t\t\t\tthis.hideItem(item.id);\n\t\t\t});\n\n\t\t\tconst messageKey = (\n\t\t\t\tallSelectedItems.length > 1\n\t\t\t\t\t? 'TASKS_V2_CHECK_LIST_ITEM_REMOVE_BALLOON_CHILDREN'\n\t\t\t\t\t: 'TASKS_V2_CHECK_LIST_ITEM_REMOVE_BALLOON_CHILD'\n\t\t\t);\n\n\t\t\tconst notifier = new CheckListNotifier({\n\t\t\t\tcontent: this.loc(messageKey),\n\t\t\t});\n\t\t\tnotifier.subscribeOnce('complete', (baseEvent: BaseEvent) => {\n\t\t\t\tconst timerHasEnded = baseEvent.getData();\n\t\t\t\tallSelectedItems.forEach((item: CheckListModel) => {\n\t\t\t\t\tif (timerHasEnded)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.removeItem(item.id);\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.showItem(item.id);\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.itemsToDelete = this.itemsToDelete.filter((id) => id !== item.id);\n\t\t\t\t});\n\t\t\t\tif (timerHasEnded)\n\t\t\t\t{\n\t\t\t\t\tif (nearestItem && !this.itemsToDelete.includes(nearestItem.id))\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.showItemPanel(nearestItem.id);\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.cancelGroupMode();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.showItemPanel(this.item.id);\n\t\t\t\t}\n\n\t\t\t\tthis.unfreeze();\n\t\t\t});\n\n\t\t\tnotifier.showBalloonWithTimer();\n\t\t},\n\t\thandleToggleIsComplete(itemId: number | string): void\n\t\t{\n\t\t\tthis.syncParentCompletionState(itemId);\n\t\t},\n\t\thandleFocus(itemId: number | string): void\n\t\t{\n\t\t\tthis.showItemPanel(itemId);\n\t\t},\n\t\thandleBlur(itemId: number | string): void\n\t\t{\n\t\t\tthis.itemId = itemId;\n\n\t\t\tif (this.isItemPanelFreeze === false)\n\t\t\t{\n\t\t\t\tthis.hideItemPanel(itemId);\n\t\t\t}\n\t\t},\n\t\thandleEmptyBlur(itemId: number | string): void\n\t\t{\n\t\t\tthis.itemId = itemId;\n\n\t\t\tif (this.item.parentId === 0)\n\t\t\t{\n\t\t\t\tthis.setDefaultCheckListTitle(itemId);\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (this.isItemPanelFreeze === false)\n\t\t\t{\n\t\t\t\tthis.removeItem(itemId);\n\t\t\t}\n\t\t},\n\t\thandleGroupMode(itemId: number | string): void\n\t\t{\n\t\t\tthis.itemId = itemId;\n\n\t\t\tconst firstChild = this.checkListManager.getFirstChild(itemId);\n\t\t\tif (!firstChild)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.activateGroupMode(itemId);\n\t\t\tthis.showItemPanel(firstChild.id);\n\t\t},\n\t\thandleGroupModeSelect(itemId: number | string): void\n\t\t{\n\t\t\tthis.itemId = itemId;\n\n\t\t\tif (this.itemGroupModeSelected)\n\t\t\t{\n\t\t\t\tthis.showItemPanel(itemId);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.showItemPanelOnNearestSelectedItem(itemId);\n\t\t\t}\n\t\t},\n\t\thandlePanelAction({ action, node }: {action: string, node: HTMLElement}): void\n\t\t{\n\t\t\tconst actionHandlers = {\n\t\t\t\t[PanelAction.SetImportant]: (n) => this.setImportant(n),\n\t\t\t\t[PanelAction.AttachFile]: (n) => this.attachFile(n),\n\t\t\t\t[PanelAction.MoveRight]: (n) => this.moveGroupToRight(n),\n\t\t\t\t[PanelAction.MoveLeft]: (n) => this.moveGroupToLeft(n),\n\t\t\t\t[PanelAction.AssignAccomplice]: (n) => {\n\t\t\t\t\tif (!this.isItemPanelFreeze)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.showParticipantDialog(n, 'accomplices');\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t[PanelAction.AssignAuditor]: (n) => {\n\t\t\t\t\tif (!this.isItemPanelFreeze)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.showParticipantDialog(n, 'auditors');\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t[PanelAction.Forward]: (n) => this.forward(n),\n\t\t\t\t[PanelAction.Delete]: (n) => this.delete(n),\n\t\t\t\t[PanelAction.Cancel]: (n) => this.cancelGroupMode(n),\n\t\t\t};\n\n\t\t\tactionHandlers[action]?.(node);\n\t\t},\n\t\thandleOpenCheckList(checkListId: number | string): void\n\t\t{\n\t\t\tvoid this.updateCheckList(checkListId, {\n\t\t\t\tcollapsed: false,\n\t\t\t\tpreviewCollapsed: false,\n\t\t\t});\n\n\t\t\tthis.$emit('open', checkListId);\n\t\t},\n\t\tupdateCheckList(id: number | string, fields: Partial<CheckListModel>): Promise<void>\n\t\t{\n\t\t\treturn this.$store.dispatch(`${Model.CheckList}/update`, { id, fields });\n\t\t},\n\t\tupdateTask(fields: Partial<TaskModel>): Promise<void>\n\t\t{\n\t\t\treturn this.$store.dispatch(`${Model.Tasks}/update`, {\n\t\t\t\tid: this.taskId,\n\t\t\t\tfields,\n\t\t\t});\n\t\t},\n\t\tupsertCheckLists(items: CheckListModel[]): Promise<void>\n\t\t{\n\t\t\treturn this.$store.dispatch(`${Model.CheckList}/upsertMany`, items);\n\t\t},\n\n\t\tinsertCheckList(item: CheckListModel): Promise<void>\n\t\t{\n\t\t\treturn this.$store.dispatch(`${Model.CheckList}/insert`, item);\n\t\t},\n\n\t\tinsertManyCheckLists(items: CheckListModel[]): Promise<void>\n\t\t{\n\t\t\treturn this.$store.dispatch(`${Model.CheckList}/insertMany`, items);\n\t\t},\n\n\t\tdeleteCheckList(id: number | string): Promise<void>\n\t\t{\n\t\t\treturn this.$store.dispatch(`${Model.CheckList}/delete`, id);\n\t\t},\n\t\tasync saveCheckList(): Promise<void>\n\t\t{\n\t\t\tif (this.checkListWasUpdated && this.isEdit)\n\t\t\t{\n\t\t\t\tawait checkListService.save(this.taskId, this.checkLists);\n\t\t\t}\n\n\t\t\tif (!this.isDemoCheckListModified())\n\t\t\t{\n\t\t\t\tthis.removeChecklists();\n\t\t\t}\n\n\t\t\tthis.checkListWasUpdated = false;\n\t\t},\n\t\tisDemoCheckListModified(): boolean\n\t\t{\n\t\t\tif (this.checkLists.length !== 1)\n\t\t\t{\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\tconst [checkList] = this.checkLists;\n\t\t\tconst demoTitle = this.loc('TASKS_V2_CHECK_LIST_TITLE_NUMBER', { '#number#': 1 });\n\n\t\t\treturn (\n\t\t\t\tcheckList.title !== demoTitle\n\t\t\t\t|| checkList.accomplices.length > 0\n\t\t\t\t|| checkList.auditors.length > 0\n\t\t\t);\n\t\t},\n\t\tremoveChecklists(): void\n\t\t{\n\t\t\tthis.checkLists\n\t\t\t\t.filter((checklist: CheckListModel) => checklist.parentId === 0)\n\t\t\t\t.forEach((item: CheckListModel) => {\n\t\t\t\t\tthis.removeItem(item.id);\n\t\t\t\t});\n\t\t},\n\t\tasync addCheckList(empty: boolean = false): Promise<string>\n\t\t{\n\t\t\tconst parentId = Text.getRandom();\n\t\t\tconst childId = Text.getRandom();\n\n\t\t\tconst items = [this.getDataForNewCheckList(parentId)];\n\t\t\tif (!empty)\n\t\t\t{\n\t\t\t\titems.push({\n\t\t\t\t\tid: childId,\n\t\t\t\t\tnodeId: childId,\n\t\t\t\t\tparentId,\n\t\t\t\t\tsortIndex: 0,\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tawait this.insertManyCheckLists(items);\n\t\t\tvoid this.updateTask({ checklist: [...this.task.checklist, parentId, childId] });\n\n\t\t\treturn parentId;\n\t\t},\n\t\tasync addFastCheckList(): void\n\t\t{\n\t\t\tconst checkListId = await this.addCheckList();\n\n\t\t\tthis.handleOpenCheckList(checkListId);\n\t\t},\n\t\tshowForwardMenu(node: HTMLElement): void\n\t\t{\n\t\t\tthis.forwardBindElement = node;\n\n\t\t\tthis.isForwardMenuShown = true;\n\t\t},\n\t\tgetCheckListsNumber(): number\n\t\t{\n\t\t\treturn this.checkLists.filter((checklist: CheckListModel) => {\n\t\t\t\treturn checklist.parentId === 0 && !this.itemsToDelete.includes(checklist.id);\n\t\t\t}).length;\n\t\t},\n\t\tgetDataForNewCheckList(parentId: string): CheckListModel\n\t\t{\n\t\t\treturn {\n\t\t\t\tid: parentId,\n\t\t\t\tnodeId: parentId,\n\t\t\t\ttitle: this.loc('TASKS_V2_CHECK_LIST_TITLE_NUMBER', { '#number#': this.getCountForNewCheckList() }),\n\t\t\t\tsortIndex: this.getSortForNewCheckList(),\n\t\t\t};\n\t\t},\n\t\tgetSortForNewCheckList(): number\n\t\t{\n\t\t\treturn this.getCheckListsNumber();\n\t\t},\n\t\tgetCountForNewCheckList(): number\n\t\t{\n\t\t\treturn this.getCheckListsNumber() + 1;\n\t\t},\n\t\tsetItemsRef(id, ref): void\n\t\t{\n\t\t\tthis.itemsRefs[id] = ref;\n\t\t},\n\t\tgetItemsRef(id): Object\n\t\t{\n\t\t\treturn this.itemsRefs[id];\n\t\t},\n\t\tfocusToItem(itemId: number | string): void\n\t\t{\n\t\t\tvoid this.$nextTick(() => {\n\t\t\t\tthis.getItemsRef(itemId)?.$refs.growingTextArea?.focusTextarea();\n\t\t\t});\n\t\t},\n\t\tshowItem(itemId: number | string): void\n\t\t{\n\t\t\tvoid this.updateCheckList(itemId, { hidden: false });\n\n\t\t\tconst children = this.checkListManager.getChildren(itemId);\n\t\t\tif (children.length > 0)\n\t\t\t{\n\t\t\t\tchildren.forEach((child: CheckListModel) => {\n\t\t\t\t\tthis.showItem(child.id);\n\t\t\t\t});\n\t\t\t}\n\t\t},\n\t\thideItem(itemId: number | string): void\n\t\t{\n\t\t\tvoid this.updateCheckList(itemId, { hidden: true });\n\n\t\t\tconst children = this.checkListManager.getChildren(itemId);\n\t\t\tif (children.length > 0)\n\t\t\t{\n\t\t\t\tchildren.forEach((child: CheckListModel) => {\n\t\t\t\t\tthis.hideItem(child.id);\n\t\t\t\t});\n\t\t\t}\n\t\t},\n\t\taddItem({ id, sort }: {id: number | string, sort: number}): void\n\t\t{\n\t\t\tif (this.hasActiveGroupMode())\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.itemId = id;\n\n\t\t\tconst childId = Text.getRandom();\n\t\t\tconst parentId = this.item.parentId;\n\n\t\t\tthis.resortItemsAfterIndex(parentId, sort);\n\n\t\t\tvoid this.insertCheckList({\n\t\t\t\tid: childId,\n\t\t\t\tnodeId: childId,\n\t\t\t\tparentId,\n\t\t\t\tsortIndex: sort,\n\t\t\t});\n\t\t\tvoid this.updateTask({ checklist: [...this.task.checklist, childId] });\n\n\t\t\tthis.syncParentCompletionState(childId);\n\t\t},\n\t\taddItemFromBtn(checkListId: number | string): void\n\t\t{\n\t\t\tif (this.isPreview)\n\t\t\t{\n\t\t\t\tthis.handleOpenCheckList(checkListId);\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (this.hasActiveGroupMode())\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst childId = Text.getRandom();\n\t\t\tconst sortIndex = this.checkListManager.getChildren(checkListId).length;\n\n\t\t\tvoid this.insertCheckList({\n\t\t\t\tid: childId,\n\t\t\t\tnodeId: childId,\n\t\t\t\tparentId: checkListId,\n\t\t\t\tsortIndex,\n\t\t\t});\n\t\t\tvoid this.updateTask({ checklist: [...this.task.checklist, childId] });\n\n\t\t\tthis.syncParentCompletionState(childId);\n\t\t},\n\t\tremoveItem(id: number | string, isRootCall: boolean = true): void\n\t\t{\n\t\t\tif (!this.task)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.itemId = id;\n\n\t\t\tif (this.item?.title)\n\t\t\t{\n\t\t\t\tthis.checkListWasUpdated = true;\n\t\t\t}\n\n\t\t\tconst parentId = this.item?.parentId || null;\n\t\t\tconst children = this.checkListManager.getChildren(id);\n\n\t\t\tif (children.length > 0)\n\t\t\t{\n\t\t\t\tchildren.forEach((child: CheckListModel) => {\n\t\t\t\t\tthis.removeItem(child.id, false);\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tvoid this.updateTask({ checklist: this.task.checklist.filter((itemId) => itemId !== id) });\n\t\t\tvoid this.deleteCheckList(id);\n\n\t\t\tif (isRootCall)\n\t\t\t{\n\t\t\t\tthis.resortItemsOnLevel(parentId);\n\t\t\t}\n\n\t\t\tthis.syncParentCompletionState(id, parentId);\n\n\t\t\tfileService.delete(id, EntityTypes.CheckListItem);\n\t\t},\n\t\tresortItemsAfterIndex(parentId: number | string, sortIndex: number): void\n\t\t{\n\t\t\tthis.checkListManager.resortItemsAfterIndex(\n\t\t\t\tparentId,\n\t\t\t\tsortIndex,\n\t\t\t\t(updates: CheckListModel[]) => {\n\t\t\t\t\tvoid this.upsertCheckLists(updates);\n\t\t\t\t},\n\t\t\t);\n\t\t},\n\t\tresortItemsOnLevel(parentId: number | string): void\n\t\t{\n\t\t\tthis.checkListManager.resortItemsOnLevel(\n\t\t\t\tparentId,\n\t\t\t\t(updates: CheckListModel[]) => this.upsertCheckLists(updates),\n\t\t\t);\n\t\t},\n\t\tsyncParentCompletionState(itemId: number | string, parentId: number | string): void\n\t\t{\n\t\t\tthis.checkListManager.syncParentCompletionState(\n\t\t\t\titemId,\n\t\t\t\t(id: string | number, fields: Partial<CheckListModel>) => this.updateCheckList(id, fields),\n\t\t\t\tparentId,\n\t\t\t);\n\t\t},\n\t\ttoggleCompleted({ itemId, collapsed }: { itemId: number | string, collapsed: boolean }): void\n\t\t{\n\t\t\tthis.itemId = itemId;\n\n\t\t\tthis.checkListManager.getAllCompletedChildrenChildren(itemId)\n\t\t\t\t.forEach((item: CheckListModel) => {\n\t\t\t\t\tif (collapsed === false)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.showItem(item.id);\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.hideItem(item.id);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t},\n\t\tshowItemPanel(itemId: number | string): void\n\t\t{\n\t\t\tif (this.isPreview)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.itemId = itemId;\n\n\t\t\tthis.itemPanelIsShown = true;\n\n\t\t\tvoid this.updateCheckList(itemId, { panelIsShown: true });\n\n\t\t\tvoid this.$nextTick(() => this.updatePanelPosition());\n\t\t},\n\t\thideItemPanel(itemId: number | string): void\n\t\t{\n\t\t\tif (this.isPreview)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.itemPanelIsShown = false;\n\n\t\t\tif (this.hasActiveGroupMode() && this.checkListManager.getAllSelectedItems().length === 0)\n\t\t\t{\n\t\t\t\tthis.deactivateGroupMode();\n\t\t\t}\n\n\t\t\tconst item = this.checkListManager.getItem(itemId);\n\t\t\tif (item)\n\t\t\t{\n\t\t\t\tvoid this.updateCheckList(itemId, { panelIsShown: false });\n\t\t\t}\n\n\t\t\tthis.isItemPanelFreeze = false;\n\t\t},\n\t\tshowItemPanelOnNearestSelectedItem(itemId: number | string): void\n\t\t{\n\t\t\t// eslint-disable-next-line no-lonely-if\n\t\t\tconst nearestSelectedItem = this.checkListManager.findNearestItem(this.item, true);\n\t\t\tif (nearestSelectedItem)\n\t\t\t{\n\t\t\t\tthis.showItemPanel(nearestSelectedItem.id);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.hideItemPanel(itemId);\n\t\t\t}\n\t\t},\n\t\tupdatePanelPosition()\n\t\t{\n\t\t\tif (this.itemPanelIsShown === false)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst itemRef = this.$refs.list.querySelector([`[data-id=\"${this.item.id}\"]`]);\n\n\t\t\tconst panelRect = Dom.getPosition(this.$refs.panel.$el);\n\t\t\tconst listRect = Dom.getPosition(this.$refs.list);\n\t\t\tconst itemRect = Dom.getRelativePosition(itemRef, this.$refs.list);\n\t\t\tconst isParentItem = (this.item.parentId === 0);\n\n\t\t\tconst paddingOffset = 18;\n\t\t\tconst panelWidth = panelRect.width === 0 ? 304 : panelRect.width;\n\n\t\t\tconst top = itemRect.top - 14;\n\n\t\t\tif (isParentItem)\n\t\t\t{\n\t\t\t\tconst left = listRect.width - panelWidth - (paddingOffset * 2) - 80;\n\t\t\t\tconst display = top > -30 && top < this.itemPanelTopLimit ? 'flex' : 'none';\n\n\t\t\t\tthis.itemPanelStyles = {\n\t\t\t\t\ttop: `${top}px`,\n\t\t\t\t\tleft: `${left}px`,\n\t\t\t\t\tdisplay,\n\t\t\t\t};\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tconst left = listRect.width - panelWidth - paddingOffset;\n\t\t\t\tconst display = top > 40 && top < this.itemPanelTopLimit ? 'flex' : 'none';\n\n\t\t\t\tthis.itemPanelStyles = {\n\t\t\t\t\ttop: `${top}px`,\n\t\t\t\t\tleft: `${left}px`,\n\t\t\t\t\tdisplay,\n\t\t\t\t};\n\t\t\t}\n\t\t},\n\t\tsetImportant(): void\n\t\t{\n\t\t\tif (this.itemGroupModeSelected)\n\t\t\t{\n\t\t\t\tconst updates = this.checkListManager.getAllSelectedItems()\n\t\t\t\t\t.map((item: CheckListModel) => ({\n\t\t\t\t\t\t...item,\n\t\t\t\t\t\tisImportant: !item.isImportant,\n\t\t\t\t\t}));\n\n\t\t\t\tvoid this.upsertCheckLists(updates);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tvoid this.updateCheckList(this.item.id, { isImportant: !this.item.isImportant });\n\t\t\t}\n\n\t\t\tthis.checkListWasUpdated = true;\n\t\t},\n\t\tattachFile(node: HTMLElement): void\n\t\t{\n\t\t\tthis.isItemPanelFreeze = true;\n\n\t\t\tfileService.get(this.item.id, EntityTypes.CheckListItem).browse({\n\t\t\t\tbindElement: node,\n\t\t\t});\n\n\t\t\tfileService.get(this.item.id, EntityTypes.CheckListItem).subscribeOnce('onFileComplete', () => {\n\t\t\t\tthis.isItemPanelFreeze = false;\n\n\t\t\t\tthis.focusToItem(this.item.id);\n\n\t\t\t\tthis.checkListWasUpdated = true;\n\t\t\t});\n\t\t},\n\t\tmoveGroupToRight(): void\n\t\t{\n\t\t\tif (this.itemGroupModeSelected)\n\t\t\t{\n\t\t\t\tthis.checkListManager.getAllSelectedItems()\n\t\t\t\t\t.sort((a: CheckListModel, b: CheckListModel) => a.sortIndex - b.sortIndex)\n\t\t\t\t\t.forEach((item: CheckListModel) => {\n\t\t\t\t\t\tthis.moveRight(item);\n\t\t\t\t\t});\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.moveRight(this.item);\n\t\t\t}\n\t\t},\n\t\tmoveRight(item: CheckListModel): void\n\t\t{\n\t\t\tthis.checkListManager.moveRight(\n\t\t\t\titem,\n\t\t\t\t(updates: CheckListModel[]) => {\n\t\t\t\t\tvoid this.upsertCheckLists(updates);\n\t\t\t\t\tthis.checkListWasUpdated = true;\n\n\t\t\t\t\tif (!item.groupMode?.active)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.focusToItem(item.id);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t);\n\t\t},\n\t\tmoveGroupToLeft(): void\n\t\t{\n\t\t\tif (this.itemGroupModeSelected)\n\t\t\t{\n\t\t\t\tthis.checkListManager.getAllSelectedItems()\n\t\t\t\t\t.sort((a: CheckListModel, b: CheckListModel) => b.sortIndex - a.sortIndex)\n\t\t\t\t\t.forEach((item: CheckListModel) => {\n\t\t\t\t\t\tthis.moveLeft(item);\n\t\t\t\t\t});\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.moveLeft(this.item);\n\t\t\t}\n\t\t},\n\t\tmoveLeft(item: CheckListModel): void\n\t\t{\n\t\t\tthis.checkListManager.moveLeft(\n\t\t\t\titem,\n\t\t\t\t(updates: CheckListModel[]) => {\n\t\t\t\t\tvoid this.upsertCheckLists(updates);\n\t\t\t\t\tthis.checkListWasUpdated = true;\n\n\t\t\t\t\tif (!item.groupMode?.active)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.focusToItem(item.id);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t);\n\t\t},\n\t\tasync forward(node: HTMLElement): Promise<void>\n\t\t{\n\t\t\tif (this.hasFewParentCheckLists)\n\t\t\t{\n\t\t\t\tthis.showForwardMenu(node);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.hideItemPanel();\n\n\t\t\t\tvoid this.forwardToNewChecklist();\n\t\t\t}\n\n\t\t\tthis.checkListWasUpdated = true;\n\t\t},\n\t\tasync forwardToNewChecklist(): Promise<void>\n\t\t{\n\t\t\tconst newParentId = await this.addCheckList(true);\n\n\t\t\tif (this.itemGroupModeSelected)\n\t\t\t{\n\t\t\t\tvoid this.forwardGroupItemsToChecklist(newParentId);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.forwardToChecklist(newParentId);\n\t\t\t}\n\t\t},\n\t\tforwardToChecklist(checkListId: number | string): void\n\t\t{\n\t\t\tconst finalSortIndex = this.checkListManager.getChildren(checkListId).length;\n\n\t\t\tvoid this.updateCheckList(this.item.id, {\n\t\t\t\tparentId: checkListId,\n\t\t\t\tsortIndex: finalSortIndex,\n\t\t\t});\n\n\t\t\tthis.resortItemsOnLevel(checkListId);\n\t\t\tthis.resortItemsOnLevel(this.item.parentId);\n\t\t},\n\t\tasync forwardGroupItemsToChecklist(checkListId: number | string): Promise<void>\n\t\t{\n\t\t\tconst finalSortIndex = this.checkListManager.getChildren(checkListId).length;\n\n\t\t\tconst checkListIdsFromWhichWereForwarded = new Set();\n\n\t\t\tconst allSelectedItems = this.checkListManager.getAllSelectedItems();\n\t\t\tconst nearestItem = this.checkListManager.findNearestItem(this.item, false, allSelectedItems);\n\t\t\tif (nearestItem)\n\t\t\t{\n\t\t\t\tthis.showItemPanel(nearestItem.id);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.cancelGroupMode();\n\t\t\t}\n\n\t\t\tconst allSelectedWithChildren = this.checkListManager.getAllSelectedItemsWithChildren();\n\n\t\t\tconst selectedItemsIds = new Set(allSelectedItems.map((item: CheckListModel) => item.id));\n\n\t\t\tconst updates = [];\n\n\t\t\tallSelectedItems.forEach((item: CheckListModel) => {\n\t\t\t\tconst shouldUpdateParentId = !selectedItemsIds.has(item.parentId);\n\n\t\t\t\tcheckListIdsFromWhichWereForwarded.add(item.parentId);\n\n\t\t\t\tupdates.push({\n\t\t\t\t\t...item,\n\t\t\t\t\tparentId: shouldUpdateParentId ? checkListId : item.parentId,\n\t\t\t\t\tgroupMode: {\n\t\t\t\t\t\tactive: false,\n\t\t\t\t\t\tselected: false,\n\t\t\t\t\t},\n\t\t\t\t\tsortIndex: shouldUpdateParentId ? finalSortIndex : item.sortIndex,\n\t\t\t\t});\n\t\t\t});\n\n\t\t\tallSelectedWithChildren.forEach((item: CheckListModel) => {\n\t\t\t\tif (!selectedItemsIds.has(item.id))\n\t\t\t\t{\n\t\t\t\t\tupdates.push({\n\t\t\t\t\t\t...item,\n\t\t\t\t\t\tgroupMode: {\n\t\t\t\t\t\t\tactive: false,\n\t\t\t\t\t\t\tselected: false,\n\t\t\t\t\t\t},\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tawait this.upsertCheckLists(updates);\n\n\t\t\tif (nearestItem)\n\t\t\t{\n\t\t\t\tvoid this.updateCheckList(nearestItem.id, {\n\t\t\t\t\tgroupMode: {\n\t\t\t\t\t\tactive: true,\n\t\t\t\t\t\tselected: true,\n\t\t\t\t\t},\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tthis.resortItemsOnLevel(checkListId);\n\t\t\tcheckListIdsFromWhichWereForwarded.forEach((id: number | string) => {\n\t\t\t\tthis.resortItemsOnLevel(id);\n\t\t\t});\n\t\t},\n\t\tdelete(): void\n\t\t{\n\t\t\tif (this.itemGroupModeSelected)\n\t\t\t{\n\t\t\t\tvoid this.handleGroupRemove(this.item.id);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.hideItemPanel();\n\t\t\t\tthis.handleRemove(this.item.id);\n\t\t\t}\n\t\t},\n\t\tcancelGroupMode(): void\n\t\t{\n\t\t\tthis.deactivateGroupMode();\n\t\t\tthis.hideItemPanel();\n\t\t},\n\t\tshowParticipantDialog(targetNode: HTMLElement, type: 'accomplices' | 'auditors'): void\n\t\t{\n\t\t\tthis.isItemPanelFreeze = true;\n\t\t\tconst preselected = this.item[type].map((user: UserModel) => ['user', user.id]);\n\n\t\t\tthis.selector ??= new EntitySelectorDialog({\n\t\t\t\t...participantMeta.dialogOptions(this.taskId, 'check-list'),\n\t\t\t\tpreselectedItems: preselected,\n\t\t\t\tpopupOptions: {\n\t\t\t\t\tevents: {\n\t\t\t\t\t\tonShow: (baseEvent: BaseEvent): void => {\n\t\t\t\t\t\t\tconst popup = baseEvent.getTarget();\n\t\t\t\t\t\t\tconst popupWidth = popup.getPopupContainer().offsetWidth;\n\t\t\t\t\t\t\tconst targetNodeWidth = 10;\n\n\t\t\t\t\t\t\tconst offsetLeft = targetNodeWidth - (popupWidth / 2);\n\t\t\t\t\t\t\tconst angleShift = Popup.getOption('angleLeftOffset') - Popup.getOption('angleMinTop');\n\n\t\t\t\t\t\t\tpopup.setAngle({ offset: popupWidth / 2 - angleShift });\n\t\t\t\t\t\t\tpopup.setOffset({ offsetLeft: offsetLeft + Popup.getOption('angleLeftOffset') });\n\t\t\t\t\t\t},\n\t\t\t\t\t\tonClose: (): void => {\n\t\t\t\t\t\t\tconst users = this.selector.getSelectedItems().map((item: Item) => ({\n\t\t\t\t\t\t\t\tid: item.getId(),\n\t\t\t\t\t\t\t\tname: item.getTitle(),\n\t\t\t\t\t\t\t\timage: item.getAvatar(),\n\t\t\t\t\t\t\t\ttype: item.getEntityType(),\n\t\t\t\t\t\t\t}));\n\n\t\t\t\t\t\t\tthis.saveParticipants(this.selector.params.itemId, this.selector.params.type, users);\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\tevents: {\n\t\t\t\t\tonHide: (): void => {\n\t\t\t\t\t\tthis.isItemPanelFreeze = false;\n\n\t\t\t\t\t\tif (!this.itemGroupModeSelected && this.item.id === this.selector.params.itemId)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.focusToItem(this.selector.params.itemId);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tthis.updatePanelPosition();\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t});\n\n\t\t\tthis.selector.selectItemsByIds(preselected);\n\t\t\tthis.selector.params = {\n\t\t\t\titemId: this.item.id,\n\t\t\t\ttype,\n\t\t\t};\n\n\t\t\tthis.selector.showTo(targetNode);\n\t\t},\n\t\tsaveParticipants(id: number | string, type: 'accomplices' | 'auditors', users: UserModel[]): void\n\t\t{\n\t\t\tif (this.itemGroupModeSelected)\n\t\t\t{\n\t\t\t\tconst updates = this.checkListManager.getAllSelectedItems()\n\t\t\t\t\t.map((item: CheckListModel) => ({\n\t\t\t\t\t\t...item,\n\t\t\t\t\t\t[type]: users,\n\t\t\t\t\t}));\n\n\t\t\t\tvoid this.upsertCheckLists(updates);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tvoid this.updateCheckList(id, {\n\t\t\t\t\t[type]: users,\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tconst ids = users.map((user: UserModel) => user.id);\n\t\t\tconst fields = {\n\t\t\t\t[`${type}Ids`]: ids,\n\t\t\t};\n\n\t\t\tvoid this.updateTask(fields);\n\t\t},\n\t\tactivateGroupMode(parentItemId: number | string): void\n\t\t{\n\t\t\tthis.itemId = parentItemId;\n\n\t\t\tconst updates = this.checkListManager.getAllChildren(parentItemId)\n\t\t\t\t.map((item: CheckListModel, index: number) => ({\n\t\t\t\t\t...item,\n\t\t\t\t\tgroupMode: {\n\t\t\t\t\t\tactive: true,\n\t\t\t\t\t\tselected: index === 0,\n\t\t\t\t\t},\n\t\t\t\t}));\n\n\t\t\tupdates.push({\n\t\t\t\t...this.item,\n\t\t\t\tgroupMode: {\n\t\t\t\t\tactive: true,\n\t\t\t\t\tselected: false,\n\t\t\t\t},\n\t\t\t});\n\n\t\t\tvoid this.upsertCheckLists(updates);\n\t\t},\n\t\tdeactivateGroupMode(): void\n\t\t{\n\t\t\tconst updates = this.checkListManager.getAllGroupModeItems()\n\t\t\t\t.map((item: CheckListModel) => ({\n\t\t\t\t\t...item,\n\t\t\t\t\tgroupMode: {\n\t\t\t\t\t\tactive: false,\n\t\t\t\t\t\tselected: false,\n\t\t\t\t\t},\n\t\t\t\t}));\n\n\t\t\tvoid this.upsertCheckLists(updates);\n\t\t},\n\t\thasActiveGroupMode(): boolean\n\t\t{\n\t\t\treturn this.checkListManager.getAllGroupModeItems().length > 0;\n\t\t},\n\t\tfreeze()\n\t\t{\n\t\t\tthis.$refs.childComponent?.$refs?.childComponent?.freeze();\n\t\t},\n\t\tunfreeze()\n\t\t{\n\t\t\tif (\n\t\t\t\tthis.shownPopups.size === 0\n\t\t\t\t&& this.itemsToDelete.length === 0\n\t\t\t)\n\t\t\t{\n\t\t\t\tthis.$refs.childComponent?.$refs?.childComponent?.unfreeze();\n\t\t\t}\n\t\t},\n\t\tsetDefaultCheckListTitle(itemId: number | string): void\n\t\t{\n\t\t\tvoid this.updateCheckList(itemId, {\n\t\t\t\ttitle: this.loc(\n\t\t\t\t\t'TASKS_V2_CHECK_LIST_TITLE_NUMBER',\n\t\t\t\t\t{ '#number#': this.getCheckListsNumber() },\n\t\t\t\t),\n\t\t\t});\n\t\t},\n\t\tunCollapseFirstParent(): void\n\t\t{\n\t\t\tconst firstParent = this.parentCheckLists[0];\n\n\t\t\tif (firstParent.previewCollapsed === true)\n\t\t\t{\n\t\t\t\tvoid this.updateCheckList(firstParent.id, { previewCollapsed: false });\n\t\t\t}\n\t\t},\n\t},\n\ttemplate: `\n\t\t<component\n\t\t\tv-if=\"componentShown\"\n\t\t\tref=\"childComponent\"\n\t\t\t:is=\"componentName\"\n\t\t\t:taskId=\"taskId\"\n\t\t\t:isShown=\"isShown\"\n\t\t\t@show=\"handleShow\"\n\t\t\t@close=\"handleClose\"\n\t\t\t@isShown=\"handleIsShown\"\n\t\t\t@addFastCheckList=\"addFastCheckList\"\n\t\t\t@resize=\"$emit('resize')\"\n\t\t>\n\t\t\t<template v-slot:default=\"{ handleShow, handleClose }\">\n\t\t\t\t<div ref=\"wrapper\" class=\"tasks-check-list-wrapper\" :class=\"contextClass\">\n\t\t\t\t\t<div v-if=\"!isPreview\" class=\"tasks-check-list-close-icon\" :class=\"contextClass\">\n\t\t\t\t\t\t<BIcon :name=\"Outline.CROSS_L\" @click=\"handleClose\"/>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div ref=\"list\" data-list class=\"tasks-check-list-content\" :class=\"contextClass\">\n\t\t\t\t\t\t<CheckListWidget\n\t\t\t\t\t\t\tv-show=\"!stub\"\n\t\t\t\t\t\t\t:taskId=\"taskId\"\n\t\t\t\t\t\t\t:checkListId=\"checkListId\"\n\t\t\t\t\t\t\t:isPreview=\"isPreview\"\n\t\t\t\t\t\t\t@beforeCreated=\"handleBeforeCreated\"\n\t\t\t\t\t\t\t@update=\"handleUpdate\"\n\t\t\t\t\t\t\t@toggleIsComplete=\"handleToggleIsComplete\"\n\t\t\t\t\t\t\t@show=\"handleShow\"\n\t\t\t\t\t\t\t@addItem=\"addItem\"\n\t\t\t\t\t\t\t@addItemFromBtn=\"addItemFromBtn\"\n\t\t\t\t\t\t\t@removeItem=\"handleRemove\"\n\t\t\t\t\t\t\t@focus=\"handleFocus\"\n\t\t\t\t\t\t\t@blur=\"handleBlur\"\n\t\t\t\t\t\t\t@emptyBlur=\"handleEmptyBlur\"\n\t\t\t\t\t\t\t@toggleCompleted=\"toggleCompleted\"\n\t\t\t\t\t\t\t@startGroupMode=\"handleGroupMode\"\n\t\t\t\t\t\t\t@toggleGroupModeSelected=\"handleGroupModeSelect\"\n\t\t\t\t\t\t\t@openCheckList=\"handleOpenCheckList\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<CheckListStub v-if=\"stub\" @click=\"addCheckList\" />\n\t\t\t\t\t</div>\n\t\t\t\t\t<div v-show=\"!stub && !isPreview\" class=\"tasks-check-list-footer\" :class=\"contextClass\">\n\t\t\t\t\t\t<UiButton\n\t\t\t\t\t\t\t:text=\"loc('TASKS_V2_CHECK_LIST_NEW_BTN')\"\n\t\t\t\t\t\t\t:size=\"ButtonSize.MEDIUM\"\n\t\t\t\t\t\t\t:leftIcon=\"ButtonIcon.ADD\"\n\t\t\t\t\t\t\t:style=\"AirButtonStyle.PLAIN_NO_ACCENT\"\n\t\t\t\t\t\t\t@click=\"addCheckList\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<UiButton\n\t\t\t\t\t\t\t:text=\"loc('TASKS_V2_CHECK_LIST_READY_BTN')\"\n\t\t\t\t\t\t\t:size=\"ButtonSize.MEDIUM\"\n\t\t\t\t\t\t\t@click=\"handleClose\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t\t<CheckListItemPanel\n\t\t\t\t\t\tv-if=\"itemPanelIsShown && !isPreview\"\n\t\t\t\t\t\tref=\"panel\"\n\t\t\t\t\t\t:style=\"itemPanelStyles\"\n\t\t\t\t\t\t:visibleActions=\"visiblePanelActions\"\n\t\t\t\t\t\t:disabledActions=\"disabledPanelActions\"\n\t\t\t\t\t\t:activeActions=\"activePanelActions\"\n\t\t\t\t\t\t@action=\"handlePanelAction\"\n\t\t\t\t\t/>\n\t\t\t\t\t<BMenu\n\t\t\t\t\t\tv-if=\"isForwardMenuShown\"\n\t\t\t\t\t\t:options=\"forwardMenuOptions\"\n\t\t\t\t\t\t@close=\"isForwardMenuShown = false\"\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t</template>\n\t\t</component>\n\t`,\n};\n","import { Text } from 'main.core';\n\nimport { Animated, Outline } from 'ui.icon-set.api.core';\nimport 'ui.icon-set.outline';\n\nimport { fieldHighlighter } from 'tasks.v2.lib.field-highlighter';\nimport { Chip, ChipDesign } from 'tasks.v2.component.elements.chip';\nimport { fileService, EntityTypes } from 'tasks.v2.provider.service.file-service';\nimport { EventName, Model } from 'tasks.v2.const';\nimport type { TaskModel } from 'tasks.v2.model.tasks';\nimport type { CheckListModel } from 'tasks.v2.model.check-list';\n\nimport { checkListMeta } from './lib/check-list-meta';\n\n// @vue/component\nexport const CheckListChip = {\n\tcomponents: {\n\t\tChip,\n\t},\n\tprops: {\n\t\ttaskId: {\n\t\t\ttype: [Number, String],\n\t\t\trequired: true,\n\t\t},\n\t\tisAutonomous: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t},\n\temits: ['showCheckList'],\n\tsetup(): Object\n\t{\n\t\treturn {\n\t\t\tOutline,\n\t\t\tcheckListMeta,\n\t\t};\n\t},\n\tcomputed: {\n\t\ttask(): TaskModel\n\t\t{\n\t\t\treturn this.$store.getters[`${Model.Tasks}/getById`](this.taskId);\n\t\t},\n\t\tcheckLists(): CheckListModel[]\n\t\t{\n\t\t\treturn this.$store.getters[`${Model.CheckList}/getByIds`](this.task.checklist);\n\t\t},\n\t\tisUploading(): boolean\n\t\t{\n\t\t\treturn this.task.checklist?.some((itemId) => fileService.get(itemId, EntityTypes.CheckListItem).isUploading());\n\t\t},\n\t\tdesign(): string\n\t\t{\n\t\t\treturn {\n\t\t\t\t[!this.isAutonomous && !this.isSelected]: ChipDesign.Shadow,\n\t\t\t\t[!this.isAutonomous && this.isSelected]: ChipDesign.ShadowAccent,\n\t\t\t\t[this.isAutonomous && !this.isSelected]: ChipDesign.Outline,\n\t\t\t\t[this.isAutonomous && this.isSelected]: ChipDesign.OutlineAccent,\n\t\t\t}.true;\n\t\t},\n\t\tisSelected(): boolean\n\t\t{\n\t\t\treturn this.checkLists.length > 0;\n\t\t},\n\t\tcheckListItemCount(): number\n\t\t{\n\t\t\treturn (this.checkLists.filter((checkList: CheckListModel) => checkList.parentId !== 0)).length;\n\t\t},\n\t\ttext(): string\n\t\t{\n\t\t\tif (this.isAutonomous && this.checkListItemCount > 0)\n\t\t\t{\n\t\t\t\tconst completedCount = this.getCompletedCount();\n\n\t\t\t\treturn this.loc(\n\t\t\t\t\t'TASKS_V2_CHECK_LIST_COUNT_TITLE',\n\t\t\t\t\t{\n\t\t\t\t\t\t'#count#': completedCount,\n\t\t\t\t\t\t'#total#': this.checkListItemCount,\n\t\t\t\t\t},\n\t\t\t\t);\n\t\t\t}\n\n\t\t\treturn this.loc('TASKS_V2_CHECK_LIST_CHIP_TITLE');\n\t\t},\n\t\ticon(): string\n\t\t{\n\t\t\tif (this.isUploading)\n\t\t\t{\n\t\t\t\treturn Animated.LOADER_WAIT;\n\t\t\t}\n\n\t\t\treturn Outline.CHECK_LIST;\n\t\t},\n\t},\n\tmounted(): void\n\t{\n\t\tthis.$bitrix.eventEmitter.subscribe(EventName.CloseCheckList, this.handleFieldClose);\n\t},\n\tbeforeUnmount(): void\n\t{\n\t\tthis.$bitrix.eventEmitter.unsubscribe(EventName.CloseCheckList, this.handleFieldClose);\n\t},\n\tmethods: {\n\t\thandleClick(): void\n\t\t{\n\t\t\tif (this.isAutonomous)\n\t\t\t{\n\t\t\t\tvoid this.showCheckList();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\t// eslint-disable-next-line no-lonely-if\n\t\t\t\tif (this.isSelected)\n\t\t\t\t{\n\t\t\t\t\tthis.highlightField();\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tvoid this.showCheckList();\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\tasync showCheckList(): Promise<void>\n\t\t{\n\t\t\tif (!this.isSelected)\n\t\t\t{\n\t\t\t\tawait this.buildEmptyCheckList();\n\t\t\t}\n\n\t\t\tthis.$emit('showCheckList');\n\t\t},\n\t\tasync buildEmptyCheckList(): Promise<void>\n\t\t{\n\t\t\tconst parentId = Text.getRandom();\n\t\t\tconst childId = Text.getRandom();\n\n\t\t\tawait this.$store.dispatch(`${Model.CheckList}/insertMany`, [\n\t\t\t\t{\n\t\t\t\t\tid: parentId,\n\t\t\t\t\tnodeId: parentId,\n\t\t\t\t\ttitle: this.loc('TASKS_V2_CHECK_LIST_TITLE_NUMBER', { '#number#': 1 }),\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tid: childId,\n\t\t\t\t\tnodeId: childId,\n\t\t\t\t\tparentId,\n\t\t\t\t},\n\t\t\t]);\n\n\t\t\tawait this.$store.dispatch(`${Model.Tasks}/update`, {\n\t\t\t\tid: this.taskId,\n\t\t\t\tfields: {\n\t\t\t\t\tchecklist: [parentId, childId],\n\t\t\t\t},\n\t\t\t});\n\t\t},\n\t\thighlightField(): void\n\t\t{\n\t\t\tvoid fieldHighlighter.setContainer(this.$root.$el).highlight(checkListMeta.id);\n\t\t},\n\t\tgetCompletedCount(): number\n\t\t{\n\t\t\treturn this.checkLists.filter((checklist: CheckListModel) => {\n\t\t\t\treturn checklist.isComplete && checklist.parentId !== 0;\n\t\t\t}).length;\n\t\t},\n\t\thandleFieldClose(): void\n\t\t{\n\t\t\tif (this.isAutonomous)\n\t\t\t{\n\t\t\t\tthis.$refs.chip.focus();\n\t\t\t}\n\t\t},\n\t},\n\ttemplate: `\n\t\t<Chip\n\t\t\t:design=\"design\"\n\t\t\t:icon=\"icon\"\n\t\t\t:text=\"text\"\n\t\t\t:data-task-id=\"taskId\"\n\t\t\t:data-task-chip-id=\"checkListMeta.id\"\n\t\t\tref=\"chip\"\n\t\t\t@click=\"handleClick\"\n\t\t/>\n\t`,\n};\n"],"names":["CheckListStub","name","components","UiButton","emits","setup","ButtonSize","template","CheckListPopup","Popup","inheritAttrs","props","taskId","type","Number","String","required","resizeObserver","computed","popupId","popupOptions","className","width","height","borderRadius","offsetTop","padding","autoHide","closeByEsc","animation","showClassName","closeClassName","closeAnimationType","events","onClose","handleClose","bind","mapGetters","titleFieldOffsetHeight","Model","Interface","watch","$refs","childComponent","$nextTick","resize","created","ResizeObserver","entries","entry","target","wrapper","mounted","Event","window","beforeUnmount","unbind","methods","popupInstance","getPopupInstance","$emit","adjustPosition","handleShow","setTimeout","observe","$parent","disconnect","$bitrix","eventEmitter","emit","EventName","CloseCheckList","CheckListSheet","BottomSheet","isShown","Boolean","data","isExpanded","value","CheckListManager","constructor","params","getItem","itemId","find","item","id","getItemsOnLevel","parentId","filter","sort","a","b","sortIndex","getItemLevel","checkListItem","level","current","visitedIds","Set","findParent","has","add","isItemDescendant","potentialAncestor","parent","i","syncParentCompletionState","updateFn","parentItemId","changedItem","parentItem","childrenItems","isEmptyParent","length","allChildrenCompleted","every","child","isComplete","someChildrenIncomplete","some","shouldUpdateParent","getAllGroupModeItems","groupMode","active","getAllSelectedItems","selected","getAllSelectedItemsWithChildren","result","Map","selectedItems","allItems","forEach","set","getChildren","parentIds","children","includes","map","Array","from","values","getAllChildren","visited","collectChildren","currentId","push","getAllCompletedChildrenChildren","getSiblings","sibling","resortItemsOnLevel","sortedItems","updates","newIndex","resortItemsAfterIndex","itemsToResort","moveRight","itemsOnLevel","currentIndex","findIndex","newParent","candidate","newParentChildren","index","parentNodeId","nodeId","moveLeft","currentParent","parentInNewListIndex","currentSiblingsUpdates","newSortIndex","shiftUpdates","movedItemUpdate","findNearestItem","initialItem","excludeChildrenOf","rootParent","currentSortIndex","excludedParentIds","eligibleItems","isChildOfExcluded","reduce","nearest","getFirstChild","checkLists","checkListMeta","Object","freeze","title","Loc","getMessage","CheckListList","BIcon","Animated","Outline","checkListManager","task","$store","getters","Tasks","CheckList","checklist","isLoading","containsChecklist","loadData","checkListService","load","CheckListItemMixin","isPreview","default","isHovered","scrollContainer","canModify","actions","modify","canRemove","remove","canToggle","toggle","hasAttachments","hasUsers","hasAccomplices","hasAuditors","accomplices","auditors","files","attachments","textColor","groupModeSelected","handleFocus","handleBlur","handleEmptyBlur","updateTitle","dispatch","fields","addItem","Type","isNumber","removeItem","CheckListParentItem","BMenu","GrowingTextArea","UserAvatarList","ProgressBar","mixins","inject","Actions","isSticky","isMenuShown","menuRemoveSectionCode","areCompletedCollapsed","menuOptions","Text","getRandom","bindElement","more","$el","minWidth","offsetLeft","sections","code","items","menuItems","targetContainer","document","body","collapseItem","loc","icon","OBSERVER","CROSSED_EYE","dataset","onClick","collapsed","groupActionsItem","MULTICHOICE_ON","collapseChildrenItems","editItem","sectionCode","EDIT_L","design","TRASHCAN","itemIcon","CHECK_L","CHECK_LIST","checkListStatus","label","replace","completedCount","totalCount","closest","setItemsRef","handleScroll","checkSticky","mutationObserver","MutationObserver","childList","subtree","stickyRect","getBoundingClientRect","containerRect","top","showMenu","previewCollapsed","isCollapsed","CheckListChildItem","UserFieldWidgetComponent","itemOffset","fileService","get","EntityTypes","CheckListItem","uploaderAdapter","getAdapter","uploadingFiles","getFiles","widgetOptions","isEmbedded","withControlPanel","canCreateDocuments","tileWidgetOptions","compact","hideDropArea","readonly","hasFilesAttach","hasFiles","isUploading","hasUploadingError","status","FileStatus","UPLOADING","LOADING","UPLOAD_FAILED","LOAD_FAILED","hasTrashcanIcon","panelIsShown","loadFiles","toggleIsComplete","toggleGroupModeSelected","focusToItem","offset","scrollTo","behavior","focusToTextarea","event","ignoreList","checkbox","growingTextArea","focusTextarea","ids","file","list","handleEnter","handleClick","filesWidget","isClickInsideFilesWidget","filesNode","excludedClasses","isInsideWidget","contains","hasExcludedClass","CheckListAddItem","CheckListWidget","checkListId","parentCheckLists","checkList","siblings","$root","querySelector","targetParentItem","scrollTop","getItemOffset","isFirstVisibleItem","firstVisibleIndex","hidden","PanelSection","Important","Attachments","Movement","Accomplice","Auditor","Forward","Delete","Cancel","PanelAction","SetImportant","AttachFile","MoveRight","MoveLeft","AssignAccomplice","AssignAuditor","PanelMeta","defaultSections","FIRE","activeIcon","FIRE_SOLID","action","hint","hoverable","ATTACH","POINT_RIGHT","POINT_LEFT","PERSON","FORWARD","CROSS_L","CheckListItemPanel","directives","visibleSections","section","visibleActions","disabledActions","activeActions","currentHintElement","currentHintText","disabled","isItemDisabled","isItemActive","tooltip","text","timeout","background","darkMode","offsetWidth","bindOptions","forceBindPosition","forceTop","position","getItemIcon","handleItemClick","node","currentTarget","handleItemMouseEnter","CheckListNotifier","EventEmitter","setEventNamespace","content","isUndefined","timerValue","showBalloonWithTimer","UI","Notification","Center","notify","mouseup","setInterval","update","close","clearInterval","provide","getItemsRef","isAutonomous","isComponentShown","AirButtonStyle","ButtonIcon","itemPanelIsShown","checkListWasUpdated","itemPanelStyles","display","isItemPanelFreeze","itemPanelTopOffset","itemPanelTopLimit","itemsRefs","isForwardMenuShown","forwardMenuSectionCode","forwardBindElement","itemsToDelete","collapsedItems","shownPopups","componentName","componentShown","isEdit","hasFewParentCheckLists","itemGroupModeSelected","visiblePanelActions","limits","Core","getParams","stakeholdersActions","isDisabledStakeholders","stakeholders","disabledPanelActions","itemLevel","conditionHandlers","condition","activePanelActions","isImportant","forwardMenuOptions","maxWidth","maxHeight","forwardMenuItems","checklistItems","hideItemPanel","forwardGroupItemsToChecklist","forwardToChecklist","forwardToNewChecklist","stub","emptyList","contextClass","popupComponent","unCollapseFirstParent","subscribeToEvents","unsubscribeFromEvents","subscribe","handleInitPopup","handleShowPopup","handleClosePopup","unsubscribe","handleBeforeCreated","handleUpdate","handleRemove","hideItem","messageKey","notifier","subscribeOnce","baseEvent","timerHasEnded","getData","showItem","unfreeze","updatePanelPosition","cancelGroupMode","saveCheckList","handleIsShown","getCompatData","isDomNode","popup","getId","delete","handleGroupRemove","allSelectedItems","nearestItem","updateCheckList","showItemPanel","handleToggleIsComplete","setDefaultCheckListTitle","handleGroupMode","firstChild","activateGroupMode","handleGroupModeSelect","showItemPanelOnNearestSelectedItem","handlePanelAction","actionHandlers","n","setImportant","attachFile","moveGroupToRight","moveGroupToLeft","showParticipantDialog","forward","handleOpenCheckList","updateTask","upsertCheckLists","insertCheckList","insertManyCheckLists","deleteCheckList","save","isDemoCheckListModified","removeChecklists","demoTitle","addCheckList","empty","childId","getDataForNewCheckList","addFastCheckList","showForwardMenu","getCheckListsNumber","getCountForNewCheckList","getSortForNewCheckList","ref","hasActiveGroupMode","addItemFromBtn","isRootCall","toggleCompleted","deactivateGroupMode","nearestSelectedItem","itemRef","panelRect","Dom","getPosition","panel","listRect","itemRect","getRelativePosition","isParentItem","paddingOffset","panelWidth","left","browse","newParentId","finalSortIndex","checkListIdsFromWhichWereForwarded","allSelectedWithChildren","selectedItemsIds","shouldUpdateParentId","targetNode","preselected","user","selector","EntitySelectorDialog","participantMeta","dialogOptions","preselectedItems","onShow","getTarget","popupWidth","getPopupContainer","targetNodeWidth","angleShift","getOption","setAngle","setOffset","users","getSelectedItems","getTitle","image","getAvatar","getEntityType","saveParticipants","onHide","selectItemsByIds","showTo","size","firstParent","CheckListChip","Chip","isSelected","ChipDesign","Shadow","ShadowAccent","OutlineAccent","true","checkListItemCount","getCompletedCount","LOADER_WAIT","handleFieldClose","showCheckList","highlightField","buildEmptyCheckList","fieldHighlighter","setContainer","highlight","chip","focus"],"mappings":";;;;;;;;CAEA;AACA,CAAO,MAAMA,aAAa,GAAG;GAC5BC,IAAI,EAAE,eAAe;GACrBC,UAAU,EAAE;eACXC;IACA;GACDC,KAAK,EAAE,CAAC,OAAO,CAAC;GAChBC,KAAK,GACL;KACC,OAAO;mBACNC;MACA;IACD;GACDC,QAAQ,EAAG;;;;;;;;;;;;;;;CAeZ,CAAC;;CCpBD;AACA,CAAO,MAAMC,cAAc,GAAG;GAC7BP,IAAI,EAAE,oBAAoB;GAC1BC,UAAU,EAAE;YACXO;IACA;GACDC,YAAY,EAAE,KAAK;GACnBC,KAAK,EAAE;KACNC,MAAM,EAAE;OACPC,IAAI,EAAE,CAACC,MAAM,EAAEC,MAAM,CAAC;OACtBC,QAAQ,EAAE;;IAEX;GACDZ,KAAK,EAAE,CAAC,MAAM,EAAE,OAAO,EAAE,QAAQ,CAAC;GAClCC,KAAK,GACL;KACC,OAAO;OACNY,cAAc,EAAE;MAChB;IACD;GACDC,QAAQ,EAAE;KACTC,OAAO,GACP;OACC,OAAQ,0BAAyB,IAAI,CAACP,MAAO,EAAC;MAC9C;KACDQ,YAAY,GACZ;OACC,OAAO;SACNC,SAAS,EAAE,wBAAwB;SACnCC,KAAK,EAAE,GAAG;SACVC,MAAM,EAAE,GAAG;SACXC,YAAY,EAAE,MAAM;SACpBC,SAAS,EAAE,CAAC;SACZC,OAAO,EAAE,CAAC;SACVC,QAAQ,EAAE,IAAI;SACdC,UAAU,EAAE,IAAI;SAChBC,SAAS,EAAE;WACVC,aAAa,EAAE,6BAA6B;WAC5CC,cAAc,EAAE,8BAA8B;WAC9CC,kBAAkB,EAAE;UACpB;SACDC,MAAM,EAAE;WACPC,OAAO,EAAE,IAAI,CAACC,WAAW,CAACC,IAAI,CAAC,IAAI;;QAEpC;MACD;KACD,GAAGC,uBAAU,CAAC;OACbC,sBAAsB,EAAG,GAAEC,oBAAK,CAACC,SAAU;MAC3C;IACD;GACDC,KAAK,EAAE;KACN,MAAMH,sBAAsB,GAC5B;OACC,IAAI,CAAC,IAAI,CAACI,KAAK,CAACC,cAAc,EAC9B;SACC;;OAGD,MAAM,IAAI,CAACC,SAAS,EAAE;OAEtB,IAAI,CAACC,MAAM,EAAE;;IAEd;GACDC,OAAO,GACP;KACC,IAAI,CAAC7B,cAAc,GAAG,IAAI8B,cAAc,CAAEC,OAA8B,IAAK;OAC5E,KAAK,MAAMC,KAAK,IAAID,OAAO,EAC3B;SACC,IAAIC,KAAK,CAACC,MAAM,KAAK,IAAI,CAACR,KAAK,CAACS,OAAO,EACvC;WACC,IAAI,CAACN,MAAM,EAAE;;;MAGf,CAAC;IACF;GACDO,OAAO,GACP;KACCC,eAAK,CAACjB,IAAI,CAACkB,MAAM,EAAE,QAAQ,EAAE,IAAI,CAACT,MAAM,CAAC;IACzC;GACDU,aAAa,GACb;KACCF,eAAK,CAACG,MAAM,CAACF,MAAM,EAAE,QAAQ,EAAE,IAAI,CAACT,MAAM,CAAC;IAC3C;GACDY,OAAO,EAAE;KACRZ,MAAM,GACN;OAAA;OACC,MAAMa,aAAa,4BAAG,IAAI,CAAChB,KAAK,CAACC,cAAc,qBAAzB,sBAA2BgB,gBAAgB,EAAE;OACnE,IAAID,aAAa,EACjB;SACC,IAAI,CAACE,KAAK,CAAC,QAAQ,CAAC;SAEpBF,aAAa,CAACG,cAAc,EAAE;;MAE/B;KACDC,UAAU,GACV;OAAA;OACC,IAAI,CAACF,KAAK,CAAC,MAAM,EAAE;SAAEF,aAAa,EAAE,IAAI,CAAChB,KAAK,CAACC,cAAc,CAACgB,gBAAgB;QAAI,CAAC;OAEnF,8BAAI,CAACjB,KAAK,CAACC,cAAc,qBAAzB,uBAA2BgB,gBAAgB,EAAE,CAACE,cAAc,EAAE;OAC9DE,UAAU,CAAC,MAAM,IAAI,CAAC9C,cAAc,CAAC+C,OAAO,CAAC,IAAI,CAACC,OAAO,CAACvB,KAAK,CAACS,OAAO,CAAC,EAAE,GAAG,CAAC;MAC9E;KACDhB,WAAW,GACX;OACC,IAAI,CAAClB,cAAc,CAACiD,UAAU,EAAE;OAChC,IAAI,CAACC,OAAO,CAACC,YAAY,CAACC,IAAI,CAACC,wBAAS,CAACC,cAAc,CAAC;OAExD,IAAI,CAACX,KAAK,CAAC,OAAO,CAAC;;IAEpB;GACDrD,QAAQ,EAAG;;;;;;;;CAQZ,CAAC;;CCxHD;AACA,CAAO,MAAMiE,cAAc,GAAG;GAC7BvE,IAAI,EAAE,oBAAoB;GAC1BC,UAAU,EAAE;kBACXuE;IACA;GACD9D,KAAK,EAAE;KACN+D,OAAO,EAAE;OACR7D,IAAI,EAAE8D,OAAO;OACb3D,QAAQ,EAAE;;IAEX;GACDZ,KAAK,EAAE,CAAC,MAAM,EAAE,OAAO,EAAE,SAAS,CAAC;GACnCwE,IAAI,GACJ;KACC,OAAO;OACNC,UAAU,EAAE;MACZ;IACD;GACD3D,QAAQ,EAAE;KACT,GAAGmB,uBAAU,CAAC;OACbC,sBAAsB,EAAG,GAAEC,oBAAK,CAACC,SAAU;MAC3C;IACD;GACDC,KAAK,EAAE;KACNH,sBAAsB,GACtB;OAAA;OACC,6BAAI,CAACI,KAAK,CAACC,cAAc,qBAAzB,sBAA2BkB,cAAc,EAAE;MAC3C;KACD,MAAMa,OAAO,CAACI,KAAK,EACnB;OACC,MAAM,IAAI,CAAClC,SAAS,EAAE;OAEtB,IAAI,CAACgB,KAAK,CAAC,SAAS,EAAEkB,KAAK,CAAC;;IAE7B;GACDrB,OAAO,EAAE;KACRK,UAAU,GACV;OACC,IAAI,CAACF,KAAK,CAAC,MAAM,CAAC;MAClB;KACDzB,WAAW,GACX;OACC,IAAI,CAACyB,KAAK,CAAC,OAAO,CAAC;;IAEpB;GACDrD,QAAQ,EAAG;;;;;;;;;;;;;CAaZ,CAAC;;CClEsC;CAAA;CAAA;AASvC,CAAO,MAAMwE,gBAAgB,CAC7B;GAGCC,WAAW,CAACC,MAAc,EAC1B;KAAA;OAAA;;KAAA;OAAA;;KAAA;OAAA;OAAA;;KACC,4CAAI,sBAAWA,MAAM;;GAGtBC,OAAO,CAACC,MAAuB,EAC/B;KACC,OAAO,4CAAI,oCAAkBC,IAAI,CAAEC,IAAoB,IAAKA,IAAI,CAACC,EAAE,KAAKH,MAAM,CAAC;;GAGhFI,eAAe,CAACC,QAAyB,EACzC;KACC,OAAO,4CAAI,oCACTC,MAAM,CAAEJ,IAAoB,IAAKA,IAAI,CAACG,QAAQ,KAAKA,QAAQ,CAAC,CAC5DE,IAAI,CAAC,CAACC,CAAiB,EAAEC,CAAiB,KAAKD,CAAC,CAACE,SAAS,GAAGD,CAAC,CAACC,SAAS,CAAC;;GAG5EC,YAAY,CAACC,aAA6B,EAC1C;KACC,IAAIC,KAAK,GAAG,CAAC;KACb,IAAIC,OAAO,GAAGF,aAAa;KAE3B,MAAMG,UAAU,GAAG,IAAIC,GAAG,EAAE;KAE5B,MAAMC,UAAU,GAAIZ,QAAQ,IAAK,4CAAI,oCAAkBJ,IAAI,CAAEC,IAAoB,IAAKA,IAAI,CAACC,EAAE,KAAKE,QAAQ,CAAC;KAE3G,OAAOS,OAAO,CAACT,QAAQ,KAAK,CAAC,EAAE;OAC9B,IAAIU,UAAU,CAACG,GAAG,CAACJ,OAAO,CAACX,EAAE,CAAC,EAC9B;SACC;;OAGDY,UAAU,CAACI,GAAG,CAACL,OAAO,CAACX,EAAE,CAAC;OAE1BW,OAAO,GAAGG,UAAU,CAACH,OAAO,CAACT,QAAQ,CAAC;OACtC,IAAI,CAACS,OAAO,EACZ;SACC;;OAEDD,KAAK,EAAE;;KAGR,OAAOA,KAAK;;GAGbO,gBAAgB,CAACC,iBAAkC,EAAEnB,IAAqB,EAC1E;KACC,IAAI,CAAAA,IAAI,oBAAJA,IAAI,CAAEG,QAAQ,OAAKgB,iBAAiB,oBAAjBA,iBAAiB,CAAElB,EAAE,GAC5C;OACC,OAAO,IAAI;;KAGZ,IAAI,CAAAD,IAAI,oBAAJA,IAAI,CAAEG,QAAQ,MAAK,CAAC,EACxB;OACC,OAAO,KAAK;;KAGb,MAAMiB,MAAM,GAAG,4CAAI,oCAAkBrB,IAAI,CAAEsB,CAAiB,IAAKA,CAAC,CAACpB,EAAE,MAAKD,IAAI,oBAAJA,IAAI,CAAEG,QAAQ,EAAC;KACzF,IAAI,CAACiB,MAAM,EACX;OACC,OAAO,KAAK;;KAGb,OAAO,IAAI,CAACF,gBAAgB,CAACC,iBAAiB,EAAEC,MAAM,CAAC;;GAGxDE,yBAAyB,CACxBxB,MAAuB,EACvByB,QAAwE,EACxEC,YAA8B,EAE/B;KACC,MAAMC,WAAW,GAAG,4CAAI,oCAAkB1B,IAAI,CAAEC,IAAoB,IAAKA,IAAI,CAACC,EAAE,KAAKH,MAAM,CAAC;KAE5F,IAAI,CAAC,CAAC2B,WAAW,IAAI,CAACA,WAAW,CAACtB,QAAQ,KAAK,CAACqB,YAAY,EAC5D;OACC;;KAGD,MAAMrB,QAAQ,GAAGqB,YAAY,IAAIC,WAAW,CAACtB,QAAQ;KAErD,MAAMuB,UAAU,GAAG,4CAAI,oCAAkB3B,IAAI,CAAEC,IAAoB,IAAKA,IAAI,CAACC,EAAE,KAAKE,QAAQ,CAAC;KAC7F,IAAI,CAACuB,UAAU,EACf;OACC;;KAGD,MAAMC,aAAa,GAAG,4CAAI,oCAAkBvB,MAAM,CAAEJ,IAAoB,IAAKA,IAAI,CAACG,QAAQ,KAAKuB,UAAU,CAACzB,EAAE,CAAC;KAC7G,MAAM2B,aAAa,GAAID,aAAa,CAACE,MAAM,KAAK,CAAE;KAElD,MAAMC,oBAAoB,GAAGH,aAAa,CAACI,KAAK,CAAEC,KAAqB,IAAKA,KAAK,CAACC,UAAU,CAAC;KAC7F,MAAMC,sBAAsB,GAAGP,aAAa,CAACQ,IAAI,CAAEH,KAAqB,IAAK,CAACA,KAAK,CAACC,UAAU,CAAC;KAE/F,MAAMG,kBAAkB,GACvBR,aAAa,IACTE,oBAAoB,IAAI,CAACJ,UAAU,CAACO,UAAW,IAC/CC,sBAAsB,IAAIR,UAAU,CAACO,UACzC;KACD,IAAI,CAACG,kBAAkB,EACvB;OACC;;KAGDb,QAAQ,CAACG,UAAU,CAACzB,EAAE,EAAE;OACvBgC,UAAU,EAAEH,oBAAoB,IAAI,CAACF;MACrC,CAAC;KAEF,IAAIF,UAAU,CAACvB,QAAQ,EACvB;OACC,IAAI,CAACmB,yBAAyB,CAACI,UAAU,CAACzB,EAAE,EAAEsB,QAAQ,CAAC;;;GAIzDc,oBAAoB,GACpB;KACC,OAAO,4CAAI,oCAAkBjC,MAAM,CAAEJ,IAAoB;OAAA;OAAA,OAAK,oBAAAA,IAAI,CAACsC,SAAS,qBAAd,gBAAgBC,MAAM,MAAK,IAAI;OAAC;;GAG/FC,mBAAmB,GACnB;KACC,OAAO,4CAAI,oCAAkBpC,MAAM,CAAEJ,IAAoB,IAAK;OAAA;OAC7D,OAAQA,IAAI,CAACG,QAAQ,KAAK,CAAC,IAAI,qBAAAH,IAAI,CAACsC,SAAS,qBAAd,iBAAgBG,QAAQ,MAAK,IAAI;MAChE,CAAC;;GAGHC,+BAA+B,GAC/B;KACC,MAAMC,MAAM,GAAG,IAAIC,GAAG,EAAE;KAExB,MAAMC,aAAa,GAAG,IAAI,CAACL,mBAAmB,EAAE;KAChD,MAAMM,QAAQ,2CAAG,IAAI,mCAAiB;KAEtCD,aAAa,CAACE,OAAO,CAAE/C,IAAoB,IAAK2C,MAAM,CAACK,GAAG,CAAChD,IAAI,CAACC,EAAE,EAAED,IAAI,CAAC,CAAC;KAE1E,MAAMiD,WAAW,GAAIC,SAA8B,IAAW;OAC7D,MAAMC,QAAQ,GAAGL,QAAQ,CAAC1C,MAAM,CAAEJ,IAAoB,IACrDkD,SAAS,CAACE,QAAQ,CAACpD,IAAI,CAACG,QAAQ,CAAC,IAAI,CAACwC,MAAM,CAAC3B,GAAG,CAAChB,IAAI,CAACC,EAAE,CAAC,CACzD;OAEDkD,QAAQ,CAACJ,OAAO,CAAEf,KAAqB,IAAKW,MAAM,CAACK,GAAG,CAAChB,KAAK,CAAC/B,EAAE,EAAE+B,KAAK,CAAC,CAAC;OAExE,IAAImB,QAAQ,CAACtB,MAAM,GAAG,CAAC,EACvB;SACCoB,WAAW,CAACE,QAAQ,CAACE,GAAG,CAAErB,KAAqB,IAAKA,KAAK,CAAC/B,EAAE,CAAC,CAAC;;MAE/D;KAEDgD,WAAW,CAACJ,aAAa,CAACQ,GAAG,CAAErD,IAAoB,IAAKA,IAAI,CAACC,EAAE,CAAC,CAAC;KAEjE,OAAOqD,KAAK,CAACC,IAAI,CAACZ,MAAM,CAACa,MAAM,EAAE,CAAC;;GAGnCC,cAAc,CAAC3D,MAAuB,EACtC;KACC,MAAM4D,OAAO,GAAG,IAAI5C,GAAG,EAAE;KAEzB,MAAM6B,MAAM,GAAG,EAAE;KAEjB,MAAMgB,eAAe,GAAIC,SAA0B,IAAK;OACvD,IAAIF,OAAO,CAAC1C,GAAG,CAAC4C,SAAS,CAAC,EAC1B;SACC;;OAGDF,OAAO,CAACzC,GAAG,CAAC2C,SAAS,CAAC;OAEtB,MAAMT,QAAQ,GAAG,4CAAI,oCACnB/C,MAAM,CAAEJ,IAAoB,IAAKA,IAAI,CAACG,QAAQ,KAAKyD,SAAS,CAAC,CAC7DvD,IAAI,CAAC,CAACC,CAAiB,EAAEC,CAAiB,KAAKD,CAAC,CAACE,SAAS,GAAGD,CAAC,CAACC,SAAS,CAAC;OAE3E2C,QAAQ,CAACJ,OAAO,CAAEf,KAAqB,IAAK;SAC3C,IAAI,CAAC0B,OAAO,CAAC1C,GAAG,CAACgB,KAAK,CAAC/B,EAAE,CAAC,EAC1B;WACC0C,MAAM,CAACkB,IAAI,CAAC7B,KAAK,CAAC;WAClB2B,eAAe,CAAC3B,KAAK,CAAC/B,EAAE,CAAC;;QAE1B,CAAC;MACF;KAED0D,eAAe,CAAC7D,MAAM,CAAC;KAEvB,OAAO6C,MAAM;;GAGdmB,+BAA+B,CAAChE,MAAuB,EACvD;KACC,OAAO,IAAI,CAAC2D,cAAc,CAAC3D,MAAM,CAAC,CAACM,MAAM,CAAEJ,IAAoB,IAAKA,IAAI,CAACiC,UAAU,KAAK,IAAI,CAAC;;GAG9FgB,WAAW,CAACnD,MAAuB,EACnC;KACC,OAAO,4CAAI,oCAAkBM,MAAM,CAAEJ,IAAoB,IAAK;OAC7D,OAAOA,IAAI,CAACG,QAAQ,KAAKL,MAAM;MAC/B,CAAC;;GAGHiE,WAAW,CAACjE,MAAuB,EAAEK,QAAyB,EAC9D;KACC,OAAO,4CAAI,oCACTC,MAAM,CAAE4D,OAAuB,IAAKA,OAAO,CAAC7D,QAAQ,KAAKA,QAAQ,IAAI6D,OAAO,CAAC/D,EAAE,KAAKH,MAAM,CAAC,CAC3FO,IAAI,CAAC,CAACC,CAAiB,EAAEC,CAAiB,KAAKD,CAAC,CAACE,SAAS,GAAGD,CAAC,CAACC,SAAS,CAAC;;GAG5EyD,kBAAkB,CACjB9D,QAAyB,EACzBoB,QAA6C,EAE9C;KACC,MAAMuB,QAAQ,GAAG,4CAAI,oCACnB1C,MAAM,CAAEJ,IAAoB,IAAKA,IAAI,CAACG,QAAQ,KAAKA,QAAQ,CAAC;KAE9D,MAAM+D,WAAW,GAAG,CAAC,GAAGpB,QAAQ,CAAC,CAACzC,IAAI,CAAC,CAACC,CAAiB,EAAEC,CAAiB,KAAKD,CAAC,CAACE,SAAS,GAAGD,CAAC,CAACC,SAAS,CAAC;KAE3G,MAAM2D,OAAO,GAAGD,WAAW,CACzBb,GAAG,CAAC,CAACrD,IAAoB,EAAEoE,QAAgB,MAAM;OACjD,GAAGpE,IAAI;OACPQ,SAAS,EAAE4D;MACX,CAAC,CAAC;KAEJ,IAAID,OAAO,CAACtC,MAAM,GAAG,CAAC,EACtB;OACCN,QAAQ,CAAC4C,OAAO,CAAC;;;GAInBE,qBAAqB,CACpBlE,QAAyB,EACzBK,SAAiB,EACjBe,QAA6C,EAE9C;KACC,MAAMuB,QAAQ,GAAG,4CAAI,oCACnB1C,MAAM,CAAEJ,IAAoB,IAAKA,IAAI,CAACG,QAAQ,KAAKA,QAAQ,CAAC;KAE9D,MAAMmE,aAAa,GAAGxB,QAAQ,CAC5B1C,MAAM,CAAEJ,IAAoB,IAAKA,IAAI,CAACQ,SAAS,IAAIA,SAAS,CAAC,CAC7DH,IAAI,CAAC,CAACC,CAAiB,EAAEC,CAAiB,KAAKD,CAAC,CAACE,SAAS,GAAGD,CAAC,CAACC,SAAS,CAAC;KAE3E,MAAM2D,OAAO,GAAGG,aAAa,CAC3BjB,GAAG,CAAErD,IAAoB,KAAM;OAC/B,GAAGA,IAAI;OACPQ,SAAS,EAAER,IAAI,CAACQ,SAAS,GAAG;MAC5B,CAAC,CAAC;KAEJ,IAAI2D,OAAO,CAACtC,MAAM,GAAG,CAAC,EACtB;OACCN,QAAQ,CAAC4C,OAAO,CAAC;;;GAInBI,SAAS,CAACvE,IAAoB,EAAEuB,QAA6C,EAC7E;KACC,IAAIvB,IAAI,CAACG,QAAQ,KAAK,CAAC,IAAI,IAAI,CAACM,YAAY,CAACT,IAAI,CAAC,GAAG,CAAC,EACtD;OACC;;KAGD,MAAMwE,YAAY,GAAG,IAAI,CAACtE,eAAe,CAACF,IAAI,CAACG,QAAQ,CAAC;KAExD,MAAMsE,YAAY,GAAGD,YAAY,CAACE,SAAS,CAAEV,OAAuB,IAAKA,OAAO,CAAC/D,EAAE,KAAKD,IAAI,CAACC,EAAE,CAAC;KAChG,IAAIwE,YAAY,IAAI,CAAC,EACrB;OACC;;KAGD,IAAIE,SAAS,GAAG,IAAI;KACpB,KAAK,IAAItD,CAAC,GAAGoD,YAAY,GAAG,CAAC,EAAEpD,CAAC,IAAI,CAAC,EAAEA,CAAC,EAAE,EAC1C;OACC,MAAMuD,SAAS,GAAGJ,YAAY,CAACnD,CAAC,CAAC;OACjC,IAAI,CAAC,IAAI,CAACH,gBAAgB,CAAC0D,SAAS,EAAE5E,IAAI,CAAC,EAC3C;SACC2E,SAAS,GAAGC,SAAS;SACrB;;;KAIF,IAAI,CAACD,SAAS,EACd;OACC;;KAGD,MAAME,iBAAiB,GAAG,4CAAI,oCAC5BzE,MAAM,CAAE4B,KAAqB,IAAKA,KAAK,CAAC7B,QAAQ,KAAKwE,SAAS,CAAC1E,EAAE,CAAC,CAClEI,IAAI,CAAC,CAACC,CAAiB,EAAEC,CAAiB,KAAKD,CAAC,CAACE,SAAS,GAAGD,CAAC,CAACC,SAAS,CAAC;KAE3E,MAAM2D,OAAO,GAAGK,YAAY,CAC1BpE,MAAM,CAAC,CAAC4D,OAAuB,EAAEc,KAAa,KAAKA,KAAK,GAAGL,YAAY,CAAC,CACxEpB,GAAG,CAAEW,OAAuB,KAAM;OAClC,GAAGA,OAAO;OACVxD,SAAS,EAAEwD,OAAO,CAACxD,SAAS,GAAG;MAC/B,CAAC,CAAC;KAEJ2D,OAAO,CAACN,IAAI,CAAC;OACZ,GAAG7D,IAAI;OACPG,QAAQ,EAAEwE,SAAS,CAAC1E,EAAE;OACtB8E,YAAY,EAAEJ,SAAS,CAACK,MAAM;OAC9BxE,SAAS,EAAEqE,iBAAiB,CAAChD,MAAM,GAAG,CAAC,GACpCgD,iBAAiB,CAACA,iBAAiB,CAAChD,MAAM,GAAG,CAAC,CAAC,CAACrB,SAAS,GAAG,CAAC,GAC7D;MACH,CAAC;KAEFe,QAAQ,CAAC4C,OAAO,CAAC;;GAGlBc,QAAQ,CAACjF,IAAoB,EAAEuB,QAA6C,EAC5E;KACC,IAAIvB,IAAI,CAACG,QAAQ,KAAK,CAAC,IAAI,IAAI,CAACM,YAAY,CAACT,IAAI,CAAC,IAAI,CAAC,EACvD;OACC;;KAGD,MAAMkF,aAAa,GAAG,4CAAI,oCAAkBnF,IAAI,CAAEqB,MAAsB,IAAKA,MAAM,CAACnB,EAAE,KAAKD,IAAI,CAACG,QAAQ,CAAC;KACzG,IAAI,CAAC+E,aAAa,EAClB;OACC;;KAGD,MAAMV,YAAY,GAAG,IAAI,CAACtE,eAAe,CAACgF,aAAa,CAAC/E,QAAQ,CAAC;KAEjE,MAAMgF,oBAAoB,GAAGX,YAAY,CACvCE,SAAS,CAAEV,OAAuB,IAAKA,OAAO,CAAC/D,EAAE,KAAKiF,aAAa,CAACjF,EAAE,CAAC;KAEzE,MAAMmF,sBAAsB,GAAG,4CAAI,oCACjChF,MAAM,CAAE4D,OAAuB,IAC/BA,OAAO,CAAC7D,QAAQ,KAAKH,IAAI,CAACG,QAAQ,IAC/B6D,OAAO,CAACxD,SAAS,GAAGR,IAAI,CAACQ,SAC5B,CAAC,CACD6C,GAAG,CAAEW,OAAuB,KAAM;OAClC,GAAGA,OAAO;OACVxD,SAAS,EAAEwD,OAAO,CAACxD,SAAS,GAAG;MAC/B,CAAC,CAAC;KAEJ,IAAI6E,YAAY,GAAG,CAAC;KACpB,IACCF,oBAAoB,KAAK,CAAC,CAAC,IACxBA,oBAAoB,KAAKX,YAAY,CAAC3C,MAAM,GAAG,CAAC,EAEpD;OACCwD,YAAY,GAAGb,YAAY,CAAC3C,MAAM,GAAG,CAAC,GAAG2C,YAAY,CAACA,YAAY,CAAC3C,MAAM,GAAG,CAAC,CAAC,CAACrB,SAAS,GAAG,CAAC,GAAG,CAAC;MAChG,MAED;OACC6E,YAAY,GAAGb,YAAY,CAACW,oBAAoB,CAAC,CAAC3E,SAAS,GAAG,CAAC;OAE/D,MAAM8E,YAAY,GAAGd,YAAY,CAC/BpE,MAAM,CAAE4D,OAAuB,IAAKA,OAAO,CAACxD,SAAS,IAAI6E,YAAY,CAAC,CACtEhC,GAAG,CAAEW,OAAuB,KAAM;SAClC,GAAGA,OAAO;SACVxD,SAAS,EAAEwD,OAAO,CAACxD,SAAS,GAAG;QAC/B,CAAC,CAAC;OAEJ4E,sBAAsB,CAACvB,IAAI,CAAC,GAAGyB,YAAY,CAAC;;KAG7C,MAAMC,eAAe,GAAG;OACvB,GAAGvF,IAAI;OACPG,QAAQ,EAAE+E,aAAa,CAAC/E,QAAQ;OAChC4E,YAAY,EAAEG,aAAa,CAACH,YAAY,IAAI,IAAI;OAChDvE,SAAS,EAAE6E;MACX;KAED9D,QAAQ,CAAC,CAAC,GAAG6D,sBAAsB,EAAEG,eAAe,CAAC,CAAC;;GAGvDC,eAAe,CACdC,WAA2B,EAC3BhD,QAAiB,EACjBiD,iBAAmC,GAAG,EAAE,EAEzC;KACC,IAAI,CAACD,WAAW,EAChB;OACC,OAAO,IAAI;;KAGZ,MAAME,UAAU,2CAAG,IAAI,kCAAgBF,WAAW,CAAC;KACnD,IAAI,CAACE,UAAU,EACf;OACC,OAAO,IAAI;;KAGZ,MAAMC,gBAAgB,GAAGH,WAAW,CAACjF,SAAS;KAE9C,MAAMqF,iBAAiB,GAAG,IAAI/E,GAAG,CAAC4E,iBAAiB,CAACrC,GAAG,CAAErD,IAAoB,IAAKA,IAAI,CAACC,EAAE,CAAC,CAAC;KAE3F,MAAM6F,aAAa,GAAG,4CAAI,oCACxBzF,IAAI,CAAC,CAACC,CAAiB,EAAEC,CAAiB,KAAKD,CAAC,CAACE,SAAS,GAAGD,CAAC,CAACC,SAAS,CAAC,CACzEJ,MAAM,CAAEJ,IAAoB,IAAK;OAAA;OACjC,MAAM+F,iBAAiB,GAAGF,iBAAiB,CAAC7E,GAAG,CAAChB,IAAI,CAACG,QAAQ,CAAC;OAE9D,OACCH,IAAI,CAACC,EAAE,KAAKwF,WAAW,CAACxF,EAAE,IACvBD,IAAI,CAACG,QAAQ,KAAK,CAAC,IACnB,qBAAAH,IAAI,CAACsC,SAAS,qBAAd,iBAAgBG,QAAQ,MAAKA,QAAQ,IACrC,sEAAI,kCAAgBzC,IAAI,sBAAxB,sBAA2BC,EAAE,MAAK0F,UAAU,CAAC1F,EAAE,IAC/C,CAAC8F,iBAAiB;MAEtB,CAAC;KAEH,IAAID,aAAa,CAACjE,MAAM,KAAK,CAAC,EAC9B;OACC,OAAO,IAAI;;KAGZ,OAAOiE,aAAa,CAACE,MAAM,CAAC,CAACC,OAAuB,EAAEjG,IAAoB,KAAK;OAC9E,OACCA,IAAI,CAACQ,SAAS,GAAGoF,gBAAgB,KAEhC5F,IAAI,CAACQ,SAAS,GAAGyF,OAAO,CAACzF,SAAS,IAC/ByF,OAAO,CAACzF,SAAS,IAAIoF,gBAAgB,CACxC,GACE5F,IAAI,GAAGiG,OAAO;MAClB,CAAC;;GAGHC,aAAa,CAACpG,MAAuB,EACrC;KACC,MAAMqD,QAAQ,GAAG,4CAAI,oCACnB/C,MAAM,CAAEJ,IAAoB,IAAKA,IAAI,CAACG,QAAQ,KAAKL,MAAM,CAAC,CAC1DO,IAAI,CAAC,CAACC,CAAiB,EAAEC,CAAiB,KAAKD,CAAC,CAACE,SAAS,GAAGD,CAAC,CAACC,SAAS,CAAC;KAE3E,OAAO2C,QAAQ,CAAC,CAAC,CAAC,IAAI,IAAI;;CAuB5B;CAAC,yBApBenD,IAAoB,EACnC;GACC,IAAI,CAACA,IAAI,IAAIA,IAAI,CAACG,QAAQ,KAAK,CAAC,EAChC;KACC,OAAOH,IAAI,IAAI,IAAI;;GAGpB,MAAM0B,UAAU,GAAG,4CAAI,oCAAkB3B,IAAI,CAAEqB,MAAsB,IAAKA,MAAM,CAACnB,EAAE,KAAKD,IAAI,CAACG,QAAQ,CAAC;GACtG,IAAI,CAACuB,UAAU,EACf;KACC,OAAO,IAAI;;GAGZ,+CAAO,IAAI,kCAAgBA,UAAU;CACtC;CAAC,2BAGD;GAAA;GACC,mGAAO,IAAI,kEAAJ,uBAAc7F,QAAQ,qBAAtB,uBAAwBsK,UAAU,EAAE,qCAAI,EAAE;CAClD;;OCtcYC,aAAa,GAAGC,MAAM,CAACC,MAAM,CAAC;GAC1CrG,EAAE,EAAE,WAAW;GACfsG,KAAK,EAAEC,aAAG,CAACC,UAAU,CAAC,2BAA2B;CAClD,CAAC,CAAC;;CCQF;AACA,OAAaC,aAAa,GAAG;GAC5B9L,IAAI,EAAE,mBAAmB;GACzBC,UAAU,EAAE;YACX8L;IACA;GACDrL,KAAK,EAAE;KACNC,MAAM,EAAE;OACPC,IAAI,EAAE,CAACC,MAAM,EAAEC,MAAM,CAAC;OACtBC,QAAQ,EAAE;;IAEX;GACDZ,KAAK,EAAE,CAAC,MAAM,EAAE,kBAAkB,CAAC;GACnCC,KAAK,GACL;KACC,OAAO;iBACN4L,4BAAQ;gBACRC,2BAAO;OACPT;MACA;IACD;GACD7G,IAAI,GACJ;KACC,OAAO;OACNuH,gBAAgB,EAAE;MAClB;IACD;GACDjL,QAAQ,EAAE;KACTkL,IAAI,GACJ;OACC,OAAO,IAAI,CAACC,MAAM,CAACC,OAAO,CAAE,GAAE/J,oBAAK,CAACgK,KAAM,UAAS,CAAC,CAAC,IAAI,CAAC3L,MAAM,CAAC;MACjE;KACD4K,UAAU,GACV;OACC,OAAO,IAAI,CAACa,MAAM,CAACC,OAAO,CAAE,GAAE/J,oBAAK,CAACiK,SAAU,WAAU,CAAC,CAAC,IAAI,CAACJ,IAAI,CAACK,SAAS,CAAC;MAC9E;KACDC,SAAS,GACT;OACC,OAAO,IAAI,CAAClB,UAAU,CAACtE,MAAM,KAAK,CAAC;MACnC;KACDyF,iBAAiB,GACjB;OACC,OAAO,IAAI,CAACP,IAAI,CAACO,iBAAiB;;IAEnC;GACD,MAAM7J,OAAO,GACb;KACC,IAAI,CAACqJ,gBAAgB,GAAG,IAAIpH,gBAAgB,CAAC;OAC5C7D,QAAQ,EAAE;SACTsK,UAAU,EAAE,MAAM,IAAI,CAACA;;MAExB,CAAC;KAEF,IAAI,IAAI,CAACmB,iBAAiB,EAC1B;OACC,KAAK,IAAI,CAACC,QAAQ,EAAE;;IAErB;GACDnJ,OAAO,EAAE;KACR,MAAMmJ,QAAQ,GACd;OACC,MAAMC,2DAAgB,CAACC,IAAI,CAAC,IAAI,CAAClM,MAAM,CAAC;;IAEzC;GACDL,QAAQ,EAAG;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;CAmCZ,CAAC;;CC1GD;AACA,CAAO,MAAMwM,kBAAkB,GAAG;GACjCpM,KAAK,EAAE;KACNC,MAAM,EAAE;OACPC,IAAI,EAAE,CAACC,MAAM,EAAEC,MAAM,CAAC;OACtBC,QAAQ,EAAE;MACV;KACDsE,EAAE,EAAE;OACHzE,IAAI,EAAE,CAACC,MAAM,EAAEC,MAAM,CAAC;OACtBC,QAAQ,EAAE;MACV;KACDgM,SAAS,EAAE;OACVnM,IAAI,EAAE8D,OAAO;OACbsI,OAAO,EAAE;;IAEV;GACD7M,KAAK,EAAE,CACN,QAAQ,EACR,SAAS,EACT,YAAY,EACZ,OAAO,EACP,MAAM,EACN,WAAW,EACX,MAAM,EACN,MAAM,CACN;GACDwE,IAAI,GACJ;KACC,OAAO;OACNsI,SAAS,EAAE,KAAK;OAChBC,eAAe,EAAE;MACjB;IACD;GACDjM,QAAQ,EAAE;KACTkL,IAAI,GACJ;OACC,OAAO,IAAI,CAACC,MAAM,CAACC,OAAO,CAAE,GAAE/J,oBAAK,CAACgK,KAAM,UAAS,CAAC,CAAC,IAAI,CAAC3L,MAAM,CAAC;MACjE;KACD4K,UAAU,GACV;OACC,OAAO,IAAI,CAACa,MAAM,CAACC,OAAO,CAAE,GAAE/J,oBAAK,CAACiK,SAAU,WAAU,CAAC,CAAC,IAAI,CAACJ,IAAI,CAACK,SAAS,CAAC;MAC9E;KACDpH,IAAI,GACJ;OACC,OAAO,IAAI,CAACgH,MAAM,CAACC,OAAO,CAAE,GAAE/J,oBAAK,CAACiK,SAAU,UAAS,CAAC,CAAC,IAAI,CAAClH,EAAE,CAAC;MACjE;KACD8H,SAAS,GACT;OACC,OAAO,IAAI,CAAC/H,IAAI,CAACgI,OAAO,CAACC,MAAM,KAAK,IAAI;MACxC;KACDC,SAAS,GACT;OACC,OAAO,IAAI,CAAClI,IAAI,CAACgI,OAAO,CAACG,MAAM,KAAK,IAAI;MACxC;KACDC,SAAS,GACT;OACC,OAAO,IAAI,CAACpI,IAAI,CAACgI,OAAO,CAACK,MAAM,KAAK,IAAI;MACxC;KACDC,cAAc,GACd;OACC,OAAO,IAAI,CAACC,QAAQ;MACpB;KACDA,QAAQ,GACR;OACC,OACC,IAAI,CAACC,cAAc,IAChB,IAAI,CAACC,WAAW;MAEpB;KACDD,cAAc,GACd;OAAA;OACC,OAAO,0BAAI,CAACE,WAAW,qBAAhB,kBAAkB7G,MAAM,IAAG,CAAC;MACnC;KACD4G,WAAW,GACX;OAAA;OACC,OAAO,uBAAI,CAACE,QAAQ,qBAAb,eAAe9G,MAAM,IAAG,CAAC;MAChC;KACD6G,WAAW,GACX;OACC,OAAO,IAAI,CAAC1I,IAAI,CAAC0I,WAAW;MAC5B;KACDC,QAAQ,GACR;OACC,OAAO,IAAI,CAAC3I,IAAI,CAAC2I,QAAQ;MACzB;KACDC,KAAK,GACL;OACC,OAAO,IAAI,CAAC5I,IAAI,CAAC6I,WAAW;MAC5B;KACDC,SAAS,GACT;OACC,OAAO,IAAI,CAAC9I,IAAI,CAACiC,UAAU,GAAG,wBAAwB,GAAG,wBAAwB;MACjF;KACDK,SAAS,GACT;OAAA;OACC,OAAO,6BAAI,CAACtC,IAAI,CAACsC,SAAS,qBAAnB,qBAAqBC,MAAM,MAAK,IAAI;MAC3C;KACDwG,iBAAiB,GACjB;OAAA;OACC,OAAO,8BAAI,CAAC/I,IAAI,CAACsC,SAAS,qBAAnB,sBAAqBG,QAAQ,MAAK,IAAI;;IAE9C;GACDrE,OAAO,EAAE;KACR4K,WAAW,GACX;OACC,IAAI,CAACzK,KAAK,CAAC,OAAO,EAAE,IAAI,CAAC0B,EAAE,CAAC;MAC5B;KACDgJ,UAAU,GACV;OACC,IAAI,CAAC1K,KAAK,CAAC,MAAM,EAAE,IAAI,CAAC0B,EAAE,CAAC;MAC3B;KACDiJ,eAAe,GACf;OACC,IAAI,CAAC3K,KAAK,CAAC,WAAW,EAAE,IAAI,CAAC0B,EAAE,CAAC;MAChC;KACDkJ,WAAW,CAAC5C,KAAa,GAAG,EAAE,EAC9B;OACC,IAAI,CAACS,MAAM,CAACoC,QAAQ,CAAE,GAAElM,oBAAK,CAACiK,SAAU,SAAQ,EAAE;SACjDlH,EAAE,EAAE,IAAI,CAACA,EAAE;SACXoJ,MAAM,EAAE;WAAE9C;;QACV,CAAC;OAEF,IAAI,CAAChI,KAAK,CAAC,QAAQ,CAAC;MACpB;KACD+K,OAAO,CAACjJ,IAAa,EACrB;OACC,IAAI,CAAC9B,KAAK,CACT,SAAS,EACT;SACC0B,EAAE,EAAE,IAAI,CAACA,EAAE;SACXI,IAAI,EAAEkJ,cAAI,CAACC,QAAQ,CAACnJ,IAAI,CAAC,GAAGA,IAAI,GAAG;QACnC,CACD;MACD;KACDoJ,UAAU,GACV;OACC,IAAI,CAAClL,KAAK,CAAC,YAAY,EAAE,IAAI,CAAC0B,EAAE,CAAC;MACjC;KACDgD,WAAW,CAACnD,MAAuB,EACnC;OACC,OAAO,IAAI,CAACqG,UAAU,CAAC/F,MAAM,CAAEJ,IAAoB,IAAK;SACvD,OAAOA,IAAI,CAACG,QAAQ,KAAKL,MAAM;QAC/B,CAAC;;;CAGL,CAAC;;CCzID;AACA,CAAO,MAAM4J,mBAAmB,GAAG;GAClC9O,IAAI,EAAE,qBAAqB;GAC3BC,UAAU,EAAE;YACX8L,wBAAK;YACLgD,6BAAK;sBACLC,2DAAe;qBACfC,yDAAc;kBACdC;IACA;GACDC,MAAM,EAAE,CACPrC,kBAAkB,CAClB;GACDsC,MAAM,EAAE,CAAC,aAAa,CAAC;GACvBjP,KAAK,EAAE,CACN,iBAAiB,EACjB,gBAAgB,EAChB,eAAe,CACf;GACDC,KAAK,GACL;KACC,OAAO;gBACNiP,2BAAO;gBACPpD;MACA;IACD;GACDtH,IAAI,GACJ;KACC,OAAO;OACN2K,QAAQ,EAAE,KAAK;OACfC,WAAW,EAAE,KAAK;OAClBC,qBAAqB,EAAE,eAAe;OACtCC,qBAAqB,EAAE;MACvB;IACD;GACDxO,QAAQ,EAAE;KACTyO,WAAW,GACX;OACC,OAAO;SACNrK,EAAE,EAAG,sCAAqCsK,cAAI,CAACC,SAAS,EAAG,EAAC;SAC5DC,WAAW,EAAE,IAAI,CAACpN,KAAK,CAACqN,IAAI,CAACC,GAAG;SAChCC,QAAQ,EAAE,GAAG;SACbC,UAAU,EAAE,CAAC,GAAG;SAChBC,QAAQ,EAAE,CACT;WACCC,IAAI,EAAE,IAAI,CAACX;UACX,CACD;SACDY,KAAK,EAAE,IAAI,CAACC,SAAS;SACrBC,eAAe,EAAEC,QAAQ,CAACC,IAAI;SAC9B7O,UAAU,EAAE;QACZ;MACD;KACD0O,SAAS,GACT;OACC,MAAMI,YAAY,GAAG;SACpB9E,KAAK,EAAG,IAAI,CAAC8D,qBAAqB,GAC9B,IAAI,CAACiB,GAAG,CAAC,oCAAoC,CAAC,GAC9C,IAAI,CAACA,GAAG,CAAC,oCAAoC,CAChD;SACDC,IAAI,EAAE,IAAI,CAAClB,qBAAqB,GAAGxD,2BAAO,CAAC2E,QAAQ,GAAG3E,2BAAO,CAAC4E,WAAW;SACzEC,OAAO,EAAE;WACRzL,EAAE,EAAG,mBAAkB,IAAI,CAACA,EAAG;UAC/B;SACD0L,OAAO,EAAE,MAAM;WACd,IAAI,CAACxB,WAAW,GAAG,KAAK;WACxB,IAAI,CAACE,qBAAqB,GAAG,CAAC,IAAI,CAACA,qBAAqB;WACxD,IAAI,CAAC9L,KAAK,CAAC,iBAAiB,EAAE;aAC7BuB,MAAM,EAAE,IAAI,CAACG,EAAE;aACf2L,SAAS,EAAE,IAAI,CAACvB;YAChB,CAAC;;QAEH;OAED,MAAMwB,gBAAgB,GAAG;SACxBtF,KAAK,EAAE,IAAI,CAAC+E,GAAG,CAAC,qCAAqC,CAAC;SACtDC,IAAI,EAAE1E,2BAAO,CAACiF,cAAc;SAC5BJ,OAAO,EAAE;WACRzL,EAAE,EAAG,oBAAmB,IAAI,CAACA,EAAG;UAChC;SACD0L,OAAO,EAAE,MAAM;WACd,IAAI,IAAI,CAAC3L,IAAI,CAAC4L,SAAS,KAAK,IAAI,EAChC;aACC,IAAI,CAACG,qBAAqB,CAAC,IAAI,CAAC9L,EAAE,CAAC;;WAEpC,IAAI,CAAC1B,KAAK,CAAC,gBAAgB,EAAE,IAAI,CAAC0B,EAAE,CAAC;WACrC,IAAI,CAACkK,WAAW,GAAG,KAAK;;QAEzB;OAED,MAAM6B,QAAQ,GAAG;SAChBC,WAAW,EAAE,IAAI,CAAC7B,qBAAqB;SACvC7D,KAAK,EAAE,IAAI,CAAC+E,GAAG,CAAC,oCAAoC,CAAC;SACrDC,IAAI,EAAE1E,2BAAO,CAACqF,MAAM;SACpBR,OAAO,EAAE;WACRzL,EAAE,EAAG,mBAAkB,IAAI,CAACA,EAAG;UAC/B;SACD0L,OAAO,EAAE,MAAM,IAAI,CAACpN,KAAK,CAAC,eAAe,EAAE,IAAI,CAAC0B,EAAE;QAClD;OAED,MAAMwJ,UAAU,GAAG;SAClBwC,WAAW,EAAE,IAAI,CAAC7B,qBAAqB;SACvC+B,MAAM,EAAE,OAAO;SACf5F,KAAK,EAAE,IAAI,CAAC+E,GAAG,CAAC,sCAAsC,CAAC;SACvDC,IAAI,EAAE1E,2BAAO,CAACuF,QAAQ;SACtBV,OAAO,EAAE;WACRzL,EAAE,EAAG,qBAAoB,IAAI,CAACA,EAAG;UACjC;SACD0L,OAAO,EAAE,IAAI,CAAClC,UAAU,CAAC1M,IAAI,CAAC,IAAI;QAClC;OAED,IAAI,IAAI,CAAC4K,SAAS,EAClB;SACC,OAAO,CACN0D,YAAY,EACZW,QAAQ,EACRvC,UAAU,CACV;QACD,MAED;SACC,OAAO,CACN4B,YAAY,EACZQ,gBAAgB,EAChBpC,UAAU,CACV;;MAEF;KACD4C,QAAQ,GACR;OACC,OAAO,IAAI,CAACrM,IAAI,CAACiC,UAAU,GAAG4E,2BAAO,CAACyF,OAAO,GAAGzF,2BAAO,CAAC0F,UAAU;MAClE;KACDC,eAAe,GACf;OACC,MAAMC,KAAK,GAAG,IAAI,CAACnB,GAAG,CAAC,sCAAsC,CAAC;OAE9D,OAAOmB,KAAK,CACVC,OAAO,CAAC,aAAa,EAAE,IAAI,CAACC,cAAc,CAAC,CAC3CD,OAAO,CAAC,SAAS,EAAE,IAAI,CAACE,UAAU,CAAC;MACrC;KACDD,cAAc,GACd;OACC,OAAO,IAAI,CAACxG,UAAU,CAAC/F,MAAM,CAAEgH,SAAyB,IAAK;SAC5D,OAAOA,SAAS,CAACjH,QAAQ,KAAK,IAAI,CAACF,EAAE,IAAImH,SAAS,CAACnF,UAAU;QAC7D,CAAC,CAACJ,MAAM;MACT;KACD+K,UAAU,GACV;OACC,OAAO,IAAI,CAACzG,UAAU,CAAC/F,MAAM,CAAEgH,SAAyB,IAAK;SAC5D,OAAOA,SAAS,CAACjH,QAAQ,KAAK,IAAI,CAACF,EAAE;QACrC,CAAC,CAAC4B,MAAM;;IAEV;GACD9D,OAAO,GACP;KAAA;KACC,IAAI,CAAC+J,eAAe,wBAAG,IAAI,CAAClJ,OAAO,CAAC+L,GAAG,qBAAhB,kBAAkBkC,OAAO,CAAC,aAAa,CAAC;KAE/D,IAAI,IAAI,CAACC,WAAW,EACpB;OACC,IAAI,CAACA,WAAW,CAAC,IAAI,CAAC7M,EAAE,EAAE,IAAI,CAAC;;KAGhC,IAAI,IAAI,CAAC6H,eAAe,EACxB;OACC9J,eAAK,CAACjB,IAAI,CAAC,IAAI,CAAC+K,eAAe,EAAE,QAAQ,EAAE,IAAI,CAACiF,YAAY,CAAC;OAE7D,KAAK,IAAI,CAACxP,SAAS,CAAC,IAAI,CAACyP,WAAW,CAAC;OAErC,IAAI,CAACC,gBAAgB,GAAG,IAAIC,gBAAgB,CAAC,MAAM;SAClD,IAAI,CAACF,WAAW,EAAE;QAClB,CAAC;OACF,IAAI,CAACC,gBAAgB,CAACtO,OAAO,CAC5B,IAAI,CAACmJ,eAAe,EACpB;SACCqF,SAAS,EAAE,IAAI;SACfC,OAAO,EAAE;QACT,CACD;;IAEF;GACDlP,aAAa,GACb;KACC,IAAI,IAAI,CAAC4J,eAAe,EACxB;OACC9J,eAAK,CAACG,MAAM,CAAC,IAAI,CAAC2J,eAAe,EAAE,QAAQ,EAAE,IAAI,CAACiF,YAAY,CAAC;;KAGhE,IAAI,IAAI,CAACE,gBAAgB,EACzB;OACC,IAAI,CAACA,gBAAgB,CAACpO,UAAU,EAAE;;KAGnC,IAAI,IAAI,CAACiO,WAAW,EACpB;OACC,IAAI,CAACA,WAAW,CAAC,IAAI,CAAC7M,EAAE,EAAE,IAAI,CAAC;;IAEhC;GACD7B,OAAO,EAAE;KACR2O,YAAY,GACZ;OACC,IAAI,CAACC,WAAW,EAAE;OAElB,IAAI,CAAC7C,WAAW,GAAG,KAAK;MACxB;KACD6C,WAAW,GACX;OACC,IAAI,CAAC,IAAI,CAAClF,eAAe,IAAI,CAAC,IAAI,CAACzK,KAAK,CAAC2C,IAAI,EAC7C;SACC;;OAGD,MAAMqN,UAAU,GAAG,IAAI,CAAChQ,KAAK,CAAC2C,IAAI,CAACsN,qBAAqB,EAAE;OAC1D,MAAMC,aAAa,GAAG,IAAI,CAACzF,eAAe,CAACwF,qBAAqB,EAAE;OAElE,IAAI,CAACpD,QAAQ,GAAGmD,UAAU,CAACG,GAAG,IAAKD,aAAa,CAACC,GAAG,GAAGH,UAAU,CAACnR,MAAM,GAAG,CAAE;MAC7E;KACDuR,QAAQ,GACR;OACC,IAAI,CAACtD,WAAW,GAAG,IAAI;MACvB;KACD4B,qBAAqB,CAACjM,MAAuB,EAC7C;OACC,IAAI,CAACkH,MAAM,CAACoC,QAAQ,CAAE,GAAElM,oBAAK,CAACiK,SAAU,SAAQ,EAAE;SACjDlH,EAAE,EAAEH,MAAM;SACVuJ,MAAM,EAAE;WACPuC,SAAS,EAAE,CAAC,IAAI,CAAC5L,IAAI,CAAC4L,SAAS,IAAI,CAAC,IAAI,CAAC5L,IAAI,CAAC0N,gBAAgB;WAC9DA,gBAAgB,EAAE;;QAEnB,CAAC;MACF;KACDC,WAAW,CAAC3N,IAAoB,EAChC;OACC,OACCA,IAAI,CAAC4L,SAAS,KAAK,IAAI,IACnB,IAAI,CAACjE,SAAS,IAAI3H,IAAI,CAAC0N,gBAAgB,KAAK,IAAK;;IAGvD;GACDxS,QAAQ,EAAG;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;CAyEZ,CAAC;;CCvTD;AACA,CAAO,MAAM0S,kBAAkB,GAAG;GACjChT,IAAI,EAAE,oBAAoB;GAC1BC,UAAU,EAAE;YACX8L,wBAAK;sBACLiD,2DAAe;qBACfC,yDAAc;+BACdgE;IACA;GACD9D,MAAM,EAAE,CACPrC,kBAAkB,CAClB;GACDsC,MAAM,EAAE,CAAC,aAAa,CAAC;GACvB1O,KAAK,EAAE;KACNwS,UAAU,EAAE;OACXtS,IAAI,EAAEE,MAAM;OACZkM,OAAO,EAAE;;IAEV;GACD7M,KAAK,EAAE,CACN,kBAAkB,EAClB,yBAAyB,CACzB;GACDC,KAAK,CAACM,KAAa,EACnB;KACC,OAAO;gBACNuL,2BAAO;OACPkH,WAAW,EAAEA,iDAAW,CAACC,GAAG,CAAC1S,KAAK,CAAC2E,EAAE,EAAEgO,iDAAW,CAACC,aAAa,CAAC;OACjEC,eAAe,EAAEJ,iDAAW,CAACC,GAAG,CAAC1S,KAAK,CAAC2E,EAAE,EAAEgO,iDAAW,CAACC,aAAa,CAAC,CAACE,UAAU;MAChF;IACD;GACD7O,IAAI,GACJ;KACC,OAAO;OACN8O,cAAc,EAAE,IAAI,CAACN,WAAW,CAACO,QAAQ;MACzC;IACD;GACDzS,QAAQ,EAAE;KACT0S,aAAa,GACb;OACC,OAAO;SACNC,UAAU,EAAE,IAAI;SAChBC,gBAAgB,EAAE,KAAK;SACvBC,kBAAkB,EAAE,KAAK;SACzBC,iBAAiB,EAAE;WAClBC,OAAO,EAAE,IAAI;WACbC,YAAY,EAAE,IAAI;WAClBC,QAAQ,EAAE,IAAI,CAACnH;;QAEhB;MACD;KACDW,cAAc,GACd;OACC,OAAO,IAAI,CAACC,QAAQ,IAAI,IAAI,CAACwG,cAAc;MAC3C;KACDA,cAAc,GACd;OACC,OAAO,IAAI,CAACC,QAAQ,IAAI,IAAI,CAACC,WAAW,IAAI,IAAI,CAACC,iBAAiB;MAClE;KACDF,QAAQ,GACR;OAAA;OACC,OAAO,oBAAI,CAACpG,KAAK,qBAAV,YAAY/G,MAAM,IAAG,CAAC;MAC7B;KACDoN,WAAW,GACX;OACC,OAAO,IAAI,CAACZ,cAAc,CAAClM,IAAI,CAAC,CAAC;SAAEgN;QAAQ,KAAK,CAC/CC,2BAAU,CAACC,SAAS,EACpBD,2BAAU,CAACE,OAAO,CAClB,CAAClM,QAAQ,CAAC+L,MAAM,CAAC,CAAC;MACnB;KACDD,iBAAiB,GACjB;OACC,OAAO,IAAI,CAACb,cAAc,CAAClM,IAAI,CAAC,CAAC;SAAEgN;QAAQ,KAAK,CAC/CC,2BAAU,CAACG,aAAa,EACxBH,2BAAU,CAACI,WAAW,CACtB,CAACpM,QAAQ,CAAC+L,MAAM,CAAC,CAAC;MACnB;KACDM,eAAe,GACf;OACC,OACC,IAAI,CAAC5H,SAAS,IACX,CAAC,IAAI,CAAC7H,IAAI,CAAC0P,YAAY,IACvB,CAAC,IAAI,CAACpN,SAAS,IACf,CAAC,IAAI,CAACqF,SAAS;;IAGpB;GACDlK,OAAO,GACP;KACC,IAAI,IAAI,CAACsR,cAAc,EACvB;OACC,KAAK,IAAI,CAACY,SAAS,EAAE;;IAEtB;GACD5R,OAAO,GACP;KACC,IAAI,IAAI,CAAC+O,WAAW,EACpB;OACC,IAAI,CAACA,WAAW,CAAC,IAAI,CAAC7M,EAAE,EAAE,IAAI,CAAC;;IAEhC;GACD/B,aAAa,GACb;KACC,IAAI,IAAI,CAAC4O,WAAW,EACpB;OACC,IAAI,CAACA,WAAW,CAAC,IAAI,CAAC7M,EAAE,EAAE,IAAI,CAAC;;IAEhC;GACD7B,OAAO,EAAE;KACRwR,gBAAgB,GAChB;OACC,IAAI,IAAI,CAACxH,SAAS,KAAK,KAAK,EAC5B;SACC;;OAGD,IAAI,CAACpB,MAAM,CAACoC,QAAQ,CAAE,GAAElM,oBAAK,CAACiK,SAAU,SAAQ,EAAE;SACjDlH,EAAE,EAAE,IAAI,CAACA,EAAE;SACXoJ,MAAM,EAAE;WAAEpH,UAAU,EAAE,CAAC,IAAI,CAACjC,IAAI,CAACiC;;QACjC,CAAC;OAEF,IAAI,CAAC1D,KAAK,CAAC,kBAAkB,EAAE,IAAI,CAAC0B,EAAE,CAAC;MACvC;KACD4P,uBAAuB,GACvB;OACC,IAAI,CAAC7I,MAAM,CAACoC,QAAQ,CAAE,GAAElM,oBAAK,CAACiK,SAAU,SAAQ,EAAE;SACjDlH,EAAE,EAAE,IAAI,CAACA,EAAE;SACXoJ,MAAM,EAAE;WACP/G,SAAS,EAAE;aACVC,MAAM,EAAE,IAAI;aACZE,QAAQ,EAAE,CAAC,IAAI,CAACsG;;;QAGlB,CAAC;OAEF,IAAI,CAACxK,KAAK,CAAC,yBAAyB,EAAE,IAAI,CAAC0B,EAAE,CAAC;MAC9C;KACD6P,WAAW,GACX;OAAA;OACC,6BAAI,CAAChI,eAAe,oCAApB,IAAI,CAACA,eAAe,wBAAK,IAAI,CAAClJ,OAAO,CAAC+L,GAAG,qBAAhB,kBAAkBkC,OAAO,CAAC,aAAa,CAAC;OAEjE,MAAMkD,MAAM,GAAG,GAAG;OAElB,IAAI,CAACjI,eAAe,CAACkI,QAAQ,CAAC;SAC7BxC,GAAG,EAAE,IAAI,CAACnQ,KAAK,CAAC2C,IAAI,CAAC5D,SAAS,GAAG2T,MAAM;SACvCE,QAAQ,EAAE;QACV,CAAC;MACF;KACDC,eAAe,CAACC,KAAmB,EACnC;OACC,MAAMC,UAAU,GAAG,IAAItP,GAAG,CAAC,CAAC,IAAI,CAACzD,KAAK,CAACgT,QAAQ,CAAC,CAAC;OAEjD,IAAI,CAACD,UAAU,CAACpP,GAAG,CAACmP,KAAK,CAACtS,MAAM,CAAC,EACjC;SAAA;SACC,6BAAI,CAACR,KAAK,CAACiT,eAAe,qBAA1B,sBAA4BC,aAAa,EAAE;;MAE5C;KACD,MAAMZ,SAAS,GACf;OAAA;OACC,MAAMa,GAAG,mBAAG,IAAI,CAAC5H,KAAK,qBAAV,aAAYvF,GAAG,CAAEoN,IAAI;SAAA;SAAA,mBAAKA,IAAI,oBAAJA,IAAI,CAAExQ,EAAE,uBAAIwQ,IAAI;SAAC;OAEvD,MAAM,IAAI,CAAC1C,WAAW,CAAC2C,IAAI,CAACF,GAAG,WAAHA,GAAG,GAAI,EAAE,CAAC;MACtC;KACDG,WAAW,GACX;OACC,IAAI,CAAC,IAAI,CAAC3Q,IAAI,EACd;SACC;;OAGD,IAAI,CAACsJ,OAAO,CAAC,IAAI,CAACtJ,IAAI,CAACQ,SAAS,GAAG,CAAC,CAAC;MACrC;KACDoQ,WAAW,CAACT,KAAmB,EAC/B;OACC,MAAMU,WAAW,GAAG,IAAI,CAACxT,KAAK,CAAC,cAAc,CAAC;OAE9C,IAAI,IAAI,CAACyT,wBAAwB,CAACD,WAAW,oBAAXA,WAAW,CAAElG,GAAG,EAAEwF,KAAK,CAACtS,MAAM,CAAC,EACjE;SACC;;OAGD,IAAI,IAAI,CAACyE,SAAS,EAClB;SACC,IAAI,CAACuN,uBAAuB,EAAE;;OAG/B,IAAI,IAAI,CAAClI,SAAS,EAClB;SACC,IAAI,CAACiI,gBAAgB,EAAE;;MAExB;KACDkB,wBAAwB,CAACC,SAAsB,EAAElT,MAAmB,EACpE;OACC,IAAI,CAACkT,SAAS,IAAI,CAAClT,MAAM,EACzB;SACC,OAAO,KAAK;;OAGb,MAAMmT,eAAe,GAAG,CAAC,wBAAwB,CAAC;OAElD,MAAMC,cAAc,GAAGF,SAAS,CAACG,QAAQ,CAACrT,MAAM,CAAC;OACjD,IAAI,CAACoT,cAAc,EACnB;SACC,OAAO,KAAK;;OAGb,MAAME,gBAAgB,GAAGH,eAAe,CAAC7O,IAAI,CAAEnG,SAAiB,IAC/D6B,MAAM,CAACgP,OAAO,CAAE,IAAG7Q,SAAU,EAAC,CAAC,KAAK,IAAI,CACxC;OAED,OAAO,CAACmV,gBAAgB;;IAEzB;GACDjW,QAAQ,EAAG;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;CA8FZ,CAAC;;CC9TD;AACA,CAAO,MAAMkW,gBAAgB,GAAG;GAC/BxW,IAAI,EAAE,kBAAkB;GACxBC,UAAU,EAAE;YACX8L;IACA;GACDrL,KAAK,EAAE;KACNqM,SAAS,EAAE;OACVnM,IAAI,EAAE8D,OAAO;OACbsI,OAAO,EAAE;;IAEV;GACD7M,KAAK,EAAE,CAAC,SAAS,CAAC;GAClBC,KAAK,GACL;KACC,OAAO;gBACN6L;MACA;IACD;GACD3L,QAAQ,EAAG;;;;;;;;;;;;;;CAcZ,CAAC;;CCxBD;AACA,CAAO,MAAMmW,eAAe,GAAG;GAC9BzW,IAAI,EAAE,iBAAiB;GACvBC,UAAU,EAAE;KACX6O,mBAAmB;KACnBkE,kBAAkB;KAClBwD;IACA;GACD9V,KAAK,EAAE;KACNC,MAAM,EAAE;OACPC,IAAI,EAAE,CAACC,MAAM,EAAEC,MAAM,CAAC;OACtBC,QAAQ,EAAE;MACV;KACD2V,WAAW,EAAE;OACZ9V,IAAI,EAAE,CAACC,MAAM,EAAEC,MAAM,CAAC;OACtBkM,OAAO,EAAE;MACT;KACDzH,QAAQ,EAAE;OACT3E,IAAI,EAAE,CAACC,MAAM,EAAEC,MAAM,CAAC;OACtBkM,OAAO,EAAE;MACT;KACDD,SAAS,EAAE;OACVnM,IAAI,EAAE8D,OAAO;OACbsI,OAAO,EAAE;;IAEV;GACD7M,KAAK,EAAE,CACN,eAAe,EACf,MAAM,EACN,QAAQ,EACR,SAAS,EACT,gBAAgB,EAChB,YAAY,EACZ,kBAAkB,EAClB,OAAO,EACP,MAAM,EACN,WAAW,EACX,iBAAiB,EACjB,gBAAgB,EAChB,yBAAyB,EACzB,eAAe,CACf;GACDwE,IAAI,GACJ;KACC,OAAO,EAAE;IACT;GACD1D,QAAQ,EAAE;KACTkL,IAAI,GACJ;OACC,OAAO,IAAI,CAACC,MAAM,CAACC,OAAO,CAAE,GAAE/J,oBAAK,CAACgK,KAAM,UAAS,CAAC,CAAC,IAAI,CAAC3L,MAAM,CAAC;MACjE;KACD4K,UAAU,GACV;OACC,OAAO,IAAI,CAACa,MAAM,CAACC,OAAO,CAAE,GAAE/J,oBAAK,CAACiK,SAAU,WAAU,CAAC,CAAC,IAAI,CAACJ,IAAI,CAACK,SAAS,CAAC;MAC9E;KACDmK,gBAAgB,GAChB;OACC,OAAO,IAAI,CAACpL,UAAU,CACpB/F,MAAM,CAAEoR,SAAyB,IAAKA,SAAS,CAACrR,QAAQ,KAAK,CAAC,CAAC,CAC/DE,IAAI,CAAC,CAACC,CAAiB,EAAEC,CAAiB,KAAKD,CAAC,CAACE,SAAS,GAAGD,CAAC,CAACC,SAAS,CAAC;MAC3E;KACDiR,QAAQ,GACR;OACC,OAAO,IAAI,CAACtL,UAAU,CACpB/F,MAAM,CAAEJ,IAAoB,IAAKA,IAAI,CAACG,QAAQ,KAAK,IAAI,CAACA,QAAQ,CAAC,CACjEE,IAAI,CAAC,CAACC,CAAiB,EAAEC,CAAiB,KAAKD,CAAC,CAACE,SAAS,GAAGD,CAAC,CAACC,SAAS,CAAC;;IAE5E;GACD/C,OAAO,GACP;KACC,IAAI,CAACc,KAAK,CAAC,eAAe,CAAC;KAE3B,IAAI,CAACuI,gBAAgB,GAAG,IAAIpH,gBAAgB,CAAC;OAC5C7D,QAAQ,EAAE;SACTsK,UAAU,EAAE,MAAM,IAAI,CAACA;;MAExB,CAAC;IACF;GACDpI,OAAO,GACP;KACC,IAAI,IAAI,CAACuT,WAAW,EACpB;OAAA;OACC,IAAI,CAACxJ,eAAe,sBAAG,IAAI,CAAC4J,KAAK,CAAC/G,GAAG,qBAAd,gBAAgBgH,aAAa,CAAC,CAAC,aAAa,CAAC,CAAC;OAErE,MAAMC,gBAAgB,GAAG,IAAI,CAAC9J,eAAe,CAAC6J,aAAa,CAAC,CAAE,iBAAgB,IAAI,CAACL,WAAY,IAAG,CAAC,CAAC;OAEpG5S,UAAU,CAAC,MAAM;SAChB,IAAI,CAACoJ,eAAe,CAAC+J,SAAS,GAAGD,gBAAgB,CAACxV,SAAS;QAC3D,EAAE,CAAC,CAAC;;KAGN,IAAI,CAACmC,KAAK,CAAC,MAAM,CAAC;IAClB;GACDH,OAAO,EAAE;KACR0T,aAAa,CAAC9R,IAAoB,EAClC;OACC,IAAIA,IAAI,CAACG,QAAQ,KAAK,CAAC,EACvB;SACC,OAAO,GAAG;;OAGX,MAAMQ,KAAK,GAAG,IAAI,CAACmG,gBAAgB,CAACrG,YAAY,CAACT,IAAI,CAAC;OACtD,IAAIW,KAAK,KAAK,CAAC,EACf;SACC,OAAO,GAAG;;OAGX,OAAQ,GAAE,CAACA,KAAK,GAAG,CAAC,IAAI,EAAG,IAAG;MAC9B;KACDoR,kBAAkB,CAACjN,KAAK,EACxB;OACC,IAAI,IAAI,CAAC6C,SAAS,KAAK,IAAI,EAC3B;SACC,OAAO,KAAK;;OAGb,MAAM8J,QAAQ,GAAG,IAAI,CAACA,QAAQ;OAE9B,MAAMO,iBAAiB,GAAGP,QAAQ,CAAC/M,SAAS,CAAE1E,IAAI,IAAK,CAACA,IAAI,CAACiS,MAAM,CAAC;OAEpE,OAAOD,iBAAiB,KAAK,CAAC,CAAC,IAAIA,iBAAiB,KAAKlN,KAAK;MAC9D;KACD7B,WAAW,CAAC7B,MAAsB,EAClC;OACC,IAAI,IAAI,CAACuM,WAAW,CAACvM,MAAM,CAAC,EAC5B;SACC,OAAO,EAAE;;OAGV,OAAO,IAAI,CAAC0F,gBAAgB,CAACrD,cAAc,CAACrC,MAAM,CAACnB,EAAE,CAAC;MACtD;KACD0N,WAAW,CAAC3N,IAAoB,EAChC;OACC,OACCA,IAAI,CAAC4L,SAAS,KAAK,IAAI,IACnB,IAAI,CAACjE,SAAS,IAAI3H,IAAI,CAAC0N,gBAAgB,KAAK,IAAK;;IAGvD;GACDxS,QAAQ,EAAG;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;CAkEZ,CAAC;;CCvNM,MAAMgX,YAAY,GAAG7L,MAAM,CAACC,MAAM,CAAC;GACzC6L,SAAS,EAAE,WAAW;GACtBC,WAAW,EAAE,aAAa;GAC1BC,QAAQ,EAAE,UAAU;GACpBC,UAAU,EAAE,YAAY;GACxBC,OAAO,EAAE,SAAS;GAClBC,OAAO,EAAE,SAAS;GAClBC,MAAM,EAAE,QAAQ;GAChBC,MAAM,EAAE;CACT,CAAC,CAAC;AAEF,CAAO,MAAMC,WAAW,GAAGtM,MAAM,CAACC,MAAM,CAAC;GACxCsM,YAAY,EAAE,cAAc;GAC5BC,UAAU,EAAE,YAAY;GACxBC,SAAS,EAAE,WAAW;GACtBC,QAAQ,EAAE,UAAU;GACpBC,gBAAgB,EAAE,kBAAkB;GACpCC,aAAa,EAAE,eAAe;GAC9BT,OAAO,EAAE,SAAS;GAClBC,MAAM,EAAE,QAAQ;GAChBC,MAAM,EAAE;CACT,CAAC,CAAC;AAEF,CAAO,MAAMQ,SAAS,GAAG7M,MAAM,CAACC,MAAM,CAAC;GACtC6M,eAAe,EAAE,CAChB;KACCvY,IAAI,EAAEsX,YAAY,CAACC,SAAS;KAC5BnH,KAAK,EAAE,CACN;OACCO,IAAI,EAAE1E,2BAAO,CAACuM,IAAI;OAClBC,UAAU,EAAExM,2BAAO,CAACyM,UAAU;OAC9BC,MAAM,EAAEZ,WAAW,CAACC,YAAY;OAChCY,IAAI,EAAE,yCAAyC;OAC/CxX,SAAS,EAAE,aAAa;OACxByX,SAAS,EAAE;MACX;IAEF,EACD;KACC7Y,IAAI,EAAEsX,YAAY,CAACE,WAAW;KAC9BpH,KAAK,EAAE,CACN;OACCO,IAAI,EAAE1E,2BAAO,CAAC6M,MAAM;OACpBH,MAAM,EAAEZ,WAAW,CAACE,UAAU;OAC9BW,IAAI,EAAE;MACN;IAEF,EACD;KACC5Y,IAAI,EAAEsX,YAAY,CAACG,QAAQ;KAC3BrH,KAAK,EAAE,CACN;OACCO,IAAI,EAAE1E,2BAAO,CAAC8M,WAAW;OACzBJ,MAAM,EAAEZ,WAAW,CAACG,SAAS;OAC7BU,IAAI,EAAE;MACN,EACD;OACCjI,IAAI,EAAE1E,2BAAO,CAAC+M,UAAU;OACxBL,MAAM,EAAEZ,WAAW,CAACI,QAAQ;OAC5BS,IAAI,EAAE;MACN;IAEF,EACD;KACC5Y,IAAI,EAAEsX,YAAY,CAACI,UAAU;KAC7BtH,KAAK,EAAE,CACN;OACCO,IAAI,EAAE1E,2BAAO,CAACgN,MAAM;OACpBN,MAAM,EAAEZ,WAAW,CAACK,gBAAgB;OACpCQ,IAAI,EAAE;MACN;IAEF,EACD;KACC5Y,IAAI,EAAEsX,YAAY,CAACK,OAAO;KAC1BvH,KAAK,EAAE,CACN;OACCO,IAAI,EAAE1E,2BAAO,CAAC2E,QAAQ;OACtB+H,MAAM,EAAEZ,WAAW,CAACM,aAAa;OACjCO,IAAI,EAAE;MACN;IAEF,EACD;KACC5Y,IAAI,EAAEsX,YAAY,CAACM,OAAO;KAC1BxH,KAAK,EAAE,CACN;OACCO,IAAI,EAAE1E,2BAAO,CAACiN,OAAO;OACrBP,MAAM,EAAEZ,WAAW,CAACH,OAAO;OAC3BgB,IAAI,EAAE;MACN;IAEF,EACD;KACC5Y,IAAI,EAAEsX,YAAY,CAACO,MAAM;KACzBzH,KAAK,EAAE,CACN;OACCO,IAAI,EAAE1E,2BAAO,CAACuF,QAAQ;OACtBmH,MAAM,EAAEZ,WAAW,CAACF,MAAM;OAC1Be,IAAI,EAAE;MACN;IAEF,EACD;KACC5Y,IAAI,EAAEsX,YAAY,CAACQ,MAAM;KACzB1H,KAAK,EAAE,CACN;OACCO,IAAI,EAAE1E,2BAAO,CAACkN,OAAO;OACrBR,MAAM,EAAEZ,WAAW,CAACD,MAAM;OAC1Bc,IAAI,EAAE;MACN;IAEF;CAEH,CAAC,CAAC;;CC1GF;AACA,CAAO,MAAMQ,kBAAkB,GAAG;GACjCpZ,IAAI,EAAE,oBAAoB;GAC1BC,UAAU,EAAE;YACX8L;IACA;GACDsN,UAAU,EAAE;WAAET;IAAM;GACpBlY,KAAK,EAAE;;KAEN4Y,eAAe,EAAE;OAChB1Y,IAAI,EAAE8H,KAAK;OACXsE,OAAO,EAAE,MAAMsL,SAAS,CAACC,eAAe,CAAC9P,GAAG,CAAE8Q,OAAgB,IAAKA,OAAO,CAACvZ,IAAI;MAC/E;KACDwZ,cAAc,EAAE;OACf5Y,IAAI,EAAE8H,KAAK;OACXsE,OAAO,EAAE,MAAM;MACf;KACDyM,eAAe,EAAE;OAChB7Y,IAAI,EAAE8H,KAAK;OACXsE,OAAO,EAAE,MAAM;MACf;KACD0M,aAAa,EAAE;OACd9Y,IAAI,EAAE8H,KAAK;OACXsE,OAAO,EAAE,MAAM;;IAEhB;GACD7M,KAAK,EAAE,CAAC,QAAQ,CAAC;GACjBwE,IAAI,GACJ;KACC,OAAO;OACNgV,kBAAkB,EAAE,IAAI;OACxBC,eAAe,EAAE;MACjB;IACD;GACD3Y,QAAQ,EAAE;KACTiP,QAAQ,GACR;OACC,OAAOoI,SAAS,CAACC,eAAe,CAC9B/S,MAAM,CAAE+T,OAAO,IAAK,IAAI,CAACD,eAAe,CAAC9Q,QAAQ,CAAC+Q,OAAO,CAACvZ,IAAI,CAAC,CAAC,CAChEyI,GAAG,CAAE8Q,OAAO,KAAM;SAClB,GAAGA,OAAO;SACVnJ,KAAK,EAAEmJ,OAAO,CAACnJ,KAAK,CAClB5K,MAAM,CAAEJ,IAAU,IAAK,IAAI,CAACoU,cAAc,CAAChR,QAAQ,CAACpD,IAAI,CAACuT,MAAM,CAAC,CAAC,CACjElQ,GAAG,CAAErD,IAAU;WAAA;WAAA,OAAM;aACrB,GAAGA,IAAI;aACPyU,QAAQ,EAAE,IAAI,CAACC,cAAc,CAAC1U,IAAI,CAAC;aACnCuC,MAAM,EAAE,IAAI,CAACoS,YAAY,CAAC3U,IAAI,CAAC;aAC/ByT,SAAS,qBAAEzT,IAAI,CAACyT,SAAS,8BAAI;YAC7B;UAAC;QACH,CAAC,CAAC,CACFrT,MAAM,CAAE+T,OAAO,IAAKA,OAAO,CAACnJ,KAAK,CAACnJ,MAAM,GAAG,CAAC,CAAC;MAE/C;KACD+S,OAAO,GACP;OACC,OAAO;SAAA;SAAA,OAAmB;WACzBC,IAAI,EAAE,IAAI,CAACL,eAAe;WAC1BM,OAAO,EAAE,GAAG;WACZ/Y,YAAY,EAAE;aACbC,SAAS,EAAE,YAAY;aACvB+Y,UAAU,EAAE,kCAAkC;aAC9CC,QAAQ,EAAE,KAAK;aACfnK,UAAU,EAAE,qDAAE,IAAI,CAAC0J,kBAAkB,qBAAvB,uBAAyBU,WAAW,oCAAI,CAAC,CAAC;aACxD5Y,OAAO,EAAE,CAAC;aACV6Y,WAAW,EAAE;eACZC,iBAAiB,EAAE,IAAI;eACvBC,QAAQ,EAAE,IAAI;eACdC,QAAQ,EAAE;cACV;aACDnK,eAAe,EAAEC,QAAQ,CAACC;;UAE3B;QAAC;;IAEH;GACDhN,OAAO,EAAE;KACRsW,cAAc,CAAC1U,IAAU,EACzB;OAAA;OACC,yBAAOA,IAAI,CAACyU,QAAQ,6BAAI,IAAI,CAACJ,eAAe,CAACjR,QAAQ,CAACpD,IAAI,CAACuT,MAAM,CAAC;MAClE;KACDoB,YAAY,CAAC3U,IAAU,EACvB;OAAA;OACC,uBAAOA,IAAI,CAACuC,MAAM,2BAAI,IAAI,CAAC+R,aAAa,CAAClR,QAAQ,CAACpD,IAAI,CAACuT,MAAM,CAAC;MAC9D;KACD+B,WAAW,CAACtV,IAAU,EACtB;OACC,OAAQA,IAAI,CAACuC,MAAM,IAAIvC,IAAI,CAACqT,UAAU,GAAIrT,IAAI,CAACqT,UAAU,GAAGrT,IAAI,CAACuL,IAAI;MACrE;KACDgK,eAAe,CAACpF,KAAiB,EAAEnQ,IAAU,EAC7C;OACC,IAAI,CAACA,IAAI,CAACyU,QAAQ,EAClB;SACC,IAAI,CAAClW,KAAK,CAAC,QAAQ,EAAE;WACpBgV,MAAM,EAAEvT,IAAI,CAACuT,MAAM;WACnBiC,IAAI,EAAErF,KAAK,CAACsF;UACZ,CAAC;;MAEH;KACDC,oBAAoB,CAACvF,KAAiB,EAAEnQ,IAAU,EAClD;OACC,IAAI,CAACuU,kBAAkB,GAAGpE,KAAK,CAACsF,aAAa;OAC7C,IAAI,CAACjB,eAAe,GAAGxU,IAAI,CAACwT,IAAI,GAAG,IAAI,CAAClI,GAAG,CAACtL,IAAI,CAACwT,IAAI,CAAC,GAAG,IAAI;;IAE9D;GACDtY,QAAQ,EAAG;;;;;;;;;;;;;;;;;;;;;;;;CAwBZ,CAAC;;CCvIoC;CAAA;CAAA;CAAA;CAAA;CAAA;CAAA;CAAA;CAAA;AAOrC,CAAO,MAAMya,iBAAiB,SAASC,6BAAY,CACnD;GAQCjW,WAAW,CAACC,MAAc,EAC1B;KACC,KAAK,EAAE;KAAC;OAAA;;KAAA;OAAA;;KAAA;OAAA;;KAAA;OAAA;;KAAA;OAAA;OAAA,OATY;;KAAI;OAAA;OAAA,OACH;;KAAC;OAAA;OAAA,OACJ;;KAAC;OAAA;OAAA,OACD;;KAAE;OAAA;OAAA;;KAQpB,IAAI,CAACiW,iBAAiB,CAAC,sCAAsC,CAAC;KAE9D,4CAAI,wBAAYjW,MAAM,CAACkW,OAAO;KAC9B,4CAAI,8BAAevM,cAAI,CAACwM,WAAW,CAACnW,MAAM,CAACoW,UAAU,CAAC,2CAAG,IAAI,8BAAepW,MAAM,CAACoW,UAAU;;GAG9FC,oBAAoB,GACpB;KACC,4CAAI,gEAAY,IAAI,2BAAY;KAEhC,4CAAI,0CAAqBC,kBAAE,CAACC,YAAY,CAACC,MAAM,CAACC,MAAM,CAAC;OACtDpW,EAAE,EAAG,sBAAqBsK,cAAI,CAACC,SAAS,EAAG,EAAC;OAC5CsL,OAAO,0CAAE,IAAI,2CAAqB;OAClC9N,OAAO,EAAE,CAAC;SACTzB,KAAK,EAAEC,aAAG,CAACC,UAAU,CAAC,oCAAoC,CAAC;SAC3D7J,MAAM,EAAE;WACP0Z,OAAO,EAAE,4CAAI,0CAAoBvZ,IAAI,CAAC,IAAI;;QAE3C,CAAC;OACFH,MAAM,EAAE;SACPC,OAAO,EAAE,4CAAI,gDAAuBE,IAAI,CAAC,IAAI;;MAE9C,CAAC;KAEF,4CAAI;;CAmCN;CAAC,wBA/BA;GACC,4CAAI,0BAAawZ,WAAW,CAAC,MAAM;KAClC,4CAAI,uBAAW;KAEf,4CAAI,wCAAmBC,MAAM,CAAC;OAAEV,OAAO,0CAAE,IAAI;MAAuB,CAAC;KAErE,IAAI,4CAAI,yBAAa,CAAC,EACtB;OACC,4CAAI,wCAAmBW,KAAK,EAAE;OAE9B,IAAI,CAACzX,IAAI,CAAC,UAAU,EAAE,IAAI,CAAC;;IAE5B,EAAE,IAAI,CAAC;CACT;CAAC,+BAGD;GACC,4CAAI,wCAAmByX,KAAK,EAAE;CAC/B;CAAC,kCAGD;GACCC,aAAa,yCAAC,IAAI,wBAAW;GAE7B,IAAI,CAAC1X,IAAI,CAAC,UAAU,EAAE,KAAK,CAAC;CAC7B;CAAC,+BAGD;GACC,OAAO,4CAAI,sBAAU0N,OAAO,CAAC,aAAa,0CAAE,IAAI,sBAAU;CAC3D;;CCxCD;AACA,OAAavF,SAAS,GAAG;GACxBvM,IAAI,EAAE,eAAe;GACrBC,UAAU,EAAE;KACXwW,eAAe;KACf2C,kBAAkB;KAClBrZ,aAAa;eACbG,gCAAQ;YACR6L,wBAAK;YACLgD;IACA;GACDgN,OAAO,GACP;KACC,OAAO;OACN7J,WAAW,EAAE,IAAI,CAACA,WAAW;OAC7B8J,WAAW,EAAE,IAAI,CAACA;MAClB;IACD;GACDtb,KAAK,EAAE;KACNC,MAAM,EAAE;OACPC,IAAI,EAAE,CAACC,MAAM,EAAEC,MAAM,CAAC;OACtBC,QAAQ,EAAE;MACV;KACDkb,YAAY,EAAE;OACbrb,IAAI,EAAE8D,OAAO;OACbsI,OAAO,EAAE;MACT;KACDD,SAAS,EAAE;OACVnM,IAAI,EAAE8D,OAAO;OACbsI,OAAO,EAAE;MACT;KACDkP,gBAAgB,EAAE;OACjBtb,IAAI,EAAE8D,OAAO;OACbsI,OAAO,EAAE;MACT;KACD0J,WAAW,EAAE;OACZ9V,IAAI,EAAE,CAACC,MAAM,EAAEC,MAAM,CAAC;OACtBkM,OAAO,EAAE;MACT;KACDvI,OAAO,EAAE;OACR7D,IAAI,EAAE8D,OAAO;OACbsI,OAAO,EAAE;;IAEV;GACD7M,KAAK,EAAE,CAAC,MAAM,EAAE,OAAO,EAAE,QAAQ,EAAE,MAAM,CAAC;GAC1CC,KAAK,GACL;KACC,OAAO;OACNY,cAAc,EAAE,IAAI;uBACpBmb,wCAAc;mBACd9b,oCAAU;mBACV+b,oCAAU;gBACVnQ;MACA;IACD;GACDtH,IAAI,GACJ;KACC,OAAO;OACNuH,gBAAgB,EAAE,IAAI;OACtBmQ,gBAAgB,EAAE,KAAK;OACvBC,mBAAmB,EAAE,KAAK;OAC1BpX,MAAM,EAAE,IAAI;OACZqX,eAAe,EAAE;SAChB3J,GAAG,EAAE,GAAG;SACR4J,OAAO,EAAE;QACT;OACDC,iBAAiB,EAAE,KAAK;OACxBC,kBAAkB,EAAE,IAAI,CAACT,YAAY,GAAG,CAAC,GAAG,CAAC;OAC7CU,iBAAiB,EAAE,IAAI,CAACV,YAAY,GAAG,GAAG,GAAG,GAAG;OAChDW,SAAS,EAAE,EAAE;OACbC,kBAAkB,EAAE,KAAK;OACzBC,sBAAsB,EAAE,eAAe;OACvCC,kBAAkB,EAAE,IAAI;OACxBC,aAAa,EAAE,EAAE;OACjBC,cAAc,EAAE,IAAIjV,GAAG,EAAE;OACzBkV,WAAW,EAAE,IAAIhX,GAAG;MACpB;IACD;GACDjF,QAAQ,EAAE;KACTkc,aAAa,GACb;OACC,IAAI,IAAI,CAAClB,YAAY,EACrB;SACC,OAAO1b,cAAc;QACrB,MACI,IAAI,IAAI,CAACwM,SAAS,EACvB;SACC,OAAOjB,aAAa;;OAGrB,OAAOvH,cAAc;MACrB;KACD6Y,cAAc,GACd;OACC,IAAI,IAAI,CAACrQ,SAAS,EAClB;SACC,OAAO,IAAI,CAACmP,gBAAgB;;OAG7B,OAAO,IAAI;MACX;KACDmB,MAAM,GACN;OACC,OAAO1O,cAAI,CAACC,QAAQ,CAAC,IAAI,CAACjO,MAAM,CAAC,IAAI,IAAI,CAACA,MAAM,GAAG,CAAC;MACpD;KACDwL,IAAI,GACJ;OACC,OAAO,IAAI,CAACC,MAAM,CAACC,OAAO,CAAE,GAAE/J,oBAAK,CAACgK,KAAM,UAAS,CAAC,CAAC,IAAI,CAAC3L,MAAM,CAAC;MACjE;KACD4K,UAAU,GACV;OACC,OAAO,IAAI,CAACa,MAAM,CAACC,OAAO,CAAE,GAAE/J,oBAAK,CAACiK,SAAU,WAAU,CAAC,CAAC,IAAI,CAACJ,IAAI,CAACK,SAAS,CAAC;MAC9E;KACDmK,gBAAgB,GAChB;OACC,OAAO,IAAI,CAACpL,UAAU,CAAC/F,MAAM,CAAEoR,SAAyB,IAAKA,SAAS,CAACrR,QAAQ,KAAK,CAAC,CAAC;MACtF;KACD+X,sBAAsB,GACtB;OACC,OAAO,IAAI,CAAC3G,gBAAgB,CAAC1P,MAAM,GAAG,CAAC;MACvC;KACD7B,IAAI,GACJ;OACC,OAAO,IAAI,CAACgH,MAAM,CAACC,OAAO,CAAE,GAAE/J,oBAAK,CAACiK,SAAU,UAAS,CAAC,CAAC,IAAI,CAACrH,MAAM,CAAC;MACrE;KACDqY,qBAAqB,GACrB;OAAA;OACC,IAAI,CAAC,IAAI,CAACnY,IAAI,EACd;SACC,OAAO,KAAK;;OAGb,OAAO,6BAAI,CAACA,IAAI,CAACsC,SAAS,qBAAnB,qBAAqBG,QAAQ,MAAK,IAAI;MAC7C;KACD2V,mBAAmB,GACnB;OACC,IAAI,CAAC,IAAI,CAACpY,IAAI,EACd;SACC,OAAO,EAAE;;OAGV,IAAIgI,OAAO,GAAG,CACb2K,WAAW,CAACC,YAAY,EACxBD,WAAW,CAACG,SAAS,EACrBH,WAAW,CAACI,QAAQ,EACpBJ,WAAW,CAACK,gBAAgB,EAC5BL,WAAW,CAACM,aAAa,EACzBN,WAAW,CAACH,OAAO,EACnBG,WAAW,CAACF,MAAM,CAClB;OAED,IAAI,IAAI,CAAC0F,qBAAqB,EAC9B;SACCnQ,OAAO,CAACnE,IAAI,CAAC8O,WAAW,CAACD,MAAM,CAAC;QAChC,MAED;SACC1K,OAAO,CAACnE,IAAI,CAAC8O,WAAW,CAACE,UAAU,CAAC;;OAGrC,IAAI,IAAI,CAAC7S,IAAI,CAACG,QAAQ,KAAK,CAAC,EAC5B;SACC6H,OAAO,GAAG,CACT2K,WAAW,CAACK,gBAAgB,EAC5BL,WAAW,CAACM,aAAa,CACzB;;OAGF,MAAMoF,MAAM,GAAGC,kBAAI,CAACC,SAAS,EAAE,CAACF,MAAM;OACtC,MAAMG,mBAAmB,GAAG,IAAI1X,GAAG,CAAC,CACnC6R,WAAW,CAACK,gBAAgB,EAC5BL,WAAW,CAACM,aAAa,CACzB,CAAC;OAEF,OAAOjL,OAAO,CAAC5H,MAAM,CAAEmT,MAAc,IAAK;SACzC,MAAMkF,sBAAsB,GAAGD,mBAAmB,CAACxX,GAAG,CAACuS,MAAM,CAAC,IAAI,CAAC8E,MAAM,CAACK,YAAY;SAEtF,OAAO,CAACD,sBAAsB;QAC9B,CAAC;MACF;KACDE,oBAAoB,GACpB;OACC,IAAI,CAAC,IAAI,CAAC3Y,IAAI,EACd;SACC,OAAO,EAAE;;OAGV,MAAMqU,eAAe,GAAG,EAAE;OAE1B,MAAMuE,SAAS,GAAG,IAAI,CAAC9R,gBAAgB,CAACrG,YAAY,CAAC,IAAI,CAACT,IAAI,CAAC;OAC/D,MAAM+H,SAAS,GAAG,IAAI,CAAC/H,IAAI,CAACgI,OAAO,CAACC,MAAM,KAAK,IAAI;OACnD,MAAMC,SAAS,GAAG,IAAI,CAAClI,IAAI,CAACgI,OAAO,CAACG,MAAM,KAAK,IAAI;OAEnD,MAAM0Q,iBAAiB,GAAG;SACzB,CAAClG,WAAW,CAACC,YAAY,GAAG,MAAM;WACjC,OAAO7K,SAAS,KAAK,KAAK;UAC1B;SACD,CAAC4K,WAAW,CAACE,UAAU,GAAG,MAAM;WAC/B,OAAO9K,SAAS,KAAK,KAAK;UAC1B;SACD,CAAC4K,WAAW,CAACI,QAAQ,GAAG,MAAM;WAC7B,OAAO6F,SAAS,KAAK,CAAC,IAAI7Q,SAAS,KAAK,KAAK;UAC7C;SACD,CAAC4K,WAAW,CAACG,SAAS,GAAG,MAAM;WAC9B,OACC8F,SAAS,KAAK,CAAC,IACZ,IAAI,CAAC5Y,IAAI,CAACQ,SAAS,KAAK,CAAC,IACzBuH,SAAS,KAAK,KAAK;UAEvB;SACD,CAAC4K,WAAW,CAACK,gBAAgB,GAAG,MAAM;WACrC,OAAOjL,SAAS,KAAK,KAAK;UAC1B;SACD,CAAC4K,WAAW,CAACM,aAAa,GAAG,MAAM;WAClC,OAAOlL,SAAS,KAAK,KAAK;UAC1B;SACD,CAAC4K,WAAW,CAACH,OAAO,GAAG,MAAM;WAC5B,OACCzK,SAAS,KAAK,KAAK,IAChB,IAAI,CAAC/H,IAAI,CAACuG,KAAK,KAAK,EAAE;UAE1B;SACD,CAACoM,WAAW,CAACF,MAAM,GAAG,MAAM;WAC3B,OACCvK,SAAS,KAAK,KAAK,IAChB,IAAI,CAAClI,IAAI,CAACuG,KAAK,KAAK,EAAE;;QAG3B;OAEDF,MAAM,CAAC1I,OAAO,CAACkb,iBAAiB,CAAC,CAC/B9V,OAAO,CAAC,CAAC,CAACwQ,MAAc,EAAEuF,SAAmB,CAAC,KAAK;SACnD,IAAIA,SAAS,EAAE,EACf;WACCzE,eAAe,CAACxQ,IAAI,CAAC0P,MAAM,CAAC;;QAE7B,CAAC;OAGH,OAAOc,eAAe;MACtB;KACD0E,kBAAkB,GAClB;OACC,IAAI,CAAC,IAAI,CAAC/Y,IAAI,EACd;SACC,OAAO,EAAE;;OAGV,MAAMgI,OAAO,GAAG,EAAE;OAElB,IAAI,IAAI,CAAChI,IAAI,CAACgZ,WAAW,EACzB;SACChR,OAAO,CAACnE,IAAI,CAAC8O,WAAW,CAACC,YAAY,CAAC;;OAGvC,OAAO5K,OAAO;MACd;KACDiR,kBAAkB,GAClB;OACC,OAAO;SACNhZ,EAAE,EAAG,gCAA+B,IAAI,CAACD,IAAI,CAACC,EAAG,EAAC;SAClDwK,WAAW,EAAE,IAAI,CAACkN,kBAAkB;SACpCuB,QAAQ,EAAE,GAAG;SACbC,SAAS,EAAE,GAAG;SACdtO,UAAU,EAAE,CAAC,GAAG;SAChBC,QAAQ,EAAE,CACT;WACCC,IAAI,EAAE,IAAI,CAAC2M;UACX,CACD;SACD1M,KAAK,EAAE,IAAI,CAACoO,gBAAgB;SAC5BlO,eAAe,EAAEC,QAAQ,CAACC;QAC1B;MACD;KACDgO,gBAAgB,GAChB;OACC,MAAMC,cAAc,GAAG,IAAI,CAAC9H,gBAAgB,CAC1CnR,MAAM,CAAEoR,SAAyB,IAAKA,SAAS,CAACvR,EAAE,KAAK,IAAI,CAACD,IAAI,CAACG,QAAQ,CAAC,CAC1EkD,GAAG,CAAEmO,SAAyB,KAAM;SACpCjL,KAAK,EAAEiL,SAAS,CAACjL,KAAK;SACtBmF,OAAO,EAAE;WACRzL,EAAE,EAAG,wBAAuBuR,SAAS,CAACvR,EAAG;UACzC;SACD0L,OAAO,EAAE,MAAM;WACd,IAAI,CAAC2N,aAAa,EAAE;WACpB,IAAI,IAAI,CAACnB,qBAAqB,EAC9B;aACC,KAAK,IAAI,CAACoB,4BAA4B,CAAC/H,SAAS,CAACvR,EAAE,CAAC;YACpD,MAED;aACC,IAAI,CAACuZ,kBAAkB,CAAChI,SAAS,CAACvR,EAAE,CAAC;;;QAGvC,CAAC,CAAC;OAEJ,OAAO,CACN,GAAGoZ,cAAc,EACjB;SACCpN,WAAW,EAAE,IAAI,CAACyL,sBAAsB;SACxCnR,KAAK,EAAE,IAAI,CAAC+E,GAAG,CAAC,8CAA8C,CAAC;SAC/DI,OAAO,EAAE;WACRzL,EAAE,EAAG,wBAAuB,IAAI,CAACD,IAAI,CAACC,EAAG;UACzC;SACD0L,OAAO,EAAE,IAAI,CAAC8N,qBAAqB,CAAC1c,IAAI,CAAC,IAAI;QAC7C,CACD;MACD;KACD2c,IAAI,GACJ;OACC,OAAO,IAAI,CAACvT,UAAU,CAACtE,MAAM,KAAK,CAAC,IAAI,IAAI,CAAC8X,SAAS,KAAK,IAAI;MAC9D;KACDA,SAAS,GACT;OACC,MAAMlI,QAAQ,GAAG,IAAI,CAACF,gBAAgB,CACpCnR,MAAM,CAAEJ,IAAoB,IAAK,CAAC,IAAI,CAAC4X,aAAa,CAACxU,QAAQ,CAACpD,IAAI,CAACC,EAAE,CAAC,CAAC;OAEzE,OAAOwR,QAAQ,CAAC5P,MAAM,KAAK,CAAC;MAC5B;KACD+X,YAAY,GACZ;OACC,IAAI,IAAI,CAACjS,SAAS,EAClB;SACC,OAAO,WAAW;;OAGnB,OAAO,IAAI,CAACkP,YAAY,GAAG,SAAS,GAAG,SAAS;;IAEjD;GACDzZ,KAAK,EAAE;KACN,MAAMH,sBAAsB,GAC5B;OACC,IAAI,CAAC,IAAI,CAACI,KAAK,CAACwc,cAAc,EAC9B;SACC;;OAGD,MAAM,IAAI,CAACtc,SAAS,EAAE;OACtB,IAAI,CAACC,MAAM,EAAE;MACb;KACD+T,gBAAgB,GAChB;OACC,IAAI,IAAI,CAAC5J,SAAS,EAClB;SACC,IAAI,CAACmS,qBAAqB,EAAE;;MAE7B;KACD9B,cAAc,CAACvY,KAAc,EAC7B;OACC,IAAI,CAAC,IAAI,CAACkI,SAAS,EACnB;SACC;;OAGD,IAAIlI,KAAK,EACT;SACC,IAAI,CAACsa,iBAAiB,EAAE;QACxB,MAED;SACC,IAAI,CAACC,qBAAqB,EAAE;;;IAG9B;GACDvc,OAAO,GACP;KACC,IAAI,CAACqJ,gBAAgB,GAAG,IAAIpH,gBAAgB,CAAC;OAC5C7D,QAAQ,EAAE;SACTsK,UAAU,EAAE,MAAM,IAAI,CAACA;;MAExB,CAAC;IACF;GACDpI,OAAO,GACP;KACC,IAAI,IAAI,CAAC8Y,YAAY,IAAI,IAAI,CAAClP,SAAS,EACvC;OACC,IAAI,CAACoS,iBAAiB,EAAE;;IAEzB;GACD7b,aAAa,GACb;KACC,IAAI,IAAI,CAAC2Y,YAAY,IAAI,IAAI,CAAClP,SAAS,EACvC;OACC,IAAI,CAACqS,qBAAqB,EAAE;;IAE7B;GACD5b,OAAO,EAAE;KACR2b,iBAAiB,GACjB;OACC/b,eAAK,CAACjB,IAAI,CAAC,IAAI,CAACM,KAAK,CAACqT,IAAI,EAAE,QAAQ,EAAE,IAAI,CAAC3D,YAAY,CAAC;OAExD6I,6BAAY,CAACqE,SAAS,CAAC,sBAAsB,EAAE,IAAI,CAACC,eAAe,CAAC;OACpEtE,6BAAY,CAACqE,SAAS,CAAC,sBAAsB,EAAE,IAAI,CAACE,eAAe,CAAC;OACpEvE,6BAAY,CAACqE,SAAS,CAAC,uBAAuB,EAAE,IAAI,CAACG,gBAAgB,CAAC;MACtE;KACDJ,qBAAqB,GACrB;OACChc,eAAK,CAACG,MAAM,CAAC,IAAI,CAACd,KAAK,CAACqT,IAAI,EAAE,QAAQ,EAAE,IAAI,CAAC3D,YAAY,CAAC;OAE1D6I,6BAAY,CAACyE,WAAW,CAAC,sBAAsB,EAAE,IAAI,CAACH,eAAe,CAAC;OACtEtE,6BAAY,CAACyE,WAAW,CAAC,sBAAsB,EAAE,IAAI,CAACF,eAAe,CAAC;OACtEvE,6BAAY,CAACyE,WAAW,CAAC,uBAAuB,EAAE,IAAI,CAACD,gBAAgB,CAAC;MACxE;KACDE,mBAAmB,GACnB;OACC,IAAI,IAAI,CAAC3S,SAAS,EAClB;SACC,IAAI,CAACmS,qBAAqB,EAAE;;MAE7B;KACDS,YAAY,GACZ;OACC,IAAI,CAACrD,mBAAmB,GAAG,IAAI;MAC/B;KACDsD,YAAY,CAAC1a,MAAuB,EACpC;OACC,IAAI,CAACA,MAAM,GAAGA,MAAM;OAEpB,IAAI,CAACwG,MAAM,EAAE;OAEb,IAAI,CAACsR,aAAa,GAAG,CAAC,GAAG,IAAI,CAACA,aAAa,EAAE9X,MAAM,CAAC;OAEpD,IAAI,CAAC2a,QAAQ,CAAC3a,MAAM,CAAC;OAErB,MAAM4a,UAAU,GACf,IAAI,CAAC1a,IAAI,CAACG,QAAQ,KAAK,CAAC,GACrB,gDAAgD,GAChD,+CACH;OAED,MAAMwa,QAAQ,GAAG,IAAIhF,iBAAiB,CAAC;SACtCG,OAAO,EAAE,IAAI,CAACxK,GAAG,CAACoP,UAAU;QAC5B,CAAC;OACFC,QAAQ,CAACC,aAAa,CAAC,UAAU,EAAGC,SAAoB,IAAK;SAC5D,MAAMC,aAAa,GAAGD,SAAS,CAACE,OAAO,EAAE;SAEzC,IAAID,aAAa,EACjB;WACC,IAAI,CAACrR,UAAU,CAAC3J,MAAM,CAAC;UACvB,MAED;WACC,IAAI,CAACkb,QAAQ,CAAClb,MAAM,CAAC;;SAGtB,IAAI,CAAC8X,aAAa,GAAG,IAAI,CAACA,aAAa,CAACxX,MAAM,CAAEH,EAAE,IAAKA,EAAE,KAAKH,MAAM,CAAC;SAErE,IAAI,CAACmb,QAAQ,EAAE;QACf,CAAC;OAEFN,QAAQ,CAAC1E,oBAAoB,EAAE;MAC/B;KACDlJ,YAAY,GACZ;OACC,IAAI,CAAC0K,kBAAkB,GAAG,KAAK;OAE/B,IAAI,CAACyD,mBAAmB,EAAE;MAC1B;KACDzc,UAAU,CAACc,IAAI,EACf;OACC,IAAI,CAAChB,KAAK,CAAC,MAAM,EAAEgB,IAAI,CAAC;MACxB;KACD,MAAMzC,WAAW,GACjB;OACC,IAAI,CAACqe,eAAe,EAAE;OAEtB,IAAI,CAAC5c,KAAK,CAAC,OAAO,CAAC;OAEnB,MAAM,IAAI,CAAC6c,aAAa,EAAE;MAC1B;KACDC,aAAa,CAAChc,OAAgB,EAC9B;OACC,IAAIA,OAAO,EACX;SACC,IAAI,CAAC0a,iBAAiB,EAAE;QACxB,MAED;SACC,IAAI,CAACC,qBAAqB,EAAE;;MAE7B;KACDE,eAAe,CAACW,SAAoB,EACpC;OACC,MAAMtb,IAAI,GAAGsb,SAAS,CAACS,aAAa,EAAE;OAEtC,MAAM7Q,WAAW,GAAGlL,IAAI,CAAC,CAAC,CAAC;OAC3B,MAAMK,MAAM,GAAGL,IAAI,CAAC,CAAC,CAAC;OAEtB,IAAIgK,cAAI,CAACgS,SAAS,CAAC9Q,WAAW,CAAC,EAC/B;SAAA;SACC,wBAAI,IAAI,CAACpN,KAAK,CAACqT,IAAI,aAAf,iBAAiBQ,QAAQ,CAACzG,WAAW,CAAC,EAC1C;WACC7K,MAAM,CAACsL,eAAe,GAAG,IAAI,CAAC7N,KAAK,CAACqT,IAAI;UACxC,MAED;WACC9Q,MAAM,CAACsL,eAAe,GAAGC,QAAQ,CAACC,IAAI;;;MAGxC;KACD+O,eAAe,CAACU,SAAoB,EACpC;OACC,MAAM,CAACW,KAAK,CAAC,GAAGX,SAAS,CAACS,aAAa,EAAE;OAEzC,IAAI,CAACxD,WAAW,CAAC7W,GAAG,CAACua,KAAK,CAACC,KAAK,EAAE,CAAC;OAEnC,IAAI,CAACnV,MAAM,EAAE;MACb;KACD8T,gBAAgB,CAACS,SAAoB,EACrC;OACC,MAAM,CAACW,KAAK,CAAC,GAAGX,SAAS,CAACS,aAAa,EAAE;OAEzC,IAAI,CAACxD,WAAW,CAAC4D,MAAM,CAACF,KAAK,CAACC,KAAK,EAAE,CAAC;OAEtC,IAAI,CAACR,QAAQ,EAAE;MACf;KACD,MAAMU,iBAAiB,CAAC7b,MAAuB,EAC/C;OACC,IAAI,CAACA,MAAM,GAAGA,MAAM;OAEpB,IAAI,CAACwG,MAAM,EAAE;OAEb,IAAI,CAACsR,aAAa,GAAG,CAAC,GAAG,IAAI,CAACA,aAAa,EAAE9X,MAAM,CAAC;OAEpD,IAAI,CAACwZ,aAAa,CAACxZ,MAAM,CAAC;OAE1B,MAAM8b,gBAAgB,GAAG,IAAI,CAAC9U,gBAAgB,CAACtE,mBAAmB,EAAE;OAEpE,MAAMqZ,WAAW,GAAG,IAAI,CAAC/U,gBAAgB,CAACtB,eAAe,CAAC,IAAI,CAACxF,IAAI,EAAE,KAAK,CAAC;OAC3E,IAAI6b,WAAW,EACf;SACC,MAAM,IAAI,CAACC,eAAe,CAACD,WAAW,CAAC5b,EAAE,EAAE;WAC1CqC,SAAS,EAAE;aACVC,MAAM,EAAE,IAAI;aACZE,QAAQ,EAAE;;UAEX,CAAC;SAEF/D,UAAU,CAAC,MAAM;WAChB,IAAI,CAACqd,aAAa,CAACF,WAAW,CAAC5b,EAAE,CAAC;UAClC,EAAE,CAAC,CAAC;;OAGN2b,gBAAgB,CAAC7Y,OAAO,CAAE/C,IAAoB,IAAK;SAClD,IAAI,CAACya,QAAQ,CAACza,IAAI,CAACC,EAAE,CAAC;QACtB,CAAC;OAEF,MAAMya,UAAU,GACfkB,gBAAgB,CAAC/Z,MAAM,GAAG,CAAC,GACxB,kDAAkD,GAClD,+CACH;OAED,MAAM8Y,QAAQ,GAAG,IAAIhF,iBAAiB,CAAC;SACtCG,OAAO,EAAE,IAAI,CAACxK,GAAG,CAACoP,UAAU;QAC5B,CAAC;OACFC,QAAQ,CAACC,aAAa,CAAC,UAAU,EAAGC,SAAoB,IAAK;SAC5D,MAAMC,aAAa,GAAGD,SAAS,CAACE,OAAO,EAAE;SACzCa,gBAAgB,CAAC7Y,OAAO,CAAE/C,IAAoB,IAAK;WAClD,IAAI8a,aAAa,EACjB;aACC,IAAI,CAACrR,UAAU,CAACzJ,IAAI,CAACC,EAAE,CAAC;YACxB,MAED;aACC,IAAI,CAAC+a,QAAQ,CAAChb,IAAI,CAACC,EAAE,CAAC;;WAGvB,IAAI,CAAC2X,aAAa,GAAG,IAAI,CAACA,aAAa,CAACxX,MAAM,CAAEH,EAAE,IAAKA,EAAE,KAAKD,IAAI,CAACC,EAAE,CAAC;UACtE,CAAC;SACF,IAAI6a,aAAa,EACjB;WACC,IAAIe,WAAW,IAAI,CAAC,IAAI,CAACjE,aAAa,CAACxU,QAAQ,CAACyY,WAAW,CAAC5b,EAAE,CAAC,EAC/D;aACC,IAAI,CAAC8b,aAAa,CAACF,WAAW,CAAC5b,EAAE,CAAC;YAClC,MAED;aACC,IAAI,CAACkb,eAAe,EAAE;;UAEvB,MAED;WACC,IAAI,CAACY,aAAa,CAAC,IAAI,CAAC/b,IAAI,CAACC,EAAE,CAAC;;SAGjC,IAAI,CAACgb,QAAQ,EAAE;QACf,CAAC;OAEFN,QAAQ,CAAC1E,oBAAoB,EAAE;MAC/B;KACD+F,sBAAsB,CAAClc,MAAuB,EAC9C;OACC,IAAI,CAACwB,yBAAyB,CAACxB,MAAM,CAAC;MACtC;KACDkJ,WAAW,CAAClJ,MAAuB,EACnC;OACC,IAAI,CAACic,aAAa,CAACjc,MAAM,CAAC;MAC1B;KACDmJ,UAAU,CAACnJ,MAAuB,EAClC;OACC,IAAI,CAACA,MAAM,GAAGA,MAAM;OAEpB,IAAI,IAAI,CAACuX,iBAAiB,KAAK,KAAK,EACpC;SACC,IAAI,CAACiC,aAAa,CAACxZ,MAAM,CAAC;;MAE3B;KACDoJ,eAAe,CAACpJ,MAAuB,EACvC;OACC,IAAI,CAACA,MAAM,GAAGA,MAAM;OAEpB,IAAI,IAAI,CAACE,IAAI,CAACG,QAAQ,KAAK,CAAC,EAC5B;SACC,IAAI,CAAC8b,wBAAwB,CAACnc,MAAM,CAAC;SAErC;;OAGD,IAAI,IAAI,CAACuX,iBAAiB,KAAK,KAAK,EACpC;SACC,IAAI,CAAC5N,UAAU,CAAC3J,MAAM,CAAC;;MAExB;KACDoc,eAAe,CAACpc,MAAuB,EACvC;OACC,IAAI,CAACA,MAAM,GAAGA,MAAM;OAEpB,MAAMqc,UAAU,GAAG,IAAI,CAACrV,gBAAgB,CAACZ,aAAa,CAACpG,MAAM,CAAC;OAC9D,IAAI,CAACqc,UAAU,EACf;SACC;;OAGD,IAAI,CAACC,iBAAiB,CAACtc,MAAM,CAAC;OAC9B,IAAI,CAACic,aAAa,CAACI,UAAU,CAAClc,EAAE,CAAC;MACjC;KACDoc,qBAAqB,CAACvc,MAAuB,EAC7C;OACC,IAAI,CAACA,MAAM,GAAGA,MAAM;OAEpB,IAAI,IAAI,CAACqY,qBAAqB,EAC9B;SACC,IAAI,CAAC4D,aAAa,CAACjc,MAAM,CAAC;QAC1B,MAED;SACC,IAAI,CAACwc,kCAAkC,CAACxc,MAAM,CAAC;;MAEhD;KACDyc,iBAAiB,CAAC;OAAEhJ,MAAM;OAAEiC;MAA2C,EACvE;OAAA;OACC,MAAMgH,cAAc,GAAG;SACtB,CAAC7J,WAAW,CAACC,YAAY,GAAI6J,CAAC,IAAK,IAAI,CAACC,YAAY,CAACD,CAAC,CAAC;SACvD,CAAC9J,WAAW,CAACE,UAAU,GAAI4J,CAAC,IAAK,IAAI,CAACE,UAAU,CAACF,CAAC,CAAC;SACnD,CAAC9J,WAAW,CAACG,SAAS,GAAI2J,CAAC,IAAK,IAAI,CAACG,gBAAgB,CAACH,CAAC,CAAC;SACxD,CAAC9J,WAAW,CAACI,QAAQ,GAAI0J,CAAC,IAAK,IAAI,CAACI,eAAe,CAACJ,CAAC,CAAC;SACtD,CAAC9J,WAAW,CAACK,gBAAgB,GAAIyJ,CAAC,IAAK;WACtC,IAAI,CAAC,IAAI,CAACpF,iBAAiB,EAC3B;aACC,IAAI,CAACyF,qBAAqB,CAACL,CAAC,EAAE,aAAa,CAAC;;UAE7C;SACD,CAAC9J,WAAW,CAACM,aAAa,GAAIwJ,CAAC,IAAK;WACnC,IAAI,CAAC,IAAI,CAACpF,iBAAiB,EAC3B;aACC,IAAI,CAACyF,qBAAqB,CAACL,CAAC,EAAE,UAAU,CAAC;;UAE1C;SACD,CAAC9J,WAAW,CAACH,OAAO,GAAIiK,CAAC,IAAK,IAAI,CAACM,OAAO,CAACN,CAAC,CAAC;SAC7C,CAAC9J,WAAW,CAACF,MAAM,GAAIgK,CAAC,IAAK,IAAI,CAACf,MAAM,CAACe,CAAC,CAAC;SAC3C,CAAC9J,WAAW,CAACD,MAAM,GAAI+J,CAAC,IAAK,IAAI,CAACtB,eAAe,CAACsB,CAAC;QACnD;OAED,yBAAAD,cAAc,CAACjJ,MAAM,CAAC,qBAAtB,2BAAAiJ,cAAc,EAAWhH,IAAI,CAAC;MAC9B;KACDwH,mBAAmB,CAAC1L,WAA4B,EAChD;OACC,KAAK,IAAI,CAACwK,eAAe,CAACxK,WAAW,EAAE;SACtC1F,SAAS,EAAE,KAAK;SAChB8B,gBAAgB,EAAE;QAClB,CAAC;OAEF,IAAI,CAACnP,KAAK,CAAC,MAAM,EAAE+S,WAAW,CAAC;MAC/B;KACDwK,eAAe,CAAC7b,EAAmB,EAAEoJ,MAA+B,EACpE;OACC,OAAO,IAAI,CAACrC,MAAM,CAACoC,QAAQ,CAAE,GAAElM,oBAAK,CAACiK,SAAU,SAAQ,EAAE;SAAElH,EAAE;SAAEoJ;QAAQ,CAAC;MACxE;KACD4T,UAAU,CAAC5T,MAA0B,EACrC;OACC,OAAO,IAAI,CAACrC,MAAM,CAACoC,QAAQ,CAAE,GAAElM,oBAAK,CAACgK,KAAM,SAAQ,EAAE;SACpDjH,EAAE,EAAE,IAAI,CAAC1E,MAAM;SACf8N;QACA,CAAC;MACF;KACD6T,gBAAgB,CAAClS,KAAuB,EACxC;OACC,OAAO,IAAI,CAAChE,MAAM,CAACoC,QAAQ,CAAE,GAAElM,oBAAK,CAACiK,SAAU,aAAY,EAAE6D,KAAK,CAAC;MACnE;KAEDmS,eAAe,CAACnd,IAAoB,EACpC;OACC,OAAO,IAAI,CAACgH,MAAM,CAACoC,QAAQ,CAAE,GAAElM,oBAAK,CAACiK,SAAU,SAAQ,EAAEnH,IAAI,CAAC;MAC9D;KAEDod,oBAAoB,CAACpS,KAAuB,EAC5C;OACC,OAAO,IAAI,CAAChE,MAAM,CAACoC,QAAQ,CAAE,GAAElM,oBAAK,CAACiK,SAAU,aAAY,EAAE6D,KAAK,CAAC;MACnE;KAEDqS,eAAe,CAACpd,EAAmB,EACnC;OACC,OAAO,IAAI,CAAC+G,MAAM,CAACoC,QAAQ,CAAE,GAAElM,oBAAK,CAACiK,SAAU,SAAQ,EAAElH,EAAE,CAAC;MAC5D;KACD,MAAMmb,aAAa,GACnB;OACC,IAAI,IAAI,CAAClE,mBAAmB,IAAI,IAAI,CAACe,MAAM,EAC3C;SACC,MAAMzQ,2DAAgB,CAAC8V,IAAI,CAAC,IAAI,CAAC/hB,MAAM,EAAE,IAAI,CAAC4K,UAAU,CAAC;;OAG1D,IAAI,CAAC,IAAI,CAACoX,uBAAuB,EAAE,EACnC;SACC,IAAI,CAACC,gBAAgB,EAAE;;OAGxB,IAAI,CAACtG,mBAAmB,GAAG,KAAK;MAChC;KACDqG,uBAAuB,GACvB;OACC,IAAI,IAAI,CAACpX,UAAU,CAACtE,MAAM,KAAK,CAAC,EAChC;SACC,OAAO,IAAI;;OAGZ,MAAM,CAAC2P,SAAS,CAAC,GAAG,IAAI,CAACrL,UAAU;OACnC,MAAMsX,SAAS,GAAG,IAAI,CAACnS,GAAG,CAAC,kCAAkC,EAAE;SAAE,UAAU,EAAE;QAAG,CAAC;OAEjF,OACCkG,SAAS,CAACjL,KAAK,KAAKkX,SAAS,IAC1BjM,SAAS,CAAC9I,WAAW,CAAC7G,MAAM,GAAG,CAAC,IAChC2P,SAAS,CAAC7I,QAAQ,CAAC9G,MAAM,GAAG,CAAC;MAEjC;KACD2b,gBAAgB,GAChB;OACC,IAAI,CAACrX,UAAU,CACb/F,MAAM,CAAEgH,SAAyB,IAAKA,SAAS,CAACjH,QAAQ,KAAK,CAAC,CAAC,CAC/D4C,OAAO,CAAE/C,IAAoB,IAAK;SAClC,IAAI,CAACyJ,UAAU,CAACzJ,IAAI,CAACC,EAAE,CAAC;QACxB,CAAC;MACH;KACD,MAAMyd,YAAY,CAACC,KAAc,GAAG,KAAK,EACzC;OACC,MAAMxd,QAAQ,GAAGoK,cAAI,CAACC,SAAS,EAAE;OACjC,MAAMoT,OAAO,GAAGrT,cAAI,CAACC,SAAS,EAAE;OAEhC,MAAMQ,KAAK,GAAG,CAAC,IAAI,CAAC6S,sBAAsB,CAAC1d,QAAQ,CAAC,CAAC;OACrD,IAAI,CAACwd,KAAK,EACV;SACC3S,KAAK,CAACnH,IAAI,CAAC;WACV5D,EAAE,EAAE2d,OAAO;WACX5Y,MAAM,EAAE4Y,OAAO;WACfzd,QAAQ;WACRK,SAAS,EAAE;UACX,CAAC;;OAGH,MAAM,IAAI,CAAC4c,oBAAoB,CAACpS,KAAK,CAAC;OACtC,KAAK,IAAI,CAACiS,UAAU,CAAC;SAAE7V,SAAS,EAAE,CAAC,GAAG,IAAI,CAACL,IAAI,CAACK,SAAS,EAAEjH,QAAQ,EAAEyd,OAAO;QAAG,CAAC;OAEhF,OAAOzd,QAAQ;MACf;KACD,MAAM2d,gBAAgB,GACtB;OACC,MAAMxM,WAAW,GAAG,MAAM,IAAI,CAACoM,YAAY,EAAE;OAE7C,IAAI,CAACV,mBAAmB,CAAC1L,WAAW,CAAC;MACrC;KACDyM,eAAe,CAACvI,IAAiB,EACjC;OACC,IAAI,CAACmC,kBAAkB,GAAGnC,IAAI;OAE9B,IAAI,CAACiC,kBAAkB,GAAG,IAAI;MAC9B;KACDuG,mBAAmB,GACnB;OACC,OAAO,IAAI,CAAC7X,UAAU,CAAC/F,MAAM,CAAEgH,SAAyB,IAAK;SAC5D,OAAOA,SAAS,CAACjH,QAAQ,KAAK,CAAC,IAAI,CAAC,IAAI,CAACyX,aAAa,CAACxU,QAAQ,CAACgE,SAAS,CAACnH,EAAE,CAAC;QAC7E,CAAC,CAAC4B,MAAM;MACT;KACDgc,sBAAsB,CAAC1d,QAAgB,EACvC;OACC,OAAO;SACNF,EAAE,EAAEE,QAAQ;SACZ6E,MAAM,EAAE7E,QAAQ;SAChBoG,KAAK,EAAE,IAAI,CAAC+E,GAAG,CAAC,kCAAkC,EAAE;WAAE,UAAU,EAAE,IAAI,CAAC2S,uBAAuB;UAAI,CAAC;SACnGzd,SAAS,EAAE,IAAI,CAAC0d,sBAAsB;QACtC;MACD;KACDA,sBAAsB,GACtB;OACC,OAAO,IAAI,CAACF,mBAAmB,EAAE;MACjC;KACDC,uBAAuB,GACvB;OACC,OAAO,IAAI,CAACD,mBAAmB,EAAE,GAAG,CAAC;MACrC;KACDlR,WAAW,CAAC7M,EAAE,EAAEke,GAAG,EACnB;OACC,IAAI,CAAC3G,SAAS,CAACvX,EAAE,CAAC,GAAGke,GAAG;MACxB;KACDvH,WAAW,CAAC3W,EAAE,EACd;OACC,OAAO,IAAI,CAACuX,SAAS,CAACvX,EAAE,CAAC;MACzB;KACD6P,WAAW,CAAChQ,MAAuB,EACnC;OACC,KAAK,IAAI,CAACvC,SAAS,CAAC,MAAM;SAAA;SACzB,yBAAI,CAACqZ,WAAW,CAAC9W,MAAM,CAAC,8CAAxB,kBAA0BzC,KAAK,CAACiT,eAAe,qBAA/C,sBAAiDC,aAAa,EAAE;QAChE,CAAC;MACF;KACDyK,QAAQ,CAAClb,MAAuB,EAChC;OACC,KAAK,IAAI,CAACgc,eAAe,CAAChc,MAAM,EAAE;SAAEmS,MAAM,EAAE;QAAO,CAAC;OAEpD,MAAM9O,QAAQ,GAAG,IAAI,CAAC2D,gBAAgB,CAAC7D,WAAW,CAACnD,MAAM,CAAC;OAC1D,IAAIqD,QAAQ,CAACtB,MAAM,GAAG,CAAC,EACvB;SACCsB,QAAQ,CAACJ,OAAO,CAAEf,KAAqB,IAAK;WAC3C,IAAI,CAACgZ,QAAQ,CAAChZ,KAAK,CAAC/B,EAAE,CAAC;UACvB,CAAC;;MAEH;KACDwa,QAAQ,CAAC3a,MAAuB,EAChC;OACC,KAAK,IAAI,CAACgc,eAAe,CAAChc,MAAM,EAAE;SAAEmS,MAAM,EAAE;QAAM,CAAC;OAEnD,MAAM9O,QAAQ,GAAG,IAAI,CAAC2D,gBAAgB,CAAC7D,WAAW,CAACnD,MAAM,CAAC;OAC1D,IAAIqD,QAAQ,CAACtB,MAAM,GAAG,CAAC,EACvB;SACCsB,QAAQ,CAACJ,OAAO,CAAEf,KAAqB,IAAK;WAC3C,IAAI,CAACyY,QAAQ,CAACzY,KAAK,CAAC/B,EAAE,CAAC;UACvB,CAAC;;MAEH;KACDqJ,OAAO,CAAC;OAAErJ,EAAE;OAAEI;MAA2C,EACzD;OACC,IAAI,IAAI,CAAC+d,kBAAkB,EAAE,EAC7B;SACC;;OAGD,IAAI,CAACte,MAAM,GAAGG,EAAE;OAEhB,MAAM2d,OAAO,GAAGrT,cAAI,CAACC,SAAS,EAAE;OAChC,MAAMrK,QAAQ,GAAG,IAAI,CAACH,IAAI,CAACG,QAAQ;OAEnC,IAAI,CAACkE,qBAAqB,CAAClE,QAAQ,EAAEE,IAAI,CAAC;OAE1C,KAAK,IAAI,CAAC8c,eAAe,CAAC;SACzBld,EAAE,EAAE2d,OAAO;SACX5Y,MAAM,EAAE4Y,OAAO;SACfzd,QAAQ;SACRK,SAAS,EAAEH;QACX,CAAC;OACF,KAAK,IAAI,CAAC4c,UAAU,CAAC;SAAE7V,SAAS,EAAE,CAAC,GAAG,IAAI,CAACL,IAAI,CAACK,SAAS,EAAEwW,OAAO;QAAG,CAAC;OAEtE,IAAI,CAACtc,yBAAyB,CAACsc,OAAO,CAAC;MACvC;KACDS,cAAc,CAAC/M,WAA4B,EAC3C;OACC,IAAI,IAAI,CAAC3J,SAAS,EAClB;SACC,IAAI,CAACqV,mBAAmB,CAAC1L,WAAW,CAAC;SAErC;;OAGD,IAAI,IAAI,CAAC8M,kBAAkB,EAAE,EAC7B;SACC;;OAGD,MAAMR,OAAO,GAAGrT,cAAI,CAACC,SAAS,EAAE;OAChC,MAAMhK,SAAS,GAAG,IAAI,CAACsG,gBAAgB,CAAC7D,WAAW,CAACqO,WAAW,CAAC,CAACzP,MAAM;OAEvE,KAAK,IAAI,CAACsb,eAAe,CAAC;SACzBld,EAAE,EAAE2d,OAAO;SACX5Y,MAAM,EAAE4Y,OAAO;SACfzd,QAAQ,EAAEmR,WAAW;SACrB9Q;QACA,CAAC;OACF,KAAK,IAAI,CAACyc,UAAU,CAAC;SAAE7V,SAAS,EAAE,CAAC,GAAG,IAAI,CAACL,IAAI,CAACK,SAAS,EAAEwW,OAAO;QAAG,CAAC;OAEtE,IAAI,CAACtc,yBAAyB,CAACsc,OAAO,CAAC;MACvC;KACDnU,UAAU,CAACxJ,EAAmB,EAAEqe,UAAmB,GAAG,IAAI,EAC1D;OAAA;OACC,IAAI,CAAC,IAAI,CAACvX,IAAI,EACd;SACC;;OAGD,IAAI,CAACjH,MAAM,GAAGG,EAAE;OAEhB,kBAAI,IAAI,CAACD,IAAI,aAAT,WAAWuG,KAAK,EACpB;SACC,IAAI,CAAC2Q,mBAAmB,GAAG,IAAI;;OAGhC,MAAM/W,QAAQ,GAAG,oBAAI,CAACH,IAAI,qBAAT,YAAWG,QAAQ,KAAI,IAAI;OAC5C,MAAMgD,QAAQ,GAAG,IAAI,CAAC2D,gBAAgB,CAAC7D,WAAW,CAAChD,EAAE,CAAC;OAEtD,IAAIkD,QAAQ,CAACtB,MAAM,GAAG,CAAC,EACvB;SACCsB,QAAQ,CAACJ,OAAO,CAAEf,KAAqB,IAAK;WAC3C,IAAI,CAACyH,UAAU,CAACzH,KAAK,CAAC/B,EAAE,EAAE,KAAK,CAAC;UAChC,CAAC;;OAGH,KAAK,IAAI,CAACgd,UAAU,CAAC;SAAE7V,SAAS,EAAE,IAAI,CAACL,IAAI,CAACK,SAAS,CAAChH,MAAM,CAAEN,MAAM,IAAKA,MAAM,KAAKG,EAAE;QAAG,CAAC;OAC1F,KAAK,IAAI,CAACod,eAAe,CAACpd,EAAE,CAAC;OAE7B,IAAIqe,UAAU,EACd;SACC,IAAI,CAACra,kBAAkB,CAAC9D,QAAQ,CAAC;;OAGlC,IAAI,CAACmB,yBAAyB,CAACrB,EAAE,EAAEE,QAAQ,CAAC;OAE5C4N,iDAAW,CAAC2N,MAAM,CAACzb,EAAE,EAAEgO,iDAAW,CAACC,aAAa,CAAC;MACjD;KACD7J,qBAAqB,CAAClE,QAAyB,EAAEK,SAAiB,EAClE;OACC,IAAI,CAACsG,gBAAgB,CAACzC,qBAAqB,CAC1ClE,QAAQ,EACRK,SAAS,EACR2D,OAAyB,IAAK;SAC9B,KAAK,IAAI,CAAC+Y,gBAAgB,CAAC/Y,OAAO,CAAC;QACnC,CACD;MACD;KACDF,kBAAkB,CAAC9D,QAAyB,EAC5C;OACC,IAAI,CAAC2G,gBAAgB,CAAC7C,kBAAkB,CACvC9D,QAAQ,EACPgE,OAAyB,IAAK,IAAI,CAAC+Y,gBAAgB,CAAC/Y,OAAO,CAAC,CAC7D;MACD;KACD7C,yBAAyB,CAACxB,MAAuB,EAAEK,QAAyB,EAC5E;OACC,IAAI,CAAC2G,gBAAgB,CAACxF,yBAAyB,CAC9CxB,MAAM,EACN,CAACG,EAAmB,EAAEoJ,MAA+B,KAAK,IAAI,CAACyS,eAAe,CAAC7b,EAAE,EAAEoJ,MAAM,CAAC,EAC1FlJ,QAAQ,CACR;MACD;KACDoe,eAAe,CAAC;OAAEze,MAAM;OAAE8L;MAA4D,EACtF;OACC,IAAI,CAAC9L,MAAM,GAAGA,MAAM;OAEpB,IAAI,CAACgH,gBAAgB,CAAChD,+BAA+B,CAAChE,MAAM,CAAC,CAC3DiD,OAAO,CAAE/C,IAAoB,IAAK;SAClC,IAAI4L,SAAS,KAAK,KAAK,EACvB;WACC,IAAI,CAACoP,QAAQ,CAAChb,IAAI,CAACC,EAAE,CAAC;UACtB,MAED;WACC,IAAI,CAACwa,QAAQ,CAACza,IAAI,CAACC,EAAE,CAAC;;QAEvB,CAAC;MACH;KACD8b,aAAa,CAACjc,MAAuB,EACrC;OACC,IAAI,IAAI,CAAC6H,SAAS,EAClB;SACC;;OAGD,IAAI,CAAC7H,MAAM,GAAGA,MAAM;OAEpB,IAAI,CAACmX,gBAAgB,GAAG,IAAI;OAE5B,KAAK,IAAI,CAAC6E,eAAe,CAAChc,MAAM,EAAE;SAAE4P,YAAY,EAAE;QAAM,CAAC;OAEzD,KAAK,IAAI,CAACnS,SAAS,CAAC,MAAM,IAAI,CAAC2d,mBAAmB,EAAE,CAAC;MACrD;KACD5B,aAAa,CAACxZ,MAAuB,EACrC;OACC,IAAI,IAAI,CAAC6H,SAAS,EAClB;SACC;;OAGD,IAAI,CAACsP,gBAAgB,GAAG,KAAK;OAE7B,IAAI,IAAI,CAACmH,kBAAkB,EAAE,IAAI,IAAI,CAACtX,gBAAgB,CAACtE,mBAAmB,EAAE,CAACX,MAAM,KAAK,CAAC,EACzF;SACC,IAAI,CAAC2c,mBAAmB,EAAE;;OAG3B,MAAMxe,IAAI,GAAG,IAAI,CAAC8G,gBAAgB,CAACjH,OAAO,CAACC,MAAM,CAAC;OAClD,IAAIE,IAAI,EACR;SACC,KAAK,IAAI,CAAC8b,eAAe,CAAChc,MAAM,EAAE;WAAE4P,YAAY,EAAE;UAAO,CAAC;;OAG3D,IAAI,CAAC2H,iBAAiB,GAAG,KAAK;MAC9B;KACDiF,kCAAkC,CAACxc,MAAuB,EAC1D;;OAEC,MAAM2e,mBAAmB,GAAG,IAAI,CAAC3X,gBAAgB,CAACtB,eAAe,CAAC,IAAI,CAACxF,IAAI,EAAE,IAAI,CAAC;OAClF,IAAIye,mBAAmB,EACvB;SACC,IAAI,CAAC1C,aAAa,CAAC0C,mBAAmB,CAACxe,EAAE,CAAC;QAC1C,MAED;SACC,IAAI,CAACqZ,aAAa,CAACxZ,MAAM,CAAC;;MAE3B;KACDob,mBAAmB,GACnB;OACC,IAAI,IAAI,CAACjE,gBAAgB,KAAK,KAAK,EACnC;SACC;;OAGD,MAAMyH,OAAO,GAAG,IAAI,CAACrhB,KAAK,CAACqT,IAAI,CAACiB,aAAa,CAAC,CAAE,aAAY,IAAI,CAAC3R,IAAI,CAACC,EAAG,IAAG,CAAC,CAAC;OAE9E,MAAM0e,SAAS,GAAGC,aAAG,CAACC,WAAW,CAAC,IAAI,CAACxhB,KAAK,CAACyhB,KAAK,CAACnU,GAAG,CAAC;OACvD,MAAMoU,QAAQ,GAAGH,aAAG,CAACC,WAAW,CAAC,IAAI,CAACxhB,KAAK,CAACqT,IAAI,CAAC;OACjD,MAAMsO,QAAQ,GAAGJ,aAAG,CAACK,mBAAmB,CAACP,OAAO,EAAE,IAAI,CAACrhB,KAAK,CAACqT,IAAI,CAAC;OAClE,MAAMwO,YAAY,GAAI,IAAI,CAAClf,IAAI,CAACG,QAAQ,KAAK,CAAE;OAE/C,MAAMgf,aAAa,GAAG,EAAE;OACxB,MAAMC,UAAU,GAAGT,SAAS,CAAC1iB,KAAK,KAAK,CAAC,GAAG,GAAG,GAAG0iB,SAAS,CAAC1iB,KAAK;OAEhE,MAAMuR,GAAG,GAAGwR,QAAQ,CAACxR,GAAG,GAAG,EAAE;OAE7B,IAAI0R,YAAY,EAChB;SACC,MAAMG,IAAI,GAAGN,QAAQ,CAAC9iB,KAAK,GAAGmjB,UAAU,GAAID,aAAa,GAAG,CAAE,GAAG,EAAE;SACnE,MAAM/H,OAAO,GAAG5J,GAAG,GAAG,CAAC,EAAE,IAAIA,GAAG,GAAG,IAAI,CAAC+J,iBAAiB,GAAG,MAAM,GAAG,MAAM;SAE3E,IAAI,CAACJ,eAAe,GAAG;WACtB3J,GAAG,EAAG,GAAEA,GAAI,IAAG;WACf6R,IAAI,EAAG,GAAEA,IAAK,IAAG;WACjBjI;UACA;QACD,MAED;SACC,MAAMiI,IAAI,GAAGN,QAAQ,CAAC9iB,KAAK,GAAGmjB,UAAU,GAAGD,aAAa;SACxD,MAAM/H,OAAO,GAAG5J,GAAG,GAAG,EAAE,IAAIA,GAAG,GAAG,IAAI,CAAC+J,iBAAiB,GAAG,MAAM,GAAG,MAAM;SAE1E,IAAI,CAACJ,eAAe,GAAG;WACtB3J,GAAG,EAAG,GAAEA,GAAI,IAAG;WACf6R,IAAI,EAAG,GAAEA,IAAK,IAAG;WACjBjI;UACA;;MAEF;KACDsF,YAAY,GACZ;OACC,IAAI,IAAI,CAACvE,qBAAqB,EAC9B;SACC,MAAMhU,OAAO,GAAG,IAAI,CAAC2C,gBAAgB,CAACtE,mBAAmB,EAAE,CACzDa,GAAG,CAAErD,IAAoB,KAAM;WAC/B,GAAGA,IAAI;WACPgZ,WAAW,EAAE,CAAChZ,IAAI,CAACgZ;UACnB,CAAC,CAAC;SAEJ,KAAK,IAAI,CAACkE,gBAAgB,CAAC/Y,OAAO,CAAC;QACnC,MAED;SACC,KAAK,IAAI,CAAC2X,eAAe,CAAC,IAAI,CAAC9b,IAAI,CAACC,EAAE,EAAE;WAAE+Y,WAAW,EAAE,CAAC,IAAI,CAAChZ,IAAI,CAACgZ;UAAa,CAAC;;OAGjF,IAAI,CAAC9B,mBAAmB,GAAG,IAAI;MAC/B;KACDyF,UAAU,CAACnH,IAAiB,EAC5B;OACC,IAAI,CAAC6B,iBAAiB,GAAG,IAAI;OAE7BtJ,iDAAW,CAACC,GAAG,CAAC,IAAI,CAAChO,IAAI,CAACC,EAAE,EAAEgO,iDAAW,CAACC,aAAa,CAAC,CAACoR,MAAM,CAAC;SAC/D7U,WAAW,EAAE+K;QACb,CAAC;OAEFzH,iDAAW,CAACC,GAAG,CAAC,IAAI,CAAChO,IAAI,CAACC,EAAE,EAAEgO,iDAAW,CAACC,aAAa,CAAC,CAAC0M,aAAa,CAAC,gBAAgB,EAAE,MAAM;SAC9F,IAAI,CAACvD,iBAAiB,GAAG,KAAK;SAE9B,IAAI,CAACvH,WAAW,CAAC,IAAI,CAAC9P,IAAI,CAACC,EAAE,CAAC;SAE9B,IAAI,CAACiX,mBAAmB,GAAG,IAAI;QAC/B,CAAC;MACF;KACD0F,gBAAgB,GAChB;OACC,IAAI,IAAI,CAACzE,qBAAqB,EAC9B;SACC,IAAI,CAACrR,gBAAgB,CAACtE,mBAAmB,EAAE,CACzCnC,IAAI,CAAC,CAACC,CAAiB,EAAEC,CAAiB,KAAKD,CAAC,CAACE,SAAS,GAAGD,CAAC,CAACC,SAAS,CAAC,CACzEuC,OAAO,CAAE/C,IAAoB,IAAK;WAClC,IAAI,CAACuE,SAAS,CAACvE,IAAI,CAAC;UACpB,CAAC;QACH,MAED;SACC,IAAI,CAACuE,SAAS,CAAC,IAAI,CAACvE,IAAI,CAAC;;MAE1B;KACDuE,SAAS,CAACvE,IAAoB,EAC9B;OACC,IAAI,CAAC8G,gBAAgB,CAACvC,SAAS,CAC9BvE,IAAI,EACHmE,OAAyB,IAAK;SAAA;SAC9B,KAAK,IAAI,CAAC+Y,gBAAgB,CAAC/Y,OAAO,CAAC;SACnC,IAAI,CAAC+S,mBAAmB,GAAG,IAAI;SAE/B,IAAI,qBAAClX,IAAI,CAACsC,SAAS,aAAd,gBAAgBC,MAAM,GAC3B;WACC,IAAI,CAACuN,WAAW,CAAC9P,IAAI,CAACC,EAAE,CAAC;;QAE1B,CACD;MACD;KACD4c,eAAe,GACf;OACC,IAAI,IAAI,CAAC1E,qBAAqB,EAC9B;SACC,IAAI,CAACrR,gBAAgB,CAACtE,mBAAmB,EAAE,CACzCnC,IAAI,CAAC,CAACC,CAAiB,EAAEC,CAAiB,KAAKA,CAAC,CAACC,SAAS,GAAGF,CAAC,CAACE,SAAS,CAAC,CACzEuC,OAAO,CAAE/C,IAAoB,IAAK;WAClC,IAAI,CAACiF,QAAQ,CAACjF,IAAI,CAAC;UACnB,CAAC;QACH,MAED;SACC,IAAI,CAACiF,QAAQ,CAAC,IAAI,CAACjF,IAAI,CAAC;;MAEzB;KACDiF,QAAQ,CAACjF,IAAoB,EAC7B;OACC,IAAI,CAAC8G,gBAAgB,CAAC7B,QAAQ,CAC7BjF,IAAI,EACHmE,OAAyB,IAAK;SAAA;SAC9B,KAAK,IAAI,CAAC+Y,gBAAgB,CAAC/Y,OAAO,CAAC;SACnC,IAAI,CAAC+S,mBAAmB,GAAG,IAAI;SAE/B,IAAI,sBAAClX,IAAI,CAACsC,SAAS,aAAd,iBAAgBC,MAAM,GAC3B;WACC,IAAI,CAACuN,WAAW,CAAC9P,IAAI,CAACC,EAAE,CAAC;;QAE1B,CACD;MACD;KACD,MAAM8c,OAAO,CAACvH,IAAiB,EAC/B;OACC,IAAI,IAAI,CAAC0C,sBAAsB,EAC/B;SACC,IAAI,CAAC6F,eAAe,CAACvI,IAAI,CAAC;QAC1B,MAED;SACC,IAAI,CAAC8D,aAAa,EAAE;SAEpB,KAAK,IAAI,CAACG,qBAAqB,EAAE;;OAGlC,IAAI,CAACvC,mBAAmB,GAAG,IAAI;MAC/B;KACD,MAAMuC,qBAAqB,GAC3B;OACC,MAAM8F,WAAW,GAAG,MAAM,IAAI,CAAC7B,YAAY,CAAC,IAAI,CAAC;OAEjD,IAAI,IAAI,CAACvF,qBAAqB,EAC9B;SACC,KAAK,IAAI,CAACoB,4BAA4B,CAACgG,WAAW,CAAC;QACnD,MAED;SACC,IAAI,CAAC/F,kBAAkB,CAAC+F,WAAW,CAAC;;MAErC;KACD/F,kBAAkB,CAAClI,WAA4B,EAC/C;OACC,MAAMkO,cAAc,GAAG,IAAI,CAAC1Y,gBAAgB,CAAC7D,WAAW,CAACqO,WAAW,CAAC,CAACzP,MAAM;OAE5E,KAAK,IAAI,CAACia,eAAe,CAAC,IAAI,CAAC9b,IAAI,CAACC,EAAE,EAAE;SACvCE,QAAQ,EAAEmR,WAAW;SACrB9Q,SAAS,EAAEgf;QACX,CAAC;OAEF,IAAI,CAACvb,kBAAkB,CAACqN,WAAW,CAAC;OACpC,IAAI,CAACrN,kBAAkB,CAAC,IAAI,CAACjE,IAAI,CAACG,QAAQ,CAAC;MAC3C;KACD,MAAMoZ,4BAA4B,CAACjI,WAA4B,EAC/D;OACC,MAAMkO,cAAc,GAAG,IAAI,CAAC1Y,gBAAgB,CAAC7D,WAAW,CAACqO,WAAW,CAAC,CAACzP,MAAM;OAE5E,MAAM4d,kCAAkC,GAAG,IAAI3e,GAAG,EAAE;OAEpD,MAAM8a,gBAAgB,GAAG,IAAI,CAAC9U,gBAAgB,CAACtE,mBAAmB,EAAE;OACpE,MAAMqZ,WAAW,GAAG,IAAI,CAAC/U,gBAAgB,CAACtB,eAAe,CAAC,IAAI,CAACxF,IAAI,EAAE,KAAK,EAAE4b,gBAAgB,CAAC;OAC7F,IAAIC,WAAW,EACf;SACC,IAAI,CAACE,aAAa,CAACF,WAAW,CAAC5b,EAAE,CAAC;QAClC,MAED;SACC,IAAI,CAACkb,eAAe,EAAE;;OAGvB,MAAMuE,uBAAuB,GAAG,IAAI,CAAC5Y,gBAAgB,CAACpE,+BAA+B,EAAE;OAEvF,MAAMid,gBAAgB,GAAG,IAAI7e,GAAG,CAAC8a,gBAAgB,CAACvY,GAAG,CAAErD,IAAoB,IAAKA,IAAI,CAACC,EAAE,CAAC,CAAC;OAEzF,MAAMkE,OAAO,GAAG,EAAE;OAElByX,gBAAgB,CAAC7Y,OAAO,CAAE/C,IAAoB,IAAK;SAClD,MAAM4f,oBAAoB,GAAG,CAACD,gBAAgB,CAAC3e,GAAG,CAAChB,IAAI,CAACG,QAAQ,CAAC;SAEjEsf,kCAAkC,CAACxe,GAAG,CAACjB,IAAI,CAACG,QAAQ,CAAC;SAErDgE,OAAO,CAACN,IAAI,CAAC;WACZ,GAAG7D,IAAI;WACPG,QAAQ,EAAEyf,oBAAoB,GAAGtO,WAAW,GAAGtR,IAAI,CAACG,QAAQ;WAC5DmC,SAAS,EAAE;aACVC,MAAM,EAAE,KAAK;aACbE,QAAQ,EAAE;YACV;WACDjC,SAAS,EAAEof,oBAAoB,GAAGJ,cAAc,GAAGxf,IAAI,CAACQ;UACxD,CAAC;QACF,CAAC;OAEFkf,uBAAuB,CAAC3c,OAAO,CAAE/C,IAAoB,IAAK;SACzD,IAAI,CAAC2f,gBAAgB,CAAC3e,GAAG,CAAChB,IAAI,CAACC,EAAE,CAAC,EAClC;WACCkE,OAAO,CAACN,IAAI,CAAC;aACZ,GAAG7D,IAAI;aACPsC,SAAS,EAAE;eACVC,MAAM,EAAE,KAAK;eACbE,QAAQ,EAAE;;YAEX,CAAC;;QAEH,CAAC;OAEF,MAAM,IAAI,CAACya,gBAAgB,CAAC/Y,OAAO,CAAC;OAEpC,IAAI0X,WAAW,EACf;SACC,KAAK,IAAI,CAACC,eAAe,CAACD,WAAW,CAAC5b,EAAE,EAAE;WACzCqC,SAAS,EAAE;aACVC,MAAM,EAAE,IAAI;aACZE,QAAQ,EAAE;;UAEX,CAAC;;OAGH,IAAI,CAACwB,kBAAkB,CAACqN,WAAW,CAAC;OACpCmO,kCAAkC,CAAC1c,OAAO,CAAE9C,EAAmB,IAAK;SACnE,IAAI,CAACgE,kBAAkB,CAAChE,EAAE,CAAC;QAC3B,CAAC;MACF;KACDyb,MAAM,GACN;OACC,IAAI,IAAI,CAACvD,qBAAqB,EAC9B;SACC,KAAK,IAAI,CAACwD,iBAAiB,CAAC,IAAI,CAAC3b,IAAI,CAACC,EAAE,CAAC;QACzC,MAED;SACC,IAAI,CAACqZ,aAAa,EAAE;SACpB,IAAI,CAACkB,YAAY,CAAC,IAAI,CAACxa,IAAI,CAACC,EAAE,CAAC;;MAEhC;KACDkb,eAAe,GACf;OACC,IAAI,CAACqD,mBAAmB,EAAE;OAC1B,IAAI,CAAClF,aAAa,EAAE;MACpB;KACDwD,qBAAqB,CAAC+C,UAAuB,EAAErkB,IAAgC,EAC/E;OAAA;OACC,IAAI,CAAC6b,iBAAiB,GAAG,IAAI;OAC7B,MAAMyI,WAAW,GAAG,IAAI,CAAC9f,IAAI,CAACxE,IAAI,CAAC,CAAC6H,GAAG,CAAE0c,IAAe,IAAK,CAAC,MAAM,EAAEA,IAAI,CAAC9f,EAAE,CAAC,CAAC;OAE/E,sBAAI,CAAC+f,QAAQ,6BAAb,IAAI,CAACA,QAAQ,GAAK,IAAIC,sDAAoB,CAAC;SAC1C,GAAGC,2DAAe,CAACC,aAAa,CAAC,IAAI,CAAC5kB,MAAM,EAAE,YAAY,CAAC;SAC3D6kB,gBAAgB,EAAEN,WAAW;SAC7B/jB,YAAY,EAAE;WACba,MAAM,EAAE;aACPyjB,MAAM,EAAGxF,SAAoB,IAAW;eACvC,MAAMW,KAAK,GAAGX,SAAS,CAACyF,SAAS,EAAE;eACnC,MAAMC,UAAU,GAAG/E,KAAK,CAACgF,iBAAiB,EAAE,CAACvL,WAAW;eACxD,MAAMwL,eAAe,GAAG,EAAE;eAE1B,MAAM5V,UAAU,GAAG4V,eAAe,GAAIF,UAAU,GAAG,CAAE;eACrD,MAAMG,UAAU,GAAGtlB,gBAAK,CAACulB,SAAS,CAAC,iBAAiB,CAAC,GAAGvlB,gBAAK,CAACulB,SAAS,CAAC,aAAa,CAAC;eAEtFnF,KAAK,CAACoF,QAAQ,CAAC;iBAAE7Q,MAAM,EAAEwQ,UAAU,GAAG,CAAC,GAAGG;gBAAY,CAAC;eACvDlF,KAAK,CAACqF,SAAS,CAAC;iBAAEhW,UAAU,EAAEA,UAAU,GAAGzP,gBAAK,CAACulB,SAAS,CAAC,iBAAiB;gBAAG,CAAC;cAChF;aACD9jB,OAAO,EAAE,MAAY;eACpB,MAAMikB,KAAK,GAAG,IAAI,CAACd,QAAQ,CAACe,gBAAgB,EAAE,CAAC1d,GAAG,CAAErD,IAAU,KAAM;iBACnEC,EAAE,EAAED,IAAI,CAACyb,KAAK,EAAE;iBAChB7gB,IAAI,EAAEoF,IAAI,CAACghB,QAAQ,EAAE;iBACrBC,KAAK,EAAEjhB,IAAI,CAACkhB,SAAS,EAAE;iBACvB1lB,IAAI,EAAEwE,IAAI,CAACmhB,aAAa;gBACxB,CAAC,CAAC;eAEH,IAAI,CAACC,gBAAgB,CAAC,IAAI,CAACpB,QAAQ,CAACpgB,MAAM,CAACE,MAAM,EAAE,IAAI,CAACkgB,QAAQ,CAACpgB,MAAM,CAACpE,IAAI,EAAEslB,KAAK,CAAC;;;UAGtF;SACDlkB,MAAM,EAAE;WACPykB,MAAM,EAAE,MAAY;aACnB,IAAI,CAAChK,iBAAiB,GAAG,KAAK;aAE9B,IAAI,CAAC,IAAI,CAACc,qBAAqB,IAAI,IAAI,CAACnY,IAAI,CAACC,EAAE,KAAK,IAAI,CAAC+f,QAAQ,CAACpgB,MAAM,CAACE,MAAM,EAC/E;eACC,IAAI,CAACgQ,WAAW,CAAC,IAAI,CAACkQ,QAAQ,CAACpgB,MAAM,CAACE,MAAM,CAAC;;aAG9C,IAAI,CAACob,mBAAmB,EAAE;;;QAG5B,CAAC;OAEF,IAAI,CAAC8E,QAAQ,CAACsB,gBAAgB,CAACxB,WAAW,CAAC;OAC3C,IAAI,CAACE,QAAQ,CAACpgB,MAAM,GAAG;SACtBE,MAAM,EAAE,IAAI,CAACE,IAAI,CAACC,EAAE;SACpBzE;QACA;OAED,IAAI,CAACwkB,QAAQ,CAACuB,MAAM,CAAC1B,UAAU,CAAC;MAChC;KACDuB,gBAAgB,CAACnhB,EAAmB,EAAEzE,IAAgC,EAAEslB,KAAkB,EAC1F;OACC,IAAI,IAAI,CAAC3I,qBAAqB,EAC9B;SACC,MAAMhU,OAAO,GAAG,IAAI,CAAC2C,gBAAgB,CAACtE,mBAAmB,EAAE,CACzDa,GAAG,CAAErD,IAAoB,KAAM;WAC/B,GAAGA,IAAI;WACP,CAACxE,IAAI,GAAGslB;UACR,CAAC,CAAC;SAEJ,KAAK,IAAI,CAAC5D,gBAAgB,CAAC/Y,OAAO,CAAC;QACnC,MAED;SACC,KAAK,IAAI,CAAC2X,eAAe,CAAC7b,EAAE,EAAE;WAC7B,CAACzE,IAAI,GAAGslB;UACR,CAAC;;OAGH,MAAMtQ,GAAG,GAAGsQ,KAAK,CAACzd,GAAG,CAAE0c,IAAe,IAAKA,IAAI,CAAC9f,EAAE,CAAC;OACnD,MAAMoJ,MAAM,GAAG;SACd,CAAE,GAAE7N,IAAK,KAAI,GAAGgV;QAChB;OAED,KAAK,IAAI,CAACyM,UAAU,CAAC5T,MAAM,CAAC;MAC5B;KACD+S,iBAAiB,CAAC5a,YAA6B,EAC/C;OACC,IAAI,CAAC1B,MAAM,GAAG0B,YAAY;OAE1B,MAAM2C,OAAO,GAAG,IAAI,CAAC2C,gBAAgB,CAACrD,cAAc,CAACjC,YAAY,CAAC,CAChE6B,GAAG,CAAC,CAACrD,IAAoB,EAAE8E,KAAa,MAAM;SAC9C,GAAG9E,IAAI;SACPsC,SAAS,EAAE;WACVC,MAAM,EAAE,IAAI;WACZE,QAAQ,EAAEqC,KAAK,KAAK;;QAErB,CAAC,CAAC;OAEJX,OAAO,CAACN,IAAI,CAAC;SACZ,GAAG,IAAI,CAAC7D,IAAI;SACZsC,SAAS,EAAE;WACVC,MAAM,EAAE,IAAI;WACZE,QAAQ,EAAE;;QAEX,CAAC;OAEF,KAAK,IAAI,CAACya,gBAAgB,CAAC/Y,OAAO,CAAC;MACnC;KACDqa,mBAAmB,GACnB;OACC,MAAMra,OAAO,GAAG,IAAI,CAAC2C,gBAAgB,CAACzE,oBAAoB,EAAE,CAC1DgB,GAAG,CAAErD,IAAoB,KAAM;SAC/B,GAAGA,IAAI;SACPsC,SAAS,EAAE;WACVC,MAAM,EAAE,KAAK;WACbE,QAAQ,EAAE;;QAEX,CAAC,CAAC;OAEJ,KAAK,IAAI,CAACya,gBAAgB,CAAC/Y,OAAO,CAAC;MACnC;KACDia,kBAAkB,GAClB;OACC,OAAO,IAAI,CAACtX,gBAAgB,CAACzE,oBAAoB,EAAE,CAACR,MAAM,GAAG,CAAC;MAC9D;KACDyE,MAAM,GACN;OAAA;OACC,6BAAI,CAACjJ,KAAK,CAACC,cAAc,+CAAzB,sBAA2BD,KAAK,+CAAhC,uBAAkCC,cAAc,qBAAhD,uBAAkDgJ,MAAM,EAAE;MAC1D;KACD2U,QAAQ,GACR;OACC,IACC,IAAI,CAACnD,WAAW,CAAC0J,IAAI,KAAK,CAAC,IACxB,IAAI,CAAC5J,aAAa,CAAC/V,MAAM,KAAK,CAAC,EAEnC;SAAA;SACC,8BAAI,CAACxE,KAAK,CAACC,cAAc,+CAAzB,uBAA2BD,KAAK,+CAAhC,uBAAkCC,cAAc,qBAAhD,uBAAkD2d,QAAQ,EAAE;;MAE7D;KACDgB,wBAAwB,CAACnc,MAAuB,EAChD;OACC,KAAK,IAAI,CAACgc,eAAe,CAAChc,MAAM,EAAE;SACjCyG,KAAK,EAAE,IAAI,CAAC+E,GAAG,CACd,kCAAkC,EAClC;WAAE,UAAU,EAAE,IAAI,CAAC0S,mBAAmB;UAAI;QAE3C,CAAC;MACF;KACDlE,qBAAqB,GACrB;OACC,MAAM2H,WAAW,GAAG,IAAI,CAAClQ,gBAAgB,CAAC,CAAC,CAAC;OAE5C,IAAIkQ,WAAW,CAAC/T,gBAAgB,KAAK,IAAI,EACzC;SACC,KAAK,IAAI,CAACoO,eAAe,CAAC2F,WAAW,CAACxhB,EAAE,EAAE;WAAEyN,gBAAgB,EAAE;UAAO,CAAC;;;IAGxE;GACDxS,QAAQ,EAAG;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;CAyEZ,CAAC;;CCrgDD;AACA,OAAawmB,aAAa,GAAG;GAC5B7mB,UAAU,EAAE;WACX8mB;IACA;GACDrmB,KAAK,EAAE;KACNC,MAAM,EAAE;OACPC,IAAI,EAAE,CAACC,MAAM,EAAEC,MAAM,CAAC;OACtBC,QAAQ,EAAE;MACV;KACDkb,YAAY,EAAE;OACbrb,IAAI,EAAE8D,OAAO;OACbsI,OAAO,EAAE;;IAEV;GACD7M,KAAK,EAAE,CAAC,eAAe,CAAC;GACxBC,KAAK,GACL;KACC,OAAO;gBACN6L,2BAAO;OACPT;MACA;IACD;GACDvK,QAAQ,EAAE;KACTkL,IAAI,GACJ;OACC,OAAO,IAAI,CAACC,MAAM,CAACC,OAAO,CAAE,GAAE/J,oBAAK,CAACgK,KAAM,UAAS,CAAC,CAAC,IAAI,CAAC3L,MAAM,CAAC;MACjE;KACD4K,UAAU,GACV;OACC,OAAO,IAAI,CAACa,MAAM,CAACC,OAAO,CAAE,GAAE/J,oBAAK,CAACiK,SAAU,WAAU,CAAC,CAAC,IAAI,CAACJ,IAAI,CAACK,SAAS,CAAC;MAC9E;KACD6H,WAAW,GACX;OAAA;OACC,+BAAO,IAAI,CAAClI,IAAI,CAACK,SAAS,qBAAnB,qBAAqBjF,IAAI,CAAErC,MAAM,IAAKiO,iDAAW,CAACC,GAAG,CAAClO,MAAM,EAAEmO,iDAAW,CAACC,aAAa,CAAC,CAACe,WAAW,EAAE,CAAC;MAC9G;KACD9C,MAAM,GACN;OACC,OAAO;SACN,CAAC,CAAC,IAAI,CAAC0K,YAAY,IAAI,CAAC,IAAI,CAAC+K,UAAU,GAAGC,2CAAU,CAACC,MAAM;SAC3D,CAAC,CAAC,IAAI,CAACjL,YAAY,IAAI,IAAI,CAAC+K,UAAU,GAAGC,2CAAU,CAACE,YAAY;SAChE,CAAC,IAAI,CAAClL,YAAY,IAAI,CAAC,IAAI,CAAC+K,UAAU,GAAGC,2CAAU,CAAChb,OAAO;SAC3D,CAAC,IAAI,CAACgQ,YAAY,IAAI,IAAI,CAAC+K,UAAU,GAAGC,2CAAU,CAACG;QACnD,CAACC,IAAI;MACN;KACDL,UAAU,GACV;OACC,OAAO,IAAI,CAACzb,UAAU,CAACtE,MAAM,GAAG,CAAC;MACjC;KACDqgB,kBAAkB,GAClB;OACC,OAAQ,IAAI,CAAC/b,UAAU,CAAC/F,MAAM,CAAEoR,SAAyB,IAAKA,SAAS,CAACrR,QAAQ,KAAK,CAAC,CAAC,CAAE0B,MAAM;MAC/F;KACDgT,IAAI,GACJ;OACC,IAAI,IAAI,CAACgC,YAAY,IAAI,IAAI,CAACqL,kBAAkB,GAAG,CAAC,EACpD;SACC,MAAMvV,cAAc,GAAG,IAAI,CAACwV,iBAAiB,EAAE;SAE/C,OAAO,IAAI,CAAC7W,GAAG,CACd,iCAAiC,EACjC;WACC,SAAS,EAAEqB,cAAc;WACzB,SAAS,EAAE,IAAI,CAACuV;UAChB,CACD;;OAGF,OAAO,IAAI,CAAC5W,GAAG,CAAC,gCAAgC,CAAC;MACjD;KACDC,IAAI,GACJ;OACC,IAAI,IAAI,CAAC0D,WAAW,EACpB;SACC,OAAOrI,4BAAQ,CAACwb,WAAW;;OAG5B,OAAOvb,2BAAO,CAAC0F,UAAU;;IAE1B;GACDxO,OAAO,GACP;KACC,IAAI,CAACe,OAAO,CAACC,YAAY,CAACkb,SAAS,CAAChb,wBAAS,CAACC,cAAc,EAAE,IAAI,CAACmjB,gBAAgB,CAAC;IACpF;GACDnkB,aAAa,GACb;KACC,IAAI,CAACY,OAAO,CAACC,YAAY,CAACsb,WAAW,CAACpb,wBAAS,CAACC,cAAc,EAAE,IAAI,CAACmjB,gBAAgB,CAAC;IACtF;GACDjkB,OAAO,EAAE;KACRwS,WAAW,GACX;OACC,IAAI,IAAI,CAACiG,YAAY,EACrB;SACC,KAAK,IAAI,CAACyL,aAAa,EAAE;QACzB,MAED;;SAEC,IAAI,IAAI,CAACV,UAAU,EACnB;WACC,IAAI,CAACW,cAAc,EAAE;UACrB,MAED;WACC,KAAK,IAAI,CAACD,aAAa,EAAE;;;MAG3B;KACD,MAAMA,aAAa,GACnB;OACC,IAAI,CAAC,IAAI,CAACV,UAAU,EACpB;SACC,MAAM,IAAI,CAACY,mBAAmB,EAAE;;OAGjC,IAAI,CAACjkB,KAAK,CAAC,eAAe,CAAC;MAC3B;KACD,MAAMikB,mBAAmB,GACzB;OACC,MAAMriB,QAAQ,GAAGoK,cAAI,CAACC,SAAS,EAAE;OACjC,MAAMoT,OAAO,GAAGrT,cAAI,CAACC,SAAS,EAAE;OAEhC,MAAM,IAAI,CAACxD,MAAM,CAACoC,QAAQ,CAAE,GAAElM,oBAAK,CAACiK,SAAU,aAAY,EAAE,CAC3D;SACClH,EAAE,EAAEE,QAAQ;SACZ6E,MAAM,EAAE7E,QAAQ;SAChBoG,KAAK,EAAE,IAAI,CAAC+E,GAAG,CAAC,kCAAkC,EAAE;WAAE,UAAU,EAAE;UAAG;QACrE,EACD;SACCrL,EAAE,EAAE2d,OAAO;SACX5Y,MAAM,EAAE4Y,OAAO;SACfzd;QACA,CACD,CAAC;OAEF,MAAM,IAAI,CAAC6G,MAAM,CAACoC,QAAQ,CAAE,GAAElM,oBAAK,CAACgK,KAAM,SAAQ,EAAE;SACnDjH,EAAE,EAAE,IAAI,CAAC1E,MAAM;SACf8N,MAAM,EAAE;WACPjC,SAAS,EAAE,CAACjH,QAAQ,EAAEyd,OAAO;;QAE9B,CAAC;MACF;KACD2E,cAAc,GACd;OACC,KAAKE,8CAAgB,CAACC,YAAY,CAAC,IAAI,CAAChR,KAAK,CAAC/G,GAAG,CAAC,CAACgY,SAAS,CAACvc,aAAa,CAACnG,EAAE,CAAC;MAC9E;KACDkiB,iBAAiB,GACjB;OACC,OAAO,IAAI,CAAChc,UAAU,CAAC/F,MAAM,CAAEgH,SAAyB,IAAK;SAC5D,OAAOA,SAAS,CAACnF,UAAU,IAAImF,SAAS,CAACjH,QAAQ,KAAK,CAAC;QACvD,CAAC,CAAC0B,MAAM;MACT;KACDwgB,gBAAgB,GAChB;OACC,IAAI,IAAI,CAACxL,YAAY,EACrB;SACC,IAAI,CAACxZ,KAAK,CAACulB,IAAI,CAACC,KAAK,EAAE;;;IAGzB;GACD3nB,QAAQ,EAAG;;;;;;;;;;;CAWZ,CAAC;;;;;;;;;;;"}