{"version":3,"file":"status.bundle.js","sources":["../src/status-meta.js","../src/status.js"],"sourcesContent":["import { Loc } from 'main.core';\n\nexport const statusMeta = Object.freeze({\n\tid: 'status',\n\ttitle: Loc.getMessage('TASKS_V2_STATUS_TITLE'),\n});\n","import { DateTimeFormat } from 'main.date';\nimport { BIcon } from 'ui.icon-set.api.vue';\nimport { Outline } from 'ui.icon-set.api.core';\nimport 'ui.icon-set.outline';\n\nimport { Hint } from 'tasks.v2.component.elements.hint';\nimport { Model, TaskStatus } from 'tasks.v2.const';\nimport type { TaskModel } from 'tasks.v2.model.tasks';\n\nimport { statusMeta } from './status-meta';\nimport './status.css';\n\n// @vue/component\nexport const Status = {\n\tcomponents: {\n\t\tBIcon,\n\t\tHint,\n\t},\n\tprops: {\n\t\ttaskId: {\n\t\t\ttype: [Number, String],\n\t\t\trequired: true,\n\t\t},\n\t},\n\tsetup(): Object\n\t{\n\t\treturn {\n\t\t\tstatusMeta,\n\t\t};\n\t},\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tisHintShown: false,\n\t\t};\n\t},\n\tcomputed: {\n\t\ttask(): TaskModel\n\t\t{\n\t\t\treturn this.$store.getters[`${Model.Tasks}/getById`](this.taskId);\n\t\t},\n\t\ticon(): string\n\t\t{\n\t\t\tconst statuses = {\n\t\t\t\t[TaskStatus.Pending]: Outline.HOURGLASS,\n\t\t\t\t[TaskStatus.InProgress]: Outline.NEXT,\n\t\t\t\t[TaskStatus.SupposedlyCompleted]: Outline.REFRESH,\n\t\t\t\t[TaskStatus.Completed]: Outline.SENDED,\n\t\t\t\t[TaskStatus.Deferred]: Outline.PAUSE_L,\n\t\t\t};\n\n\t\t\treturn statuses[this.task.status] ?? Outline.HOURGLASS;\n\t\t},\n\t\tstatusFormatted(): string\n\t\t{\n\t\t\tconst statuses = {\n\t\t\t\t[TaskStatus.Pending]: this.loc('TASKS_V2_STATUS_PENDING'),\n\t\t\t\t[TaskStatus.InProgress]: this.loc('TASKS_V2_STATUS_IN_PROGRESS'),\n\t\t\t\t[TaskStatus.SupposedlyCompleted]: this.loc('TASKS_V2_STATUS_SUPPOSEDLY_COMPLETED'),\n\t\t\t\t[TaskStatus.Completed]: this.loc('TASKS_V2_STATUS_COMPLETED'),\n\t\t\t\t[TaskStatus.Deferred]: this.loc('TASKS_V2_STATUS_DEFERRED'),\n\t\t\t};\n\n\t\t\treturn statuses[this.task.status] ?? this.loc('TASKS_V2_STATUS_PENDING');\n\t\t},\n\t\tstatusAtFormatted(): string\n\t\t{\n\t\t\tconst statuses = {\n\t\t\t\t[TaskStatus.Pending]: 'TASKS_V2_STATUS_PENDING_FROM',\n\t\t\t\t[TaskStatus.InProgress]: 'TASKS_V2_STATUS_IN_PROGRESS_FROM',\n\t\t\t\t[TaskStatus.SupposedlyCompleted]: 'TASKS_V2_STATUS_SUPPOSEDLY_COMPLETED_FROM',\n\t\t\t\t[TaskStatus.Completed]: 'TASKS_V2_STATUS_COMPLETED_AT',\n\t\t\t\t[TaskStatus.Deferred]: 'TASKS_V2_STATUS_DEFERRED_AT',\n\t\t\t};\n\n\t\t\treturn this.loc(statuses[this.task.status], {\n\t\t\t\t'#DATE#': this.formatDate(this.task.statusChangedTs),\n\t\t\t\t'#TIME#': this.formatTime(this.task.statusChangedTs),\n\t\t\t});\n\t\t},\n\t\tcreatedAtFormatted(): string\n\t\t{\n\t\t\treturn this.loc('TASKS_V2_STATUS_CREATED_AT', {\n\t\t\t\t'#DATE#': this.formatDate(this.task.createdTs),\n\t\t\t\t'#TIME#': this.formatTime(this.task.createdTs),\n\t\t\t});\n\t\t},\n\t},\n\tmethods: {\n\t\tformatDate(timestamp: number): string\n\t\t{\n\t\t\treturn DateTimeFormat.format(DateTimeFormat.getFormat('SHORT_DATE_FORMAT'), timestamp / 1000);\n\t\t},\n\t\tformatTime(timestamp: number): string\n\t\t{\n\t\t\treturn DateTimeFormat.format(DateTimeFormat.getFormat('SHORT_TIME_FORMAT'), timestamp / 1000);\n\t\t},\n\t\thandleClick(): void\n\t\t{\n\t\t\tthis.clearTimeouts();\n\t\t\tif (this.isHintShown)\n\t\t\t{\n\t\t\t\tthis.closePopup();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.showPopup();\n\t\t\t}\n\t\t},\n\t\thandleMouseEnter(): void\n\t\t{\n\t\t\tthis.clearTimeouts();\n\t\t\tthis.showTimeout = setTimeout(() => this.showPopup(), 100);\n\t\t},\n\t\thandleMouseLeave(): void\n\t\t{\n\t\t\tthis.clearTimeouts();\n\t\t\tthis.closePopup();\n\t\t},\n\t\tshowPopup(): void\n\t\t{\n\t\t\tthis.clearTimeouts();\n\t\t\tthis.isHintShown = true;\n\t\t},\n\t\tclosePopup(): void\n\t\t{\n\t\t\tthis.clearTimeouts();\n\t\t\tthis.isHintShown = false;\n\t\t},\n\t\tclearTimeouts(): void\n\t\t{\n\t\t\tclearTimeout(this.showTimeout);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div\n\t\t\tclass=\"tasks-field-status\"\n\t\t\t:data-task-id=\"taskId\"\n\t\t\t:data-task-field-id=\"statusMeta.id\"\n\t\t\t:data-task-field-value=\"task.status\"\n\t\t\t:data-task-created-ts=\"task.createdTs\"\n\t\t\t:data-task-status-changes-ts=\"task.statusChangedTs\"\n\t\t\tref=\"container\"\n\t\t\t@click=\"handleClick\"\n\t\t\t@mouseenter=\"handleMouseEnter\"\n\t\t\t@mouseleave=\"handleMouseLeave\"\n\t\t>\n\t\t\t<BIcon class=\"tasks-field-status-icon\" :name=\"icon\"/>\n\t\t\t<div class=\"tasks-field-status-text\">{{ statusFormatted }}</div>\n\t\t</div>\n\t\t<Hint v-if=\"isHintShown\" :bindElement=\"$refs.container\" @close=\"closePopup\">\n\t\t\t<div class=\"tasks-field-status-hint\">\n\t\t\t\t<div>{{ statusAtFormatted }}</div>\n\t\t\t\t<div>{{ createdAtFormatted }}</div>\n\t\t\t</div>\n\t\t</Hint>\n\t`,\n};\n"],"names":["statusMeta","Object","freeze","id","title","Loc","getMessage","Status","components","BIcon","Hint","props","taskId","type","Number","String","required","setup","data","isHintShown","computed","task","$store","getters","Model","Tasks","icon","statuses","TaskStatus","Pending","Outline","HOURGLASS","InProgress","NEXT","SupposedlyCompleted","REFRESH","Completed","SENDED","Deferred","PAUSE_L","status","statusFormatted","loc","statusAtFormatted","formatDate","statusChangedTs","formatTime","createdAtFormatted","createdTs","methods","timestamp","DateTimeFormat","format","getFormat","handleClick","clearTimeouts","closePopup","showPopup","handleMouseEnter","showTimeout","setTimeout","handleMouseLeave","clearTimeout","template"],"mappings":"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"}