{"version":3,"file":"deadline.bundle.js","sources":["../src/deadline-popup/deadline-popup-content.js","../src/deadline-popup/deadline-popup.js","../src/deadline-meta.js","../src/deadline.js"],"sourcesContent":["import { DateTimeFormat } from 'main.date';\nimport type { BaseEvent } from 'main.core.events';\n\nimport { DatePicker, DatePickerEvent } from 'ui.date-picker';\nimport { BIcon } from 'ui.icon-set.api.vue';\nimport { Outline } from 'ui.icon-set.api.core';\nimport 'ui.icon-set.outline';\n\nimport { Model, Analytics } from 'tasks.v2.const';\nimport { calendar } from 'tasks.v2.lib.calendar';\nimport { timezone } from 'tasks.v2.lib.timezone';\nimport { analytics } from 'tasks.v2.lib.analytics';\nimport type { TaskModel } from 'tasks.v2.model.tasks';\n\nimport './deadline-popup-content.css';\n\ntype Preset = {\n\tid: string,\n\ttitle: string,\n\ttimestamp: number,\n\tformatted: string,\n};\n\n// @vue/component\nexport const DeadlinePopupContent = {\n\tcomponents: {\n\t\tBIcon,\n\t},\n\tinject: ['analytics', 'cardType'],\n\tprops: {\n\t\ttaskId: {\n\t\t\ttype: [Number, String],\n\t\t\trequired: true,\n\t\t},\n\t},\n\temits: ['update', 'close'],\n\tsetup(): Object\n\t{\n\t\treturn {\n\t\t\tOutline,\n\t\t\ttoday: new Date(),\n\t\t\t/** @type DatePicker */\n\t\t\tdatePicker: null,\n\t\t\tdateTs: null,\n\t\t\thour: null,\n\t\t};\n\t},\n\tcomputed: {\n\t\ttask(): TaskModel\n\t\t{\n\t\t\treturn this.$store.getters[`${Model.Tasks}/getById`](this.taskId);\n\t\t},\n\t\tpresets(): Preset[]\n\t\t{\n\t\t\tconst [year, month, date] = [this.today.getFullYear(), this.today.getMonth(), this.today.getDate()];\n\t\t\tconst format = DateTimeFormat.getFormat('DAY_OF_WEEK_MONTH_FORMAT');\n\n\t\t\treturn [\n\t\t\t\t{\n\t\t\t\t\tid: `today-${this.taskId}`,\n\t\t\t\t\ttitle: this.loc('TASKS_V2_DEADLINE_TODAY'),\n\t\t\t\t\tdate: new Date(year, month, date),\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tid: `tomorrow-${this.taskId}`,\n\t\t\t\t\ttitle: this.loc('TASKS_V2_DEADLINE_TOMORROW'),\n\t\t\t\t\tdate: new Date(year, month, date + 1),\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tid: `end-week-${this.taskId}`,\n\t\t\t\t\ttitle: this.loc('TASKS_V2_DEADLINE_IN_THE_END_OF_THE_WEEK'),\n\t\t\t\t\tdate: new Date(year, month, date - this.today.getDay() + 5),\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tid: `in-week-${this.taskId}`,\n\t\t\t\t\ttitle: this.loc('TASKS_V2_DEADLINE_IN_A_WEEK'),\n\t\t\t\t\tdate: new Date(year, month, date + 7),\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tid: `month-${this.taskId}`,\n\t\t\t\t\ttitle: this.loc('TASKS_V2_DEADLINE_IN_THE_END_OF_THE_MONTH'),\n\t\t\t\t\tdate: new Date(year, month + 1, 0),\n\t\t\t\t},\n\t\t\t].map((preset): Preset => ({\n\t\t\t\tid: preset.id,\n\t\t\t\ttitle: preset.title,\n\t\t\t\ttimestamp: preset.date.getTime(),\n\t\t\t\tformatted: DateTimeFormat.format(format, preset.date),\n\t\t\t}));\n\t\t},\n\t},\n\tcreated(): void\n\t{\n\t\tthis.datePicker = this.createDatePicker();\n\n\t\tconst date = new Date(this.task.deadlineTs + timezone.getOffset(this.task.deadlineTs));\n\t\tthis.dateTs = new Date(date.getFullYear(), date.getMonth(), date.getDate()).getTime();\n\t\tthis.hour = date.getHours();\n\t},\n\tmounted(): void\n\t{\n\t\tthis.datePicker.setTargetNode(this.$refs.picker);\n\t\tthis.datePicker.show();\n\t},\n\tbeforeUnmount(): void\n\t{\n\t\tthis.datePicker.destroy();\n\t},\n\tmethods: {\n\t\tcreateDatePicker(): DatePicker\n\t\t{\n\t\t\tconst offset = timezone.getOffset(this.task.deadlineTs);\n\t\t\tconst picker = new DatePicker({\n\t\t\t\tselectedDates: this.task.deadlineTs ? [this.task.deadlineTs + offset] : null,\n\t\t\t\tdefaultTime: calendar.defaultTime,\n\t\t\t\tinline: true,\n\t\t\t\tenableTime: true,\n\t\t\t\tevents: {\n\t\t\t\t\t[DatePickerEvent.SELECT]: (event: BaseEvent) => {\n\t\t\t\t\t\tconst { date } = event.getData();\n\t\t\t\t\t\tconst dateTs = calendar.createDateFromUtc(date).getTime();\n\t\t\t\t\t\tthis.$emit('update', dateTs - timezone.getOffset(dateTs));\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t});\n\n\t\t\tpicker.getPicker('day').subscribe('onSelect', (event: BaseEvent) => {\n\t\t\t\tconst { year, month, day } = event.getData();\n\t\t\t\tconst dateTs = new Date(year, month, day).getTime();\n\n\t\t\t\tthis.close();\n\t\t\t\tthis.sendAnalytics(Analytics.Element.Calendar);\n\n\t\t\t\tthis.dateTs = dateTs;\n\t\t\t});\n\n\t\t\tpicker.getPicker('time').subscribe('onSelect', (event: BaseEvent) => {\n\t\t\t\tconst { hour, minute } = event.getData();\n\t\t\t\tif (Number.isInteger(minute) || hour === this.hour)\n\t\t\t\t{\n\t\t\t\t\tthis.close();\n\t\t\t\t}\n\t\t\t\tthis.sendAnalytics(Analytics.Element.Calendar);\n\n\t\t\t\tthis.hour = hour;\n\t\t\t});\n\n\t\t\treturn picker;\n\t\t},\n\t\tfocusDate(timestamp: ?number): void\n\t\t{\n\t\t\tthis.datePicker.setFocusDate(timestamp);\n\t\t},\n\t\tselectPresetDate(timestamp: number): void\n\t\t{\n\t\t\tconst date = new Date(timestamp);\n\t\t\tconst [y, m, d] = [date.getFullYear(), date.getMonth(), date.getDate()];\n\n\t\t\tthis.datePicker.selectDate(new Date(`${m + 1}/${d}/${y} ${calendar.defaultTime}`));\n\t\t\tthis.sendAnalytics(Analytics.Element.DeadlinePreset);\n\n\t\t\tthis.close();\n\t\t},\n\t\tclose(): void\n\t\t{\n\t\t\tthis.$emit('close');\n\t\t},\n\t\tsendAnalytics(element: string): void\n\t\t{\n\t\t\tanalytics.sendDeadlineSet(this.analytics, {\n\t\t\t\tcardType: this.cardType,\n\t\t\t\telement,\n\t\t\t});\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"tasks-field-deadline-popup\">\n\t\t\t<div class=\"tasks-field-deadline-presets\">\n\t\t\t\t<template v-for=\"(preset, index) of presets\" :key=\"index\">\n\t\t\t\t\t<div\n\t\t\t\t\t\t:data-task-preset-id=\"preset.id\"\n\t\t\t\t\t\tclass=\"tasks-field-deadline-preset\"\n\t\t\t\t\t\t@click=\"selectPresetDate(preset.timestamp)\"\n\t\t\t\t\t\t@mouseenter=\"focusDate(preset.timestamp)\"\n\t\t\t\t\t\t@mouseleave=\"focusDate(null)\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<div class=\"tasks-field-deadline-preset-title\">{{ preset.title }}</div>\n\t\t\t\t\t\t<div class=\"tasks-field-deadline-preset-date\">{{ preset.formatted }}</div>\n\t\t\t\t\t</div>\n\t\t\t\t</template>\n\t\t\t</div>\n\t\t\t<div class=\"tasks-field-deadline-picker-container\">\n\t\t\t\t<div class=\"tasks-field-deadline-picker\" ref=\"picker\">\n\t\t\t\t\t<BIcon v-if=\"false\" class=\"tasks-field-deadline-picker-settings\" :name=\"Outline.FILTER_2_LINES\"/>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div v-if=\"false\" class=\"tasks-field-deadline-settings\">\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import type { PopupOptions } from 'main.popup';\nimport { Popup } from 'ui.vue3.components.popup';\nimport { taskService } from 'tasks.v2.provider.service.task-service';\nimport { DeadlinePopupContent } from './deadline-popup-content';\n\n// @vue/component\nexport const DeadlinePopup = {\n\tcomponents: {\n\t\tPopup,\n\t\tDeadlinePopupContent,\n\t},\n\tprops: {\n\t\ttaskId: {\n\t\t\ttype: [Number, String],\n\t\t\trequired: true,\n\t\t},\n\t\tbindElement: {\n\t\t\ttype: HTMLElement,\n\t\t\trequired: true,\n\t\t},\n\t},\n\temits: ['update', 'close'],\n\tcomputed: {\n\t\tpopupOptions(): PopupOptions\n\t\t{\n\t\t\treturn {\n\t\t\t\tid: `tasks-field-deadline-popup-${this.taskId}`,\n\t\t\t\tbindElement: this.bindElement,\n\t\t\t\tpadding: 24,\n\t\t\t\toffsetTop: 5,\n\t\t\t\toffsetLeft: -100,\n\t\t\t\ttargetContainer: document.body,\n\t\t\t};\n\t\t},\n\t},\n\tmethods: {\n\t\tclear(): void\n\t\t{\n\t\t\tthis.deadlineTs = null;\n\t\t},\n\t\thandleUpdate(dateTs: number): void\n\t\t{\n\t\t\tthis.deadlineTs = dateTs;\n\t\t\tthis.$emit('update', dateTs);\n\t\t},\n\t\thandleClose(): void\n\t\t{\n\t\t\tif (this.deadlineTs)\n\t\t\t{\n\t\t\t\tvoid taskService.update(\n\t\t\t\t\tthis.taskId,\n\t\t\t\t\t{\n\t\t\t\t\t\tdeadlineTs: this.deadlineTs,\n\t\t\t\t\t},\n\t\t\t\t);\n\t\t\t}\n\n\t\t\tthis.$emit('close');\n\t\t},\n\t},\n\ttemplate: `\n\t\t<Popup\n\t\t\t:options=\"popupOptions\"\n\t\t\t@close=\"handleClose\"\n\t\t>\n\t\t\t<DeadlinePopupContent :taskId=\"taskId\" @update=\"handleUpdate\" @close=\"handleClose\"/>\n\t\t</Popup>\n\t`,\n};\n","import { Loc } from 'main.core';\n\nexport const deadlineMeta = Object.freeze({\n\tid: 'deadlineTs',\n\ttitle: Loc.getMessage('TASKS_V2_DEADLINE_TITLE'),\n});\n","import { DurationFormat } from 'main.date';\nimport { TextMd, Text2Xs } from 'ui.system.typography.vue';\nimport { BIcon, Outline } from 'ui.icon-set.api.vue';\nimport 'ui.icon-set.outline';\n\nimport { Model } from 'tasks.v2.const';\nimport { HoverPill } from 'tasks.v2.component.elements.hover-pill';\nimport { calendar } from 'tasks.v2.lib.calendar';\nimport { heightTransition } from 'tasks.v2.lib.height-transition';\nimport { taskService } from 'tasks.v2.provider.service.task-service';\nimport type { TaskModel } from 'tasks.v2.model.tasks';\n\nimport { DeadlinePopup } from './deadline-popup/deadline-popup';\nimport { deadlineMeta } from './deadline-meta';\nimport './deadline.css';\n\n// @vue/component\nexport const Deadline = {\n\tcomponents: {\n\t\tTextMd,\n\t\tText2Xs,\n\t\tHoverPill,\n\t\tBIcon,\n\t\tDeadlinePopup,\n\t},\n\tprops: {\n\t\ttaskId: {\n\t\t\ttype: [Number, String],\n\t\t\trequired: true,\n\t\t},\n\t},\n\tsetup(): Object\n\t{\n\t\treturn {\n\t\t\tdeadlineMeta,\n\t\t};\n\t},\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tnowTs: Date.now(),\n\t\t\tisPopupShown: false,\n\t\t\tselectingDeadlineTs: null,\n\t\t};\n\t},\n\tcomputed: {\n\t\ttask(): TaskModel\n\t\t{\n\t\t\treturn this.$store.getters[`${Model.Tasks}/getById`](this.taskId);\n\t\t},\n\t\tdeadlineTs(): number\n\t\t{\n\t\t\treturn this.selectingDeadlineTs ?? this.task.deadlineTs;\n\t\t},\n\t\texpiredDuration(): number\n\t\t{\n\t\t\tif (!this.deadlineTs)\n\t\t\t{\n\t\t\t\treturn 0;\n\t\t\t}\n\n\t\t\treturn this.nowTs - this.deadlineTs;\n\t\t},\n\t\tisExpired(): boolean\n\t\t{\n\t\t\treturn this.expiredDuration > 0 && !this.isFlowFilledOnAdd;\n\t\t},\n\t\texpiredFormatted(): string\n\t\t{\n\t\t\treturn this.loc('TASKS_V2_DEADLINE_EXPIRED', {\n\t\t\t\t'#EXPIRED_DURATION#': new DurationFormat(this.expiredDuration).formatClosest(),\n\t\t\t});\n\t\t},\n\t\tdeadlineFormatted(): string\n\t\t{\n\t\t\tif (this.isFlowFilledOnAdd)\n\t\t\t{\n\t\t\t\treturn this.loc('TASKS_V2_DEADLINE_AUTO');\n\t\t\t}\n\n\t\t\tif (!this.deadlineTs)\n\t\t\t{\n\t\t\t\treturn this.loc('TASKS_V2_DEADLINE_EMPTY');\n\t\t\t}\n\n\t\t\treturn calendar.formatDateTime(this.deadlineTs);\n\t\t},\n\t\ticonName(): string\n\t\t{\n\t\t\tif (this.isFlowFilledOnAdd)\n\t\t\t{\n\t\t\t\treturn Outline.BOTTLENECK;\n\t\t\t}\n\n\t\t\treturn Outline.CALENDAR_WITH_SLOTS;\n\t\t},\n\t\tisEdit(): boolean\n\t\t{\n\t\t\treturn Number.isInteger(this.taskId) && this.taskId > 0;\n\t\t},\n\t\tisFlowFilledOnAdd(): boolean\n\t\t{\n\t\t\treturn this.task.flowId > 0 && !this.isEdit;\n\t\t},\n\t\treadonly(): boolean\n\t\t{\n\t\t\treturn !this.task.rights.deadline || this.isFlowFilledOnAdd;\n\t\t},\n\t},\n\tmounted(): void\n\t{\n\t\theightTransition.animate(this.$refs.container);\n\t\tthis.nowTsInterval = setInterval(() => {\n\t\t\tthis.nowTs = Date.now();\n\t\t}, 1000);\n\t},\n\tupdated(): void\n\t{\n\t\theightTransition.animate(this.$refs.container);\n\t},\n\tbeforeUnmount(): void\n\t{\n\t\tclearInterval(this.nowTsInterval);\n\t},\n\tmethods: {\n\t\thandleClick(): void\n\t\t{\n\t\t\tif (this.readonly)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.isPopupShown = true;\n\t\t},\n\t\thandleCrossClick(): void\n\t\t{\n\t\t\tthis.$refs.popup?.clear();\n\n\t\t\tvoid taskService.update(\n\t\t\t\tthis.taskId,\n\t\t\t\t{\n\t\t\t\t\tdeadlineTs: 0,\n\t\t\t\t},\n\t\t\t);\n\t\t},\n\t\thandleUpdate(selectingDeadlineTs: number): void\n\t\t{\n\t\t\tthis.selectingDeadlineTs = selectingDeadlineTs;\n\t\t},\n\t\thandleClose(): void\n\t\t{\n\t\t\tthis.isPopupShown = false;\n\t\t\tthis.selectingDeadlineTs = null;\n\t\t\tthis.$refs.deadline?.$el?.focus();\n\t\t},\n\t\thandleKeydown(event: KeyboardEvent): void\n\t\t{\n\t\t\tif (event.key === 'Enter' && !(event.ctrlKey || event.metaKey))\n\t\t\t{\n\t\t\t\tvoid this.handleClick();\n\t\t\t}\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div\n\t\t\tclass=\"tasks-field-deadline\"\n\t\t\t:class=\"{ '--expired': isExpired, '--readonly': readonly, '--filled': deadlineTs }\"\n\t\t\t:data-task-id=\"taskId\"\n\t\t\t:data-task-field-id=\"deadlineMeta.id\"\n\t\t\t:data-task-field-value=\"task.deadlineTs\"\n\t\t\tref=\"container\"\n\t\t>\n\t\t\t<HoverPill\n\t\t\t\t:withClear=\"Boolean(deadlineTs) && !readonly\"\n\t\t\t\t:readonly=\"readonly\"\n\t\t\t\tref=\"deadline\"\n\t\t\t\t@click=\"handleClick\"\n\t\t\t\t@clear=\"handleCrossClick\"\n\t\t\t\t@keydown=\"handleKeydown\"\n\t\t\t>\n\t\t\t\t<BIcon class=\"tasks-field-deadline-icon\" :name=\"iconName\"/>\n\t\t\t\t<TextMd class=\"tasks-field-deadline-text\" :accent=\"isExpired\">{{ deadlineFormatted }}</TextMd>\n\t\t\t</HoverPill>\n\t\t\t<Text2Xs v-if=\"isExpired\" class=\"tasks-field-deadline-expired\">{{ expiredFormatted }}</Text2Xs>\n\t\t</div>\n\t\t<DeadlinePopup\n\t\t\tv-if=\"isPopupShown\"\n\t\t\t:taskId=\"taskId\"\n\t\t\t:bindElement=\"$refs.deadline.$el\"\n\t\t\tref=\"popup\"\n\t\t\t@update=\"handleUpdate\"\n\t\t\t@close=\"handleClose\"\n\t\t/>\n\t`,\n};\n"],"names":["DeadlinePopupContent","components","BIcon","inject","props","taskId","type","Number","String","required","emits","setup","Outline","today","Date","datePicker","dateTs","hour","computed","task","$store","getters","Model","Tasks","presets","year","month","date","getFullYear","getMonth","getDate","format","DateTimeFormat","getFormat","id","title","loc","getDay","map","preset","timestamp","getTime","formatted","created","createDatePicker","deadlineTs","timezone","getOffset","getHours","mounted","setTargetNode","$refs","picker","show","beforeUnmount","destroy","methods","offset","DatePicker","selectedDates","defaultTime","calendar","inline","enableTime","events","DatePickerEvent","SELECT","event","getData","createDateFromUtc","$emit","getPicker","subscribe","day","close","sendAnalytics","Analytics","Element","Calendar","minute","isInteger","focusDate","setFocusDate","selectPresetDate","y","m","d","selectDate","DeadlinePreset","element","analytics","sendDeadlineSet","cardType","template","DeadlinePopup","Popup","bindElement","HTMLElement","popupOptions","padding","offsetTop","offsetLeft","targetContainer","document","body","clear","handleUpdate","handleClose","taskService","update","deadlineMeta","Object","freeze","Loc","getMessage","Deadline","TextMd","Text2Xs","HoverPill","data","nowTs","now","isPopupShown","selectingDeadlineTs","expiredDuration","isExpired","isFlowFilledOnAdd","expiredFormatted","DurationFormat","formatClosest","deadlineFormatted","formatDateTime","iconName","BOTTLENECK","CALENDAR_WITH_SLOTS","isEdit","flowId","readonly","rights","deadline","heightTransition","animate","container","nowTsInterval","setInterval","updated","clearInterval","handleClick","handleCrossClick","popup","$el","focus","handleKeydown","key","ctrlKey","metaKey"],"mappings":";;;;;;;;CAuBA;AACA,CAAO,MAAMA,oBAAoB,GAAG;GACnCC,UAAU,EAAE;YACXC;IACA;GACDC,MAAM,EAAE,CAAC,WAAW,EAAE,UAAU,CAAC;GACjCC,KAAK,EAAE;KACNC,MAAM,EAAE;OACPC,IAAI,EAAE,CAACC,MAAM,EAAEC,MAAM,CAAC;OACtBC,QAAQ,EAAE;;IAEX;GACDC,KAAK,EAAE,CAAC,QAAQ,EAAE,OAAO,CAAC;GAC1BC,KAAK,GACL;KACC,OAAO;gBACNC,2BAAO;OACPC,KAAK,EAAE,IAAIC,IAAI,EAAE;;OAEjBC,UAAU,EAAE,IAAI;OAChBC,MAAM,EAAE,IAAI;OACZC,IAAI,EAAE;MACN;IACD;GACDC,QAAQ,EAAE;KACTC,IAAI,GACJ;OACC,OAAO,IAAI,CAACC,MAAM,CAACC,OAAO,CAAE,GAAEC,oBAAK,CAACC,KAAM,UAAS,CAAC,CAAC,IAAI,CAAClB,MAAM,CAAC;MACjE;KACDmB,OAAO,GACP;OACC,MAAM,CAACC,IAAI,EAAEC,KAAK,EAAEC,IAAI,CAAC,GAAG,CAAC,IAAI,CAACd,KAAK,CAACe,WAAW,EAAE,EAAE,IAAI,CAACf,KAAK,CAACgB,QAAQ,EAAE,EAAE,IAAI,CAAChB,KAAK,CAACiB,OAAO,EAAE,CAAC;OACnG,MAAMC,MAAM,GAAGC,wBAAc,CAACC,SAAS,CAAC,0BAA0B,CAAC;OAEnE,OAAO,CACN;SACCC,EAAE,EAAG,SAAQ,IAAI,CAAC7B,MAAO,EAAC;SAC1B8B,KAAK,EAAE,IAAI,CAACC,GAAG,CAAC,yBAAyB,CAAC;SAC1CT,IAAI,EAAE,IAAIb,IAAI,CAACW,IAAI,EAAEC,KAAK,EAAEC,IAAI;QAChC,EACD;SACCO,EAAE,EAAG,YAAW,IAAI,CAAC7B,MAAO,EAAC;SAC7B8B,KAAK,EAAE,IAAI,CAACC,GAAG,CAAC,4BAA4B,CAAC;SAC7CT,IAAI,EAAE,IAAIb,IAAI,CAACW,IAAI,EAAEC,KAAK,EAAEC,IAAI,GAAG,CAAC;QACpC,EACD;SACCO,EAAE,EAAG,YAAW,IAAI,CAAC7B,MAAO,EAAC;SAC7B8B,KAAK,EAAE,IAAI,CAACC,GAAG,CAAC,0CAA0C,CAAC;SAC3DT,IAAI,EAAE,IAAIb,IAAI,CAACW,IAAI,EAAEC,KAAK,EAAEC,IAAI,GAAG,IAAI,CAACd,KAAK,CAACwB,MAAM,EAAE,GAAG,CAAC;QAC1D,EACD;SACCH,EAAE,EAAG,WAAU,IAAI,CAAC7B,MAAO,EAAC;SAC5B8B,KAAK,EAAE,IAAI,CAACC,GAAG,CAAC,6BAA6B,CAAC;SAC9CT,IAAI,EAAE,IAAIb,IAAI,CAACW,IAAI,EAAEC,KAAK,EAAEC,IAAI,GAAG,CAAC;QACpC,EACD;SACCO,EAAE,EAAG,SAAQ,IAAI,CAAC7B,MAAO,EAAC;SAC1B8B,KAAK,EAAE,IAAI,CAACC,GAAG,CAAC,2CAA2C,CAAC;SAC5DT,IAAI,EAAE,IAAIb,IAAI,CAACW,IAAI,EAAEC,KAAK,GAAG,CAAC,EAAE,CAAC;QACjC,CACD,CAACY,GAAG,CAAEC,MAAM,KAAc;SAC1BL,EAAE,EAAEK,MAAM,CAACL,EAAE;SACbC,KAAK,EAAEI,MAAM,CAACJ,KAAK;SACnBK,SAAS,EAAED,MAAM,CAACZ,IAAI,CAACc,OAAO,EAAE;SAChCC,SAAS,EAAEV,wBAAc,CAACD,MAAM,CAACA,MAAM,EAAEQ,MAAM,CAACZ,IAAI;QACpD,CAAC,CAAC;;IAEJ;GACDgB,OAAO,GACP;KACC,IAAI,CAAC5B,UAAU,GAAG,IAAI,CAAC6B,gBAAgB,EAAE;KAEzC,MAAMjB,IAAI,GAAG,IAAIb,IAAI,CAAC,IAAI,CAACK,IAAI,CAAC0B,UAAU,GAAGC,8BAAQ,CAACC,SAAS,CAAC,IAAI,CAAC5B,IAAI,CAAC0B,UAAU,CAAC,CAAC;KACtF,IAAI,CAAC7B,MAAM,GAAG,IAAIF,IAAI,CAACa,IAAI,CAACC,WAAW,EAAE,EAAED,IAAI,CAACE,QAAQ,EAAE,EAAEF,IAAI,CAACG,OAAO,EAAE,CAAC,CAACW,OAAO,EAAE;KACrF,IAAI,CAACxB,IAAI,GAAGU,IAAI,CAACqB,QAAQ,EAAE;IAC3B;GACDC,OAAO,GACP;KACC,IAAI,CAAClC,UAAU,CAACmC,aAAa,CAAC,IAAI,CAACC,KAAK,CAACC,MAAM,CAAC;KAChD,IAAI,CAACrC,UAAU,CAACsC,IAAI,EAAE;IACtB;GACDC,aAAa,GACb;KACC,IAAI,CAACvC,UAAU,CAACwC,OAAO,EAAE;IACzB;GACDC,OAAO,EAAE;KACRZ,gBAAgB,GAChB;OACC,MAAMa,MAAM,GAAGX,8BAAQ,CAACC,SAAS,CAAC,IAAI,CAAC5B,IAAI,CAAC0B,UAAU,CAAC;OACvD,MAAMO,MAAM,GAAG,IAAIM,wBAAU,CAAC;SAC7BC,aAAa,EAAE,IAAI,CAACxC,IAAI,CAAC0B,UAAU,GAAG,CAAC,IAAI,CAAC1B,IAAI,CAAC0B,UAAU,GAAGY,MAAM,CAAC,GAAG,IAAI;SAC5EG,WAAW,EAAEC,8BAAQ,CAACD,WAAW;SACjCE,MAAM,EAAE,IAAI;SACZC,UAAU,EAAE,IAAI;SAChBC,MAAM,EAAE;WACP,CAACC,6BAAe,CAACC,MAAM,GAAIC,KAAgB,IAAK;aAC/C,MAAM;eAAExC;cAAM,GAAGwC,KAAK,CAACC,OAAO,EAAE;aAChC,MAAMpD,MAAM,GAAG6C,8BAAQ,CAACQ,iBAAiB,CAAC1C,IAAI,CAAC,CAACc,OAAO,EAAE;aACzD,IAAI,CAAC6B,KAAK,CAAC,QAAQ,EAAEtD,MAAM,GAAG8B,8BAAQ,CAACC,SAAS,CAAC/B,MAAM,CAAC,CAAC;;;QAG3D,CAAC;OAEFoC,MAAM,CAACmB,SAAS,CAAC,KAAK,CAAC,CAACC,SAAS,CAAC,UAAU,EAAGL,KAAgB,IAAK;SACnE,MAAM;WAAE1C,IAAI;WAAEC,KAAK;WAAE+C;UAAK,GAAGN,KAAK,CAACC,OAAO,EAAE;SAC5C,MAAMpD,MAAM,GAAG,IAAIF,IAAI,CAACW,IAAI,EAAEC,KAAK,EAAE+C,GAAG,CAAC,CAAChC,OAAO,EAAE;SAEnD,IAAI,CAACiC,KAAK,EAAE;SACZ,IAAI,CAACC,aAAa,CAACC,wBAAS,CAACC,OAAO,CAACC,QAAQ,CAAC;SAE9C,IAAI,CAAC9D,MAAM,GAAGA,MAAM;QACpB,CAAC;OAEFoC,MAAM,CAACmB,SAAS,CAAC,MAAM,CAAC,CAACC,SAAS,CAAC,UAAU,EAAGL,KAAgB,IAAK;SACpE,MAAM;WAAElD,IAAI;WAAE8D;UAAQ,GAAGZ,KAAK,CAACC,OAAO,EAAE;SACxC,IAAI7D,MAAM,CAACyE,SAAS,CAACD,MAAM,CAAC,IAAI9D,IAAI,KAAK,IAAI,CAACA,IAAI,EAClD;WACC,IAAI,CAACyD,KAAK,EAAE;;SAEb,IAAI,CAACC,aAAa,CAACC,wBAAS,CAACC,OAAO,CAACC,QAAQ,CAAC;SAE9C,IAAI,CAAC7D,IAAI,GAAGA,IAAI;QAChB,CAAC;OAEF,OAAOmC,MAAM;MACb;KACD6B,SAAS,CAACzC,SAAkB,EAC5B;OACC,IAAI,CAACzB,UAAU,CAACmE,YAAY,CAAC1C,SAAS,CAAC;MACvC;KACD2C,gBAAgB,CAAC3C,SAAiB,EAClC;OACC,MAAMb,IAAI,GAAG,IAAIb,IAAI,CAAC0B,SAAS,CAAC;OAChC,MAAM,CAAC4C,CAAC,EAAEC,CAAC,EAAEC,CAAC,CAAC,GAAG,CAAC3D,IAAI,CAACC,WAAW,EAAE,EAAED,IAAI,CAACE,QAAQ,EAAE,EAAEF,IAAI,CAACG,OAAO,EAAE,CAAC;OAEvE,IAAI,CAACf,UAAU,CAACwE,UAAU,CAAC,IAAIzE,IAAI,CAAE,GAAEuE,CAAC,GAAG,CAAE,IAAGC,CAAE,IAAGF,CAAE,IAAGvB,8BAAQ,CAACD,WAAY,EAAC,CAAC,CAAC;OAClF,IAAI,CAACe,aAAa,CAACC,wBAAS,CAACC,OAAO,CAACW,cAAc,CAAC;OAEpD,IAAI,CAACd,KAAK,EAAE;MACZ;KACDA,KAAK,GACL;OACC,IAAI,CAACJ,KAAK,CAAC,OAAO,CAAC;MACnB;KACDK,aAAa,CAACc,OAAe,EAC7B;OACCC,gCAAS,CAACC,eAAe,CAAC,IAAI,CAACD,SAAS,EAAE;SACzCE,QAAQ,EAAE,IAAI,CAACA,QAAQ;SACvBH;QACA,CAAC;;IAEH;GACDI,QAAQ,EAAG;;;;;;;;;;;;;;;;;;;;;;;;;CAyBZ,CAAC;;CCnMD;AACA,CAAO,MAAMC,aAAa,GAAG;GAC5B7F,UAAU,EAAE;YACX8F,8BAAK;KACL/F;IACA;GACDI,KAAK,EAAE;KACNC,MAAM,EAAE;OACPC,IAAI,EAAE,CAACC,MAAM,EAAEC,MAAM,CAAC;OACtBC,QAAQ,EAAE;MACV;KACDuF,WAAW,EAAE;OACZ1F,IAAI,EAAE2F,WAAW;OACjBxF,QAAQ,EAAE;;IAEX;GACDC,KAAK,EAAE,CAAC,QAAQ,EAAE,OAAO,CAAC;GAC1BQ,QAAQ,EAAE;KACTgF,YAAY,GACZ;OACC,OAAO;SACNhE,EAAE,EAAG,8BAA6B,IAAI,CAAC7B,MAAO,EAAC;SAC/C2F,WAAW,EAAE,IAAI,CAACA,WAAW;SAC7BG,OAAO,EAAE,EAAE;SACXC,SAAS,EAAE,CAAC;SACZC,UAAU,EAAE,CAAC,GAAG;SAChBC,eAAe,EAAEC,QAAQ,CAACC;QAC1B;;IAEF;GACDhD,OAAO,EAAE;KACRiD,KAAK,GACL;OACC,IAAI,CAAC5D,UAAU,GAAG,IAAI;MACtB;KACD6D,YAAY,CAAC1F,MAAc,EAC3B;OACC,IAAI,CAAC6B,UAAU,GAAG7B,MAAM;OACxB,IAAI,CAACsD,KAAK,CAAC,QAAQ,EAAEtD,MAAM,CAAC;MAC5B;KACD2F,WAAW,GACX;OACC,IAAI,IAAI,CAAC9D,UAAU,EACnB;SACC,KAAK+D,iDAAW,CAACC,MAAM,CACtB,IAAI,CAACxG,MAAM,EACX;WACCwC,UAAU,EAAE,IAAI,CAACA;UACjB,CACD;;OAGF,IAAI,CAACyB,KAAK,CAAC,OAAO,CAAC;;IAEpB;GACDuB,QAAQ,EAAG;;;;;;;;CAQZ,CAAC;;OClEYiB,YAAY,GAAGC,MAAM,CAACC,MAAM,CAAC;GACzC9E,EAAE,EAAE,YAAY;GAChBC,KAAK,EAAE8E,aAAG,CAACC,UAAU,CAAC,yBAAyB;CAChD,CAAC,CAAC;;CCWF;AACA,OAAaC,QAAQ,GAAG;GACvBlH,UAAU,EAAE;aACXmH,+BAAM;cACNC,gCAAO;gBACPC,+CAAS;YACTpH,wBAAK;KACL4F;IACA;GACD1F,KAAK,EAAE;KACNC,MAAM,EAAE;OACPC,IAAI,EAAE,CAACC,MAAM,EAAEC,MAAM,CAAC;OACtBC,QAAQ,EAAE;;IAEX;GACDE,KAAK,GACL;KACC,OAAO;OACNmG;MACA;IACD;GACDS,IAAI,GACJ;KACC,OAAO;OACNC,KAAK,EAAE1G,IAAI,CAAC2G,GAAG,EAAE;OACjBC,YAAY,EAAE,KAAK;OACnBC,mBAAmB,EAAE;MACrB;IACD;GACDzG,QAAQ,EAAE;KACTC,IAAI,GACJ;OACC,OAAO,IAAI,CAACC,MAAM,CAACC,OAAO,CAAE,GAAEC,oBAAK,CAACC,KAAM,UAAS,CAAC,CAAC,IAAI,CAAClB,MAAM,CAAC;MACjE;KACDwC,UAAU,GACV;OAAA;OACC,gCAAO,IAAI,CAAC8E,mBAAmB,oCAAI,IAAI,CAACxG,IAAI,CAAC0B,UAAU;MACvD;KACD+E,eAAe,GACf;OACC,IAAI,CAAC,IAAI,CAAC/E,UAAU,EACpB;SACC,OAAO,CAAC;;OAGT,OAAO,IAAI,CAAC2E,KAAK,GAAG,IAAI,CAAC3E,UAAU;MACnC;KACDgF,SAAS,GACT;OACC,OAAO,IAAI,CAACD,eAAe,GAAG,CAAC,IAAI,CAAC,IAAI,CAACE,iBAAiB;MAC1D;KACDC,gBAAgB,GAChB;OACC,OAAO,IAAI,CAAC3F,GAAG,CAAC,2BAA2B,EAAE;SAC5C,oBAAoB,EAAE,IAAI4F,wBAAc,CAAC,IAAI,CAACJ,eAAe,CAAC,CAACK,aAAa;QAC5E,CAAC;MACF;KACDC,iBAAiB,GACjB;OACC,IAAI,IAAI,CAACJ,iBAAiB,EAC1B;SACC,OAAO,IAAI,CAAC1F,GAAG,CAAC,wBAAwB,CAAC;;OAG1C,IAAI,CAAC,IAAI,CAACS,UAAU,EACpB;SACC,OAAO,IAAI,CAACT,GAAG,CAAC,yBAAyB,CAAC;;OAG3C,OAAOyB,8BAAQ,CAACsE,cAAc,CAAC,IAAI,CAACtF,UAAU,CAAC;MAC/C;KACDuF,QAAQ,GACR;OACC,IAAI,IAAI,CAACN,iBAAiB,EAC1B;SACC,OAAOlH,0BAAO,CAACyH,UAAU;;OAG1B,OAAOzH,0BAAO,CAAC0H,mBAAmB;MAClC;KACDC,MAAM,GACN;OACC,OAAOhI,MAAM,CAACyE,SAAS,CAAC,IAAI,CAAC3E,MAAM,CAAC,IAAI,IAAI,CAACA,MAAM,GAAG,CAAC;MACvD;KACDyH,iBAAiB,GACjB;OACC,OAAO,IAAI,CAAC3G,IAAI,CAACqH,MAAM,GAAG,CAAC,IAAI,CAAC,IAAI,CAACD,MAAM;MAC3C;KACDE,QAAQ,GACR;OACC,OAAO,CAAC,IAAI,CAACtH,IAAI,CAACuH,MAAM,CAACC,QAAQ,IAAI,IAAI,CAACb,iBAAiB;;IAE5D;GACD7E,OAAO,GACP;KACC2F,8CAAgB,CAACC,OAAO,CAAC,IAAI,CAAC1F,KAAK,CAAC2F,SAAS,CAAC;KAC9C,IAAI,CAACC,aAAa,GAAGC,WAAW,CAAC,MAAM;OACtC,IAAI,CAACxB,KAAK,GAAG1G,IAAI,CAAC2G,GAAG,EAAE;MACvB,EAAE,IAAI,CAAC;IACR;GACDwB,OAAO,GACP;KACCL,8CAAgB,CAACC,OAAO,CAAC,IAAI,CAAC1F,KAAK,CAAC2F,SAAS,CAAC;IAC9C;GACDxF,aAAa,GACb;KACC4F,aAAa,CAAC,IAAI,CAACH,aAAa,CAAC;IACjC;GACDvF,OAAO,EAAE;KACR2F,WAAW,GACX;OACC,IAAI,IAAI,CAACV,QAAQ,EACjB;SACC;;OAGD,IAAI,CAACf,YAAY,GAAG,IAAI;MACxB;KACD0B,gBAAgB,GAChB;OAAA;OACC,yBAAI,CAACjG,KAAK,CAACkG,KAAK,qBAAhB,kBAAkB5C,KAAK,EAAE;OAEzB,KAAKG,iDAAW,CAACC,MAAM,CACtB,IAAI,CAACxG,MAAM,EACX;SACCwC,UAAU,EAAE;QACZ,CACD;MACD;KACD6D,YAAY,CAACiB,mBAA2B,EACxC;OACC,IAAI,CAACA,mBAAmB,GAAGA,mBAAmB;MAC9C;KACDhB,WAAW,GACX;OAAA;OACC,IAAI,CAACe,YAAY,GAAG,KAAK;OACzB,IAAI,CAACC,mBAAmB,GAAG,IAAI;OAC/B,4BAAI,CAACxE,KAAK,CAACwF,QAAQ,8CAAnB,qBAAqBW,GAAG,qBAAxB,sBAA0BC,KAAK,EAAE;MACjC;KACDC,aAAa,CAACrF,KAAoB,EAClC;OACC,IAAIA,KAAK,CAACsF,GAAG,KAAK,OAAO,IAAI,EAAEtF,KAAK,CAACuF,OAAO,IAAIvF,KAAK,CAACwF,OAAO,CAAC,EAC9D;SACC,KAAK,IAAI,CAACR,WAAW,EAAE;;;IAGzB;GACDtD,QAAQ,EAAG;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;CA+BZ,CAAC;;;;;;;;;"}