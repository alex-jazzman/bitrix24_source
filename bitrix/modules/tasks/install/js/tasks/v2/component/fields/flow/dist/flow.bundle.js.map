{"version":3,"file":"flow.bundle.js","sources":["../src/flow-meta.js","../src/flow-dialog.js","../src/flow.js","../src/flow-chip.js"],"sourcesContent":["import { Loc } from 'main.core';\nimport { TaskField } from 'tasks.v2.const';\n\nexport const flowMeta = Object.freeze({\n\tid: TaskField.Flow,\n\ttitle: Loc.getMessage('TASKS_V2_FLOW_TITLE'),\n});\n","import { Extension, Runtime } from 'main.core';\n\nimport { EmptyStub, Footer } from 'tasks.flow.entity-selector';\nimport { Core } from 'tasks.v2.core';\nimport { EntitySelectorEntity, Model } from 'tasks.v2.const';\nimport { EntitySelectorDialog, type ItemId } from 'tasks.v2.lib.entity-selector-dialog';\nimport { groupService } from 'tasks.v2.provider.service.group-service';\nimport { taskService } from 'tasks.v2.provider.service.task-service';\nimport type { FlowModel } from 'tasks.v2.model.flows';\nimport type { GroupModel } from 'tasks.v2.model.groups';\nimport type { TaskModel } from 'tasks.v2.model.tasks';\n\nclass FlowDialog\n{\n\t#taskId: number | string;\n\t#dialog: EntitySelectorDialog;\n\t#onUpdateOnce: Function | null = null;\n\n\tsetTaskId(taskId: number | string): FlowDialog\n\t{\n\t\tthis.#taskId = taskId;\n\n\t\treturn this;\n\t}\n\n\tshowTo(targetNode: HTMLElement): void\n\t{\n\t\tthis.#dialog ??= this.#createDialog();\n\t\tthis.#dialog.selectItemsByIds(this.#items);\n\t\tthis.#dialog.showTo(targetNode);\n\t}\n\n\tonUpdateOnce(callback: Function): void\n\t{\n\t\tthis.#onUpdateOnce = callback;\n\t}\n\n\t#createDialog(): EntitySelectorDialog\n\t{\n\t\tconst onItemChangeDebounced = Runtime.debounce(this.#onItemChange, 10, this);\n\n\t\tconst dialog = new EntitySelectorDialog({\n\t\t\tcontext: 'tasks-card',\n\t\t\twidth: 380,\n\t\t\theight: 370,\n\t\t\tmultiple: false,\n\t\t\thideOnDeselect: true,\n\t\t\tenableSearch: true,\n\t\t\tentities: [\n\t\t\t\t{\n\t\t\t\t\tid: EntitySelectorEntity.Flow,\n\t\t\t\t\toptions: {\n\t\t\t\t\t\tonlyActive: true,\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t],\n\t\t\tpreselectedItems: this.#items,\n\t\t\tevents: {\n\t\t\t\t'Item:onSelect': onItemChangeDebounced,\n\t\t\t\t'Item:onDeselect': onItemChangeDebounced,\n\t\t\t\tonHide: this.#clearOnUpdateOnce,\n\t\t\t\tonDestroy: this.#clearOnUpdateOnce,\n\t\t\t},\n\t\t\trecentTabOptions: {\n\t\t\t\tstub: EmptyStub,\n\t\t\t\tstubOptions: {\n\t\t\t\t\tshowArrow: false,\n\t\t\t\t},\n\t\t\t},\n\t\t});\n\n\t\tif (Core.getParams().rights?.flow?.create)\n\t\t{\n\t\t\tconst isFeatureTriable = Extension.getSettings('tasks.v2.component.fields.flow').get('isFeatureTriable');\n\n\t\t\tconst footer = new Footer(dialog, {\n\t\t\t\tisFeatureTriable,\n\t\t\t});\n\t\t\tdialog.setFooter(footer.render());\n\t\t}\n\n\t\treturn dialog;\n\t}\n\n\tasync #onItemChange(): void\n\t{\n\t\tconst item = this.#dialog.getSelectedItems()[0];\n\t\tconst groupId = item?.getCustomData().get('groupId');\n\t\tif (item)\n\t\t{\n\t\t\tthis.#insertFlow({\n\t\t\t\tid: item.getId(),\n\t\t\t\tname: item.getTitle(),\n\t\t\t});\n\n\t\t\tconst group: GroupModel | undefined = Core.getStore().getters[`${Model.Groups}/getById`](groupId);\n\t\t\tif (!group)\n\t\t\t{\n\t\t\t\tawait groupService.getGroup(groupId);\n\t\t\t}\n\t\t}\n\n\t\tthis.#updateFlow(item?.getId() ?? 0, groupId ?? 0);\n\t}\n\n\tget #items(): ItemId[]\n\t{\n\t\treturn [[EntitySelectorEntity.Flow, this.#task.flowId]];\n\t}\n\n\tget #task(): TaskModel\n\t{\n\t\treturn Core.getStore().getters[`${Model.Tasks}/getById`](this.#taskId);\n\t}\n\n\t#insertFlow(flow: FlowModel): void\n\t{\n\t\tvoid Core.getStore().dispatch(`${Model.Flows}/insert`, flow);\n\t}\n\n\t#updateFlow(flowId: number, groupId: number): void\n\t{\n\t\tconst creatorId = Core.getStore().getters[`${Model.Interface}/currentUserId`];\n\t\tvoid taskService.update(\n\t\t\tthis.#taskId,\n\t\t\t{\n\t\t\t\tcreatorId,\n\t\t\t\tflowId,\n\t\t\t\tgroupId,\n\t\t\t\tstageId: 0,\n\t\t\t},\n\t\t);\n\n\t\tthis.#onUpdateOnce?.();\n\t\tthis.#clearOnUpdateOnce();\n\t}\n\n\t#clearOnUpdateOnce = (): void => {\n\t\tthis.#onUpdateOnce = null;\n\t};\n}\n\nexport const flowDialog = new FlowDialog();\n","import { SidePanel } from 'main.sidepanel';\nimport { mapGetters } from 'ui.vue3.vuex';\nimport { BMenu, MenuItemDesign, type MenuOptions } from 'ui.vue3.components.menu';\nimport { BIcon, Outline } from 'ui.icon-set.api.vue';\nimport 'ui.icon-set.outline';\n\nimport { Model } from 'tasks.v2.const';\nimport { HoverPill } from 'tasks.v2.component.elements.hover-pill';\nimport { FieldAdd } from 'tasks.v2.component.elements.field-add';\nimport { Stage } from 'tasks.v2.component.fields.group';\nimport { flowService } from 'tasks.v2.provider.service.flow-service';\nimport { taskService } from 'tasks.v2.provider.service.task-service';\nimport type { FlowModel } from 'tasks.v2.model.flows';\nimport type { TaskModel } from 'tasks.v2.model.tasks';\n\nimport { flowMeta } from './flow-meta';\nimport { flowDialog } from './flow-dialog';\nimport './flow.css';\n\n// @vue/component\nexport const Flow = {\n\tname: 'TaskFlow',\n\tcomponents: {\n\t\tBIcon,\n\t\tBMenu,\n\t\tHoverPill,\n\t\tFieldAdd,\n\t\tStage,\n\t},\n\tprops: {\n\t\ttaskId: {\n\t\t\ttype: [Number, String],\n\t\t\trequired: true,\n\t\t},\n\t},\n\tsetup(): Object\n\t{\n\t\treturn {\n\t\t\tflowMeta,\n\t\t\tOutline,\n\t\t};\n\t},\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tisMenuShown: false,\n\t\t};\n\t},\n\tcomputed: {\n\t\t...mapGetters({\n\t\t\tcurrentUserId: `${Model.Interface}/currentUserId`,\n\t\t}),\n\t\ttask(): TaskModel\n\t\t{\n\t\t\treturn this.$store.getters[`${Model.Tasks}/getById`](this.taskId);\n\t\t},\n\t\tflow(): FlowModel\n\t\t{\n\t\t\treturn this.$store.getters[`${Model.Flows}/getById`](this.task.flowId);\n\t\t},\n\t\tisEdit(): boolean\n\t\t{\n\t\t\treturn Number.isInteger(this.taskId) && this.taskId > 0;\n\t\t},\n\t\tmenuOptions(): MenuOptions\n\t\t{\n\t\t\treturn {\n\t\t\t\tid: 'tasks-field-flow-menu',\n\t\t\t\tbindElement: this.$refs.container,\n\t\t\t\toffsetTop: 8,\n\t\t\t\titems: [\n\t\t\t\t\t{\n\t\t\t\t\t\ttitle: this.loc('TASKS_V2_FLOW_ABOUT'),\n\t\t\t\t\t\ticon: Outline.BOTTLENECK,\n\t\t\t\t\t\tonClick: this.openFlow,\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\ttitle: this.loc('TASKS_V2_FLOW_CHANGE'),\n\t\t\t\t\t\ticon: Outline.EDIT_L,\n\t\t\t\t\t\tonClick: this.showDialog,\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tdesign: MenuItemDesign.Alert,\n\t\t\t\t\t\ttitle: this.loc('TASKS_V2_FLOW_DETACH'),\n\t\t\t\t\t\ticon: Outline.CROSS_L,\n\t\t\t\t\t\tonClick: this.clearField,\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t\ttargetContainer: document.body,\n\t\t\t};\n\t\t},\n\t\treadonly(): boolean\n\t\t{\n\t\t\treturn !this.task.rights.edit;\n\t\t},\n\t},\n\tmethods: {\n\t\thandleClick(): void\n\t\t{\n\t\t\tif (this.flow && this.readonly)\n\t\t\t{\n\t\t\t\tthis.openFlow();\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (this.isEdit && this.flow)\n\t\t\t{\n\t\t\t\tthis.showMenu();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.showDialog();\n\t\t\t}\n\t\t},\n\t\tshowMenu(): void\n\t\t{\n\t\t\tthis.isMenuShown = true;\n\t\t},\n\t\thandleClear(): void\n\t\t{\n\t\t\tthis.clearField();\n\t\t},\n\t\topenFlow(): void\n\t\t{\n\t\t\tconst href = flowService.getUrl(this.flow.id, this.currentUserId);\n\n\t\t\tSidePanel.Instance.open(href);\n\t\t},\n\t\tclearField(): void\n\t\t{\n\t\t\tvoid taskService.update(\n\t\t\t\tthis.taskId,\n\t\t\t\t{\n\t\t\t\t\tflowId: 0,\n\t\t\t\t\tgroupId: 0,\n\t\t\t\t\tstageId: 0,\n\t\t\t\t},\n\t\t\t);\n\t\t},\n\t\tshowDialog(): void\n\t\t{\n\t\t\tflowDialog.setTaskId(this.taskId).showTo(this.$refs.container);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div\n\t\t\t:data-task-id=\"taskId\"\n\t\t\t:data-task-field-id=\"flowMeta.id\"\n\t\t\t:data-task-field-value=\"task.flowId\"\n\t\t>\n\t\t\t<HoverPill\n\t\t\t\tv-if=\"flow\"\n\t\t\t\t:withClear=\"!readonly && !isEdit\"\n\t\t\t\t@click=\"handleClick\"\n\t\t\t\t@clear=\"handleClear\"\n\t\t\t>\n\t\t\t\t<div class=\"tasks-field-flow\">\n\t\t\t\t\t<BIcon :name=\"Outline.BOTTLENECK\"/>\n\t\t\t\t\t<div class=\"tasks-field-flow-title\">{{ flow.name }}</div>\n\t\t\t\t</div>\n\t\t\t</HoverPill>\n\t\t\t<FieldAdd v-else :icon=\"Outline.BOTTLENECK\" @click=\"handleClick\"/>\n\t\t\t<Stage v-if=\"isEdit && flow\" :taskId=\"taskId\"/>\n\t\t</div>\n\t\t<BMenu v-if=\"isMenuShown\" :options=\"menuOptions\" @close=\"isMenuShown = false\"/>\n\t`,\n};\n","import { Outline } from 'ui.icon-set.api.core';\nimport 'ui.icon-set.outline';\n\nimport { Model } from 'tasks.v2.const';\nimport { Chip, ChipDesign } from 'tasks.v2.component.elements.chip';\nimport { fieldHighlighter } from 'tasks.v2.lib.field-highlighter';\nimport { taskService } from 'tasks.v2.provider.service.task-service';\nimport type { TaskModel } from 'tasks.v2.model.tasks';\nimport type { FlowModel } from 'tasks.v2.model.flows';\n\nimport { flowMeta } from './flow-meta';\nimport { flowDialog } from './flow-dialog';\n\n// @vue/component\nexport const FlowChip = {\n\tcomponents: {\n\t\tChip,\n\t},\n\tprops: {\n\t\ttaskId: {\n\t\t\ttype: [Number, String],\n\t\t\trequired: true,\n\t\t},\n\t\tisAutonomous: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t},\n\tsetup(): Object\n\t{\n\t\treturn {\n\t\t\tOutline,\n\t\t\tflowMeta,\n\t\t};\n\t},\n\tcomputed: {\n\t\ttask(): TaskModel\n\t\t{\n\t\t\treturn this.$store.getters[`${Model.Tasks}/getById`](this.taskId);\n\t\t},\n\t\tflow(): FlowModel\n\t\t{\n\t\t\treturn this.$store.getters[`${Model.Flows}/getById`](this.task.flowId);\n\t\t},\n\t\tdesign(): string\n\t\t{\n\t\t\treturn {\n\t\t\t\t[!this.isAutonomous && !this.isSelected]: ChipDesign.ShadowNoAccent,\n\t\t\t\t[!this.isAutonomous && this.isSelected]: ChipDesign.ShadowAccent,\n\t\t\t\t[this.isAutonomous && !this.isSelected]: ChipDesign.OutlineNoAccent,\n\t\t\t\t[this.isAutonomous && this.isSelected]: ChipDesign.OutlineAccent,\n\t\t\t}.true;\n\t\t},\n\t\tisSelected(): boolean\n\t\t{\n\t\t\tif (this.isAutonomous)\n\t\t\t{\n\t\t\t\treturn this.task.flowId > 0;\n\t\t\t}\n\n\t\t\treturn this.$store.getters[`${Model.Tasks}/wasFieldFilled`](this.taskId, flowMeta.id);\n\t\t},\n\t\tisFilled(): boolean\n\t\t{\n\t\t\treturn this.isAutonomous && this.task.flowId > 0;\n\t\t},\n\t\ttext(): string\n\t\t{\n\t\t\tif (this.isFilled)\n\t\t\t{\n\t\t\t\treturn this.flow.name;\n\t\t\t}\n\n\t\t\treturn this.loc('TASKS_V2_FLOW_TITLE_CHIP');\n\t\t},\n\t\treadonly(): boolean\n\t\t{\n\t\t\treturn !this.task.rights.edit;\n\t\t},\n\t},\n\tmethods: {\n\t\thandleClick(): void\n\t\t{\n\t\t\tif (!this.isAutonomous && this.isSelected)\n\t\t\t{\n\t\t\t\tthis.highlightField();\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tflowDialog.setTaskId(this.taskId).showTo(this.$el);\n\n\t\t\tif (!this.isAutonomous)\n\t\t\t{\n\t\t\t\tflowDialog.onUpdateOnce(this.highlightField);\n\t\t\t}\n\t\t},\n\t\thighlightField(): void\n\t\t{\n\t\t\tvoid fieldHighlighter.setContainer(this.$root.$el).highlight(flowMeta.id);\n\t\t},\n\t\thandleClear(): void\n\t\t{\n\t\t\tvoid taskService.update(\n\t\t\t\tthis.taskId,\n\t\t\t\t{\n\t\t\t\t\tflowId: 0,\n\t\t\t\t\tgroupId: 0,\n\t\t\t\t},\n\t\t\t);\n\t\t},\n\t},\n\t// TODO: remove title prop when flow popup added\n\ttemplate: `\n\t\t<Chip\n\t\t\tv-if=\"isSelected || !readonly\"\n\t\t\t:design=\"design\"\n\t\t\t:icon=\"Outline.BOTTLENECK\"\n\t\t\t:text=\"text\"\n\t\t\t:withClear=\"isFilled\"\n\t\t\t:trimmable=\"isFilled\"\n\t\t\t:data-task-id=\"taskId\"\n\t\t\t:data-task-chip-id=\"flowMeta.id\"\n\t\t\t:data-task-chip-value=\"task.flowId\"\n\t\t\t@click=\"handleClick\"\n\t\t\t@clear=\"handleClear\"\n\t\t\t:title=\"flow?.name ?? ''\"\n\t\t/>\n\t`,\n};\n"],"names":["flowMeta","Object","freeze","id","TaskField","Flow","title","Loc","getMessage","FlowDialog","setTaskId","taskId","showTo","targetNode","selectItemsByIds","onUpdateOnce","callback","onItemChangeDebounced","Runtime","debounce","dialog","EntitySelectorDialog","context","width","height","multiple","hideOnDeselect","enableSearch","entities","EntitySelectorEntity","options","onlyActive","preselectedItems","events","onHide","onDestroy","recentTabOptions","stub","EmptyStub","stubOptions","showArrow","Core","getParams","rights","flow","create","isFeatureTriable","Extension","getSettings","get","footer","Footer","setFooter","render","item","getSelectedItems","groupId","getCustomData","getId","name","getTitle","group","getStore","getters","Model","Groups","groupService","getGroup","flowId","Tasks","dispatch","Flows","creatorId","Interface","taskService","update","stageId","flowDialog","components","BIcon","BMenu","HoverPill","FieldAdd","Stage","props","type","Number","String","required","setup","Outline","data","isMenuShown","computed","mapGetters","currentUserId","task","$store","isEdit","isInteger","menuOptions","bindElement","$refs","container","offsetTop","items","loc","icon","BOTTLENECK","onClick","openFlow","EDIT_L","showDialog","design","MenuItemDesign","Alert","CROSS_L","clearField","targetContainer","document","body","readonly","edit","methods","handleClick","showMenu","handleClear","href","flowService","getUrl","SidePanel","Instance","open","template","FlowChip","Chip","isAutonomous","Boolean","default","isSelected","ChipDesign","ShadowNoAccent","ShadowAccent","OutlineNoAccent","OutlineAccent","true","isFilled","text","highlightField","$el","fieldHighlighter","setContainer","$root","highlight"],"mappings":";;;;;;;;OAGaA,QAAQ,GAAGC,MAAM,CAACC,MAAM,CAAC;GACrCC,EAAE,EAAEC,wBAAS,CAACC,IAAI;GAClBC,KAAK,EAAEC,aAAG,CAACC,UAAU,CAAC,qBAAqB;CAC5C,CAAC,CAAC;;CCCmE;CAAA;CAAA;CAAA;CAAA;CAAA;CAAA;CAAA;CAAA;CAAA;CAKrE,MAAMC,UAAU,CAChB;GAAA;KAAA;OAAA;;KAAA;OAAA;;KAAA;OAAA;OAAA;;KAAA;OAAA;OAAA;;KAAA;OAAA;;KAAA;OAAA;;KAAA;OAAA;OAAA;;KAAA;OAAA;OAAA;;KAAA;OAAA;OAAA,OAGkC;;KAAI;OAAA;OAAA,OAyHhB,MAAY;SAChC,4CAAI,kCAAiB,IAAI;;;;GAxH1BC,SAAS,CAACC,MAAuB,EACjC;KACC,4CAAI,sBAAWA,MAAM;KAErB,OAAO,IAAI;;GAGZC,MAAM,CAACC,UAAuB,EAC9B;KAAA;KACC,+FAAI,kIAAa,IAAI;KACrB,4CAAI,oBAASC,gBAAgB,yCAAC,IAAI,kBAAQ;KAC1C,4CAAI,oBAASF,MAAM,CAACC,UAAU,CAAC;;GAGhCE,YAAY,CAACC,QAAkB,EAC/B;KACC,4CAAI,kCAAiBA,QAAQ;;CA0G/B;CAAC,0BAtGA;GAAA;GACC,MAAMC,qBAAqB,GAAGC,iBAAO,CAACC,QAAQ,yCAAC,IAAI,iCAAgB,EAAE,EAAE,IAAI,CAAC;GAE5E,MAAMC,MAAM,GAAG,IAAIC,sDAAoB,CAAC;KACvCC,OAAO,EAAE,YAAY;KACrBC,KAAK,EAAE,GAAG;KACVC,MAAM,EAAE,GAAG;KACXC,QAAQ,EAAE,KAAK;KACfC,cAAc,EAAE,IAAI;KACpBC,YAAY,EAAE,IAAI;KAClBC,QAAQ,EAAE,CACT;OACCzB,EAAE,EAAE0B,mCAAoB,CAACxB,IAAI;OAC7ByB,OAAO,EAAE;SACRC,UAAU,EAAE;;MAEb,CACD;KACDC,gBAAgB,0CAAE,IAAI,iBAAO;KAC7BC,MAAM,EAAE;OACP,eAAe,EAAEhB,qBAAqB;OACtC,iBAAiB,EAAEA,qBAAqB;OACxCiB,MAAM,0CAAE,IAAI,yCAAmB;OAC/BC,SAAS,0CAAE,IAAI;MACf;KACDC,gBAAgB,EAAE;OACjBC,IAAI,EAAEC,mCAAS;OACfC,WAAW,EAAE;SACZC,SAAS,EAAE;;;IAGb,CAAC;GAEF,6BAAIC,kBAAI,CAACC,SAAS,EAAE,CAACC,MAAM,uCAAvB,sBAAyBC,IAAI,aAA7B,uBAA+BC,MAAM,EACzC;KACC,MAAMC,gBAAgB,GAAGC,mBAAS,CAACC,WAAW,CAAC,gCAAgC,CAAC,CAACC,GAAG,CAAC,kBAAkB,CAAC;KAExG,MAAMC,MAAM,GAAG,IAAIC,gCAAM,CAAC/B,MAAM,EAAE;OACjC0B;MACA,CAAC;KACF1B,MAAM,CAACgC,SAAS,CAACF,MAAM,CAACG,MAAM,EAAE,CAAC;;GAGlC,OAAOjC,MAAM;CACd;CAAC,gCAGD;GAAA;GACC,MAAMkC,IAAI,GAAG,4CAAI,oBAASC,gBAAgB,EAAE,CAAC,CAAC,CAAC;GAC/C,MAAMC,OAAO,GAAGF,IAAI,oBAAJA,IAAI,CAAEG,aAAa,EAAE,CAACR,GAAG,CAAC,SAAS,CAAC;GACpD,IAAIK,IAAI,EACR;KACC,4CAAI,4BAAa;OAChBnD,EAAE,EAAEmD,IAAI,CAACI,KAAK,EAAE;OAChBC,IAAI,EAAEL,IAAI,CAACM,QAAQ;MACnB;KAED,MAAMC,KAA6B,GAAGpB,kBAAI,CAACqB,QAAQ,EAAE,CAACC,OAAO,CAAE,GAAEC,oBAAK,CAACC,MAAO,UAAS,CAAC,CAACT,OAAO,CAAC;KACjG,IAAI,CAACK,KAAK,EACV;OACC,MAAMK,mDAAY,CAACC,QAAQ,CAACX,OAAO,CAAC;;;GAItC,4CAAI,2CAAaF,IAAI,oBAAJA,IAAI,CAAEI,KAAK,EAAE,0BAAI,CAAC,EAAEF,OAAO,WAAPA,OAAO,GAAI,CAAC;CAClD;CAAC,sBAGD;GACC,OAAO,CAAC,CAAC3B,mCAAoB,CAACxB,IAAI,EAAE,4CAAI,gBAAO+D,MAAM,CAAC,CAAC;CACxD;CAAC,qBAGD;GACC,OAAO3B,kBAAI,CAACqB,QAAQ,EAAE,CAACC,OAAO,CAAE,GAAEC,oBAAK,CAACK,KAAM,UAAS,CAAC,yCAAC,IAAI,oBAAS;CACvE;CAAC,sBAEWzB,IAAe,EAC3B;GACC,KAAKH,kBAAI,CAACqB,QAAQ,EAAE,CAACQ,QAAQ,CAAE,GAAEN,oBAAK,CAACO,KAAM,SAAQ,EAAE3B,IAAI,CAAC;CAC7D;CAAC,sBAEWwB,MAAc,EAAEZ,OAAe,EAC3C;GAAA;GACC,MAAMgB,SAAS,GAAG/B,kBAAI,CAACqB,QAAQ,EAAE,CAACC,OAAO,CAAE,GAAEC,oBAAK,CAACS,SAAU,gBAAe,CAAC;GAC7E,KAAKC,iDAAW,CAACC,MAAM,yCACtB,IAAI,qBACJ;KACCH,SAAS;KACTJ,MAAM;KACNZ,OAAO;KACPoB,OAAO,EAAE;IACT,CACD;GAED,gGAAI;GACJ,4CAAI;CACL;AAOD,CAAO,MAAMC,UAAU,GAAG,IAAIpE,UAAU,EAAE;;CC3H1C;AACA,OAAaJ,IAAI,GAAG;GACnBsD,IAAI,EAAE,UAAU;GAChBmB,UAAU,EAAE;YACXC,wBAAK;YACLC,6BAAK;gBACLC,+CAAS;eACTC,6CAAQ;YACRC;IACA;GACDC,KAAK,EAAE;KACNzE,MAAM,EAAE;OACP0E,IAAI,EAAE,CAACC,MAAM,EAAEC,MAAM,CAAC;OACtBC,QAAQ,EAAE;;IAEX;GACDC,KAAK,GACL;KACC,OAAO;OACNzF,QAAQ;gBACR0F;MACA;IACD;GACDC,IAAI,GACJ;KACC,OAAO;OACNC,WAAW,EAAE;MACb;IACD;GACDC,QAAQ,EAAE;KACT,GAAGC,uBAAU,CAAC;OACbC,aAAa,EAAG,GAAE/B,oBAAK,CAACS,SAAU;MAClC,CAAC;KACFuB,IAAI,GACJ;OACC,OAAO,IAAI,CAACC,MAAM,CAAClC,OAAO,CAAE,GAAEC,oBAAK,CAACK,KAAM,UAAS,CAAC,CAAC,IAAI,CAAC1D,MAAM,CAAC;MACjE;KACDiC,IAAI,GACJ;OACC,OAAO,IAAI,CAACqD,MAAM,CAAClC,OAAO,CAAE,GAAEC,oBAAK,CAACO,KAAM,UAAS,CAAC,CAAC,IAAI,CAACyB,IAAI,CAAC5B,MAAM,CAAC;MACtE;KACD8B,MAAM,GACN;OACC,OAAOZ,MAAM,CAACa,SAAS,CAAC,IAAI,CAACxF,MAAM,CAAC,IAAI,IAAI,CAACA,MAAM,GAAG,CAAC;MACvD;KACDyF,WAAW,GACX;OACC,OAAO;SACNjG,EAAE,EAAE,uBAAuB;SAC3BkG,WAAW,EAAE,IAAI,CAACC,KAAK,CAACC,SAAS;SACjCC,SAAS,EAAE,CAAC;SACZC,KAAK,EAAE,CACN;WACCnG,KAAK,EAAE,IAAI,CAACoG,GAAG,CAAC,qBAAqB,CAAC;WACtCC,IAAI,EAAEjB,0BAAO,CAACkB,UAAU;WACxBC,OAAO,EAAE,IAAI,CAACC;UACd,EACD;WACCxG,KAAK,EAAE,IAAI,CAACoG,GAAG,CAAC,sBAAsB,CAAC;WACvCC,IAAI,EAAEjB,0BAAO,CAACqB,MAAM;WACpBF,OAAO,EAAE,IAAI,CAACG;UACd,EACD;WACCC,MAAM,EAAEC,sCAAc,CAACC,KAAK;WAC5B7G,KAAK,EAAE,IAAI,CAACoG,GAAG,CAAC,sBAAsB,CAAC;WACvCC,IAAI,EAAEjB,0BAAO,CAAC0B,OAAO;WACrBP,OAAO,EAAE,IAAI,CAACQ;UACd,CACD;SACDC,eAAe,EAAEC,QAAQ,CAACC;QAC1B;MACD;KACDC,QAAQ,GACR;OACC,OAAO,CAAC,IAAI,CAACzB,IAAI,CAACrD,MAAM,CAAC+E,IAAI;;IAE9B;GACDC,OAAO,EAAE;KACRC,WAAW,GACX;OACC,IAAI,IAAI,CAAChF,IAAI,IAAI,IAAI,CAAC6E,QAAQ,EAC9B;SACC,IAAI,CAACX,QAAQ,EAAE;SAEf;;OAGD,IAAI,IAAI,CAACZ,MAAM,IAAI,IAAI,CAACtD,IAAI,EAC5B;SACC,IAAI,CAACiF,QAAQ,EAAE;QACf,MAED;SACC,IAAI,CAACb,UAAU,EAAE;;MAElB;KACDa,QAAQ,GACR;OACC,IAAI,CAACjC,WAAW,GAAG,IAAI;MACvB;KACDkC,WAAW,GACX;OACC,IAAI,CAACT,UAAU,EAAE;MACjB;KACDP,QAAQ,GACR;OACC,MAAMiB,IAAI,GAAGC,iDAAW,CAACC,MAAM,CAAC,IAAI,CAACrF,IAAI,CAACzC,EAAE,EAAE,IAAI,CAAC4F,aAAa,CAAC;OAEjEmC,wBAAS,CAACC,QAAQ,CAACC,IAAI,CAACL,IAAI,CAAC;MAC7B;KACDV,UAAU,GACV;OACC,KAAK3C,iDAAW,CAACC,MAAM,CACtB,IAAI,CAAChE,MAAM,EACX;SACCyD,MAAM,EAAE,CAAC;SACTZ,OAAO,EAAE,CAAC;SACVoB,OAAO,EAAE;QACT,CACD;MACD;KACDoC,UAAU,GACV;OACCnC,UAAU,CAACnE,SAAS,CAAC,IAAI,CAACC,MAAM,CAAC,CAACC,MAAM,CAAC,IAAI,CAAC0F,KAAK,CAACC,SAAS,CAAC;;IAE/D;GACD8B,QAAQ,EAAG;;;;;;;;;;;;;;;;;;;;;;CAsBZ,CAAC;;CC1JD;AACA,OAAaC,QAAQ,GAAG;GACvBxD,UAAU,EAAE;WACXyD;IACA;GACDnD,KAAK,EAAE;KACNzE,MAAM,EAAE;OACP0E,IAAI,EAAE,CAACC,MAAM,EAAEC,MAAM,CAAC;OACtBC,QAAQ,EAAE;MACV;KACDgD,YAAY,EAAE;OACbnD,IAAI,EAAEoD,OAAO;OACbC,OAAO,EAAE;;IAEV;GACDjD,KAAK,GACL;KACC,OAAO;gBACNC,2BAAO;OACP1F;MACA;IACD;GACD6F,QAAQ,EAAE;KACTG,IAAI,GACJ;OACC,OAAO,IAAI,CAACC,MAAM,CAAClC,OAAO,CAAE,GAAEC,oBAAK,CAACK,KAAM,UAAS,CAAC,CAAC,IAAI,CAAC1D,MAAM,CAAC;MACjE;KACDiC,IAAI,GACJ;OACC,OAAO,IAAI,CAACqD,MAAM,CAAClC,OAAO,CAAE,GAAEC,oBAAK,CAACO,KAAM,UAAS,CAAC,CAAC,IAAI,CAACyB,IAAI,CAAC5B,MAAM,CAAC;MACtE;KACD6C,MAAM,GACN;OACC,OAAO;SACN,CAAC,CAAC,IAAI,CAACuB,YAAY,IAAI,CAAC,IAAI,CAACG,UAAU,GAAGC,2CAAU,CAACC,cAAc;SACnE,CAAC,CAAC,IAAI,CAACL,YAAY,IAAI,IAAI,CAACG,UAAU,GAAGC,2CAAU,CAACE,YAAY;SAChE,CAAC,IAAI,CAACN,YAAY,IAAI,CAAC,IAAI,CAACG,UAAU,GAAGC,2CAAU,CAACG,eAAe;SACnE,CAAC,IAAI,CAACP,YAAY,IAAI,IAAI,CAACG,UAAU,GAAGC,2CAAU,CAACI;QACnD,CAACC,IAAI;MACN;KACDN,UAAU,GACV;OACC,IAAI,IAAI,CAACH,YAAY,EACrB;SACC,OAAO,IAAI,CAACxC,IAAI,CAAC5B,MAAM,GAAG,CAAC;;OAG5B,OAAO,IAAI,CAAC6B,MAAM,CAAClC,OAAO,CAAE,GAAEC,oBAAK,CAACK,KAAM,iBAAgB,CAAC,CAAC,IAAI,CAAC1D,MAAM,EAAEX,QAAQ,CAACG,EAAE,CAAC;MACrF;KACD+I,QAAQ,GACR;OACC,OAAO,IAAI,CAACV,YAAY,IAAI,IAAI,CAACxC,IAAI,CAAC5B,MAAM,GAAG,CAAC;MAChD;KACD+E,IAAI,GACJ;OACC,IAAI,IAAI,CAACD,QAAQ,EACjB;SACC,OAAO,IAAI,CAACtG,IAAI,CAACe,IAAI;;OAGtB,OAAO,IAAI,CAAC+C,GAAG,CAAC,0BAA0B,CAAC;MAC3C;KACDe,QAAQ,GACR;OACC,OAAO,CAAC,IAAI,CAACzB,IAAI,CAACrD,MAAM,CAAC+E,IAAI;;IAE9B;GACDC,OAAO,EAAE;KACRC,WAAW,GACX;OACC,IAAI,CAAC,IAAI,CAACY,YAAY,IAAI,IAAI,CAACG,UAAU,EACzC;SACC,IAAI,CAACS,cAAc,EAAE;SAErB;;OAGDvE,UAAU,CAACnE,SAAS,CAAC,IAAI,CAACC,MAAM,CAAC,CAACC,MAAM,CAAC,IAAI,CAACyI,GAAG,CAAC;OAElD,IAAI,CAAC,IAAI,CAACb,YAAY,EACtB;SACC3D,UAAU,CAAC9D,YAAY,CAAC,IAAI,CAACqI,cAAc,CAAC;;MAE7C;KACDA,cAAc,GACd;OACC,KAAKE,8CAAgB,CAACC,YAAY,CAAC,IAAI,CAACC,KAAK,CAACH,GAAG,CAAC,CAACI,SAAS,CAACzJ,QAAQ,CAACG,EAAE,CAAC;MACzE;KACD2H,WAAW,GACX;OACC,KAAKpD,iDAAW,CAACC,MAAM,CACtB,IAAI,CAAChE,MAAM,EACX;SACCyD,MAAM,EAAE,CAAC;SACTZ,OAAO,EAAE;QACT,CACD;;IAEF;;GAED6E,QAAQ,EAAG;;;;;;;;;;;;;;;;CAgBZ,CAAC;;;;;;;;;;"}