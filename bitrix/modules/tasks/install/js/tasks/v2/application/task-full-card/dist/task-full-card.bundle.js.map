{"version":3,"file":"task-full-card.bundle.js","sources":["../src/component/task-header/burger-menu/burger-menu.js","../src/component/task-header/task-header.js","../src/component/chat/chat.js","../src/component/chips/chips.js","../src/component/footer-create/footer-create.js","../src/component/footer-edit/more/more.js","../src/component/footer-edit/footer-edit.js","../src/component/app.js","../src/task-full-card.js"],"sourcesContent":["import { Tag, Loc } from 'main.core';\nimport { mapGetters } from 'ui.vue3.vuex';\nimport { AirButtonStyle, ButtonSize } from 'ui.vue3.components.button';\nimport { BMenu, type MenuOptions, type MenuItemOptions } from 'ui.vue3.components.menu';\nimport { BIcon, Outline } from 'ui.icon-set.api.vue';\nimport 'ui.icon-set.outline';\nimport 'ui.icon-set.main';\nimport { Model } from 'tasks.v2.const';\nimport { Core } from 'tasks.v2.core';\nimport { taskService } from 'tasks.v2.provider.service.task-service';\nimport { TaskCard } from 'tasks.v2.application.task-card';\nimport type { TaskModel } from 'tasks.v2.model.tasks';\n\nimport './burger-menu.css';\n\n\nconst MENU_SECTION_PERSONAL = 'MENU_SECTION_PERSONAL';\nconst MENU_SECTION_TASKS = 'MENU_SECTION_TASKS';\nconst MENU_SECTION_COPY = 'MENU_SECTION_COPY';\nconst MENU_SECTION_LINKS = 'MENU_SECTION_LINKS';\n\n// @vue/component\nexport const BurgerMenu = {\n\tname: 'TaskFullCardBurgerMenu',\n\tcomponents: {\n\t\tBIcon,\n\t\tBMenu,\n\t},\n\tprops: {\n\t\ttaskId: {\n\t\t\ttype: [Number, String],\n\t\t\trequired: true,\n\t\t},\n\t},\n\tsetup(): Object\n\t{\n\t\treturn {\n\t\t\tOutline,\n\t\t\tuserRights: Core.getParams().rights,\n\t\t};\n\t},\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tisMenuShown: false,\n\t\t};\n\t},\n\tcomputed: {\n\t\t...mapGetters({\n\t\t\tcurrentUserId: `${Model.Interface}/currentUserId`,\n\t\t}),\n\t\ttask(): TaskModel\n\t\t{\n\t\t\treturn this.$store.getters[`${Model.Tasks}/getById`](this.taskId);\n\t\t},\n\t\tmenuOptions(): Function\n\t\t{\n\t\t\treturn (): MenuOptions => ({\n\t\t\t\tid: 'tasks-full-card-header-burger-menu',\n\t\t\t\tbindElement: this.$refs.button.$el,\n\t\t\t\tsections: [\n\t\t\t\t\t{\n\t\t\t\t\t\tcode: MENU_SECTION_PERSONAL,\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tcode: MENU_SECTION_TASKS,\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tcode: MENU_SECTION_COPY,\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tcode: MENU_SECTION_LINKS,\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t\titems: this.menuItems,\n\t\t\t});\n\t\t},\n\t\tmenuItems(): MenuItemOptions[]\n\t\t{\n\t\t\tconst actionsMenuItems = [];\n\n\t\t\tif (this.task.rights.favorite)\n\t\t\t{\n\t\t\t\tactionsMenuItems.push(this.getToggleFavoriteItem());\n\t\t\t}\n\n\t\t\tif (this.task.rights.watch)\n\t\t\t{\n\t\t\t\tactionsMenuItems.push(this.getBecomeAuditorItem());\n\t\t\t}\n\n\t\t\tif (this.task.rights.mute)\n\t\t\t{\n\t\t\t\tactionsMenuItems.push(this.getToggleMuteItem());\n\t\t\t}\n\n\t\t\tif (this.userRights.tasks.create)\n\t\t\t{\n\t\t\t\tactionsMenuItems.push(this.getCreateNewTaskItem());\n\t\t\t}\n\n\t\t\tif (this.task.rights.createSubtask)\n\t\t\t{\n\t\t\t\tactionsMenuItems.push(this.getCreateSubtaskItem());\n\t\t\t}\n\n\t\t\tif (this.task.rights.copy)\n\t\t\t{\n\t\t\t\tactionsMenuItems.push(this.getCreateDuplicateTaskItem());\n\t\t\t}\n\n\t\t\tif (this.userRights.tasks.createFromTemplate)\n\t\t\t{\n\t\t\t\tactionsMenuItems.push(this.getCreateNewTaskWithTemplateItem());\n\t\t\t}\n\n\t\t\tif (this.task.rights.saveAsTemplate)\n\t\t\t{\n\t\t\t\tactionsMenuItems.push(this.getCreateTemplateFromTaskItem());\n\t\t\t}\n\n\t\t\tactionsMenuItems.push(\n\t\t\t\tthis.getCopyTaskIdItem(),\n\t\t\t\tthis.getGoToBitrixMarketItem(),\n\t\t\t);\n\n\t\t\tif (this.userRights.tasks.robot)\n\t\t\t{\n\t\t\t\tactionsMenuItems.push(this.getGoToRobotsItem());\n\t\t\t}\n\n\t\t\treturn actionsMenuItems;\n\t\t},\n\t},\n\tmethods: {\n\t\tgetNotificationLayoutWithTitle({ title, text }): Node\n\t\t{\n\t\t\treturn Tag.render`\n\t\t\t\t<div>\n\t\t\t\t\t<p style=\"margin: 0\">${title}</p>\n\t\t\t\t\t<p style=\"margin: 5px 0 0 0; font-size: 12px\">${text}</p>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t},\n\n\t\t// handlers\n\t\thandleClickOpener(): void\n\t\t{\n\t\t\tthis.isMenuShown = true;\n\t\t},\n\t\t// handlers end\n\n\t\t// button getters\n\t\tgetToggleFavoriteItem(): MenuItemOptions\n\t\t{\n\t\t\tconst isTurningOn = !this.task.inFavorite.includes(this.currentUserId);\n\n\t\t\treturn {\n\t\t\t\tsectionCode: MENU_SECTION_PERSONAL,\n\t\t\t\ttitle: isTurningOn\n\t\t\t\t\t? this.loc('TASKS_V2_TASK_FULL_CARD_FAVOR_ACTION')\n\t\t\t\t\t: this.loc('TASKS_V2_TASK_FULL_CARD_UNFAVOR_ACTION'),\n\t\t\t\ticon: isTurningOn ? Outline.FAVORITE : Outline.NON_FAVORITE,\n\t\t\t\tonClick: async (): void => {\n\t\t\t\t\tif (isTurningOn)\n\t\t\t\t\t{\n\t\t\t\t\t\tconst isSuccess = await taskService.addFavorite(this.task, this.currentUserId);\n\t\t\t\t\t\tBX.UI.Notification.Center.notify({\n\t\t\t\t\t\t\tcontent: isSuccess\n\t\t\t\t\t\t\t\t? this.loc('TASKS_V2_TASK_FULL_CARD_FAVOR_NOTIF_SUCC')\n\t\t\t\t\t\t\t\t: this.loc('TASKS_V2_TASK_FULL_CARD_FAVOR_NOTIF_FAIL'),\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tconst isSuccess = await taskService.removeFavorite(this.task, this.currentUserId);\n\t\t\t\t\t\tBX.UI.Notification.Center.notify({\n\t\t\t\t\t\t\tcontent: isSuccess\n\t\t\t\t\t\t\t\t? this.loc('TASKS_V2_TASK_FULL_CARD_UNFAVOR_NOTIF_SUCC')\n\t\t\t\t\t\t\t\t: this.loc('TASKS_V2_TASK_FULL_CARD_UNFAVOR_NOTIF_FAIL'),\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t};\n\t\t},\n\t\tgetBecomeAuditorItem(): MenuItemOptions\n\t\t{\n\t\t\tconst auditorsIdsCurrent = this.task.auditorsIds;\n\t\t\tconst isBecomingAuditor = !auditorsIdsCurrent.includes(this.currentUserId);\n\n\t\t\treturn {\n\t\t\t\tsectionCode: MENU_SECTION_PERSONAL,\n\t\t\t\ttitle: isBecomingAuditor\n\t\t\t\t\t? this.loc('TASKS_V2_TASK_FULL_CARD_BECOME_AUDITOR_ACTION')\n\t\t\t\t\t: this.loc('TASKS_V2_TASK_FULL_CARD_STOP_BEING_AUDITOR_ACTION'),\n\t\t\t\ticon: isBecomingAuditor\n\t\t\t\t\t? Outline.OBSERVER\n\t\t\t\t\t: Outline.CROSSED_EYE,\n\t\t\t\tonClick: async (): void => {\n\t\t\t\t\tif (isBecomingAuditor)\n\t\t\t\t\t{\n\t\t\t\t\t\tconst isSuccess = await taskService.setAuditors(\n\t\t\t\t\t\t\tthis.task.id,\n\t\t\t\t\t\t\t[...auditorsIdsCurrent, this.currentUserId],\n\t\t\t\t\t\t);\n\t\t\t\t\t\tBX.UI.Notification.Center.notify({\n\t\t\t\t\t\t\tcontent: isSuccess\n\t\t\t\t\t\t\t\t? this.loc('TASKS_V2_TASK_FULL_CARD_BECOME_AUDITOR_NOTIF_SUCC')\n\t\t\t\t\t\t\t\t: this.loc('TASKS_V2_TASK_FULL_CARD_BECOME_AUDITOR_NOTIF_FAIL'),\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tconst isSuccess = await taskService.setAuditors(\n\t\t\t\t\t\t\tthis.task.id,\n\t\t\t\t\t\t\tauditorsIdsCurrent.filter(auditorId => auditorId !== this.currentUserId),\n\t\t\t\t\t\t);\n\t\t\t\t\t\tBX.UI.Notification.Center.notify({\n\t\t\t\t\t\t\tcontent: isSuccess\n\t\t\t\t\t\t\t\t? this.loc('TASKS_V2_TASK_FULL_CARD_STOP_BEING_AUDITOR_NOTIF_SUCC')\n\t\t\t\t\t\t\t\t: this.loc('TASKS_V2_TASK_FULL_CARD_STOP_BEING_AUDITOR_NOTIF_FAIL'),\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t};\n\t\t},\n\t\tgetToggleMuteItem(): MenuItemOptions\n\t\t{\n\t\t\tconst isMuting = !this.task.inMute.includes(this.currentUserId);\n\n\t\t\treturn {\n\t\t\t\tsectionCode: MENU_SECTION_PERSONAL,\n\t\t\t\ttitle: isMuting\n\t\t\t\t\t? this.loc('TASKS_V2_TASK_FULL_CARD_MUTE_ACTION')\n\t\t\t\t\t: this.loc('TASKS_V2_TASK_FULL_CARD_UNMUTE_ACTION'),\n\t\t\t\ticon: isMuting ? Outline.SOUND_OFF : Outline.SOUND_ON,\n\t\t\t\tonClick: async (): void => {\n\t\t\t\t\tif (isMuting)\n\t\t\t\t\t{\n\t\t\t\t\t\tconst isSuccess = await taskService.muteTask(this.task, this.currentUserId);\n\t\t\t\t\t\tBX.UI.Notification.Center.notify({\n\t\t\t\t\t\t\tcontent: isSuccess\n\t\t\t\t\t\t\t\t? this.getNotificationLayoutWithTitle({\n\t\t\t\t\t\t\t\t\ttitle: this.loc('TASKS_V2_TASK_FULL_CARD_MUTE_NOTIF_SUCC_TITLE'),\n\t\t\t\t\t\t\t\t\ttext: this.loc('TASKS_V2_TASK_FULL_CARD_MUTE_NOTIF_SUCC_DESCR'),\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t: this.loc('TASKS_V2_TASK_FULL_CARD_MUTE_NOTIF_FAIL'),\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tconst isSuccess = await taskService.unmuteTask(this.task, this.currentUserId);\n\t\t\t\t\t\tBX.UI.Notification.Center.notify({\n\t\t\t\t\t\t\tcontent: isSuccess\n\t\t\t\t\t\t\t\t? this.getNotificationLayoutWithTitle({\n\t\t\t\t\t\t\t\t\ttitle: this.loc('TASKS_V2_TASK_FULL_CARD_UNMUTE_NOTIF_SUCC_TITLE'),\n\t\t\t\t\t\t\t\t\ttext: this.loc('TASKS_V2_TASK_FULL_CARD_UNMUTE_NOTIF_SUCC_DESCR'),\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t: this.loc('TASKS_V2_TASK_FULL_CARD_UNMUTE_NOTIF_FAIL'),\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t};\n\t\t},\n\t\tgetCreateNewTaskItem(): MenuItemOptions\n\t\t{\n\t\t\treturn {\n\t\t\t\tsectionCode: MENU_SECTION_TASKS,\n\t\t\t\ttitle: this.loc('TASKS_V2_TASK_FULL_CARD_CREATE_STANDALONE_TASK'),\n\t\t\t\ticon: Outline.TASK,\n\t\t\t\tonClick: async (): void => {\n\t\t\t\t\tTaskCard.showCompactCard({});\n\t\t\t\t},\n\t\t\t};\n\t\t},\n\t\tgetCreateSubtaskItem(): MenuItemOptions\n\t\t{\n\t\t\treturn {\n\t\t\t\tsectionCode: MENU_SECTION_TASKS,\n\t\t\t\ttitle: this.loc('TASKS_V2_TASK_FULL_CARD_CREATE_SUBTASK'),\n\t\t\t\t// icon: Outline.SUBTASK,\n\t\t\t\ticon: Outline.RELATED_TASKS,\n\t\t\t\tonClick: async (): void => {\n\t\t\t\t\tTaskCard.showCompactCard({ parentId: this.taskId });\n\t\t\t\t},\n\t\t\t};\n\t\t},\n\t\tgetCreateDuplicateTaskItem(): MenuItemOptions\n\t\t{\n\t\t\treturn {\n\t\t\t\tsectionCode: MENU_SECTION_TASKS,\n\t\t\t\ttitle: this.loc('TASKS_V2_TASK_FULL_CARD_CREATE_DUPLICATE_TASK'),\n\t\t\t\ticon: Outline.DUPLICATE,\n\t\t\t\tonClick: async (): void => {\n\t\t\t\t\tTaskCard.showCompactCard({});\n\t\t\t\t},\n\t\t\t};\n\t\t},\n\t\tgetCreateNewTaskWithTemplateItem(): MenuItemOptions\n\t\t{\n\t\t\treturn {\n\t\t\t\tsectionCode: MENU_SECTION_TASKS,\n\t\t\t\ttitle: this.loc('TASKS_V2_TASK_FULL_CARD_CREATE_STANDALONE_TASK_WITH_TEMPLATE'),\n\t\t\t\ticon: Outline.CHEVRON_RIGHT_L,\n\t\t\t\tonClick: async (): void => {\n\t\t\t\t\tTaskCard.showCompactCard({});\n\t\t\t\t},\n\t\t\t};\n\t\t},\n\t\tgetCreateTemplateFromTaskItem(): MenuItemOptions\n\t\t{\n\t\t\treturn {\n\t\t\t\tsectionCode: MENU_SECTION_TASKS,\n\t\t\t\ttitle: this.loc('TASKS_V2_TASK_FULL_CARD_CREATE_TEMPLATE_FROM_TASK'),\n\t\t\t\ticon: Outline.TEMPLATE_TASK,\n\t\t\t\tonClick: async (): void => {\n\t\t\t\t\tTaskCard.showCompactCard({});\n\t\t\t\t},\n\t\t\t};\n\t\t},\n\t\tgetCopyTaskIdItem(): MenuItemOptions\n\t\t{\n\t\t\treturn {\n\t\t\t\tsectionCode: MENU_SECTION_COPY,\n\t\t\t\ttitle: this.loc('TASKS_V2_TASK_FULL_CARD_COPY_TASK_ID_ACTION'),\n\t\t\t\ticon: Outline.COPY,\n\t\t\t\tonClick: async (): void => {\n\t\t\t\t\tconst isCopyingSuccess = BX.clipboard.copy(this.taskId);\n\t\t\t\t\tif (isCopyingSuccess)\n\t\t\t\t\t{\n\t\t\t\t\t\tBX.UI.Notification.Center.notify({\n\t\t\t\t\t\t\tcontent: this.loc('TASKS_V2_TASK_FULL_CARD_COPY_TASK_ID_NOTIF'),\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t};\n\t\t},\n\t\tgetGoToBitrixMarketItem(): MenuItemOptions\n\t\t{\n\t\t\treturn {\n\t\t\t\tsectionCode: MENU_SECTION_LINKS,\n\t\t\t\tuiButtonOptions: {\n\t\t\t\t\ticon: Outline.MARKET,\n\t\t\t\t\ttext: this.loc('TASKS_V2_TASK_FULL_CARD_GO_TO_BITRIX_MARKET'),\n\t\t\t\t\tsize: ButtonSize.SMALL,\n\t\t\t\t\tuseAirDesign: true,\n\t\t\t\t\tstyle: AirButtonStyle.OUTLINE,\n\t\t\t\t\twide: true,\n\t\t\t\t\tdisabled: false,\n\t\t\t\t\tonclick: async (): void => {\n\t\t\t\t\t\tBX.rest.Marketplace.open({ PLACEMENT: 'TASK_LIST_CONTEXT_MENU' });\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t};\n\t\t},\n\t\tgetGoToRobotsItem(): MenuItemOptions\n\t\t{\n\t\t\treturn {\n\t\t\t\tsectionCode: MENU_SECTION_LINKS,\n\t\t\t\tuiButtonOptions: {\n\t\t\t\t\ticon: Outline.ROBOT,\n\t\t\t\t\ttext: this.loc('TASKS_V2_TASK_FULL_CARD_GO_TO_ROBOTS'),\n\t\t\t\t\tsize: ButtonSize.SMALL,\n\t\t\t\t\tuseAirDesign: true,\n\t\t\t\t\tstyle: AirButtonStyle.OUTLINE,\n\t\t\t\t\twide: true,\n\t\t\t\t\tdisabled: false,\n\t\t\t\t\tonclick: (): void => {\n\t\t\t\t\t\tBX.SidePanel.Instance.open(\n\t\t\t\t\t\t\t`/bitrix/components/bitrix/tasks.automation/slider.php?site_id=${\n\t\t\t\t\t\t\t\tLoc.getMessage('SITE_ID')\n\t\t\t\t\t\t\t}&project_id=${this.task.groupId}&task_id=${this.taskId}`,\n\t\t\t\t\t\t\t{ cacheable: false, customLeftBoundary: 0, loader: 'bizproc:automation-loader' },\n\t\t\t\t\t\t);\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t};\n\t\t},\n\t\t// button getters end\n\t},\n\ttemplate: `\n\t\t<div\n\t\t\tv-if=\"menuItems\"\n\t\t\tclass=\"tasks-full-card-header-burger-container\"\n\t\t\t@click=\"handleClickOpener\"\n\t\t>\n\t\t\t<BIcon\n\t\t\t\tclass=\"tasks-full-card-header-burger\"\n\t\t\t\tref=\"button\"\n\t\t\t\t:name=\"Outline.MORE_L\"\n\t\t\t/>\n\t\t</div>\n\t\t<BMenu v-if=\"isMenuShown\" :options=\"menuOptions()\" @close=\"isMenuShown = false\"/>\n\t`,\n};\n","import { Type } from 'main.core';\nimport 'im.v2.application.integration.task';\n\nimport { Title as TitleField } from 'tasks.v2.component.fields.title';\nimport { Importance } from 'tasks.v2.component.fields.importance';\n\nimport { BurgerMenu } from './burger-menu/burger-menu';\nimport './task-header.css';\n\n// @vue/component\nexport const TaskHeader = {\n\tname: 'TaskFullCardHeader',\n\tcomponents: {\n\t\tTitleField,\n\t\tImportance,\n\t\tBurgerMenu,\n\t},\n\tprops: {\n\t\ttaskId: {\n\t\t\ttype: [Number, String],\n\t\t\trequired: true,\n\t\t},\n\t},\n\tcomputed: {\n\t\tisEdit(): boolean\n\t\t{\n\t\t\treturn Type.isNumber(this.taskId) && this.taskId > 0;\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"tasks-full-card-header\">\n\t\t\t<TitleField :taskId />\n\t\t\t<Importance :taskId />\n\t\t\t<BurgerMenu v-if=\"isEdit\" :taskId/>\n\t\t</div>\n\t`,\n};\n","import { EventEmitter } from 'main.core.events';\nimport { Messenger } from 'im.public';\nimport 'im.v2.application.integration.task';\n\nimport { Core } from 'tasks.v2.core';\nimport { Model } from 'tasks.v2.const';\nimport type { TaskModel } from 'tasks.v2.model.tasks';\n\nimport './chat.css';\n\n// @vue/component\nexport const Chat = {\n\tname: 'TaskFullCardChat',\n\tprops: {\n\t\ttaskId: {\n\t\t\ttype: [Number, String],\n\t\t\trequired: true,\n\t\t},\n\t},\n\tcomputed: {\n\t\ttask(): TaskModel\n\t\t{\n\t\t\treturn this.$store.getters[`${Model.Tasks}/getById`](this.taskId);\n\t\t},\n\t\tisEdit(): boolean\n\t\t{\n\t\t\treturn Number.isInteger(this.taskId) && this.taskId > 0;\n\t\t},\n\t},\n\twatch: {\n\t\ttaskId(): void\n\t\t{\n\t\t\tvoid this.openChat();\n\t\t},\n\t},\n\tmounted(): void\n\t{\n\t\tvoid this.openChat();\n\t},\n\tmethods: {\n\t\tasync openChat(): Promise<void>\n\t\t{\n\t\t\tthis.app?.bitrixVue.unmount();\n\t\t\tthis.app ??= await Messenger.initApplication('task');\n\n\t\t\tif (this.isEdit)\n\t\t\t{\n\t\t\t\tvoid this.app.mount({\n\t\t\t\t\trootContainer: this.$el,\n\t\t\t\t\tchatId: this.task.chatId,\n\t\t\t\t\ttaskId: this.taskId,\n\t\t\t\t\ttype: Core.getParams().chatType,\n\t\t\t\t});\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tawait this.app.mountPlaceholder({\n\t\t\t\t\trootContainer: this.$el,\n\t\t\t\t\ttaskId: `'${this.taskId}'`,\n\t\t\t\t});\n\n\t\t\t\tEventEmitter.emit('tasks:card:onMembersCountChange', {\n\t\t\t\t\ttaskId: this.taskId,\n\t\t\t\t\tuserCounter: 1,\n\t\t\t\t});\n\t\t\t}\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"tasks-full-card-chat\"></div>\n\t`,\n};\n","import { Chip, ChipDesign } from 'ui.system.chip.vue';\nimport { Outline } from 'ui.icon-set.api.vue';\nimport 'ui.icon-set.outline';\n\nimport { heightTransition } from 'tasks.v2.lib.height-transition';\nimport './chips.css';\n\n// @vue/component\nexport const Chips = {\n\tcomponents: {\n\t\tChip,\n\t},\n\tprops: {\n\t\ttaskId: {\n\t\t\ttype: [Number, String],\n\t\t\trequired: true,\n\t\t},\n\t\tchips: {\n\t\t\ttype: Array,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tsetup(): Object\n\t{\n\t\treturn {\n\t\t\tOutline,\n\t\t\tChipDesign,\n\t\t};\n\t},\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tchipsCollapsed: true,\n\t\t};\n\t},\n\tmounted(): void\n\t{\n\t\theightTransition.animate(this.$el);\n\t},\n\tupdated(): void\n\t{\n\t\theightTransition.animate(this.$el);\n\t},\n\ttemplate: `\n\t\t<div class=\"tasks-full-card-chips\">\n\t\t\t<template v-for=\"(chip, index) of chips\" :key=\"index\">\n\t\t\t\t<component\n\t\t\t\t\tv-if=\"!chip.collapsed || !chipsCollapsed\"\n\t\t\t\t\t:is=\"chip.component ?? chip\"\n\t\t\t\t\tv-bind=\"{ taskId }\"\n\t\t\t\t\tv-on=\"chip.events ?? {}\"\n\t\t\t\t/>\n\t\t\t</template>\n\t\t\t<Chip\n\t\t\t\t:design=\"ChipDesign.ShadowNoAccent\"\n\t\t\t\t:icon=\"chipsCollapsed ? Outline.APPS : Outline.CHEVRON_TOP_L\"\n\t\t\t\t:text=\"chipsCollapsed ? loc('TASKS_V2_TASK_FULL_CARD_MORE') : ''\"\n\t\t\t\t@click=\"chipsCollapsed = !chipsCollapsed\"\n\t\t\t/>\n\t\t</div>\n\t`,\n};\n","import { Event } from 'main.core';\nimport { Button as UiButton, AirButtonStyle, ButtonSize } from 'ui.vue3.components.button';\n\nimport { Core } from 'tasks.v2.core';\nimport { EventName } from 'tasks.v2.const';\nimport { AddTaskButton } from 'tasks.v2.component.add-task-button';\nimport './footer-create.css';\n\n// @vue/component\nexport const FooterCreate = {\n\tcomponents: {\n\t\tUiButton,\n\t\tAddTaskButton,\n\t},\n\tprops: {\n\t\ttaskId: {\n\t\t\ttype: [Number, String],\n\t\t\trequired: true,\n\t\t},\n\t},\n\temits: ['addTask'],\n\tsetup(): Object\n\t{\n\t\treturn {\n\t\t\tAirButtonStyle,\n\t\t\tButtonSize,\n\t\t};\n\t},\n\tcomputed: {\n\t\tisTemplateEnabled(): boolean\n\t\t{\n\t\t\treturn Core.getParams().features.isTemplateEnabled;\n\t\t},\n\t},\n\tmethods: {\n\t\tclose(): void\n\t\t{\n\t\t\tEvent.EventEmitter.emit(EventName.CloseFullCard, { taskId: this.taskId });\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"tasks-full-card-footer-create\">\n\t\t\t<div class=\"tasks-full-card-footer-main-buttons\">\n\t\t\t\t<AddTaskButton :taskId=\"taskId\" @addTask=\"$emit('addTask')\"/>\n\t\t\t\t<UiButton\n\t\t\t\t\t:text=\"loc('TASKS_V2_TASK_FULL_CARD_CANCEL')\"\n\t\t\t\t\t:size=\"ButtonSize.LARGE\"\n\t\t\t\t\t:style=\"AirButtonStyle.PLAIN\"\n\t\t\t\t\tdata-task-cancel-button\n\t\t\t\t\t@click=\"close\"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t\t<UiButton\n\t\t\t\tv-if=\"isTemplateEnabled\"\n\t\t\t\tclass=\"tasks-full-card-footer-template-button\"\n\t\t\t\t:text=\"loc('TASKS_V2_TASK_FULL_CARD_TEMPLATES')\"\n\t\t\t\t:size=\"ButtonSize.SMALL\"\n\t\t\t\t:style=\"AirButtonStyle.PLAIN_NO_ACCENT\"\n\t\t\t\t:dropdown=\"true\"\n\t\t\t/>\n\t\t</div>\n\t`,\n};\n","import { Event, Runtime } from 'main.core';\nimport { mapGetters } from 'ui.vue3.vuex';\nimport { BMenu, MenuItemDesign, type MenuOptions, type MenuItemOptions } from 'ui.vue3.components.menu';\nimport { BIcon } from 'ui.icon-set.api.vue';\nimport { Outline } from 'ui.icon-set.api.core';\nimport 'ui.icon-set.outline';\n\nimport { EventName, Model, TaskStatus } from 'tasks.v2.const';\nimport { responsibleMeta } from 'tasks.v2.component.fields.responsible';\nimport { EntitySelectorDialog } from 'tasks.v2.lib.entity-selector-dialog';\nimport { taskService } from 'tasks.v2.provider.service.task-service';\nimport { statusService } from 'tasks.v2.provider.service.status-service';\nimport type { TaskModel } from 'tasks.v2.model.tasks';\n\nimport './more.css';\n\n// @vue/component\nexport const More = {\n\tname: 'TaskFullCardMoreActionsStatus',\n\tcomponents: {\n\t\tBIcon,\n\t\tBMenu,\n\t},\n\tprops: {\n\t\ttaskId: {\n\t\t\ttype: [Number, String],\n\t\t\trequired: true,\n\t\t},\n\t},\n\tsetup(): Object\n\t{\n\t\treturn {\n\t\t\tOutline,\n\t\t};\n\t},\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tisMenuShown: false,\n\t\t};\n\t},\n\tcomputed: {\n\t\t...mapGetters({\n\t\t\tcurrentUserId: `${Model.Interface}/currentUserId`,\n\t\t}),\n\t\ttask(): TaskModel\n\t\t{\n\t\t\treturn this.$store.getters[`${Model.Tasks}/getById`](this.taskId);\n\t\t},\n\t\tpreselected(): [string, number][]\n\t\t{\n\t\t\treturn [['user', this.task.responsibleId || this.currentUserId]];\n\t\t},\n\t\tisCreator(): boolean\n\t\t{\n\t\t\treturn this.currentUserId === this.task.creatorId;\n\t\t},\n\t\tisResponsible(): boolean\n\t\t{\n\t\t\treturn this.currentUserId === this.task.responsibleId;\n\t\t},\n\t\tmenuOptions(): Function\n\t\t{\n\t\t\treturn (): MenuOptions => ({\n\t\t\t\tid: 'tasks-full-card-footer-more-menu',\n\t\t\t\tbindElement: this.$refs.button.$el,\n\t\t\t\titems: this.menuItems,\n\t\t\t});\n\t\t},\n\t\tmenuItems(): MenuItemOptions[]\n\t\t{\n\t\t\tconst statuses = {\n\t\t\t\t[TaskStatus.Pending]: {\n\t\t\t\t\t[this.isResponsible]: [\n\t\t\t\t\t\tthis.getCompleteItem(),\n\t\t\t\t\t\tthis.getDefferItem(),\n\t\t\t\t\t\tthis.getDelegateItem(),\n\t\t\t\t\t],\n\t\t\t\t\t[this.isCreator]: [\n\t\t\t\t\t\tthis.getDefferItem(),\n\t\t\t\t\t\tthis.getDelegateItem(),\n\t\t\t\t\t\tthis.getDeleteItem(),\n\t\t\t\t\t],\n\t\t\t\t\t[this.isResponsible && this.isCreator]: [\n\t\t\t\t\t\tthis.getCompleteItem(),\n\t\t\t\t\t\tthis.getDefferItem(),\n\t\t\t\t\t\tthis.getDelegateItem(),\n\t\t\t\t\t\tthis.getDeleteItem(),\n\t\t\t\t\t],\n\t\t\t\t},\n\t\t\t\t[TaskStatus.InProgress]: {\n\t\t\t\t\t[this.isResponsible]: [\n\t\t\t\t\t\tthis.getPauseItem(),\n\t\t\t\t\t\tthis.getDefferItem(),\n\t\t\t\t\t\tthis.getDelegateItem(),\n\t\t\t\t\t],\n\t\t\t\t\t[this.isCreator]: [\n\t\t\t\t\t\tthis.getDefferItem(),\n\t\t\t\t\t\tthis.getDelegateItem(),\n\t\t\t\t\t\tthis.getDeleteItem(),\n\t\t\t\t\t],\n\t\t\t\t\t[this.isResponsible && this.isCreator]: [\n\t\t\t\t\t\tthis.getPauseItem(),\n\t\t\t\t\t\tthis.getDefferItem(),\n\t\t\t\t\t\tthis.getDelegateItem(),\n\t\t\t\t\t\tthis.getDeleteItem(),\n\t\t\t\t\t],\n\t\t\t\t},\n\t\t\t\t[TaskStatus.Deferred]: {\n\t\t\t\t\t[this.isResponsible]: [\n\t\t\t\t\t\tthis.getCompleteItem(),\n\t\t\t\t\t\tthis.getDelegateItem(),\n\t\t\t\t\t],\n\t\t\t\t\t[this.isCreator]: [\n\t\t\t\t\t\tthis.getCompleteItem(),\n\t\t\t\t\t\tthis.getDelegateItem(),\n\t\t\t\t\t\tthis.getDeleteItem(),\n\t\t\t\t\t],\n\t\t\t\t},\n\t\t\t\t[TaskStatus.SupposedlyCompleted]: {\n\t\t\t\t\t[this.isResponsible]: [\n\t\t\t\t\t\tthis.getFixItem(),\n\t\t\t\t\t\tthis.getDelegateItem(),\n\t\t\t\t\t],\n\t\t\t\t\t[this.isCreator]: [\n\t\t\t\t\t\tthis.getDisapproveItem(),\n\t\t\t\t\t\tthis.getDelegateItem(),\n\t\t\t\t\t\tthis.getDeleteItem(),\n\t\t\t\t\t],\n\t\t\t\t\t[this.isResponsible && this.isCreator]: [\n\t\t\t\t\t\tthis.getCompleteItem(),\n\t\t\t\t\t\tthis.getDelegateItem(),\n\t\t\t\t\t\tthis.getDeleteItem(),\n\t\t\t\t\t],\n\t\t\t\t},\n\t\t\t\t[TaskStatus.Completed]: {\n\t\t\t\t\t[this.isCreator]: [\n\t\t\t\t\t\tthis.getRenewItem(),\n\t\t\t\t\t\tthis.getDeleteItem(),\n\t\t\t\t\t],\n\t\t\t\t},\n\t\t\t};\n\n\t\t\treturn statuses[this.task.status].true;\n\t\t},\n\t},\n\tmethods: {\n\t\thandleClick(): void\n\t\t{\n\t\t\tthis.isMenuShown = true;\n\t\t},\n\t\tgetDefferItem(): MenuItemOptions\n\t\t{\n\t\t\tif (!this.task.rights.defer)\n\t\t\t{\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\ttitle: this.loc('TASKS_V2_TASK_FULL_CARD_DEFER'),\n\t\t\t\ticon: Outline.PAUSE_L,\n\t\t\t\tonClick: (): void => statusService.defer(this.taskId),\n\t\t\t};\n\t\t},\n\t\tgetPauseItem(): MenuItemOptions\n\t\t{\n\t\t\tif (!this.task.rights.pause)\n\t\t\t{\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\ttitle: this.loc('TASKS_V2_TASK_FULL_CARD_PAUSE'),\n\t\t\t\ticon: Outline.STOP_L,\n\t\t\t\tonClick: (): void => statusService.pause(this.taskId),\n\t\t\t};\n\t\t},\n\t\tgetRenewItem(): MenuItemOptions\n\t\t{\n\t\t\tif (!this.task.rights.renew)\n\t\t\t{\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\ttitle: this.loc('TASKS_V2_TASK_FULL_CARD_RENEW'),\n\t\t\t\ticon: Outline.UNDO,\n\t\t\t\tonClick: (): void => statusService.renew(this.taskId),\n\t\t\t};\n\t\t},\n\t\tgetFixItem(): MenuItemOptions\n\t\t{\n\t\t\tif (!this.task.rights.renew)\n\t\t\t{\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\ttitle: this.loc('TASKS_V2_TASK_FULL_CARD_FIX'),\n\t\t\t\ticon: Outline.UNDO,\n\t\t\t\tonClick: (): void => statusService.renew(this.taskId),\n\t\t\t};\n\t\t},\n\t\tgetDisapproveItem(): MenuItemOptions\n\t\t{\n\t\t\tif (!this.task.rights.disapprove)\n\t\t\t{\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\ttitle: this.loc('TASKS_V2_TASK_FULL_CARD_DISAPPROVE'),\n\t\t\t\ticon: Outline.UNDO,\n\t\t\t\tonClick: (): void => statusService.disapprove(this.taskId),\n\t\t\t};\n\t\t},\n\t\tgetCompleteItem(): MenuItemOptions\n\t\t{\n\t\t\tif (!this.task.rights.complete)\n\t\t\t{\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\ttitle: this.loc('TASKS_V2_TASK_FULL_CARD_COMPLETE'),\n\t\t\t\ticon: Outline.SENDED,\n\t\t\t\tonClick: (): void => statusService.complete(this.taskId),\n\t\t\t};\n\t\t},\n\t\tgetDelegateItem(): MenuItemOptions\n\t\t{\n\t\t\tif (!this.task.rights.delegate)\n\t\t\t{\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\ttitle: this.loc('TASKS_V2_TASK_FULL_CARD_DELEGATE'),\n\t\t\t\ticon: Outline.DELEGATE,\n\t\t\t\tonClick: (): void => {\n\t\t\t\t\tconst onItemChangeDebounced = Runtime.debounce(this.handleDelegateSelect, 10, this);\n\n\t\t\t\t\tthis.dialog ??= new EntitySelectorDialog({\n\t\t\t\t\t\t...responsibleMeta.dialogOptions(this.$options.name),\n\t\t\t\t\t\tpreselectedItems: this.preselected,\n\t\t\t\t\t\tevents: {\n\t\t\t\t\t\t\t'Item:onSelect': onItemChangeDebounced,\n\t\t\t\t\t\t\t'Item:onDeselect': onItemChangeDebounced,\n\t\t\t\t\t\t},\n\t\t\t\t\t});\n\t\t\t\t\tthis.dialog.selectItemsByIds(this.preselected);\n\t\t\t\t\tthis.dialog.showTo(this.$refs.button.$el);\n\t\t\t\t},\n\t\t\t};\n\t\t},\n\t\thandleDelegateSelect(): void\n\t\t{\n\t\t\tconst responsibleId = this.dialog.getSelectedItems()[0]?.getId() ?? 0;\n\n\t\t\tvoid taskService.update(\n\t\t\t\tthis.taskId,\n\t\t\t\t{ responsibleId },\n\t\t\t);\n\t\t},\n\t\tgetDeleteItem(): MenuItemOptions\n\t\t{\n\t\t\tif (!this.task.rights.remove)\n\t\t\t{\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\tdesign: MenuItemDesign.Alert,\n\t\t\t\ttitle: this.loc('TASKS_V2_TASK_FULL_CARD_DELETE'),\n\t\t\t\ticon: Outline.TRASHCAN,\n\t\t\t\tonClick: (): void => {\n\t\t\t\t\tvoid taskService.delete(this.taskId);\n\t\t\t\t\tEvent.EventEmitter.emit(EventName.CloseFullCard, { taskId: this.taskId });\n\t\t\t\t},\n\t\t\t};\n\t\t},\n\t},\n\ttemplate: `\n\t\t<BIcon\n\t\t\tv-if=\"menuItems\"\n\t\t\tclass=\"tasks-full-card-footer-more\"\n\t\t\t:name=\"Outline.MORE_L\"\n\t\t\tdata-task-more-button\n\t\t\tref=\"button\"\n\t\t\t@click=\"handleClick\"\n\t\t/>\n\t\t<BMenu v-if=\"isMenuShown\" :options=\"menuOptions()\" @close=\"isMenuShown = false\"/>\n\t`,\n};\n","import { mapGetters } from 'ui.vue3.vuex';\nimport { Button as UiButton, AirButtonStyle, ButtonSize, ButtonIcon } from 'ui.vue3.components.button';\nimport { BIcon } from 'ui.icon-set.api.vue';\nimport { Outline } from 'ui.icon-set.api.core';\nimport 'ui.icon-set.outline';\n\nimport { Model, TaskStatus } from 'tasks.v2.const';\nimport { statusService } from 'tasks.v2.provider.service.status-service';\nimport type { TaskModel } from 'tasks.v2.model.tasks';\n\nimport { More } from './more/more';\nimport './footer-edit.css';\n\ntype ButtonOptions = {\n\ttext: string,\n\tcolor: string,\n\tdisabled: boolean,\n\tonClick: Function,\n};\n\n// @vue/component\nexport const FooterEdit = {\n\tcomponents: {\n\t\tUiButton,\n\t\tBIcon,\n\t\tMore,\n\t},\n\tprops: {\n\t\ttaskId: {\n\t\t\ttype: [Number, String],\n\t\t\trequired: true,\n\t\t},\n\t},\n\tsetup(): Object\n\t{\n\t\treturn {\n\t\t\tAirButtonStyle,\n\t\t\tButtonSize,\n\t\t\tButtonIcon,\n\t\t\tOutline,\n\t\t\tTaskStatus,\n\t\t};\n\t},\n\tcomputed: {\n\t\t...mapGetters({\n\t\t\tcurrentUserId: `${Model.Interface}/currentUserId`,\n\t\t}),\n\t\ttask(): TaskModel\n\t\t{\n\t\t\treturn this.$store.getters[`${Model.Tasks}/getById`](this.taskId);\n\t\t},\n\t\tisCreator(): boolean\n\t\t{\n\t\t\treturn this.currentUserId === this.task.creatorId;\n\t\t},\n\t\tisResponsible(): boolean\n\t\t{\n\t\t\treturn this.currentUserId === this.task.responsibleId;\n\t\t},\n\t\tstatusButton(): ButtonOptions | null\n\t\t{\n\t\t\tconst statuses = {\n\t\t\t\t[TaskStatus.Pending]: {\n\t\t\t\t\t[this.isCreator]: this.getCompleteButton(),\n\t\t\t\t\t[this.isResponsible]: this.getStartButton(),\n\t\t\t\t},\n\t\t\t\t[TaskStatus.InProgress]: {\n\t\t\t\t\t[this.isResponsible]: this.getCompleteButton(),\n\t\t\t\t\t[this.isCreator]: this.getCompleteButton(),\n\t\t\t\t},\n\t\t\t\t[TaskStatus.Deferred]: {\n\t\t\t\t\t[this.isResponsible]: this.getRenewButton(),\n\t\t\t\t\t[this.isCreator]: this.getRenewButton(),\n\t\t\t\t},\n\t\t\t\t[TaskStatus.SupposedlyCompleted]: {\n\t\t\t\t\t[this.isResponsible]: this.getReviewButton(),\n\t\t\t\t\t[this.isCreator]: this.getApproveButton(),\n\t\t\t\t},\n\t\t\t\t[TaskStatus.Completed]: {\n\t\t\t\t\t[this.isResponsible && !this.isCreator]: this.getRenewButton(AirButtonStyle.PLAIN),\n\t\t\t\t},\n\t\t\t};\n\n\t\t\treturn statuses[this.task.status].true;\n\t\t},\n\t},\n\tmethods: {\n\t\tgetStartButton(): ButtonOptions\n\t\t{\n\t\t\tif (!this.task.rights.start)\n\t\t\t{\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\ttext: this.loc('TASKS_V2_TASK_FULL_CARD_START'),\n\t\t\t\tonClick: (): void => statusService.start(this.taskId),\n\t\t\t};\n\t\t},\n\t\tgetCompleteButton(): ButtonOptions\n\t\t{\n\t\t\tif (!this.task.rights.complete)\n\t\t\t{\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\ttext: this.loc('TASKS_V2_TASK_FULL_CARD_COMPLETE'),\n\t\t\t\tonClick: (): void => statusService.complete(this.taskId),\n\t\t\t};\n\t\t},\n\t\tgetRenewButton(style: string): ButtonOptions\n\t\t{\n\t\t\tif (!this.task.rights.renew)\n\t\t\t{\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\ttext: this.loc('TASKS_V2_TASK_FULL_CARD_RENEW'),\n\t\t\t\tstyle,\n\t\t\t\tonClick: (): void => statusService.renew(this.taskId),\n\t\t\t};\n\t\t},\n\t\tgetReviewButton(): ButtonOptions\n\t\t{\n\t\t\treturn {\n\t\t\t\ttext: this.loc('TASKS_V2_TASK_FULL_CARD_ON_REVIEW'),\n\t\t\t\tdisabled: true,\n\t\t\t};\n\t\t},\n\t\tgetApproveButton(): ButtonOptions\n\t\t{\n\t\t\tif (!this.task.rights.approve)\n\t\t\t{\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\ttext: this.loc('TASKS_V2_TASK_FULL_CARD_APPROVE'),\n\t\t\t\tonClick: (): void => statusService.complete(this.taskId),\n\t\t\t};\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"tasks-full-card-footer-edit\">\n\t\t\t<UiButton\n\t\t\t\tv-if=\"statusButton\"\n\t\t\t\t:text=\"statusButton.text\"\n\t\t\t\t:size=\"ButtonSize.LARGE\"\n\t\t\t\t:style=\"statusButton.style ?? AirButtonStyle.FILLED\"\n\t\t\t\t:disabled=\"statusButton.disabled ?? false\"\n\t\t\t\tdata-task-status-button\n\t\t\t\t@click=\"statusButton.onClick\"\n\t\t\t/>\n\t\t\t<More :taskId=\"taskId\"/>\n\t\t\t<div class=\"tasks-full-card-footer-actions\">\n\t\t\t\t<div class=\"tasks-full-card-footer-reaction\">\n\t\t\t\t\t<BIcon :name=\"Outline.LIKE\"/>\n\t\t\t\t\t<div class=\"tasks-full-card-footer-reaction-text\">Нравится</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-full-card-footer-views\">\n\t\t\t\t\t<BIcon :name=\"Outline.OBSERVER\"/>\n\t\t\t\t\t<div class=\"tasks-full-card-footer-views-text\">1</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import { Dom, Text } from 'main.core';\nimport { EventEmitter } from 'main.core.events';\nimport { mapGetters } from 'ui.vue3.vuex';\n\nimport { FullSkeleton } from 'tasks.v2.application.task-card';\nimport { Core } from 'tasks.v2.core';\nimport { CardType, EventName, Model } from 'tasks.v2.const';\nimport { FieldList } from 'tasks.v2.component.elements.field-list';\nimport { DropZone } from 'tasks.v2.component.drop-zone';\nimport { DescriptionField, DescriptionSheet, descriptionTextEditor } from 'tasks.v2.component.fields.description';\nimport { Creator, creatorMeta } from 'tasks.v2.component.fields.creator';\nimport { Responsible, responsibleMeta } from 'tasks.v2.component.fields.responsible';\nimport { Deadline, deadlineMeta } from 'tasks.v2.component.fields.deadline';\nimport { Status, statusMeta } from 'tasks.v2.component.fields.status';\nimport { Files, FilesSheet, FilesChip, filesMeta } from 'tasks.v2.component.fields.files';\nimport { CheckList, CheckListChip, checkListMeta } from 'tasks.v2.component.fields.check-list';\nimport { Group, GroupChip, groupMeta } from 'tasks.v2.component.fields.group';\nimport { Flow, FlowChip, flowMeta } from 'tasks.v2.component.fields.flow';\nimport { Accomplices, AccomplicesChip, accomplicesMeta } from 'tasks.v2.component.fields.accomplices';\nimport { Auditors, AuditorsChip, auditorsMeta } from 'tasks.v2.component.fields.auditors';\nimport { Tags, TagsChip, tagsMeta } from 'tasks.v2.component.fields.tags';\nimport { Crm, CrmChip, crmMeta } from 'tasks.v2.component.fields.crm';\nimport { DatePlan, DatePlanChip, DatePlanSheet, datePlanMeta } from 'tasks.v2.component.fields.date-plan';\nimport { SubTasks, SubTasksChip, subTasksMeta } from 'tasks.v2.component.fields.sub-tasks';\nimport { ParentTask, ParentTaskChip, parentTaskMeta } from 'tasks.v2.component.fields.parent-task';\nimport { RelatedTasks, RelatedTasksChip, relatedTasksMeta } from 'tasks.v2.component.fields.related-tasks';\n\nimport { fileService } from 'tasks.v2.provider.service.file-service';\nimport { taskService } from 'tasks.v2.provider.service.task-service';\nimport { checkListService } from 'tasks.v2.provider.service.check-list-service';\nimport type { TaskModel } from 'tasks.v2.model.tasks';\nimport type { CheckListModel } from 'tasks.v2.model.check-list';\n\nimport { TaskHeader } from './task-header/task-header';\nimport { Chat } from './chat/chat';\nimport { Chips } from './chips/chips';\nimport { FooterCreate } from './footer-create/footer-create';\nimport { FooterEdit } from './footer-edit/footer-edit';\nimport './app.css';\n\n// @vue/component\nexport const App = {\n\tname: 'TaskFullCard',\n\tcomponents: {\n\t\tTaskHeader,\n\t\tDescriptionField,\n\t\tDescriptionSheet,\n\t\tFiles,\n\t\tFilesSheet,\n\t\tCheckList,\n\t\tDatePlan,\n\t\tDatePlanSheet,\n\t\tSubTasks,\n\t\tParentTask,\n\t\tRelatedTasks,\n\t\tFieldList,\n\t\tChat,\n\t\tFooterCreate,\n\t\tFooterEdit,\n\t\tDropZone,\n\t\tChips,\n\t},\n\tprovide(): Object\n\t{\n\t\treturn {\n\t\t\tanalytics: this.analytics,\n\t\t\tcardType: CardType.Full,\n\t\t};\n\t},\n\tprops: {\n\t\tid: {\n\t\t\ttype: [Number, String],\n\t\t\tdefault: () => Text.getRandom(),\n\t\t},\n\t\tanalytics: {\n\t\t\ttype: Object,\n\t\t\tdefault: () => ({}),\n\t\t},\n\t},\n\tsetup(): Object\n\t{\n\t\treturn {\n\t\t\tfilesMeta,\n\t\t\tdatePlanMeta,\n\t\t\tcheckListMeta,\n\t\t\tsubTasksMeta,\n\t\t\tparentTaskMeta,\n\t\t\trelatedTasksMeta,\n\t\t\tresizeObserver: null,\n\t\t};\n\t},\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\ttaskId: this.id,\n\t\t\tisFilesSheetShown: false,\n\t\t\tisDescriptionSheetShown: false,\n\t\t\tisCheckListSheetShown: false,\n\t\t\tisDatePlanSheetShown: false,\n\t\t\tcheckListId: 0,\n\t\t\tfiles: fileService.get(this.id).getFiles(),\n\t\t};\n\t},\n\tcomputed: {\n\t\t...mapGetters({\n\t\t\tcurrentUserId: `${Model.Interface}/currentUserId`,\n\t\t}),\n\t\ttask(): TaskModel\n\t\t{\n\t\t\treturn this.$store.getters[`${Model.Tasks}/getById`](this.taskId);\n\t\t},\n\t\tcheckLists(): CheckListModel[]\n\t\t{\n\t\t\treturn this.task?.checklist\n\t\t\t\t? this.$store.getters[`${Model.CheckList}/getByIds`](this.task.checklist)\n\t\t\t\t: [];\n\t\t},\n\t\tisEdit(): boolean\n\t\t{\n\t\t\treturn Number.isInteger(this.taskId) && this.taskId > 0;\n\t\t},\n\t\tisPartiallyLoaded(): boolean\n\t\t{\n\t\t\treturn this.$store.getters[`${Model.Tasks}/isPartiallyLoaded`](this.taskId);\n\t\t},\n\t\tfields(): Object[]\n\t\t{\n\t\t\tconst fields = [\n\t\t\t\t{\n\t\t\t\t\ttitle: creatorMeta.title,\n\t\t\t\t\tcomponent: Creator,\n\t\t\t\t\tprops: {\n\t\t\t\t\t\tcontext: this.$options.name,\n\t\t\t\t\t\tselectorWithActionMenu: this.isEdit,\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\ttitle: responsibleMeta.title,\n\t\t\t\t\tcomponent: Responsible,\n\t\t\t\t\tprops: {\n\t\t\t\t\t\tcontext: this.$options.name,\n\t\t\t\t\t\tselectorWithActionMenu: this.isEdit,\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\ttitle: deadlineMeta.title,\n\t\t\t\t\tcomponent: Deadline,\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\ttitle: statusMeta.title,\n\t\t\t\t\tcomponent: Status,\n\t\t\t\t\twithSeparator: true,\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tchip: FilesChip,\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tchip: {\n\t\t\t\t\t\tcomponent: CheckListChip,\n\t\t\t\t\t\tevents: {\n\t\t\t\t\t\t\tshowCheckList: this.openCheckList,\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\ttitle: groupMeta.getTitle(this.task.groupId),\n\t\t\t\t\tcomponent: Group,\n\t\t\t\t\tchip: GroupChip,\n\t\t\t\t\tisEnabled: Core.getParams().features.isProjectsEnabled,\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\ttitle: accomplicesMeta.title,\n\t\t\t\t\tcomponent: Accomplices,\n\t\t\t\t\tchip: AccomplicesChip,\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\ttitle: auditorsMeta.title,\n\t\t\t\t\tcomponent: Auditors,\n\t\t\t\t\tchip: AuditorsChip,\n\t\t\t\t\twithSeparator: this.wasFilled(accomplicesMeta.id),\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\ttitle: flowMeta.title,\n\t\t\t\t\tcomponent: Flow,\n\t\t\t\t\tchip: FlowChip,\n\t\t\t\t\twithSeparator: true,\n\t\t\t\t\tisEnabled: Core.getParams().features.isFlowEnabled,\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\ttitle: tagsMeta.title,\n\t\t\t\t\tcomponent: Tags,\n\t\t\t\t\tchip: TagsChip,\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\ttitle: crmMeta.title,\n\t\t\t\t\tcomponent: Crm,\n\t\t\t\t\tchip: {\n\t\t\t\t\t\tcomponent: CrmChip,\n\t\t\t\t\t\tcollapsed: true,\n\t\t\t\t\t},\n\t\t\t\t\twithSeparator: this.wasFilled(groupMeta.id) || this.wasFilled(flowMeta.id),\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tchip: {\n\t\t\t\t\t\tcomponent: ParentTaskChip,\n\t\t\t\t\t\tcollapsed: true,\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tchip: {\n\t\t\t\t\t\tcomponent: SubTasksChip,\n\t\t\t\t\t\tcollapsed: true,\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tchip: {\n\t\t\t\t\t\tcomponent: RelatedTasksChip,\n\t\t\t\t\t\tcollapsed: true,\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tchip: {\n\t\t\t\t\t\tcomponent: DatePlanChip,\n\t\t\t\t\t\tcollapsed: true,\n\t\t\t\t\t\tevents: {\n\t\t\t\t\t\t\topen: this.openDatePlan,\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t];\n\n\t\t\t/* eslint-disable no-param-reassign */\n\t\t\tfields.forEach((field) => {\n\t\t\t\tfield.props ??= {};\n\t\t\t\tfield.props.taskId = this.taskId;\n\t\t\t});\n\n\t\t\treturn fields;\n\t\t},\n\t\tprimaryFields(): Object[]\n\t\t{\n\t\t\tconst primaryFields = new Set([\n\t\t\t\tCreator,\n\t\t\t\tResponsible,\n\t\t\t\tDeadline,\n\t\t\t\t...(this.isEdit ? [Status] : []),\n\t\t\t]);\n\n\t\t\treturn this.fields.filter(({ component }) => primaryFields.has(component));\n\t\t},\n\t\tprojectFields(): Object[]\n\t\t{\n\t\t\tconst projectFields = new Set();\n\t\t\tif (this.wasFilled(groupMeta.id))\n\t\t\t{\n\t\t\t\tprojectFields.add(Group);\n\t\t\t}\n\n\t\t\tif (this.wasFilled(flowMeta.id))\n\t\t\t{\n\t\t\t\tprojectFields.add(Flow);\n\t\t\t}\n\n\t\t\tif (this.wasFilled(crmMeta.id))\n\t\t\t{\n\t\t\t\tprojectFields.add(Crm);\n\t\t\t}\n\n\t\t\treturn this.fields.filter(({ component }) => projectFields.has(component));\n\t\t},\n\t\tparticipantsFields(): Object[]\n\t\t{\n\t\t\tconst participantsFields = new Set();\n\n\t\t\tif (this.wasFilled(accomplicesMeta.id))\n\t\t\t{\n\t\t\t\tparticipantsFields.add(Accomplices);\n\t\t\t}\n\n\t\t\tif (this.wasFilled(auditorsMeta.id))\n\t\t\t{\n\t\t\t\tparticipantsFields.add(Auditors);\n\t\t\t}\n\n\t\t\treturn this.fields.filter(({ component }) => participantsFields.has(component));\n\t\t},\n\t\ttagsFields(): Object[]\n\t\t{\n\t\t\tif (!this.wasFilled(tagsMeta.id))\n\t\t\t{\n\t\t\t\treturn [];\n\t\t\t}\n\n\t\t\treturn this.fields.filter(({ component }) => component === Tags);\n\t\t},\n\t\tchips(): any[]\n\t\t{\n\t\t\treturn this.fields.filter(({ chip, isEnabled }) => chip && isEnabled !== false).map(({ chip }) => chip);\n\t\t},\n\t\tisBottomSheetShown(): boolean\n\t\t{\n\t\t\treturn this.isDescriptionSheetShown\n\t\t\t\t|| this.isFilesSheetShown\n\t\t\t\t|| this.isCheckListSheetShown\n\t\t\t\t|| this.isDatePlanSheetShown\n\t\t\t;\n\t\t},\n\t},\n\twatch: {\n\t\tasync task(): Promise<void>\n\t\t{\n\t\t\tif (this.task)\n\t\t\t{\n\t\t\t\tawait this.$nextTick();\n\t\t\t\tthis.tryStartObserver();\n\t\t\t}\n\t\t},\n\t},\n\tasync created(): Promise<void>\n\t{\n\t\tif (!this.isEdit && !this.task)\n\t\t{\n\t\t\tvoid this.$store.dispatch(`${Model.Tasks}/insert`, {\n\t\t\t\tid: this.taskId,\n\t\t\t\tcreatorId: this.currentUserId,\n\t\t\t});\n\t\t}\n\n\t\tawait this.$store.dispatch(`${Model.Tasks}/clearFieldsFilled`, this.taskId);\n\n\t\tif (this.isEdit && (!this.task || this.isPartiallyLoaded))\n\t\t{\n\t\t\tawait taskService.getById(this.taskId);\n\t\t}\n\n\t\tawait fileService.get(this.taskId).list(this.task.fileIds);\n\n\t\tdescriptionTextEditor.get(this.taskId, {\n\t\t\tcontent: this.task?.description,\n\t\t});\n\t},\n\tmounted(): void\n\t{\n\t\tthis.tryStartObserver();\n\t\tthis.$refs.skeleton?.append(FullSkeleton());\n\t},\n\tbeforeUnmount(): void\n\t{\n\t\tthis.resizeObserver?.disconnect();\n\t},\n\tunmounted(): void\n\t{\n\t\tif (!this.isEdit)\n\t\t{\n\t\t\tvoid this.$store.dispatch(`${Model.Tasks}/delete`, this.taskId);\n\t\t\tfileService.delete(this.taskId);\n\t\t\tdescriptionTextEditor.delete(this.taskId);\n\t\t}\n\t},\n\tmethods: {\n\t\twasFilled(fieldId: string): boolean\n\t\t{\n\t\t\treturn this.$store.getters[`${Model.Tasks}/wasFieldFilled`](this.taskId, fieldId);\n\t\t},\n\t\ttryStartObserver(): void\n\t\t{\n\t\t\tif (this.$refs.title && !this.resizeObserver)\n\t\t\t{\n\t\t\t\tthis.resizeObserver = this.getObserver();\n\t\t\t\tthis.resizeObserver.observe(this.$refs.title);\n\t\t\t}\n\t\t},\n\t\tgetObserver(): ResizeObserver\n\t\t{\n\t\t\treturn new ResizeObserver((entries) => {\n\t\t\t\tfor (const entry of entries)\n\t\t\t\t{\n\t\t\t\t\tif (entry.target === this.$refs.title)\n\t\t\t\t\t{\n\t\t\t\t\t\tvoid this.$store.dispatch(`${Model.Interface}/updateTitleFieldOffsetHeight`, entry.contentRect.height);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\t\tasync addTask(): Promise<void>\n\t\t{\n\t\t\tawait this.$refs?.description?.save();\n\n\t\t\tconst checkLists = this.checkLists;\n\n\t\t\tconst [id] = await taskService.add(this.task);\n\n\t\t\tthis.taskId = id;\n\n\t\t\tif (checkLists.length > 0)\n\t\t\t{\n\t\t\t\tawait checkListService.save(this.taskId, checkLists);\n\t\t\t}\n\n\t\t\tfileService.replace(this.id, this.taskId);\n\t\t\tdescriptionTextEditor.replace(this.id, this.taskId);\n\t\t},\n\t\topenEditor(): void\n\t\t{\n\t\t\tthis.isDescriptionSheetShown = true;\n\t\t\tthis.handleShowBottomSheet();\n\t\t},\n\t\tcloseEditor(slot: { close: () => void }): void\n\t\t{\n\t\t\tslot.close();\n\t\t\tthis.isDescriptionSheetShown = false;\n\t\t\tthis.handleCloseBottomSheet();\n\t\t},\n\t\topenFiles(): void\n\t\t{\n\t\t\tthis.isFilesSheetShown = true;\n\t\t\tthis.handleShowBottomSheet();\n\t\t},\n\t\tcloseFiles(): void\n\t\t{\n\t\t\tthis.isFilesSheetShown = false;\n\t\t\tthis.handleCloseBottomSheet();\n\t\t},\n\t\topenCheckList(checkListId?: number): void\n\t\t{\n\t\t\tthis.checkListId = checkListId;\n\t\t\tthis.isCheckListSheetShown = true;\n\t\t\tthis.handleShowBottomSheet();\n\t\t},\n\t\tcloseCheckList(checkListId?: number): void\n\t\t{\n\t\t\tthis.checkListId = checkListId;\n\t\t\tthis.isCheckListSheetShown = false;\n\t\t\tthis.handleCloseBottomSheet();\n\t\t},\n\t\topenDatePlan(): void\n\t\t{\n\t\t\tthis.isDatePlanSheetShown = true;\n\t\t\tthis.handleShowBottomSheet();\n\t\t},\n\t\tcloseDatePlan(): void\n\t\t{\n\t\t\tthis.isDatePlanSheetShown = false;\n\t\t\tthis.handleCloseBottomSheet();\n\t\t},\n\t\thandleShowBottomSheet(): void\n\t\t{\n\t\t\tDom.addClass(this.$refs.scrollContent, '--disable-scroll');\n\t\t},\n\t\thandleCloseBottomSheet(): void\n\t\t{\n\t\t\tDom.removeClass(this.$refs.scrollContent, '--disable-scroll');\n\t\t},\n\t\tclose(): void\n\t\t{\n\t\t\tEventEmitter.emit(EventName.CloseFullCard, { taskId: this.taskId });\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"tasks-full-card\" :class=\"{ '--blur': isDescriptionSheetShown }\" :data-task-id=\"taskId\" data-task-full>\n\t\t\t<template v-if=\"task && !isPartiallyLoaded\">\n\t\t\t\t<div class=\"tasks-full-card-main\" :class=\"{ '--overlay': isBottomSheetShown }\" ref=\"main\">\n\t\t\t\t\t<div class=\"tasks-full-card-content\" :data-task-card-scroll=\"taskId\" ref=\"scrollContent\">\n\t\t\t\t\t\t<div\n\t\t\t\t\t\t\tref=\"title\">\n\t\t\t\t\t\t\t<TaskHeader :taskId/>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<FilesSheet\n\t\t\t\t\t\t\t:taskId=\"taskId\"\n\t\t\t\t\t\t\t:isShown=\"isFilesSheetShown\"\n\t\t\t\t\t\t\t:getBindElement=\"() => $refs.title\"\n\t\t\t\t\t\t\t:getTargetContainer=\"() => $refs.main\"\n\t\t\t\t\t\t\t@close=\"closeFiles\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<CheckList\n\t\t\t\t\t\t\t:taskId=\"taskId\"\n\t\t\t\t\t\t\t:checkListId=\"checkListId\"\n\t\t\t\t\t\t\t:isShown=\"isCheckListSheetShown\"\n\t\t\t\t\t\t\t:getBindElement=\"() => $refs.title\"\n\t\t\t\t\t\t\t:getTargetContainer=\"() => $refs.main\"\n\t\t\t\t\t\t\t@close=\"closeCheckList\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<DatePlanSheet\n\t\t\t\t\t\t\t:taskId=\"taskId\"\n\t\t\t\t\t\t\t:isShown=\"isDatePlanSheetShown\"\n\t\t\t\t\t\t\t:getBindElement=\"() => $refs.title\"\n\t\t\t\t\t\t\t:getTargetContainer=\"() => $refs.main\"\n\t\t\t\t\t\t\t@close=\"closeDatePlan\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<DescriptionField\n\t\t\t\t\t\t\t:taskId=\"taskId\"\n\t\t\t\t\t\t\tv-slot=\"slot\"\n\t\t\t\t\t\t\tref=\"description\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<DescriptionSheet\n\t\t\t\t\t\t\t\t:taskId=\"taskId\"\n\t\t\t\t\t\t\t\t:isShown=\"slot.isShown\"\n\t\t\t\t\t\t\t\t:doOpenInEditMode=\"slot.doOpenInEditMode\"\n\t\t\t\t\t\t\t\t:getBindElement=\"() => $refs.title\"\n\t\t\t\t\t\t\t\t:getTargetContainer=\"() => $refs.main\"\n\t\t\t\t\t\t\t\t@show=\"openEditor\"\n\t\t\t\t\t\t\t\t@close=\"closeEditor(slot)\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</DescriptionField>\n\t\t\t\t\t\t<div class=\"tasks-full-card-fields\">\n\t\t\t\t\t\t\t<div class=\"tasks-full-card-field-container\" data-field-container>\n\t\t\t\t\t\t\t\t<FieldList :fields=\"primaryFields\"/>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class=\"tasks-full-card-chips-fields\">\n\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\tv-if=\"files.length > 0 || wasFilled(filesMeta.id)\"\n\t\t\t\t\t\t\t\t\tclass=\"tasks-full-card-field-container --small-vertical-padding\"\n\t\t\t\t\t\t\t\t\tdata-field-container\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t<Files :taskId=\"taskId\" @open=\"openFiles\"/>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\tv-if=\"wasFilled(checkListMeta.id)\"\n\t\t\t\t\t\t\t\t\tclass=\"tasks-full-card-field-container --custom\"\n\t\t\t\t\t\t\t\t\tdata-field-container\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t<CheckList\n\t\t\t\t\t\t\t\t\t\t:taskId=\"taskId\"\n\t\t\t\t\t\t\t\t\t\t:isPreview=\"true\"\n\t\t\t\t\t\t\t\t\t\t:isComponentShown=\"!isCheckListSheetShown\"\n\t\t\t\t\t\t\t\t\t\t:checkListId=\"checkListId\"\n\t\t\t\t\t\t\t\t\t\t@open=\"openCheckList\"\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\tv-if=\"projectFields.length > 0\"\n\t\t\t\t\t\t\t\t\tclass=\"tasks-full-card-field-container\"\n\t\t\t\t\t\t\t\t\tdata-field-container\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t<FieldList :fields=\"projectFields\"/>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\tv-if=\"participantsFields.length > 0\"\n\t\t\t\t\t\t\t\t\tclass=\"tasks-full-card-field-container\"\n\t\t\t\t\t\t\t\t\tdata-field-container\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t<FieldList\n\t\t\t\t\t\t\t\t\t\t:fields=\"participantsFields\"\n\t\t\t\t\t\t\t\t\t\t:useSeparator=\"participantsFields.length > 1\"\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\tv-if=\"tagsFields.length > 0\"\n\t\t\t\t\t\t\t\t\tclass=\"tasks-full-card-field-container\"\n\t\t\t\t\t\t\t\t\tdata-field-container\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t<FieldList :fields=\"tagsFields\"/>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\tv-if=\"wasFilled(datePlanMeta.id)\"\n\t\t\t\t\t\t\t\t\tclass=\"tasks-full-card-field-container\"\n\t\t\t\t\t\t\t\t\tdata-field-container\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t<DatePlan :taskId=\"taskId\" @open=\"openDatePlan\"/>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\tv-if=\"wasFilled(parentTaskMeta.id)\"\n\t\t\t\t\t\t\t\t\tclass=\"tasks-full-card-field-container --custom\"\n\t\t\t\t\t\t\t\t\tdata-field-container\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t<ParentTask :taskId=\"taskId\"/>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\tv-if=\"wasFilled(subTasksMeta.id)\"\n\t\t\t\t\t\t\t\t\tclass=\"tasks-full-card-field-container --custom\"\n\t\t\t\t\t\t\t\t\tdata-field-container\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t<SubTasks :taskId=\"taskId\"/>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\tv-if=\"wasFilled(relatedTasksMeta.id)\"\n\t\t\t\t\t\t\t\t\tclass=\"tasks-full-card-field-container --custom\"\n\t\t\t\t\t\t\t\t\tdata-field-container\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t<RelatedTasks :taskId=\"taskId\"/>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<Chips :taskId=\"taskId\" :chips=\"chips\"/>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<DropZone\n\t\t\t\t\t\t\tv-if=\"!isBottomSheetShown\"\n\t\t\t\t\t\t\t:taskId=\"taskId\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"tasks-full-card-footer\">\n\t\t\t\t\t\t<FooterEdit v-if=\"isEdit\" :taskId=\"taskId\"/>\n\t\t\t\t\t\t<FooterCreate v-else :taskId=\"taskId\" @addTask=\"addTask\"/>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<Chat :taskId=\"taskId\"/>\n\t\t\t</template>\n\t\t\t<template v-else>\n\t\t\t\t<div ref=\"skeleton\" style=\"width: 100%;\"></div>\n\t\t\t</template>\n\t\t</div>\n\t`,\n};\n","import { Event, Runtime, Text } from 'main.core';\nimport { EventEmitter, type BaseEvent } from 'main.core.events';\nimport type { Popup } from 'main.popup';\nimport type { Slider } from 'main.sidepanel';\n\nimport { BitrixVue, type VueCreateAppResult } from 'ui.vue3';\nimport { locMixin } from 'ui.vue3.mixins.loc-mixin';\n\nimport { Core } from 'tasks.v2.core';\nimport { EventName } from 'tasks.v2.const';\nimport type { Params } from 'tasks.v2.application.task-card';\n\nimport { App } from './component/app';\n\nexport class TaskFullCard\n{\n\t#params: Params;\n\t#slider: Slider;\n\t#application: ?VueCreateAppResult;\n\t#handlers: { [eventName: string]: Function };\n\t#needToReloadGrid: boolean = false;\n\n\tconstructor(params: Params = {})\n\t{\n\t\tthis.#params = params;\n\n\t\tthis.#params.taskId = this.#params.taskId || Text.getRandom();\n\t}\n\n\tasync mountCard(slider: Slider): Promise<void>\n\t{\n\t\tif (!slider.isOpen())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.#slider = slider;\n\n\t\tthis.#subscribe();\n\n\t\tthis.#application = await this.#mountApplication(slider.getContentContainer());\n\t}\n\n\tunmountCard(): void\n\t{\n\t\tthis.#unmountApplication();\n\n\t\tthis.#unsubscribe();\n\n\t\tif (this.#needToReloadGrid && BX.Tasks.Util)\n\t\t{\n\t\t\tconst id = this.#params.taskId;\n\t\t\tBX.Tasks.Util.fireGlobalTaskEvent('UPDATE', { ID: id }, { STAY_AT_PAGE: true }, { id });\n\t\t}\n\t}\n\n\tasync #mountApplication(container: HTMLElement): Promise<VueCreateAppResult>\n\t{\n\t\tawait Core.init();\n\n\t\tconst application = BitrixVue.createApp(App, {\n\t\t\t...this.#params,\n\t\t\tid: this.#params.taskId,\n\t\t});\n\n\t\tapplication.mixin(locMixin);\n\t\tapplication.use(Core.getStore());\n\t\tapplication.mount(container);\n\n\t\treturn application;\n\t}\n\n\t#unmountApplication(): void\n\t{\n\t\tthis.#application?.unmount();\n\t}\n\n\t#subscribe(): void\n\t{\n\t\tthis.#handlers = {\n\t\t\t[EventName.TaskUpdate]: this.#handleTaskUpdate,\n\t\t\t[EventName.CloseFullCard]: this.#onClose,\n\t\t\t[EventName.OpenFullCard]: this.#openFullCard,\n\t\t\t[EventName.OpenCompactCard]: this.#openCompactCard,\n\t\t\t[EventName.OpenGrid]: this.#openGrid,\n\t\t\t'BX.Main.Popup:onShow': this.#handlePopupShow,\n\t\t};\n\n\t\tObject.entries(this.#handlers).forEach(([event, handler]) => EventEmitter.subscribe(event, handler));\n\t}\n\n\t#unsubscribe(): void\n\t{\n\t\tObject.entries(this.#handlers).forEach(([event, handler]) => EventEmitter.unsubscribe(event, handler));\n\t}\n\n\t#handleTaskUpdate = (event: BaseEvent): void => {\n\t\tif (event.getData().id === this.#params.taskId)\n\t\t{\n\t\t\tconst fieldsForReloadGrid = new Set(['deadlineTs', 'responsibleId']);\n\t\t\tconst fields = Object.keys(event.getData());\n\t\t\tif (fields.some((field: string) => fieldsForReloadGrid.has(field)))\n\t\t\t{\n\t\t\t\tthis.#needToReloadGrid = true;\n\t\t\t}\n\t\t}\n\t};\n\n\t#onClose = (event: BaseEvent): void => {\n\t\tif (event.getData().taskId === this.#params.taskId)\n\t\t{\n\t\t\tthis.#slider.close();\n\t\t}\n\t};\n\n\t#openFullCard = async (baseEvent: BaseEvent): Promise<void> => {\n\t\tconst { TaskCard } = await Runtime.loadExtension('tasks.v2.application.task-card');\n\n\t\tconst params = baseEvent.getData();\n\n\t\tTaskCard.showFullCard(params);\n\t};\n\n\t#openCompactCard = async (baseEvent: BaseEvent): Promise<void> => {\n\t\tconst { TaskCard } = await Runtime.loadExtension('tasks.v2.application.task-card');\n\n\t\tconst params = baseEvent.getData();\n\n\t\tTaskCard.showCompactCard(params);\n\t};\n\n\t#openGrid = (baseEvent: BaseEvent): void => {\n\t\tconst { taskId, type } = baseEvent.getData();\n\t\tconst userId = Core.getParams().currentUserId;\n\n\t\tBX.SidePanel.Instance.open(`/company/personal/user/${userId}/tasks/?relationToId=${taskId}&relationType=${type}`);\n\t};\n\n\t#handlePopupShow = (event: BaseEvent): void => {\n\t\tconst popup: Popup = event.getCompatData()[0];\n\t\tif (popup.getTargetContainer() !== document.body)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst onScroll = () => popup.adjustPosition();\n\t\tconst onClose = () => {\n\t\t\tpopup.unsubscribe('onClose', onClose);\n\t\t\tpopup.unsubscribe('onDestroy', onClose);\n\t\t\tEvent.unbind(document, 'scroll', onScroll, true);\n\t\t};\n\n\t\tpopup.subscribe('onClose', onClose);\n\t\tpopup.subscribe('onDestroy', onClose);\n\t\tEvent.bind(document, 'scroll', onScroll, true);\n\t};\n}\n"],"names":["MENU_SECTION_PERSONAL","MENU_SECTION_TASKS","MENU_SECTION_COPY","MENU_SECTION_LINKS","BurgerMenu","name","components","BIcon","BMenu","props","taskId","type","Number","String","required","setup","Outline","userRights","Core","getParams","rights","data","isMenuShown","computed","mapGetters","currentUserId","Model","Interface","task","$store","getters","Tasks","menuOptions","id","bindElement","$refs","button","$el","sections","code","items","menuItems","actionsMenuItems","favorite","push","getToggleFavoriteItem","watch","getBecomeAuditorItem","mute","getToggleMuteItem","tasks","create","getCreateNewTaskItem","createSubtask","getCreateSubtaskItem","copy","getCreateDuplicateTaskItem","createFromTemplate","getCreateNewTaskWithTemplateItem","saveAsTemplate","getCreateTemplateFromTaskItem","getCopyTaskIdItem","getGoToBitrixMarketItem","robot","getGoToRobotsItem","methods","getNotificationLayoutWithTitle","title","text","Tag","render","handleClickOpener","isTurningOn","inFavorite","includes","sectionCode","loc","icon","FAVORITE","NON_FAVORITE","onClick","isSuccess","taskService","addFavorite","BX","UI","Notification","Center","notify","content","removeFavorite","auditorsIdsCurrent","auditorsIds","isBecomingAuditor","OBSERVER","CROSSED_EYE","setAuditors","filter","auditorId","isMuting","inMute","SOUND_OFF","SOUND_ON","muteTask","unmuteTask","TASK","TaskCard","showCompactCard","RELATED_TASKS","parentId","DUPLICATE","CHEVRON_RIGHT_L","TEMPLATE_TASK","COPY","isCopyingSuccess","clipboard","uiButtonOptions","MARKET","size","ButtonSize","SMALL","useAirDesign","style","AirButtonStyle","OUTLINE","wide","disabled","onclick","rest","Marketplace","open","PLACEMENT","ROBOT","SidePanel","Instance","Loc","getMessage","groupId","cacheable","customLeftBoundary","loader","template","TaskHeader","TitleField","Importance","isEdit","Type","isNumber","Chat","isInteger","openChat","mounted","app","bitrixVue","unmount","Messenger","initApplication","mount","rootContainer","chatId","chatType","mountPlaceholder","EventEmitter","emit","userCounter","Chips","Chip","chips","Array","ChipDesign","chipsCollapsed","heightTransition","animate","updated","FooterCreate","UiButton","AddTaskButton","emits","isTemplateEnabled","features","close","Event","EventName","CloseFullCard","More","preselected","responsibleId","isCreator","creatorId","isResponsible","statuses","TaskStatus","Pending","getCompleteItem","getDefferItem","getDelegateItem","getDeleteItem","InProgress","getPauseItem","Deferred","SupposedlyCompleted","getFixItem","getDisapproveItem","Completed","getRenewItem","status","true","handleClick","defer","PAUSE_L","statusService","pause","STOP_L","renew","UNDO","disapprove","complete","SENDED","delegate","DELEGATE","onItemChangeDebounced","Runtime","debounce","handleDelegateSelect","dialog","EntitySelectorDialog","responsibleMeta","dialogOptions","$options","preselectedItems","events","selectItemsByIds","showTo","getSelectedItems","getId","update","remove","design","MenuItemDesign","Alert","TRASHCAN","delete","FooterEdit","ButtonIcon","statusButton","getCompleteButton","getStartButton","getRenewButton","getReviewButton","getApproveButton","PLAIN","start","approve","App","DescriptionField","DescriptionSheet","Files","FilesSheet","CheckList","DatePlan","DatePlanSheet","SubTasks","ParentTask","RelatedTasks","FieldList","DropZone","provide","analytics","cardType","CardType","Full","default","Text","getRandom","Object","filesMeta","datePlanMeta","checkListMeta","subTasksMeta","parentTaskMeta","relatedTasksMeta","resizeObserver","isFilesSheetShown","isDescriptionSheetShown","isCheckListSheetShown","isDatePlanSheetShown","checkListId","files","fileService","get","getFiles","checkLists","checklist","isPartiallyLoaded","fields","creatorMeta","component","Creator","context","selectorWithActionMenu","Responsible","deadlineMeta","Deadline","statusMeta","Status","withSeparator","chip","FilesChip","CheckListChip","showCheckList","openCheckList","groupMeta","getTitle","Group","GroupChip","isEnabled","isProjectsEnabled","accomplicesMeta","Accomplices","AccomplicesChip","auditorsMeta","Auditors","AuditorsChip","wasFilled","flowMeta","Flow","FlowChip","isFlowEnabled","tagsMeta","Tags","TagsChip","crmMeta","Crm","CrmChip","collapsed","ParentTaskChip","SubTasksChip","RelatedTasksChip","DatePlanChip","openDatePlan","forEach","field","primaryFields","Set","has","projectFields","add","participantsFields","tagsFields","map","isBottomSheetShown","$nextTick","tryStartObserver","created","dispatch","getById","list","fileIds","descriptionTextEditor","description","skeleton","append","FullSkeleton","beforeUnmount","disconnect","unmounted","fieldId","getObserver","observe","ResizeObserver","entries","entry","target","contentRect","height","addTask","save","length","checkListService","replace","openEditor","handleShowBottomSheet","closeEditor","slot","handleCloseBottomSheet","openFiles","closeFiles","closeCheckList","closeDatePlan","Dom","addClass","scrollContent","removeClass","TaskFullCard","constructor","params","event","getData","fieldsForReloadGrid","keys","some","baseEvent","loadExtension","showFullCard","userId","popup","getCompatData","getTargetContainer","document","body","onScroll","adjustPosition","onClose","unsubscribe","unbind","subscribe","bind","mountCard","slider","isOpen","getContentContainer","unmountCard","Util","fireGlobalTaskEvent","ID","STAY_AT_PAGE","container","init","application","BitrixVue","createApp","mixin","locMixin","use","getStore","TaskUpdate","OpenFullCard","OpenCompactCard","OpenGrid","handler"],"mappings":"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"}