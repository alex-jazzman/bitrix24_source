{"version":3,"file":"task-compact-card.bundle.js","sources":["../src/component/full-card-button/full-card-button.js","../src/component/app.js","../src/task-compact-card.js"],"sourcesContent":["import { Event } from 'main.core';\nimport { Button as UiButton, AirButtonStyle, ButtonSize } from 'ui.vue3.components.button';\n\nimport { Core } from 'tasks.v2.core';\nimport { EventName, Model, Option, TaskField } from 'tasks.v2.const';\nimport { Hint } from 'tasks.v2.component.elements.hint';\nimport { fieldHighlighter } from 'tasks.v2.lib.field-highlighter';\nimport { analytics } from 'tasks.v2.lib.analytics';\nimport { ahaMoments } from 'tasks.v2.lib.aha-moments';\nimport { EntityTypes, fileService } from 'tasks.v2.provider.service.file-service';\nimport type { TaskModel } from 'tasks.v2.model.tasks';\nimport type { CheckListModel } from 'tasks.v2.model.check-list';\n\nimport './full-card-button.css';\n\n// @vue/component\nexport const FullCardButton = {\n\tcomponents: {\n\t\tHint,\n\t\tUiButton,\n\t},\n\tinject: ['analytics'],\n\tprops: {\n\t\ttaskId: {\n\t\t\ttype: [Number, String],\n\t\t\trequired: true,\n\t\t},\n\t\tisOpening: {\n\t\t\ttype: Boolean,\n\t\t\trequired: true,\n\t\t},\n\t},\n\temits: ['update:isOpening'],\n\tsetup(props): Object\n\t{\n\t\treturn {\n\t\t\tAirButtonStyle,\n\t\t\tButtonSize,\n\t\t\tfileService: fileService.get(props.taskId),\n\t\t};\n\t},\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tisHintShown: false,\n\t\t\thintBindElement: null,\n\t\t\tshowAuditorsHint: false,\n\t\t\tauditorsHintBindElement: null,\n\t\t};\n\t},\n\tcomputed: {\n\t\ttask(): TaskModel\n\t\t{\n\t\t\treturn this.$store.getters[`${Model.Tasks}/getById`](this.taskId);\n\t\t},\n\t\tcheckLists(): CheckListModel[]\n\t\t{\n\t\t\treturn this.task?.checklist\n\t\t\t\t? this.$store.getters[`${Model.CheckList}/getByIds`](this.task.checklist)\n\t\t\t\t: [];\n\t\t},\n\t\tisDisabled(): boolean\n\t\t{\n\t\t\treturn this.isUploading || this.isCheckListUploading;\n\t\t},\n\t\tisUploading(): boolean\n\t\t{\n\t\t\treturn this.fileService.isUploading();\n\t\t},\n\t\tisCheckListUploading(): boolean\n\t\t{\n\t\t\treturn this.task.checklist?.some((itemId) => fileService.get(itemId, EntityTypes.CheckListItem).isUploading());\n\t\t},\n\t\thasAuditors(): boolean\n\t\t{\n\t\t\treturn Array.isArray(this.task?.auditorsIds) && this.task.auditorsIds.length > 0;\n\t\t},\n\t\tauditorsHintOptions(): Object\n\t\t{\n\t\t\treturn {\n\t\t\t\tcloseIcon: true,\n\t\t\t\toffsetLeft: -60,\n\t\t\t\tangle: {\n\t\t\t\t\toffset: 140,\n\t\t\t\t},\n\t\t\t\tbindOptions: {\n\t\t\t\t\tforceBindPosition: true,\n\t\t\t\t\tforceTop: true,\n\t\t\t\t\tposition: 'top',\n\t\t\t\t},\n\t\t\t};\n\t\t},\n\t},\n\tmounted()\n\t{\n\t\t// Show auditors hint if auditorsIds is not empty\n\t\tif (this.hasAuditors && ahaMoments.shouldShow(Option.AhaAuditorsInCompactFormPopup))\n\t\t{\n\t\t\tthis.$nextTick(() => {\n\t\t\t\t// Bind to the button element\n\t\t\t\tthis.auditorsHintBindElement = this.$refs.fullCardButtonContainer;\n\t\t\t\tthis.showAuditorsHint = true;\n\t\t\t});\n\t\t}\n\t},\n\tmethods: {\n\t\thandleClick(): void\n\t\t{\n\t\t\tif (this.isUploading)\n\t\t\t{\n\t\t\t\tthis.highlightFiles();\n\t\t\t}\n\t\t\telse if (this.isCheckListUploading)\n\t\t\t{\n\t\t\t\tthis.highlightChecklist();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.openFullCard();\n\t\t\t}\n\t\t},\n\t\thighlightFiles(): void\n\t\t{\n\t\t\tthis.hintBindElement = fieldHighlighter\n\t\t\t\t.setContainer(this.$root.$el)\n\t\t\t\t.addChipHighlight(TaskField.Files)\n\t\t\t\t.getChipContainer(TaskField.Files)\n\t\t\t;\n\n\t\t\tthis.showHint();\n\t\t},\n\t\thighlightChecklist(): void\n\t\t{\n\t\t\tthis.hintBindElement = fieldHighlighter\n\t\t\t\t.setContainer(this.$root.$el)\n\t\t\t\t.addChipHighlight(TaskField.CheckList)\n\t\t\t\t.getChipContainer(TaskField.CheckList)\n\t\t\t;\n\n\t\t\tthis.showHint();\n\t\t},\n\t\tshowHint(): void\n\t\t{\n\t\t\tconst removeHighlight = () => {\n\t\t\t\tthis.isHintShown = false;\n\t\t\t\tEvent.unbind(window, 'keydown', removeHighlight);\n\t\t\t};\n\t\t\tEvent.bind(window, 'keydown', removeHighlight);\n\n\t\t\tthis.isHintShown = true;\n\t\t},\n\t\topenFullCard(): void\n\t\t{\n\t\t\tif (this.isOpening)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.$emit('update:isOpening', true);\n\n\t\t\tconst features = Core.getParams().features;\n\t\t\tanalytics.sendOpenFullCard(this.analytics);\n\t\t\tif (features.isMiniformEnabled && !features.isV2Enabled)\n\t\t\t{\n\t\t\t\tEvent.EventEmitter.emit(`${EventName.OpenSliderCard}:${this.taskId}`, {\n\t\t\t\t\ttask: this.task,\n\t\t\t\t\tcheckLists: this.checkLists,\n\t\t\t\t});\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tEvent.EventEmitter.emit(`${EventName.OpenFullCard}:${this.taskId}`, this.taskId);\n\t\t\t}\n\t\t},\n\t\tcloseAuditorsHint()\n\t\t{\n\t\t\tthis.showAuditorsHint = false;\n\t\t},\n\t\thandleAuditorsHintLinkClick()\n\t\t{\n\t\t\tahaMoments.setShown(Option.AhaAuditorsInCompactFormPopup);\n\t\t\tthis.closeAuditorsHint();\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div\n\t\t\tref=\"fullCardButtonContainer\"\n\t\t\tclass=\"tasks-compact-card-full-button-container\"\n\t\t\t:class=\"{ '--disabled': isDisabled }\"\n\t\t\t@click=\"handleClick\"\n\t\t>\n\t\t\t<UiButton\n\t\t\t\tclass=\"tasks-compact-card-full-button\"\n\t\t\t\t:text=\"loc('TASKS_V2_TCC_FULL_CARD_BTN')\"\n\t\t\t\t:size=\"ButtonSize.SMALL\"\n\t\t\t\t:style=\"AirButtonStyle.PLAIN_NO_ACCENT\"\n\t\t\t\t:loading=\"isOpening\"\n\t\t\t\t:dataset=\"{taskButtonId: 'full'}\"\n\t\t\t\t:disabled=\"isDisabled\"\n\t\t\t/>\n\t\t\t<Hint\n\t\t\t\tv-if=\"showAuditorsHint\"\n\t\t\t\t:bindElement=\"auditorsHintBindElement\"\n\t\t\t\t@close=\"closeAuditorsHint\"\n\t\t\t\t:options=\"auditorsHintOptions\"\n\t\t\t>\n\t\t\t\t<div class=\"tasks-compact-card-full-button-auditors-hint\">\n\t\t\t\t\t<div class=\"tasks-compact-card-full-button-auditors-hint-title\">\n\t\t\t\t\t\t{{ loc('TASKS_V2_TCC_AUDITORS_HINT_TITLE') }}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"tasks-compact-card-full-button-auditors-hint-content\">\n\t\t\t\t\t\t{{ loc('TASKS_V2_TCC_AUDITORS_HINT_CONTENT') }}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div\n\t\t\t\t\t\tclass=\"tasks-compact-card-full-button-auditors-hint-link\"\n\t\t\t\t\t\t@click.stop=\"handleAuditorsHintLinkClick\"\n\t\t\t\t\t>\n\t\t\t\t\t\t{{ loc('TASKS_V2_TCC_AUDITORS_HINT_DO_NOT_SHOW_AGAIN') }}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</Hint>\n\t\t</div>\n\t\t<Hint\n\t\t\tv-if=\"isHintShown\"\n\t\t\t:bindElement=\"hintBindElement\"\n\t\t\t@close=\"isHintShown = false\"\n\t\t>\n\t\t\t{{ loc('TASKS_V2_TCC_FILE_IS_UPLOADING') }}\n\t\t</Hint>\n\t`,\n};\n","import { Event, Text, Type } from 'main.core';\nimport { EventEmitter, BaseEvent } from 'main.core.events';\nimport { Popup } from 'main.popup';\n\nimport { mapActions, mapGetters } from 'ui.vue3.vuex';\nimport { Notifier } from 'ui.notification-manager';\nimport { DragOverMixin } from 'ui.uploader.tile-widget';\nimport { Button as UiButton, AirButtonStyle, ButtonSize } from 'ui.vue3.components.button';\nimport { BIcon } from 'ui.icon-set.api.vue';\nimport { Outline } from 'ui.icon-set.api.core';\nimport 'ui.icon-set.outline';\n\nimport { Core } from 'tasks.v2.core';\nimport { EventName, Model, CardType, GroupType } from 'tasks.v2.const';\nimport { AddTaskButton } from 'tasks.v2.component.add-task-button';\nimport { Title as FieldTitle } from 'tasks.v2.component.fields.title';\nimport { Importance } from 'tasks.v2.component.fields.importance';\nimport { DescriptionInline } from 'tasks.v2.component.fields.description';\nimport { FieldList } from 'tasks.v2.component.elements.field-list';\nimport { DropZone } from 'tasks.v2.component.drop-zone';\nimport { Responsible, responsibleMeta } from 'tasks.v2.component.fields.responsible';\nimport { Deadline, deadlineMeta } from 'tasks.v2.component.fields.deadline';\nimport { CheckListChip, CheckList } from 'tasks.v2.component.fields.check-list';\nimport { FilesChip } from 'tasks.v2.component.fields.files';\nimport { GroupChip } from 'tasks.v2.component.fields.group';\nimport { analytics } from 'tasks.v2.lib.analytics';\nimport { fileService } from 'tasks.v2.provider.service.file-service';\nimport { taskService } from 'tasks.v2.provider.service.task-service';\nimport { checkListService } from 'tasks.v2.provider.service.check-list-service';\nimport type { TaskModel } from 'tasks.v2.model.tasks';\nimport type { GroupModel } from 'tasks.v2.model.groups';\nimport type { CheckListModel } from 'tasks.v2.model.check-list';\n\nimport { FullCardButton } from './full-card-button/full-card-button';\nimport './app.css';\n\n// @vue/component\nexport const App = {\n\tname: 'TaskCompactCard',\n\tcomponents: {\n\t\tBIcon,\n\t\tFieldTitle,\n\t\tDescriptionInline,\n\t\tImportance,\n\t\tFieldList,\n\t\tUiButton,\n\t\tAddTaskButton,\n\t\tCheckList,\n\t\tFullCardButton,\n\t\tDropZone,\n\t},\n\tmixins: [DragOverMixin],\n\tprovide(): Object\n\t{\n\t\treturn {\n\t\t\tanalytics: this.analytics,\n\t\t\tcardType: CardType.Compact,\n\t\t};\n\t},\n\tprops: {\n\t\ttaskId: {\n\t\t\ttype: [Number, String],\n\t\t\tdefault: () => Text.getRandom(),\n\t\t},\n\t\tgroupId: {\n\t\t\ttype: [Number],\n\t\t\tdefault: null,\n\t\t},\n\t\tparentId: {\n\t\t\ttype: [Number],\n\t\t\tdefault: null,\n\t\t},\n\t\trelatedToTaskId: {\n\t\t\ttype: [Number],\n\t\t\tdefault: null,\n\t\t},\n\t\tdeadlineTs: {\n\t\t\ttype: [Number, null],\n\t\t\tdefault: null,\n\t\t},\n\t\ttitle: {\n\t\t\ttype: [String, null],\n\t\t\tdefault: '',\n\t\t},\n\t\tdescription: {\n\t\t\ttype: [String, null],\n\t\t\tdefault: '',\n\t\t},\n\t\tauditorsIds: {\n\t\t\ttype: Array,\n\t\t\tdefault: () => [],\n\t\t},\n\t\tanalytics: {\n\t\t\ttype: Object,\n\t\t\tdefault: () => ({}),\n\t\t},\n\t\tsource: {\n\t\t\ttype: Object,\n\t\t\tdefault: () => ({}),\n\t\t},\n\t},\n\tsetup(): Object\n\t{\n\t\treturn {\n\t\t\tButtonSize,\n\t\t\tAirButtonStyle,\n\t\t\tOutline,\n\t\t};\n\t},\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\topeningFullCard: false,\n\t\t\tisCheckListPopupShown: false,\n\t\t\tchipsEventHandlers: {\n\t\t\t\tshowCheckList: this.showCheckListPopup,\n\t\t\t},\n\t\t\tcreationError: false,\n\t\t\tpopupCount: 0,\n\t\t};\n\t},\n\tcomputed: {\n\t\t...mapGetters({\n\t\t\ttitleFieldOffsetHeight: `${Model.Interface}/titleFieldOffsetHeight`,\n\t\t\tcurrentUserId: `${Model.Interface}/currentUserId`,\n\t\t\tdefaultDeadline: `${Model.Interface}/defaultDeadline`,\n\t\t}),\n\t\thasDefaultDeadline(): boolean\n\t\t{\n\t\t\treturn this.defaultDeadline.defaultDeadlineDate !== '';\n\t\t},\n\t\tdefaultDeadlineTs(): number\n\t\t{\n\t\t\treturn new Date(this.defaultDeadline.defaultDeadlineDate).getTime();\n\t\t},\n\t\ttask(): TaskModel\n\t\t{\n\t\t\treturn this.$store.getters[`${Model.Tasks}/getById`](this.taskId);\n\t\t},\n\t\tgroup(): GroupModel\n\t\t{\n\t\t\treturn this.$store.getters[`${Model.Groups}/getById`](this.task.groupId);\n\t\t},\n\t\tcheckLists(): CheckListModel[]\n\t\t{\n\t\t\treturn this.task?.checklist\n\t\t\t\t? this.$store.getters[`${Model.CheckList}/getByIds`](this.task.checklist)\n\t\t\t\t: [];\n\t\t},\n\t\tisEdit(): boolean\n\t\t{\n\t\t\treturn Type.isNumber(this.taskId) && this.taskId > 0;\n\t\t},\n\t\tprimaryFields(): Object[]\n\t\t{\n\t\t\treturn [\n\t\t\t\t{\n\t\t\t\t\ttitle: responsibleMeta.title,\n\t\t\t\t\tcomponent: Responsible,\n\t\t\t\t\tprops: {\n\t\t\t\t\t\ttaskId: this.taskId,\n\t\t\t\t\t\tcontext: this.$options.name,\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\ttitle: deadlineMeta.title,\n\t\t\t\t\tcomponent: Deadline,\n\t\t\t\t\tprops: {\n\t\t\t\t\t\ttaskId: this.taskId,\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t];\n\t\t},\n\t\tchips(): Object[]\n\t\t{\n\t\t\treturn [\n\t\t\t\tFilesChip,\n\t\t\t\tCheckListChip,\n\t\t\t\t...(Core.getParams().features.isProjectsEnabled ? [GroupChip] : []),\n\t\t\t];\n\t\t},\n\t},\n\tcreated(): void\n\t{\n\t\tif (!this.isEdit)\n\t\t{\n\t\t\tthis.destroy();\n\n\t\t\tconst payload = {\n\t\t\t\tid: this.taskId,\n\t\t\t\tcreatorId: this.currentUserId,\n\t\t\t\tresponsibleId: this.currentUserId,\n\t\t\t\t...(this.groupId ? { groupId: this.groupId } : {}),\n\t\t\t\t...(this.title ? { title: this.title } : ''),\n\t\t\t\t...(this.description ? { description: this.description } : ''),\n\t\t\t\t...(this.auditorsIds ? { auditorsIds: this.auditorsIds } : []),\n\t\t\t\t...(this.parentId ? { parentId: this.parentId } : {}),\n\t\t\t\t...(this.relatedToTaskId ? { relatedToTaskId: this.relatedToTaskId } : {}),\n\t\t\t\t...(this.source ? { source: this.source } : {}),\n\t\t\t};\n\n\t\t\tif (this.deadlineTs !== null)\n\t\t\t{\n\t\t\t\tpayload.deadlineTs = this.deadlineTs;\n\t\t\t}\n\t\t\telse if (this.hasDefaultDeadline)\n\t\t\t{\n\t\t\t\tpayload.deadlineTs = this.defaultDeadlineTs;\n\t\t\t}\n\n\t\t\tif (this.auditorsIds !== null && this.auditorsIds.length > 0)\n\t\t\t{\n\t\t\t\tthis.auditorsIds.forEach((auditorId) => {\n\t\t\t\t\tthis.insertUser({\n\t\t\t\t\t\tid: auditorId,\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tthis.insert(payload);\n\t\t}\n\n\t\tthis.fileService = fileService.get(this.taskId);\n\n\t\tanalytics.sendOpenCard(this.analytics, {\n\t\t\tcollabId: this.group?.type === GroupType.Collab ? this.group.id : null,\n\t\t});\n\t},\n\tmounted(): void\n\t{\n\t\tthis.resizeObserver = new ResizeObserver(async (entries) => {\n\t\t\tconst title = entries.find(({ target }) => target === this.$refs.title);\n\t\t\tif (title)\n\t\t\t{\n\t\t\t\tawait this.updateTitleFieldOffsetHeight(title.contentRect.height);\n\t\t\t}\n\t\t});\n\n\t\tthis.resizeObserver.observe(this.$refs.title);\n\t\tthis.subscribeEvents();\n\t},\n\tbeforeUnmount(): void\n\t{\n\t\tif (this.resizeObserver)\n\t\t{\n\t\t\tthis.resizeObserver.disconnect();\n\t\t}\n\t\tthis.unsubscribeEvents();\n\t},\n\tunmounted(): void\n\t{\n\t\tif (!this.isEdit && this.openingFullCard === false)\n\t\t{\n\t\t\tthis.destroy();\n\t\t}\n\t},\n\tmethods: {\n\t\t...mapActions(Model.Tasks, [\n\t\t\t'insert',\n\t\t\t'delete',\n\t\t]),\n\t\t...mapActions(Model.Interface, [\n\t\t\t'updateTitleFieldOffsetHeight',\n\t\t]),\n\t\t...mapActions(Model.Users, {\n\t\t\tinsertUser: 'insert',\n\t\t}),\n\t\tclose(): void\n\t\t{\n\t\t\tEvent.EventEmitter.emit(`${EventName.CloseCard}:${this.taskId}`);\n\t\t},\n\t\tasync addTask(): void\n\t\t{\n\t\t\tconst [id, error] = await taskService.add(this.task);\n\n\t\t\tif (!id)\n\t\t\t{\n\t\t\t\tthis.creationError = true;\n\n\t\t\t\tNotifier.notifyViaBrowserProvider({\n\t\t\t\t\tid: 'task-notify-add-error',\n\t\t\t\t\ttext: error.message,\n\t\t\t\t});\n\n\t\t\t\tthis.sendAddTaskAnalytics(false);\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.sendAddTaskAnalytics(true);\n\n\t\t\tanalytics.sendDescription(this.analytics, {\n\t\t\t\thasDescription: Type.isStringFilled(this.task?.description),\n\t\t\t\thasScroll: this.$refs?.description?.hasScroll(),\n\t\t\t});\n\n\t\t\tif (this.checkLists.length > 0)\n\t\t\t{\n\t\t\t\tawait checkListService.save(id, this.checkLists);\n\t\t\t}\n\n\t\t\tfileService.replace(this.taskId, id);\n\n\t\t\tconst baseEvent = new BaseEvent({\n\t\t\t\tdata: id,\n\t\t\t\tcompatData: [\n\t\t\t\t\t'ADD',\n\t\t\t\t\t{\n\t\t\t\t\t\ttask: this.task,\n\t\t\t\t\t\toptions: {},\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t});\n\n\t\t\tEvent.EventEmitter.emit(EventName.NotifyGrid, baseEvent);\n\n\t\t\tconst features = Core.getParams().features;\n\t\t\tif (features.isMiniformEnabled && !features.isV2Enabled)\n\t\t\t{\n\t\t\t\tthis.close();\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.close();\n\t\t},\n\t\tsendAddTaskAnalytics(isSuccess: boolean): void\n\t\t{\n\t\t\tconst collabId = this.group?.type === GroupType.Collab ? this.group.id : null;\n\t\t\tif (this.checkLists.length > 0)\n\t\t\t{\n\t\t\t\tconst checkLists = this.checkLists.filter(({ parentId }) => parentId === 0);\n\t\t\t\tconst checkListsItems = this.checkLists.filter(({ parentId }) => parentId !== 0);\n\t\t\t\tanalytics.sendAddTaskWithCheckList(this.analytics, {\n\t\t\t\t\tisSuccess,\n\t\t\t\t\tcollabId,\n\t\t\t\t\tviewersCount: this.task.auditorsIds.length,\n\t\t\t\t\tchecklistCount: checkLists.length,\n\t\t\t\t\tchecklistItemsCount: checkListsItems.length,\n\t\t\t\t});\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tanalytics.sendAddTask(this.analytics, {\n\t\t\t\t\tisSuccess,\n\t\t\t\t\tcollabId,\n\t\t\t\t\tviewersCount: this.task.auditorsIds.length,\n\t\t\t\t\tcoexecutorsCount: this.task.accomplicesIds.length,\n\t\t\t\t});\n\t\t\t}\n\t\t},\n\t\thandleShowingPopup(event: BaseEvent): void\n\t\t{\n\t\t\tEvent.EventEmitter.emit(`${EventName.ShowOverlay}:${this.taskId}`);\n\t\t\tEvent.EventEmitter.emit(`${EventName.AdjustPosition}:${this.taskId}`);\n\t\t\tthis.externalPopup = event.popupInstance;\n\t\t\tthis.adjustCardPopup(true);\n\t\t},\n\t\thandleHidingPopup(): void\n\t\t{\n\t\t\tEvent.EventEmitter.emit(`${EventName.HideOverlay}:${this.taskId}`);\n\t\t\tEvent.EventEmitter.emit(`${EventName.AdjustPosition}:${this.taskId}`);\n\t\t\tthis.externalPopup = null;\n\t\t},\n\t\thandleResizingPopup(): void\n\t\t{\n\t\t\tthis.adjustCardPopup();\n\t\t},\n\t\tadjustCardPopup(animate: boolean = false): void\n\t\t{\n\t\t\tif (!this.externalPopup)\n\t\t\t{\n\t\t\t\tEvent.EventEmitter.emit(`${EventName.AdjustPosition}:${this.taskId}`);\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tEvent.EventEmitter.emit(`${EventName.AdjustPosition}:${this.taskId}`, {\n\t\t\t\ttitleFieldHeight: this.titleFieldOffsetHeight,\n\t\t\t\tinnerPopup: this.externalPopup,\n\t\t\t\tanimate,\n\t\t\t});\n\t\t},\n\t\tshowCheckListPopup(): void\n\t\t{\n\t\t\tthis.isCheckListPopupShown = true;\n\t\t},\n\t\tcloseCheckListPopup(): void\n\t\t{\n\t\t\tthis.isCheckListPopupShown = false;\n\t\t},\n\t\tgetEventListeners(chip, handlers): Object\n\t\t{\n\t\t\tconst listeners = {};\n\n\t\t\tif (chip.emits)\n\t\t\t{\n\t\t\t\tObject.keys(handlers).forEach((event: string) => {\n\t\t\t\t\tif (chip.emits.includes(event))\n\t\t\t\t\t{\n\t\t\t\t\t\tlisteners[event] = handlers[event];\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\n\t\t\treturn listeners;\n\t\t},\n\t\tsubscribeEvents(): void\n\t\t{\n\t\t\tEventEmitter.subscribe('BX.Main.Popup:onShow', this.handlePopupShow);\n\t\t\tEvent.bind(document, 'keydown', this.handleKeyDown, { capture: true });\n\t\t},\n\t\tunsubscribeEvents(): void\n\t\t{\n\t\t\tEventEmitter.unsubscribe('BX.Main.Popup:onShow', this.handlePopupShow);\n\t\t\tEvent.unbind(document, 'keydown', this.handleKeyDown, { capture: true });\n\t\t},\n\t\thandlePopupShow(event): void\n\t\t{\n\t\t\tconst popup: Popup = event.getCompatData()[0];\n\n\t\t\tconst onClose = (): void => {\n\t\t\t\tpopup.unsubscribe('onClose', onClose);\n\t\t\t\tpopup.unsubscribe('onDestroy', onClose);\n\n\t\t\t\tthis.popupCount--;\n\t\t\t};\n\n\t\t\tpopup.subscribe('onClose', onClose);\n\t\t\tpopup.subscribe('onDestroy', onClose);\n\n\t\t\tthis.popupCount++;\n\t\t},\n\t\thandleKeyDown(event: KeyboardEvent): void\n\t\t{\n\t\t\tif (this.popupCount > 0)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (event.key === 'Enter' && (event.ctrlKey || event.metaKey))\n\t\t\t{\n\t\t\t\tthis.$refs.addTaskButton.handleClick();\n\t\t\t}\n\t\t\telse if (event.key === 'Escape')\n\t\t\t{\n\t\t\t\tthis.close();\n\t\t\t}\n\t\t},\n\t\tdestroy(): void\n\t\t{\n\t\t\tthis.delete(this.taskId);\n\t\t\tfileService.delete(this.taskId);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div v-drop class=\"tasks-compact-card-container\">\n\t\t\t<div v-if=\"task\" class=\"tasks-compact-card\" :data-task-id=\"taskId\" data-task-compact>\n\t\t\t\t<div class=\"tasks-compact-card-fields\">\n\t\t\t\t\t<div\n\t\t\t\t\t\tclass=\"tasks-compact-card-fields-title\"\n\t\t\t\t\t\t:class=\"{'--no-gap': task.description.length > 0}\"\n\t\t\t\t\t\tref=\"title\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<FieldTitle :taskId=\"taskId\" :disabled=\"isCheckListPopupShown\"/>\n\t\t\t\t\t\t<Importance :taskId=\"taskId\"/>\n\t\t\t\t\t\t<BIcon\n\t\t\t\t\t\t\tclass=\"tasks-compact-card-fields-close\"\n\t\t\t\t\t\t\t:name=\"Outline.CROSS_L\"\n\t\t\t\t\t\t\tdata-task-button-id=\"close\"\n\t\t\t\t\t\t\t@click=\"close\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t\t<DescriptionInline ref=\"description\" :taskId=\"taskId\"/>\n\t\t\t\t\t<div class=\"tasks-compact-card-fields-list\">\n\t\t\t\t\t\t<FieldList :fields=\"primaryFields\"/>\n\t\t\t\t\t</div>\n\t\t\t\t\t<CheckList\n\t\t\t\t\t\tv-if=\"isCheckListPopupShown\"\n\t\t\t\t\t\t:taskId=\"taskId\"\n\t\t\t\t\t\t:isAutonomous=\"true\"\n\t\t\t\t\t\t@show=\"handleShowingPopup\"\n\t\t\t\t\t\t@close=\"handleHidingPopup(); closeCheckListPopup();\"\n\t\t\t\t\t\t@resize=\"handleResizingPopup\"\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"tasks-compact-card-footer\">\n\t\t\t\t\t<div class=\"tasks-compact-card-chips\">\n\t\t\t\t\t\t<template v-for=\"(chip, index) of chips\" :key=\"index\">\n\t\t\t\t\t\t\t<component\n\t\t\t\t\t\t\t\t:is=\"chip\"\n\t\t\t\t\t\t\t\tv-bind=\"{ taskId, isAutonomous: true }\"\n\t\t\t\t\t\t\t\tv-on=\"getEventListeners(chip, chipsEventHandlers)\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</template>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"tasks-compact-card-buttons\">\n\t\t\t\t\t\t<div class=\"tasks-compact-card-main-buttons\">\n\t\t\t\t\t\t\t<AddTaskButton\n\t\t\t\t\t\t\t\tref=\"addTaskButton\"\n\t\t\t\t\t\t\t\t:taskId=\"taskId\"\n\t\t\t\t\t\t\t\t:size=\"ButtonSize.MEDIUM\"\n\t\t\t\t\t\t\t\tv-model:hasError=\"creationError\"\n\t\t\t\t\t\t\t\t@addTask=\"addTask\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t<UiButton\n\t\t\t\t\t\t\t\t:text=\"loc('TASKS_V2_TCC_CANCEL_BTN')\"\n\t\t\t\t\t\t\t\t:size=\"ButtonSize.MEDIUM\"\n\t\t\t\t\t\t\t\t:style=\"AirButtonStyle.PLAIN\"\n\t\t\t\t\t\t\t\t:dataset=\"{\n\t\t\t\t\t\t\t\t\ttaskButtonId: 'cancel',\n\t\t\t\t\t\t\t\t}\"\n\t\t\t\t\t\t\t\t@click=\"close\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<FullCardButton v-model:isOpening=\"openingFullCard\" :taskId=\"taskId\"/>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<DropZone v-if=\"!isCheckListPopupShown\" :taskId=\"taskId\" :bottom=\"18\"/>\n\t\t</div>\n\t`,\n};\n","import { Dom, Runtime, Tag, Text } from 'main.core';\nimport { EventEmitter, type BaseEvent } from 'main.core.events';\nimport type { Popup } from 'main.popup';\n\nimport { BitrixVue, type VueCreateAppResult } from 'ui.vue3';\nimport { locMixin } from 'ui.vue3.mixins.loc-mixin';\n\nimport { TaskMappers } from 'tasks.v2.provider.service.task-service';\nimport { Core } from 'tasks.v2.core';\nimport { EventName } from 'tasks.v2.const';\nimport type { Params } from 'tasks.v2.application.task-card';\n\nimport { App } from './component/app';\n\nexport class TaskCompactCard\n{\n\t#params: Params;\n\t#popup: Popup;\n\t#application: ?VueCreateAppResult;\n\t#handlers: { [eventName: string]: Function };\n\n\tconstructor(params: Params = {})\n\t{\n\t\tthis.#params = params;\n\n\t\tthis.#params.taskId = this.#params.taskId || Text.getRandom();\n\t}\n\n\tasync mountCard(popup: Popup): Promise<void>\n\t{\n\t\tthis.#popup = popup;\n\n\t\tawait this.#mountApplication(popup.getContentContainer());\n\n\t\tthis.#adjustPosition();\n\t\tthis.#subscribe();\n\n\t\tconst dragHandle = Tag.render`<div class=\"tasks-compact-card-popup-drag-handle\"></div>`;\n\t\tDom.append(dragHandle, popup.getContentContainer());\n\t\tthis.#popup.setDraggable({\n\t\t\telement: dragHandle,\n\t\t\trestrict: true,\n\t\t});\n\t}\n\n\tunmountCard(): void\n\t{\n\t\tthis.#unmountApplication();\n\n\t\tthis.#unsubscribe();\n\t}\n\n\tasync #mountApplication(container: HTMLElement): Promise<void>\n\t{\n\t\tawait Core.init();\n\n\t\tconst application = BitrixVue.createApp(App, this.#params);\n\n\t\tapplication.mixin(locMixin);\n\t\tapplication.use(Core.getStore());\n\t\tapplication.mount(container);\n\n\t\tthis.#application = application;\n\t}\n\n\t#unmountApplication(): void\n\t{\n\t\tthis.#application.unmount();\n\t}\n\n\t#subscribe(): void\n\t{\n\t\tthis.#handlers = {\n\t\t\t[`${EventName.CloseCard}:${this.#params.taskId}`]: this.#closeCard,\n\t\t\t[`${EventName.OpenFullCard}:${this.#params.taskId}`]: this.#openFullCard,\n\t\t\t[`${EventName.OpenSliderCard}:${this.#params.taskId}`]: this.#openSliderCard,\n\t\t\t[`${EventName.ShowOverlay}:${this.#params.taskId}`]: this.#showOverlay,\n\t\t\t[`${EventName.HideOverlay}:${this.#params.taskId}`]: this.#hideOverlay,\n\t\t\t[`${EventName.AdjustPosition}:${this.#params.taskId}`]: this.#handleAdjustPosition,\n\t\t\t'BX.Main.Popup:onShow': this.#handlePopupShow,\n\t\t};\n\n\t\tObject.entries(this.#handlers).forEach(([event, handler]) => EventEmitter.subscribe(event, handler));\n\t}\n\n\t#unsubscribe(): void\n\t{\n\t\tObject.entries(this.#handlers).forEach(([event, handler]) => EventEmitter.unsubscribe(event, handler));\n\t}\n\n\t#openFullCard = async (baseEvent: BaseEvent): Promise<void> => {\n\t\tthis.#closeCard();\n\n\t\tconst { TaskCard } = await Runtime.loadExtension('tasks.v2.application.task-card');\n\n\t\tthis.#params.taskId = baseEvent.getData();\n\n\t\tTaskCard.showFullCard(this.#params);\n\t};\n\n\t#openSliderCard = (baseEvent: BaseEvent): void => {\n\t\tconst task = baseEvent.getData().task;\n\t\tconst checkLists = baseEvent.getData().checkLists;\n\n\t\tconst data = TaskMappers.mapModelToSliderData(task, checkLists);\n\n\t\tconst path = Core.getParams().paths.editPath;\n\t\tBX.SidePanel.Instance.open(path, {\n\t\t\trequestMethod: 'post',\n\t\t\trequestParams: data,\n\t\t\tcacheable: false,\n\t\t});\n\n\t\tthis.#closeCard();\n\t};\n\n\t#closeCard = (): void => {\n\t\tthis.#popup.close();\n\t};\n\n\t#showOverlay = (): void => {\n\t\tDom.addClass(this.#popup.getPopupContainer(), '--overlay');\n\t};\n\n\t#hideOverlay = (): void => {\n\t\tDom.removeClass(this.#popup.getPopupContainer(), '--overlay');\n\t};\n\n\t#handleAdjustPosition = (baseEvent?: BaseEvent): void => {\n\t\tconst { innerPopup, titleFieldHeight, animate } = baseEvent?.getData() ?? {};\n\t\tif (!innerPopup)\n\t\t{\n\t\t\tthis.#popup.setOffset({\n\t\t\t\toffsetTop: 0,\n\t\t\t});\n\t\t\tthis.#adjustPosition();\n\n\t\t\treturn;\n\t\t}\n\n\t\tconst innerPopupContainer = innerPopup.getPopupContainer();\n\t\tconst popupContainer = this.#popup.getPopupContainer();\n\n\t\tconst heightDifference = innerPopupContainer.offsetHeight - popupContainer.offsetHeight;\n\t\tconst popupPaddingTop = 20;\n\t\tconst offset = titleFieldHeight + heightDifference / 2 + popupPaddingTop * 2;\n\n\t\tDom.style(popupContainer, '--overlay-offset-top', `-${offset}px`);\n\t\tif (!animate)\n\t\t{\n\t\t\tthis.#adjustPosition();\n\t\t\tDom.style(popupContainer, 'transition', 'none');\n\t\t\tsetTimeout(() => Dom.style(popupContainer, 'transition', null));\n\t\t}\n\t};\n\n\t#adjustPosition(): void\n\t{\n\t\tthis.#popup.adjustPosition({\n\t\t\tforceBindPosition: true,\n\t\t});\n\t}\n\n\t#handlePopupShow = (event): void => {\n\t\tthis.#handlePopupShow.openedPopupsCount ??= 0;\n\n\t\tconst popup: Popup = event.getCompatData()[0];\n\t\tconst popupContainer = this.#popup.getPopupContainer();\n\n\t\tconst onClose = (): void => {\n\t\t\tpopup.unsubscribe('onClose', onClose);\n\t\t\tpopup.unsubscribe('onDestroy', onClose);\n\n\t\t\tthis.#handlePopupShow.openedPopupsCount--;\n\t\t\tif (this.#handlePopupShow.openedPopupsCount === 0)\n\t\t\t{\n\t\t\t\tDom.removeClass(popupContainer, '--disable-drag');\n\t\t\t}\n\t\t};\n\n\t\tpopup.subscribe('onClose', onClose);\n\t\tpopup.subscribe('onDestroy', onClose);\n\n\t\tthis.#handlePopupShow.openedPopupsCount++;\n\t\tDom.addClass(popupContainer, '--disable-drag');\n\t};\n}\n"],"names":["FullCardButton","components","Hint","UiButton","inject","props","taskId","type","Number","String","required","isOpening","Boolean","emits","setup","AirButtonStyle","ButtonSize","fileService","get","data","isHintShown","hintBindElement","showAuditorsHint","auditorsHintBindElement","computed","task","$store","getters","Model","Tasks","checkLists","checklist","CheckList","isDisabled","isUploading","isCheckListUploading","some","itemId","EntityTypes","CheckListItem","hasAuditors","Array","isArray","auditorsIds","length","auditorsHintOptions","closeIcon","offsetLeft","angle","offset","bindOptions","forceBindPosition","forceTop","position","mounted","ahaMoments","shouldShow","Option","AhaAuditorsInCompactFormPopup","$nextTick","$refs","fullCardButtonContainer","methods","handleClick","highlightFiles","highlightChecklist","openFullCard","fieldHighlighter","setContainer","$root","$el","addChipHighlight","TaskField","Files","getChipContainer","showHint","removeHighlight","Event","unbind","window","bind","$emit","features","Core","getParams","analytics","sendOpenFullCard","isMiniformEnabled","isV2Enabled","EventEmitter","emit","EventName","OpenSliderCard","OpenFullCard","closeAuditorsHint","handleAuditorsHintLinkClick","setShown","template","App","name","BIcon","FieldTitle","DescriptionInline","Importance","FieldList","AddTaskButton","DropZone","mixins","DragOverMixin","provide","cardType","CardType","Compact","default","Text","getRandom","groupId","parentId","relatedToTaskId","deadlineTs","title","description","Object","source","Outline","openingFullCard","isCheckListPopupShown","chipsEventHandlers","showCheckList","showCheckListPopup","creationError","popupCount","mapGetters","titleFieldOffsetHeight","Interface","currentUserId","defaultDeadline","hasDefaultDeadline","defaultDeadlineDate","defaultDeadlineTs","Date","getTime","group","Groups","isEdit","Type","isNumber","primaryFields","responsibleMeta","component","Responsible","context","$options","deadlineMeta","Deadline","chips","FilesChip","CheckListChip","isProjectsEnabled","GroupChip","created","destroy","payload","id","creatorId","responsibleId","forEach","auditorId","insertUser","insert","sendOpenCard","collabId","GroupType","Collab","resizeObserver","ResizeObserver","entries","find","target","updateTitleFieldOffsetHeight","contentRect","height","observe","subscribeEvents","beforeUnmount","disconnect","unsubscribeEvents","unmounted","mapActions","Users","close","CloseCard","addTask","error","taskService","add","Notifier","notifyViaBrowserProvider","text","message","sendAddTaskAnalytics","sendDescription","hasDescription","isStringFilled","hasScroll","checkListService","save","replace","baseEvent","BaseEvent","compatData","options","NotifyGrid","isSuccess","filter","checkListsItems","sendAddTaskWithCheckList","viewersCount","checklistCount","checklistItemsCount","sendAddTask","coexecutorsCount","accomplicesIds","handleShowingPopup","event","ShowOverlay","AdjustPosition","externalPopup","popupInstance","adjustCardPopup","handleHidingPopup","HideOverlay","handleResizingPopup","animate","titleFieldHeight","innerPopup","closeCheckListPopup","getEventListeners","chip","handlers","listeners","keys","includes","subscribe","handlePopupShow","document","handleKeyDown","capture","unsubscribe","popup","getCompatData","onClose","key","ctrlKey","metaKey","addTaskButton","delete","TaskCompactCard","constructor","params","TaskCard","Runtime","loadExtension","getData","showFullCard","TaskMappers","mapModelToSliderData","path","paths","editPath","BX","SidePanel","Instance","open","requestMethod","requestParams","cacheable","Dom","addClass","getPopupContainer","removeClass","setOffset","offsetTop","innerPopupContainer","popupContainer","heightDifference","offsetHeight","popupPaddingTop","style","setTimeout","openedPopupsCount","mountCard","getContentContainer","dragHandle","Tag","render","append","setDraggable","element","restrict","unmountCard","container","init","application","BitrixVue","createApp","mixin","locMixin","use","getStore","mount","unmount","handler","adjustPosition"],"mappings":"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"}