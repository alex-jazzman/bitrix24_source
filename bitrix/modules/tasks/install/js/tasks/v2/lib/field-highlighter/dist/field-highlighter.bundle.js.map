{"version":3,"file":"field-highlighter.bundle.js","sources":["../src/field-highlighter.js"],"sourcesContent":["import { Dom, Event } from 'main.core';\nimport './field-highlighter.css';\n\nconst fieldAttribute = 'data-task-field-id';\nconst chipAttribute = 'data-task-chip-id';\nconst fieldSelector = '[data-field-container]';\n\nclass FieldHighlighter\n{\n\t#container: HTMLElement = document.body;\n\t#highlightTimeouts: { [fieldId: string]: number } = {};\n\n\tsetContainer(container: HTMLElement): FieldHighlighter\n\t{\n\t\tthis.#container = container;\n\n\t\treturn this;\n\t}\n\n\taddHighlight(fieldId: string): FieldHighlighter\n\t{\n\t\tthis.highlightContainer(this.getFieldContainer(fieldId));\n\n\t\treturn this;\n\t}\n\n\taddChipHighlight(fieldId: string): FieldHighlighter\n\t{\n\t\tthis.highlightContainer(this.getChipContainer(fieldId));\n\n\t\treturn this;\n\t}\n\n\thighlightContainer(container: ?HTMLElement): void\n\t{\n\t\tif (!container)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tDom.addClass(container, 'tasks-field-highlight');\n\n\t\tconst removeHighlight = () => {\n\t\t\tDom.removeClass(container, 'tasks-field-highlight');\n\t\t\tEvent.unbind(window, 'click', removeHighlight);\n\t\t\tEvent.unbind(window, 'keydown', removeHighlight);\n\t\t};\n\t\tEvent.bind(window, 'click', removeHighlight);\n\t\tEvent.bind(window, 'keydown', removeHighlight);\n\t}\n\n\tasync highlight(fieldId: string): Promise<void>\n\t{\n\t\tawait this.#nextTick();\n\n\t\tconst fieldContainer = this.getFieldContainer(fieldId);\n\n\t\tif (!fieldContainer)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.#stopAnimation(fieldContainer);\n\t\tsetTimeout(() => this.#startAnimation(fieldContainer));\n\n\t\tclearTimeout(this.#highlightTimeouts[fieldId]);\n\t\tthis.#highlightTimeouts[fieldId] = setTimeout(() => this.#stopAnimation(fieldContainer), 1500);\n\n\t\tthis.#scrollToField(fieldId);\n\t}\n\n\t#startAnimation(fieldContainer: HTMLElement): void\n\t{\n\t\tDom.addClass(fieldContainer, ['tasks-field-highlight', '--animate']);\n\t}\n\n\t#stopAnimation(fieldContainer: HTMLElement): void\n\t{\n\t\tDom.removeClass(fieldContainer, ['tasks-field-highlight', '--animate']);\n\t}\n\n\t#scrollToField(fieldId: string): void\n\t{\n\t\tconst fieldContainer = this.getFieldContainer(fieldId);\n\n\t\tif (!fieldContainer)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tDom.style(fieldContainer, 'scrollMarginTop', '100px');\n\n\t\tfieldContainer.scrollIntoView({\n\t\t\tblock: 'start',\n\t\t\tbehavior: 'smooth',\n\t\t});\n\n\t\tsetTimeout(() => {\n\t\t\tDom.style(fieldContainer, 'scrollMarginTop', null);\n\t\t}, 1000);\n\t}\n\n\tgetFieldContainer(fieldId: string): ?HTMLElement\n\t{\n\t\treturn this.#container.querySelector(`[${fieldAttribute}=\"${fieldId}\"]`)?.closest(fieldSelector);\n\t}\n\n\tgetChipContainer(fieldId: string): ?HTMLElement\n\t{\n\t\treturn this.#container.querySelector(`[${chipAttribute}=\"${fieldId}\"]`);\n\t}\n\n\t#nextTick(): Promise<void>\n\t{\n\t\treturn new Promise((resolve) => {\n\t\t\tsetTimeout(resolve, 0);\n\t\t});\n\t}\n}\n\nexport const fieldHighlighter = new FieldHighlighter();\n"],"names":["fieldAttribute","chipAttribute","fieldSelector","FieldHighlighter","document","body","setContainer","container","addHighlight","fieldId","highlightContainer","getFieldContainer","addChipHighlight","getChipContainer","Dom","addClass","removeHighlight","removeClass","Event","unbind","window","bind","highlight","fieldContainer","setTimeout","clearTimeout","querySelector","closest","style","scrollIntoView","block","behavior","Promise","resolve","fieldHighlighter"],"mappings":";;;;;;;CAGA,MAAMA,cAAc,GAAG,oBAAoB;CAC3C,MAAMC,aAAa,GAAG,mBAAmB;CACzC,MAAMC,aAAa,GAAG,wBAAwB;CAAC;CAAA;CAAA;CAAA;CAAA;CAAA;CAE/C,MAAMC,gBAAgB,CACtB;GAAA;KAAA;OAAA;;KAAA;OAAA;;KAAA;OAAA;;KAAA;OAAA;;KAAA;OAAA;OAAA,OAC2BC,QAAQ,CAACC;;KAAI;OAAA;OAAA,OACa;;;GAEpDC,YAAY,CAACC,SAAsB,EACnC;KACC,4CAAI,4BAAcA,SAAS;KAE3B,OAAO,IAAI;;GAGZC,YAAY,CAACC,OAAe,EAC5B;KACC,IAAI,CAACC,kBAAkB,CAAC,IAAI,CAACC,iBAAiB,CAACF,OAAO,CAAC,CAAC;KAExD,OAAO,IAAI;;GAGZG,gBAAgB,CAACH,OAAe,EAChC;KACC,IAAI,CAACC,kBAAkB,CAAC,IAAI,CAACG,gBAAgB,CAACJ,OAAO,CAAC,CAAC;KAEvD,OAAO,IAAI;;GAGZC,kBAAkB,CAACH,SAAuB,EAC1C;KACC,IAAI,CAACA,SAAS,EACd;OACC;;KAGDO,aAAG,CAACC,QAAQ,CAACR,SAAS,EAAE,uBAAuB,CAAC;KAEhD,MAAMS,eAAe,GAAG,MAAM;OAC7BF,aAAG,CAACG,WAAW,CAACV,SAAS,EAAE,uBAAuB,CAAC;OACnDW,eAAK,CAACC,MAAM,CAACC,MAAM,EAAE,OAAO,EAAEJ,eAAe,CAAC;OAC9CE,eAAK,CAACC,MAAM,CAACC,MAAM,EAAE,SAAS,EAAEJ,eAAe,CAAC;MAChD;KACDE,eAAK,CAACG,IAAI,CAACD,MAAM,EAAE,OAAO,EAAEJ,eAAe,CAAC;KAC5CE,eAAK,CAACG,IAAI,CAACD,MAAM,EAAE,SAAS,EAAEJ,eAAe,CAAC;;GAG/C,MAAMM,SAAS,CAACb,OAAe,EAC/B;KACC,8CAAM,IAAI,yBAAY;KAEtB,MAAMc,cAAc,GAAG,IAAI,CAACZ,iBAAiB,CAACF,OAAO,CAAC;KAEtD,IAAI,CAACc,cAAc,EACnB;OACC;;KAGD,4CAAI,kCAAgBA,cAAc;KAClCC,UAAU,CAAC,8CAAM,IAAI,oCAAiBD,cAAc,CAAC,CAAC;KAEtDE,YAAY,CAAC,4CAAI,0CAAoBhB,OAAO,CAAC,CAAC;KAC9C,4CAAI,0CAAoBA,OAAO,CAAC,GAAGe,UAAU,CAAC,8CAAM,IAAI,kCAAgBD,cAAc,CAAC,EAAE,IAAI,CAAC;KAE9F,4CAAI,kCAAgBd,OAAO;;GAkC5BE,iBAAiB,CAACF,OAAe,EACjC;KAAA;KACC,gCAAO,4CAAI,0BAAYiB,aAAa,CAAE,IAAG1B,cAAe,KAAIS,OAAQ,IAAG,CAAC,qBAAjE,sBAAmEkB,OAAO,CAACzB,aAAa,CAAC;;GAGjGW,gBAAgB,CAACJ,OAAe,EAChC;KACC,OAAO,4CAAI,0BAAYiB,aAAa,CAAE,IAAGzB,aAAc,KAAIQ,OAAQ,IAAG,CAAC;;CASzE;CAAC,0BA/CgBc,cAA2B,EAC3C;GACCT,aAAG,CAACC,QAAQ,CAACQ,cAAc,EAAE,CAAC,uBAAuB,EAAE,WAAW,CAAC,CAAC;CACrE;CAAC,yBAEcA,cAA2B,EAC1C;GACCT,aAAG,CAACG,WAAW,CAACM,cAAc,EAAE,CAAC,uBAAuB,EAAE,WAAW,CAAC,CAAC;CACxE;CAAC,yBAEcd,OAAe,EAC9B;GACC,MAAMc,cAAc,GAAG,IAAI,CAACZ,iBAAiB,CAACF,OAAO,CAAC;GAEtD,IAAI,CAACc,cAAc,EACnB;KACC;;GAGDT,aAAG,CAACc,KAAK,CAACL,cAAc,EAAE,iBAAiB,EAAE,OAAO,CAAC;GAErDA,cAAc,CAACM,cAAc,CAAC;KAC7BC,KAAK,EAAE,OAAO;KACdC,QAAQ,EAAE;IACV,CAAC;GAEFP,UAAU,CAAC,MAAM;KAChBV,aAAG,CAACc,KAAK,CAACL,cAAc,EAAE,iBAAiB,EAAE,IAAI,CAAC;IAClD,EAAE,IAAI,CAAC;CACT;CAAC,sBAaD;GACC,OAAO,IAAIS,OAAO,CAAEC,OAAO,IAAK;KAC/BT,UAAU,CAACS,OAAO,EAAE,CAAC,CAAC;IACtB,CAAC;CACH;AAGD,OAAaC,gBAAgB,GAAG,IAAI/B,gBAAgB,EAAE;;;;;;;;"}