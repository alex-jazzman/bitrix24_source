this.BX=this.BX||{};(function(e,t,i,s){"use strict";var a,l,n;function r(e,t){c(e,t);t.add(e)}function o(e,t,i){c(e,t);t.set(e,i)}function c(e,t){if(t.has(e)){throw new TypeError("Cannot initialize the same private elements twice on an object")}}function h(e,t,i){if(!t.has(e)){throw new TypeError("attempted to get private field on non-instance")}return i}var u=Object.freeze({Closed:"CLOSED",Opened:"OPENED",Paused:"PAUSED",Expired:"EXPIRED"});var d=Object.freeze({Open:"OPEN",Reopen:"REOPEN"});var v=new WeakMap;var T=new WeakMap;var p=new WeakMap;var b=new WeakMap;var E=new WeakMap;var f=new WeakMap;var w=new WeakMap;var M=new WeakMap;var I=new WeakSet;var S=new WeakSet;var A=new WeakSet;var B=new WeakSet;var P=new WeakSet;var _=new WeakSet;var N=new WeakSet;var k=new WeakSet;var O=new WeakSet;var g=new WeakSet;var H=new WeakSet;var W=new WeakSet;var F=new WeakSet;var R=new WeakSet;var m=new WeakSet;var G=new WeakSet;var X=new WeakSet;var D=function(){function e(){babelHelpers.classCallCheck(this,e);r(this,X);r(this,G);r(this,m);r(this,R);r(this,F);r(this,W);r(this,H);r(this,g);r(this,O);r(this,k);r(this,N);r(this,_);r(this,P);r(this,B);r(this,A);r(this,S);r(this,I);o(this,v,{writable:true,value:{}});o(this,T,{writable:true,value:void 0});o(this,p,{writable:true,value:void 0});o(this,b,{writable:true,value:void 0});o(this,E,{writable:true,value:void 0});o(this,f,{writable:true,value:void 0});o(this,w,{writable:true,value:void 0});o(this,M,{writable:true,value:void 0});var c=t.Extension.getSettings("timeman.work-time-button");babelHelpers.classPrivateFieldGet(this,v).workReport=c.get("workReport");babelHelpers.classPrivateFieldGet(this,v).info=c.get("info");babelHelpers.classPrivateFieldGet(this,v).siteId=c.get("siteId");babelHelpers.classPrivateFieldSet(this,T,new s.Button({size:s.Button.Size.MEDIUM,text:"\u0432\u0438\u0434\u0433\u0435\u0442 \u043e\u043f\u0435\u043d\u0435\u0440",icon:h(this,O,q).call(this),useAirDesign:true,style:s.AirButtonStyle.PLAIN,noCaps:true,wide:true,events:{click:h(this,G,ee).bind(this)},className:"timeman-widget-opener"}));babelHelpers.classPrivateFieldSet(this,p,new s.Button({size:s.Button.Size.MEDIUM,text:t.Loc.getMessage("TIMEMAN_WORK_TIME_BUTTON_TEXT_START"),icon:s.ButtonIcon.START,useAirDesign:true,style:s.AirButtonStyle.FILLED,noCaps:true,wide:true,events:{click:h(this,X,te).bind(this)},className:"task-status-action task-status-action_start"}));babelHelpers.classPrivateFieldSet(this,b,new s.Button({size:s.Button.Size.MEDIUM,text:t.Loc.getMessage("TIMEMAN_WORK_TIME_BUTTON_TEXT_EXPIRED"),icon:s.ButtonIcon.ALERT,useAirDesign:true,style:s.AirButtonStyle.TINTED_ALERT,noCaps:true,wide:true,events:{click:h(this,X,te).bind(this)},className:"task-status-action task-status-action_finish"}));babelHelpers.classPrivateFieldSet(this,E,babelHelpers.classPrivateFieldGet(this,T).render());babelHelpers.classPrivateFieldSet(this,w,t.Tag.render(a||(a=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<div class="timeman-instant-container">\n\t\t\t</div>\n\t\t']))));babelHelpers.classPrivateFieldSet(this,f,t.Tag.render(l||(l=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<ul class="task-status__actions">\n\t\t\t\t',"\n\t\t\t\t","\n\t\t\t</ul>\n\t\t"])),h(this,N,z).call(this).map((function(e){return t.Tag.render(n||(n=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t\t<li class="task-status__action">\n\t\t\t\t\t\t',"\n\t\t\t\t\t</li>\n\t\t\t\t"])),e.render())})),babelHelpers.classPrivateFieldGet(this,w)));i.EventEmitter.subscribe("onTimemanInit",h(this,P,x).bind(this));i.EventEmitter.subscribe("onTimeManDataRecieved",h(this,_,K).bind(this));window.BX.timeman("bx_tm",babelHelpers.classPrivateFieldGet(this,v).info,babelHelpers.classPrivateFieldGet(this,v).siteId)}babelHelpers.createClass(e,[{key:"renderTaskStatusActions",value:function e(){return babelHelpers.classPrivateFieldGet(this,f)}},{key:"renderTimemanWidgetOpenerNode",value:function e(){return babelHelpers.classPrivateFieldGet(this,E)}}]);return e}();function L(){return babelHelpers.classPrivateFieldGet(this,v).info.STATE}function C(){var e,t;return(e=(t=babelHelpers.classPrivateFieldGet(this,v).info)===null||t===void 0?void 0:t.CAN_OPEN)!==null&&e!==void 0?e:null}function y(){return babelHelpers.classPrivateFieldGet(this,v).info.INFO.DATE_START}function U(){return babelHelpers.classPrivateFieldGet(this,v).info.INFO.TIME_LEAKS}function x(){h(this,H,Q).call(this);window.BXTIMEMAN.initFormWeekly(babelHelpers.classPrivateFieldGet(this,v).workReport)}function K(e){var t=e.getCompatData(),i=babelHelpers.slicedToArray(t,1),s=i[0];babelHelpers.classPrivateFieldGet(this,v).info=s;babelHelpers.classPrivateFieldGet(this,p).setText(h(this,k,j).call(this));babelHelpers.classPrivateFieldGet(this,p).setIcon(h(this,O,q).call(this));babelHelpers.classPrivateFieldGet(this,p).setStyle(h(this,g,J).call(this));h(this,H,Q).call(this)}function z(){var e=[];e.push(babelHelpers.classPrivateFieldGet(this,p));e.push(babelHelpers.classPrivateFieldGet(this,b));return e}function j(){if(h(this,I,L).call(this)===u.Closed&&h(this,S,C).call(this)===d.Open){return t.Loc.getMessage("TIMEMAN_WORK_TIME_BUTTON_TEXT_START")}if(h(this,I,L).call(this)===u.Opened){return h(this,R,Z).call(this)}if(h(this,I,L).call(this)===u.Paused){return t.Loc.getMessage("TIMEMAN_WORK_TIME_BUTTON_TEXT_CONTINUE")}if(h(this,I,L).call(this)===u.Closed&&h(this,S,C).call(this)===d.Reopen){return t.Loc.getMessage("TIMEMAN_WORK_TIME_BUTTON_TEXT_CONTINUE")}if(h(this,I,L).call(this)===u.Expired){return t.Loc.getMessage("TIMEMAN_WORK_TIME_BUTTON_TEXT_EXPIRED")}return""}function q(){if(h(this,I,L).call(this)===u.Closed&&h(this,S,C).call(this)===d.Open){return s.ButtonIcon.START}if(h(this,I,L).call(this)===u.Opened){return s.ButtonIcon.START}if(h(this,I,L).call(this)===u.Paused){return s.ButtonIcon.START}if(h(this,I,L).call(this)===u.Closed&&h(this,S,C).call(this)===d.Reopen){return s.ButtonIcon.REFRESH}if(h(this,I,L).call(this)===u.Expired){return s.ButtonIcon.ALERT}return null}function J(){if(h(this,I,L).call(this)===u.Opened){return s.AirButtonStyle.TINTED}if(h(this,I,L).call(this)===u.Paused){return s.AirButtonStyle.FILLED}if(h(this,I,L).call(this)===u.Closed&&h(this,S,C).call(this)===d.Reopen){return s.AirButtonStyle.TINTED}if(h(this,I,L).call(this)===u.Expired){return s.AirButtonStyle.TINTED_ALERT}return s.AirButtonStyle.FILLED}function Q(){h(this,F,Y).call(this);if(h(this,I,L).call(this)===u.Opened){h(this,W,V).call(this)}}function V(){var e=this;babelHelpers.classPrivateFieldSet(this,M,setInterval((function(){babelHelpers.classPrivateFieldGet(e,p).setText(h(e,R,Z).call(e))}),1e3))}function Y(){clearInterval(babelHelpers.classPrivateFieldGet(this,M))}function Z(){var e=Math.floor(Date.now()/1e3);var t=e-h(this,A,y).call(this)-(h(this,B,U).call(this)||0);if(t<0){return h(this,m,$).call(this,0,0,0)}var i=Math.floor(t/3600);var s=Math.floor(t%3600/60);var a=t%60;return h(this,m,$).call(this,i,s,a)}function $(e,i,s){var a=function e(t){return(t!==null&&t!==void 0?t:0).toString().padStart(2,"0")};return t.Loc.getMessage("TIMEMAN_WORK_TIME_BUTTON_TEXT_WORKING").replace("#time#","".concat(a(e),":").concat(a(i),":").concat(a(s)))}function ee(e,t){t.stopPropagation();window.BXTIMEMAN.setBindOptions({node:babelHelpers.classPrivateFieldGet(this,E),mode:"popup",popupOptions:{autoHide:true,angle:false,offsetTop:-40,closeByEsc:true,bindOptions:{forceBindPosition:true,forceTop:true,forceLeft:false},events:{onClose:function e(){},onDestroy:function e(){}},fixed:true}});window.BXTIMEMAN.Open()}function te(e,t){t.stopPropagation();console.log("HOBANA START WORKING");console.log("HOBANA START WORKING window.BXTIMEMAN",window.BXTIMEMAN);var i=window.BXTIMEMAN.getWnd();babelHelpers.classPrivateFieldGet(this,w).appendChild(i.CreateMainRow(window.BXTIMEMAN))}e.WorkTimeButton=D})(this.BX.Timeman=this.BX.Timeman||{},BX,BX.Event,BX.UI);
//# sourceMappingURL=work-time-button.bundle.map.js