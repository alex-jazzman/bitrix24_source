{"version":3,"file":"disk.onlyoffice-item.bundle.js","sources":["../src/onlyoffice-item.js","../src/onlyoffice-external-link-item.js"],"sourcesContent":["export default class OnlyOfficeItem extends BX.UI.Viewer.Item\n{\n\tconstructor(options)\n\t{\n\t\toptions = options || {};\n\n\t\tsuper(options);\n\t\tthis.objectId = options.objectId;\n\t\tthis.attachedObjectId = options.attachedObjectId;\n\t\tthis.versionId = options.versionId;\n\t\tthis.openEditInsteadPreview = options.openEditInsteadPreview;\n\t}\n\n\tsetController (controller: BX.UI.Viewer.Controller)\n\t{\n\t\tsuper.setController(controller);\n\n\t\tthis.controller.preload = 0;\n\t}\n\n\tenableEditInsteadPreview()\n\t{\n\t\tthis.openEditInsteadPreview = true;\n\t}\n\n\tsetPropertiesByNode (node: HTMLElement)\n\t{\n\t\tsuper.setPropertiesByNode(node);\n\n\t\tthis.objectId = node.dataset.objectId;\n\t\tthis.attachedObjectId = node.dataset.attachedObjectId;\n\t\tthis.versionId = node.dataset.versionId;\n\t\tthis.openEditInsteadPreview = node.dataset.openEditInsteadPreview;\n\t}\n\n\tloadData ()\n\t{\n\t\tconst uid = BX.util.getRandomString(16);\n\n\t\tBX.SidePanel.Instance.open(BX.util.add_url_param('/bitrix/services/main/ajax.php', this.getSliderQueryParameters()), {\n\t\t\twidth: '100%',\n\t\t\tcacheable: false,\n\t\t\tcustomLeftBoundary: 30,\n\t\t\tallowChangeHistory: false,\n\t\t\tdata: {\n\t\t\t\tdocumentEditor: true,\n\t\t\t\tuid: uid\n\t\t\t}\n\t\t});\n\n\t\treturn new BX.Promise();\n\t}\n\n\tgetSliderQueryParameters(): Object\n\t{\n\t\tlet action = 'disk.api.documentService.goToPreview';\n\t\tif (this.openEditInsteadPreview && BX.Disk.getDocumentService() === 'onlyoffice')\n\t\t{\n\t\t\taction = 'disk.api.documentService.goToEditOrPreview';\n\t\t}\n\n\t\treturn {\n\t\t\taction: action,\n\t\t\tserviceCode: 'onlyoffice',\n\t\t\tobjectId: this.objectId || 0,\n\t\t\tattachedObjectId: this.attachedObjectId || 0,\n\t\t\tversionId: this.versionId || 0\n\t\t}\n\t}\n}","\nexport default class OnlyofficeExternalLinkItem extends BX.UI.Viewer.Item\n{\n\tdocumentViewUrl: string;\n\n\tconstructor(options)\n\t{\n\t\toptions = options || {};\n\n\t\tsuper(options);\n\t\tthis.documentViewUrl = options.documentViewUrl;\n\t}\n\n\tsetPropertiesByNode (node: HTMLElement)\n\t{\n\t\tsuper.setPropertiesByNode(node);\n\t\tthis.documentViewUrl = node.dataset.documentViewUrl;\n\t}\n\n\tgetDocumentViewUrl(): string\n\t{\n\t\treturn this.documentViewUrl;\n\t}\n\n\tsetController (controller: BX.UI.Viewer.Controller)\n\t{\n\t\tsuper.setController(controller);\n\n\t\tthis.controller.preload = 0;\n\t}\n\n\tloadData ()\n\t{\n\t\tconst uid = BX.util.getRandomString(16);\n\n\t\tBX.SidePanel.Instance.open(this.getDocumentViewUrl(), {\n\t\t\twidth: '100%',\n\t\t\tcacheable: false,\n\t\t\tcustomLeftBoundary: 30,\n\t\t\tallowChangeHistory: false,\n\t\t\tdata: {\n\t\t\t\tdocumentEditor: true,\n\t\t\t\tuid: uid\n\t\t\t}\n\t\t});\n\n\t\treturn new BX.Promise();\n\t}\n}"],"names":["OnlyOfficeItem","options","objectId","attachedObjectId","versionId","openEditInsteadPreview","controller","preload","node","dataset","uid","BX","util","getRandomString","SidePanel","Instance","open","add_url_param","getSliderQueryParameters","width","cacheable","customLeftBoundary","allowChangeHistory","data","documentEditor","Promise","action","Disk","getDocumentService","serviceCode","UI","Viewer","Item","OnlyofficeExternalLinkItem","documentViewUrl","getDocumentViewUrl"],"mappings":"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"}