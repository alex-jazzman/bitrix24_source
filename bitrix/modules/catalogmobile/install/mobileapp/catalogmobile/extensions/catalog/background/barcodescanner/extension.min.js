(()=>{include("InAppNotifier");const t="CATALOG_BARCODE_SCANNER";const e=1e4;const a="OpenBarcodeScanner";class i{constructor(){this.barcodeNotificationId=null;this.isBarcodeNotificationVisible=false;this.handlePullEvents=this.handlePullEvents.bind(this);BX.addCustomEvent("onPullEvent-catalog",this.handlePullEvents)}handlePullEvents(t,e,i,o){switch(t){case a:this.suggestOpenBarcodeScanner(e);break;default:break}}suggestOpenBarcodeScanner(t){setTimeout((()=>{this.isBarcodeNotificationVisible=false}),e);this.setBarcodeNotificationId(t.id);if(!this.isBarcodeNotificationVisible){jnComponent.getState("catalog:catalog.barcode.scanner").then((()=>{BX.postComponentEvent("CatalogBarcodeScanner::onSessionIdChanged",[t.id])})).catch((()=>{this.showNotification()}))}}showNotification(){InAppNotifier.setHandler((()=>this.openBarcodeScanner()));InAppNotifier.showNotification({title:BX.message("CATALOG_BACKGROUND_BARCODE_SCAN_TITLE"),backgroundColor:"#E6000000",message:BX.message("CATALOG_BACKGROUND_BARCODE_SCAN_TEXT"),time:e/1e3});this.isBarcodeNotificationVisible=true}openBarcodeScanner(){this.isBarcodeNotificationVisible=false;ComponentHelper.openLayout({name:"catalog:catalog.barcode.scanner",canOpenInDefault:true,object:"layout",componentParams:{ID:this.barcodeNotificationId},widgetParams:BarcodeScannerWidget.getWidgetParams()})}setBarcodeNotificationId(t){this.barcodeNotificationId=t;return this}}this.CatalogBarcodeScannerBackground=new i;this.onAppActive=()=>{const e=Application.getLastNotification();if(e&&e.hasOwnProperty("params")){let a=JSON.parse(e.params);if(a&&a.hasOwnProperty("TYPE")&&a.TYPE===t){this.CatalogBarcodeScannerBackground.setBarcodeNotificationId(a.ID||"");this.CatalogBarcodeScannerBackground.openBarcodeScanner()}}};BX.addCustomEvent("onAppActive",this.onAppActive.bind(this));this.onAppActive()})();
//# sourceMappingURL=extension.map.js