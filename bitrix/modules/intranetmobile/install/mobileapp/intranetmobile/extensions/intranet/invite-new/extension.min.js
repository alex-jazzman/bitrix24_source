jn.define("intranet/invite-new",((t,e,n)=>{const{PureComponent:i}=t("layout/pure-component");const{Loc:s}=t("loc");const{Box:r}=t("ui-system/layout/box");const{BoxFooter:a}=t("ui-system/layout/dialog-footer");const{AnalyticsEvent:o,IntranetInviteAnalytics:l}=t("intranet/invite-new/src/analytics");const{Indent:c}=t("tokens");const{Button:u,ButtonDesign:d,ButtonSize:I}=t("ui-system/form/buttons/button");const{UIMenu:v}=t("layout/ui/menu");const{ContentStatusBlock:h}=t("intranet/invite-new/src/content-status-block");const{InviterFactory:p}=t("intranet/invite-new/src/inviter/factory");const{InviteCases:m}=t("intranet/invite-new/src/inviter/type");const{getSmartphoneContacts:g}=t("layout/ui/smartphone-contact-selector");const{createTestIdGenerator:y}=t("utils/test");class C extends i{static getAjaxErrorText(t){return t.map((t=>{if(t.message){return t.message.replace("<br/>:","\n").replace("<br/>","\n")}return t.replace("<br/>:","\n").replace("<br/>","\n")})).filter((t=>t.length>0)).join("\n")}constructor(t){super(t);this.smartphoneContacts=null;this.getTestId=y({prefix:"invite"});this.#t(t)}async componentDidMount(){const{department:t=null}=this.state;this.updateDepartmentInInviters(t);this.smartphoneContacts=await g()}#t(t){const{department:e=null}=t;this.state={department:e};this.inviters=Object.values(m).map((t=>p.createInviterByCase(t,this.#e()))).sort(((t,e)=>t.getSortOrder()-e.getSortOrder()))}updateDepartmentInInviters(t){this.inviters.forEach((e=>e.updateDepartment(t)))}#e=()=>{const{canInviteByLink:t,canInviteByEmail:e,canInviteBySMS:n,adminConfirm:i,analytics:s,layout:r,isBitrix24Included:a,isInviteWithLocalEmailAppEnabled:o,creatorEmailConfirmed:l=false,multipleInvite:c=true,onInviteSentHandler:u=null,onInviteError:d=null}=this.props;return{canInviteByLink:t,canInviteByEmail:e,canInviteBySMS:n,adminConfirm:i,analytics:s,layout:r,isBitrix24Included:a,isInviteWithLocalEmailAppEnabled:o,creatorEmailConfirmed:l,multipleInvite:c,onInviteSentHandler:u,onInviteError:d,selectedDepartmentChanged:this.#n,initialContacts:this.smartphoneContacts,onUIMenuItemSelected:this.onUIMenuItemSelected,getDepartment:this.getDepartment,onInviteLinkChanged:this.onInviteLinkChanged}};onUIMenuItemSelected=()=>{this.menu.hide()};onInviteLinkChanged=t=>{this.inviters.filter((t=>t.shouldUpdateInviteLink())).forEach((e=>{e.setInviteLink?.(t)}))};getDepartment=()=>this.state.department;render(){const{analytics:t,layout:e}=this.props;const{department:n}=this.state;return r({footer:this.#i(),style:{paddingVertical:c.XL3.toNumber()}},h({testId:this.getTestId("status-block"),analytics:t,layout:e,department:n,selectedDepartmentChanged:this.#n,graphicsUri:this.#s().getGraphicsUri()}))}#n=t=>{const{analytics:e}=this.props;e.setDepartmentParam(t!==null);this.setState({department:t},(()=>{this.updateDepartmentInInviters(t)}))};#i(){const t=this.#r();return a({safeArea:true,testId:this.getTestId("buttons")},this.#s().renderMainButton(),t>2&&u({testId:this.getTestId("by-other-button"),forwardRef:this.#a,text:s.getMessage("INTRANET_INVITE_BY_OTHER_BUTTON_TEXT"),size:I.M,design:d.PLAN_ACCENT,stretched:true,onClick:()=>{this.#o()}}),t===2&&this.#l().renderSecondaryButton())}#c(){return this.inviters.filter((t=>t.isAvailableInviteMethod()))}#u(){return this.#c().filter((t=>!t.isDisabledInviteMethod()))}#r(){return this.#u().length}#s(){const t=this.#u();if(t.length>0){return t[0]}return this.inviters[0]}#l(){const t=this.#u();if(t.length>1){return t[1]}return null}#a=t=>{this.inviteCasesButtonRef=t};#o=()=>{this.menu=new v(this.#d());this.menu.show({target:this.inviteCasesButtonRef})};#d=()=>{const t=this.#s().getInviteCase();return this.#c().filter((e=>e.getInviteCase()!==t)).map((t=>t.getItemForUIMenu()))}}n.exports={Invite:C,AnalyticsEvent:o,IntranetInviteAnalytics:l}}));
//# sourceMappingURL=extension.map.js