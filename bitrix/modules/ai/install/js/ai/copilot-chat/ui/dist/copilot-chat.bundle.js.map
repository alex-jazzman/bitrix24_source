{"version":3,"file":"copilot-chat.bundle.js","sources":["../src/components/copilot-chat-status.js","../src/helpers/new-messages-visibility-observer.js","../src/components/copilot-chat-avatar.js","../src/components/copilot-chat-header-menu.js","../src/components/copilot-chat-header.js","../src/components/copilot-chat-voice-input-btn.js","../src/components/copilot-chat-input.js","../src/helpers/is-message-from-copilot.js","../src/components/copilot-chat-message.js","../src/components/copilot-chat-welcome-message.js","../src/components/copilot-chat-messages-date-group.js","../src/components/copilot-chat-new-messages-label.js","../src/components/copilot-chat-messages-author-group.js","../src/types.js","../src/components/directives/copilot-chat-new-message-visibility-observer.js","../src/components/message/copilot-chat-message-menu.js","../src/components/message/copilot-chat-message-default.js","../src/components/message/copilot-chat-message-welcome.js","../src/components/message/copilot-chat-message-site-with-ai.js","../src/components/message/copilot-chat-message-welcome-flows.js","../src/components/message/index.js","../src/components/copilot-chat-messages.js","../src/components/copilot-chat-history-loader.js","../src/components/copilot-chat-warning-message.js","../src/components/copilot-chat.js","../src/copilot-chat.js"],"sourcesContent":["import { BIcon, Set } from 'ui.icon-set.api.vue';\n\nimport '../css/copilot-chat-status.css';\n\nexport const Status = Object.freeze({\n\tCOPILOT_WRITING: 'copilot-writing',\n\tNONE: 'none',\n});\n\nexport const CopilotChatStatus = {\n\tcomponents: {\n\t\tBIcon,\n\t},\n\tprops: {\n\t\tstatus: {\n\t\t\ttype: String,\n\t\t\trequired: false,\n\t\t\tdefault: Status.NONE,\n\t\t},\n\t},\n\tcomputed: {\n\t\tStatus(): Status {\n\t\t\treturn Status;\n\t\t},\n\t\twritingStatusIcon(): {name: string, size: number} {\n\t\t\treturn {\n\t\t\t\tname: Set.PENCIL_60,\n\t\t\t\tsize: 14,\n\t\t\t\tcolor: '#fff',\n\t\t\t};\n\t\t},\n\t\tcontainerClassname(): string[] {\n\t\t\treturn [\n\t\t\t\t'ai__copilot-chat_status',\n\t\t\t\t`--${this.status}`,\n\t\t\t];\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"ai__copilot-chat_status-wrapper\">\n\t\t\t<div class=\"ai__copilot-chat_status\">\n\t\t\t\t<template v-if=\"status === Status.COPILOT_WRITING\">\n\t\t\t\t\t<span class=\"ai__copilot-chat_status-icon --typing\">\n\t\t\t\t\t\t<BIcon\n\t\t\t\t\t\t\tv-bind=\"writingStatusIcon\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</span>\n\t\t\t\t\t<span>{{ $Bitrix.Loc.getMessage('AI_COPILOT_CHAT_STATUS_COPILOT_WRITING') }}</span>\n\t\t\t\t</template>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import { Dom } from 'main.core';\nimport { BaseEvent, EventEmitter } from 'main.core.events';\n\nexport const NewMessagesVisibilityObserverEvents = Object.freeze({\n\tVIEW_NEW_MESSAGE: 'viewNewMessage',\n});\n\nexport class NewMessagesVisibilityObserver extends EventEmitter\n{\n\t#observer: IntersectionObserver | null = null;\n\t#root: HTMLElement = null;\n\t#observableElements: HTMLElement[] = [];\n\n\tconstructor(options) {\n\t\tsuper(options);\n\n\t\tthis.setEventNamespace('AI.CopilotChat.InterSectionManager');\n\t}\n\n\tinit(): void\n\t{\n\t\t// eslint-disable-next-line @bitrix24/bitrix24-rules/no-io-without-polyfill\n\t\tthis.#observer = new IntersectionObserver((entries: IntersectionObserverEntry[]) => {\n\t\t\tentries.forEach((entry) => {\n\t\t\t\tconst isMessageVisible = entry.isIntersecting && entry.intersectionRatio > 0.5;\n\n\t\t\t\tif (isMessageVisible)\n\t\t\t\t{\n\t\t\t\t\tconst messageElement = entry.target;\n\n\t\t\t\t\tthis.emit(NewMessagesVisibilityObserverEvents.VIEW_NEW_MESSAGE, new BaseEvent({\n\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\tid: Dom.attr(messageElement, 'data-id'),\n\t\t\t\t\t\t},\n\t\t\t\t\t}));\n\n\t\t\t\t\tthis.#observer.unobserve(messageElement);\n\t\t\t\t}\n\t\t\t});\n\t\t}, {\n\t\t\troot: this.#root,\n\t\t\tthreshold: this.#getThreshold(),\n\t\t});\n\n\t\tthis.#observableElements.forEach((element) => {\n\t\t\tthis.#observer.observe(element);\n\t\t});\n\t}\n\n\t#getThreshold(): number[]\n\t{\n\t\tconst arrayWithZeros = Array.from({ length: 101 }).fill(0);\n\n\t\treturn arrayWithZeros.map((zero, index) => index * 0.01);\n\t}\n\n\tobserve(element: HTMLElement): void\n\t{\n\t\tif (!this.#root || !this.#observer)\n\t\t{\n\t\t\tthis.#observableElements.push(element);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.#observer.observe(element);\n\t\t}\n\t}\n\n\tunobserve(element: HTMLElement): void\n\t{\n\t\tthis.#observer.unobserve(element);\n\t}\n\n\tsetRoot(root: HTMLElement): void\n\n\t{\n\t\tthis.#root = root;\n\t}\n}\n","import '../css/copilot-chat-avatar.css';\n\nexport const CopilotChatAvatar = {\n\tprops: {\n\t\tsrc: String,\n\t\talt: String,\n\t},\n\ttemplate: `\n\t\t<img\n\t\t\tclass=\"ai__copilot-chat-avatar\"\n\t\t\t:alt=\"alt\"\n\t\t\t:src=\"src\"\n\t\t/>\n\t`,\n};\n","import { Menu, type MenuItemOptions } from 'main.popup';\nimport { BIcon, Set } from 'ui.icon-set.api.vue';\n\nimport '../css/copilot-chat-header-menu.css';\n\nexport const CopilotChatHeaderMenu = {\n\tcomponents: {\n\t\tBIcon,\n\t},\n\tprops: {\n\t\tmenuItems: {\n\t\t\ttype: Array,\n\t\t\trequired: true,\n\t\t\tdefault: () => ([]),\n\t\t},\n\t},\n\tcomputed: {\n\t\titems(): MenuItemOptions[] {\n\t\t\treturn this.menuItems;\n\t\t},\n\t\tmenuIconProps(): { name: string, size: number } {\n\t\t\treturn {\n\t\t\t\tname: Set.MORE,\n\t\t\t\tsize: 24,\n\t\t\t};\n\t\t},\n\t},\n\tbeforeMount() {\n\t\tthis.menu = new Menu({\n\t\t\titems: this.items,\n\t\t});\n\t},\n\tmounted() {\n\t\tthis.menu.getPopupWindow().setBindElement(this.$refs.menuButton);\n\t},\n\tbeforeUnmount() {\n\t\tthis.menu.destroy();\n\t},\n\tmethods: {\n\t\ttoggleMenu(): void {\n\t\t\tif (this.isMenuOpen())\n\t\t\t{\n\t\t\t\tthis.hideMenu();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.showMenu();\n\t\t\t}\n\t\t},\n\t\tshowMenu(): void {\n\t\t\tthis.menu.show();\n\t\t},\n\t\thideMenu(): void {\n\t\t\tthis.menu.close();\n\t\t},\n\t\tisMenuOpen(): boolean {\n\t\t\treturn this.menu.getPopupWindow().isShown();\n\t\t},\n\t},\n\ttemplate: `\n\t\t<button\n\t\t\tref=\"menuButton\"\n\t\t\t@click=\"toggleMenu\"\n\t\t\tclass=\"ai__copilot-chat-header-menu\"\n\t\t>\n\t\t\t<span class=\"ai__copilot-chat-header-menu_icon\">\n\t\t\t\t<b-icon\n\t\t\t\t\tv-bind=\"menuIconProps\"\n\t\t\t\t></b-icon>\n\t\t\t</span>\n\t\t</button>\n\t`,\n};\n","import type { MenuItemOptions } from 'main.popup';\nimport { CopilotChatAvatar } from './copilot-chat-avatar';\nimport { CopilotChatHeaderMenu } from './copilot-chat-header-menu';\nimport { BIcon, Set } from 'ui.icon-set.api.vue';\nimport 'ui.icon-set.actions';\n\nimport '../css/copilot-chat-header.css';\n\nexport const CopilotChatHeader = {\n\tcomponents: {\n\t\tCopilotChatAvatar,\n\t\tCopilotChatHeaderMenu,\n\t\tBIcon,\n\t},\n\temits: ['clickOnCloseIcon'],\n\tprops: {\n\t\ttitle: String,\n\t\tsubtitle: String,\n\t\tavatar: String,\n\t\tuseCloseIcon: {\n\t\t\ttype: Boolean,\n\t\t\trequired: false,\n\t\t\tdefault: false,\n\t\t},\n\t\tmenu: Object,\n\t},\n\tcomputed: {\n\t\tcloseIconProps(): { name: string, size: number } {\n\t\t\treturn {\n\t\t\t\tname: Set.CROSS_40,\n\t\t\t\tsize: 24,\n\t\t\t};\n\t\t},\n\t\tisMenuExists(): boolean {\n\t\t\treturn this.menu && this.menu.items && this.menu.items.length > 0;\n\t\t},\n\t\tmenuItems(): MenuItemOptions {\n\t\t\treturn this.menu?.items ?? [];\n\t\t},\n\t},\n\tmethods: {\n\t\thandleClickOnCloseIcon(): void {\n\t\t\tthis.$emit('clickOnCloseIcon');\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"ai__copilot-chat-header\">\n\t\t\t<button\n\t\t\t\tv-if=\"useCloseIcon\"\n\t\t\t\t@click=\"handleClickOnCloseIcon\"\n\t\t\t\tclass=\"ai__copilot-chat-header_close-icon\"\n\t\t\t>\n\t\t\t\t<b-icon\n\t\t\t\t\tv-bind=\"closeIconProps\"\n\t\t\t\t />\n\t\t\t</button>\n\t\t\t<div class=\"ai__copilot-chat-header_avatar\">\n\t\t\t\t<CopilotChatAvatar\n\t\t\t\t\t:src=\"avatar\"\n\t\t\t\t\t:alt=\"title\"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t\t<div class=\"ai__copilot-chat-header_info\">\n\t\t\t\t<h4 class=\"ai__copilot-chat-header_title\">\n\t\t\t\t\t{{ title }}\n\t\t\t\t</h4>\n\t\t\t\t<div class=\"ai__copilot-chat-header_subtitle\">\n\t\t\t\t\t{{ subtitle }}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div\n\t\t\t\tv-if=\"isMenuExists\"\n\t\t\t\tclass=\"ai__copilot-chat-header_menu\"\n\t\t\t>\n\t\t\t\t<copilot-chat-header-menu :menu-items=\"menuItems\"></copilot-chat-header-menu>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import type { SpeechConverterErrorEventData, SpeechConverterResultEventData } from 'ai.speech-converter';\nimport { SpeechConverter, speechConverterEvents } from 'ai.speech-converter';\nimport { BaseEvent } from 'main.core.events';\nimport { Set as IconSet } from 'ui.icon-set.api.core';\nimport { BIcon } from 'ui.icon-set.api.vue';\nimport { toRaw } from 'ui.vue3';\n\nimport 'ui.icon-set.main';\n\nexport const CopilotChatVoiceInputBtn = {\n\tcomponents: {\n\t\tBIcon,\n\t},\n\temits: ['input', 'start', 'stop'],\n\tdata(): { converter: ?SpeechConverter } {\n\t\treturn {\n\t\t\tconverter: null,\n\t\t\tisVoiceRecording: false,\n\t\t};\n\t},\n\tcomputed: {\n\t\tIconSet(): IconSet {\n\t\t\treturn IconSet;\n\t\t},\n\t\tisVoiceInputDisabled(): boolean {\n\t\t\treturn SpeechConverter.isBrowserSupport() === false;\n\t\t},\n\t},\n\tmethods: {\n\t\thandleClickOnStartVoiceInputBtn(): void {\n\t\t\tif (this.isVoiceRecording)\n\t\t\t{\n\t\t\t\tthis.stopVoiceInput();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.startVoiceInput();\n\t\t\t}\n\t\t},\n\t\tstartVoiceInput() {\n\t\t\tconst converter: SpeechConverter = toRaw(this.converter);\n\t\t\tconverter.start();\n\t\t},\n\t\tstopVoiceInput(): void {\n\t\t\tconst converter: SpeechConverter = toRaw(this.converter);\n\t\t\tconverter.stop();\n\t\t},\n\t\thandleSpeechConverterStartEvent(): void {\n\t\t\tthis.$emit('start');\n\t\t\tthis.isVoiceRecording = true;\n\t\t},\n\t\thandleSpeechConverterStopEvent(): void {\n\t\t\tthis.isVoiceRecording = false;\n\t\t\tthis.$emit('stop');\n\t\t},\n\t\thandleSpeechConverterResultEvent(e: BaseEvent<SpeechConverterResultEventData>): void {\n\t\t\tthis.$emit('input', e.getData().text);\n\t\t},\n\t\thandleSpeechConverterErrorEvent(e: BaseEvent<SpeechConverterErrorEventData>) {\n\t\t\tconsole.error(e);\n\t\t\tthis.isVoiceRecording = false;\n\t\t},\n\t},\n\tmounted() {\n\t\tif (this.isVoiceInputDisabled === false)\n\t\t{\n\t\t\tthis.converter = new SpeechConverter({});\n\n\t\t\tconst converter: SpeechConverter = toRaw(this.converter);\n\n\t\t\tconverter.subscribe(speechConverterEvents.start, this.handleSpeechConverterStartEvent);\n\t\t\tconverter.subscribe(speechConverterEvents.stop, this.handleSpeechConverterStopEvent);\n\t\t\tconverter.subscribe(speechConverterEvents.result, this.handleSpeechConverterResultEvent.bind(this));\n\t\t\tconverter.subscribe(speechConverterEvents.error, this.handleSpeechConverterErrorEvent);\n\t\t}\n\t},\n\tunmounted() {\n\t\tconst converter: SpeechConverter = toRaw(this.converter);\n\n\t\tconverter.unsubscribe(speechConverterEvents.start, this.handleSpeechConverterStartEvent);\n\t\tconverter.unsubscribe(speechConverterEvents.stop, this.handleSpeechConverterStopEvent);\n\t\tconverter.unsubscribe(speechConverterEvents.result, this.handleSpeechConverterResultEvent.bind(this));\n\t\tconverter.unsubscribe(speechConverterEvents.error, this.handleSpeechConverterErrorEvent);\n\t},\n\ttemplate: `\n\t\t<button\n\t\t\t:disabled=\"isVoiceInputDisabled\"\n\t\t\t@click=\"handleClickOnStartVoiceInputBtn\"\n\t\t\tclass=\"ai__copilot-chat-input_voice-input\"\n\t\t>\n\t\t\t<span\n\t\t\t\tv-if=\"isVoiceRecording === false\"\n\t\t\t\tclass=\"ai__copilot-chat-input_voice-input-no-record-icon-wrapper\"\n\t\t\t>\n\t\t\t\t<BIcon\n\t\t\t\t\t:size=\"24\"\n\t\t\t\t\t:name=\"IconSet.MICROPHONE_ON\"\n\t\t\t\t/>\n\t\t\t</span>\n\t\t\t<span\n\t\t\t\tv-else\n\t\t\t\tclass=\"ai__copilot-chat-input_voice-input-record-icon-wrapper\"\n\t\t\t>\n\t\t\t\t<span class=\"ai__copilot-chat-input_voice-input-record-icon\"></span>\n\t\t\t</span>\n\t\t</button>\n\t`,\n};\n","import { Loc, Dom } from 'main.core';\nimport { CopilotChatVoiceInputBtn } from './copilot-chat-voice-input-btn';\nimport 'ui.icon-set.main';\n\nimport '../css/copilot-chat-input.css';\n\nexport const CopilotChatInput = {\n\tcomponents: {\n\t\tCopilotChatVoiceInputBtn,\n\t},\n\temits: ['submit'],\n\tprops: {\n\t\tdisabled: {\n\t\t\ttype: Boolean,\n\t\t\trequired: false,\n\t\t\tdefault: false,\n\t\t},\n\t\tplaceholder: {\n\t\t\ttype: String,\n\t\t\trequired: false,\n\t\t\tdefault: Loc.getMessage('AI_COPILOT_CHAT_INPUT_PLACEHOLDER'),\n\t\t},\n\t},\n\tdata(): {\n\t\tuserMessage: string,\n\t\tuserMessageBeforeVoiceInput: string,\n\t\tisRecording: boolean,\n\t\t} {\n\t\treturn {\n\t\t\tuserMessage: '',\n\t\t\tuserMessageBeforeVoiceInput: this.userMessage,\n\t\t\tisRecording: false,\n\t\t};\n\t},\n\tcomputed: {\n\t\tisSubmitButtonDisabled(): boolean {\n\t\t\treturn !this.userMessage || this.userMessage.trim().length === 0 || this.isRecording;\n\t\t},\n\t\tcontainerClassname(): string {\n\t\t\treturn {\n\t\t\t\t'ai__copilot-chat-input': true,\n\t\t\t\t'--disabled': this.disabled,\n\t\t\t};\n\t\t},\n\t},\n\tmethods: {\n\t\thandleSubmitButton(e: PointerEvent): void {\n\t\t\te.target.blur();\n\n\t\t\tthis.submitMessage();\n\t\t},\n\t\thandleEnterKeyDown(e: KeyboardEvent): boolean {\n\t\t\tif (e.shiftKey || e.ctrlKey)\n\t\t\t{\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\te.preventDefault();\n\n\t\t\tif (this.userMessage?.trim())\n\t\t\t{\n\t\t\t\tthis.submitMessage();\n\t\t\t}\n\n\t\t\treturn false;\n\t\t},\n\t\tsubmitMessage(): void {\n\t\t\tthis.$emit('submit', this.userMessage.trim());\n\n\t\t\tthis.userMessage = '';\n\t\t},\n\t\thandleInput(e: InputEvent): void {\n\t\t\tthis.userMessage = e.target.value;\n\t\t},\n\t\thandleVoiceInputText(text: string): void {\n\t\t\tthis.userMessage = this.userMessageBeforeVoiceInput + text;\n\n\t\t\tthis.updateTextareaHeight();\n\t\t},\n\t\thandleStartVoiceInput(): void {\n\t\t\tthis.isRecording = true;\n\t\t\tif (this.userMessage && this.userMessage.at(-1) !== ' ')\n\t\t\t{\n\t\t\t\tthis.userMessage += ' ';\n\t\t\t}\n\n\t\t\tthis.userMessageBeforeVoiceInput = this.userMessage;\n\t\t},\n\t\thandleStopVoiceInput(): void {\n\t\t\tthis.isRecording = false;\n\t\t\tthis.$refs.textarea.focus();\n\t\t},\n\t\tupdateTextareaHeight(): void {\n\t\t\tconst textarea: HTMLElement = this.$refs.textarea;\n\t\t\tDom.style(textarea, 'height', 'auto');\n\n\t\t\tDom.style(textarea, 'height', `${textarea.scrollHeight}px`);\n\t\t},\n\t},\n\twatch: {\n\t\tuserMessage(): void {\n\t\t\trequestAnimationFrame(() => {\n\t\t\t\tthis.updateTextareaHeight();\n\t\t\t});\n\t\t},\n\t\tdisabled(isDisabled): void {\n\t\t\tif (isDisabled === false)\n\t\t\t{\n\t\t\t\tthis.$refs.textarea.focus();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.$refs.textarea.blur();\n\t\t\t}\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div :class=\"containerClassname\">\n\t\t\t<div class=\"ai__copilot-chat-input_textarea-wrapper\">\n\t\t\t\t<textarea\n\t\t\t\t\ttype=\"text\" class=\"ai__copilot-chat-input_textarea\"\n\t\t\t\t\tref=\"textarea\"\n\t\t\t\t\t:placeholder=\"placeholder\"\n\t\t\t\t\trows=\"1\"\n\t\t\t\t\t@input=\"handleInput\"\n\t\t\t\t\t@keydown.enter=\"handleEnterKeyDown\"\n\t\t\t\t\t:value=\"userMessage\"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t\t<div class=\"ai__copilot-chat-input_actions\">\n\t\t\t\t<CopilotChatVoiceInputBtn\n\t\t\t\t\t@start=\"handleStartVoiceInput\"\n\t\t\t\t\t@input=\"handleVoiceInputText\"\n\t\t\t\t\t@stop=\"handleStopVoiceInput\"\n\t\t\t\t/>\n\t\t\t\t<button @click=\"handleSubmitButton\" :disabled=\"isSubmitButtonDisabled\" class=\"ai__copilot-chat-input_submit\"></button>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","export const isMessageFromCopilot = (authorId: string): boolean => {\n\treturn authorId === 0;\n};\n","import '../css/copilot-chat-message.css';\n\nexport type CopilotChatMessageDataButton = {\n\ttext: string;\n\tisSelected: boolean;\n}\n\nexport const CopilotChatMessage = {\n\tprops: {\n\t\tavatar: String,\n\t\tavatarAlt: String,\n\t\tmessageTitle: String,\n\t\tmessageText: String,\n\t\ttime: String,\n\t\tbuttons: {\n\t\t\ttype: Array,\n\t\t\trequired: false,\n\t\t\tdefault: () => ([]),\n\t\t},\n\t\tcolorScheme: String,\n\t\tstatus: {\n\t\t\ttype: String,\n\t\t\trequired: false,\n\t\t},\n\t},\n\tcomputed: {\n\t\tmessageButtons(): CopilotChatMessageDataButton[] {\n\t\t\treturn this.buttons;\n\t\t},\n\t\tformattedTime(): string {\n\t\t\tconst date = (new Date(this.time));\n\n\t\t\treturn `${date.getHours()}:${date.getMinutes()}`;\n\t\t},\n\t\tisUserMessage(): boolean {\n\t\t\treturn true; // replace with the actual code\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div\n\t\t\tclass=\"ai__copilot-chat-message\"\n\t\t\t:class=\"'--color-schema-' + colorScheme\"\n\t\t>\n\t\t\t<div class=\"ai__copilot-chat-message_avatar-wrapper\">\n\t\t\t\t<img\n\t\t\t\t\tclass=\"ai__copilot-chat-message_avatar\"\n\t\t\t\t\t:src=\"avatar\"\n\t\t\t\t\t:alt=\"avatarAlt\"\n\t\t\t\t\t:title=\"avatarAlt\"\n\t\t\t\t>\n\t\t\t</div>\n\t\t\t<div class=\"ai__copilot-chat-message-content-wrapper\">\n\t\t\t\t<div class=\"ai__copilot-chat-message-content\">\n\t\t\t\t\t<div class=\"ai__copilot-chat-message-content-main\">\n\t\t\t\t\t\t<div\n\t\t\t\t\t\t\tv-if=\"messageTitle\"\n\t\t\t\t\t\t\tclass=\"ai__copilot-chat-message-title\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{{ messageTitle }}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"ai__copilot-chat-message-text\">\n\t\t\t\t\t\t\t{{ messageText }}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"ai__copilot-chat-message_time\">\n\t\t\t\t\t\t{{ formattedTime }}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div\n\t\t\t\t\t\tv-if=\"status\"\n\t\t\t\t\t\tclass=\"ai__copilot-chat-message_status\"\n\t\t\t\t\t\t:class=\"'--' + status\"\n\t\t\t\t\t></div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div v-if=\"messageButtons.length > 0\" class=\"ai__copilot-chat-message_action-buttons\">\n\t\t\t\t<button\n\t\t\t\t\tv-for=\"button in messageButtons\"\n\t\t\t\t\tclass=\"ai__copilot-chat-message_action-button\"\n\t\t\t\t\t:class=\"{'--selected': button.isSelected}\"\n\t\t\t\t>\n\t\t\t\t\t{{ button.text }}\n\t\t\t\t</button>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","export const CopilotChatWelcomeMessage = {\n\tprops: {\n\t\tavatar: String,\n\t\ttitle: String,\n\t\tcontent: String,\n\t},\n\ttemplate: `\n\t\t<div class=\"landing__copilot-landing-chat-welcome-message\">\n\t\t\t<div class=\"landing__copilot-landing-chat-welcome-message_avatar-wrapper\">\n\t\t\t\t<img\n\t\t\t\t\tclass=\"landing__copilot-landing-chat-welcome-message_avatar\"\n\t\t\t\t\tsrc=\"/dev/ai/copilot-chat/images/avatar-example-4x.png\"\n\t\t\t\t\talt=\"Copilot Designer\"\n\t\t\t\t>\n\t\t\t</div>\n\t\t\t<div class=\"landing__copilot-landing-chat-welcome-message_content\">\n\t\t\t\t<h6 class=\"landing__copilot-landing-chat-welcome-message_title\">{{ title }}</h6>\n\t\t\t\t<div v-html=\"content\"></div>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import { DateTimeFormat } from 'main.date';\n\nimport '../css/copilot-chat-messages-date-group.css';\n\nexport const CopilotChatMessagesDateGroup = {\n\tprops: {\n\t\tdate: {\n\t\t\ttype: String,\n\t\t\trequired: false,\n\t\t\tdefault: '',\n\t\t},\n\t},\n\tcomputed: {\n\t\tformattedDate(): string\n\t\t{\n\t\t\tconst format = [\n\t\t\t\t['today', 'today'],\n\t\t\t\t['yesterday', 'yesterday'],\n\t\t\t\t['m', 'l, d F'],\n\t\t\t\t['', 'l, d F Y'],\n\t\t\t];\n\n\t\t\treturn DateTimeFormat.format(format, new Date(this.date), new Date());\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"ai__copilot-chat-messages-date-group\">\n\t\t\t<div class=\"ai__copilot-chat-messages-date-group__date\">\n\t\t\t\t<div class=\"ai__copilot-chat-messages-date-group__date-label\">\n\t\t\t\t\t{{ formattedDate }}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div class=\"ai__copilot-chat-messages-date-group__content\">\n\t\t\t\t<slot></slot>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import '../css/copilot-chat-new-messages-label.css';\n\nexport const containerClassname = 'ai__copilot-chat_new-messages-label';\n\nexport const CopilotChatNewMessagesLabel = {\n\ttemplate: `\n\t\t<div class=\"${containerClassname}\">\n\t\t\t{{ $Bitrix.Loc.getMessage('AI_COPILOT_CHAT_NEW_MESSAGES_LABEL') }}\n\t\t</div>\n\t`,\n};\n","import { CopilotChatNewMessagesLabel } from './copilot-chat-new-messages-label';\n\nimport '../css/copilot-chat-messages-author-group.css';\n\nexport const CopilotChatMessagesAuthorGroup = {\n\tcomponents: {\n\t\tCopilotChatNewMessagesLabel,\n\t},\n\tprops: {\n\t\tavatar: {\n\t\t\ttype: String,\n\t\t\trequired: false,\n\t\t},\n\t\tshowNewMessagesLabel: {\n\t\t\ttype: Boolean,\n\t\t\trequired: false,\n\t\t\tdefault: false,\n\t\t},\n\t},\n\ttemplate: `\n\t\t<CopilotChatNewMessagesLabel v-if=\"showNewMessagesLabel\" />\n\t\t<div class=\"ai__copilot-chat_messages-author-group\">\n\t\t\t<div v-if=\"avatar\" class=\"ai__copilot-chat_messages-author-group__avatar\">\n\t\t\t\t<img :src=\"avatar\" alt=\"#\">\n\t\t\t</div>\n\t\t\t<div class=\"ai__copilot-chat_messages-author-group__messages\">\n\t\t\t\t<slot></slot>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","export type CopilotChatMessage = {\n\tid?: number;\n\tcontent: string;\n\tauthorId: number;\n\tstatus?: 'sending' | 'delivered' | '';\n\tparams?: CopilotChatMessageParams;\n\tdateCreated?: string;\n\ttype?: 'default' | 'welcomeFlows' | 'welcomeSiteWithAi' | 'system' | 'buttonClickMessage';\n\tviewed: boolean;\n};\n\ntype CopilotChatMessageParams = {\n\tbuttons?: CopilotChatMessageButton[];\n}\n\nexport type CopilotChatMessageButton = {\n\tid: number;\n\ttext: string;\n\tisSelected: boolean;\n\tmessage: string;\n}\n\nexport const CopilotChatMessageType = Object.freeze({\n\tDEFAULT: 'default',\n\tBUTTON_CLICK_MESSAGE: 'buttonClickMessage',\n\tWELCOME_FLOWS: 'welcomeFlows',\n\tWELCOME_SITE_WITH_AI: 'welcomeSiteWithAi',\n\tSYSTEM: 'system',\n});\n","export const CopilotChatNewMessageVisibilityObserver = {\n\tmounted(element, binding) {\n\t\tconst isMessageViewed = binding.value;\n\n\t\tif (isMessageViewed === false)\n\t\t{\n\t\t\tbinding.instance.observer.observe(element);\n\t\t}\n\t},\n\tbeforeUnmount(element, binding) {\n\t\tbinding.instance.observer.unobserve(element);\n\t},\n};\n","import { bind, Dom } from 'main.core';\nimport { Menu, type MenuItemOptions } from 'main.popup';\nimport { BIcon, Set } from 'ui.icon-set.api.vue';\n\nimport '../../css/copilot-chat-message-menu.css';\n\nexport type MenuItemOnClickCustomData = {\n\tmessage: MenuItemMessageData;\n};\n\nexport type MenuItemMessageData = {\n\tid: number;\n\tcontent: string;\n\tdateCreated: string;\n};\n\nexport const CopilotChatMessageMenu = {\n\tcomponents: {\n\t\tBIcon,\n\t},\n\tprops: {\n\t\tmenuItems: {\n\t\t\ttype: Array,\n\t\t\trequired: true,\n\t\t\tdefault: () => ([]),\n\t\t},\n\t\tmessage: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t\tdefault: () => ({}),\n\t\t},\n\t},\n\tdata(): {isMenuOpen: boolean} {\n\t\treturn {\n\t\t\tisMenuOpen: false,\n\t\t};\n\t},\n\tcomputed: {\n\t\titems(): MenuItemOptions[] {\n\t\t\treturn this.menuItems.map((item: MenuItemOptions) => {\n\t\t\t\treturn {\n\t\t\t\t\t...item,\n\t\t\t\t\tonclick: (event: PointerEvent, menuItem: MenuItem) => {\n\t\t\t\t\t\tconst myCustomData: MenuItemOnClickCustomData = {\n\t\t\t\t\t\t\tmessage: {\n\t\t\t\t\t\t\t\tid: this.message.id,\n\t\t\t\t\t\t\t\tcontent: this.message.content,\n\t\t\t\t\t\t\t\tdateCreated: this.message.dateCreated,\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t};\n\n\t\t\t\t\t\tthis.hideMenu();\n\n\t\t\t\t\t\treturn item.onclick(event, menuItem, myCustomData);\n\t\t\t\t\t},\n\t\t\t\t};\n\t\t\t});\n\t\t},\n\t\tmenuIconProps(): { name: string, size: number} {\n\t\t\treturn {\n\t\t\t\tname: Set.MORE,\n\t\t\t\tsize: 22,\n\t\t\t};\n\t\t},\n\t\tmenuButtonClassname(): Object {\n\t\t\treturn {\n\t\t\t\t'ai__copilot-chat-message-menu': true,\n\t\t\t\t'--open': this.isMenuOpen,\n\t\t\t};\n\t\t},\n\t},\n\tmethods: {\n\t\ttoggleMenu(): void {\n\t\t\tif (this.isMenuOpen)\n\t\t\t{\n\t\t\t\tthis.hideMenu();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.showMenu();\n\t\t\t}\n\t\t},\n\t\tshowMenu(): void {\n\t\t\tif (!this.menu)\n\t\t\t{\n\t\t\t\tthis.initMenu();\n\t\t\t}\n\n\t\t\tthis.menu?.show();\n\t\t},\n\t\thideMenu(): void {\n\t\t\tthis.menu?.close();\n\t\t},\n\t\tinitMenu(): Menu {\n\t\t\tthis.menu = new Menu({\n\t\t\t\titems: this.items,\n\t\t\t\tangle: {\n\t\t\t\t\toffset: Dom.getPosition(this.$refs.menuButton).width / 2 + 23,\n\t\t\t\t},\n\t\t\t\tevents: {\n\t\t\t\t\tonPopupShow: () => {\n\t\t\t\t\t\tthis.isMenuOpen = true;\n\t\t\t\t\t},\n\t\t\t\t\tonPopupClose: () => {\n\t\t\t\t\t\tthis.isMenuOpen = false;\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\tbindElement: this.$refs.menuButton,\n\t\t\t});\n\n\t\t\tbind(document.body.querySelector('.ai__copilot-chat_main'), 'scroll', () => {\n\t\t\t\tthis.hideMenu();\n\t\t\t});\n\n\t\t\treturn this.menu;\n\t\t},\n\t},\n\tbeforeUnmount() {\n\t\tthis.menu?.destroy();\n\t},\n\ttemplate: `\n\t\t<button\n\t\t\tref=\"menuButton\"\n\t\t\t@click=\"toggleMenu\"\n\t\t\t:class=\"menuButtonClassname\"\n\t\t>\n\t\t\t<BIcon v-bind=\"menuIconProps\"></BIcon>\n\t\t</button>\n\t`,\n};\n","import { Dom } from 'main.core';\nimport { isMessageFromCopilot } from '../../helpers/is-message-from-copilot';\nimport { CopilotChatMessageMenu } from './copilot-chat-message-menu';\nimport type { CopilotChatMessage, CopilotChatMessageButton } from '../../types';\nimport { HtmlFormatter } from 'ui.bbcode.formatter.html-formatter';\n\nimport '../../css/copilot-chat-message.css';\n\nexport const CopilotChatMessageDefault = {\n\tcomponents: {\n\t\tCopilotChatMessageMenu,\n\t},\n\temits: ['buttonClick'],\n\tprops: {\n\t\tmessage: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t\tavatar: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t\ttitle: {\n\t\t\ttype: String,\n\t\t\trequired: false,\n\t\t},\n\t\tuseAvatarTail: {\n\t\t\ttype: Boolean,\n\t\t\trequired: false,\n\t\t\tdefault: false,\n\t\t},\n\t\tmenuItems: {\n\t\t\ttype: Array,\n\t\t\trequired: false,\n\t\t\tdefault: () => ([]),\n\t\t},\n\t\tcolor: {\n\t\t\ttype: String,\n\t\t\trequired: false,\n\t\t\tdefault: '',\n\t\t},\n\t\tdisableAllActions: {\n\t\t\ttype: Boolean,\n\t\t\trequired: false,\n\t\t\tdefault: false,\n\t\t},\n\t},\n\tcomputed: {\n\t\tmessageData(): CopilotChatMessage {\n\t\t\treturn this.message;\n\t\t},\n\t\tmessageContent(): string {\n\t\t\treturn this.messageData.content;\n\t\t},\n\t\tisMessageFromCopilot(): boolean {\n\t\t\treturn isMessageFromCopilot(this.messageData.authorId);\n\t\t},\n\t\tformattedMessageContent(): DocumentFragment {\n\t\t\tconst htmlFormatter = new HtmlFormatter({\n\t\t\t\tcontainerMode: 'collapsed',\n\t\t\t});\n\n\t\t\treturn htmlFormatter.format({\n\t\t\t\tsource: this.messageContent,\n\t\t\t});\n\t\t},\n\t\tformattedDeliveryTime(): string {\n\t\t\treturn this.formatTime(this.messageData.dateCreated);\n\t\t},\n\t\tmessageButtons(): CopilotChatMessageButton[] {\n\t\t\treturn this.messageData.params?.buttons ?? [];\n\t\t},\n\t\tisSomeButtonSelected(): boolean {\n\t\t\treturn this.messageButtons.some((button) => button.isSelected);\n\t\t},\n\t\tshowMenuButton(): boolean {\n\t\t\treturn this.menuItems?.length > 0;\n\t\t},\n\t},\n\tmethods: {\n\t\tformatTime(dateTime: string): string {\n\t\t\tif (!dateTime)\n\t\t\t{\n\t\t\t\treturn '';\n\t\t\t}\n\n\t\t\tconst date = new Date(dateTime);\n\n\t\t\tconst hours: string = date.getHours().toString().padStart(2, '0');\n\t\t\tconst minutes: string = date.getMinutes().toString().padStart(2, '0');\n\n\t\t\treturn `${hours}:${minutes}`;\n\t\t},\n\t},\n\tmounted() {\n\t\tif (this.isMessageFromCopilot)\n\t\t{\n\t\t\tDom.append(this.formattedMessageContent, this.$refs.content);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.$refs.content.innerText = this.messageContent;\n\t\t}\n\t},\n\ttemplate: `\n\t\t<div\n\t\t\t:data-id=\"messageData.id\"\n\t\t\tclass=\"ai__copilot-chat-message\"\n\t\t\t:class=\"'--color-schema-' + color\"\n\t\t>\n\t\t\t<div\n\t\t\t\tclass=\"ai__copilot-chat-message-content-wrapper\"\n\t\t\t\t:class=\"{ '--with-tail': useAvatarTail }\"\n\t\t\t>\n\t\t\t\t<div class=\"ai__copilot-chat-message-content\">\n\t\t\t\t\t<div class=\"ai__copilot-chat-message-content-main\">\n\t\t\t\t\t\t<div\n\t\t\t\t\t\t\tv-if=\"title\"\n\t\t\t\t\t\t\tclass=\"ai__copilot-chat-message-title\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{{ title }}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"ai__copilot-chat-message-text\" ref=\"content\"></div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"ai__copilot-chat-message_status-info\">\n\t\t\t\t\t\t<div\n\t\t\t\t\t\t\tv-if=\"messageData.dateCreated\"\n\t\t\t\t\t\t\tclass=\"ai__copilot-chat-message_time\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{{ formattedDeliveryTime }}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div\n\t\t\t\t\t\t\tv-if=\"messageData.status\"\n\t\t\t\t\t\t\tclass=\"ai__copilot-chat-message_status\"\n\t\t\t\t\t\t\t:class=\"'--' + messageData.status\"\n\t\t\t\t\t\t></div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div v-if=\"messageButtons.length > 0\" class=\"ai__copilot-chat-message_action-buttons\">\n\t\t\t\t\t<button\n\t\t\t\t\t\tv-for=\"button in messageButtons\"\n\t\t\t\t\t\tclass=\"ai__copilot-chat-message_action-button\"\n\t\t\t\t\t\t:class=\"{'--selected': button.isSelected}\"\n\t\t\t\t\t\t:disabled=\"isSomeButtonSelected || disableAllActions\"\n\t\t\t\t\t\t@click=\"$emit('buttonClick', button.id)\"\n\t\t\t\t\t>\n\t\t\t\t\t\t{{ button.text }}\n\t\t\t\t\t</button>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div\n\t\t\t\tv-if=\"showMenuButton\"\n\t\t\t\tclass=\"ai__copilot-chat-message_menu\"\n\t\t\t>\n\t\t\t\t<CopilotChatMessageMenu\n\t\t\t\t\t:menu-items=\"menuItems\"\n\t\t\t\t\t:message=\"message\"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import type { CopilotChatMessage } from '../../types';\n\nimport '../../css/copilot-chat-message-welcome.css';\nexport const CopilotChatMessageWelcome = {\n\tprops: {\n\t\tmessage: {\n\t\t\ttype: Object,\n\t\t\trequired: false,\n\t\t},\n\t\tavatar: {\n\t\t\ttype: String,\n\t\t\trequired: false,\n\t\t},\n\t},\n\tcomputed: {\n\t\tmessageInfo(): CopilotChatMessage {\n\t\t\treturn this.message;\n\t\t},\n\t\ttitle(): string {\n\t\t\treturn this.messageInfo.params?.title ?? '';\n\t\t},\n\t\tsubtitle(): string {\n\t\t\treturn this.messageInfo.params?.subtitle ?? '';\n\t\t},\n\t\tcontent(): string {\n\t\t\treturn this.messageInfo.params?.content ?? '';\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"ai__copilot-chat-message-welcome\">\n\t\t\t<header class=\"ai__copilot-chat-message-welcome_header\">\n\t\t\t\t<div class=\"ai__copilot-chat-message-welcome_header-left\">\n\t\t\t\t\t<img\n\t\t\t\t\t\t:src=\"avatar\"\n\t\t\t\t\t\talt=\"#\"\n\t\t\t\t\t\tclass=\"ai__copilot-chat-message-welcome_avatar\"\n\t\t\t\t\t>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"ai__copilot-chat-message-welcome_header-right\">\n\t\t\t\t\t<h5 class=\"ai__copilot-chat-message-welcome_title\">{{ title }}</h5>\n\t\t\t\t\t<p v-if=\"subtitle\" class=\"ai__copilot-chat-message-welcome_subtitle\">{{ subtitle }}</p>\n\t\t\t\t</div>\n\t\t\t</header>\n\t\t\t<main class=\"ai__copilot-chat-message-welcome_main\">\n\t\t\t\t<div class=\"ai__copilot-chat-message-welcome_content\">\n\t\t\t\t\t<slot name=\"content\">\n\t\t\t\t\t\t{{ content }}\n\t\t\t\t\t</slot>\n\t\t\t\t</div>\n\t\t\t</main>\n\t\t</div>\n\t`,\n};\n","import { bind, Dom, Tag } from 'main.core';\nimport type { CopilotChatMessage } from '../../types';\nimport { CopilotChatMessageWelcome } from './copilot-chat-message-welcome';\n\nexport const CopilotChatMessageSiteWithAi = {\n\tcomponents: {\n\t\tCopilotChatMessageWelcome,\n\t},\n\tprops: {\n\t\tmessage: {\n\t\t\ttype: Object,\n\t\t\trequired: false,\n\t\t},\n\t\tavatar: {\n\t\t\ttype: String,\n\t\t\trequired: false,\n\t\t},\n\t\tdisableAllActions: {\n\t\t\ttype: Boolean,\n\t\t\trequired: false,\n\t\t\tdefault: false,\n\t\t},\n\t},\n\tcomputed: {\n\t\tmessageInfo(): CopilotChatMessage {\n\t\t\treturn {\n\t\t\t\t...this.message,\n\t\t\t\tparams: {\n\t\t\t\t\t...this.message.params,\n\t\t\t\t\ttitle: 'Привет! Я — Веб-дизайнер',\n\t\t\t\t\tsubtitle: '',\n\t\t\t\t\tcontent: '',\n\t\t\t\t},\n\t\t\t};\n\t\t},\n\t},\n\tmethods: {\n\t\trenderContent(): void {\n\t\t\tconst paragraph2 = this.$Bitrix.Loc.getMessage('AI_COPILOT_CHAT_WELCOME_MESSAGE_SITE_WITH_AI_2', {\n\t\t\t\t'#LINK#': `<a href=\"#\" class=\"${this.disableAllActions ? 'disabled' : ''}\" ref=\"createSiteLink\">`,\n\t\t\t\t'#/LINK#': '</a>',\n\t\t\t});\n\n\t\t\tconst content = Tag.render`\n\t\t\t\t<div>\n\t\t\t\t\t<p>${this.$Bitrix.Loc.getMessage('AI_COPILOT_CHAT_WELCOME_MESSAGE_SITE_WITH_AI_1')}</p>\n\t\t\t\t\t<p>${paragraph2}</p>\n\t\t\t\t</div>\n\t\t\t`;\n\n\t\t\tbind(content.createSiteLink, 'click', () => {\n\t\t\t\t// TODO add some action here\n\t\t\t});\n\n\t\t\tthis.$refs.content.innerHTML = '';\n\t\t\tDom.append(content.root, this.$refs.content);\n\t\t},\n\t},\n\twatch: {\n\t\tdisableAllActions() {\n\t\t\tthis.renderContent();\n\t\t},\n\t},\n\tmounted() {\n\t\tthis.renderContent();\n\t},\n\ttemplate: `\n\t\t<CopilotChatMessageWelcome\n\t\t\t:avatar=\"avatar\"\n\t\t\t:message=\"messageInfo\"\n\t\t>\n\t\t\t<template #content>\n\t\t\t\t<div ref=\"content\"></div>\n\t\t\t</template>\n\t\t</CopilotChatMessageWelcome>\n\t`,\n};\n","import type { CopilotChatMessage } from '../../types';\nimport { CopilotChatMessageWelcome } from './copilot-chat-message-welcome';\n\nexport const CopilotChatMessageWelcomeFlows = {\n\tcomponents: {\n\t\tCopilotChatMessageWelcome,\n\t},\n\tprops: {\n\t\tmessage: {\n\t\t\ttype: Object,\n\t\t\trequired: false,\n\t\t},\n\t\tavatar: {\n\t\t\ttype: String,\n\t\t\trequired: false,\n\t\t},\n\t},\n\tcomputed: {\n\t\tmessageInfo(): CopilotChatMessage {\n\t\t\treturn this.message;\n\t\t},\n\t},\n\ttemplate: `\n\t\t<CopilotChatMessageWelcome\n\t\t\t:avatar=\"avatar\"\n\t\t\t:message=\"messageInfo\"\n\t\t/>\n\t`,\n};\n","export * from './copilot-chat-message-default';\nexport * from './copilot-chat-message-site-with-ai';\nexport * from './copilot-chat-message-welcome';\nexport * from './copilot-chat-message-welcome-flows';\n\nexport const CopilotChatMessageColor = Object.freeze({\n\tUSER: 'user',\n\tCOPILOT: 'copilot',\n\tERROR: 'error',\n\tUSER_WITH_HIGHLIGHT_TEXT: 'userWithHighlightText',\n});\n","import { Dom } from 'main.core';\nimport { isMessageFromCopilot } from '../helpers/is-message-from-copilot';\nimport { CopilotChatMessage } from './copilot-chat-message';\nimport { CopilotChatWelcomeMessage } from './copilot-chat-welcome-message';\nimport { CopilotChatMessagesDateGroup } from './copilot-chat-messages-date-group';\nimport { CopilotChatMessagesAuthorGroup } from './copilot-chat-messages-author-group';\nimport { type CopilotChatMessage as CopilotChatMessageData, CopilotChatMessageType } from '../types';\nimport { CopilotChatNewMessageVisibilityObserver } from './directives/copilot-chat-new-message-visibility-observer';\nimport {\n\tCopilotChatMessageDefault,\n\tCopilotChatMessageWelcome,\n\tCopilotChatMessageSiteWithAi,\n\tCopilotChatMessageWelcomeFlows, CopilotChatMessageColor,\n} from './message';\n\nimport '../css/copilot-chat-messages.css';\n\nexport const CopilotChatMessages = {\n\tcomponents: {\n\t\tCopilotChatMessage,\n\t\tCopilotChatWelcomeMessage,\n\t\tCopilotChatMessageDefault,\n\t\tCopilotChatMessageWelcome,\n\t\tCopilotChatMessageSiteWithAi,\n\t\tCopilotChatMessageWelcomeFlows,\n\t\tCopilotChatMessagesDateGroup,\n\t\tCopilotChatMessagesAuthorGroup,\n\t},\n\temits: ['clickMessageButton'],\n\tprops: {\n\t\tmessages: {\n\t\t\ttype: Array,\n\t\t\trequired: false,\n\t\t\tdefault: () => ([]),\n\t\t},\n\t\tcopilotAvatar: String,\n\t\tuserAvatar: String,\n\t\tcopilotMessageTitle: {\n\t\t\ttype: String,\n\t\t\trequired: false,\n\t\t\tdefault: '',\n\t\t},\n\t\tuserMessageMenuItems: {\n\t\t\ttype: Array,\n\t\t\trequired: false,\n\t\t\tdefault: () => ([]),\n\t\t},\n\t\tcopilotMessageMenuItems: {\n\t\t\ttype: Array,\n\t\t\trequired: false,\n\t\t\tdefault: () => ([]),\n\t\t},\n\t\twelcomeMessageHtmlElement: HTMLElement,\n\t},\n\tinject: ['observer'],\n\tdirectives: {\n\t\tCopilotChatNewMessageVisibilityObserver,\n\t},\n\tcomputed: {\n\t\tmessagesList(): CopilotChatMessageData[] {\n\t\t\treturn this.messages;\n\t\t},\n\t\tmessagesGroupedByDayAndAuthor(): Array {\n\t\t\tconst groupsOfMessages = this.groupMessagesByDay(this.messagesList);\n\n\t\t\tconst result = {};\n\n\t\t\tObject.entries(groupsOfMessages).forEach(([date: string, { messages, isNewMessagesStartHere }]) => {\n\t\t\t\tresult[date] = this.groupMessagesByAuthor(messages, isNewMessagesStartHere);\n\t\t\t});\n\n\t\t\treturn result;\n\t\t},\n\t\tsortedByDateMessagesGroups(): string[] {\n\t\t\treturn Object.keys(this.messagesGroupedByDayAndAuthor).sort();\n\t\t},\n\t},\n\tmethods: {\n\t\tgroupMessagesByDay(messages: CopilotChatMessageData[]): { [string]: CopilotChatMessageData[] } {\n\t\t\tlet isMessagesContainsUnread = false;\n\n\t\t\treturn messages.reduce((groupedMessages, message) => {\n\t\t\t\tconst messageDeliveryDate = new Date(message.dateCreated);\n\t\t\t\tconst messageIsoDate = this.formatISODate(messageDeliveryDate);\n\n\t\t\t\tif (groupedMessages[messageIsoDate] === undefined)\n\t\t\t\t{\n\t\t\t\t\tgroupedMessages[messageIsoDate] = {\n\t\t\t\t\t\tmessages: [],\n\t\t\t\t\t\tisNewMessagesStartHere: false,\n\t\t\t\t\t};\n\t\t\t\t}\n\n\t\t\t\tif (message.viewed === false && isMessagesContainsUnread === false)\n\t\t\t\t{\n\t\t\t\t\tgroupedMessages[messageIsoDate].isNewMessagesStartHere = true;\n\t\t\t\t\tisMessagesContainsUnread = true;\n\t\t\t\t}\n\n\t\t\t\tgroupedMessages[messageIsoDate].messages.push(message);\n\n\t\t\t\treturn groupedMessages;\n\t\t\t}, {});\n\t\t},\n\t\tgroupMessagesByAuthor(messages: CopilotChatMessageData[], isNewMessagesStartHere: boolean): Array {\n\t\t\tlet currentAuthor: number | null = -Infinity;\n\n\t\t\tlet isNewMessagesLabelWasAdded = false;\n\n\t\t\treturn messages.reduce((messagesGroupedByAuthor: Array, message) => {\n\t\t\t\tif (message.viewed === false && isNewMessagesLabelWasAdded === false && isNewMessagesStartHere === true)\n\t\t\t\t{\n\t\t\t\t\tmessagesGroupedByAuthor.push([\n\t\t\t\t\t\tmessage.authorId,\n\t\t\t\t\t\t[],\n\t\t\t\t\t\ttrue,\n\t\t\t\t\t]);\n\n\t\t\t\t\tisNewMessagesLabelWasAdded = true;\n\t\t\t\t}\n\t\t\t\telse if (message.authorId !== currentAuthor)\n\t\t\t\t{\n\t\t\t\t\tmessagesGroupedByAuthor.push([\n\t\t\t\t\t\tmessage.authorId,\n\t\t\t\t\t\t[],\n\t\t\t\t\t]);\n\n\t\t\t\t\tcurrentAuthor = message.authorId;\n\t\t\t\t}\n\n\t\t\t\tmessagesGroupedByAuthor.at(-1)[1].push(message);\n\n\t\t\t\treturn messagesGroupedByAuthor;\n\t\t\t}, []);\n\t\t},\n\t\tgetMessageMenuItems(message: CopilotChatMessageData): Array {\n\t\t\tif (message.authorId === null || message.authorId === undefined)\n\t\t\t{\n\t\t\t\treturn [];\n\t\t\t}\n\n\t\t\treturn isMessageFromCopilot(message.authorId) ? this.copilotMessageMenuItems : this.userMessageMenuItems;\n\t\t},\n\t\tformatISODate(date: Date): string {\n\t\t\tconst year = date.getFullYear();\n\t\t\tconst month = (date.getMonth() + 1).toString().padStart(2, '0');\n\t\t\tconst day = date.getDate().toString().padStart(2, '0');\n\n\t\t\treturn `${year}-${month}-${day}`;\n\t\t},\n\t\tgetMessageColor(message: CopilotChatMessageData): string {\n\t\t\tif (message.type === CopilotChatMessageType.BUTTON_CLICK_MESSAGE)\n\t\t\t{\n\t\t\t\treturn CopilotChatMessageColor.USER_WITH_HIGHLIGHT_TEXT;\n\t\t\t}\n\n\t\t\tif (isMessageFromCopilot(message.authorId))\n\t\t\t{\n\t\t\t\treturn CopilotChatMessageColor.COPILOT;\n\t\t\t}\n\n\t\t\treturn CopilotChatMessageColor.USER;\n\t\t},\n\t\tgetMessageComponent(message: CopilotChatMessageData): Object {\n\t\t\tswitch (message.type)\n\t\t\t{\n\t\t\t\tcase CopilotChatMessageType.DEFAULT: return CopilotChatMessageDefault;\n\t\t\t\tcase CopilotChatMessageType.WELCOME_FLOWS: return CopilotChatMessageWelcomeFlows;\n\t\t\t\tcase CopilotChatMessageType.WELCOME_SITE_WITH_AI: return CopilotChatMessageSiteWithAi;\n\t\t\t\tdefault: return CopilotChatMessageDefault;\n\t\t\t}\n\t\t},\n\t\tgetMessageTitle(authorId: string): ?string {\n\t\t\treturn this.isMessageFromCopilot(authorId)\n\t\t\t\t? this.copilotMessageTitle\n\t\t\t\t: ''\n\t\t\t;\n\t\t},\n\t\tgetMessageAvatarByAuthorId(authorId: number): ?string {\n\t\t\treturn this.isMessageFromCopilot(authorId)\n\t\t\t\t? this.copilotAvatar\n\t\t\t\t: this.userAvatar\n\t\t\t;\n\t\t},\n\t\tgetAuthorMessagesGroupAvatar(authorId: number): string\n\t\t{\n\t\t\tif (authorId === null || authorId === undefined)\n\t\t\t{\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\treturn this.getMessageAvatarByAuthorId(authorId);\n\t\t},\n\t\tisMessageFromCopilot(authorId: number): boolean {\n\t\t\treturn authorId < 1;\n\t\t},\n\t\tisMessageHaveButtons(message: CopilotChatMessageData): boolean {\n\t\t\treturn message?.params?.buttons?.length > 0;\n\t\t},\n\t\thandleMessageButtonClick(messageId, buttonId): void {\n\t\t\tthis.$emit('clickMessageButton', {\n\t\t\t\tmessageId,\n\t\t\t\tbuttonId,\n\t\t\t});\n\t\t},\n\t\tisLastMessage(dateGroupIndex: number, authorGroupIndex: number, messageIndexAtAuthorGroup: number): boolean {\n\t\t\treturn (dateGroupIndex + 1) * (authorGroupIndex + 1) + messageIndexAtAuthorGroup === this.messages.length;\n\t\t},\n\t},\n\tmounted() {\n\t\tDom.append(this.welcomeMessageHtmlElement, this.$refs.welcomeMessage);\n\t},\n\ttemplate: `\n\t\t<CopilotChatMessagesDateGroup\n\t\t\tv-for=\"(date, dateGroupIndex) of sortedByDateMessagesGroups\"\n\t\t\t:date=\"date\"\n\t\t>\n\t\t\t<CopilotChatMessagesAuthorGroup\n\t\t\t\tv-for=\"([authorId, messagesFromCurrentAuthor, showNewMessagesLabel], authorGroupIndex) in messagesGroupedByDayAndAuthor[date]\"\n\t\t\t\t:avatar=\"getAuthorMessagesGroupAvatar(authorId)\"\n\t\t\t\t:show-new-messages-label=\"showNewMessagesLabel\"\n\t\t\t>\n\t\t\t\t<ul class=\"ai__copilot-chat-messages\">\n\t\t\t\t\t<li\n\t\t\t\t\t\tv-for=\"(message, index) of messagesFromCurrentAuthor\"\n\t\t\t\t\t\tclass=\"ai__copilot-chat-messages_message-wrapper\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<component :is=\"getMessageComponent(message)\" \n\t\t\t\t\t\t\t\tv-copilot-chat-new-message-visibility-observer=\"message.viewed\"\n\t\t\t\t\t\t\t\t@buttonClick=\"handleMessageButtonClick(message.id, $event)\"\n\t\t\t\t\t\t\t\t:message=\"message\"\n\t\t\t\t\t\t\t\t:title=\"getMessageTitle(message.authorId)\"\n\t\t\t\t\t\t\t\t:color=\"getMessageColor(message)\"\n\t\t\t\t\t\t\t\t:avatar=\"getMessageAvatarByAuthorId(message.authorId)\"\n\t\t\t\t\t\t\t\t:useAvatarTail=\"index === messagesFromCurrentAuthor.length - 1 && isMessageHaveButtons(message) === false\"\n\t\t\t\t\t\t\t\t:disable-all-actions=\"isLastMessage(dateGroupIndex, authorGroupIndex, index) === false\"\n\t\t\t\t\t\t\t\t:menu-items=\"getMessageMenuItems(message)\"\n\t\t\t\t\t\t></component>\n\t\t\t\t\t</li>\n\t\t\t\t</ul>\n\t\t\t</CopilotChatMessagesAuthorGroup>\n\t\n\t\t</CopilotChatMessagesDateGroup>\n\t`,\n};\n","import { Loader } from 'main.loader';\n\nimport '../css/copilot-chat-history-loader.css';\n\nexport const CopilotChatHistoryLoader = {\n\tbeforeMount() {\n\t\tconst color = getComputedStyle(document.body).getPropertyValue('--ui-color-base-02');\n\n\t\tthis.loader = new Loader({\n\t\t\tcolor,\n\t\t\tsize: 40,\n\t\t});\n\t},\n\tmounted() {\n\t\tthis.loader.show(this.$refs.loaderContainer);\n\t},\n\tunmounted() {\n\t\tthis.loader.hide();\n\t\tthis.loader = null;\n\t},\n\ttemplate: `\n\t\t<div class=\"ai__copilot-chat-history-loader\">\n\t\t\t<div ref=\"loaderContainer\" class=\"ai__copilot-chat-history-loader_animation-container\"></div>\n\t\t\t<div class=\"ai__copilot-chat_history-loader_text\">\n\t\t\t\t{{ $Bitrix.Loc.getMessage('AI_COPILOT_CHAT_MESSAGES_HISTORY_LOADER_TEXT') }}\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import { Reflection, Tag, Event, Dom } from 'main.core';\n\nexport const CopilotChatWarningMessage = {\n\tname: 'CopilotWarningMessage',\n\tmethods: {\n\t\tshowArticle(): void {\n\t\t\tconst Helper = Reflection.getClass('top.BX.Helper');\n\t\t\tconst articleCode: string = '20412666';\n\n\t\t\tHelper?.show(`redirect=detail&code=${articleCode}`);\n\t\t},\n\t},\n\tmounted() {\n\t\tconst warningMessage = Tag.render`<span>${this.$Bitrix.Loc.getMessage('AI_COPILOT_CHAT_ANSWER_WARNING', {\n\t\t\t'#LINK_START#': '<a ref=\"link\" href=\"#\">',\n\t\t\t'#LINK_END#': '</a>',\n\t\t})}</span>`;\n\n\t\tEvent.bind(warningMessage.link, 'click', this.showArticle);\n\n\t\tDom.append(warningMessage.root, this.$refs.container);\n\t},\n\ttemplate: `\n\t\t<div\n\t\t\tref=\"container\"\n\t\t\tclass=\"ai__copilot-chat-warning-message\"\n\t\t></div>\n\t`,\n};\n","import type { MenuItemOptions } from 'main.popup';\nimport { CopilotChatEvents } from '../copilot-chat';\n\nimport type { CopilotChatBotOptions, CopilotChat as CopilotChatInstance } from '../copilot-chat';\nimport { NewMessagesVisibilityObserver, NewMessagesVisibilityObserverEvents } from '../helpers/new-messages-visibility-observer';\nimport { CopilotChatHeader } from './copilot-chat-header';\nimport { CopilotChatInput } from './copilot-chat-input';\nimport type { CopilotChatMessage as CopilotChatMessageData } from '../types';\nimport { CopilotChatMessages } from './copilot-chat-messages';\nimport { CopilotChatHistoryLoader } from './copilot-chat-history-loader';\nimport { containerClassname as newMessagesLabelContainerClassname } from './copilot-chat-new-messages-label';\nimport { CopilotChatStatus } from './copilot-chat-status';\nimport { CopilotChatWarningMessage } from './copilot-chat-warning-message';\n\nimport '../css/copilot-chat.css';\nexport type CopilotChatHeaderProps = {\n\ttitle: string;\n\tsubtitle: string;\n\tavatar: string;\n\tuseCloseIcon?: boolean;\n\tmenu: ?CopilotChatMenuOptions;\n\textraParams?: Object;\n}\n\nexport type CopilotChatMenuOptions = {\n\titems: MenuItemOptions[];\n}\n\ntype CopilotChatData = {\n\tmessages: CopilotChatMessageData;\n}\n\nexport type CopilotChatSlots = {\n\tLOADER?: string;\n\tLOADER_ERROR?: string;\n};\n\nexport const CopilotChatSlot = {\n\tLOADER: 'loader',\n};\n\nexport const CopilotChat = {\n\tname: 'CopilotChat',\n\tcomponents: {\n\t\tCopilotChatHeader,\n\t\tCopilotChatMessages,\n\t\tCopilotChatInput,\n\t\tCopilotChatHistoryLoader,\n\t\tCopilotChatStatus,\n\t\tCopilotChatWarningMessage,\n\t},\n\tprops: {\n\t\theader: Object,\n\t\twelcomeMessageHtml: HTMLElement,\n\t\tbotOptions: Object,\n\t\tscrollToTheEndAfterFirstShow: Object,\n\t\tslots: Object,\n\t\tisShowWarningMessage: {\n\t\t\ttype: Object,\n\t\t\trequired: false,\n\t\t\tdefault: () => ({ value: false }),\n\t\t},\n\t\tmessages: Array,\n\t\tcopilotChatInstance: Object,\n\t\tuseInput: {\n\t\t\ttype: Boolean,\n\t\t\trequired: false,\n\t\t\tdefault: true,\n\t\t},\n\t\tdisableInput: Object,\n\t\tshowLoader: Object,\n\t\tshowCopilotWritingStatus: Object,\n\t\tstatus: Object,\n\t\tuseStatus: Object,\n\t\tcopilotMessageMenuItems: {\n\t\t\ttype: Array,\n\t\t\trequired: false,\n\t\t\tdefault: () => ([]),\n\t\t},\n\t\tuserMessageMenuItems: {\n\t\t\ttype: Array,\n\t\t\trequired: false,\n\t\t\tdefault: () => ([]),\n\t\t},\n\t},\n\tdata(): CopilotChatData {\n\t\treturn {\n\t\t\tisCopilotWriting: false,\n\t\t\tisShowErrorScreen: false,\n\t\t};\n\t},\n\tprovide(): { instance: CopilotChatInstance} {\n\t\treturn {\n\t\t\tinstance: this.copilotChatInstance,\n\t\t\tobserver: this.observer,\n\t\t};\n\t},\n\tcomputed: {\n\t\tisInputDisabled(): boolean {\n\t\t\treturn this.disableInput.value === true;\n\t\t},\n\t\tisLoaderShown(): boolean {\n\t\t\treturn this.showLoader.value === true;\n\t\t},\n\t\tisWarningMessageShown(): boolean {\n\t\t\treturn this.isShowWarningMessage?.value === true;\n\t\t},\n\t\tinstance(): CopilotChatInstance {\n\t\t\treturn this.copilotChatInstance;\n\t\t},\n\t\tSlot(): CopilotChatSlots {\n\t\t\treturn {\n\t\t\t\t...this.slots,\n\t\t\t};\n\t\t},\n\t\theaderProps(): CopilotChatHeaderProps {\n\t\t\treturn {\n\t\t\t\ttitle: this.header?.title,\n\t\t\t\tsubtitle: this.header?.subtitle,\n\t\t\t\tavatar: this.header?.avatar,\n\t\t\t\tuseCloseIcon: this.header?.useCloseIcon,\n\t\t\t\tmenu: this.header?.menu,\n\t\t\t};\n\t\t},\n\t\tbotData(): CopilotChatBotOptions {\n\t\t\treturn {\n\t\t\t\tmessageTitle: this.botOptions.messageTitle,\n\t\t\t\tavatar: this.botOptions.avatar,\n\t\t\t\tmessageMenuItems: this.botOptions?.messageMenuItems ?? [],\n\t\t\t};\n\t\t},\n\t\tmessagesList(): CopilotChatMessageData[] {\n\t\t\treturn this.messages;\n\t\t},\n\t\thaveNewMessages(): boolean {\n\t\t\treturn this.messagesList.some((message) => message.viewed === false);\n\t\t},\n\t\tcopilotChatStatus(): string {\n\t\t\treturn this.status.value;\n\t\t},\n\t\tisChatStatusUsed(): boolean {\n\t\t\treturn this.useStatus.value;\n\t\t},\n\t\tisScrollToTheEndAfterMounted(): boolean {\n\t\t\treturn this.scrollToTheEndAfterFirstShow.value;\n\t\t},\n\t},\n\tmethods: {\n\t\thideChat(): void {\n\t\t\tthis.copilotChatInstance.hide();\n\t\t},\n\t\tasync handleSubmitMessage(userMessage: string): void {\n\t\t\tconst newMessage: CopilotChatMessageData = {\n\t\t\t\tcontent: userMessage,\n\t\t\t};\n\n\t\t\tthis.instance.addUserMessage(newMessage);\n\t\t},\n\t\tscrollMessagesListAfterOpen(): void {\n\t\t\tif (this.haveNewMessages)\n\t\t\t{\n\t\t\t\tconst newMessagesLabel: HTMLElement = this.$refs.main.querySelector(`.${newMessagesLabelContainerClassname}`);\n\n\t\t\t\tnewMessagesLabel?.scrollIntoView();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.scrollMessagesListToTheEnd();\n\t\t\t}\n\t\t},\n\t\tscrollMessagesListToTheEnd(isSmooth: boolean = false): void {\n\t\t\tthis.$refs.main.scrollTo({\n\t\t\t\tleft: 0,\n\t\t\t\ttop: 9999,\n\t\t\t\tbehavior: isSmooth ? 'smooth' : 'auto',\n\t\t\t});\n\t\t},\n\t\thandleClickOnMessageButton(eventData): void {\n\t\t\tthis.instance.emitClickOnMessageButton({\n\t\t\t\tmessageId: eventData.messageId,\n\t\t\t\tbuttonId: eventData.buttonId,\n\t\t\t});\n\t\t},\n\t\thandleAddNewUserMessage(): void {\n\t\t\trequestAnimationFrame(() => {\n\t\t\t\tthis.scrollMessagesListToTheEnd(true);\n\t\t\t});\n\t\t},\n\t},\n\tbeforeCreate() {\n\t\tthis.observer = new NewMessagesVisibilityObserver();\n\n\t\tthis.observer.subscribe(NewMessagesVisibilityObserverEvents.VIEW_NEW_MESSAGE, (event) => {\n\t\t\tthis.instance.setNewMessageIsViewed(event.getData().id);\n\t\t});\n\t},\n\tmounted() {\n\t\tthis.observer.setRoot(this.$refs.main);\n\t\tthis.observer.init();\n\n\t\tthis.instance.subscribe(CopilotChatEvents.ADD_USER_MESSAGE, this.handleAddNewUserMessage);\n\n\t\trequestAnimationFrame(() => {\n\t\t\tif (this.isScrollToTheEndAfterMounted)\n\t\t\t{\n\t\t\t\tthis.scrollMessagesListAfterOpen();\n\t\t\t}\n\t\t});\n\t},\n\tbeforeUnmount() {\n\t\tthis.instance.unsubscribe(CopilotChatEvents.ADD_USER_MESSAGE, this.handleAddNewUserMessage);\n\t},\n\twatch: {\n\t\t'messagesList.length': function(newMessagesCount, oldMessagesCount) {\n\t\t\trequestAnimationFrame(() => {\n\t\t\t\tif (oldMessagesCount === 0 && newMessagesCount > 1 && this.isScrollToTheEndAfterMounted)\n\t\t\t\t{\n\t\t\t\t\tthis.scrollMessagesListToTheEnd();\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"ai__copilot-chat\">\n\t\t\t<header class=\"ai__copilot-chat_header\">\n\t\t\t\t<CopilotChatHeader\n\t\t\t\t\t:title=\"headerProps.title\"\n\t\t\t\t\t:subtitle=\"headerProps.subtitle\"\n\t\t\t\t\t:avatar=\"headerProps.avatar\"\n\t\t\t\t\t:use-close-icon=\"headerProps.useCloseIcon\"\n\t\t\t\t\t:menu=\"headerProps.menu\"\n\t\t\t\t\t@clickOnCloseIcon=\"hideChat\"\n\t\t\t\t/>\n\t\t\t</header>\n\t\t\t<main ref=\"main\" class=\"ai__copilot-chat_main\">\n\t\t\t\t<div\n\t\t\t\t\tv-if=\"isLoaderShown\"\n\t\t\t\t\tclass=\"ai__copilot-chat_main-loader-container\"\n\t\t\t\t>\n\t\t\t\t\t<slot name=\"loader\">\n\t\t\t\t\t\t<CopilotChatHistoryLoader />\n\t\t\t\t\t</slot>\n\t\t\t\t</div>\n\t\t\t\t<div v-else-if=\"isShowErrorScreen\">\n\t\t\t\t\t<slot name=\"loaderError\">\n\t\t\t\t\t\tSorry, we can't load messages, try later\n\t\t\t\t\t</slot>\n\t\t\t\t</div>\n\t\t\t\t<CopilotChatMessages\n\t\t\t\t\tv-else\n\t\t\t\t\t@clickMessageButton=\"handleClickOnMessageButton\"\n\t\t\t\t\tuser-avatar=\"/bitrix/js/ui/icons/b24/images/ui-user.svg?v2\"\n\t\t\t\t\t:copilot-avatar=\"botData.avatar\"\n\t\t\t\t\t:messages=\"messagesList\"\n\t\t\t\t\t:welcome-message-html-element=\"welcomeMessageHtml\"\n\t\t\t\t\t:copilot-message-title=\"botData.messageTitle\"\n\t\t\t\t\t:copilot-message-menu-items=\"botData.messageMenuItems\"\n\t\t\t\t\t:user-message-menu-items=\"userMessageMenuItems\"\n\t\t\t\t></CopilotChatMessages>\n\t\t\t\t<CopilotChatStatus\n\t\t\t\t\tv-if=\"isLoaderShown === false && isChatStatusUsed\"\n\t\t\t\t\t:status=\"copilotChatStatus\"\n\t\t\t\t/>\n\t\t\t\t<div id=\"anchor\"></div>\n\t\t\t</main>\n\t\t\t<footer class=\"ai__copilot-chat_footer\">\n\t\t\t\t<CopilotChatInput\n\t\t\t\t\tv-if=\"useInput\"\n\t\t\t\t\t:disabled=\"isInputDisabled\"\n\t\t\t\t\t@submit=\"handleSubmitMessage\"\n\t\t\t\t/>\n\t\t\t\t<div\n\t\t\t\t\tv-if=\"isWarningMessageShown\"\n\t\t\t\t\tclass=\"ai__copilot-chat_warning-message\"\n\t\t\t\t>\n\t\t\t\t\t<CopilotChatWarningMessage />\n\t\t\t\t</div>\n\t\t\t</footer>\n\t\t</div>\n\t`,\n};\n","import { Tag, Type } from 'main.core';\nimport { BaseEvent, EventEmitter } from 'main.core.events';\nimport { Popup, type PopupOptions, type MenuItemOptions } from 'main.popup';\nimport { type VueRefValue, BitrixVue, ref } from 'ui.vue3';\nimport { Status as CopilotChatStatus } from './components/copilot-chat-status';\nimport { CopilotChat as CopilotChatComponent, type CopilotChatHeaderProps, type CopilotChatSlots } from './components/copilot-chat.js';\n\nimport './css/copilot-chat-popup.css';\nimport type { CopilotChatMessage, CopilotChatMessageButton } from './types';\n\nexport type CopilotChatBotOptions = {\n\tavatar: string;\n\tmessageTitle: string;\n\tmessageMenuItems: MenuItemOptions[],\n}\n\nexport const CopilotChatEvents = Object.freeze({\n\tADD_USER_MESSAGE: 'addUserMessage',\n\tADD_BOT_MESSAGE: 'addBotMessage',\n\tADD_OLD_MESSAGES: 'addBotMessage',\n\tADD_NEW_MESSAGES: 'addMessages',\n\tCLICK_ON_MESSAGE_BUTTON: 'clickOnMessageButton',\n\tVIEW_NEW_MESSAGE: 'viewMessage',\n\tSHOW_LOADER: 'showLoader',\n\tHIDE_LOADER: 'hideLoader',\n\tSHOW_COPILOT_WRITING_LOADER: 'showCopilotWritingLoader',\n\tHIDE_COPILOT_WRITING_LOADER: 'hideCopilotWritingLoader',\n\tDISABLE_INPUT_FIELD: 'disableInputField',\n\tENABLE_INPUT_FIELD: 'enableInputField',\n\tSET_MESSAGE_STATUS: 'setMessageStatus',\n\tSHOW_ERROR_SCREEN: 'showErrorScreen',\n\tHIDE_ERROR_SCREEN: 'hideErrorScreen',\n});\n\nexport const CopilotChatMessageStatus = {\n\tDEPART: 'depart',\n\tSENT: 'sent',\n\tDELIVERED: 'delivered',\n\tERROR: 'error',\n};\n\nexport type CopilotChatOptions = {\n\theader: CopilotChatHeaderProps;\n\tbotOptions: CopilotChatBotOptions;\n\tslots: CopilotChatSlots;\n\tvueComponents: Object;\n\tpopupOptions: PopupOptions;\n\tuseChatStatus: boolean;\n\tcopilotMessageMenuItems: MenuItemOptions[];\n\tuserMessageMenuItems: MenuItemOptions[];\n\tscrollToTheEndAfterFirstShow: boolean;\n\tshowCopilotWarningMessage: boolean;\n}\n\nexport class CopilotChat extends EventEmitter\n{\n\t#copilotChatOptions: CopilotChatOptions;\n\t#popupOptions: PopupOptions;\n\t#popup: Popup;\n\t#app;\n\t#messages: VueRefValue<CopilotChatMessage[]>;\n\t#isShowLoader: VueRefValue<boolean>;\n\t#isInputDisabled: VueRefValue<boolean>;\n\t#chatStatus: VueRefValue<string>;\n\t#useChatStatus: VueRefValue<boolean>;\n\t#copilotMessageMenuItems: VueRefValue<MenuItemOptions[]>;\n\t#userMessageMenuItems: VueRefValue<MenuItemOptions[]>;\n\t#scrollToTheEndAfterFirstShow: VueRefValue<boolean>;\n\t#showCopilotWarningMessage: VueRefValue<boolean>;\n\t#copilotChatBotOptions: VueRefValue<CopilotChatBotOptions>;\n\n\tconstructor(options: CopilotChatOptions = {})\n\t{\n\t\tsuper(options);\n\n\t\tthis.setEventNamespace('AI.CopilotChat');\n\t\tthis.#copilotChatOptions = options || {};\n\t\tthis.#copilotChatBotOptions = ref(options?.botOptions ?? {});\n\t\tthis.#popupOptions = options?.popupOptions || {};\n\n\t\tthis.#messages = ref([]);\n\t\tthis.#copilotMessageMenuItems = ref(\n\t\t\tType.isArray(options.botOptions.messageMenuItems) ? options.botOptions.messageMenuItems : [],\n\t\t);\n\t\tthis.#userMessageMenuItems = ref(Type.isArray(options.userMessageMenuItems) ? options.userMessageMenuItems : []);\n\t\tthis.#isShowLoader = ref(false);\n\t\tthis.#isInputDisabled = ref(false);\n\t\tthis.#chatStatus = ref(CopilotChatStatus.NONE);\n\t\tthis.#useChatStatus = ref(Type.isBoolean(options.useChatStatus) ? options.useChatStatus : true);\n\t\tthis.#scrollToTheEndAfterFirstShow = ref(\n\t\t\tType.isBoolean(options.scrollToTheEndAfterFirstShow)\n\t\t\t\t? options.scrollToTheEndAfterFirstShow\n\t\t\t\t: true,\n\t\t);\n\t\tthis.#showCopilotWarningMessage = ref(options.showCopilotWarningMessage === true);\n\t}\n\n\tstatic getDefaultMinWidth(): number\n\t{\n\t\treturn 375;\n\t}\n\n\tstatic getDefaultHeight(): number\n\t{\n\t\treturn 669;\n\t}\n\n\taddUserMessage(message: CopilotChatMessage): void\n\t{\n\t\tconst newUserMessage: CopilotChatMessage = {\n\t\t\t...message,\n\t\t\tauthorId: 1,\n\t\t};\n\n\t\tthis.#addNewMessage(newUserMessage);\n\t}\n\n\taddBotMessage(message: CopilotChatMessage): void\n\t{\n\t\tconst newUserMessage: CopilotChatMessage = {\n\t\t\t...message,\n\t\t\tauthorId: 0,\n\t\t\tstatus: null,\n\t\t};\n\n\t\tthis.#addNewMessage(newUserMessage);\n\t}\n\n\taddSystemMessage(message: CopilotChatMessage): void\n\t{\n\t\tconst newSystemMessage: CopilotChatMessage = {\n\t\t\t...message,\n\t\t\tauthorId: null,\n\t\t\tstatus: null,\n\t\t};\n\n\t\tthis.#addNewMessage(newSystemMessage);\n\t}\n\n\tenableInput(): void\n\t{\n\t\tthis.#isInputDisabled.value = false;\n\n\t\tthis.emit(CopilotChatEvents.ENABLE_INPUT_FIELD);\n\t}\n\n\tdisableInput(): void\n\t{\n\t\tthis.#isInputDisabled.value = true;\n\n\t\tthis.emit(CopilotChatEvents.DISABLE_INPUT_FIELD);\n\t}\n\n\tshowLoader(): void\n\t{\n\t\tthis.#isShowLoader.value = true;\n\n\t\tthis.emit(CopilotChatEvents.SHOW_LOADER);\n\t}\n\n\thideLoader(): void\n\t{\n\t\tthis.#isShowLoader.value = false;\n\n\t\tthis.emit(CopilotChatEvents.HIDE_LOADER);\n\t}\n\n\tsetMessageStatusDepart(messageId: string): void\n\t{\n\t\tthis.#setMessageStatus(messageId, CopilotChatMessageStatus.DEPART);\n\t}\n\n\tsetMessageStatusDelivered(messageId: string): void\n\t{\n\t\tthis.#setMessageStatus(messageId, CopilotChatMessageStatus.DELIVERED);\n\t}\n\n\tsetMessageStatusSent(messageId: string): void\n\t{\n\t\tthis.#setMessageStatus(messageId, CopilotChatMessageStatus.SENT);\n\t}\n\n\tsetCopilotWritingStatus(value: boolean): void\n\t{\n\t\tif (value === true)\n\t\t{\n\t\t\tthis.#chatStatus.value = CopilotChatStatus.COPILOT_WRITING;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.#chatStatus.value = CopilotChatStatus.NONE;\n\t\t}\n\t}\n\n\tsetNewMessageIsViewed(messageId: number): void\n\t{\n\t\tthis.emit(CopilotChatEvents.VIEW_NEW_MESSAGE, new BaseEvent({\n\t\t\tdata: {\n\t\t\t\tid: messageId,\n\t\t\t},\n\t\t}));\n\t}\n\n\temitClickOnMessageButton(data: { buttonId: number, messageId: number }): void\n\t{\n\t\tconst { buttonId, messageId } = data;\n\n\t\tconst clickedMessageButton = this.#findMessageButton(messageId, buttonId);\n\n\t\tclickedMessageButton.isSelected = true;\n\n\t\tthis.emit(CopilotChatEvents.CLICK_ON_MESSAGE_BUTTON, {\n\t\t\tmessageId,\n\t\t\tbutton: { ...clickedMessageButton },\n\t\t});\n\t}\n\n\t#findMessageButton(messageId: number, buttonId: number): ?CopilotChatMessageButton\n\t{\n\t\tconst searchedMessage = this.#messages.value.find((message) => message.id === messageId);\n\n\t\tif (Type.isArray(searchedMessage.params?.buttons) === false)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\treturn searchedMessage.params.buttons.find((button) => button.id === buttonId) ?? null;\n\t}\n\n\t#setMessageStatus(messageId: number, status: string): void\n\t{\n\t\tconst message: ?CopilotChatMessage = this.#messages.value.find((currentMessage) => currentMessage.id === messageId);\n\n\t\tif (!message)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tmessage.status = status;\n\n\t\tthis.emit(CopilotChatEvents.SET_MESSAGE_STATUS, {\n\t\t\tmessageId,\n\t\t\tstatus,\n\t\t});\n\t}\n\n\t#addNewMessage(message: CopilotChatMessage): void\n\t{\n\t\tconst newMessageId = Math.round(-Math.random() * 1000);\n\n\t\tconst isCopilotChatShown = this.isShown();\n\n\t\tconst newMessage: CopilotChatMessage = {\n\t\t\tid: newMessageId,\n\t\t\tdateCreated: (new Date()).toISOString(),\n\t\t\tstatus: CopilotChatMessageStatus.DEPART,\n\t\t\tauthorId: 0,\n\t\t\t...message,\n\t\t\tviewed: message?.viewed ?? isCopilotChatShown,\n\t\t};\n\n\t\tthis.#messages.value.push(newMessage);\n\n\t\tif (newMessage.authorId === 0)\n\t\t{\n\t\t\tthis.emit(CopilotChatEvents.ADD_BOT_MESSAGE, {\n\t\t\t\tmessage: newMessage,\n\t\t\t});\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.emit(CopilotChatEvents.ADD_USER_MESSAGE, {\n\t\t\t\tmessage: newMessage,\n\t\t\t});\n\t\t}\n\t}\n\n\tshow(): void\n\t{\n\t\tif (!this.#popup)\n\t\t{\n\t\t\tthis.#initPopup();\n\t\t}\n\n\t\tthis.#popup.show();\n\t}\n\n\thide(): void\n\t{\n\t\tthis.#popup?.close();\n\t}\n\n\tisShown(): boolean\n\t{\n\t\treturn Boolean(this.#popup?.isShown());\n\t}\n\n\t#initPopup(): Popup\n\t{\n\t\tthis.#popup = new Popup({\n\t\t\t...this.#popupOptions,\n\t\t\tcontent: this.#renderPopupContent(),\n\t\t\tminWidth: this.#popupOptions?.minWidth ?? CopilotChat.getDefaultMinWidth(),\n\t\t\theight: this.#popupOptions?.height ?? CopilotChat.getDefaultHeight(),\n\t\t\tcontentNoPaddings: true,\n\t\t\tpadding: 0,\n\t\t\tborderRadius: '16px',\n\t\t\tclassName: `ai__copilot-chat-popup ${this.#popupOptions.className ?? ''}`,\n\t\t\tcacheable: this.#popupOptions?.cacheable ?? false,\n\t\t\tevents: {\n\t\t\t\tonPopupAfterClose: () => {\n\t\t\t\t\tthis.#popup = null;\n\t\t\t\t\tthis.#app.unmount();\n\n\t\t\t\t\tif (Type.isFunction(this.#popupOptions?.events?.onPopupAfterClose))\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.#popupOptions?.events?.onPopupAfterClose();\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t},\n\t\t});\n\n\t\treturn this.#popup;\n\t}\n\n\t#renderPopupContent(): HTMLElement\n\t{\n\t\tconst appContainer = Tag.render`<div class=\"ai__copilot-chat-popup-content\"></div>`;\n\t\tthis.#app = BitrixVue.createApp({\n\t\t\tname: 'CopilotChatPopup',\n\t\t\tcomponents: {\n\t\t\t\tCopilotChat: CopilotChatComponent,\n\t\t\t\t...(this.#copilotChatOptions?.vueComponents),\n\t\t\t},\n\t\t\ttemplate: `\n\t\t\t\t<CopilotChat>\n\t\t\t\t\t<template v-slot:loader>\n\t\t\t\t\t\t${this.#copilotChatOptions.slots?.LOADER ?? ''}\n\t\t\t\t\t</template>\n\t\t\t\t\t<template v-slot:loaderError>\n\t\t\t\t\t\t${this.#copilotChatOptions.slots?.LOADER_ERROR ?? ''}\n\t\t\t\t\t</template>\n\t\t\t\t</CopilotChat>\n\t\t\t`,\n\t\t}, {\n\t\t\t...this.#copilotChatOptions,\n\t\t\tmessages: this.#messages.value,\n\t\t\tcopilotChatInstance: this,\n\t\t\tshowLoader: this.#isShowLoader,\n\t\t\tdisableInput: this.#isInputDisabled,\n\t\t\tstatus: this.#chatStatus,\n\t\t\tuseStatus: this.#useChatStatus,\n\t\t\tscrollToTheEndAfterFirstShow: this.#scrollToTheEndAfterFirstShow,\n\t\t\tcopilotMessageMenuItems: this.#copilotMessageMenuItems.value,\n\t\t\tuserMessageMenuItems: this.#userMessageMenuItems.value,\n\t\t\tisShowWarningMessage: this.#showCopilotWarningMessage,\n\t\t\tbotOptions: this.#copilotChatBotOptions.value,\n\t\t});\n\n\t\tthis.#app.mount(appContainer);\n\n\t\treturn appContainer;\n\t}\n}\n"],"names":["Status","Object","freeze","COPILOT_WRITING","NONE","CopilotChatStatus","components","BIcon","props","status","type","String","required","default","computed","writingStatusIcon","name","Set","PENCIL_60","size","color","containerClassname","template","NewMessagesVisibilityObserverEvents","VIEW_NEW_MESSAGE","NewMessagesVisibilityObserver","EventEmitter","constructor","options","setEventNamespace","init","IntersectionObserver","entries","forEach","entry","isMessageVisible","isIntersecting","intersectionRatio","messageElement","target","emit","BaseEvent","data","id","Dom","attr","unobserve","root","threshold","element","observe","push","setRoot","arrayWithZeros","Array","from","length","fill","map","zero","index","CopilotChatAvatar","src","alt","CopilotChatHeaderMenu","menuItems","items","menuIconProps","MORE","beforeMount","menu","Menu","mounted","getPopupWindow","setBindElement","$refs","menuButton","beforeUnmount","destroy","methods","toggleMenu","isMenuOpen","hideMenu","showMenu","show","close","isShown","CopilotChatHeader","emits","title","subtitle","avatar","useCloseIcon","Boolean","closeIconProps","CROSS_40","isMenuExists","handleClickOnCloseIcon","$emit","CopilotChatVoiceInputBtn","converter","isVoiceRecording","IconSet","isVoiceInputDisabled","SpeechConverter","isBrowserSupport","handleClickOnStartVoiceInputBtn","stopVoiceInput","startVoiceInput","toRaw","start","stop","handleSpeechConverterStartEvent","handleSpeechConverterStopEvent","handleSpeechConverterResultEvent","e","getData","text","handleSpeechConverterErrorEvent","console","error","subscribe","speechConverterEvents","result","bind","unmounted","unsubscribe","CopilotChatInput","disabled","placeholder","Loc","getMessage","userMessage","userMessageBeforeVoiceInput","isRecording","isSubmitButtonDisabled","trim","handleSubmitButton","blur","submitMessage","handleEnterKeyDown","shiftKey","ctrlKey","preventDefault","handleInput","value","handleVoiceInputText","updateTextareaHeight","handleStartVoiceInput","at","handleStopVoiceInput","textarea","focus","style","scrollHeight","watch","requestAnimationFrame","isDisabled","isMessageFromCopilot","authorId","CopilotChatMessage","avatarAlt","messageTitle","messageText","time","buttons","colorScheme","messageButtons","formattedTime","date","Date","getHours","getMinutes","isUserMessage","CopilotChatWelcomeMessage","content","CopilotChatMessagesDateGroup","formattedDate","format","DateTimeFormat","CopilotChatNewMessagesLabel","CopilotChatMessagesAuthorGroup","showNewMessagesLabel","CopilotChatMessageType","DEFAULT","BUTTON_CLICK_MESSAGE","WELCOME_FLOWS","WELCOME_SITE_WITH_AI","SYSTEM","CopilotChatNewMessageVisibilityObserver","binding","isMessageViewed","instance","observer","CopilotChatMessageMenu","message","item","onclick","event","menuItem","myCustomData","dateCreated","menuButtonClassname","initMenu","angle","offset","getPosition","width","events","onPopupShow","onPopupClose","bindElement","document","body","querySelector","CopilotChatMessageDefault","useAvatarTail","disableAllActions","messageData","messageContent","formattedMessageContent","htmlFormatter","HtmlFormatter","containerMode","source","formattedDeliveryTime","formatTime","params","isSomeButtonSelected","some","button","isSelected","showMenuButton","dateTime","hours","toString","padStart","minutes","append","innerText","CopilotChatMessageWelcome","messageInfo","CopilotChatMessageSiteWithAi","renderContent","paragraph2","$Bitrix","Tag","render","createSiteLink","innerHTML","CopilotChatMessageWelcomeFlows","CopilotChatMessageColor","USER","COPILOT","ERROR","USER_WITH_HIGHLIGHT_TEXT","CopilotChatMessages","messages","copilotAvatar","userAvatar","copilotMessageTitle","userMessageMenuItems","copilotMessageMenuItems","welcomeMessageHtmlElement","HTMLElement","inject","directives","messagesList","messagesGroupedByDayAndAuthor","groupsOfMessages","groupMessagesByDay","isNewMessagesStartHere","groupMessagesByAuthor","sortedByDateMessagesGroups","keys","sort","isMessagesContainsUnread","reduce","groupedMessages","messageDeliveryDate","messageIsoDate","formatISODate","undefined","viewed","currentAuthor","Infinity","isNewMessagesLabelWasAdded","messagesGroupedByAuthor","getMessageMenuItems","year","getFullYear","month","getMonth","day","getDate","getMessageColor","getMessageComponent","getMessageTitle","getMessageAvatarByAuthorId","getAuthorMessagesGroupAvatar","isMessageHaveButtons","handleMessageButtonClick","messageId","buttonId","isLastMessage","dateGroupIndex","authorGroupIndex","messageIndexAtAuthorGroup","welcomeMessage","CopilotChatHistoryLoader","getComputedStyle","getPropertyValue","loader","Loader","loaderContainer","hide","CopilotChatWarningMessage","showArticle","Helper","Reflection","getClass","articleCode","warningMessage","Event","link","container","CopilotChat","header","welcomeMessageHtml","botOptions","scrollToTheEndAfterFirstShow","slots","isShowWarningMessage","copilotChatInstance","useInput","disableInput","showLoader","showCopilotWritingStatus","useStatus","isCopilotWriting","isShowErrorScreen","provide","isInputDisabled","isLoaderShown","isWarningMessageShown","Slot","headerProps","botData","messageMenuItems","haveNewMessages","copilotChatStatus","isChatStatusUsed","isScrollToTheEndAfterMounted","hideChat","handleSubmitMessage","newMessage","addUserMessage","scrollMessagesListAfterOpen","newMessagesLabel","main","newMessagesLabelContainerClassname","scrollIntoView","scrollMessagesListToTheEnd","isSmooth","scrollTo","left","top","behavior","handleClickOnMessageButton","eventData","emitClickOnMessageButton","handleAddNewUserMessage","beforeCreate","setNewMessageIsViewed","CopilotChatEvents","ADD_USER_MESSAGE","newMessagesCount","oldMessagesCount","ADD_BOT_MESSAGE","ADD_OLD_MESSAGES","ADD_NEW_MESSAGES","CLICK_ON_MESSAGE_BUTTON","SHOW_LOADER","HIDE_LOADER","SHOW_COPILOT_WRITING_LOADER","HIDE_COPILOT_WRITING_LOADER","DISABLE_INPUT_FIELD","ENABLE_INPUT_FIELD","SET_MESSAGE_STATUS","SHOW_ERROR_SCREEN","HIDE_ERROR_SCREEN","CopilotChatMessageStatus","DEPART","SENT","DELIVERED","ref","popupOptions","Type","isArray","isBoolean","useChatStatus","showCopilotWarningMessage","getDefaultMinWidth","getDefaultHeight","newUserMessage","addBotMessage","addSystemMessage","newSystemMessage","enableInput","hideLoader","setMessageStatusDepart","setMessageStatusDelivered","setMessageStatusSent","setCopilotWritingStatus","clickedMessageButton","searchedMessage","find","currentMessage","newMessageId","Math","round","random","isCopilotChatShown","toISOString","Popup","minWidth","height","contentNoPaddings","padding","borderRadius","className","cacheable","onPopupAfterClose","unmount","isFunction","appContainer","BitrixVue","createApp","CopilotChatComponent","vueComponents","LOADER","LOADER_ERROR","mount"],"mappings":"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"}