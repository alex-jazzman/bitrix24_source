(function(e,t,a,n,i,r,l){"use strict";var s;function o(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function c(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?o(Object(a),!0).forEach((function(t){babelHelpers.defineProperty(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):o(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function d(e,t){f(e,t);t.add(e)}function u(e,t,a){f(e,t);t.set(e,a)}function f(e,t){if(t.has(e)){throw new TypeError("Cannot initialize the same private elements twice on an object")}}function E(e,t,a){if(!t.has(e)){throw new TypeError("attempted to get private field on non-instance")}return a}var b=new WeakMap;var h=new WeakMap;var v=new WeakSet;var p=new WeakSet;var I=new WeakSet;var T=new WeakSet;var _=new WeakSet;var g=function(){function e(t){var a;babelHelpers.classCallCheck(this,e);d(this,_);d(this,T);d(this,I);d(this,p);d(this,v);u(this,b,{writable:true,value:void 0});u(this,h,{writable:true,value:void 0});babelHelpers.classPrivateFieldSet(this,b,(a=BX.Main.gridManager.getById(t.gridId))===null||a===void 0?void 0:a.instance);babelHelpers.classPrivateFieldSet(this,h,BX.Main.filterManager.getById(t.gridId));E(this,p,D).call(this);E(this,v,P).call(this)}babelHelpers.createClass(e,[{key:"handleCreatedByClick",value:function e(t){this.handleDatasetFilterChange(c({fieldId:"CREATED_BY_ID"},t))}},{key:"handleUpdatedByClick",value:function e(t){this.handleDatasetFilterChange(c({fieldId:"UPDATED_BY_ID"},t))}},{key:"handleSourceClick",value:function e(t){this.handleDatasetFilterChange(c({fieldId:"SOURCE.ID"},t))}},{key:"handleDatasetFilterChange",value:function e(t){var a,n;var i=babelHelpers.classPrivateFieldGet(this,h).getFilterFieldsValues();var r=(a=i[t.fieldId])!==null&&a!==void 0?a:[];var l=(n=i["".concat(t.fieldId,"_label")])!==null&&n!==void 0?n:[];if(t.IS_FILTERED){r=r.filter((function(e){return parseInt(e,10)!==t.ID}));l=l.filter((function(e){return e!==t.TITLE}))}else if(!r.includes(t.ID)){r.push(t.ID);l.push(t.TITLE)}var s=babelHelpers.classPrivateFieldGet(this,h).getApi();var o={};o[t.fieldId]=r;o["".concat(t.fieldId,"_label")]=l;s.extendFilter(o);s.apply()}},{key:"exportDataset",value:function e(a){var n=this;babelHelpers.classPrivateFieldGet(this,b).tableFade();t.FileExport.getInstance().downloadOnce(a).then((function(){babelHelpers.classPrivateFieldGet(n,b).tableUnfade()}))["catch"]((function(){babelHelpers.classPrivateFieldGet(n,b).tableUnfade()}))}},{key:"deleteDataset",value:function e(t){E(this,I,S).call(this,t).show()}},{key:"deleteDatasetAjaxAction",value:function e(t){return n.ajax.runAction("biconnector.externalsource.dataset.delete",{data:{id:t}})}},{key:"createChart",value:function e(t){var a=this;babelHelpers.classPrivateFieldGet(this,b).tableFade();n.ajax.runAction("biconnector.externalsource.dataset.getEditUrl",{data:{id:t}}).then((function(e){var t=e.data;if(t){window.open(t,"_blank").focus()}babelHelpers.classPrivateFieldGet(a,b).tableUnfade()}))["catch"]((function(e){babelHelpers.classPrivateFieldGet(a,b).tableUnfade();if(e.errors){E(a,_,y).call(a,e.errors)}}))}},{key:"showSupersetError",value:function e(){BX.UI.Notification.Center.notify({content:n.Text.encode(n.Loc.getMessage("BICONNECTOR_SUPERSET_EXTERNAL_DATASET_GRID_ERROR_SUPERSET"))})}}]);return e}();function P(){var e=BX.UI.Hint.createInstance({popupParameters:{autoHide:true}});e.init(babelHelpers.classPrivateFieldGet(this,b).getContainer())}function D(){var e=this;i.EventEmitter.subscribe("SidePanel.Slider:onMessage",(function(t){var a=t.getData(),n=babelHelpers.slicedToArray(a,1),i=n[0];if(i.getEventId()==="BIConnector.dataset-import:onDatasetCreated"){babelHelpers.classPrivateFieldGet(e,b).reload()}}));i.EventEmitter.subscribe("Grid::updated",(function(){E(e,v,P).call(e)}))}function S(e){var t=this;var a=new l.Dialog({title:n.Loc.getMessage("BICONNECTOR_SUPERSET_EXTERNAL_DATASET_GRID_DELETE_POPUP_TITLE_MSGVER_1"),content:E(this,T,O).call(this),centerButtons:[new r.Button({text:n.Loc.getMessage("BICONNECTOR_SUPERSET_EXTERNAL_DATASET_GRID_DELETE_POPUP_CAPTION_YES"),size:r.ButtonSize.LARGE,style:r.AirButtonStyle.FILLED,useAirDesign:true,onclick:function n(i){i.setWaiting();t.deleteDatasetAjaxAction(e).then((function(){babelHelpers.classPrivateFieldGet(t,b).reload();a.hide()}))["catch"]((function(e){a.hide();if(e.errors){E(t,_,y).call(t,e.errors)}}))}}),new r.Button({text:n.Loc.getMessage("BICONNECTOR_SUPERSET_EXTERNAL_DATASET_GRID_DELETE_POPUP_CAPTION_NO"),size:r.ButtonSize.LARGE,style:r.AirButtonStyle.PLAIN,useAirDesign:true,onclick:function e(){return a.hide()}})],hasOverlay:true,width:400});return a}function O(){return n.Tag.render(s||(s=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<div class="biconnector-delete-dataset-popup-content">\n\t\t\t\t',"\n\t\t\t</div>\n\t\t"])),n.Loc.getMessage("BICONNECTOR_SUPERSET_EXTERNAL_DATASET_GRID_DELETE_POPUP_DESCRIPTION_MSGVER_1"))}function y(e){if(e[0]&&e[0].message){BX.UI.Notification.Center.notify({content:n.Text.encode(e[0].message)})}}n.Reflection.namespace("BX.BIConnector").ExternalDatasetManager=g})(this.window=this.window||{},BX.BIConnector.DatasetImport,BX.Main,BX,BX.Event,BX.UI,BX.UI.System);
//# sourceMappingURL=script.map.js