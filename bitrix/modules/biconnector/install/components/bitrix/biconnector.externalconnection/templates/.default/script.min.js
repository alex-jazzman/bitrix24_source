(function(t,e,a,i,n,l,s){"use strict";var r,o,c,d,v,u,p,b,h,g,f;function E(t,e){T(t,e);e.add(t)}function w(t,e,a){T(t,e);e.set(t,a)}function T(t,e){if(e.has(t)){throw new TypeError("Cannot initialize the same private elements twice on an object")}}function m(t,e,a){if(!e.has(t)){throw new TypeError("attempted to get private field on non-instance")}return a}var H=new WeakMap;var C=new WeakMap;var F=new WeakMap;var P=new WeakMap;var S=new WeakSet;var N=new WeakSet;var _=new WeakSet;var I=new WeakSet;var G=new WeakSet;var y=new WeakSet;var L=new WeakSet;var D=new WeakSet;var k=new WeakSet;var x=new WeakSet;var A=new WeakSet;var O=new WeakSet;var B=function(){function t(e){babelHelpers.classCallCheck(this,t);E(this,O);E(this,A);E(this,x);E(this,k);E(this,D);E(this,L);E(this,y);E(this,G);E(this,I);E(this,_);E(this,N);E(this,S);w(this,H,{writable:true,value:void 0});w(this,C,{writable:true,value:void 0});w(this,F,{writable:true,value:void 0});w(this,P,{writable:true,value:void 0});babelHelpers.classPrivateFieldSet(this,C,e);m(this,S,X).call(this)}babelHelpers.createClass(t,[{key:"onClickSave",value:function t(){var a=this;var i=n.ButtonManager.createFromNode(document.querySelector("#connection-button-save"));i.setWaiting(true);var l=m(this,k,K).call(this);if(babelHelpers.classPrivateFieldGet(this,C).sourceFields.id){l.id=babelHelpers.classPrivateFieldGet(this,C).sourceFields.id}m(this,x,V).call(this).then((function(){return e.ajax.runAction("biconnector.externalsource.source.save",{data:{data:l}})})).then((function(t){BX.SidePanel.Instance.postMessage(window,"BIConnector:ExternalConnection:onConnectionSave",{connection:t.data.connection});if(babelHelpers.classPrivateFieldGet(a,C).closeAfterCreate){m(a,O,J).call(a)}else{m(a,A,Y).call(a,t.data.connection);i.setWaiting(false)}}))["catch"]((function(t){var e;i.setWaiting(false);if((t===null||t===void 0?void 0:(e=t.errors)===null||e===void 0?void 0:e.length)>0){BX.UI.Notification.Center.notify({content:t.errors[0].message})}BX.SidePanel.Instance.postMessage(window,"BIConnector:ExternalConnection:onConnectionCreationError")}))}}]);return t}();function X(){babelHelpers.classPrivateFieldSet(this,H,document.querySelector("#connection-form"));var t=e.Tag.render(r||(r=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<div class="hint-wrapper"></div>\n\t\t'])));e.Dom.append(t,babelHelpers.classPrivateFieldGet(this,H));m(this,N,M).call(this);var a=e.Tag.render(o||(o=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<div class="fields-wrapper"></div>\n\t\t'])));e.Dom.append(a,babelHelpers.classPrivateFieldGet(this,H));m(this,_,W).call(this);var i=e.Tag.render(c||(c=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<div class="db-connection-button-block">\n\t\t\t\t<div class="db-connection-button"></div>\n\t\t\t\t<div class="db-connection-status"></div>\n\t\t\t</div>\n\t\t'])));e.Dom.append(i,babelHelpers.classPrivateFieldGet(this,H));m(this,G,q).call(this);m(this,y,U).call(this)}function M(){var t,a;var i=babelHelpers.classPrivateFieldGet(this,H).querySelector(".hint-wrapper");var n={"1c":"23508958",rest:"24486426"};var l=(t=n[(a=babelHelpers.classPrivateFieldGet(this,C).sourceFields)===null||a===void 0?void 0:a.type])!==null&&t!==void 0?t:n["1c"];var s="redirect=detail&code=".concat(l);var r=e.Tag.render(d||(d=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<div class="db-connection-hint">\n\t\t\t\t',"\n\t\t\t</div>\n\t\t"])),e.Loc.getMessage("EXTERNAL_CONNECTION_HINT",{"[link]":'<a class="ui-link" onclick="top.BX.Helper.show(`'.concat(s,'`)">'),"[/link]":"</a>"}));e.Dom.append(r,i)}function W(){var t,a,i,n,s,r,o=this,c;var d=babelHelpers.classPrivateFieldGet(this,H).querySelector(".fields-wrapper");var p=(t=babelHelpers.classPrivateFieldGet(this,C).sourceFields)!==null&&t!==void 0?t:{};var b=e.Tag.render(v||(v=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<div class="form-fields">\n\t\t\t\t<div class="ui-form-row">\n\t\t\t\t\t<div class="ui-form-label">\n\t\t\t\t\t\t<div class="ui-ctl-label-text">','</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="ui-ctl ui-ctl-after-icon ui-ctl-dropdown ui-ctl-w100">\n\t\t\t\t\t\t<div class="ui-ctl-after ui-ctl-icon-angle"></div>\n\t\t\t\t\t\t<div class="ui-ctl-element"  id="connection-type-button">\n\t\t\t\t\t\t\t','\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<input \n\t\t\t\t\t\t\ttype="hidden" \n\t\t\t\t\t\t\tid="connection-type-code"\n\t\t\t\t\t\t\tdata-code="code"\n\t\t\t\t\t\t\tvalue="','">\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class="ui-form-row">\n\t\t\t\t\t<div class="ui-form-label">\n\t\t\t\t\t\t<div class="ui-ctl-label-text">','</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="ui-form-content">\n\t\t\t\t\t\t<div class="ui-ctl ui-ctl-textbox ui-ctl-w100">\n\t\t\t\t\t\t\t<input \n\t\t\t\t\t\t\t\ttype="text" \n\t\t\t\t\t\t\t\tclass="ui-ctl-element" \n\t\t\t\t\t\t\t\tplaceholder="','" \n\t\t\t\t\t\t\t\tdata-code="title"\n\t\t\t\t\t\t\t\tvalue="','"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t'])),e.Loc.getMessage("EXTERNAL_CONNECTION_FIELD_TYPE"),p.code?e.Text.encode((a=babelHelpers.classPrivateFieldGet(this,C).supportedDatabases.find((function(t){return t.code===p.code})))===null||a===void 0?void 0:a.name):e.Text.encode((i=babelHelpers.classPrivateFieldGet(this,C).supportedDatabases[0])===null||i===void 0?void 0:i.name),p.code?(n=babelHelpers.classPrivateFieldGet(this,C).supportedDatabases.find((function(t){return t.code===p.code})))===null||n===void 0?void 0:n.code:(s=babelHelpers.classPrivateFieldGet(this,C).supportedDatabases[0])===null||s===void 0?void 0:s.code,e.Loc.getMessage("EXTERNAL_CONNECTION_FIELD_NAME"),e.Loc.getMessage("EXTERNAL_CONNECTION_FIELD_NAME_PLACEHOLDER"),(r=p.title)!==null&&r!==void 0?r:"");e.Dom.append(b,d);var h=document.getElementById("connection-type-button");var g=new l.Dialog({targetNode:h,width:465,height:400,autoHide:true,multiple:false,showAvatars:false,compactView:true,dropdownMode:true,enableSearch:true,items:babelHelpers.classPrivateFieldGet(this,C).supportedDatabases.map((function(t){return{id:t.code,entityId:"biconnector-external-connection",title:t.name,tabs:"connections"}})),events:{"Item:onSelect":function t(a){var i=a.getData().item;var n=i.getId();var l=i.getTitle();h.textContent=e.Text.encode(l);m(o,I,R).call(o,{target:{value:n}})}},entities:[{id:"biconnector-external-connection"}],tabs:[{id:"connections",showInList:true}]});if(p.id){e.Dom.attr(h,"disabled",true)}else{e.Event.bind(h,"click",(function(){g.show()}))}var f=babelHelpers.classPrivateFieldGet(this,C).fieldsConfig;var E=(c=p.code)!==null&&c!==void 0?c:babelHelpers.classPrivateFieldGet(this,C).supportedDatabases[0].code;f[E].forEach((function(t){var a;var i=t.type;if(t.code==="password"){i="password"}var n=e.Tag.render(u||(u=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t<div class="ui-form-row">\n\t\t\t\t\t<div class="ui-form-label">\n\t\t\t\t\t\t<div class="ui-ctl-label-text">','</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="ui-form-content">\n\t\t\t\t\t\t<div class="ui-ctl ui-ctl-textbox ui-ctl-w100">\n\t\t\t\t\t\t\t<input \n\t\t\t\t\t\t\t\ttype="','" \n\t\t\t\t\t\t\t\tclass="ui-ctl-element" \n\t\t\t\t\t\t\t\tdata-code="','"\n\t\t\t\t\t\t\t\tplaceholder="','" \n\t\t\t\t\t\t\t\tvalue="','"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t'])),e.Text.encode(t.name),i,t.code,t.placeholder,(a=p[t.code])!==null&&a!==void 0?a:"");e.Dom.append(n,b);e.Event.bind(n,"input",(function(){return m(o,L,j).call(o)}))}))}function R(t){var a;var i=t.target.value;var n=babelHelpers.classPrivateFieldGet(this,C).supportedDatabases.filter((function(t){return t.code===i}))[0];babelHelpers.classPrivateFieldGet(this,C).sourceFields.code=i;babelHelpers.classPrivateFieldGet(this,C).sourceFields.type=(a=n.type)!==null&&a!==void 0?a:null;e.Dom.clean(babelHelpers.classPrivateFieldGet(this,H).querySelector(".hint-wrapper"));m(this,N,M).call(this);e.Dom.clean(babelHelpers.classPrivateFieldGet(this,H).querySelector(".fields-wrapper"));m(this,_,W).call(this);m(this,L,j).call(this)}function q(){var t=this;var a=new n.Button({text:e.Loc.getMessage("EXTERNAL_CONNECTION_CHECK_BUTTON"),color:n.ButtonColor.PRIMARY,onclick:function e(a,i){i.preventDefault();m(t,x,V).call(t)["catch"]((function(){}))},noCaps:true});a.renderTo(babelHelpers.classPrivateFieldGet(this,H).querySelector(".db-connection-button"));babelHelpers.classPrivateFieldSet(this,F,a)}function U(){babelHelpers.classPrivateFieldSet(this,P,babelHelpers.classPrivateFieldGet(this,H).querySelector(".db-connection-status"))}function j(){e.Dom.clean(babelHelpers.classPrivateFieldGet(this,P))}function z(t,a){e.Dom.clean(babelHelpers.classPrivateFieldGet(this,P));var i=null;if(t){i=e.Tag.render(p||(p=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t<div class="db-connection-success">\n\t\t\t\t\t<div class="ui-icon-set --check" style="--ui-icon-set__icon-size: 18px; --ui-icon-set__icon-color: var(--ui-color-palette-green-50);"></div>\n\t\t\t\t\t',"\n\t\t\t\t</div>\n\t\t\t"])),e.Loc.getMessage("EXTERNAL_CONNECTION_CHECK_SUCCESS"))}else{i=e.Tag.render(b||(b=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t<div class="db-connection-error">\n\t\t\t\t\t<div class="ui-icon-set --warning" style="--ui-icon-set__icon-size: 18px; --ui-icon-set__icon-color: var(--ui-color-palette-red-60);"></div>\n\t\t\t\t\t',"\n\t\t\t\t</div>\n\t\t\t"])),a.replaceAll(/\s+/g," "))}e.Dom.append(i,babelHelpers.classPrivateFieldGet(this,P))}function K(){var t,e,a,i,n;var l={};babelHelpers.classPrivateFieldGet(this,H).querySelectorAll("[data-code]").forEach((function(t){l[t.getAttribute("data-code")]=t.value}));var s=(t=(e=(a=babelHelpers.classPrivateFieldGet(this,C))===null||a===void 0?void 0:(i=a.sourceFields)===null||i===void 0?void 0:i.type)!==null&&e!==void 0?e:(n=babelHelpers.classPrivateFieldGet(this,C).supportedDatabases[0])===null||n===void 0?void 0:n.type)!==null&&t!==void 0?t:null;if(s){l.type=s}return l}function V(){var t=this;babelHelpers.classPrivateFieldGet(this,F).setState(n.ButtonState.WAITING);return new Promise((function(a,i){e.ajax.runAction("biconnector.externalsource.source.checkConnectionByData",{data:{data:m(t,k,K).call(t)}}).then((function(e){m(t,D,z).call(t,true);babelHelpers.classPrivateFieldGet(t,F).setState(null);a(e)}))["catch"]((function(e){m(t,D,z).call(t,false,e.errors[0].message);babelHelpers.classPrivateFieldGet(t,F).setState(null);i()}))}))}function Y(t){var a=this,n;var l=null;var r=!Object.hasOwn(babelHelpers.classPrivateFieldGet(this,C).sourceFields,"id")||babelHelpers.classPrivateFieldGet(this,C).sourceFields.active;var o=r?e.Tag.render(h||(h=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<a class="ui-btn ui-btn-md ui-btn-primary">\n\t\t\t\t',"\n\t\t\t</a>\n\t\t"])),e.Loc.getMessage("EXTERNAL_CONNECTION_CREATE_DATASET")):false;var c=e.Tag.render(g||(g=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<a class="ui-btn ui-btn-md ui-btn-light-border">\n\t\t\t\t',"\n\t\t\t</a>\n\t\t"])),e.Loc.getMessage("EXTERNAL_CONNECTION_CLOSE"));var d=function t(){m(a,O,J).call(a)};var v=(n=babelHelpers.classPrivateFieldGet(this,C).sourceFields.type)!==null&&n!==void 0?n:babelHelpers.classPrivateFieldGet(this,C).supportedDatabases[0].code;e.Event.bind(o,"click",(function(){d();s.Slider.open(v,0,{connectionId:t.id,connectionType:t.type})}));e.Event.bind(c,"click",(function(){d()}));var u=Boolean(babelHelpers.classPrivateFieldGet(this,C).sourceFields.id);var p=u?"EXTERNAL_CONNECTION_EDIT_SUCCESS":"EXTERNAL_CONNECTION_SAVE_SUCCESS";var b=e.Loc.getMessage(p,{"#CONNECTION_TITLE#":e.Text.encode(m(this,k,K).call(this).title)});var E=e.Tag.render(f||(f=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<div class="biconnector-popup--full-height">\n\t\t\t\t<div class="biconnector-save-progress-popup">\n\t\t\t\t\t<div class="biconnector-save-progress-popup__content">\n\t\t\t\t\t\t<div class="biconnector-save-progress-popup__success-logo"></div>\n\t\t\t\t\t\t<div class="biconnector-save-progress-popup__texts">\n\t\t\t\t\t\t\t<h3 class="biconnector-save-progress-popup__header">','</h3>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="biconnector-save-progress-popup__buttons">\n\t\t\t\t\t\t\t',"\n\t\t\t\t\t\t\t","\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t"])),b,o,c);l=new i.Popup({content:E,autoHide:true,events:{onPopupClose:d,onPopupDestroy:d},fixed:true,width:500,minHeight:299,closeIcon:true,noAllPaddings:true,overlay:true});l.show()}function J(){BX.SidePanel.Instance.postMessage(window,"BIConnector:ExternalConnection:onConnectionSliderClose");BX.SidePanel.Instance.getTopSlider().close()}e.Reflection.namespace("BX.BIConnector").ExternalConnectionForm=B})(this.window=this.window||{},BX,BX.Event,BX.Main,BX.UI,BX.UI.EntitySelector,BX.BIConnector.DatasetImport);
//# sourceMappingURL=script.map.js