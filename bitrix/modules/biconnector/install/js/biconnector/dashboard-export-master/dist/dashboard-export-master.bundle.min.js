this.BX=this.BX||{},function(t,e,i,n,a,s,r,l,c,o){"use strict";function d(t,e){var i="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!i){if(Array.isArray(t)||(i=function(t,e){if(!t)return;if("string"==typeof t)return b(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return b(t,e)}(t))||e&&t&&"number"==typeof t.length){i&&(t=i);var n=0,a=function(){};return{s:a,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,r=!0,l=!1;return{s:function(){i=i.call(t)},n:function(){var t=i.next();return r=t.done,t},e:function(t){l=!0,s=t},f:function(){try{r||null==i.return||i.return()}finally{if(l)throw s}}}}function b(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function p(t,e){h(t,e),e.add(t)}function v(t,e,i){h(t,e),e.set(t,i)}function h(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function u(t,e,i){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return i}var g=new WeakMap,f=new WeakMap,S=new WeakMap,P=new WeakMap,w=new WeakMap,I=new WeakMap,C=new WeakSet,y=new WeakSet,B=new WeakSet,E=new WeakSet,m=new WeakSet,H=new WeakSet,_=new WeakSet,T=function(){function t(e){babelHelpers.classCallCheck(this,t),p(this,_),p(this,H),p(this,m),p(this,E),p(this,B),p(this,y),p(this,C),v(this,g,{writable:!0,value:void 0}),v(this,f,{writable:!0,value:void 0}),v(this,S,{writable:!0,value:void 0}),v(this,P,{writable:!0,value:void 0}),v(this,w,{writable:!0,value:!0}),v(this,I,{writable:!0,value:void 0}),babelHelpers.classPrivateFieldSet(this,g,e.dashboardId),babelHelpers.classPrivateFieldSet(this,f,e.openedFrom)}return babelHelpers.createClass(t,[{key:"showPopup",value:function(){var t=this;return new Promise((function(i,n){u(t,C,F).call(t,babelHelpers.classPrivateFieldGet(t,g)).then((function(e){babelHelpers.classPrivateFieldSet(t,P,e.data),u(t,y,A).call(t,e.data),i(e)})).catch((function(t){e.UI.Notification.Center.notify({content:e.Loc.getMessage("BIC_EXPORT_ERROR")}),n(t)}))}))}}]),t}();function F(t){return new Promise((function(n,a){e.ajax.runAction("biconnector.dashboard.getExportData",{data:{id:t}}).then((function(t){i.EventEmitter.emit("BIConnector.ExportMaster:onDashboardDataLoaded"),n(t)})).catch((function(t){a(t)}))}))}function A(t){var i=this;babelHelpers.classPrivateFieldSet(this,S,new a.Popup({content:u(this,B,X).call(this,t),closeIcon:!0,closeByEsc:!0,cacheable:!1,overlay:!0,width:360,height:500,padding:0})),babelHelpers.classPrivateFieldGet(this,S).show(),new o.TextCrop({rows:1,resize:!0,target:document.querySelector(".bic-export-dashboard-title")}).init(),babelHelpers.classPrivateFieldSet(this,I,new l.Button({text:e.Loc.getMessage("BIC_EXPORT_BUTTON"),size:l.Button.Size.SMALL,round:!0,color:l.Button.Color.PRIMARY,className:"bic-export-button",onclick:function(){return u(i,m,R).call(i,babelHelpers.classPrivateFieldGet(i,g),babelHelpers.classPrivateFieldGet(i,w))}})),babelHelpers.classPrivateFieldGet(this,I).renderTo(babelHelpers.classPrivateFieldGet(this,S).getContentContainer().querySelector(".bic-export-footer")),new c.Switcher({node:babelHelpers.classPrivateFieldGet(this,S).getContentContainer().querySelector("#bic-setting-switcher"),checked:!0,color:c.SwitcherColor.primary,size:c.SwitcherSize.small,handlers:{toggled:u(this,E,G).bind(this)}}),babelHelpers.classPrivateFieldGet(this,S).getContentContainer().querySelector(".bic-settings-link").onclick=u(this,H,x).bind(this,babelHelpers.classPrivateFieldGet(this,g))}function X(t){var i=""===t.scope?e.Loc.getMessage("BIC_EXPORT_SCOPE_NONE"):t.scope;return'\n\t\t\t<div class="bic-export-container">\n\t\t\t\t<div class="bic-export-header">\n\t\t\t\t\t<div class="bic-export-subtitle">'.concat(e.Loc.getMessage("BIC_EXPORT_SUBTITLE"),'</div>\n\t\t\t\t\t<div class="bic-export-dashboard-title">').concat(t.title,'</div>\n\t\t\t\t</div>\n\t\t\t\t<div class="bic-export-separator"></div>\n\t\t\t\t<div class="bic-export-body">\n\t\t\t\t\t<div class="bic-setting-item bic-setting-item-export-with-settings">\n\t\t\t\t\t\t<div class="bic-setting-title">').concat(e.Loc.getMessage("BIC_EXPORT_EXPORT_WITH_SETTINGS"),'</div>\n\t\t\t\t\t\t<div class="bic-setting-value" id="bic-setting-switcher"></div>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div class="bic-export-hint">').concat(e.Loc.getMessage("BIC_EXPORT_HINT"),'</div>\n\t\t\t\t\t<div class="bic-export-hint disabled">').concat(e.Loc.getMessage("BIC_EXPORT_HINT_WITH_NO_SETTINGS"),'</div>\n\n\t\t\t\t\t<div class="bic-setting-item bic-setting-item-period">\n\t\t\t\t\t\t<div class="bic-setting-title">').concat(e.Loc.getMessage("BIC_EXPORT_PERIOD"),'</div>\n\t\t\t\t\t\t<div class="bic-setting-value">').concat(t.period,'</div>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div class="bic-setting-item bic-setting-item-scope">\n\t\t\t\t\t\t<div class="bic-setting-title">').concat(e.Loc.getMessage("BIC_EXPORT_SCOPE"),'</div>\n\t\t\t\t\t\t<div class="bic-setting-value">').concat(i,'</div>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div class="bic-setting-item">\n\t\t\t\t\t\t<span class="bic-settings-link">').concat(e.Loc.getMessage("BIC_EXPORT_OPEN_SETTINGS"),'</span>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class="bic-export-separator"></div>\n\t\t\t\t<div class="bic-export-footer"></div>\n\t\t\t</div>\n\t\t')}function G(){var t,i=d(babelHelpers.classPrivateFieldGet(this,S).getContentContainer().querySelectorAll(".bic-setting-item-period,.bic-setting-item-scope,.bic-export-hint,.bic-settings-link"));try{for(i.s();!(t=i.n()).done;){var n=t.value;e.Dom.toggleClass(n,"disabled")}}catch(t){i.e(t)}finally{i.f()}babelHelpers.classPrivateFieldSet(this,w,!babelHelpers.classPrivateFieldGet(this,w))}function R(t,i){var n=this;return babelHelpers.classPrivateFieldGet(this,I).setState(l.Button.State.WAITING),e.ajax.runAction("biconnector.dashboard.export",{data:{id:t,withSettings:i?1:0}}).then((function(e){var i=e.data.filePath;i&&window.open(i,"_self"),babelHelpers.classPrivateFieldGet(n,S).close(),s.ApacheSupersetAnalytics.sendAnalytics("edit","report_export",{type:babelHelpers.classPrivateFieldGet(n,P).type.toLowerCase(),p1:s.ApacheSupersetAnalytics.buildAppIdForAnalyticRequest(babelHelpers.classPrivateFieldGet(n,P).appId),p2:t,status:"success",c_element:babelHelpers.classPrivateFieldGet(n,f)})})).catch((function(){e.UI.Notification.Center.notify({content:e.Loc.getMessage("BIC_EXPORT_ERROR")}),babelHelpers.classPrivateFieldGet(n,I).setState(l.Button.State.ACTIVE),s.ApacheSupersetAnalytics.sendAnalytics("edit","report_export",{type:babelHelpers.classPrivateFieldGet(n,P).type.toLowerCase(),p1:s.ApacheSupersetAnalytics.buildAppIdForAnalyticRequest(babelHelpers.classPrivateFieldGet(n,P).appId),p2:t,status:"error",c_element:babelHelpers.classPrivateFieldGet(n,f)})}))}function x(t){i.EventEmitter.subscribe("BX.BIConnector.Settings:onAfterSave",u(this,_,M).bind(this)),r.DashboardManager.openSettingsSlider(t)}function M(){var t=this;i.EventEmitter.unsubscribe("BX.BIConnector.Settings:onAfterSave",u(this,_,M).bind(this)),new n.Loader({target:babelHelpers.classPrivateFieldGet(this,S).getContentContainer()}).show(),u(this,C,F).call(this,babelHelpers.classPrivateFieldGet(this,g)).then((function(e){babelHelpers.classPrivateFieldSet(t,P,e.data),babelHelpers.classPrivateFieldGet(t,S).close(),u(t,y,A).call(t,e.data)})).catch((function(){e.UI.Notification.Center.notify({content:e.Loc.getMessage("BIC_EXPORT_ERROR")})}))}t.DashboardExportMaster=T}(this.BX.BIConnector=this.BX.BIConnector||{},BX,BX.Event,BX,BX.Main,BX.BIConnector,BX.BIConnector,BX.UI,BX.UI,BX.UI);
//# sourceMappingURL=dashboard-export-master.bundle.map.js