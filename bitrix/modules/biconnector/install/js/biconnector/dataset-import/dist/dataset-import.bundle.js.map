{"version":3,"file":"dataset-import.bundle.js","sources":["../src/layout/app-layout.js","../src/layout/import-config.js","../src/layout/popup.js","../src/popups/file-checking/file-errors-popup.js","../src/popups/file-checking/checking-progress-popup.js","../src/popups/file-checking/checking-success-popup.js","../src/popups/file-checking/checking-failed-popup.js","../src/popups/generic-popup.js","../src/popups/saving/saving-popup.js","../src/popups/saving/import-failure-popup.js","../src/popups/saving/import-progress-popup.js","../src/popups/saving/import-success-popup.js","../src/layout/step-hint.js","../src/layout/step-block.js","../src/steps/base-step.js","../src/layout/error-popup.js","../src/fields/type/base-field.js","../src/fields/type/string-field.js","../src/fields/type/text-field.js","../src/fields/dataset-properties.js","../src/steps/dataset-properties.js","../src/steps/data-type/table-header.js","../src/types/data-types.js","../src/steps/data-type/data-type-menu.js","../src/steps/data-type/data-type-selector.js","../src/steps/data-type/table-row.js","../src/steps/data-type/format-table.js","../src/steps/data-type/sync-fields-button.js","../src/steps/fields-settings.js","../src/steps/data-type/format-selector.js","../src/steps/data-type/slider-button.js","../src/fields/type/switcher-field.js","../src/fields/type/custom-field.js","../src/fields/type/dropdown-field.js","../src/fields/file/file-uploader.js","../src/steps/file.js","../src/layout/app-section.js","../src/steps/import-preview/table-header.js","../src/steps/import-preview/table-row.js","../src/steps/import-preview/preview-table.js","../src/steps/import-preview.js","../src/app/base-app.js","../src/app/csv-app.js","../src/popups/sync/sync-fields-popup.js","../src/fields/type/connection-selector-field.js","../src/fields/type/table-selector-field.js","../src/steps/connection.js","../src/app/external-connection-app.js","../src/app/store.js","../src/app/app-factory.js","../src/app/slider.js"],"sourcesContent":["import 'ui.pinner';\n\nimport '../css/app-layout.css';\nimport { Dom } from 'main.core';\n\nexport const AppLayout = {\n\tprops: {\n\t\tsaveLocked: {\n\t\t\ttype: Boolean,\n\t\t\trequired: false,\n\t\t\tdefault: false,\n\t\t},\n\t\tisEditMode: {\n\t\t\ttype: Boolean,\n\t\t\trequired: false,\n\t\t\tdefault: false,\n\t\t},\n\t},\n\tcomputed: {\n\t\tsaveButtonClass()\n\t\t{\n\t\t\treturn {\n\t\t\t\t'ui-btn-base-light': this.saveLocked,\n\t\t\t\t'app-root__button--blocked': this.saveLocked,\n\t\t\t\t'ui-btn-success': !this.saveLocked,\n\t\t\t};\n\t\t},\n\t\tsaveButtonText()\n\t\t{\n\t\t\treturn this.isEditMode\n\t\t\t\t? this.$Bitrix.Loc.getMessage('DATASET_IMPORT_SAVE')\n\t\t\t\t: this.$Bitrix.Loc.getMessage('DATASET_IMPORT_CREATE');\n\t\t},\n\t},\n\tmounted()\n\t{\n\t\tDom.addClass(document.querySelector('body'), 'app-body');\n\n\t\tconst buttonsPanel = this.$refs.buttonsPanel;\n\t\tif (buttonsPanel)\n\t\t{\n\t\t\tthis.$root.$el.parentNode.appendChild(buttonsPanel);\n\t\t\tnew BX.UI.Pinner(\n\t\t\t\tbuttonsPanel,\n\t\t\t\t{\n\t\t\t\t\tfixBottom: true,\n\t\t\t\t\tfullWidth: true,\n\t\t\t\t},\n\t\t\t);\n\t\t}\n\t},\n\tmethods: {\n\t\tonCreateButtonClick()\n\t\t{\n\t\t\tthis.$Bitrix.eventEmitter.emit('biconnector:dataset-import:createButtonClick', {});\n\t\t},\n\t\tonCancelButtonClick()\n\t\t{\n\t\t\tthis.$Bitrix.eventEmitter.emit('biconnector:dataset-import:cancelButtonClick', {});\n\t\t},\n\t},\n\t// language=Vue\n\ttemplate: `\n\t\t<div class=\"app\">\n\t\t\t<div class=\"app__block app__block--narrow\">\n\t\t\t\t<slot name=\"left-panel\"></slot>\n\t\t\t</div>\n\t\t\t<div class=\"app__block\">\n\t\t\t\t<slot name=\"right-panel\"></slot>\n\t\t\t</div>\n\t\n\t\t\t<div class=\"ui-button-panel-wrapper\" ref=\"buttonsPanel\">\n\t\t\t\t<div class=\"ui-button-panel\">\n\t\t\t\t\t<div class=\"app-root__button-wrapper\" :class=\"saveLocked ? 'app-root__button-wrapper--blocked' : ''\">\n\t\t\t\t\t\t<button class=\"ui-btn ui-btn-md app-root__button\" :class=\"saveButtonClass\" @click=\"onCreateButtonClick\" ref=\"saveButton\">\n\t\t\t\t\t\t\t{{ saveButtonText }}\n\t\t\t\t\t\t</button>\n\t\t\t\t\t</div>\n\t\t\t\t\t<button class=\"ui-btn ui-btn-md ui-btn-link app-root__button\" @click=\"onCancelButtonClick\">\n\t\t\t\t\t\t{{ $Bitrix.Loc.getMessage('DATASET_IMPORT_CANCEL') }}\n\t\t\t\t\t</button>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import '../css/import-config.css';\n\nexport const ImportConfig = {\n\t// language=Vue\n\ttemplate: `\n\t\t<div class=\"import-config\">\n\t\t\t<slot></slot>\n\t\t</div>\n\t`,\n};\n","import { Popup as MainPopup, PopupManager } from 'main.popup';\n\nexport const Popup = {\n\temits: ['close'],\n\tprops: {\n\t\tid: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t\toptions: {\n\t\t\ttype: Object,\n\t\t\trequired: false,\n\t\t\tdefault: {},\n\t\t},\n\t\twrapperClass: {\n\t\t\ttype: String,\n\t\t\trequired: false,\n\t\t\tdefault: '',\n\t\t},\n\t},\n\tdata()\n\t{\n\t\treturn {\n\t\t\tpopupInstance: null,\n\t\t};\n\t},\n\tcomputed: {\n\t\tpopupOptions()\n\t\t{\n\t\t\treturn {\n\t\t\t\tid: this.id,\n\t\t\t\tcontent: this.$refs.content,\n\t\t\t\tautoHide: true,\n\t\t\t\tevents: {\n\t\t\t\t\tonPopupClose: this.closePopup,\n\t\t\t\t\tonPopupDestroy: this.closePopup,\n\t\t\t\t},\n\t\t\t\tfixed: true,\n\t\t\t\t...this.options,\n\t\t\t};\n\t\t},\n\t},\n\tmethods: {\n\t\tclosePopup()\n\t\t{\n\t\t\tPopupManager.getPopupById(this.id)?.destroy();\n\t\t\tthis.popupInstance = null;\n\t\t\tthis.$emit('close');\n\t\t},\n\t},\n\tmounted()\n\t{\n\t\tif (!this.popupInstance)\n\t\t{\n\t\t\tthis.popupInstance = new MainPopup(this.popupOptions);\n\t\t}\n\n\t\tthis.popupInstance.show();\n\t},\n\tbeforeUnmount(): void\n\t{\n\t\tthis.closePopup();\n\t},\n\ttemplate: `\n\t\t<div ref=\"content\" :class=\"wrapperClass\">\n\t\t\t<slot></slot>\n\t\t</div>\n\t`,\n};\n","import { ajax as Ajax, Dom } from 'main.core';\nimport type { PopupOptions } from 'main.popup';\nimport { Popup } from '../../layout/popup';\nimport { Button, ButtonState, ButtonSize, ButtonColor } from 'ui.buttons';\nimport '../../css/csv-errors-popup.css';\n\n// noinspection JSUnusedGlobalSymbols\nexport const FileErrorsPopup = {\n\temits: ['close', 'saveIgnoringErrors'],\n\tprops: {\n\t\terrors: {\n\t\t\ttype: Array,\n\t\t\trequired: true,\n\t\t},\n\t\tisEditMode: {\n\t\t\ttype: Boolean,\n\t\t\trequired: true,\n\t\t},\n\t\tisSavingMode: {\n\t\t\ttype: Boolean,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tdata()\n\t{\n\t\treturn {\n\t\t\treportDownloadLink: null,\n\t\t};\n\t},\n\tcomputed: {\n\t\tpopupOptions(): PopupOptions\n\t\t{\n\t\t\treturn {\n\t\t\t\twidth: 830,\n\t\t\t\tcloseIcon: false,\n\t\t\t\tnoAllPaddings: true,\n\t\t\t\toverlay: true,\n\t\t\t};\n\t\t},\n\t\ttitle(): string\n\t\t{\n\t\t\tif (!this.isSavingMode)\n\t\t\t{\n\t\t\t\tif (this.errors.length >= 200)\n\t\t\t\t{\n\t\t\t\t\treturn this.$Bitrix.Loc.getMessage('DATASET_IMPORT_CSV_ERROR_POPUP_TITLE_MANY');\n\t\t\t\t}\n\n\t\t\t\treturn this.$Bitrix.Loc.getMessage('DATASET_IMPORT_CSV_ERROR_POPUP_TITLE');\n\t\t\t}\n\n\t\t\tif (this.errors.length <= 200)\n\t\t\t{\n\t\t\t\treturn this.$Bitrix.Loc.getMessage('DATASET_IMPORT_CSV_ERROR_POPUP_TITLE');\n\t\t\t}\n\n\t\t\treturn this.isEditMode\n\t\t\t\t? this.$Bitrix.Loc.getMessage('DATASET_IMPORT_CSV_ERROR_POPUP_TITLE_STOPPED_UPDATING')\n\t\t\t\t: this.$Bitrix.Loc.getMessage('DATASET_IMPORT_CSV_ERROR_POPUP_TITLE_STOPPED_CREATING')\n\t\t\t;\n\t\t},\n\t\thintContent(): string\n\t\t{\n\t\t\tif (this.errors.length > 200)\n\t\t\t{\n\t\t\t\tif (this.isEditMode)\n\t\t\t\t{\n\t\t\t\t\treturn this.prepareHintContent('DATASET_IMPORT_CSV_ERROR_POPUP_HINT_UPDATING_MANY_ERRORS');\n\t\t\t\t}\n\n\t\t\t\treturn this.prepareHintContent('DATASET_IMPORT_CSV_ERROR_POPUP_HINT_CREATION_MANY_ERRORS');\n\t\t\t}\n\n\t\t\tif (this.isSavingMode)\n\t\t\t{\n\t\t\t\tif (this.isEditMode)\n\t\t\t\t{\n\t\t\t\t\treturn this.prepareHintContent('DATASET_IMPORT_CSV_ERROR_POPUP_HINT_UPDATING');\n\t\t\t\t}\n\n\t\t\t\treturn this.prepareHintContent('DATASET_IMPORT_CSV_ERROR_POPUP_HINT_CREATION');\n\t\t\t}\n\n\t\t\treturn this.prepareHintContent('DATASET_IMPORT_CSV_ERROR_POPUP_HINT_CHECKING');\n\t\t},\n\t\terrorsCountText(): string\n\t\t{\n\t\t\treturn this.$Bitrix.Loc.getMessage('DATASET_IMPORT_CSV_ERROR_POPUP_SUMMARY')\n\t\t\t\t.replace('[wrapper]', '<span class=\"errors-counter\">')\n\t\t\t\t.replace('#COUNT#', this.errors.length > 200 ? '200+' : this.errors.length)\n\t\t\t\t.replace('[/wrapper]', '</span>')\n\t\t\t;\n\t\t},\n\t},\n\tmethods: {\n\t\tonClose()\n\t\t{\n\t\t\tthis.$emit('close');\n\t\t},\n\t\tonIgnoreErrorsClick()\n\t\t{\n\t\t\tthis.$emit('saveIgnoringErrors');\n\t\t},\n\t\tonDownloadLogButtonClick()\n\t\t{\n\t\t\tthis.downloadLogButton.setState(ButtonState.WAITING);\n\n\t\t\tif (this.reportDownloadLink)\n\t\t\t{\n\t\t\t\tthis.downloadLogButton.setState(null);\n\t\t\t\tthis.downloadLog();\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tAjax.runAction(\n\t\t\t\t'biconnector.externalsource.dataset.logErrorsIntoFile',\n\t\t\t\t{\n\t\t\t\t\tdata: {\n\t\t\t\t\t\tfields: this.$store.state.config,\n\t\t\t\t\t\ttype: 'csv',\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t)\n\t\t\t\t.then((response) => {\n\t\t\t\t\tthis.downloadLogButton.setState(null);\n\t\t\t\t\tconst blob = new Blob([response.data], { type: 'text/html' });\n\t\t\t\t\tthis.reportDownloadLink = window.URL.createObjectURL(blob);\n\t\t\t\t\tthis.downloadLog();\n\t\t\t\t})\n\t\t\t\t.catch(() => {\n\t\t\t\t\tthis.downloadLogButton.setState(null);\n\t\t\t\t})\n\t\t\t;\n\t\t},\n\t\tdownloadLog()\n\t\t{\n\t\t\tconst link = document.createElement('a');\n\t\t\tlink.href = this.reportDownloadLink;\n\t\t\tlink.download = `${this.$store.state.config.datasetProperties.name ?? 'csv_dataset'}_errors.html`;\n\t\t\tDom.append(link, document.body);\n\t\t\tlink.click();\n\t\t\tDom.remove(link);\n\t\t},\n\t\tprepareHintContent(phraseCode: string): string\n\t\t{\n\t\t\tconst message = this.$Bitrix.Loc.getMessage(phraseCode);\n\n\t\t\treturn message\n\t\t\t\t.replace('[link]', '<a onclick=\"top.BX.Helper.show(`redirect=detail&code=23779844`)\">')\n\t\t\t\t.replace('[/link]', '</a>')\n\t\t\t;\n\t\t},\n\t},\n\tmounted()\n\t{\n\t\tthis.downloadLogButton = new Button({\n\t\t\tsize: ButtonSize.EXTRA_SMALL,\n\t\t\tcolor: ButtonColor.LIGHT,\n\t\t\tnoCaps: true,\n\t\t\tonclick: this.onDownloadLogButtonClick,\n\t\t\ttext: this.$Bitrix.Loc.getMessage('DATASET_IMPORT_CSV_ERROR_POPUP_DOWNLOAD_LOG'),\n\t\t\tclassName: 'popup-errors-log-button',\n\t\t});\n\t\tthis.downloadLogButton.renderTo(this.$refs.summaryBlock);\n\t},\n\tbeforeUnmount()\n\t{\n\t\twindow.URL.revokeObjectURL(this.reportDownloadLink);\n\t\tthis.reportDownloadLink = null;\n\t},\n\tcomponents: {\n\t\tPopup,\n\t},\n\t// language=Vue\n\ttemplate: `\n\t\t<Popup id=\"generic\" @close=\"this.onClose\" :options=\"popupOptions\" wrapper-class=\"errors-popup\">\n\t\t\t<h3 class=\"popup-header\">{{ title }}</h3>\n\t\t\t<div class=\"ui-alert ui-alert-primary popup-hint\">\n\t\t\t\t<span v-html=\"hintContent\"></span>\n\t\t\t</div>\n\n\t\t\t<div class=\"popup-errors-summary\" ref=\"summaryBlock\">\n\t\t\t\t<div\n\t\t\t\t\tclass=\"popup-errors-count\"\n\t\t\t\t\tv-html=\"errorsCountText\"\n\t\t\t\t></div>\n\t\t\t</div>\n\n\t\t\t<div \n\t\t\t\tclass=\"popup-error-header-wrapper\"\n\t\t\t\t:style=\"errors.length >= 6 ? {'padding-right': '13px'} : {}\"\n\t\t\t>\n\t\t\t\t<table class=\"popup-error-header\">\n\t\t\t\t\t<tbody>\n\t\t\t\t\t<tr>\n\t\t\t\t\t<td class=\"popup-error-header-cell cell-error-number\">\n\t\t\t\t\t\t{{ $Bitrix.Loc.getMessage('DATASET_IMPORT_CSV_ERROR_POPUP_TABLE_HEADER_ERROR_NUMBER') }}\n\t\t\t\t\t</td>\n\t\t\t\t\t<td class=\"popup-error-header-cell cell-error-message\">\n\t\t\t\t\t\t{{ $Bitrix.Loc.getMessage('DATASET_IMPORT_CSV_ERROR_POPUP_TABLE_HEADER_ERROR_MESSAGE') }}\n\t\t\t\t\t</td>\n\t\t\t\t\t<td class=\"popup-error-header-cell cell-error-line\">\n\t\t\t\t\t\t{{ $Bitrix.Loc.getMessage('DATASET_IMPORT_CSV_ERROR_POPUP_TABLE_HEADER_LINE') }}\n\t\t\t\t\t</td>\n\t\t\t\t\t<td class=\"popup-error-header-cell cell-error-column-name\">\n\t\t\t\t\t\t{{ $Bitrix.Loc.getMessage('DATASET_IMPORT_CSV_ERROR_POPUP_TABLE_HEADER_COL_NAME') }}\n\t\t\t\t\t</td>\n\t\t\t\t\t</tr>\n\t\t\t\t\t</tbody>\n\t\t\t\t</table>\n\t\t\t</div>\n\n\t\t\t<div \n\t\t\t\tclass=\"popup-error-table-wrapper\"\n\t\t\t\t:style=\"errors.length >= 6 ? {'padding-right': '3px'} : {}\"\n\t\t\t>\n\t\t\t\t<div class=\"popup-error-table-scroll\">\n\t\t\t\t\t<table class=\"popup-error-table\">\n\t\t\t\t\t\t<tr v-for=\"(error, index) in errors\">\n\t\t\t\t\t\t\t<template v-if=\"index < 200\">\n\t\t\t\t\t\t\t\t<td class=\"popup-error-table-row-cell cell-error-number\">{{ index + 1 }}</td>\n\t\t\t\t\t\t\t\t<td class=\"popup-error-table-row-cell cell-error-message\">{{ error.errorMessage }}</td>\n\t\t\t\t\t\t\t\t<td class=\"popup-error-table-row-cell cell-error-line\">{{ error.lineNumber }}</td>\n\t\t\t\t\t\t\t\t<td class=\"popup-error-table-row-cell cell-error-column-name\" :title=\"error.columnName\">{{ error.columnName }}</td>\n\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t</table>\n\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t\t<div class=\"popup-buttons-wrapper\">\n\t\t\t\t<template v-if=\"isSavingMode\">\n\t\t\t\t\t<template v-if=\"errors.length > 200\">\n\t\t\t\t\t\t<button @click=\"this.onClose\" class=\"ui-btn ui-btn-md ui-btn-primary\">\n\t\t\t\t\t\t\t{{ $Bitrix.Loc.getMessage('DATASET_IMPORT_CSV_ERROR_POPUP_BUTTON_CLOSE') }}\n\t\t\t\t\t\t</button>\n\t\t\t\t\t</template>\n\t\t\t\t\t<template v-else>\n\t\t\t\t\t\t<button v-if=\"isEditMode\" @click=\"this.onClose\" class=\"ui-btn ui-btn-md ui-btn-primary\">\n\t\t\t\t\t\t\t{{ $Bitrix.Loc.getMessage('DATASET_IMPORT_CSV_ERROR_POPUP_BUTTON_STOP_UPDATE') }}\n\t\t\t\t\t\t</button>\n\t\t\t\t\t\t<button v-else @click=\"this.onClose\" class=\"ui-btn ui-btn-md ui-btn-primary\">\n\t\t\t\t\t\t\t{{ $Bitrix.Loc.getMessage('DATASET_IMPORT_CSV_ERROR_POPUP_BUTTON_STOP') }}\n\t\t\t\t\t\t</button>\n\n\t\t\t\t\t\t<button @click=\"this.onIgnoreErrorsClick\" class=\"ui-btn ui-btn-md ui-btn-light-border\">\n\t\t\t\t\t\t\t{{ $Bitrix.Loc.getMessage('DATASET_IMPORT_CSV_ERROR_POPUP_BUTTON_IGNORE') }}\n\t\t\t\t\t\t</button>\n\t\t\t\t\t</template>\n\t\t\t\t</template>\n\t\t\t\t<template v-else>\n\t\t\t\t\t<button @click=\"this.onClose\" class=\"ui-btn ui-btn-md ui-btn-primary\">\n\t\t\t\t\t\t{{ $Bitrix.Loc.getMessage('DATASET_IMPORT_CSV_ERROR_POPUP_BUTTON_CLOSE') }}\n\t\t\t\t\t</button>\n\t\t\t\t</template>\n\t\t\t</div>\n\t\t</Popup>\n\t`,\n};\n","import { Loader } from 'main.loader';\nimport type { PopupOptions } from 'main.popup';\nimport { Popup } from '../../layout/popup';\nimport '../../css/file-checking-popup.css';\n\nexport const CheckingProgressPopup = {\n\temits: ['close'],\n\tprops: {},\n\tcomputed: {\n\t\tpopupOptions(): PopupOptions\n\t\t{\n\t\t\treturn {\n\t\t\t\twidth: 440,\n\t\t\t\tcloseIcon: false,\n\t\t\t\tnoAllPaddings: true,\n\t\t\t\toverlay: true,\n\t\t\t\tbackground: 'transparent',\n\t\t\t};\n\t\t},\n\t},\n\tmounted()\n\t{\n\t\tconst loader = new Loader({\n\t\t\ttarget: this.$refs.loader,\n\t\t\tsize: 65,\n\t\t\tcolor: 'var(--ui-color-primary)',\n\t\t\tstrokeWidth: 4,\n\t\t\tmode: 'inline',\n\t\t});\n\t\tloader.show();\n\t},\n\tmethods: {\n\t\tonClose()\n\t\t{\n\t\t\tthis.$emit('close');\n\t\t},\n\t},\n\tcomponents: {\n\t\tPopup,\n\t},\n\t// language=Vue\n\ttemplate: `\n\t\t<Popup\n\t\t\tid=\"file-check-progress\"\n\t\t\t@close=\"this.onClose\"\n\t\t\t:options=\"popupOptions\"\n\t\t>\n\t\t\t<div class=\"file-check file-check-progress\">\n\t\t\t\t<div ref=\"loader\" class=\"file-check-loader\"></div>\n\t\t\t</div>\n\t\t</Popup>\n\t`,\n};\n","import type { PopupOptions } from 'main.popup';\nimport { Popup } from '../../layout/popup';\nimport '../../css/file-checking-popup.css';\n\nexport const CheckingSuccessPopup = {\n\temits: ['close'],\n\tprops: {},\n\tcomputed: {\n\t\tpopupOptions(): PopupOptions\n\t\t{\n\t\t\treturn {\n\t\t\t\twidth: 440,\n\t\t\t\tcloseIcon: true,\n\t\t\t\tnoAllPaddings: true,\n\t\t\t\toverlay: true,\n\t\t\t};\n\t\t},\n\t},\n\tmethods: {\n\t\tonClose()\n\t\t{\n\t\t\tthis.$emit('close');\n\t\t},\n\t},\n\tcomponents: {\n\t\tPopup,\n\t},\n\t// language=Vue\n\ttemplate: `\n\t\t<Popup \n\t\t\tid=\"file-check-success\"\n\t\t\t@close=\"this.onClose\" \n\t\t\t:options=\"popupOptions\" \n\t\t>\n\t\t\t<div class=\"file-check file-check-success\">\n\t\t\t\t<div class=\"biconnector-save-progress-popup__success-logo file-check-icon-success\"></div>\n\t\t\t\t<div class=\"file-check-title\">{{ $Bitrix.Loc.getMessage('DATASET_IMPORT_CSV_ERROR_POPUP_CHECK_OK_TITLE') }}</div>\n\t\t\t\t<div class=\"file-check-subtitle\">{{ $Bitrix.Loc.getMessage('DATASET_IMPORT_CSV_ERROR_POPUP_CHECK_OK_SUBTITLE') }}</div>\n\t\t\t\t<button @click=\"this.onClose\" class=\"ui-btn ui-btn-md ui-btn-primary file-check-button\">\n\t\t\t\t\t{{ $Bitrix.Loc.getMessage('DATASET_IMPORT_CSV_ERROR_POPUP_CHECK_OK_BUTTON') }}\n\t\t\t\t</button>\n\t\t\t</div>\n\t\t</Popup>\n\t`,\n};\n","import type { PopupOptions } from 'main.popup';\nimport { Popup } from '../../layout/popup';\nimport '../../css/file-checking-popup.css';\n\nexport const CheckingFailedPopup = {\n\temits: ['close'],\n\tprops: {},\n\tcomputed: {\n\t\tpopupOptions(): PopupOptions\n\t\t{\n\t\t\treturn {\n\t\t\t\twidth: 440,\n\t\t\t\tcloseIcon: true,\n\t\t\t\tnoAllPaddings: true,\n\t\t\t\toverlay: true,\n\t\t\t};\n\t\t},\n\t},\n\tmethods: {\n\t\tonClose()\n\t\t{\n\t\t\tthis.$emit('close');\n\t\t},\n\t},\n\tcomponents: {\n\t\tPopup,\n\t},\n\t// language=Vue\n\ttemplate: `\n\t\t<Popup \n\t\t\tid=\"file-check-failed\"\n\t\t\t@close=\"this.onClose\" \n\t\t\t:options=\"popupOptions\" \n\t\t>\n\t\t\t<div class=\"file-check file-check-failed\">\n\t\t\t\t<div class=\"biconnector-save-progress-popup__failure-logo file-check-icon-failed\"></div>\n\t\t\t\t<div class=\"file-check-title\">{{ $Bitrix.Loc.getMessage('DATASET_IMPORT_CSV_ERROR_POPUP_CHECK_FAILED_TITLE') }}</div>\n\t\t\t\t<div class=\"file-check-subtitle\">{{ $Bitrix.Loc.getMessage('DATASET_IMPORT_CSV_ERROR_POPUP_CHECK_FAILED_SUBTITLE') }}</div>\n\t\t\t\t<button @click=\"this.onClose\" class=\"ui-btn ui-btn-md ui-btn-primary file-check-button\">\n\t\t\t\t\t{{ $Bitrix.Loc.getMessage('DATASET_IMPORT_CSV_ERROR_POPUP_CHECK_FAILED_BUTTON') }}\n\t\t\t\t</button>\n\t\t\t</div>\n\t\t</Popup>\n\t`,\n};\n","import type { PopupOptions } from 'main.popup';\nimport { Popup } from '../layout/popup';\nimport '../css/generic-popup.css';\n\nexport const GenericPopup = {\n\temits: ['close'],\n\tprops: {\n\t\ttitle: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tcomputed: {\n\t\tpopupOptions(): PopupOptions\n\t\t{\n\t\t\treturn {\n\t\t\t\twidth: 440,\n\t\t\t\tcloseIcon: true,\n\t\t\t\tnoAllPaddings: true,\n\t\t\t\toverlay: true,\n\t\t\t};\n\t\t},\n\t},\n\tmethods: {\n\t\tonClose()\n\t\t{\n\t\t\tthis.$emit('close');\n\t\t},\n\t},\n\tcomponents: {\n\t\tPopup,\n\t},\n\t// language=Vue\n\ttemplate: `\n\t\t<Popup id=\"generic\" @close=\"this.onClose\" :options=\"popupOptions\" wrapper-class=\"generic-popup\">\n\t\t\t<h3 class=\"generic-popup__header\">{{ title }}</h3>\n\t\t\t<div class=\"generic-popup__content\">\n\t\t\t\t<slot name=\"content\"></slot>\n\t\t\t</div>\n\t\t\t<div class=\"generic-popup__buttons-wrapper\">\n\t\t\t\t<slot name=\"buttons\"></slot>\n\t\t\t</div>\n\t\t</Popup>\n\t`,\n};\n","import type { PopupOptions } from 'main.popup';\nimport { Popup } from '../../layout/popup';\n\nexport const SavingPopup = {\n\temits: ['close'],\n\tprops: {\n\t\ttitle: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t\tdescription: {\n\t\t\ttype: String,\n\t\t\trequired: false,\n\t\t\tdefault: '',\n\t\t},\n\t\toptions: {\n\t\t\ttype: Object,\n\t\t\trequired: false,\n\t\t\tdefault: {},\n\t\t},\n\t},\n\tcomputed: {\n\t\tpopupOptions(): PopupOptions\n\t\t{\n\t\t\treturn {\n\t\t\t\twidth: 500,\n\t\t\t\tminHeight: 299,\n\t\t\t\tcloseIcon: true,\n\t\t\t\tnoAllPaddings: true,\n\t\t\t\toverlay: true,\n\t\t\t\t...this.options,\n\t\t\t};\n\t\t},\n\t},\n\tmethods: {\n\t\tonClose()\n\t\t{\n\t\t\tthis.$emit('close');\n\t\t},\n\t},\n\tcomponents: {\n\t\tPopup,\n\t},\n\t// language=Vue\n\ttemplate: `\n\t\t<Popup id=\"saveProgress\" @close=\"this.onClose\" :options=\"popupOptions\" wrapper-class=\"biconnector-popup--full-height\">\n\t\t\t<div class=\"biconnector-save-progress-popup\">\n\t\t\t\t<div class=\"biconnector-save-progress-popup__content\">\n\t\t\t\t\t<slot name=\"icon\"></slot>\n\t\t\t\t\t<div class=\"biconnector-save-progress-popup__texts\">\n\t\t\t\t\t\t<h3 class=\"biconnector-save-progress-popup__header\">{{ title }}</h3>\n\t\t\t\t\t\t<p class=\"biconnector-save-progress-popup__description\" v-if=\"description\">{{ description }}</p>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"biconnector-save-progress-popup__buttons\"><slot name=\"buttons\"></slot></div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</Popup>\n\t`,\n};\n","import { SavingPopup } from './saving-popup';\n\nexport const ImportFailurePopup = {\n\tprops: {\n\t\ttitle: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t\tdescription: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t},\n\temits: ['click'],\n\tcomputed: {},\n\tmethods:\n\t{\n\t\tonClick()\n\t\t{\n\t\t\tthis.$emit('click');\n\t\t},\n\t},\n\tcomponents: {\n\t\tSaveProgressPopup: SavingPopup,\n\t},\n\t// language=Vue\n\ttemplate: `\n\t\t<SaveProgressPopup\n\t\t\t:title=\"title\"\n\t\t\t:description=\"description\"\n\t\t>\n\t\t\t<template v-slot:icon>\n\t\t\t\t<div class=\"biconnector-save-progress-popup__failure-logo\"></div>\n\t\t\t</template>\n\t\t\t<template v-slot:buttons>\n\t\t\t\t<button @click=\"onClick\" class=\"ui-btn ui-btn-md ui-btn-primary\">{{ $Bitrix.Loc.getMessage('DATASET_IMPORT_FAILURE_POPUP_BUTTON') }}</button>\n\t\t\t</template>\n\t\t</SaveProgressPopup>\n\t`,\n};\n","import { SavingPopup } from './saving-popup';\nimport { Loader } from 'main.loader';\n\nexport const ImportProgressPopup = {\n\tprops: {\n\t\tdescription: {\n\t\t\ttype: String,\n\t\t\trequired: false,\n\t\t\tdefault: '',\n\t\t},\n\t},\n\tmounted()\n\t{\n\t\tconst loader = new Loader({\n\t\t\ttarget: this.$refs.loader,\n\t\t\tsize: 65,\n\t\t\tcolor: 'var(--ui-color-primary)',\n\t\t\tstrokeWidth: 4,\n\t\t\tmode: 'inline',\n\t\t});\n\t\tloader.show();\n\t},\n\tcomputed: {\n\t\tpopupOptions()\n\t\t{\n\t\t\treturn {\n\t\t\t\tautoHide: false,\n\t\t\t\tcloseIcon: false,\n\t\t\t};\n\t\t},\n\t},\n\tcomponents: {\n\t\tSaveProgressPopup: SavingPopup,\n\t},\n\t// language=Vue\n\ttemplate: `\n\t\t<SaveProgressPopup\n\t\t\t:title=\"$Bitrix.Loc.getMessage('DATASET_IMPORT_PROGRESS_POPUP_HEADER')\"\n\t\t\t:description=\"description\"\n\t\t\t:options=\"popupOptions\"\n\t\t>\n\t\t\t<template v-slot:icon>\n\t\t\t\t<div ref=\"loader\" class=\"biconnector-save-progress-loader\"></div>\n\t\t\t</template>\n\t\t</SaveProgressPopup>\n\t`,\n};\n","import { ajax as Ajax, Dom } from 'main.core';\nimport { SavingPopup } from './saving-popup';\n\nexport const ImportSuccessPopup = {\n\temits: ['click', 'oneMoreClick'],\n\tprops: {\n\t\ttitle: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t\tdescription: {\n\t\t\ttype: String,\n\t\t\trequired: false,\n\t\t\tdefault: '',\n\t\t},\n\t\tdatasetId: {\n\t\t\ttype: Number,\n\t\t\trequired: true,\n\t\t},\n\t\tshowMoreButton: {\n\t\t\ttype: Boolean,\n\t\t\trequired: false,\n\t\t\tdefault: false,\n\t\t}\n\t},\n\tcomputed: {},\n\tmethods: {\n\t\tonButtonClick()\n\t\t{\n\t\t\tDom.addClass(this.$refs.openDatasetButton, 'ui-btn-wait');\n\t\t\tAjax.runAction(\n\t\t\t\t'biconnector.externalsource.dataset.getEditUrl',\n\t\t\t\t{\n\t\t\t\t\tdata: {\n\t\t\t\t\t\tid: this.datasetId,\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t)\n\t\t\t\t.then((response) => {\n\t\t\t\t\tconst link = response.data;\n\t\t\t\t\tif (link)\n\t\t\t\t\t{\n\t\t\t\t\t\twindow.open(link, '_blank').focus();\n\t\t\t\t\t\tDom.removeClass(this.$refs.openDatasetButton, 'ui-btn-wait');\n\t\t\t\t\t\tthis.$emit('click');\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t\t.catch((response) => {\n\t\t\t\t\tDom.removeClass(this.$refs.openDatasetButton, 'ui-btn-wait');\n\t\t\t\t\tthis.$emit('click');\n\t\t\t\t});\n\t\t},\n\t\tonOneMoreButtonClick()\n\t\t{\n\t\t\tDom.addClass(this.$refs.oneMoreButton, 'ui-btn-wait');\n\t\t\tthis.$emit('oneMoreClick');\n\t\t},\n\t},\n\tcomponents: {\n\t\tSaveProgressPopup: SavingPopup,\n\t},\n\t// language=Vue\n\ttemplate: `\n\t\t<SaveProgressPopup\n\t\t\t:title=\"title\"\n\t\t\t:description=\"description\"\n\t\t>\n\t\t\t<template v-slot:icon>\n\t\t\t\t<div class=\"biconnector-save-progress-popup__success-logo\"></div>\n\t\t\t</template>\n\t\t\t<template v-slot:buttons>\n\t\t\t\t<a class=\"ui-btn ui-btn-md ui-btn-primary\" @click=\"onButtonClick\" ref=\"openDatasetButton\">\n\t\t\t\t\t{{ $Bitrix.Loc.getMessage('DATASET_IMPORT_SUCCESS_POPUP_BUTTON_MSGVER_1') }}\n\t\t\t\t</a>\n\t\t\t\t<a class=\"ui-btn ui-btn-md ui-btn-light-border\" @click=\"onOneMoreButtonClick\" ref=\"oneMoreButton\" v-if=\"showMoreButton\">\n\t\t\t\t\t{{ $Bitrix.Loc.getMessage('DATASET_IMPORT_SUCCESS_POPUP_ONE_MORE_BUTTON') }}\n\t\t\t\t</a>\n\t\t\t</template>\n\t\t</SaveProgressPopup>\n\t`,\n};\n","import 'ui.alerts';\nimport '../css/step-hint.css';\n\nexport const StepHint = {\n\tprops: {\n\t\thintClass: {\n\t\t\ttype: String,\n\t\t\trequired: false,\n\t\t\tdefault: 'ui-alert-primary',\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"ui-alert dataset-import-step__hint\" :class=\"hintClass\">\n\t\t\t<span class=\"ui-alert-message\">\n\t\t\t\t<slot></slot>\n\t\t\t</span>\n\t\t</div>\n\t`,\n};\n","import { Text } from 'main.core';\nimport { Section } from 'ui.section';\nimport { StepHint } from './step-hint';\nimport '../css/step.css';\n\nexport const StepBlock = {\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tsection: null,\n\t\t};\n\t},\n\tprops: {\n\t\ttitle: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t\thint: {\n\t\t\ttype: String,\n\t\t\trequired: false,\n\t\t\tdefault: '',\n\t\t},\n\t\tisOpenInitially: {\n\t\t\ttype: Boolean,\n\t\t\trequired: false,\n\t\t\tdefault: true,\n\t\t},\n\t\tcanCollapse: {\n\t\t\ttype: Boolean,\n\t\t\trequired: false,\n\t\t\tdefault: true,\n\t\t},\n\t\tdisabled: {\n\t\t\ttype: Boolean,\n\t\t\trequired: false,\n\t\t\tdefault: false,\n\t\t},\n\t\tcustomClasses: {\n\t\t\ttype: Array,\n\t\t\tdefault: [],\n\t\t},\n\t\thintClass: {\n\t\t\ttype: String,\n\t\t\trequired: false,\n\t\t},\n\t},\n\tcomputed: {\n\t\tadditionalClasses()\n\t\t{\n\t\t\tconst custom = this.customClasses.reduce((acc, key) => {\n\t\t\t\tacc[key] = true;\n\n\t\t\t\treturn acc;\n\t\t\t}, {});\n\n\t\t\treturn {\n\t\t\t\t'dataset-import-step__disabled': this.disabled,\n\t\t\t\t...custom,\n\t\t\t};\n\t\t},\n\t},\n\tmethods: {\n\t\ttoggleCollapse(open: ?boolean)\n\t\t{\n\t\t\tthis.section.toggle(open);\n\t\t},\n\t},\n\tmounted()\n\t{\n\t\tconst contentContainer = this.$refs.contentContainer;\n\n\t\tconst section = new Section({\n\t\t\ttitle: this.title,\n\t\t\tisOpen: this.isOpenInitially,\n\t\t\tcanCollapse: this.canCollapse,\n\t\t});\n\n\t\tsection.append(this.$refs.content);\n\t\tsection.renderTo(contentContainer);\n\t\tthis.section = section;\n\t},\n\twatch: {\n\t\ttitle(newValue)\n\t\t{\n\t\t\tif (!this.section)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.section.getContent().querySelector('.ui-section__title').innerHTML = Text.encode(newValue);\n\t\t},\n\t},\n\tcomponents: {\n\t\tStepHint,\n\t},\n\t// language=Vue\n\ttemplate: `\n\t\t<div class=\"dataset-import-step\" :class=\"additionalClasses\" ref=\"contentContainer\">\n\t\t</div>\n\t\t<div ref=\"content\" class=\"dataset-import-step__content\">\n\t\t\t<StepHint v-if=\"hint\" :hint-class=\"hintClass\">\n\t\t\t\t<span v-html=\"hint\"></span>\n\t\t\t</StepHint>\n\t\t\t<slot></slot>\n\t\t</div>\n\t`,\n};\n","import { StepBlock } from '../layout/step-block';\n\nexport const BaseStep = {\n\temits: ['validation'],\n\tprops: {\n\t\ttitle: {\n\t\t\ttype: String,\n\t\t\trequired: false,\n\t\t},\n\t\thint: {\n\t\t\ttype: String,\n\t\t\trequired: false,\n\t\t},\n\t\tisOpenInitially: {\n\t\t\ttype: Boolean,\n\t\t\trequired: false,\n\t\t\tdefault: true,\n\t\t},\n\t\tdisabled: {\n\t\t\ttype: Boolean,\n\t\t\trequired: false,\n\t\t\tdefault: false,\n\t\t},\n\t\tdisabledElements: {\n\t\t\ttype: Object,\n\t\t\trequired: false,\n\t\t\tdefault: null,\n\t\t},\n\t},\n\tcomputed: {\n\t\tdisplayedTitle()\n\t\t{\n\t\t\treturn this.title ?? this.defaultTitle;\n\t\t},\n\t\tdisplayedHint()\n\t\t{\n\t\t\treturn this.hint ?? this.defaultHint;\n\t\t},\n\t\tdefaultTitle()\n\t\t{\n\t\t\treturn '';\n\t\t},\n\t\tdefaultHint()\n\t\t{\n\t\t\treturn '';\n\t\t},\n\t},\n\tmethods: {\n\t\topen()\n\t\t{\n\t\t\tif (this.$refs.stepBlock)\n\t\t\t{\n\t\t\t\tthis.$refs.stepBlock.toggleCollapse(true);\n\t\t\t}\n\t\t},\n\t\tclose()\n\t\t{\n\t\t\tif (this.$refs.stepBlock)\n\t\t\t{\n\t\t\t\tthis.$refs.stepBlock.toggleCollapse(false);\n\t\t\t}\n\t\t},\n\t\tvalidate()\n\t\t{\n\t\t\treturn true;\n\t\t},\n\t\tshowValidationErrors()\n\t\t{},\n\t},\n\tcomponents: {\n\t\tStep: StepBlock,\n\t},\n};\n","import { Tag } from 'main.core';\nimport { Popup, PopupOptions } from 'main.popup';\n\nexport class ErrorPopup\n{\n\tstatic create(message: string, element: HTMLElement): Popup\n\t{\n\t\tconst content = Tag.render`<span class='ui-hint-content'></span>`;\n\t\tcontent.innerHTML = message;\n\n\t\tconst popupOptions: PopupOptions = {\n\t\t\tbindElement: element,\n\t\t\tdarkMode: true,\n\t\t\tcontent,\n\t\t\tautoHide: false,\n\t\t\tbindOptions: {\n\t\t\t\tposition: 'top',\n\t\t\t},\n\t\t\tangle: {\n\t\t\t\tposition: 'bottom',\n\t\t\t},\n\t\t\tcacheable: false,\n\t\t};\n\n\t\tPopup.setOptions({\n\t\t\tangleMinBottom: 43,\n\t\t});\n\n\t\treturn new Popup(popupOptions);\n\t}\n}\n","import '../../css/dataset-import-field.css';\n\nexport const BaseField = {\n\tprops: {\n\t\tdefaultValue: {\n\t\t\trequired: false,\n\t\t\tdefault: '',\n\t\t},\n\t\tname: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t\ttitle: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t\tplaceholder: {\n\t\t\ttype: String,\n\t\t\trequired: false,\n\t\t\tdefault: '',\n\t\t},\n\t\tisValid: {\n\t\t\ttype: Boolean,\n\t\t\trequired: false,\n\t\t\tdefault: true,\n\t\t},\n\t\terrorMessage: {\n\t\t\ttype: String,\n\t\t\trequired: false,\n\t\t\tdefault: '',\n\t\t},\n\t\tisDisabled: {\n\t\t\ttype: Boolean,\n\t\t\trequired: false,\n\t\t\tdefault: false,\n\t\t},\n\t\thintText: {\n\t\t\ttype: String,\n\t\t\trequired: false,\n\t\t},\n\t},\n\temits: [\n\t\t'valueChange',\n\t],\n\tdata()\n\t{\n\t\treturn {\n\t\t\tvalue: this.defaultValue,\n\t\t\tareValidationErrorsShown: false,\n\t\t};\n\t},\n\tmethods: {\n\t\tshowValidationErrors()\n\t\t{\n\t\t\tthis.areValidationErrorsShown = true;\n\t\t},\n\t\tonInputChange(newValue)\n\t\t{\n\t\t\tthis.$emit('valueChange', {\n\t\t\t\tnewValue,\n\t\t\t\tfieldName: this.name,\n\t\t\t});\n\t\t},\n\t},\n\twatch: {\n\t\tdefaultValue(newValue)\n\t\t{\n\t\t\tthis.value = newValue;\n\t\t},\n\t},\n};\n","import { Dom } from 'main.core';\nimport { ErrorPopup } from '../../layout/error-popup';\nimport { BaseField } from './base-field';\nimport '../../css/dataset-import-field.css';\nimport 'ui.hint';\n\nexport const StringField = {\n\textends: BaseField,\n\tdata()\n\t{\n\t\treturn {\n\t\t\terrorPopup: null,\n\t\t\terrorPopupTimeout: null,\n\t\t};\n\t},\n\tmethods: {\n\t\tonInput(event)\n\t\t{\n\t\t\tthis.areValidationErrorsShown = false;\n\t\t\tthis.onInputChange(event.target.value);\n\t\t},\n\t\tonBlur()\n\t\t{\n\t\t\tthis.areValidationErrorsShown = true;\n\t\t\tif (!this.isValid)\n\t\t\t{\n\t\t\t\tthis.showErrorHint();\n\t\t\t\tthis.errorPopupTimeout = setTimeout(() => {\n\t\t\t\t\tthis.hideErrorHint();\n\t\t\t\t\tthis.errorPopupTimeout = null;\n\t\t\t\t}, 3000);\n\t\t\t}\n\t\t},\n\t\tshowErrorHint()\n\t\t{\n\t\t\tif (this.errorPopupTimeout)\n\t\t\t{\n\t\t\t\tclearTimeout(this.errorPopupTimeout);\n\t\t\t\tthis.errorPopupTimeout = null;\n\t\t\t}\n\t\t\telse if (!this.errorPopup || this.errorPopup.isDestroyed())\n\t\t\t{\n\t\t\t\tthis.errorPopup = this.createErrorPopup();\n\t\t\t\tthis.errorPopup.show();\n\t\t\t}\n\t\t},\n\t\thideErrorHint()\n\t\t{\n\t\t\tif (this.errorPopup)\n\t\t\t{\n\t\t\t\tthis.errorPopup.close();\n\t\t\t}\n\t\t\tclearTimeout(this.errorPopupTimeout);\n\t\t\tthis.errorPopupTimeout = null;\n\t\t},\n\t\tcreateErrorPopup()\n\t\t{\n\t\t\treturn ErrorPopup.create(this.errorMessage, this.$refs.errorIconWrapper);\n\t\t},\n\t},\n\tmounted()\n\t{\n\t\tif (this.hintText)\n\t\t{\n\t\t\tDom.append(BX.UI.Hint.createNode(this.hintText), this.$refs.title);\n\t\t}\n\t},\n\t// language=Vue\n\ttemplate: `\n\t\t<div class=\"ui-form-row\">\n\t\t\t<div class=\"ui-form-label\">\n\t\t\t\t<div class=\"ui-ctl-label-text\" ref=\"title\">\n\t\t\t\t\t{{ title }}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div class=\"ui-ctl ui-ctl-after-icon ui-ctl-textbox ui-ctl-w100 dataset-import-control\">\n\t\t\t\t<input\n\t\t\t\t\tclass=\"ui-ctl-element dataset-import-field\"\n\t\t\t\t\ttype=\"text\"\n\t\t\t\t\t:class=\"{ 'data-import-field--invalid': !isValid && areValidationErrorsShown }\"\n\t\t\t\t\t:disabled=\"isDisabled\"\n\t\t\t\t\t:placeholder=\"placeholder\"\n\t\t\t\t\tv-model=\"value\"\n\t\t\t\t\t@input=\"onInput\"\n\t\t\t\t\t@blur=\"onBlur\"\n\t\t\t\t>\n\t\t\t\t<div class=\"ui-ctl-after\" ref=\"errorIconWrapper\">\n\t\t\t\t\t<div\n\t\t\t\t\t\tclass=\"ui-icon-set --warning format-table__error-icon\"\n\t\t\t\t\t\t@mouseenter=\"showErrorHint\"\n\t\t\t\t\t\t@mouseleave=\"hideErrorHint\"\n\t\t\t\t\t\tv-if=\"!isValid && areValidationErrorsShown\"\n\t\t\t\t\t></div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import { BaseField } from './base-field';\n\nexport const TextField = {\n\textends: BaseField,\n\t// language=Vue\n\ttemplate: `\n\t\t<div class=\"ui-form-row\">\n\t\t\t<div class=\"ui-form-label\">\n\t\t\t\t<div class=\"ui-ctl-label-text\">{{ title }}</div>\n\t\t\t</div>\n\t\t\t<div class=\"ui-ctl ui-ctl-textarea dataset-import-textarea ui-ctl-w100 ui-ctl-no-resize\">\n\t\t\t\t<textarea \n\t\t\t\t\tclass=\"ui-ctl-element dataset-import-textarea-element\" \n\t\t\t\t\t:placeholder=\"placeholder\" \n\t\t\t\t\t@input=\"onInputChange($event.target.value)\"\n\t\t\t\t\tv-model=\"value\"\n\t\t\t\t></textarea>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import type { FieldValueChangeEvent } from '../types/field-value-change-event';\nimport { StringField } from './type/string-field';\nimport { TextField } from './type/text-field';\nimport '../css/dataset-properties.css';\n\nexport const DatasetProperties = {\n\tprops: {\n\t\tdefaultName: {\n\t\t\ttype: String,\n\t\t\trequired: false,\n\t\t\tdefault: '',\n\t\t},\n\t\tdefaultDescription: {\n\t\t\ttype: String,\n\t\t\trequired: false,\n\t\t\tdefault: '',\n\t\t},\n\t\tunvalidatedFields: {\n\t\t\ttype: Object,\n\t\t\trequired: false,\n\t\t\tdefault: {},\n\t\t},\n\t\tdisabledFields: {\n\t\t\ttype: Object,\n\t\t\trequired: false,\n\t\t\tdefault: {},\n\t\t},\n\t\tdatasetSourceCode: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t},\n\temits: [\n\t\t'valueChange',\n\t\t'validationNeeded',\n\t],\n\tmethods: {\n\t\tonValueChange(event: FieldValueChangeEvent)\n\t\t{\n\t\t\tthis.$emit('valueChange', event);\n\t\t},\n\t\tshowValidationErrors()\n\t\t{\n\t\t\tthis.$refs.nameField.showValidationErrors();\n\t\t},\n\t},\n\tcomponents: {\n\t\tStringField,\n\t\tTextField,\n\t},\n\t// language=Vue\n\ttemplate: `\n\t\t<div class=\"ui-form dataset-properties\">\n\t\t\t<StringField\n\t\t\t\tref=\"nameField\"\n\t\t\t\tname=\"name\"\n\t\t\t\t:defaultValue=\"defaultName\"\n\t\t\t\t@value-change=\"onValueChange\"\n\t\t\t\t:title=\"this.$Bitrix.Loc.getMessage('DATASET_IMPORT_DATASET_PROPERTIES_CODE')\"\n\t\t\t\t:placeholder=\"this.$Bitrix.Loc.getMessage('DATASET_IMPORT_DATASET_PROPERTIES_CODE_PLACEHOLDER', { '#CODE#': this.datasetSourceCode })\"\n\t\t\t\t:is-valid=\"unvalidatedFields.name?.result ?? true\"\n\t\t\t\t:is-disabled=\"disabledFields.name ?? false\"\n\t\t\t\t:error-message=\"unvalidatedFields.name?.message ?? ''\"\n\t\t\t/>\n\t\t\t<TextField\n\t\t\t\tname=\"description\"\n\t\t\t\t:defaultValue=\"defaultDescription\"\n\t\t\t\t@value-change=\"onValueChange\"\n\t\t\t\t:title=\"this.$Bitrix.Loc.getMessage('DATASET_IMPORT_DATASET_PROPERTIES_DESCRIPTION')\"\n\t\t\t/>\n\t\t</div>\n\t`,\n};\n","import { StepBlock } from '../layout/step-block';\nimport { BaseStep } from './base-step';\nimport { DatasetProperties } from '../fields/dataset-properties';\nimport type { FieldValueChangeEvent } from '../types/field-value-change-event';\n\nexport const DatasetPropertiesStep = {\n\textends: BaseStep,\n\tprops: {\n\t\tdatasetSourceCode: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t\treservedNames: {\n\t\t\ttype: Array,\n\t\t\trequired: false,\n\t\t\tdefault: [],\n\t\t},\n\t\tnameMaxLength: {\n\t\t\ttype: Number,\n\t\t\trequired: false,\n\t\t\tdefault: 30,\n\t\t},\n\t},\n\temits: ['propertiesChanged'],\n\tcomputed: {\n\t\tdatasetProperties()\n\t\t{\n\t\t\treturn this.$store.state.config.datasetProperties;\n\t\t},\n\t\tdefaultTitle()\n\t\t{\n\t\t\treturn this.$Bitrix.Loc.getMessage('DATASET_IMPORT_PROPERTIES_HEADER');\n\t\t},\n\t\tdefaultHint()\n\t\t{\n\t\t\tif (this.isEditMode)\n\t\t\t{\n\t\t\t\treturn '';\n\t\t\t}\n\n\t\t\treturn this.$Bitrix.Loc.getMessage('DATASET_IMPORT_PROPERTIES_HINT');\n\t\t},\n\t\tdisabledFields()\n\t\t{\n\t\t\treturn {\n\t\t\t\tname: this.$store.getters.isEditMode,\n\t\t\t};\n\t\t},\n\t\tunvalidatedFields()\n\t\t{\n\t\t\tconst result = {};\n\t\t\tconst nameValidationResult = this.validateName();\n\t\t\tif (!nameValidationResult.result)\n\t\t\t{\n\t\t\t\tresult.name = nameValidationResult;\n\t\t\t}\n\n\t\t\treturn result;\n\t\t},\n\t\tisEditMode()\n\t\t{\n\t\t\treturn this.$store.getters.isEditMode;\n\t\t},\n\t},\n\tcomponents: {\n\t\tStep: StepBlock,\n\t\tDatasetProperties,\n\t},\n\tmethods: {\n\t\tonDatasetPropertiesFieldsChange(event: FieldValueChangeEvent)\n\t\t{\n\t\t\tconst datasetProperties = this.datasetProperties;\n\t\t\tdatasetProperties[event.fieldName] = event.newValue;\n\t\t\tthis.$store.commit('setDatasetProperties', datasetProperties);\n\t\t\tthis.validate();\n\n\t\t\tthis.$emit('propertiesChanged');\n\t\t},\n\t\tvalidate()\n\t\t{\n\t\t\tlet result = true;\n\t\t\tif (!this.isEditMode)\n\t\t\t{\n\t\t\t\tresult = Object.keys(this.unvalidatedFields).length === 0;\n\t\t\t}\n\n\t\t\tthis.$emit('validation', result);\n\n\t\t\treturn result;\n\t\t},\n\t\tvalidateName()\n\t\t{\n\t\t\tconst name = this.$store.state.config.datasetProperties.name;\n\t\t\tif (!name)\n\t\t\t{\n\t\t\t\treturn {\n\t\t\t\t\tresult: true,\n\t\t\t\t};\n\t\t\t}\n\n\t\t\tconst isReserved = this.reservedNames.includes(name);\n\t\t\tif (isReserved)\n\t\t\t{\n\t\t\t\treturn {\n\t\t\t\t\tresult: false,\n\t\t\t\t\tmessage: this.$Bitrix.Loc.getMessage('DATASET_IMPORT_FIELD_VALIDATION_DATASET_EXISTS'),\n\t\t\t\t};\n\t\t\t}\n\n\t\t\tif (name.length > this.nameMaxLength)\n\t\t\t{\n\t\t\t\treturn {\n\t\t\t\t\tresult: false,\n\t\t\t\t\tmessage: this.$Bitrix.Loc.getMessage('DATASET_IMPORT_FIELD_VALIDATION_DATASET_TOO_LONG_MSGVER_1', { '#MAX_LENGHT#': this.nameMaxLength }),\n\t\t\t\t};\n\t\t\t}\n\n\t\t\tif (!/^[a-z][\\d_a-z]*$/.test(name))\n\t\t\t{\n\t\t\t\treturn {\n\t\t\t\t\tresult: false,\n\t\t\t\t\tmessage: this.$Bitrix.Loc.getMessage('DATASET_IMPORT_FIELD_VALIDATION_DATASET_INVALID_CHARS'),\n\t\t\t\t};\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\tresult: true,\n\t\t\t};\n\t\t},\n\t\tshowValidationErrors()\n\t\t{\n\t\t\tthis.$refs.datasetProperties.showValidationErrors();\n\t\t},\n\t},\n\ttemplate: `\n\t\t<Step\n\t\t\t:title=\"displayedTitle\"\n\t\t\t:hint=\"displayedHint\"\n\t\t\t:is-open-initially=\"isOpenInitially\"\n\t\t\t:disabled=\"disabled\"\n\t\t\tref=\"stepBlock\"\n\t\t>\n\t\t\t<slot name=\"additional-properties\"></slot>\n\t\t\t<DatasetProperties\n\t\t\t\t@value-change=\"onDatasetPropertiesFieldsChange\"\n\t\t\t\t:default-name=\"datasetProperties.name\"\n\t\t\t\t:default-description=\"datasetProperties.description\"\n\t\t\t\tref=\"datasetProperties\"\n\t\t\t\t:disabled-fields=\"disabledFields\"\n\t\t\t\t:unvalidated-fields=\"unvalidatedFields\"\n\t\t\t\t:dataset-source-code=\"datasetSourceCode\"\n\t\t\t/>\n\t\t</Step>\n\t`,\n};\n","import '../../css/format-table.css';\nimport 'ui.hint';\n\nexport const TableHeader = {\n\tprops: {\n\t\tenabled: {\n\t\t\ttype: Boolean,\n\t\t\trequired: false,\n\t\t\tdefault: true,\n\t\t},\n\t\tindeterminate: {\n\t\t\ttype: Boolean,\n\t\t\trequired: false,\n\t\t\tdefault: false,\n\t\t},\n\t},\n\temits: [\n\t\t'checkboxClick',\n\t],\n\tcomputed: {\n\t\tisNeedShowOriginalNameHint(): boolean\n\t\t{\n\t\t\treturn this.$store.state.config.fileProperties?.firstLineHeader ?? true;\n\t\t},\n\t},\n\tmethods: {\n\t\tonCheckboxClick(event)\n\t\t{\n\t\t\tevent.preventDefault();\n\t\t\tthis.$emit('checkboxClick');\n\t\t},\n\t},\n\t// language=Vue\n\ttemplate: `\n\t\t<tr>\n\t\t\t<th class=\"format-table__header format-table__checkbox-header\">\n\t\t\t\t<input class=\"format-table__checkbox\" type=\"checkbox\" @change=\"onCheckboxClick\" :checked=\"enabled\" :indeterminate.prop=\"indeterminate\">\n\t\t\t</th>\n\t\t\t<th class=\"format-table__header format-table__type-header format-table__type-subfield-header\">{{ $Bitrix.Loc.getMessage('DATASET_IMPORT_FIELD_SETTINGS_TYPE_HEADER') }}</th>\n\t\t\t<th class=\"format-table__header format-table__header format-table__title-header\">{{ $Bitrix.Loc.getMessage('DATASET_IMPORT_FIELD_SETTINGS_CODE_HEADER') }}</th>\n\t\t\t<th class=\"format-table__header format-table__header format-table__title-header\" v-if=\"isNeedShowOriginalNameHint\"></th>\n\t\t</tr>\n\t`,\n};\n","import { Loc } from 'main.core';\n\ntype DataTypeDescription = {\n\ttitle: string,\n\ticon: string,\n}\n\nconst DataType = {\n\tstring: 'string',\n\tmoney: 'money',\n\tint: 'int',\n\tdouble: 'double',\n\tdate: 'date',\n\tdatetime: 'datetime',\n};\n\nconst DataTypeDescriptions: Record<string, DataTypeDescription> = {\n\t[DataType.string]: {\n\t\ttitle: Loc.getMessage('DATASET_IMPORT_FIELD_SETTINGS_TYPE_TEXT'),\n\t\ticon: '--formatting',\n\t},\n\t[DataType.money]: {\n\t\ttitle: Loc.getMessage('DATASET_IMPORT_FIELD_SETTINGS_TYPE_MONEY'),\n\t\ticon: '--money',\n\t},\n\t[DataType.int]: {\n\t\ttitle: Loc.getMessage('DATASET_IMPORT_FIELD_SETTINGS_TYPE_NUMBER'),\n\t\ticon: '--numbers-123',\n\t},\n\t[DataType.double]: {\n\t\ttitle: Loc.getMessage('DATASET_IMPORT_FIELD_SETTINGS_TYPE_DECIMAL'),\n\t\ticon: '--numbers-05',\n\t},\n\t[DataType.date]: {\n\t\ttitle: Loc.getMessage('DATASET_IMPORT_FIELD_SETTINGS_TYPE_DATE'),\n\t\ticon: '--calendar-1',\n\t},\n\t[DataType.datetime]: {\n\t\ttitle: Loc.getMessage('DATASET_IMPORT_FIELD_SETTINGS_TYPE_DATETIME'),\n\t\ticon: '--planning-2',\n\t},\n};\n\ntype DataFormatTemplate = {\n\t[DataType.money]: string[],\n\t[DataType.double]: string[],\n\t[DataType.date]: string[],\n\t[DataType.datetime]: string[],\n};\n\nexport {\n\tDataType,\n\tDataTypeDescriptions,\n\tDataFormatTemplate,\n};\n","import { Menu } from 'main.popup';\nimport { DataTypeDescriptions } from '../../types/data-types';\n\ntype DataTypeMenuOptions = {\n\tselectedType: string,\n\tbindElement: HTMLElement,\n\tonSelect: Function,\n\tonClose: Function,\n};\n\nexport class DataTypeMenu\n{\n\t#selectedType: string;\n\t#bindElement: HTMLElement;\n\t#onSelect: Function;\n\t#onClose: Function;\n\n\tconstructor(options: DataTypeMenuOptions)\n\t{\n\t\tthis.#selectedType = options.selectedType;\n\t\tthis.#bindElement = options.bindElement;\n\t\tthis.#onSelect = options.onSelect;\n\t\tthis.#onClose = options.onClose;\n\t}\n\n\tgetMenu(): Menu\n\t{\n\t\tconst items = [];\n\t\tObject.entries(DataTypeDescriptions).forEach(([key, value]) => {\n\t\t\titems.push({\n\t\t\t\thtml: `\n\t\t\t\t\t<div class=\"ui-icon-set ${value.icon}\"></div>\n\t\t\t\t\t<span class=\"format-table__dropdown-item-text\">${value.title}</span>\n\t\t\t\t\t${key === this.#selectedType ? '<div class=\"format-table__dropdown-item-selected ui-icon-set --check\"></div>' : ''}\n\t\t\t\t`,\n\t\t\t\tonclick: (event, item) => {\n\t\t\t\t\tthis.#onSelect(key);\n\t\t\t\t\titem.getMenuWindow().close();\n\t\t\t\t},\n\t\t\t\tclassName: `format-table__dropdown-item${key === this.#selectedType ? ' format-table__dropdown-item--active' : ''}`,\n\t\t\t});\n\t\t});\n\n\t\treturn new Menu({\n\t\t\tclassName: 'format-table__dropdown-popup',\n\t\t\tbindElement: this.#bindElement,\n\t\t\titems,\n\t\t\tevents: {\n\t\t\t\tonClose: this.#onClose,\n\t\t\t},\n\t\t});\n\t}\n}\n","import { DataTypeMenu } from './data-type-menu';\nimport { DataTypeDescriptions } from '../../types/data-types';\n\nexport const DataTypeSelector = {\n\tprops: {\n\t\tselectedType: {\n\t\t\ttype: String,\n\t\t\trequired: false,\n\t\t\tdefault: 'text',\n\t\t},\n\t\tcanEdit: {\n\t\t\ttype: Boolean,\n\t\t\trequired: false,\n\t\t\tdefault: false,\n\t\t},\n\t\tdisabled: {\n\t\t\ttype: Boolean,\n\t\t\trequired: false,\n\t\t\tdefault: false,\n\t\t},\n\t},\n\temits: [\n\t\t'valueChange',\n\t],\n\tdata()\n\t{\n\t\treturn {\n\t\t\ttypeMenu: null,\n\t\t\tisFocused: false,\n\t\t};\n\t},\n\tcomputed: {\n\t\ticonClass()\n\t\t{\n\t\t\treturn DataTypeDescriptions[this.selectedType].icon;\n\t\t},\n\t\ttypeTitle()\n\t\t{\n\t\t\treturn DataTypeDescriptions[this.selectedType].title;\n\t\t},\n\t\tisEditable()\n\t\t{\n\t\t\treturn this.canEdit;\n\t\t},\n\t},\n\tmethods: {\n\t\tonClick(event)\n\t\t{\n\t\t\tif (!this.isEditable)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.isFocused = true;\n\n\t\t\tif (!this.typeMenu)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.typeMenu.getPopupWindow().setWidth(this.$refs.formatButton.offsetWidth);\n\t\t\tthis.typeMenu.show();\n\t\t},\n\t\tcreateMenu()\n\t\t{\n\t\t\tif (this.isEditable)\n\t\t\t{\n\t\t\t\tthis.typeMenu = (new DataTypeMenu({\n\t\t\t\t\tselectedType: this.selectedType,\n\t\t\t\t\tbindElement: this.$refs.formatButton,\n\t\t\t\t\tonSelect: (selectedType) => {\n\t\t\t\t\t\tthis.$emit('valueChange', selectedType);\n\t\t\t\t\t},\n\t\t\t\t\tonClose: () => {\n\t\t\t\t\t\tthis.isFocused = false;\n\t\t\t\t\t},\n\t\t\t\t})).getMenu();\n\t\t\t}\n\t\t},\n\t\tdestroyMenu()\n\t\t{\n\t\t\tthis.typeMenu?.destroy();\n\t\t},\n\t},\n\tmounted()\n\t{\n\t\tthis.createMenu();\n\t},\n\tbeforeUnmount()\n\t{\n\t\tthis.destroyMenu();\n\t},\n\twatch: {\n\t\tselectedType(newValue)\n\t\t{\n\t\t\tthis.destroyMenu();\n\t\t\tthis.createMenu();\n\t\t},\n\t\tisEditable(newValue)\n\t\t{\n\t\t\tif (newValue && !this.typeMenu)\n\t\t\t{\n\t\t\t\tthis.createMenu();\n\t\t\t}\n\n\t\t\tif (!newValue)\n\t\t\t{\n\t\t\t\tthis.destroyMenu();\n\t\t\t}\n\t\t}\n\t},\n\t// language=Vue\n\ttemplate: `\n\t\t<div\n\t\t\tclass=\"ui-ctl ui-ctl-before-icon ui-ctl-after-icon ui-ctl-w100 format-table__type-control ui-ctl-dropdown\"\n\t\t\tref=\"formatButton\"\n\t\t\t@click=\"onClick\"\n\t\t\t:class=\"{\n\t\t\t\t'format-table__type-control--disabled': !isEditable,\n\t\t\t\t'ui-ctl-hover': isFocused,\n\t\t\t}\"\n\t\t>\n\t\t\t<div class=\"ui-ctl-after ui-ctl-icon-angle\" v-if=\"isEditable\"></div>\n\t\t\t<div class=\"ui-ctl-before\">\n\t\t\t\t<div class=\"format-table__type-button\" :class=\"{ 'format-table__type-button--disabled': !isEditable }\">\n\t\t\t\t\t<div class=\"ui-icon-set\" :class=\"iconClass\"></div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div class=\"ui-ctl-element format-table__text-input\">\n\t\t\t\t<span>{{ typeTitle }}</span>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import '../../css/format-table.css';\nimport { ErrorPopup } from '../../layout/error-popup';\nimport { DataTypeDescriptions } from '../../types/data-types';\nimport { DataTypeSelector } from './data-type-selector';\nimport { BIcon, Set } from 'ui.icon-set.api.vue';\nimport { hint } from 'ui.vue3.directives.hint';\n\nexport const TableRow = {\n\tdirectives: {\n\t\thint,\n\t},\n\tprops: {\n\t\tenabled: {\n\t\t\ttype: Boolean,\n\t\t\trequired: false,\n\t\t\tdefault: true,\n\t\t},\n\t\tindex: {\n\t\t\ttype: Number,\n\t\t\trequired: true,\n\t\t},\n\t\tfieldSettings: {\n\t\t\ttype: Object,\n\t\t\trequired: false,\n\t\t\tdefault: null,\n\t\t},\n\t\tinvalidFields: {\n\t\t\ttype: Object,\n\t\t\trequired: false,\n\t\t\tdefault: {},\n\t\t},\n\t\tdisabledElements: {\n\t\t\ttype: Object,\n\t\t\trequired: false,\n\t\t\tdefault: null,\n\t\t},\n\t},\n\tdata()\n\t{\n\t\treturn {\n\t\t\tdisplayedValidationErrors: {\n\t\t\t\tname: true,\n\t\t\t},\n\t\t\terrorPopup: {\n\t\t\t\tname: null,\n\t\t\t},\n\t\t\terrorPopupTimeout: null,\n\t\t};\n\t},\n\tcomputed: {\n\t\tisNameValid(): boolean\n\t\t{\n\t\t\treturn !('name' in this.invalidFields);\n\t\t},\n\t\tdisplayedErrorForName(): string\n\t\t{\n\t\t\treturn this.invalidFields.name.message;\n\t\t},\n\t\tset(): Set\n\t\t{\n\t\t\treturn Set;\n\t\t},\n\t\toriginalsHintText(): string\n\t\t{\n\t\t\tconst originalType = this.fieldSettings.originalType;\n\t\t\tconst originalName = this.fieldSettings.originalName;\n\n\t\t\tlet typeText = '';\n\t\t\tif (originalType)\n\t\t\t{\n\t\t\t\ttypeText = this.$Bitrix.Loc.getMessage('DATASET_IMPORT_FIELD_SETTINGS_ORIG_TYPE', {\n\t\t\t\t\t'#CLASS#': '<span class=\"format-table__orig_info_title\">',\n\t\t\t\t\t'#/CLASS#': '</span>',\n\t\t\t\t\t'#TYPENAME#': DataTypeDescriptions[originalType].title,\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tconst nameText = this.$Bitrix.Loc.getMessage('DATASET_IMPORT_FIELD_SETTINGS_ORIG_NAME', {\n\t\t\t\t'#CLASS#': '<span class=\"format-table__orig_info_title\">',\n\t\t\t\t'#/CLASS#': '</span>',\n\t\t\t\t'#FIELDNAME#': originalName,\n\t\t\t});\n\n\t\t\tif (!originalType)\n\t\t\t{\n\t\t\t\treturn nameText;\n\t\t\t}\n\n\t\t\treturn `${typeText}<br>${nameText}`;\n\t\t},\n\t\tisNeedShowOriginalNameHint(): boolean\n\t\t{\n\t\t\treturn (this.$store.state.config.fileProperties?.firstLineHeader ?? true)\n\t\t\t\t&& this.$store.state.config.connectionProperties?.connectionType\n\t\t\t\t&& this.$store.state.config.connectionProperties?.connectionType !== 'rest'\n\t\t\t;\n\t\t},\n\t\thintOptions(): Object\n\t\t{\n\t\t\treturn {\n\t\t\t\thtml: this.originalsHintText,\n\t\t\t\tpopupOptions: {\n\t\t\t\t\tangle: {\n\t\t\t\t\t\tposition: 'left',\n\t\t\t\t\t},\n\t\t\t\t\toffsetLeft: 30,\n\t\t\t\t\toffsetTop: -46,\n\t\t\t\t\tautoHide: false,\n\t\t\t\t},\n\t\t\t};\n\t\t},\n\t\tcanEdit(): boolean\n\t\t{\n\t\t\treturn !(this.fieldSettings?.id > 0);\n\t\t},\n\t},\n\temits: [\n\t\t'checkboxClick',\n\t\t'fieldChange',\n\t],\n\tmethods: {\n\t\tonCheckboxClick(event)\n\t\t{\n\t\t\tevent.preventDefault();\n\t\t\tthis.$emit('checkboxClick', {\n\t\t\t\tindex: this.index,\n\t\t\t});\n\t\t},\n\t\tonTypeSelected(type)\n\t\t{\n\t\t\tthis.$emit('fieldChange', {\n\t\t\t\tfieldName: 'type',\n\t\t\t\tvalue: type,\n\t\t\t\tindex: this.index,\n\t\t\t});\n\t\t},\n\t\tonFieldInput(event)\n\t\t{\n\t\t\tif (!this.canEdit || this.disabledElements?.name)\n\t\t\t{\n\t\t\t\tconst input = event.target;\n\t\t\t\tinput.value = this.fieldSettings.name;\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.displayedValidationErrors[event.target.name] = false;\n\t\t\tthis.$emit('fieldChange', {\n\t\t\t\tfieldName: event.target.name,\n\t\t\t\tvalue: event.target.value,\n\t\t\t\tindex: this.index,\n\t\t\t});\n\t\t},\n\t\tonFieldBlur(event)\n\t\t{\n\t\t\tthis.displayedValidationErrors[event.target.name] = true;\n\n\t\t\tif ('name' in this.invalidFields)\n\t\t\t{\n\t\t\t\tthis.showErrorHint();\n\t\t\t\tthis.errorPopupTimeout = setTimeout(() => {\n\t\t\t\t\tthis.hideErrorHint();\n\t\t\t\t\tthis.errorPopupTimeout = null;\n\t\t\t\t}, 3000);\n\t\t\t}\n\t\t},\n\t\tshowValidationErrors()\n\t\t{\n\t\t\tObject.keys(this.displayedValidationErrors).forEach((field) => {\n\t\t\t\tthis.displayedValidationErrors[field] = true;\n\t\t\t});\n\t\t},\n\t\tshowErrorHint()\n\t\t{\n\t\t\tif (this.errorPopupTimeout)\n\t\t\t{\n\t\t\t\tclearTimeout(this.errorPopupTimeout);\n\t\t\t\tthis.errorPopupTimeout = null;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.errorPopup.name = this.createErrorPopup();\n\t\t\t\tthis.errorPopup.name.show();\n\t\t\t}\n\t\t},\n\t\thideErrorHint()\n\t\t{\n\t\t\tif (this.errorPopup.name)\n\t\t\t{\n\t\t\t\tthis.errorPopup.name.close();\n\t\t\t}\n\t\t},\n\t\tcreateErrorPopup()\n\t\t{\n\t\t\treturn ErrorPopup.create(this.displayedErrorForName, this.$refs.errorIconWrapper);\n\t\t},\n\t},\n\twatch: {\n\t\tisNeedShowOriginalNameHint()\n\t\t{\n\t\t\tif (this.$refs.originalsHint)\n\t\t\t{\n\t\t\t\tthis.$refs.originalsHint.remove();\n\t\t\t}\n\t\t},\n\t},\n\tcomponents: {\n\t\tDataTypeButton: DataTypeSelector,\n\t\tBIcon,\n\t},\n\t// language=Vue\n\ttemplate: `\n\t\t<tr class=\"format-table__row\">\n\t\t\t<td class=\"format-table__checkbox-cell\">\n\t\t\t\t<input class=\"format-table__checkbox\" ref=\"visibilityCheckbox\" type=\"checkbox\" @change=\"onCheckboxClick\" :checked=\"enabled\">\n\t\t\t</td>\n\t\t\t<td class=\"format-table__cell\">\n\t\t\t\t<DataTypeButton :selected-type=\"fieldSettings.type\" @value-change=\"onTypeSelected\" :can-edit=\"canEdit && !disabledElements?.type\" :disabled=\"!canEdit || disabledElements?.type\"/>\n\t\t\t</td>\n\t\t\t<td class=\"format-table__cell\">\n\t\t\t\t<div\n\t\t\t\t\tclass=\"ui-ctl ui-ctl-textbox ui-ctl-w100 format-table__name-control\"\n\t\t\t\t\t:class=\"{\n\t\t\t\t\t\t'format-table__text-input--invalid': displayedValidationErrors.name && !isNameValid,\n\t\t\t\t\t\t'format-table__text-input--disabled': !canEdit || disabledElements?.name,\n\t\t\t\t\t\t'ui-ctl-after-icon': canEdit && !isNameValid,\n\t\t\t\t\t}\"\n\t\t\t\t>\n\t\t\t\t\t<input\n\t\t\t\t\t\tclass=\"ui-ctl-element format-table__text-input format-table__name-input\"\n\t\t\t\t\t\t:disabled=\"!canEdit || disabledElements?.name\"\n\t\t\t\t\t\ttype=\"text\"\n\t\t\t\t\t\t:placeholder=\"$Bitrix.Loc.getMessage('DATASET_IMPORT_FIELD_SETTINGS_PLACEHOLDER')\"\n\t\t\t\t\t\tname=\"name\"\n\t\t\t\t\t\t@input=\"onFieldInput\"\n\t\t\t\t\t\t@blur=\"onFieldBlur\"\n\t\t\t\t\t\t:value=\"fieldSettings.name\"\n\t\t\t\t\t>\n\t\t\t\t\t<div class=\"ui-ctl-after\" ref=\"errorIconWrapper\">\n\t\t\t\t\t\t<div\n\t\t\t\t\t\t\tclass=\"ui-icon-set --warning format-table__error-icon\"\n\t\t\t\t\t\t\t@mouseenter=\"showErrorHint\"\n\t\t\t\t\t\t\t@mouseleave=\"hideErrorHint\"\n\t\t\t\t\t\t\tv-if=\"displayedValidationErrors.name && !isNameValid\"\n\t\t\t\t\t\t></div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</td>\n\t\t\t<td class=\"format-table__cell\" v-if=\"isNeedShowOriginalNameHint\">\n\t\t\t\t<div class=\"format-table__orig-type-hint-wrapper\" v-hint=\"hintOptions\" ref=\"originalsHint\">\n\t\t\t\t\t<div class=\"format-table__orig-type-hint\">\n\t\t\t\t\t\t<BIcon\n\t\t\t\t\t\t\t:name=\"set.INFO_1\"\n\t\t\t\t\t\t\t:size=\"20\"\n\t\t\t\t\t\t\tcolor=\"#B5BABE\"\n\t\t\t\t\t\t></BIcon>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</td>\n\t\t</tr>\n\t`,\n};\n","import { TableHeader } from './table-header';\nimport { TableRow } from './table-row';\nimport '../../css/format-table.css';\n\nexport const FormatTable = {\n\tprops: {\n\t\tfieldsSettings: {\n\t\t\ttype: Array,\n\t\t\trequired: false,\n\t\t},\n\t\tunvalidatedRows: {\n\t\t\ttype: Object,\n\t\t\trequired: false,\n\t\t},\n\t\tdisabledElements: {\n\t\t\ttype: Object,\n\t\t\trequired: false,\n\t\t\tdefault: null,\n\t\t},\n\t},\n\temits: [\n\t\t'rowToggle',\n\t\t'headerToggle',\n\t\t'rowFieldChanged',\n\t],\n\tcomputed: {\n\t\tareAllRowsVisible()\n\t\t{\n\t\t\treturn this.$store.getters.areAllRowsVisible;\n\t\t},\n\t\tareNoRowsVisible()\n\t\t{\n\t\t\treturn this.$store.getters.areNoRowsVisible;\n\t\t},\n\t\tareSomeRowsVisible()\n\t\t{\n\t\t\treturn this.$store.getters.areSomeRowsVisible;\n\t\t},\n\t},\n\tmethods: {\n\t\tonRowCheckboxClicked(event)\n\t\t{\n\t\t\tthis.$emit('rowToggle', event);\n\t\t},\n\t\tonHeaderCheckboxClicked()\n\t\t{\n\t\t\tthis.$emit('headerToggle');\n\t\t},\n\t\tonRowFieldChanged(event)\n\t\t{\n\t\t\tthis.$emit('rowFieldChanged', event);\n\t\t},\n\t\tshowValidationErrors()\n\t\t{\n\t\t\tconst rowIndices = Object.keys(this.unvalidatedRows);\n\t\t\trowIndices.forEach((index) => {\n\t\t\t\tif (this.$refs.row[index])\n\t\t\t\t{\n\t\t\t\t\tthis.$refs.row[index].showValidationErrors();\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\t},\n\tcomponents: {\n\t\tTableHeader,\n\t\tTableRow,\n\t},\n\t// language=Vue\n\ttemplate: `\n\t\t<table class=\"format-table\">\n\t\t\t<thead>\n\t\t\t\t<TableHeader :enabled=\"areAllRowsVisible\" :indeterminate=\"areSomeRowsVisible\" @checkbox-click=\"onHeaderCheckboxClicked\" />\n\t\t\t</thead>\n\t\t\t<tbody>\n\t\t\t\t<template v-for=\"(field, index) in fieldsSettings\" :key=\"index\">\n\t\t\t\t\t<TableRow\n\t\t\t\t\t\tref=\"row\"\n\t\t\t\t\t\t:index=\"index\"\n\t\t\t\t\t\t:enabled=\"field.visible\"\n\t\t\t\t\t\t:field-settings=\"field\"\n\t\t\t\t\t\t@checkbox-click=\"onRowCheckboxClicked\"\n\t\t\t\t\t\t@field-change=\"onRowFieldChanged\"\n\t\t\t\t\t\t:invalid-fields=\"unvalidatedRows[index] ?? []\"\n\t\t\t\t\t\t:disabled-elements=\"disabledElements\"\n\t\t\t\t\t/>\n\t\t\t\t</template>\n\t\t\t</tbody>\n\t\t</table>\n\t`,\n};\n","import '../../css/fields-settings.css';\n\nexport const SyncFieldsButton = {\n\temits: ['buttonClick'],\n\tprops: {\n\t\tdisabled: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t},\n\tcomputed: {\n\t\tisDisabled(): boolean\n\t\t{\n\t\t\treturn this.disabled;\n\t\t},\n\t},\n\tmethods: {\n\t\tonButtonClick()\n\t\t{\n\t\t\tthis.$emit('buttonClick');\n\t\t},\n\t},\n\t// language=Vue\n\ttemplate: `\n\t\t<div class=\"ui-form-row\">\n\t\t\t<button :disabled=\"isDisabled\" class=\"ui-btn ui-btn-sm ui-btn-primary ui-btn-no-caps\" @click=\"onButtonClick\">\n\t\t\t\t{{ $Bitrix.Loc.getMessage('DATASET_IMPORT_SYNC_FIELDS_BUTTON') }}\n\t\t\t</button>\n\t\t</div>\n\t`,\n};\n","import { StepBlock } from '../layout/step-block';\nimport { BaseStep } from './base-step';\nimport { FormatTable } from './data-type/format-table';\nimport { SyncFieldsButton } from './data-type/sync-fields-button';\nimport '../css/fields-settings.css';\n\nexport const FieldsSettingsStep = {\n\temits: ['parsingOptionsChanged', 'settingsChanged', 'syncFields'],\n\textends: BaseStep,\n\tprops: {\n\t\tsyncFieldsProps: {\n\t\t\ttype: Object,\n\t\t\tdefault: {\n\t\t\t\tsupported: false,\n\t\t\t\tdisabled: true,\n\t\t\t},\n\t\t},\n\t},\n\tcomputed: {\n\t\tfieldsSettings()\n\t\t{\n\t\t\treturn this.$store.state.config.fieldsSettings;\n\t\t},\n\t\tdefaultTitle()\n\t\t{\n\t\t\treturn this.$Bitrix.Loc.getMessage('DATASET_IMPORT_FIELDS_SETTINGS_HEADER');\n\t\t},\n\t\tdefaultHint()\n\t\t{\n\t\t\tif (this.isEditMode)\n\t\t\t{\n\t\t\t\treturn this.$Bitrix.Loc.getMessage('DATASET_IMPORT_FIELDS_SETTINGS_HINT_EDIT')\n\t\t\t\t\t.replace('[link]', '<a onclick=\"top.BX.Helper.show(`redirect=detail&code=23378698`)\">')\n\t\t\t\t\t.replace('[/link]', '</a>')\n\t\t\t\t;\n\t\t\t}\n\n\t\t\treturn this.$Bitrix.Loc.getMessage('DATASET_IMPORT_FIELDS_SETTINGS_HINT')\n\t\t\t\t.replace('[link]', '<a onclick=\"top.BX.Helper.show(`redirect=detail&code=23378698`)\">')\n\t\t\t\t.replace('[/link]', '</a>')\n\t\t\t;\n\t\t},\n\t\tunvalidatedRows()\n\t\t{\n\t\t\tconst rows = {};\n\n\t\t\tthis.$store.state.config.fieldsSettings.forEach((field, index) => {\n\t\t\t\tconst invalidFields = {};\n\n\t\t\t\tif (!field.id)\n\t\t\t\t{\n\t\t\t\t\tconst nameValidationResult = this.validateName(field.name);\n\t\t\t\t\tif (!nameValidationResult.result)\n\t\t\t\t\t{\n\t\t\t\t\t\tinvalidFields.name = nameValidationResult;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (Object.keys(invalidFields).length > 0)\n\t\t\t\t{\n\t\t\t\t\trows[index] = invalidFields;\n\t\t\t\t}\n\t\t\t});\n\n\t\t\treturn rows;\n\t\t},\n\t\tisEditMode()\n\t\t{\n\t\t\treturn this.$store.getters.isEditMode;\n\t\t},\n\t\tisSyncSupported(): boolean\n\t\t{\n\t\t\treturn this.syncFieldsProps.supported;\n\t\t},\n\t\tisSyncDisabled(): boolean\n\t\t{\n\t\t\treturn this.syncFieldsProps.disabled;\n\t\t},\n\t},\n\tmethods: {\n\t\tvalidateName(name)\n\t\t{\n\t\t\tconst isNotEmpty = name.length > 0;\n\t\t\tif (!isNotEmpty)\n\t\t\t{\n\t\t\t\treturn {\n\t\t\t\t\tresult: false,\n\t\t\t\t\tmessage: this.$Bitrix.Loc.getMessage('DATASET_IMPORT_FIELD_VALIDATION_EMPTY_ERROR'),\n\t\t\t\t};\n\t\t\t}\n\n\t\t\tconst isTooLong = name.length > 32;\n\t\t\tif (isTooLong)\n\t\t\t{\n\t\t\t\treturn {\n\t\t\t\t\tresult: false,\n\t\t\t\t\tmessage: this.$Bitrix.Loc.getMessage('DATASET_IMPORT_FIELD_VALIDATION_FIELD_TOO_LONG'),\n\t\t\t\t};\n\t\t\t}\n\n\t\t\t// only numbers, uppercase letters and underscores; starts with a letter\n\t\t\tconst areCharactersValid = /^[A-Z](?=.*[A-Z_])[A-Z0-9_]*$/.test(name);\n\t\t\tif (!areCharactersValid)\n\t\t\t{\n\t\t\t\treturn {\n\t\t\t\t\tresult: false,\n\t\t\t\t\tmessage: this.$Bitrix.Loc.getMessage('DATASET_IMPORT_FIELD_VALIDATION_FIELD_INVALID_CHARS'),\n\t\t\t\t};\n\t\t\t}\n\n\t\t\tconst isAlreadyUsed = this.$store.getters.previewHeaders.reduce((\n\t\t\t\tcount,\n\t\t\t\tvalue,\n\t\t\t) => (name === value ? count + 1 : count), 0) > 1;\n\t\t\tif (isAlreadyUsed)\n\t\t\t{\n\t\t\t\treturn {\n\t\t\t\t\tresult: false,\n\t\t\t\t\tmessage: this.$Bitrix.Loc.getMessage('DATASET_IMPORT_FIELD_VALIDATION_FIELD_ALREADY_USED'),\n\t\t\t\t};\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\tresult: true,\n\t\t\t};\n\t\t},\n\t\tonRowToggled(event)\n\t\t{\n\t\t\tthis.$store.commit('toggleRowVisibility', event.index);\n\t\t\tthis.$emit('settingsChanged');\n\t\t},\n\t\tonHeaderToggled(event)\n\t\t{\n\t\t\tif (this.$store.getters.areAllRowsVisible)\n\t\t\t{\n\t\t\t\tthis.$store.commit('setAllRowsInvisible');\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.$store.commit('setAllRowsVisible');\n\t\t\t}\n\n\t\t\tthis.$emit('settingsChanged');\n\t\t},\n\t\tonRowFieldChanged(event)\n\t\t{\n\t\t\tthis.fieldsSettings[event.index][event.fieldName] = event.value;\n\t\t\tthis.$store.commit('setFieldRowSettings', {\n\t\t\t\tindex: event.index,\n\t\t\t\tsettings: this.fieldsSettings[event.index],\n\t\t\t});\n\n\t\t\tif (event.fieldName === 'type')\n\t\t\t{\n\t\t\t\tthis.$emit('parsingOptionsChanged');\n\t\t\t}\n\n\t\t\tthis.$emit('settingsChanged');\n\n\t\t\tthis.validate();\n\t\t},\n\t\tvalidate()\n\t\t{\n\t\t\tconst result = Object.keys(this.unvalidatedRows).length === 0;\n\n\t\t\tthis.$emit('validation', result);\n\n\t\t\treturn result;\n\t\t},\n\t\tshowValidationErrors()\n\t\t{\n\t\t\tthis.$refs.formatTable.showValidationErrors();\n\t\t},\n\t},\n\tcomponents: {\n\t\tStep: StepBlock,\n\t\tFormatTable,\n\t\tSyncFieldsButton,\n\t},\n\t// language=Vue\n\ttemplate: `\n\t\t<Step\n\t\t\t:title=\"displayedTitle\"\n\t\t\t:hint=\"displayedHint\"\n\t\t\t:is-open-initially=\"isOpenInitially\"\n\t\t\t:disabled=\"disabled\"\n\t\t\tref=\"stepBlock\"\n\t\t>\n\t\t\t<SyncFieldsButton v-if=\"isSyncSupported\" :disabled=\"isSyncDisabled\" @button-click=\"this.$emit('syncFields')\"/>\n\t\t\t<div class=\"ui-form-row fields-settings\">\n\t\t\t\t<FormatTable\n\t\t\t\t\t:fields-settings=\"fieldsSettings\"\n\t\t\t\t\t:disabled-elements=\"disabledElements\"\n\t\t\t\t\t@row-toggle=\"onRowToggled\"\n\t\t\t\t\t@header-toggle=\"onHeaderToggled\"\n\t\t\t\t\t@row-field-changed=\"onRowFieldChanged\"\n\t\t\t\t\t:unvalidated-rows=\"unvalidatedRows\"\n\t\t\t\t\tref=\"formatTable\"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t</Step>\n\t`,\n};\n","import { Dom, Event, Loc, Tag } from 'main.core';\nimport { Layout } from 'ui.sidepanel.layout';\nimport '../../css/format-selector.css';\nimport { DataType } from '../../types/data-types';\nimport type { DataFormatTemplate } from '../../types/data-types';\n\ntype DropdownControlOptions = {\n\ttitle: string,\n\tsubtitle: string,\n\toptions: Option[],\n\tfieldType: string,\n\tselected: string,\n};\n\nconst OptionType = {\n\tCUSTOM: 'custom',\n\tVALUE: 'value',\n};\n\ntype Option = {\n\ttitle: string,\n\ttype: OptionType.CUSTOM | OptionType.VALUE,\n\tvalue: string,\n};\n\nexport class FormatSelector\n{\n\tstatic openSlider(selected: Object, dataFormatTemplates: DataFormatTemplate, onClose: function)\n\t{\n\t\tBX.SidePanel.Instance.open('biconnector:import-field-formats', {\n\t\t\twidth: 584,\n\t\t\tcontentCallback: () => {\n\t\t\t\treturn Layout.createContent({\n\t\t\t\t\textensions: ['ui.forms', 'ui.layout-form', 'ui.alerts', 'biconnector.dataset-import'],\n\t\t\t\t\ttitle: Loc.getMessage('DATASET_IMPORT_FIELD_FORMAT_SELECTOR_TITLE'),\n\t\t\t\t\tcontent()\n\t\t\t\t\t{\n\t\t\t\t\t\treturn FormatSelector.#getContent(selected, dataFormatTemplates);\n\t\t\t\t\t},\n\t\t\t\t\tbuttons({ cancelButton, SaveButton })\n\t\t\t\t\t{\n\t\t\t\t\t\treturn [\n\t\t\t\t\t\t\tnew SaveButton({\n\t\t\t\t\t\t\t\tonclick: () => {\n\t\t\t\t\t\t\t\t\t// hack: using a singleton instance to store the form didn't work\n\t\t\t\t\t\t\t\t\tconst form = BX.SidePanel.Instance.getTopSlider().getContainer().querySelector('#formatSelectorForm');\n\t\t\t\t\t\t\t\t\tonClose(FormatSelector.#extractValues(form));\n\t\t\t\t\t\t\t\t\tBX.SidePanel.Instance.close();\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\tcancelButton,\n\t\t\t\t\t\t];\n\t\t\t\t\t},\n\t\t\t\t});\n\t\t\t},\n\t\t\tcacheable: false,\n\t\t});\n\t}\n\n\tstatic #extractValues(form): Object\n\t{\n\t\tconst formData = new FormData(form);\n\n\t\tconst result = Object.fromEntries(formData);\n\n\t\tconst customFieldsToExtract = ['date', 'datetime'];\n\n\t\tcustomFieldsToExtract.forEach((field) => {\n\t\t\tif (result[field] === 'custom')\n\t\t\t{\n\t\t\t\tresult[field] = result[`${field}CustomValue`];\n\t\t\t}\n\n\t\t\tdelete result[`${field}CustomValue`];\n\t\t});\n\n\t\treturn result;\n\t}\n\n\tstatic #getContent(selected: Object, dataFormatTemplates: DataFormatTemplate): HTMLElement\n\t{\n\t\tconst formRoot = Tag.render`\n\t\t\t<form class=\"ui-form\" id=\"formatSelectorForm\">\n\t\t\t</form>\n\t\t`;\n\n\t\tDom.append(FormatSelector.#getDropdownControl({\n\t\t\ttitle: Loc.getMessage('DATASET_IMPORT_FIELD_FORMAT_SELECTOR_DATE'),\n\t\t\tsubtitle: Loc.getMessage('DATASET_IMPORT_FIELD_FORMAT_SELECTOR_DATE_HINT'),\n\t\t\toptions: dataFormatTemplates[DataType.date],\n\t\t\tfieldType: DataType.date,\n\t\t\tselected: selected[DataType.date],\n\t\t}), formRoot);\n\n\t\tDom.append(FormatSelector.#getDropdownControl({\n\t\t\ttitle: Loc.getMessage('DATASET_IMPORT_FIELD_FORMAT_SELECTOR_DATETIME'),\n\t\t\tsubtitle: Loc.getMessage('DATASET_IMPORT_FIELD_FORMAT_SELECTOR_DATETIME_HINT'),\n\t\t\toptions: dataFormatTemplates[DataType.datetime],\n\t\t\tfieldType: DataType.datetime,\n\t\t\tselected: selected[DataType.datetime],\n\t\t}), formRoot);\n\n\t\tDom.append(FormatSelector.#getDropdownControl({\n\t\t\ttitle: Loc.getMessage('DATASET_IMPORT_FIELD_FORMAT_SELECTOR_MONEY'),\n\t\t\tsubtitle: Loc.getMessage('DATASET_IMPORT_FIELD_FORMAT_SELECTOR_MONEY_HINT'),\n\t\t\toptions: dataFormatTemplates[DataType.money],\n\t\t\tfieldType: DataType.money,\n\t\t\tselected: selected[DataType.money],\n\t\t}), formRoot);\n\n\t\tDom.append(FormatSelector.#getDropdownControl({\n\t\t\ttitle: Loc.getMessage('DATASET_IMPORT_FIELD_FORMAT_SELECTOR_DOUBLE'),\n\t\t\tsubtitle: Loc.getMessage('DATASET_IMPORT_FIELD_FORMAT_SELECTOR_DOUBLE_HINT'),\n\t\t\toptions: dataFormatTemplates[DataType.double],\n\t\t\tfieldType: DataType.double,\n\t\t\tselected: selected[DataType.double],\n\t\t}), formRoot);\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"format-selector\">\n\t\t\t\t<div class=\"ui-alert ui-alert-primary format-selector__hint\">\n\t\t\t\t\t<span class=\"ui-alert-message\">\n\t\t\t\t\t\t${Loc.getMessage('DATASET_IMPORT_FIELD_FORMAT_SELECTOR_HINT', {\n\t\t\t\t\t\t\t'[link]': '<a onclick=\"top.BX.Helper.show(`redirect=detail&code=23378698`)\">',\n\t\t\t\t\t\t\t'[/link]': '</a>',\n\t\t\t\t\t\t})}\n\t\t\t\t\t</span>\n\t\t\t\t</div>\n\t\t\t\t${formRoot}\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tstatic #getDropdownControl(options: DropdownControlOptions): HTMLElement\n\t{\n\t\tconst selectRoot = Tag.render`\n\t\t\t<select class=\"ui-ctl-element\" name=\"${options.fieldType}\">\n\t\t\t</select>\n\t\t`;\n\n\t\tlet isCustomSelected = true;\n\t\tlet customElement = null;\n\t\tlet customOptionInput = null;\n\n\t\toptions.options.forEach((option) => {\n\t\t\tlet optionElement = '';\n\n\t\t\tconst isSelected = option.value === options.selected;\n\t\t\tif (isSelected)\n\t\t\t{\n\t\t\t\tisCustomSelected = false;\n\t\t\t}\n\n\t\t\tif (option.type === OptionType.VALUE)\n\t\t\t{\n\t\t\t\toptionElement = Tag.render`\n\t\t\t\t\t<option ${option.value === options.selected ? 'selected' : ''} value=\"${option.value}\">${option.title}</option>\n\t\t\t\t`;\n\t\t\t}\n\t\t\telse if (option.type === OptionType.CUSTOM)\n\t\t\t{\n\t\t\t\tcustomElement = Tag.render`\n\t\t\t\t\t<option value=\"custom\">${Loc.getMessage('DATASET_IMPORT_FIELD_FORMAT_SELECTOR_CUSTOM_FORMAT')}</option>\n\t\t\t\t`;\n\t\t\t\toptionElement = customElement;\n\n\t\t\t\tcustomOptionInput = Tag.render`\n\t\t\t\t\t<div class=\"ui-ctl ui-ctl-textbox ui-ctl-w100 format-selector__custom-value-input format-selector__custom-value-input--hidden\">\n\t\t\t\t\t\t<input class=\"ui-ctl-element\" name=\"${options.fieldType}CustomValue\" type=\"text\" placeholder=\"...\" value=\"${option.value ?? ''}\">\n\t\t\t\t\t</div>\n\t\t\t\t`;\n\n\t\t\t\tEvent.bind(selectRoot, 'change', (event) => {\n\t\t\t\t\tconst value = event.target.value;\n\t\t\t\t\tif (value === 'custom')\n\t\t\t\t\t{\n\t\t\t\t\t\tDom.removeClass(customOptionInput, 'format-selector__custom-value-input--hidden');\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tDom.addClass(customOptionInput, 'format-selector__custom-value-input--hidden');\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tDom.append(optionElement, selectRoot);\n\t\t});\n\n\t\tif (isCustomSelected)\n\t\t{\n\t\t\tif (customElement)\n\t\t\t{\n\t\t\t\tcustomElement.setAttribute('selected', true);\n\t\t\t}\n\n\t\t\tif (customOptionInput)\n\t\t\t{\n\t\t\t\tcustomOptionInput.querySelector('input').value = options.selected;\n\t\t\t\tDom.removeClass(customOptionInput, 'format-selector__custom-value-input--hidden');\n\t\t\t}\n\t\t}\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"ui-form-row\">\n\t\t\t\t<div class=\"ui-form-label\">\n\t\t\t\t\t<div class=\"ui-ctl-label-text\">\n\t\t\t\t\t\t${options.title}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"format-selector__type-subtitle\">\n\t\t\t\t\t\t${options.subtitle}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"ui-ctl ui-ctl-after-icon ui-ctl-dropdown ui-ctl-w100\">\n\t\t\t\t\t<div class=\"ui-ctl-after ui-ctl-icon-angle\"></div>\n\t\t\t\t\t${selectRoot}\n\t\t\t\t</div>\n\t\t\t\t${customOptionInput}\n\t\t\t</div>\n\t\t`;\n\t}\n}\n","import '../../css/fields-settings.css';\nimport 'ui.icon-set.crm';\n\nexport const SliderButton = {\n\t// language=Vue\n\ttemplate: `\n\t\t<div class=\"ui-form-row\">\n\t\t\t<div class=\"ui-ctl ui-ctl-before-icon ui-ctl-after-icon ui-ctl-w100 fields-settings__slider-button\">\n\t\t\t\t<div class=\"ui-ctl-before\">\n\t\t\t\t\t<div class=\"ui-icon-set --form-settings fields-settings__slider-icon\"></div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"ui-ctl-after ui-ctl-icon-angle fields-settings__slider-chevron\">\n\t\t\t\t</div>\n\t\t\t\t<div class=\"ui-ctl-element\">\n\t\t\t\t\t{{ this.$Bitrix.Loc.getMessage('DATASET_IMPORT_FIELD_SETTINGS_FORMAT_BUTTON') }}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import { BaseField } from './base-field';\nimport { Switcher, SwitcherSize } from 'ui.switcher';\nimport '../../css/switcher-field.css';\n\nexport const SwitcherField = {\n\textends: BaseField,\n\tmounted()\n\t{\n\t\tnew Switcher({\n\t\t\tnode: this.$refs.switcher,\n\t\t\tsize: SwitcherSize.small,\n\t\t\tchecked: this.defaultValue,\n\t\t\thandlers: {\n\t\t\t\ttoggled: () => {\n\t\t\t\t\tthis.value = !this.value;\n\t\t\t\t\tthis.onInputChange(this.value);\n\t\t\t\t},\n\t\t\t},\n\t\t});\n\t},\n\t// language=Vue\n\ttemplate: `\n\t\t<div class=\"ui-form-row\">\n\t\t\t<div class=\"switcher-field\">\n\t\t\t\t<div ref=\"switcher\"></div>\n\t\t\t\t<div class=\"switcher-field__label\">\n\t\t\t\t\t<span>{{ title }}</span>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import { BaseField } from './base-field';\n\nexport const CustomField = {\n\textends: BaseField,\n\t// language=Vue\n\ttemplate: `\n\t\t<div class=\"ui-form-row\">\n\t\t\t<div class=\"ui-form-label\">\n\t\t\t\t<div class=\"ui-ctl-label-text\">{{ title }}</div>\n\t\t\t</div>\n\t\t\t<div class=\"ui-ctl ui-ctl-w100\">\n\t\t\t\t<slot name=\"field-content\"></slot>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import { BaseField } from './base-field';\n\nexport const DropdownField = {\n\textends: BaseField,\n\tprops: {\n\t\toptions: {\n\t\t\ttype: Array,\n\t\t\trequired: true,\n\t\t},\n\t},\n\t// language=Vue\n\ttemplate: `\n\t\t<div class=\"ui-form-row\">\n\t\t\t<div class=\"ui-form-label\">\n\t\t\t\t<div class=\"ui-ctl-label-text\">{{ title }}</div>\n\t\t\t</div>\n\t\t\t<div class=\"ui-ctl ui-ctl-after-icon ui-ctl-dropdown ui-ctl-w100\">\n\t\t\t\t<div class=\"ui-ctl-after ui-ctl-icon-angle\"></div>\n\t\t\t\t<select class=\"ui-ctl-element\" v-model=\"value\" @change=\"onInputChange($event.target.value)\">\n\t\t\t\t\t<option v-for=\"option in options\" :value=\"option.value\" :selected=\"option.value === defaultValue\">{{ option.title }}</option>\n\t\t\t\t</select>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import { FormatSelector } from '../../steps/data-type/format-selector';\nimport { SliderButton } from '../../steps/data-type/slider-button';\nimport type { FieldValueChangeEvent } from '../../types/field-value-change-event';\nimport { SwitcherField } from '../type/switcher-field';\nimport { StackWidgetComponent as FileUploadWidget } from 'ui.uploader.stack-widget';\nimport { CustomField } from '../type/custom-field';\nimport { DropdownField } from '../type/dropdown-field';\nimport '../../css/dataset-file-upload.css';\n\nexport const FileUploader = {\n\tcomponents: {\n\t\tFileUploadWidget,\n\t\tCustomField,\n\t\tDropdownField,\n\t\tSwitcherField,\n\t\tSliderButton,\n\t},\n\tprops: {\n\t\tdefaultEncoding: {\n\t\t\ttype: String,\n\t\t\trequired: false,\n\t\t\tdefault: '',\n\t\t},\n\t\tdefaultSeparator: {\n\t\t\ttype: String,\n\t\t\trequired: false,\n\t\t\tdefault: '',\n\t\t},\n\t\tdefaultFirstLineHeader: {\n\t\t\ttype: Boolean,\n\t\t\trequired: false,\n\t\t\tdefault: true,\n\t\t},\n\t\tencodings: {\n\t\t\ttype: Array,\n\t\t\trequired: true,\n\t\t},\n\t\tseparators: {\n\t\t\ttype: Array,\n\t\t\trequired: true,\n\t\t},\n\t\tisEditMode: {\n\t\t\ttype: Boolean,\n\t\t\trequired: false,\n\t\t\tdefault: false,\n\t\t},\n\t\tunvalidatedFields: {\n\t\t\ttype: Object,\n\t\t\trequired: false,\n\t\t\tdefault: {},\n\t\t},\n\t\tdataFormatTemplates: {\n\t\t\ttype: Object,\n\t\t},\n\t},\n\tdata()\n\t{\n\t\treturn {\n\t\t\tinputElement: null,\n\t\t\tareValidationErrorsShown: false,\n\t\t};\n\t},\n\temits: [\n\t\t'valueChange',\n\t\t'uploadError',\n\t\t'parsingOptionsChanged',\n\t],\n\tcomputed: {\n\t\tuploaderOptions()\n\t\t{\n\t\t\treturn {\n\t\t\t\tcontroller: 'biconnector.integration.ui.fileUploaderController.datasetUploaderController',\n\t\t\t\tcontrollerOptions: {},\n\t\t\t\tmultiple: false,\n\t\t\t\tacceptOnlyImages: false,\n\t\t\t\tmaxFileSize: 1024 * 1024 * 60,\n\t\t\t\tautoUpload: true,\n\t\t\t\tacceptedFileTypes: ['.csv'],\n\t\t\t\tevents: {\n\t\t\t\t\tonUploadComplete: () => {\n\t\t\t\t\t\tthis.onUploadComplete();\n\t\t\t\t\t},\n\t\t\t\t\t'File:onRemove': () => {\n\t\t\t\t\t\tthis.onFileRemoved();\n\t\t\t\t\t},\n\t\t\t\t\tonError: () => {\n\t\t\t\t\t\tthis.onUploadError();\n\t\t\t\t\t},\n\t\t\t\t\t'File:onError': () => {\n\t\t\t\t\t\tthis.onUploadError();\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t};\n\t\t},\n\t\twidgetOptions()\n\t\t{\n\t\t\treturn {\n\t\t\t\tsize: 'large',\n\t\t\t};\n\t\t},\n\t},\n\tmethods: {\n\t\tonValueChange(event: FieldValueChangeEvent)\n\t\t{\n\t\t\tthis.$emit('valueChange', event);\n\t\t},\n\t\tonUploadComplete()\n\t\t{\n\t\t\tconst file = this.$refs.uploader.uploader.getFiles()[0];\n\t\t\tif (file && file.isComplete())\n\t\t\t{\n\t\t\t\tthis.areValidationErrorsShown = false;\n\t\t\t\tthis.$emit('valueChange', {\n\t\t\t\t\tnewValue: file.getServerFileId(),\n\t\t\t\t\tfieldName: 'fileToken',\n\t\t\t\t});\n\t\t\t\tthis.$emit('valueChange', {\n\t\t\t\t\tnewValue: file.getName(),\n\t\t\t\t\tfieldName: 'fileName',\n\t\t\t\t});\n\t\t\t}\n\t\t},\n\t\tonFileRemoved()\n\t\t{\n\t\t\tthis.$emit('valueChange', {\n\t\t\t\tnewValue: null,\n\t\t\t\tfieldName: 'fileToken',\n\t\t\t});\n\t\t},\n\t\tonUploadError()\n\t\t{\n\t\t\tthis.$emit('uploadError');\n\t\t},\n\t\tshowValidationErrors()\n\t\t{\n\t\t\tthis.areValidationErrorsShown = true;\n\t\t},\n\t\topenDataFormatSlider()\n\t\t{\n\t\t\tFormatSelector.openSlider(this.$store.state.config.dataFormats, this.dataFormatTemplates, (selectedFormats) => {\n\t\t\t\tthis.$store.commit('setDataFormats', selectedFormats);\n\t\t\t\tthis.$emit('parsingOptionsChanged');\n\t\t\t});\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"ui-form\">\n\t\t\t<CustomField :title=\"$Bitrix.Loc.getMessage('DATASET_IMPORT_FILE_FIELD')\" name=\"file\">\n\t\t\t\t<template #field-content>\n\t\t\t\t\t<div class=\"dataset-file-upload\">\n\t\t\t\t\t\t<FileUploadWidget\n\t\t\t\t\t\t\t:uploaderOptions=\"uploaderOptions\"\n\t\t\t\t\t\t\t:widgetOptions=\"widgetOptions\"\n\t\t\t\t\t\t\tref=\"uploader\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<p class=\"dataset-import-field__error-text\" v-if=\"areValidationErrorsShown && !unvalidatedFields.file?.result\">\n\t\t\t\t\t\t\t{{ unvalidatedFields.file?.message }}\n\t\t\t\t\t\t</p>\n\t\t\t\t\t</div>\n\t\t\t\t</template>\n\t\t\t</CustomField>\n\t\t\t<div class=\"ui-form-row-inline\">\n\t\t\t\t<DropdownField\n\t\t\t\t\t:title=\"$Bitrix.Loc.getMessage('DATASET_IMPORT_FILE_ENCODING')\"\n\t\t\t\t\tname=\"encoding\"\n\t\t\t\t\t:options=\"encodings\"\n\t\t\t\t\t:default-value=\"defaultEncoding\"\n\t\t\t\t\t@value-change=\"onValueChange\"\n\t\t\t\t/>\n\t\t\t\t<DropdownField\n\t\t\t\t\t:title=\"$Bitrix.Loc.getMessage('DATASET_IMPORT_FILE_SEPARATOR')\"\n\t\t\t\t\tname=\"separator\"\n\t\t\t\t\t:options=\"separators\"\n\t\t\t\t\t:default-value=\"defaultSeparator\"\n\t\t\t\t\t@value-change=\"onValueChange\"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t\t<SliderButton @click=\"openDataFormatSlider\" />\n\t\t\t<SwitcherField\n\t\t\t\t:title=\"$Bitrix.Loc.getMessage('DATASET_IMPORT_FILE_FIRST_ROW_HEADER')\"\n\t\t\t\tname=\"firstLineHeader\"\n\t\t\t\t:default-value=\"defaultFirstLineHeader\"\n\t\t\t\t@value-change=\"onValueChange\"\n\t\t\t/>\n\t\t</div>\n\t`,\n};\n","import { FileUploader } from '../fields/file/file-uploader';\nimport type { FieldValueChangeEvent } from '../types/field-value-change-event';\nimport { BaseStep } from './base-step';\nimport { StepBlock } from '../layout/step-block';\n\nexport const FileStep = {\n\textends: BaseStep,\n\tprops: {\n\t\tencodings: {\n\t\t\ttype: Array,\n\t\t\trequired: true,\n\t\t},\n\t\tseparators: {\n\t\t\ttype: Array,\n\t\t\trequired: true,\n\t\t},\n\t\tdataFormatTemplates: {\n\t\t\ttype: Object,\n\t\t},\n\t},\n\tdata()\n\t{\n\t\treturn {\n\t\t\tfileProperties: this.$store.state.config.fileProperties,\n\t\t\tisErrorDisplayed: false,\n\t\t};\n\t},\n\temits: [\n\t\t'filePropertiesChange',\n\t\t'parsingOptionsChanged',\n\t],\n\tcomputed: {\n\t\tdefaultTitle()\n\t\t{\n\t\t\treturn this.$Bitrix.Loc.getMessage('DATASET_IMPORT_FILE_HEADER');\n\t\t},\n\t\tdefaultHint()\n\t\t{\n\t\t\tif (this.isErrorDisplayed)\n\t\t\t{\n\t\t\t\treturn this.$Bitrix.Loc.getMessage('DATASET_IMPORT_FILE_HINT_ERROR');\n\t\t\t}\n\n\t\t\tif (this.isEditMode)\n\t\t\t{\n\t\t\t\treturn this.$Bitrix.Loc.getMessage('DATASET_IMPORT_FILE_HINT_EDIT')\n\t\t\t\t\t.replace('[link]', '<a onclick=\"top.BX.Helper.show(`redirect=detail&code=23378680`)\">')\n\t\t\t\t\t.replace('[/link]', '</a>')\n\t\t\t\t;\n\t\t\t}\n\n\t\t\treturn this.$Bitrix.Loc.getMessage('DATASET_IMPORT_FILE_HINT')\n\t\t\t\t.replace('[link]', '<a onclick=\"top.BX.Helper.show(`redirect=detail&code=23378680`)\">')\n\t\t\t\t.replace('[/link]', '</a>')\n\t\t\t;\n\t\t},\n\t\thintClass()\n\t\t{\n\t\t\treturn this.isErrorDisplayed ? 'ui-alert-danger' : 'ui-alert-primary';\n\t\t},\n\t\tisEditMode()\n\t\t{\n\t\t\treturn this.$store.getters.isEditMode;\n\t\t},\n\t\tunvalidatedFields()\n\t\t{\n\t\t\tconst result = {};\n\n\t\t\tconst fileValidationResult = this.validateFile();\n\t\t\tif (!fileValidationResult.result)\n\t\t\t{\n\t\t\t\tresult.file = fileValidationResult;\n\t\t\t}\n\n\t\t\treturn result;\n\t\t},\n\t},\n\tmethods: {\n\t\tonFilePropertiesChange(event: FieldValueChangeEvent)\n\t\t{\n\t\t\tif (event.fieldName === 'fileToken')\n\t\t\t{\n\t\t\t\tthis.isErrorDisplayed = false;\n\t\t\t}\n\n\t\t\tthis.fileProperties[event.fieldName] = event.newValue;\n\t\t\tthis.$store.commit('setFileProperties', this.fileProperties);\n\t\t\tif (event.fieldName !== 'fileName')\n\t\t\t{\n\t\t\t\tthis.$emit('filePropertiesChange');\n\t\t\t}\n\t\t\tthis.validate();\n\t\t},\n\t\tonUploadError()\n\t\t{\n\t\t\tthis.isErrorDisplayed = true;\n\t\t},\n\t\tonParsingOptionsChanged()\n\t\t{\n\t\t\tthis.$emit('parsingOptionsChanged');\n\t\t},\n\t\tvalidate()\n\t\t{\n\t\t\tlet result = true;\n\t\t\tif (!this.isEditMode)\n\t\t\t{\n\t\t\t\tresult = Object.keys(this.unvalidatedFields).length === 0;\n\t\t\t}\n\n\t\t\tthis.$emit('validation', result);\n\n\t\t\treturn result;\n\t\t},\n\t\tvalidateFile()\n\t\t{\n\t\t\tif (!this.isEditMode && !this.$store.state.config.fileProperties.fileToken)\n\t\t\t{\n\t\t\t\treturn {\n\t\t\t\t\tresult: false,\n\t\t\t\t\tmessage: this.$Bitrix.Loc.getMessage('DATASET_IMPORT_FILE_NOT_SELECTED'),\n\t\t\t\t};\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\tresult: true,\n\t\t\t};\n\t\t},\n\t\tshowValidationErrors()\n\t\t{\n\t\t\tthis.$refs.fileUploader.showValidationErrors();\n\t\t},\n\t},\n\tcomponents: {\n\t\tStep: StepBlock,\n\t\tFileUploader,\n\t},\n\ttemplate: `\n\t\t<Step\n\t\t\t:title=\"displayedTitle\"\n\t\t\t:hint=\"displayedHint\"\n\t\t\t:is-open-initially=\"isOpenInitially\"\n\t\t\t:disabled=\"disabled\"\n\t\t\t:hint-class=\"hintClass\"\n\t\t\tref=\"stepBlock\"\n\t\t>\n\t\t\t<FileUploader\n\t\t\t\t@value-change=\"onFilePropertiesChange\"\n\t\t\t\t@upload-error=\"onUploadError\"\n\t\t\t\t@parsing-options-changed=\"onParsingOptionsChanged\"\n\t\t\t\tref=\"fileUploader\"\n\t\t\t\t:encodings=\"encodings\"\n\t\t\t\t:separators=\"separators\"\n\t\t\t\t:default-encoding=\"fileProperties.encoding\"\n\t\t\t\t:default-first-line-header=\"fileProperties.firstLineHeader\"\n\t\t\t\t:default-separator=\"fileProperties.separator\"\n\t\t\t\t:is-edit-mode=\"isEditMode\"\n\t\t\t\t:unvalidated-fields=\"unvalidatedFields\"\n\t\t\t\t:data-format-templates=\"dataFormatTemplates\"\n\t\t\t/>\n\t\t</Step>\n\t`,\n};\n","import { StepBlock } from './step-block';\n\nexport const AppSection = {\n\tprops: {\n\t\ttitle: {\n\t\t\ttype: String,\n\t\t\trequired: false,\n\t\t},\n\t\tcustomClasses: {\n\t\t\ttype: Array,\n\t\t\trequired: false,\n\t\t},\n\t},\n\tcomponents: {\n\t\tStep: StepBlock,\n\t},\n\t// language=Vue\n\ttemplate: `\n\t\t<Step\n\t\t\t:title=\"title\"\n\t\t\t:can-collapse=\"false\"\n\t\t\t:custom-classes=\"customClasses\"\n\t\t>\n\t\t\t<slot></slot>\n\t\t</Step>\n\t`,\n};\n","import '../../css/dataset-preview-table.css';\n\nexport const TableHeader = {\n\tprops: {\n\t\theaders: {\n\t\t\ttype: Array,\n\t\t\trequired: false,\n\t\t\tdefault: [],\n\t\t},\n\t\tcolumnVisibility: {\n\t\t\ttype: Array,\n\t\t\trequired: false,\n\t\t\tdefault: [],\n\t\t},\n\t},\n\tcomputed: {\n\t\tvisibleHeaders()\n\t\t{\n\t\t\treturn this.headers.filter((_, index) => this.columnVisibility[index]);\n\t\t},\n\t},\n\t// language=Vue\n\ttemplate: `\n\t\t<thead>\n\t\t\t<tr class=\"dataset-preview-table__header-row\">\n\t\t\t\t<th class=\"dataset-preview-table__header\" v-for=\"header in visibleHeaders\" :title=\"header\">{{ header }}</th>\n\t\t\t</tr>\n\t\t</thead>\n\t`,\n};\n","import '../../css/dataset-preview-table.css';\n\nexport const TableRow = {\n\tprops: {\n\t\trow: {\n\t\t\ttype: Array,\n\t\t\trequired: true,\n\t\t},\n\t\tcolumnVisibility: {\n\t\t\ttype: Array,\n\t\t\trequired: false,\n\t\t\tdefault: [],\n\t\t},\n\t},\n\tcomputed: {\n\t\tvisibleValues()\n\t\t{\n\t\t\treturn this.row.filter((_, index) => this.columnVisibility[index]);\n\t\t},\n\t},\n\t// language=Vue\n\ttemplate: `\n\t\t<tr>\n\t\t\t<td class=\"dataset-preview-table__cell\" v-for=\"value in visibleValues\" :title=\"value\">{{ value }}</td>\n\t\t</tr>\n\t`,\n};\n","import '../../css/dataset-preview-table.css';\nimport { Ears } from 'ui.ears';\nimport { TableHeader } from './table-header';\nimport { TableRow } from './table-row';\nimport { Dom, debounce } from 'main.core';\n\nexport const PreviewTable = {\n\tprops: {\n\t\theaders: {\n\t\t\ttype: Array,\n\t\t\trequired: false,\n\t\t\tdefault: [],\n\t\t},\n\t\trows: {\n\t\t\ttype: Array,\n\t\t\trequired: false,\n\t\t\tdefault: [],\n\t\t},\n\t\tcolumnVisibility: {\n\t\t\ttype: Array,\n\t\t\trequired: false,\n\t\t\tdefault: [],\n\t\t},\n\t},\n\tdata()\n\t{\n\t\treturn {\n\t\t\tdisplayedColumnVisibility: this.columnVisibility,\n\t\t\tdebouncedRefresh: debounce(this.refreshColumns, 1000),\n\t\t};\n\t},\n\tmounted()\n\t{\n\t\tconst ears = new Ears({\n\t\t\tcontainer: document.querySelector('.dataset-preview-table'),\n\t\t\tsmallSize: true,\n\t\t\tnoScrollbar: false,\n\t\t});\n\n\t\tears.init();\n\t},\n\tmethods: {\n\t\trefreshColumns(newVisibility)\n\t\t{\n\t\t\tthis.displayedColumnVisibility = newVisibility;\n\t\t\tDom.removeClass(this.$refs.table, 'dataset-preview-table--fade');\n\t\t},\n\t},\n\twatch: {\n\t\tcolumnVisibility(newValue, oldValue)\n\t\t{\n\t\t\tDom.addClass(this.$refs.table, 'dataset-preview-table--fade');\n\t\t\tthis.debouncedRefresh(newValue);\n\t\t},\n\t},\n\tcomponents: {\n\t\tTableHeader,\n\t\tTableRow,\n\t},\n\t// language=Vue\n\ttemplate: `\n\t\t<div class=\"dataset-preview-table\" ref=\"table\">\n\t\t\t<table class=\"dataset-preview-table__table\">\n\t\t\t\t<TableHeader v-if=\"headers.length > 0\" :headers=\"headers\" :column-visibility=\"displayedColumnVisibility\" />\n\t\t\t\t<tbody>\n\t\t\t\t\t<TableRow v-for=\"row in rows\" :row=\"row\" :column-visibility=\"displayedColumnVisibility\" />\n\t\t\t\t</tbody>\n\t\t\t</table>\n\t\t</div>\n\t`,\n};\n","import { Loader } from 'main.loader';\nimport { AppSection } from '../layout/app-section';\nimport '../css/import-preview.css';\nimport { PreviewTable } from './import-preview/preview-table';\n\nexport const ImportPreview = {\n\tcomponents: {\n\t\tAppSection,\n\t\tPreviewTable,\n\t},\n\tprops: {\n\t\temptyStateText: {\n\t\t\ttype: String,\n\t\t\trequired: false,\n\t\t\tdefault: null,\n\t\t},\n\t\terror: {\n\t\t\ttype: String,\n\t\t\trequired: false,\n\t\t\tdefault: '',\n\t\t},\n\t\tisLoading: {\n\t\t\ttype: Boolean,\n\t\t\trequired: false,\n\t\t\tdefault: false,\n\t\t},\n\t\tneedShowHeadersWithEmptyRows: {\n\t\t\ttype: Boolean,\n\t\t\trequired: false,\n\t\t\tdefault: false,\n\t\t},\n\t},\n\tcomputed: {\n\t\tisEditMode(): boolean\n\t\t{\n\t\t\treturn this.$store.getters.isEditMode;\n\t\t},\n\t\theaders()\n\t\t{\n\t\t\treturn this.$store.getters.previewHeaders;\n\t\t},\n\t\trows()\n\t\t{\n\t\t\treturn this.$store.state.previewData.rows;\n\t\t},\n\t\tisEverythingHidden()\n\t\t{\n\t\t\treturn this.headers.length > 0 && this.$store.getters.areNoRowsVisible;\n\t\t},\n\t\thasData()\n\t\t{\n\t\t\treturn this.$store.getters.hasData;\n\t\t},\n\t\thasHeaders(): boolean\n\t\t{\n\t\t\treturn this.headers.length > 0;\n\t\t},\n\t\tdisplayedEmptyStateText()\n\t\t{\n\t\t\treturn this.emptyStateText ?? this.$Bitrix.Loc.getMessage('DATASET_IMPORT_PREVIEW_EMPTY_STATE');\n\t\t},\n\t\tdisplayedEverythingHiddenText()\n\t\t{\n\t\t\treturn this.$Bitrix.Loc.getMessage('DATASET_IMPORT_PREVIEW_EVERYTHING_HIDDEN');\n\t\t},\n\t\tcolumnVisibility()\n\t\t{\n\t\t\treturn this.$store.getters.columnVisibilityMap;\n\t\t},\n\t\tisErrorInEditMode()\n\t\t{\n\t\t\treturn this.hasData && this.error && this.isEditMode;\n\t\t},\n\t\tisEditModeInitialDataDisplayed()\n\t\t{\n\t\t\treturn this.isEditMode && !this.$store.state.config.fileProperties.fileToken;\n\t\t},\n\t\tdisplayedTitle()\n\t\t{\n\t\t\treturn this.isEditModeInitialDataDisplayed\n\t\t\t\t? this.$Bitrix.Loc.getMessage('DATASET_IMPORT_INITIAL_DATA_PREVIEW_TITLE')\n\t\t\t\t: this.$Bitrix.Loc.getMessage('DATASET_IMPORT_PREVIEW_TITLE')\n\t\t\t;\n\t\t},\n\t\thasDataDisplayedHint()\n\t\t{\n\t\t\treturn this.isEditModeInitialDataDisplayed\n\t\t\t\t? this.$Bitrix.Loc.getMessage('DATASET_IMPORT_INITIAL_DATA_PREVIEW_HINT')\n\t\t\t\t: this.$Bitrix.Loc.getMessage('DATASET_IMPORT_PREVIEW_HINT')\n\t\t\t;\n\t\t},\n\t},\n\twatch: {\n\t\tisLoading(newValue)\n\t\t{\n\t\t\tif (this.loader)\n\t\t\t{\n\t\t\t\tthis.loader.destroy();\n\t\t\t}\n\n\t\t\tif (newValue)\n\t\t\t{\n\t\t\t\tthis.loader = new Loader({\n\t\t\t\t\ttarget: this.$refs.loadingAnchor,\n\t\t\t\t\tsize: 77,\n\t\t\t\t\tcolor: 'var(--ui-color-primary)',\n\t\t\t\t\tstrokeWidth: 4,\n\t\t\t\t});\n\t\t\t\tthis.loader.show();\n\t\t\t}\n\t\t},\n\t},\n\t// language=Vue\n\ttemplate: `\n\t\t<AppSection\n\t\t\t:title=\"displayedTitle\"\n\t\t\t:custom-classes=\"['dataset-import-step--full-height', 'dataset-import-step--sticky', 'import-preview']\"\n\t\t>\n\t\t\t<div class=\"import-preview__loading\" ref=\"loadingAnchor\"></div>\n\t\t\t<template v-if=\"!isLoading\">\n\t\t\t\t<template v-if=\"error\">\n\t\t\t\t\t<div class=\"import-preview__no-data\" v-if=\"isEverythingHidden\">\n\t\t\t\t\t\t<div class=\"import-preview__no-data-logo\"></div>\n\t\t\t\t\t\t<p class=\"import-preview__no-data-text\">{{ displayedEverythingHiddenText }}</p>\n\t\t\t\t\t</div>\n\t\t\t\t\t<template v-else>\n\t\t\t\t\t\t<div class=\"import-preview__has-data import-preview__has-data--edit-mode-error\" v-if=\"isEditMode\">\n\t\t\t\t\t\t\t<span class=\"import-preview__hint\">{{ $Bitrix.Loc.getMessage('DATASET_IMPORT_PREVIEW_HINT') }}</span>\n\t\t\t\t\t\t\t<PreviewTable\n\t\t\t\t\t\t\t\t:headers=\"headers\"\n\t\t\t\t\t\t\t\t:column-visibility=\"columnVisibility\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t<div class=\"import-preview__edit-mode-error\">\n\t\t\t\t\t\t\t\t<div class=\"import-preview__error-logo\"></div>\n\t\t\t\t\t\t\t\t<p class=\"import-preview__no-data-text\">{{ error }}</p>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"import-preview__has-data\" v-else>\n\t\t\t\t\t\t\t<PreviewTable\n\t\t\t\t\t\t\t\t:headers=\"headers\"\n\t\t\t\t\t\t\t\t:column-visibility=\"columnVisibility\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t<div class=\"import-preview__edit-mode-error\">\n\t\t\t\t\t\t\t\t<div class=\"import-preview__error-logo\"></div>\n\t\t\t\t\t\t\t\t<p class=\"import-preview__no-data-text\">{{ error }}</p>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</template>\n\t\t\t\t</template>\n\t\t\t\t<template v-else>\n\t\t\t\t\t<div class=\"import-preview__no-data\" v-if=\"isEverythingHidden\">\n\t\t\t\t\t\t<div class=\"import-preview__no-data-logo\"></div>\n\t\t\t\t\t\t<p class=\"import-preview__no-data-text\">{{ displayedEverythingHiddenText }}</p>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"import-preview__has-data\" v-else-if=\"hasData\">\n\t\t\t\t\t\t<span class=\"import-preview__hint\">{{ hasDataDisplayedHint }}</span>\n\t\t\t\t\t\t<PreviewTable\n\t\t\t\t\t\t\t:headers=\"headers\"\n\t\t\t\t\t\t\t:rows=\"rows\"\n\t\t\t\t\t\t\t:column-visibility=\"columnVisibility\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"import-preview__has-data\" v-else-if=\"hasHeaders && needShowHeadersWithEmptyRows\">\n\t\t\t\t\t\t<PreviewTable\n\t\t\t\t\t\t\t:headers=\"headers\"\n\t\t\t\t\t\t\t:column-visibility=\"columnVisibility\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<div class=\"import-preview__edit-mode-error\">\n\t\t\t\t\t\t\t<div class=\"import-preview__no-data-logo\"></div>\n\t\t\t\t\t\t\t<p class=\"import-preview__no-data-text\">{{ displayedEmptyStateText }}</p>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"import-preview__no-data\" v-else>\n\t\t\t\t\t\t<div class=\"import-preview__no-data-logo\"></div>\n\t\t\t\t\t\t<p class=\"import-preview__no-data-text\">{{ displayedEmptyStateText }}</p>\n\t\t\t\t\t</div>\n\t\t\t\t</template>\n\t\t\t</template>\n\t\t</AppSection>\n\t`,\n};\n","import { ajax as Ajax, Tag, Type } from 'main.core';\nimport { Popup as MainPopup, PopupManager } from 'main.popup';\nimport type { AnalyticsOptions } from 'ui.analytics';\nimport { sendData } from 'ui.analytics';\nimport { SidePanel } from 'ui.sidepanel';\nimport { Button, ButtonColor } from 'ui.buttons';\n\n// language=Vue\nexport const BaseApp = {\n\tprops: {\n\t\tappParams: {\n\t\t\ttype: Object,\n\t\t\trequired: false,\n\t\t\tdefault: {},\n\t\t},\n\t},\n\tdata()\n\t{\n\t\treturn {\n\t\t\tsteps: {},\n\t\t\tshownPopups: {},\n\t\t\tisChanged: false,\n\t\t\tisSaveComplete: false,\n\t\t\tlastChangedStep: null,\n\t\t};\n\t},\n\tcomputed: {\n\t\tsourceCode()\n\t\t{\n\t\t\treturn '';\n\t\t},\n\t\tloadParams()\n\t\t{\n\t\t\treturn {};\n\t\t},\n\t\tsaveParams()\n\t\t{\n\t\t\treturn {};\n\t\t},\n\t\tisEditMode()\n\t\t{\n\t\t\treturn false;\n\t\t},\n\t\tdatasetId()\n\t\t{\n\t\t\treturn this.$store.state.config.datasetProperties.id;\n\t\t},\n\t\tisSaveEnabled(): boolean\n\t\t{\n\t\t\treturn !(this.$store.getters.areNoRowsVisible) && this.isValidatedForSave && !this.previewError;\n\t\t},\n\t\tisValidatedForSave(): boolean\n\t\t{\n\t\t\treturn true;\n\t\t},\n\t\tunsavedChangesPopupTitle(): string\n\t\t{\n\t\t\treturn this.isEditMode\n\t\t\t\t? this.$Bitrix.Loc.getMessage('DATASET_IMPORT_UNSAVED_CHANGES_TITLE_EDIT')\n\t\t\t\t: this.$Bitrix.Loc.getMessage('DATASET_IMPORT_UNSAVED_CHANGES_TITLE')\n\t\t\t;\n\t\t},\n\t\tunsavedChangesPopupText(): string\n\t\t{\n\t\t\treturn this.isEditMode\n\t\t\t\t? this.$Bitrix.Loc.getMessage('DATASET_IMPORT_UNSAVED_CHANGES_TEXT_EDIT')\n\t\t\t\t: this.$Bitrix.Loc.getMessage('DATASET_IMPORT_UNSAVED_CHANGES_TEXT')\n\t\t\t;\n\t\t},\n\t},\n\tmounted()\n\t{\n\t\tthis.$Bitrix.eventEmitter.subscribe('biconnector:dataset-import:createButtonClick', this.onSaveButtonClick);\n\t\tthis.$Bitrix.eventEmitter.subscribe('biconnector:dataset-import:cancelButtonClick', this.onCancelButtonClick);\n\n\t\tconst slider = SidePanel.Instance.getTopSlider();\n\t\tif (slider)\n\t\t{\n\t\t\ttop.BX.addCustomEvent(slider, 'SidePanel.Slider:onClose', this.onSliderClose);\n\n\t\t\taddEventListener('beforeunload', (event) => {\n\t\t\t\ttop.BX.removeCustomEvent(slider, 'SidePanel.Slider:onClose', this.onSliderClose);\n\t\t\t});\n\t\t}\n\t},\n\tbeforeUnmount()\n\t{\n\t\tthis.$Bitrix.eventEmitter.unsubscribe('biconnector:dataset-import:createButtonClick', this.onSaveButtonClick);\n\t\tthis.$Bitrix.eventEmitter.unsubscribe('biconnector:dataset-import:cancelButtonClick', this.onCancelButtonClick);\n\t},\n\tmethods: {\n\t\tmarkAsChanged()\n\t\t{\n\t\t\tthis.isChanged = true;\n\t\t},\n\t\tonSliderClose(event)\n\t\t{\n\t\t\tif (!this.isChanged)\n\t\t\t{\n\t\t\t\tif (!this.isSaveComplete)\n\t\t\t\t{\n\t\t\t\t\tthis.sendAnalytics({\n\t\t\t\t\t\tevent: this.isEditMode ? 'edit_end' : 'creation_end',\n\t\t\t\t\t\tstatus: 'error',\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tevent.denyAction();\n\n\t\t\tif (PopupManager.getPopupById('unsaved'))\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst continueButton = new Button({\n\t\t\t\tcolor: ButtonColor.PRIMARY,\n\t\t\t\ttext: this.$Bitrix.Loc.getMessage('DATASET_IMPORT_CONTINUE_IMPORT'),\n\t\t\t\tevents: {\n\t\t\t\t\tclick() {\n\t\t\t\t\t\tpopup.destroy();\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t});\n\n\t\t\tconst closeButton = new Button({\n\t\t\t\tcolor: ButtonColor.LINK,\n\t\t\t\ttext: this.$Bitrix.Loc.getMessage('DATASET_IMPORT_CONFIRM_CANCEL_IMPORT'),\n\t\t\t\tevents: {\n\t\t\t\t\tclick: () => {\n\t\t\t\t\t\tthis.isChanged = false;\n\t\t\t\t\t\tthis.closeApp();\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t});\n\n\t\t\tconst popupHeader = this.unsavedChangesPopupTitle;\n\t\t\tconst popupText = this.unsavedChangesPopupText;\n\n\t\t\tconst popup = new MainPopup({\n\t\t\t\tid: 'unsaved',\n\t\t\t\tcontent: Tag.render`\n\t\t\t\t\t<div class=\"generic-popup\">\n\t\t\t\t\t\t<h3 class=\"generic-popup__header\">${popupHeader}</h3>\n\t\t\t\t\t\t<div class=\"generic-popup__content\">\n\t\t\t\t\t\t\t${popupText}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"generic-popup__buttons-wrapper\">\n\t\t\t\t\t\t\t${continueButton.render()}\n\t\t\t\t\t\t\t${closeButton.render()}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t`,\n\t\t\t\twidth: 440,\n\t\t\t\tnoAllPaddings: true,\n\t\t\t\tautoHide: false,\n\t\t\t\tfixed: true,\n\t\t\t\toverlay: true,\n\t\t\t});\n\n\t\t\tpopup.show();\n\t\t},\n\t\tcloseApp()\n\t\t{\n\t\t\tSidePanel.Instance.getTopSlider().close();\n\t\t},\n\t\ttoggleStepState(step: string, disabled: ?boolean = null)\n\t\t{\n\t\t\tif (!this.steps[step])\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (Type.isNull(disabled))\n\t\t\t{\n\t\t\t\tthis.steps[step].disabled = !Boolean(this.steps[step].disabled);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.steps[step].disabled = disabled;\n\t\t\t}\n\t\t},\n\t\ttogglePopup(step: string, shown: ?boolean = null)\n\t\t{\n\t\t\tif (Type.isNull(shown))\n\t\t\t{\n\t\t\t\tthis.shownPopups[step] = !Boolean(this.shownPopups[step]);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.shownPopups[step] = shown;\n\t\t\t}\n\t\t},\n\t\tloadDataset()\n\t\t{\n\t\t\tAjax.runAction('biconnector.externalsource.dataset.view', {\n\t\t\t\tdata: {\n\t\t\t\t\ttype: this.sourceCode,\n\t\t\t\t\tfields: this.loadParams,\n\t\t\t\t},\n\t\t\t})\n\t\t\t\t.then((response) => {\n\t\t\t\t\tthis.onLoadSuccess(response);\n\t\t\t\t})\n\t\t\t\t.catch((error) => {\n\t\t\t\t\tthis.onLoadError(error);\n\t\t\t\t});\n\t\t},\n\t\tonStepValidation(step, validationResult)\n\t\t{\n\t\t\tif (!this.steps[step])\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.steps[step].valid = validationResult;\n\t\t},\n\t\tonSaveButtonClick()\n\t\t{\n\t\t\tthis.onSaveStart()\n\t\t\t\t.then(() => {\n\t\t\t\t\tthis.handleSaveAction();\n\t\t\t\t})\n\t\t\t\t.catch(() => {})\n\t\t\t;\n\t\t},\n\t\tonCancelButtonClick()\n\t\t{\n\t\t\tthis.closeApp();\n\t\t},\n\t\thandleSaveAction()\n\t\t{\n\t\t\tif (this.isEditMode)\n\t\t\t{\n\t\t\t\tthis.updateDataset();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.saveDataset();\n\t\t\t}\n\t\t},\n\t\tsaveDataset()\n\t\t{\n\t\t\tAjax.runAction('biconnector.externalsource.dataset.add', {\n\t\t\t\tdata: {\n\t\t\t\t\ttype: this.sourceCode,\n\t\t\t\t\tfields: this.saveParams,\n\t\t\t\t},\n\t\t\t})\n\t\t\t\t.then((response) => {\n\t\t\t\t\tthis.onSaveEnd(response);\n\t\t\t\t})\n\t\t\t\t.catch((error) => {\n\t\t\t\t\tthis.onSaveError();\n\t\t\t\t});\n\t\t},\n\t\tupdateDataset()\n\t\t{\n\t\t\tAjax.runAction('biconnector.externalsource.dataset.update', {\n\t\t\t\tdata: {\n\t\t\t\t\tid: this.datasetId,\n\t\t\t\t\ttype: this.sourceCode,\n\t\t\t\t\tfields: this.saveParams,\n\t\t\t\t},\n\t\t\t})\n\t\t\t\t.then((response) => {\n\t\t\t\t\tthis.onSaveEnd(response);\n\t\t\t\t})\n\t\t\t\t.catch((error) => {\n\t\t\t\t\tthis.onSaveError();\n\t\t\t\t});\n\t\t},\n\t\tonSaveStart(): Promise\n\t\t{\n\t\t\treturn Promise.resolve();\n\t\t},\n\t\tonSaveEnd()\n\t\t{\n\t\t},\n\t\tonSaveError()\n\t\t{\n\t\t},\n\t\tonLoadStart()\n\t\t{\n\t\t},\n\t\tonLoadSuccess(response)\n\t\t{\n\t\t},\n\t\tonLoadError(response)\n\t\t{\n\t\t},\n\t\treload()\n\t\t{\n\t\t\twindow.location.reload();\n\t\t},\n\t\tsendAnalytics(params: AnalyticsOptions)\n\t\t{\n\t\t\tif (this.sourceCode)\n\t\t\t{\n\t\t\t\tsendData({\n\t\t\t\t\t...this.getBaseAnalyticsParams(),\n\t\t\t\t\t...params,\n\t\t\t\t});\n\t\t\t}\n\t\t},\n\t\tgetBaseAnalyticsParams()\n\t\t{\n\t\t\treturn {\n\t\t\t\ttool: 'BI_Builder',\n\t\t\t\tc_section: 'BI_Builder',\n\t\t\t\tcategory: this.sourceCode.toUpperCase(),\n\t\t\t};\n\t\t},\n\t},\n};\n","import { FileExport } from 'biconnector.dataset-import.file-export';\nimport { AppLayout } from '../layout/app-layout';\nimport { ImportConfig } from '../layout/import-config';\nimport { FileErrorsPopup } from '../popups/file-checking/file-errors-popup';\nimport { CheckingProgressPopup } from '../popups/file-checking/checking-progress-popup';\nimport { CheckingSuccessPopup } from '../popups/file-checking/checking-success-popup';\nimport { CheckingFailedPopup } from '../popups/file-checking/checking-failed-popup';\nimport { GenericPopup } from '../popups/generic-popup';\nimport { ImportFailurePopup } from '../popups/saving/import-failure-popup';\nimport { ImportProgressPopup } from '../popups/saving/import-progress-popup';\nimport { ImportSuccessPopup } from '../popups/saving/import-success-popup';\nimport { DatasetPropertiesStep } from '../steps/dataset-properties';\nimport { FieldsSettingsStep } from '../steps/fields-settings';\nimport { FileStep } from '../steps/file';\nimport { ImportPreview } from '../steps/import-preview';\nimport { BaseApp } from './base-app';\nimport { ajax as Ajax, Dom } from 'main.core';\nimport { EventEmitter } from 'main.core.events';\n\nexport const CsvApp = {\n\textends: BaseApp,\n\tdata()\n\t{\n\t\treturn {\n\t\t\tsteps: {\n\t\t\t\tfile: {\n\t\t\t\t\tdisabled: false,\n\t\t\t\t\tvalid: this.$store.getters.isEditMode,\n\t\t\t\t},\n\t\t\t\tproperties: {\n\t\t\t\t\tdisabled: !this.$store.getters.isEditMode,\n\t\t\t\t\tvalid: true,\n\t\t\t\t},\n\t\t\t\tfields: {\n\t\t\t\t\tdisabled: !this.$store.getters.isEditMode,\n\t\t\t\t\tvalid: true,\n\t\t\t\t},\n\t\t\t},\n\t\t\tshownPopups: {\n\t\t\t\tsavingProgress: false,\n\t\t\t\tsavingSuccess: false,\n\t\t\t\tsavingFailure: false,\n\t\t\t\teditModeFileReplacement: false,\n\t\t\t\tcheckFileProgress: false,\n\t\t\t\tcheckFileSuccess: false,\n\t\t\t\tcheckFileFailure: false,\n\t\t\t\tfileErrors: false,\n\t\t\t},\n\t\t\tisValidationComplete: true,\n\t\t\tpopupParams: {\n\t\t\t\tsavingSuccess: {},\n\t\t\t\tfileErrors: {\n\t\t\t\t\tisSavingMode: false,\n\t\t\t\t},\n\t\t\t},\n\t\t\tlastReloadSource: null,\n\t\t\tinitialPreviewData: {},\n\t\t\tinitialFieldsSettings: [],\n\t\t\tpreviewError: '',\n\t\t\tisEditModeSaveConfirmed: false,\n\t\t\tisDataLoadingAnimationDisplayed: false,\n\t\t\thasMinimalLoadingAnimationTimePassed: true,\n\t\t\tcheckFileErrors: [],\n\t\t\tisErrorsChecked: false,\n\t\t\texportDownloadLink: null,\n\t\t};\n\t},\n\tcomputed: {\n\t\tsourceCode()\n\t\t{\n\t\t\treturn 'csv';\n\t\t},\n\t\tisEditMode()\n\t\t{\n\t\t\treturn this.$store.getters.isEditMode;\n\t\t},\n\t\tloadParams()\n\t\t{\n\t\t\treturn {\n\t\t\t\tfileProperties: this.$store.state.config.fileProperties,\n\t\t\t\tdatasetProperties: this.$store.state.config.datasetProperties,\n\t\t\t\tfieldsSettings: this.$store.state.config.fieldsSettings,\n\t\t\t\tdataFormats: this.$store.state.config.dataFormats,\n\t\t\t};\n\t\t},\n\t\tsaveParams()\n\t\t{\n\t\t\treturn {\n\t\t\t\tfileProperties: this.$store.state.config.fileProperties,\n\t\t\t\tdatasetProperties: this.$store.state.config.datasetProperties,\n\t\t\t\tfieldsSettings: this.$store.state.config.fieldsSettings,\n\t\t\t\tdataFormats: this.$store.state.config.dataFormats,\n\t\t\t};\n\t\t},\n\t\tdatasetId()\n\t\t{\n\t\t\treturn this.$store.state.config.datasetProperties.id;\n\t\t},\n\t\tisValidatedForSave()\n\t\t{\n\t\t\treturn this.steps.fields.valid && this.steps.properties.valid && this.steps.file.valid;\n\t\t},\n\t\timportFailurePopupTitle()\n\t\t{\n\t\t\treturn this.isEditMode ? this.$Bitrix.Loc.getMessage('DATASET_IMPORT_FAILURE_POPUP_HEADER_EDIT') : this.$Bitrix.Loc.getMessage('DATASET_IMPORT_FAILURE_POPUP_HEADER');\n\t\t},\n\t\timportSuccessPopupTitle()\n\t\t{\n\t\t\treturn this.isEditMode\n\t\t\t\t? this.$Bitrix.Loc.getMessage('DATASET_IMPORT_SUCCESS_POPUP_HEADER_EDIT').replace('#DATASET_TITLE#', this.popupParams.savingSuccess.title)\n\t\t\t\t: this.$Bitrix.Loc.getMessage('DATASET_IMPORT_SUCCESS_POPUP_HEADER').replace('#DATASET_TITLE#', this.popupParams.savingSuccess.title);\n\t\t},\n\t\timportSuccessPopupDescription()\n\t\t{\n\t\t\treturn this.$store.state.config.fileProperties.fileName\n\t\t\t\t? this.$Bitrix.Loc.getMessage('DATASET_IMPORT_SUCCESS_POPUP_DESCRIPTION').replace('#FILE_NAME#', this.popupParams.savingSuccess.fileName)\n\t\t\t\t: '';\n\t\t},\n\t\timportProgressPopupDescription()\n\t\t{\n\t\t\treturn this.isEditMode\n\t\t\t\t? this.$Bitrix.Loc.getMessage('DATASET_IMPORT_PROGRESS_POPUP_DESCRIPTION_EDIT')\n\t\t\t\t: this.$Bitrix.Loc.getMessage('DATASET_IMPORT_PROGRESS_POPUP_DESCRIPTION');\n\t\t},\n\t},\n\tmethods: {\n\t\tmarkAsChanged()\n\t\t{\n\t\t\tthis.isChanged = true;\n\t\t},\n\t\tonDatasetPropertiesChanged()\n\t\t{\n\t\t\tthis.markAsChanged();\n\t\t\tif (this.lastChangedStep !== 'properties')\n\t\t\t{\n\t\t\t\tthis.sendAnalytics({\n\t\t\t\t\tevent: this.isEditMode ? 'edit_start' : 'creation_start',\n\t\t\t\t\tc_element: 'step_2',\n\t\t\t\t\t...(this.isEditMode && { p1: `datasetName_${this.$store.state.config.datasetProperties.name.replaceAll('_', '')}`}),\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tthis.lastChangedStep = 'properties';\n\t\t},\n\t\tonFieldsSettingsChanged()\n\t\t{\n\t\t\tthis.markAsChanged();\n\t\t\tif (this.lastChangedStep !== 'fields')\n\t\t\t{\n\t\t\t\tthis.sendAnalytics({\n\t\t\t\t\tevent: this.isEditMode ? 'edit_start' : 'creation_start',\n\t\t\t\t\tc_element: 'step_3',\n\t\t\t\t\t...(this.isEditMode && { p1: `datasetName_${this.$store.state.config.datasetProperties.name.replaceAll('_', '')}`}),\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tthis.lastChangedStep = 'fields';\n\t\t\tthis.isErrorsChecked = false;\n\t\t},\n\t\tonDatasetReloadNeeded(reloadSource)\n\t\t{\n\t\t\tthis.markAsChanged();\n\t\t\tthis.previewError = '';\n\t\t\tthis.lastReloadSource = reloadSource;\n\t\t\tthis.isErrorsChecked = false;\n\n\t\t\tif (this.$store.state.config.fileProperties.fileToken)\n\t\t\t{\n\t\t\t\tif (reloadSource === 'file')\n\t\t\t\t{\n\t\t\t\t\tthis.lastChangedStep = 'file';\n\n\t\t\t\t\tthis.sendAnalytics({\n\t\t\t\t\t\tevent: this.isEditMode ? 'edit_start' : 'creation_start',\n\t\t\t\t\t\tc_element: 'step_1',\n\t\t\t\t\t\t...(this.isEditMode && { p1: `datasetName_${this.$store.state.config.datasetProperties.name.replaceAll('_', '')}` }),\n\t\t\t\t\t});\n\n\t\t\t\t\tthis.startPreviewLoadingAnimation();\n\t\t\t\t}\n\n\t\t\t\tthis.loadDataset();\n\t\t\t}\n\t\t\telse if (this.isEditMode)\n\t\t\t{\n\t\t\t\tthis.$store.commit('setPreviewData', this.initialPreviewData);\n\t\t\t\tthis.$store.commit('setFieldsSettings', this.initialFieldsSettings);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.$store.commit('setPreviewData', []);\n\t\t\t\tthis.$refs.propertiesStep.close();\n\t\t\t\tthis.$refs.fieldsStep.close();\n\t\t\t\tthis.toggleStepState('properties', true);\n\t\t\t\tthis.toggleStepState('fields', true);\n\t\t\t\tthis.toggleCheckFileButton(true);\n\t\t\t}\n\t\t},\n\t\tprocessLoadResponse(response)\n\t\t{\n\t\t\tconst responseData = response.data;\n\n\t\t\tif (!responseData || responseData.data.length === 0)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (this.lastReloadSource === 'file' && !this.isEditMode)\n\t\t\t{\n\t\t\t\tconst headers = [];\n\t\t\t\tresponseData.headers.forEach((header, index) => {\n\t\t\t\t\theaders.push(this.prepareHeader(header, index));\n\t\t\t\t});\n\n\t\t\t\tthis.$store.commit('setFieldsSettings', headers);\n\t\t\t}\n\t\t\tthis.$store.commit('setPreviewData', responseData.data);\n\t\t},\n\t\tprepareHeader(header, index)\n\t\t{\n\t\t\treturn {\n\t\t\t\tvisible: true,\n\t\t\t\ttype: header.type,\n\t\t\t\tname: header.name && header.name.length > 0 ? header.name : `FIELD_${index}`,\n\t\t\t\toriginalType: null,\n\t\t\t\toriginalName: header.externalCode,\n\t\t\t\texternalCode: header.externalCode,\n\t\t\t};\n\t\t},\n\t\tonLoadSuccess(response)\n\t\t{\n\t\t\tthis.stopPreviewLoadingAnimation();\n\t\t\tthis.processLoadResponse(response);\n\n\t\t\tthis.$refs.propertiesStep.open();\n\t\t\tthis.$refs.fieldsStep.open();\n\t\t\tthis.toggleStepState('properties', false);\n\t\t\tthis.toggleStepState('fields', false);\n\t\t\tthis.$refs.fieldsStep.validate();\n\t\t\tthis.toggleCheckFileButton(false);\n\t\t},\n\t\tonLoadError(response)\n\t\t{\n\t\t\tthis.stopPreviewLoadingAnimation();\n\t\t\tthis.previewError = response.errors[0]?.message ?? this.$Bitrix.Loc.getMessage('DATASET_IMPORT_PREVIEW_ERROR_FILE');\n\t\t},\n\t\tonSaveStart(): Promise\n\t\t{\n\t\t\tif (!this.isValidatedForSave)\n\t\t\t{\n\t\t\t\tthis.$refs.fileStep.showValidationErrors();\n\t\t\t\tthis.$refs.fieldsStep.showValidationErrors();\n\t\t\t\tthis.$refs.propertiesStep.showValidationErrors();\n\n\t\t\t\treturn Promise.reject();\n\t\t\t}\n\n\t\t\tif (this.isEditMode && !this.isEditModeSaveConfirmed && this.$store.state.config.fileProperties.fileToken)\n\t\t\t{\n\t\t\t\tthis.togglePopup('editModeFileReplacement', true);\n\n\t\t\t\treturn Promise.reject();\n\t\t\t}\n\n\t\t\tthis.togglePopup('savingProgress', true);\n\t\t\tif (this.isEditMode && !this.$store.state.config.fileProperties.fileToken)\n\t\t\t{\n\t\t\t\treturn Promise.resolve();\n\t\t\t}\n\n\t\t\tthis.popupParams.fileErrors.isSavingMode = true;\n\n\t\t\treturn new Promise((resolve, reject) => {\n\t\t\t\tthis.checkFile()\n\t\t\t\t\t.then(() => {\n\t\t\t\t\t\tresolve();\n\t\t\t\t\t})\n\t\t\t\t\t.catch(() => {\n\t\t\t\t\t\tthis.togglePopup('savingProgress', false);\n\t\t\t\t\t\tthis.togglePopup('fileErrors', true);\n\t\t\t\t\t\treject();\n\t\t\t\t\t});\n\t\t\t});\n\t\t},\n\t\tonSaveEnd(response)\n\t\t{\n\t\t\tconst datasetName = response.data.name ?? this.$store.state.config.datasetProperties.name;\n\t\t\tconst datasetId = response.data.id ?? this.$store.state.config.datasetProperties.id;\n\t\t\tthis.popupParams.savingSuccess = {\n\t\t\t\ttitle: datasetName,\n\t\t\t\tdatasetId,\n\t\t\t\tfileName: this.$store.state.config.fileProperties.fileName,\n\t\t\t};\n\n\t\t\tthis.togglePopup('savingProgress', false);\n\t\t\tthis.togglePopup('savingSuccess', true);\n\t\t\tthis.isChanged = false;\n\t\t\tthis.isSaveComplete = true;\n\t\t\tBX.SidePanel.Instance.postMessage(window, 'BIConnector.dataset-import:onDatasetCreated', {});\n\t\t\tthis.sendAnalytics({\n\t\t\t\tevent: this.isEditMode ? 'edit_end' : 'creation_end',\n\t\t\t\tstatus: 'success',\n\t\t\t\tp1: `datasetName_${datasetName.replaceAll('_', '')}`,\n\t\t\t});\n\t\t},\n\t\tonSaveError()\n\t\t{\n\t\t\tthis.togglePopup('savingProgress', false);\n\t\t\tthis.togglePopup('savingFailure', true);\n\t\t\tBX.SidePanel.Instance.postMessage(window, 'BIConnector.dataset-import:onDatasetCreated', {});\n\n\t\t\tthis.sendAnalytics({\n\t\t\t\tevent: this.isEditMode ? 'edit_end' : 'creation_end',\n\t\t\t\tstatus: 'error',\n\t\t\t});\n\t\t},\n\t\tonSuccessPopupClose()\n\t\t{\n\t\t\tthis.togglePopup('savingSuccess', false);\n\t\t\tthis.closeApp();\n\t\t},\n\t\tcloseFailurePopup()\n\t\t{\n\t\t\tthis.togglePopup('savingFailure', false);\n\t\t},\n\t\tonReplacementButtonClick()\n\t\t{\n\t\t\tthis.isEditModeSaveConfirmed = true;\n\t\t\tthis.togglePopup('editModeFileReplacement', false);\n\t\t\tthis.onSaveButtonClick();\n\t\t},\n\t\tstartPreviewLoadingAnimation()\n\t\t{\n\t\t\tthis.isDataLoadingAnimationDisplayed = true;\n\t\t\tthis.hasMinimalLoadingAnimationTimePassed = false;\n\t\t\tsetTimeout(() => {\n\t\t\t\tthis.hasMinimalLoadingAnimationTimePassed = true;\n\t\t\t}, 1500);\n\t\t},\n\t\tstopPreviewLoadingAnimation()\n\t\t{\n\t\t\tthis.isDataLoadingAnimationDisplayed = false;\n\t\t},\n\t\tonCheckFileClick()\n\t\t{\n\t\t\tthis.popupParams.fileErrors.isSavingMode = false;\n\t\t\tif (this.previewError)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tthis.togglePopup('checkFileProgress', true);\n\t\t\tthis.checkFile()\n\t\t\t\t.then(() => {\n\t\t\t\t\tthis.togglePopup('checkFileProgress', false);\n\t\t\t\t\tthis.togglePopup('checkFileSuccess', true);\n\t\t\t\t})\n\t\t\t\t.catch(() => {\n\t\t\t\t\tthis.togglePopup('checkFileProgress', false);\n\t\t\t\t\tthis.togglePopup('fileErrors', true);\n\t\t\t\t})\n\t\t\t;\n\t\t},\n\t\tonExportFileClick()\n\t\t{\n\t\t\tconst button = document.querySelector('.biconnector-export-file-button');\n\n\t\t\tif (!button)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tDom.addClass(button, 'ui-btn-wait');\n\t\t\tDom.attr(button, { disabled: true });\n\n\t\t\tFileExport.getInstance().download({\n\t\t\t\tid: this.datasetId,\n\t\t\t\ttitle: this.$store.state.config.datasetProperties.name ?? 'dataset',\n\t\t\t})\n\t\t\t\t.then(() => {\n\t\t\t\t\tDom.removeClass(button, 'ui-btn-wait');\n\t\t\t\t\tDom.attr(button, { disabled: null });\n\t\t\t\t})\n\t\t\t\t.catch(() => {\n\t\t\t\t\tDom.removeClass(button, 'ui-btn-wait');\n\t\t\t\t\tDom.attr(button, { disabled: null });\n\t\t\t\t})\n\t\t\t;\n\t\t},\n\t\tsaveIgnoringErrors()\n\t\t{\n\t\t\tthis.togglePopup('fileErrors', false);\n\t\t\tthis.togglePopup('savingProgress', true);\n\t\t\tthis.handleSaveAction();\n\t\t},\n\t\tcheckFile(): Promise\n\t\t{\n\t\t\tif (this.isErrorsChecked)\n\t\t\t{\n\t\t\t\tif (this.checkFileErrors.length > 0)\n\t\t\t\t{\n\t\t\t\t\treturn Promise.reject();\n\t\t\t\t}\n\n\t\t\t\treturn Promise.resolve();\n\t\t\t}\n\n\t\t\treturn new Promise((resolve, reject) => {\n\t\t\t\tAjax.runAction('biconnector.externalsource.dataset.checkFile', {\n\t\t\t\t\tdata: {\n\t\t\t\t\t\ttype: this.sourceCode,\n\t\t\t\t\t\tfields: this.loadParams,\n\t\t\t\t\t},\n\t\t\t\t})\n\t\t\t\t\t.then((response) => {\n\t\t\t\t\t\tthis.checkFileErrors = this.prepareCheckFileErrors(response.data.checkFileErrors);\n\t\t\t\t\t\tthis.isErrorsChecked = true;\n\t\t\t\t\t\tif (this.checkFileErrors.length > 0)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\treject();\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tresolve();\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\t\t\t\t\t.catch((response) => {\n\t\t\t\t\t\tconsole.error(response);\n\t\t\t\t\t\tthis.togglePopup('checkFileProgress', false);\n\t\t\t\t\t\tthis.togglePopup('savingProgress', false);\n\t\t\t\t\t\tthis.togglePopup('checkFileFailure', true);\n\t\t\t\t\t})\n\t\t\t\t;\n\t\t\t});\n\t\t},\n\t\tprepareCheckFileErrors(errors: Object): Array\n\t\t{\n\t\t\tconst result = [];\n\t\t\tObject.keys(errors).forEach((lineNumber) => {\n\t\t\t\terrors[lineNumber].forEach((error) => {\n\t\t\t\t\tresult.push({\n\t\t\t\t\t\tlineNumber,\n\t\t\t\t\t\terrorMessage: error.message,\n\t\t\t\t\t\tcolumnName: this.$store.state.config.fieldsSettings[error.customData.field].name,\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t});\n\n\t\t\treturn result;\n\t\t},\n\t\ttoggleCheckFileButton(disabled: boolean): void\n\t\t{\n\t\t\tconst button = document.querySelector('.biconnector-check-file-button');\n\t\t\tif (button)\n\t\t\t{\n\t\t\t\tif (disabled)\n\t\t\t\t{\n\t\t\t\t\tDom.addClass(button, 'ui-btn-disabled');\n\t\t\t\t\tDom.attr(button, 'disabled', true);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tDom.removeClass(button, 'ui-btn-disabled');\n\t\t\t\t\tDom.attr(button, 'disabled', null);\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t},\n\tmounted()\n\t{\n\t\tif (this.isEditMode)\n\t\t{\n\t\t\tthis.initialPreviewData = this.$store.state.previewData.rows;\n\t\t\tthis.initialFieldsSettings = this.$store.state.config.fieldsSettings;\n\t\t}\n\n\t\tEventEmitter.subscribe('biconnector:dataset-import:onCheckFileClick', this.onCheckFileClick);\n\t\tEventEmitter.subscribe('biconnector:dataset-import:onExportFileClick', this.onExportFileClick);\n\t\tEventEmitter.subscribe('SidePanel.Slider:onClose', () => {\n\t\t\tURL.revokeObjectURL(this.exportDownloadLink);\n\t\t});\n\t},\n\tbeforeUnmount()\n\t{\n\t\tEventEmitter.unsubscribe('biconnector:dataset-import:onCheckFileClick', this.onCheckFileClick);\n\t\tEventEmitter.unsubscribe('biconnector:dataset-import:onExportFileClick', this.onExportFileClick);\n\t\tURL.revokeObjectURL(this.exportDownloadLink);\n\t},\n\tcomponents: {\n\t\tAppLayout,\n\t\tImportConfig,\n\t\tImportPreview,\n\t\tFileStep,\n\t\tDatasetPropertiesStep,\n\t\tFieldsSettingsStep,\n\t\tImportProgressPopup,\n\t\tImportSuccessPopup,\n\t\tImportFailurePopup,\n\t\tGenericPopup,\n\t\tFileErrorsPopup,\n\t\tCheckingProgressPopup,\n\t\tCheckingSuccessPopup,\n\t\tCheckingFailedPopup,\n\t},\n\t// language=Vue\n\ttemplate: `\n\t\t<AppLayout :save-locked=\"!isSaveEnabled\" ref=\"appLayout\" :is-edit-mode=\"isEditMode\">\n\t\t\t<template v-slot:left-panel>\n\t\t\t\t<ImportConfig>\n\t\t\t\t\t<FileStep\n\t\t\t\t\t\t:separators=\"appParams.separators\"\n\t\t\t\t\t\t:encodings=\"appParams.encodings\"\n\t\t\t\t\t\t:disabled=\"steps.file.disabled\"\n\t\t\t\t\t\t:data-format-templates=\"appParams.dataFormatTemplates\"\n\t\t\t\t\t\tref=\"fileStep\"\n\t\t\t\t\t\t@validation=\"onStepValidation('file', $event)\"\n\t\t\t\t\t\t@file-properties-change=\"onDatasetReloadNeeded('file')\"\n\t\t\t\t\t\t@parsing-options-changed=\"onDatasetReloadNeeded('fields')\"\n\t\t\t\t\t/>\n\t\t\t\t\t<DatasetPropertiesStep\n\t\t\t\t\t\t:is-open-initially=\"isEditMode\"\n\t\t\t\t\t\t:disabled=\"steps.properties.disabled\"\n\t\t\t\t\t\t:reserved-names=\"appParams.reservedNames\"\n\t\t\t\t\t\t:name-max-length=30\n\t\t\t\t\t\tref=\"propertiesStep\"\n\t\t\t\t\t\t@validation=\"onStepValidation('properties', $event)\"\n\t\t\t\t\t\t@properties-changed=\"onDatasetPropertiesChanged\"\n\t\t\t\t\t\t:dataset-source-code=\"sourceCode\"\n\t\t\t\t\t/>\n\t\t\t\t\t<FieldsSettingsStep\n\t\t\t\t\t\t:is-open-initially=\"isEditMode\"\n\t\t\t\t\t\t:disabled=\"steps.fields.disabled\"\n\t\t\t\t\t\tref=\"fieldsStep\"\n\t\t\t\t\t\t@validation=\"onStepValidation('fields', $event)\"\n\t\t\t\t\t\t@parsing-options-changed=\"onDatasetReloadNeeded('fields')\"\n\t\t\t\t\t\t@settings-changed=\"onFieldsSettingsChanged\"\n\t\t\t\t\t/>\n\t\t\t\t</ImportConfig>\n\t\t\t</template>\n\t\t\t<template v-slot:right-panel>\n\t\t\t\t<ImportPreview \n\t\t\t\t\t:error=\"previewError\"\n\t\t\t\t\t:is-loading=\"isDataLoadingAnimationDisplayed || !hasMinimalLoadingAnimationTimePassed\"\n\t\t\t\t/>\n\t\t\t</template>\n\t\t</AppLayout>\n\n\t\t<ImportProgressPopup\n\t\t\tv-if=\"shownPopups.savingProgress\"\n\t\t\t:description=\"importProgressPopupDescription\"\n\t\t/>\n\n\t\t<ImportSuccessPopup\n\t\t\tv-if=\"shownPopups.savingSuccess\"\n\t\t\t@close=\"onSuccessPopupClose\"\n\t\t\t@click=\"closeApp\"\n\t\t\t@one-more-click=\"reload\"\n\t\t\t:title=\"importSuccessPopupTitle\"\n\t\t\t:description=\"importSuccessPopupDescription\"\n\t\t\t:dataset-id=\"popupParams.savingSuccess.datasetId\"\n\t\t\t:show-more-button=\"!isEditMode\"\n\t\t/>\n\n\t\t<ImportFailurePopup\n\t\t\tv-if=\"shownPopups.savingFailure\"\n\t\t\t@close=\"closeFailurePopup\"\n\t\t\t@click=\"closeFailurePopup\"\n\t\t\t:title=\"importFailurePopupTitle\"\n\t\t\t:description=\"$Bitrix.Loc.getMessage('DATASET_IMPORT_FAILURE_POPUP_DESCRIPTION').replace('[link]', '<a>').replace('[/link]', '</a>')\"\n\t\t/>\n\n\t\t<GenericPopup\n\t\t\tv-if=\"shownPopups.editModeFileReplacement\"\n\t\t\t:title=\"$Bitrix.Loc.getMessage('DATASET_IMPORT_FILE_REPLACEMENT_TITLE')\"\n\t\t\t@close=\"togglePopup('editModeFileReplacement', false)\"\n\t\t>\n\t\t\t<template v-slot:content>\n\t\t\t\t{{ $Bitrix.Loc.getMessage('DATASET_IMPORT_FILE_REPLACEMENT_TEXT') }}\n\t\t\t</template>\n\t\t\t<template v-slot:buttons>\n\t\t\t\t<button @click=\"onReplacementButtonClick\" class=\"ui-btn ui-btn-md ui-btn-primary\">{{\n\t\t\t\t\t$Bitrix.Loc.getMessage('DATASET_IMPORT_FILE_REPLACEMENT_LOAD') }}\n\t\t\t\t</button>\n\t\t\t\t<button @click=\"togglePopup('editModeFileReplacement', false)\"\n\t\t\t\t\t\tclass=\"ui-btn ui-btn-md ui-btn-light-border\">{{\n\t\t\t\t\t$Bitrix.Loc.getMessage('DATASET_IMPORT_FILE_REPLACEMENT_CANCEL') }}\n\t\t\t\t</button>\n\t\t\t</template>\n\t\t</GenericPopup>\n\n\t\t<FileErrorsPopup\n\t\t\tv-if=\"shownPopups.fileErrors\"\n\t\t\t@close=\"togglePopup('fileErrors', false);\"\n\t\t\t@save-ignoring-errors=\"saveIgnoringErrors()\"\n\t\t\t:errors=\"checkFileErrors\"\n\t\t\t:is-edit-mode=\"this.isEditMode\"\n\t\t\t:is-saving-mode=\"popupParams.fileErrors.isSavingMode\"\n\t\t/>\n\t\t<CheckingProgressPopup\n\t\t\tv-if=\"shownPopups.checkFileProgress\"\n\t\t\t@close=\"togglePopup('checkFileProgress', false)\"\n\t\t/>\n\t\t<CheckingSuccessPopup\n\t\t\tv-if=\"shownPopups.checkFileSuccess\"\n\t\t\t@close=\"togglePopup('checkFileSuccess', false)\"\n\t\t/>\n\t\t<CheckingFailedPopup\n\t\t\tv-if=\"shownPopups.checkFileFailure\"\n\t\t\t@close=\"togglePopup('checkFileFailure', false)\"\n\t\t/>\n\t`,\n};\n","import type { PopupOptions } from 'main.popup';\nimport { Popup } from '../../layout/popup';\n\nexport const SyncFieldsPopup = {\n\temits: ['close'],\n\tprops: {\n\t\tisChange: {\n\t\t\ttype: Boolean,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tcomputed: {\n\t\tpopupOptions(): PopupOptions\n\t\t{\n\t\t\treturn {\n\t\t\t\twidth: 440,\n\t\t\t\tcloseIcon: true,\n\t\t\t\tnoAllPaddings: true,\n\t\t\t\toverlay: true,\n\t\t\t};\n\t\t},\n\t},\n\tmethods: {\n\t\tgetDescription(): string\n\t\t{\n\t\t\treturn this.isChange\n\t\t\t\t? this.$Bitrix.Loc.getMessage('DATASET_IMPORT_SYNC_FIELDS_POPUP_DESCRIPTION_CHANGED')\n\t\t\t\t: this.$Bitrix.Loc.getMessage('DATASET_IMPORT_SYNC_FIELDS_POPUP_DESCRIPTION_NOT_CHANGED');\n\t\t},\n\t\tonClose()\n\t\t{\n\t\t\tthis.$emit('close');\n\t\t},\n\t},\n\tcomponents: {\n\t\tPopup,\n\t},\n\t// language=Vue\n\ttemplate: `\n\t\t<Popup id=\"syncFields\" @close=\"this.onClose\" :options=\"popupOptions\" wrapper-class=\"generic-popup\">\n\t\t\t<h3 class=\"generic-popup__header\">{{ $Bitrix.Loc.getMessage('DATASET_IMPORT_SYNC_FIELDS_POPUP_HEADER') }}</h3>\n\t\t\t<div class=\"generic-popup__content\">\n\t\t\t\t{{ getDescription() }}\n\t\t\t</div>\n\t\t\t<div class=\"generic-popup__buttons-wrapper\">\n\t\t\t\t<button @click=\"onClose\" class=\"ui-btn ui-btn-md ui-btn-primary\">\n\t\t\t\t\t{{ $Bitrix.Loc.getMessage('DATASET_IMPORT_SYNC_FIELDS_POPUP_BUTTON') }}\n\t\t\t\t</button>\n\t\t\t</div>\n\t\t</Popup>\n\t`,\n};\n","import { Dom, Event, Tag, Type, Text } from 'main.core';\nimport { BaseEvent, EventEmitter } from 'main.core.events';\nimport { BaseField } from './base-field';\nimport { Dialog, Item, TagSelector } from 'ui.entity-selector';\nimport '../../css/entity-selector-field.css';\n\nexport const ConnectionSelectorField = {\n\textends: BaseField,\n\tprops: {\n\t\toptions: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t\titems: {\n\t\t\ttype: Array,\n\t\t\trequired: true,\n\t\t},\n\t\tconnectionId: {\n\t\t\ttype: Number,\n\t\t\trequired: false,\n\t\t},\n\t},\n\tmounted()\n\t{\n\t\tconst node = this.$refs['entity-selector'];\n\t\tconst selector: TagSelector = new TagSelector({\n\t\t\tid: this.options.selectorId,\n\t\t\tmultiple: false,\n\t\t\taddButtonCaption: this.$Bitrix.Loc.getMessage('DATASET_IMPORT_CONNECTIONS_SELECT'),\n\t\t\taddButtonCaptionMore: this.$Bitrix.Loc.getMessage('DATASET_IMPORT_CONNECTIONS_CHANGE'),\n\t\t\tdialogOptions: {\n\t\t\t\tid: this.options.selectorId,\n\t\t\t\titems: this.preparedItems,\n\t\t\t\tenableSearch: true,\n\t\t\t\tdropdownMode: true,\n\t\t\t\tshowAvatars: true,\n\t\t\t\tcompactView: false,\n\t\t\t\tmultiple: false,\n\t\t\t\twidth: 460,\n\t\t\t\theight: 420,\n\t\t\t\ttabs: [{\n\t\t\t\t\tid: 'connections',\n\t\t\t\t\tstubOptions: {\n\t\t\t\t\t\ttitle: this.$Bitrix.Loc.getMessage('DATASET_IMPORT_NO_CONNECTIONS_TITLE'),\n\t\t\t\t\t\tsubtitle: this.$Bitrix.Loc.getMessage('DATASET_IMPORT_NO_CONNECTIONS_SUBTITLE'),\n\t\t\t\t\t\tarrow: true,\n\t\t\t\t\t\ticon: '/bitrix/images/biconnector/database-connections/connections-empty-state.png',\n\t\t\t\t\t\ticonOpacity: 100,\n\t\t\t\t\t},\n\t\t\t\t}],\n\t\t\t\tentities: [{\n\t\t\t\t\tid: 'biconnector-external-connection',\n\t\t\t\t}],\n\t\t\t},\n\t\t\tevents: {\n\t\t\t\tonTagAdd: (event: BaseEvent) => {\n\t\t\t\t\tthis.$emit('valueChange', event);\n\t\t\t\t},\n\t\t\t\tonTagRemove: (event: BaseEvent) => {\n\t\t\t\t\tthis.$emit('valueClear', event);\n\t\t\t\t},\n\t\t\t},\n\t\t});\n\t\tDom.addClass(selector.getDialog().getContainer(), 'biconnector-dataset-entity-selector');\n\t\tselector.renderTo(node);\n\n\t\tconst footer = Tag.render`\n\t\t\t<span class=\"ui-selector-footer-link ui-selector-footer-link-add\">\n\t\t\t\t${this.$Bitrix.Loc.getMessage('DATASET_IMPORT_NO_CONNECTIONS_FOOTER')}\n\t\t\t</span>\n\t\t`;\n\t\tEvent.bind(footer, 'click', () => {\n\t\t\tconst link = '/bitrix/components/bitrix/biconnector.externalconnection/slider.php?closeAfterCreate=Y';\n\t\t\tBX.SidePanel.Instance.open(link, {\n\t\t\t\twidth: 564,\n\t\t\t\tallowChangeHistory: false,\n\t\t\t\tcacheable: false,\n\t\t\t});\n\t\t});\n\t\tselector.getDialog().getTab(this.name).setFooter(footer);\n\n\t\tthis.selector = selector;\n\n\t\tEventEmitter.subscribe('SidePanel.Slider:onMessage', (event) => {\n\t\t\tconst [messageEvent] = event.getData();\n\t\t\tif (messageEvent.getEventId() === 'BIConnector:ExternalConnection:onConnectionSave')\n\t\t\t{\n\t\t\t\tthis.onConnectionSave(messageEvent);\n\t\t\t}\n\t\t});\n\t},\n\tcomputed: {\n\t\tpreparedItems(): Array\n\t\t{\n\t\t\tconst selectorItems = [];\n\t\t\tthis.items.forEach((item) => {\n\t\t\t\tconst itemOptions = {\n\t\t\t\t\tid: item.ID,\n\t\t\t\t\ttitle: item.TITLE,\n\t\t\t\t\tentityId: this.options.selectorId,\n\t\t\t\t\ttabs: this.name,\n\t\t\t\t\tlink: `/bitrix/components/bitrix/biconnector.externalconnection/slider.php?sourceId=${item.ID}&closeAfterCreate=Y`,\n\t\t\t\t\tlinkTitle: this.$Bitrix.Loc.getMessage('DATASET_IMPORT_CONNECTIONS_ABOUT'),\n\t\t\t\t\tcustomData: {\n\t\t\t\t\t\tconnectionType: item.TYPE,\n\t\t\t\t\t},\n\t\t\t\t};\n\n\t\t\t\tif (item.AVATAR)\n\t\t\t\t{\n\t\t\t\t\titemOptions.avatar = item.AVATAR;\n\t\t\t\t}\n\n\t\t\t\tif (this.connectionId)\n\t\t\t\t{\n\t\t\t\t\titemOptions.selected = item.ID === this.connectionId.toString();\n\t\t\t\t}\n\n\t\t\t\tselectorItems.push(itemOptions);\n\t\t\t});\n\n\t\t\treturn selectorItems;\n\t\t},\n\t},\n\tmethods: {\n\t\tonConnectionSave(event)\n\t\t{\n\t\t\tconst itemOptions: {id: number, name: string, type: string, avatar: ?string} = event.getData().connection;\n\t\t\tif (!Type.isStringFilled(itemOptions?.avatar))\n\t\t\t{\n\t\t\t\titemOptions.avatar = `/bitrix/images/biconnector/database-connections/${itemOptions.type}.svg`;\n\t\t\t}\n\n\t\t\tconst selector: TagSelector = this.selector;\n\t\t\tconst dialog: Dialog = selector.getDialog();\n\t\t\tlet item: ?Item = dialog.getItem({\n\t\t\t\tid: itemOptions.id,\n\t\t\t\tentityId: this.options.selectorId,\n\t\t\t});\n\n\t\t\tif (item)\n\t\t\t{\n\t\t\t\titem.setTitle({ text: Text.decode(itemOptions.name), type: 'text' });\n\t\t\t\tif (item.isSelected())\n\t\t\t\t{\n\t\t\t\t\tselector.removeTags();\n\t\t\t\t\titem.deselect();\n\t\t\t\t\titem.select();\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\titem = dialog.addItem({\n\t\t\t\t\tid: itemOptions.id,\n\t\t\t\t\ttitle: itemOptions.name,\n\t\t\t\t\tentityId: this.options.selectorId,\n\t\t\t\t\ttabs: this.name,\n\t\t\t\t\tlink: `/bitrix/components/bitrix/biconnector.externalconnection/slider.php?sourceId=${itemOptions.id}&closeAfterCreate=Y`,\n\t\t\t\t\tlinkTitle: this.$Bitrix.Loc.getMessage('DATASET_IMPORT_CONNECTIONS_ABOUT'),\n\t\t\t\t\tavatar: `/bitrix/images/biconnector/database-connections/${itemOptions.type}.svg`,\n\t\t\t\t\tcustomData: {\n\t\t\t\t\t\tconnectionType: itemOptions.type,\n\t\t\t\t\t},\n\t\t\t\t});\n\t\t\t\titem.select();\n\t\t\t}\n\n\t\t\tdialog.hide();\n\t\t},\n\t},\n\t// language=Vue\n\ttemplate: `\n\t\t<div>\n\t\t\t<div class=\"ui-ctl-title\">\n\t\t\t\t<div class=\"ui-ctl-label-text\">{{ this.title }}</div>\n\t\t\t</div>\n\t\t\t<div ref=\"entity-selector\"></div>\n\t\t\t<div \n\t\t\t\tv-if=\"!isValid\"\n\t\t\t\tclass=\"connection-error\"\n\t\t\t>\n\t\t\t\t{{ this.errorMessage }}\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import { Dom } from 'main.core';\nimport { BaseEvent, EventEmitter } from 'main.core.events';\nimport { BaseField } from './base-field';\nimport { TagSelector, Dialog } from 'ui.entity-selector';\nimport { BIcon, Set } from 'ui.icon-set.api.vue';\nimport { hint } from 'ui.vue3.directives.hint';\nimport '../../css/entity-selector-field.css';\n\nexport const TableSelectorField = {\n\textends: BaseField,\n\tdirectives: {\n\t\thint,\n\t},\n\tprops: {\n\t\toptions: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t\tconnectionId: {\n\t\t\ttype: Number,\n\t\t\trequired: true,\n\t\t},\n\t\tselectedConnectionType: {\n\t\t\ttype: String,\n\t\t\trequired: false,\n\t\t},\n\t},\n\tdata(): {}\n\t{\n\t\treturn {\n\t\t\thasErrors: false,\n\t\t};\n\t},\n\tmounted()\n\t{\n\t\tconst node = this.$refs['entity-selector'];\n\t\tconst selector: TagSelector = new TagSelector({\n\t\t\tid: this.options.selectorId,\n\t\t\tmultiple: false,\n\t\t\taddButtonCaption: this.$Bitrix.Loc.getMessage('DATASET_IMPORT_CONNECTIONS_SELECT'),\n\t\t\taddButtonCaptionMore: this.$Bitrix.Loc.getMessage('DATASET_IMPORT_CONNECTIONS_CHANGE'),\n\t\t\tdialogOptions: {\n\t\t\t\tid: this.options.selectorId,\n\t\t\t\tenableSearch: true,\n\t\t\t\tdropdownMode: true,\n\t\t\t\tshowAvatars: false,\n\t\t\t\tcompactView: true,\n\t\t\t\tmultiple: false,\n\t\t\t\tdynamicLoad: true,\n\t\t\t\twidth: 460,\n\t\t\t\theight: 420,\n\t\t\t\ttabs: [{\n\t\t\t\t\tid: 'tables',\n\t\t\t\t\tstub: true,\n\t\t\t\t\tstubOptions: {\n\t\t\t\t\t\ttitle: this.$Bitrix.Loc.getMessage('DATASET_IMPORT_TABLES_STUB_TITLE'),\n\t\t\t\t\t\tsubtitle: this.$Bitrix.Loc.getMessage('DATASET_IMPORT_TABLES_STUB_SUBTITLE'),\n\t\t\t\t\t},\n\t\t\t\t}],\n\t\t\t\tentities: [{\n\t\t\t\t\tid: 'biconnector-external-table',\n\t\t\t\t\tdynamicLoad: false,\n\t\t\t\t\tdynamicSearch: true,\n\t\t\t\t\toptions: {\n\t\t\t\t\t\t...(this.connectionId && { connectionId: this.connectionId }),\n\t\t\t\t\t},\n\t\t\t\t}],\n\t\t\t\tevents: {\n\t\t\t\t\t'Entity:onError': (event: BaseEvent) => {\n\t\t\t\t\t\tthis.onError(event);\n\t\t\t\t\t},\n\t\t\t\t\tonSearch: (event: BaseEvent) => {\n\t\t\t\t\t\tthis.onSearch(event);\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t},\n\t\t\tevents: {\n\t\t\t\tonTagAdd: (event: BaseEvent) => {\n\t\t\t\t\tthis.$emit('valueChange', event);\n\t\t\t\t},\n\t\t\t\tonTagRemove: (event: BaseEvent) => {\n\t\t\t\t\tthis.$emit('valueClear', event);\n\t\t\t\t},\n\t\t\t},\n\t\t});\n\t\tDom.addClass(selector.getDialog().getContainer(), 'biconnector-dataset-entity-selector');\n\t\tselector.setLocked(!(this.connectionId > 0 && !this.isDisabled));\n\t\tselector.renderTo(node);\n\n\t\tthis.selector = selector;\n\n\t\tEventEmitter.subscribe('SidePanel.Slider:onMessage', (event) => {\n\t\t\tconst [messageEvent] = event.getData();\n\t\t\tif (messageEvent.getEventId() === 'BIConnector:ExternalConnection:onConnectionSave')\n\t\t\t{\n\t\t\t\tthis.selector.removeTags();\n\t\t\t}\n\t\t});\n\t},\n\tcomputed: {\n\t\tset(): Set\n\t\t{\n\t\t\treturn Set;\n\t\t},\n\t\thintOptions(): Object\n\t\t{\n\t\t\tconst hintCode: string =\n\t\t\t\tthis.selectedConnectionType === 'rest'\n\t\t\t\t\t? 'DATASET_IMPORT_REST_TABLES_HINT'\n\t\t\t\t\t: 'DATASET_IMPORT_TABLES_HINT'\n\t\t\t;\n\n\t\t\treturn {\n\t\t\t\ttext: this.$Bitrix.Loc.getMessage(hintCode),\n\t\t\t\tpopupOptions: {\n\t\t\t\t\tbindOptions: {\n\t\t\t\t\t\tposition: 'top',\n\t\t\t\t\t},\n\t\t\t\t\toffsetTop: -10,\n\t\t\t\t\tangle: {\n\t\t\t\t\t\tposition: 'top',\n\t\t\t\t\t\toffset: 34,\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t};\n\t\t},\n\t},\n\twatch: {\n\t\tconnectionId(newConnectionId)\n\t\t{\n\t\t\tconst selector: TagSelector = this.selector;\n\t\t\tselector.removeTags();\n\t\t\tselector.getDialog().removeItems();\n\n\t\t\tif (!newConnectionId)\n\t\t\t{\n\t\t\t\tselector.setLocked(true);\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tselector.getDialog().getEntity('biconnector-external-table').options.connectionId = newConnectionId;\n\t\t\tselector.setLocked(this.isDisabled);\n\t\t},\n\t},\n\tmethods: {\n\t\tonError(event: BaseEvent)\n\t\t{\n\t\t\tconst errors = event.getData().errors;\n\t\t\tconst dialog: Dialog = event.getTarget();\n\t\t\tconst tableTab = dialog.getTab('tables');\n\t\t\ttableTab.getStub().hide();\n\t\t\tdialog.selectTab('tables');\n\t\t\ttableTab.setStub(\n\t\t\t\ttrue,\n\t\t\t\t{\n\t\t\t\t\ttitle: errors[0].message,\n\t\t\t\t\ticon: '/bitrix/js/biconnector/dataset-import/dist/images/table-error-state.svg',\n\t\t\t\t\ticonOpacity: 100,\n\t\t\t\t},\n\t\t\t);\n\t\t\ttableTab.getStub().show();\n\n\t\t\tthis.hasErrors = true;\n\t\t},\n\t\tonSearch(event: BaseEvent)\n\t\t{\n\t\t\tif (!this.hasErrors)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst dialog: Dialog = event.getTarget();\n\t\t\tconst tableTab = dialog.getTab('tables');\n\t\t\ttableTab.getStub().hide();\n\t\t\ttableTab.setStub(true, {\n\t\t\t\ttitle: this.$Bitrix.Loc.getMessage('DATASET_IMPORT_TABLES_STUB_TITLE'),\n\t\t\t\tsubtitle: this.$Bitrix.Loc.getMessage('DATASET_IMPORT_TABLES_STUB_SUBTITLE'),\n\t\t\t});\n\n\t\t\tthis.hasErrors = false;\n\t\t},\n\t},\n\tcomponents: {\n\t\tBIcon,\n\t},\n\t// language=Vue\n\ttemplate: `\n\t\t<div>\n\t\t\t<div class=\"ui-ctl-title\">\n\t\t\t\t<div class=\"ui-ctl-label-text table-title\">\n\t\t\t\t\t<span>{{ this.title }}</span>\n\t\t\t\t\t<div v-if='selectedConnectionType' class=\"table-hint\" v-hint=\"hintOptions\">\n\t\t\t\t\t\t<BIcon\n\t\t\t\t\t\t\t:name=\"set.HELP\"\n\t\t\t\t\t\t\t:size=\"20\"\n\t\t\t\t\t\t\tcolor=\"#D5D7DB\"\n\t\t\t\t\t\t></BIcon>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div ref=\"entity-selector\"></div>\n\t\t</div>\n\t`,\n};\n","import { ajax as Ajax, Text } from 'main.core';\nimport { BaseStep } from './base-step';\nimport { ConnectionSelectorField } from '../fields/type/connection-selector-field';\nimport { CustomField } from '../fields/type/custom-field';\nimport { TableSelectorField } from '../fields/type/table-selector-field';\nimport { StringField } from '../fields/type/string-field';\nimport { EventEmitter } from 'main.core.events';\nimport '../css/connection.css';\n\nexport const ConnectionStep = {\n\textends: BaseStep,\n\tprops: {\n\t\tconnections: {\n\t\t\ttype: Array,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\ttableId: this.$store.state.config.table,\n\t\t\tconnectionSelectorId: 'biconnector-external-connection',\n\t\t\ttableSelectorId: 'biconnector-external-table',\n\t\t\tunvalidatedFields: {},\n\t\t};\n\t},\n\tcomponents: {\n\t\tConnectionSelectorField,\n\t\tCustomField,\n\t\tTableSelectorField,\n\t\tStringField,\n\t},\n\tcomputed: {\n\t\tdefaultTitle(): string\n\t\t{\n\t\t\treturn this.$Bitrix.Loc.getMessage('DATASET_IMPORT_CONNECTIONS_HEADER');\n\t\t},\n\t\tconnectionSelectorOptions(): Object\n\t\t{\n\t\t\treturn {\n\t\t\t\tselectorId: this.connectionSelectorId,\n\t\t\t};\n\t\t},\n\t\ttableSelectorOptions(): Object\n\t\t{\n\t\t\treturn {\n\t\t\t\tselectorId: this.tableSelectorId,\n\t\t\t};\n\t\t},\n\t\tselectedConnectionType(): string\n\t\t{\n\t\t\treturn this.$store.getters.connectionProperties?.connectionType;\n\t\t},\n\t\tselectedConnectionAvatar(): ?string\n\t\t{\n\t\t\tconst id = this.selectedConnectionId;\n\t\t\tif (id > 0)\n\t\t\t{\n\t\t\t\tconst connection = this.connections.find((item) => parseFloat(item.ID) === id);\n\t\t\t\tif (connection)\n\t\t\t\t{\n\t\t\t\t\treturn connection.AVATAR;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn `/bitrix/images/biconnector/database-connections/${this.selectedConnectionType}.svg`;\n\t\t},\n\t\tselectedConnectionId(): number\n\t\t{\n\t\t\treturn this.$store.getters.connectionProperties?.connectionId ?? 0;\n\t\t},\n\t\tselectedConnectionName(): number\n\t\t{\n\t\t\treturn this.$store.getters.connectionProperties?.connectionName;\n\t\t},\n\t\tselectedTableName(): string\n\t\t{\n\t\t\treturn this.$store.getters.connectionProperties?.tableName;\n\t\t},\n\t\tisEditMode(): boolean\n\t\t{\n\t\t\treturn this.$store.getters.isEditMode;\n\t\t},\n\t},\n\tmethods: {\n\t\tonConnectionSelected(event)\n\t\t{\n\t\t\tconst tag = event.data.tag;\n\t\t\tconst dialogItems = event.target.getDialog().getItems();\n\t\t\tdialogItems.forEach((item) => {\n\t\t\t\tif (item.getId() === tag.getId())\n\t\t\t\t{\n\t\t\t\t\ttag.customData = item.getCustomData();\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tconst sourceId = parseInt(event.data.tag.getId(), 10);\n\n\t\t\tthis.$store.commit('setConnectionProperties', {\n\t\t\t\tconnectionType: event.data.tag.getCustomData().get('connectionType'),\n\t\t\t\tconnectionId: sourceId,\n\t\t\t\ttableName: null,\n\t\t\t});\n\n\t\t\tAjax.runAction('biconnector.externalsource.source.checkExistingConnection', {\n\t\t\t\tdata: {\n\t\t\t\t\tsourceId,\n\t\t\t\t},\n\t\t\t})\n\t\t\t\t.then(() => {\n\t\t\t\t\tthis.unvalidatedFields = {};\n\t\t\t\t})\n\t\t\t\t.catch((response) => {\n\t\t\t\t\tthis.unvalidatedFields = {\n\t\t\t\t\t\tconnection: {\n\t\t\t\t\t\t\tresult: false,\n\t\t\t\t\t\t\tmessage: response.errors[0].message,\n\t\t\t\t\t\t},\n\t\t\t\t\t};\n\t\t\t\t})\n\t\t\t;\n\t\t\tthis.$emit('validation', false);\n\t\t},\n\t\tonConnectionDeselected()\n\t\t{\n\t\t\tthis.$store.commit('setConnectionProperties', {\n\t\t\t\tconnectionType: null,\n\t\t\t\tconnectionId: null,\n\t\t\t\ttableName: null,\n\t\t\t});\n\t\t\tthis.$emit('validation', false);\n\t\t\tthis.unvalidatedFields = {};\n\t\t},\n\t\tonTableSelected(event)\n\t\t{\n\t\t\tthis.$store.commit('setConnectionProperties', {\n\t\t\t\tconnectionType: this.selectedConnectionType,\n\t\t\t\tconnectionId: this.selectedConnectionId,\n\t\t\t\ttableName: event.data.tag.getTitle(),\n\t\t\t});\n\n\t\t\tconst tag = event.data.tag;\n\t\t\tconst dialogItems = event.target.getDialog().getItems();\n\t\t\tdialogItems.forEach((item) => {\n\t\t\t\tif (item.getId() === tag.getId())\n\t\t\t\t{\n\t\t\t\t\ttag.customData = item.getCustomData();\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tthis.$store.commit('setDatasetProperties', {\n\t\t\t\tid: null,\n\t\t\t\tname: event.data.tag.getCustomData().get('datasetName'),\n\t\t\t\tcode: event.data.tag.getId(),\n\t\t\t\tdescription: event.data.tag.getTitle(),\n\t\t\t\texternalCode: event.data.tag.getId(),\n\t\t\t\texternalName: event.data.tag.getTitle(),\n\t\t\t});\n\n\t\t\tthis.$emit('tableSelected', event);\n\t\t\tthis.$emit('validation', true);\n\t\t\tthis.unvalidatedFields = {};\n\t\t},\n\t\tonTableDeselected(event)\n\t\t{\n\t\t\tthis.$store.commit('setConnectionProperties', {\n\t\t\t\tconnectionType: this.selectedConnectionType,\n\t\t\t\tconnectionId: this.selectedConnectionId,\n\t\t\t\ttableName: null,\n\t\t\t});\n\t\t\tthis.$store.commit('setDatasetProperties', {\n\t\t\t\tid: null,\n\t\t\t\tname: null,\n\t\t\t\tcode: null,\n\t\t\t\tdescription: null,\n\t\t\t\texternalCode: null,\n\t\t\t\texternalName: null,\n\t\t\t});\n\t\t\tthis.$emit('tableDeselected', event);\n\t\t\tthis.$emit('validation', false);\n\t\t\tthis.unvalidatedFields = {};\n\t\t},\n\t\topenConnectionSlider()\n\t\t{\n\t\t\tconst link = `/bitrix/components/bitrix/biconnector.externalconnection/slider.php?sourceId=${this.selectedConnectionId}&closeAfterCreate=Y`;\n\t\t\tBX.SidePanel.Instance.open(link, {\n\t\t\t\twidth: 564,\n\t\t\t\tallowChangeHistory: false,\n\t\t\t\tcacheable: false,\n\t\t\t});\n\t\t},\n\t\thandleSliderMessage(event)\n\t\t{\n\t\t\tconst [messageEvent] = event.getData();\n\t\t\tif (messageEvent.getEventId() === 'BIConnector:ExternalConnection:onConnectionSave')\n\t\t\t{\n\t\t\t\tconst connectionProperties = this.$store.getters.connectionProperties;\n\t\t\t\tconnectionProperties.connectionName = Text.decode(messageEvent.data.connection.name);\n\t\t\t\tthis.$store.commit('setConnectionProperties', connectionProperties);\n\t\t\t}\n\t\t},\n\t},\n\tmounted()\n\t{\n\t\tEventEmitter.subscribe('SidePanel.Slider:onMessage', this.handleSliderMessage);\n\t},\n\tbeforeUnmount()\n\t{\n\t\tEventEmitter.unsubscribe('SidePanel.Slider:onMessage', this.handleSliderMessage);\n\t},\n\temits: [\n\t\t'tableSelected',\n\t\t'tableDeselected',\n\t],\n\ttemplate: `\n\t\t<Step\n\t\t\t:title=\"displayedTitle\"\n\t\t\t:hint=\"displayedHint\"\n\t\t\t:is-open-initially=\"isOpenInitially\"\n\t\t\t:disabled=\"disabled\"\n\t\t\tref=\"stepBlock\"\n\t\t>\n\t\t\t<ConnectionSelectorField\n\t\t\t\tv-if=\"!this.isEditMode\"\n\t\t\t\t:options=\"this.connectionSelectorOptions\"\n\t\t\t\tname=\"connections\"\n\t\t\t\t:title=\"this.$Bitrix.Loc.getMessage('DATASET_IMPORT_CONNECTIONS_FIELD_TITLE')\"\n\t\t\t\t:items=\"this.connections\"\n\t\t\t\t:is-disabled=\"disabled\"\n\t\t\t\t:connection-id=\"this.selectedConnectionId\"\n\t\t\t\t@value-change=\"onConnectionSelected\"\n\t\t\t\t@value-clear=\"onConnectionDeselected\"\n\t\t\t\tref=\"connectionField\"\n\t\t\t\t:is-valid=\"unvalidatedFields.connection?.result ?? true\"\n\t\t\t\t:error-message=\"unvalidatedFields.connection?.message ?? ''\"\n\t\t\t/>\n\t\t\t<TableSelectorField\n\t\t\t\tv-if=\"!this.isEditMode\"\n\t\t\t\t:options=\"this.tableSelectorOptions\"\n\t\t\t\tname=\"tables\"\n\t\t\t\t:title=\"this.$Bitrix.Loc.getMessage('DATASET_IMPORT_TABLES_FIELD_TITLE')\"\n\t\t\t\t:connection-id=\"this.selectedConnectionId\"\n\t\t\t\t:is-disabled=\"disabled\"\n\t\t\t\t:selected-connection-type=\"selectedConnectionType\"\n\t\t\t\t@value-change=\"onTableSelected\"\n\t\t\t\t@value-clear=\"onTableDeselected\"\n\t\t\t\tref=\"tableField\"\n\t\t\t/>\n\n\t\t\t<div\n\t\t\t\tv-if=\"this.isEditMode\"\n\t\t\t>\n\t\t\t\t<CustomField\n\t\t\t\t\tname=\"connections\"\n\t\t\t\t\t:title=\"this.$Bitrix.Loc.getMessage('DATASET_IMPORT_CONNECTIONS_FIELD_TITLE')\"\n\t\t\t\t>\n\t\t\t\t\t<template #field-content>\n\t\t\t\t\t\t<div class=\"connection-preview\">\n\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\tclass=\"connection-icon\"\n\t\t\t\t\t\t\t\t:style=\"'background-image: url(\\\\'' + selectedConnectionAvatar + '\\\\');'\"\n\t\t\t\t\t\t\t></div>\n\t\t\t\t\t\t\t<div class=\"connection-name\" @click=\"openConnectionSlider\">\n\t\t\t\t\t\t\t\t{{ this.selectedConnectionName }}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</template>\n\t\t\t\t</CustomField>\n\n\t\t\t\t<StringField\n\t\t\t\t\tname=\"tables\"\n\t\t\t\t\t:title=\"this.$Bitrix.Loc.getMessage('DATASET_IMPORT_TABLES_FIELD_TITLE')\"\n\t\t\t\t\t:is-disabled=\"true\"\n\t\t\t\t\t:defaultValue=\"this.selectedTableName\"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t</Step>\n\t`,\n};\n","import { ajax as Ajax } from 'main.core';\nimport { EventEmitter } from 'main.core.events';\nimport { AppLayout } from '../layout/app-layout';\nimport { ImportConfig } from '../layout/import-config';\nimport { GenericPopup } from '../popups/generic-popup';\nimport { ImportFailurePopup } from '../popups/saving/import-failure-popup';\nimport { ImportProgressPopup } from '../popups/saving/import-progress-popup';\nimport { ImportSuccessPopup } from '../popups/saving/import-success-popup';\nimport { SyncFieldsPopup } from '../popups/sync/sync-fields-popup';\nimport { ConnectionStep } from '../steps/connection';\nimport { DatasetPropertiesStep } from '../steps/dataset-properties';\nimport { FieldsSettingsStep } from '../steps/fields-settings';\nimport { ImportPreview } from '../steps/import-preview';\nimport { BaseApp } from './base-app';\n\nexport const ExternalConnectionApp = {\n\textends: BaseApp,\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tsteps: {\n\t\t\t\tconnection: {\n\t\t\t\t\tdisabled: false,\n\t\t\t\t\tvalid: this.$store.getters.isEditMode,\n\t\t\t\t},\n\t\t\t\tproperties: {\n\t\t\t\t\tdisabled: !this.$store.getters.isEditMode,\n\t\t\t\t\tvalid: true,\n\t\t\t\t},\n\t\t\t\tfields: {\n\t\t\t\t\tdisabled: !this.$store.getters.isEditMode,\n\t\t\t\t\tvalid: true,\n\t\t\t\t\tdisabledElements: null,\n\t\t\t\t},\n\t\t\t},\n\t\t\tshownPopups: {\n\t\t\t\tsavingProgress: false,\n\t\t\t\tsavingSuccess: false,\n\t\t\t\tsavingFailure: false,\n\t\t\t\tloadFailure: false,\n\t\t\t\tsyncFields: false,\n\t\t\t},\n\t\t\tisValidationComplete: true,\n\t\t\tpopupParams: {\n\t\t\t\tsavingSuccess: {},\n\t\t\t\tloadFailure: {\n\t\t\t\t\tmessages: [],\n\t\t\t\t},\n\t\t\t\tsyncFields: {\n\t\t\t\t\tisChange: false,\n\t\t\t\t},\n\t\t\t},\n\t\t\tisLoading: false,\n\t\t\tpreviewError: '',\n\t\t\tpreviewDataLoaded: false,\n\t\t};\n\t},\n\tcomputed: {\n\t\tisRestEntity(): boolean\n\t\t{\n\t\t\treturn this.sourceCode === 'rest';\n\t\t},\n\t\tsourceCode(): string\n\t\t{\n\t\t\treturn this.$store.state.config.connectionProperties?.connectionType ?? '';\n\t\t},\n\t\tisEditMode(): boolean\n\t\t{\n\t\t\treturn this.$store.getters.isEditMode;\n\t\t},\n\t\tloadParams(): Object\n\t\t{\n\t\t\treturn {\n\t\t\t\tdatasetProperties: this.$store.state.config.datasetProperties,\n\t\t\t\tfieldsSettings: this.$store.state.config.fieldsSettings,\n\t\t\t\tdataFormats: this.$store.state.config.dataFormats,\n\t\t\t\ttableName: this.$store.state.config.connectionProperties.tableName,\n\t\t\t\tconnectionType: this.$store.state.config.connectionProperties.connectionType,\n\t\t\t};\n\t\t},\n\t\tsaveParams(): Object\n\t\t{\n\t\t\treturn {\n\t\t\t\tdatasetProperties: this.$store.state.config.datasetProperties,\n\t\t\t\tfieldsSettings: this.$store.state.config.fieldsSettings,\n\t\t\t\tdataFormats: this.$store.state.config.dataFormats,\n\t\t\t\tconnectionSettings: this.$store.state.config.connectionProperties,\n\t\t\t};\n\t\t},\n\t\tisValidatedForSave(): boolean\n\t\t{\n\t\t\treturn this.steps.fields.valid && this.steps.properties.valid && this.steps.connection.valid;\n\t\t},\n\t\timportFailurePopupTitle()\n\t\t{\n\t\t\treturn this.isEditMode ? this.$Bitrix.Loc.getMessage('DATASET_IMPORT_FAILURE_POPUP_HEADER_EDIT') : this.$Bitrix.Loc.getMessage('DATASET_IMPORT_FAILURE_POPUP_HEADER');\n\t\t},\n\t\timportSuccessPopupTitle(): string\n\t\t{\n\t\t\treturn this.isEditMode\n\t\t\t\t? this.$Bitrix.Loc.getMessage('DATASET_IMPORT_SUCCESS_POPUP_HEADER_EDIT').replace('#DATASET_TITLE#', this.popupParams.savingSuccess.title)\n\t\t\t\t: this.$Bitrix.Loc.getMessage('DATASET_IMPORT_SUCCESS_POPUP_HEADER').replace('#DATASET_TITLE#', this.popupParams.savingSuccess.title)\n\t\t\t;\n\t\t},\n\t\timportProgressPopupDescription()\n\t\t{\n\t\t\treturn this.isEditMode\n\t\t\t\t? this.$Bitrix.Loc.getMessage('DATASET_IMPORT_PROGRESS_POPUP_DESCRIPTION_EDIT')\n\t\t\t\t: this.$Bitrix.Loc.getMessage('DATASET_IMPORT_PROGRESS_POPUP_DESCRIPTION');\n\t\t},\n\t\tloadFailurePopupTitle(): string\n\t\t{\n\t\t\treturn this.isEditMode\n\t\t\t\t? this.$Bitrix.Loc.getMessage('DATASET_IMPORT_FILE_ERROR_EDIT_TITLE')\n\t\t\t\t: this.$Bitrix.Loc.getMessage('DATASET_IMPORT_FILE_ERROR_TITLE')\n\t\t\t;\n\t\t},\n\t\tfieldsSettingsStepHint(): string\n\t\t{\n\t\t\tif (this.isEditMode)\n\t\t\t{\n\t\t\t\treturn this.$Bitrix.Loc.getMessage('DATASET_IMPORT_FIELDS_SETTINGS_HINT_EDIT');\n\t\t\t}\n\n\t\t\tlet articleCode = '23508958';\n\t\t\tlet hintCode = 'DATASET_IMPORT_FIELDS_SETTINGS_HINT_EXTERNAL';\n\t\t\tif (this.isRestEntity)\n\t\t\t{\n\t\t\t\tarticleCode = '24486426';\n\t\t\t\thintCode = 'DATASET_IMPORT_FIELDS_SETTINGS_HINT_EXTERNAL_REST';\n\t\t\t}\n\n\t\t\treturn this.$Bitrix.Loc.getMessage(hintCode)\n\t\t\t\t.replace('[link]', '<a onclick=\"top.BX.Helper.show(`redirect=detail&code=' + articleCode + '`)\">')\n\t\t\t\t.replace('[/link]', '</a>')\n\t\t\t;\n\t\t},\n\t\tunsavedChangesPopupTitle(): string\n\t\t{\n\t\t\treturn this.isEditMode\n\t\t\t\t? this.$Bitrix.Loc.getMessage('DATASET_IMPORT_UNSAVED_CHANGES_TITLE_EDIT')\n\t\t\t\t: this.$Bitrix.Loc.getMessage('DATASET_IMPORT_UNSAVED_CHANGES_TITLE_EXTERNAL')\n\t\t\t;\n\t\t},\n\t\tunsavedChangesPopupText(): string\n\t\t{\n\t\t\treturn this.isEditMode\n\t\t\t\t? this.$Bitrix.Loc.getMessage('DATASET_IMPORT_UNSAVED_CHANGES_TEXT_EDIT')\n\t\t\t\t: this.$Bitrix.Loc.getMessage('DATASET_IMPORT_UNSAVED_CHANGES_TEXT_EXTERNAL')\n\t\t\t;\n\t\t},\n\t\temptyStateText(): string\n\t\t{\n\t\t\treturn this.previewDataLoaded\n\t\t\t\t? this.$Bitrix.Loc.getMessage('DATASET_IMPORT_PREVIEW_ERROR_EMPTY_TABLE')\n\t\t\t\t: this.$Bitrix.Loc.getMessage('DATASET_IMPORT_PREVIEW_EMPTY_STATE_EXTERNAL')\n\t\t\t;\n\t\t},\n\t\tsyncFieldsProps(): Object\n\t\t{\n\t\t\treturn {\n\t\t\t\tsupported: this.isEditMode,\n\t\t\t\tdisabled: this.isLoading,\n\t\t\t};\n\t\t},\n\t},\n\tmounted()\n\t{\n\t\tif (\n\t\t\t!this.$store.getters.hasData\n\t\t\t&& this.$store.state.config.connectionProperties?.connectionId\n\t\t\t&& this.$store.state.config.connectionProperties?.tableName\n\t\t)\n\t\t{\n\t\t\tthis.loadDataset();\n\t\t}\n\n\t\tEventEmitter.subscribe('SidePanel.Slider:onMessage', this.onSliderEvent);\n\t},\n\tbeforeUnmount()\n\t{\n\t\tEventEmitter.subscribe('SidePanel.Slider:onMessage', this.onSliderEvent);\n\t},\n\tmethods: {\n\t\tonSliderEvent(event)\n\t\t{\n\t\t\tconst [messageEvent] = event.getData();\n\t\t\tif (messageEvent.getEventId() === 'BIConnector:ExternalConnection:onConnectionSave')\n\t\t\t{\n\t\t\t\tthis.onConnectionCreated();\n\t\t\t}\n\t\t\telse if (messageEvent.getEventId() === 'BIConnector:ExternalConnection:onConnectionCreationError')\n\t\t\t{\n\t\t\t\tthis.onConnectionCreationError();\n\t\t\t}\n\t\t},\n\t\tonConnectionCreated()\n\t\t{\n\t\t\tthis.sendAnalytics({\n\t\t\t\tevent: 'connection',\n\t\t\t\tstatus: 'success',\n\t\t\t});\n\t\t},\n\t\tonConnectionCreationError()\n\t\t{\n\t\t\tthis.sendAnalytics({\n\t\t\t\tevent: 'connection',\n\t\t\t\tstatus: 'error',\n\t\t\t});\n\t\t},\n\t\tonTableSelected()\n\t\t{\n\t\t\tthis.sendConnectionSelectorAnalytics();\n\t\t\tthis.markAsChanged();\n\t\t\tthis.loadDataset();\n\t\t\tthis.$refs.propertiesStep.showValidationErrors();\n\t\t},\n\t\tonTableDeselected()\n\t\t{\n\t\t\tthis.sendConnectionSelectorAnalytics();\n\t\t\tthis.$refs.propertiesStep.close();\n\t\t\tthis.$refs.fieldsStep.close();\n\t\t\tthis.toggleStepState('properties', true);\n\t\t\tthis.toggleStepState('fields', true);\n\t\t\tthis.$store.commit('setPreviewData', []);\n\t\t\tthis.$store.commit('setFieldsSettings', []);\n\t\t\tthis.$refs.propertiesStep.validate();\n\t\t\tthis.previewError = '';\n\t\t\tthis.previewDataLoaded = false;\n\t\t},\n\t\tsendConnectionSelectorAnalytics()\n\t\t{\n\t\t\tif (this.lastChangedStep !== 'connection' && !this.isEditMode)\n\t\t\t{\n\t\t\t\tthis.sendAnalytics({\n\t\t\t\t\tevent: 'creation_start',\n\t\t\t\t\tc_element: 'step_1',\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tthis.lastChangedStep = 'connection';\n\t\t},\n\t\tonDatasetPropertiesChanged()\n\t\t{\n\t\t\tthis.markAsChanged();\n\t\t\tif (this.lastChangedStep !== 'properties' && !this.isEditMode)\n\t\t\t{\n\t\t\t\tthis.sendAnalytics({\n\t\t\t\t\tevent: 'creation_start',\n\t\t\t\t\tc_element: 'step_2',\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tthis.lastChangedStep = 'properties';\n\t\t},\n\t\tonParsingOptionsChanged()\n\t\t{\n\t\t\tthis.markAsChanged();\n\t\t\tthis.loadDataset();\n\t\t},\n\t\tonFieldsChanged()\n\t\t{\n\t\t\tthis.markAsChanged();\n\t\t\tif (this.lastChangedStep !== 'fields' && !this.isEditMode)\n\t\t\t{\n\t\t\t\tthis.sendAnalytics({\n\t\t\t\t\tevent: 'creation_start',\n\t\t\t\t\tc_element: 'step_3',\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tthis.lastChangedStep = 'fields';\n\t\t},\n\t\tloadDataset()\n\t\t{\n\t\t\tthis.isLoading = true;\n\t\t\tAjax.runAction('biconnector.externalsource.dataset.view', {\n\t\t\t\tdata: {\n\t\t\t\t\ttype: this.sourceCode,\n\t\t\t\t\tfields: this.loadParams,\n\t\t\t\t\tsourceId: this.$store.state.config.connectionProperties.connectionId,\n\t\t\t\t},\n\t\t\t})\n\t\t\t\t.then((response) => {\n\t\t\t\t\tthis.isLoading = false;\n\t\t\t\t\tthis.onLoadSuccess(response);\n\t\t\t\t})\n\t\t\t\t.catch((response) => {\n\t\t\t\t\tthis.processLoadResponse(response);\n\t\t\t\t\tthis.isLoading = false;\n\t\t\t\t\tthis.previewError = response.errors[0]?.message ?? this.$Bitrix.Loc.getMessage('DATASET_IMPORT_PREVIEW_ERROR_EXTERNAL');\n\t\t\t\t});\n\t\t},\n\t\tonLoadSuccess(response)\n\t\t{\n\t\t\tthis.processLoadResponse(response);\n\n\t\t\tthis.$refs.propertiesStep.open();\n\t\t\tthis.$refs.fieldsStep.open();\n\t\t\tthis.toggleStepState('properties', false);\n\t\t\tif (this.isRestEntity)\n\t\t\t{\n\t\t\t\tthis.steps.fields.disabledElements = {\n\t\t\t\t\tname: true,\n\t\t\t\t\ttype: true,\n\t\t\t\t};\n\t\t\t}\n\t\t\tthis.toggleStepState('fields', false);\n\t\t\tthis.$refs.propertiesStep.validate();\n\t\t\tthis.$refs.fieldsStep.validate();\n\t\t},\n\t\tprocessLoadResponse(response)\n\t\t{\n\t\t\tconst responseData = response.data;\n\n\t\t\tif (!responseData)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.previewDataLoaded = true;\n\t\t\tif (this.lastChangedStep === 'connection')\n\t\t\t{\n\t\t\t\tconst headers = [];\n\t\t\t\tresponseData.headers.forEach((header, index) => {\n\t\t\t\t\theaders.push(this.prepareHeader(header, index));\n\t\t\t\t});\n\n\t\t\t\tthis.$store.commit('setFieldsSettings', headers);\n\t\t\t}\n\n\t\t\tthis.$store.commit('setPreviewData', responseData.data);\n\t\t},\n\t\tonSyncSuccess(response)\n\t\t{\n\t\t\tthis.processSyncResponse(response);\n\n\t\t\tthis.$refs.propertiesStep.open();\n\t\t\tthis.$refs.fieldsStep.open();\n\t\t\tthis.toggleStepState('properties', false);\n\t\t\tthis.toggleStepState('fields', false);\n\t\t\tthis.$refs.propertiesStep.validate();\n\t\t\tthis.$refs.fieldsStep.validate();\n\t\t},\n\t\tprocessSyncResponse(response)\n\t\t{\n\t\t\tconst responseData = response.data;\n\t\t\tif (responseData)\n\t\t\t{\n\t\t\t\tthis.previewDataLoaded = true;\n\t\t\t\tconst headers = [];\n\t\t\t\tresponseData.headers.forEach((header, index) => {\n\t\t\t\t\theaders.push(this.prepareHeader(header, index));\n\t\t\t\t});\n\n\t\t\t\tthis.$store.commit('setFieldsSettings', headers);\n\t\t\t\tthis.$store.commit('setPreviewData', responseData.data);\n\t\t\t}\n\n\t\t\tthis.sendAnalytics({\n\t\t\t\tevent: 'sync_fields',\n\t\t\t\tstatus: response.status,\n\t\t\t});\n\t\t},\n\t\tprepareHeader(header, index)\n\t\t{\n\t\t\tconst result = {\n\t\t\t\tvisible: header.visible,\n\t\t\t\ttype: header.type,\n\t\t\t\tname: header.name && header.name.length > 0 ? header.name : `FIELD_${index}`,\n\t\t\t\toriginalType: header.type,\n\t\t\t\toriginalName: header.externalCode,\n\t\t\t\texternalCode: header.externalCode,\n\t\t\t};\n\n\t\t\tif (header.id)\n\t\t\t{\n\t\t\t\tresult.id = header.id;\n\t\t\t}\n\n\t\t\treturn result;\n\t\t},\n\t\tonSaveStart(): Promise\n\t\t{\n\t\t\tif (!this.isValidatedForSave)\n\t\t\t{\n\t\t\t\tthis.$refs.fieldsStep.showValidationErrors();\n\t\t\t\tthis.$refs.propertiesStep.showValidationErrors();\n\n\t\t\t\treturn Promise.reject();\n\t\t\t}\n\n\t\t\tthis.togglePopup('savingProgress', true);\n\n\t\t\treturn Promise.resolve();\n\t\t},\n\t\tonSaveEnd(response)\n\t\t{\n\t\t\tconst datasetName = response.data.name ?? this.$store.state.config.datasetProperties.name;\n\t\t\tconst datasetId = response.data.id ?? this.$store.state.config.datasetProperties.id;\n\t\t\tthis.popupParams.savingSuccess = {\n\t\t\t\ttitle: datasetName,\n\t\t\t\tdatasetId,\n\t\t\t\tlink: response.data.url,\n\t\t\t};\n\n\t\t\tthis.togglePopup('savingProgress', false);\n\t\t\tthis.togglePopup('savingSuccess', true);\n\t\t\tthis.isChanged = false;\n\t\t\tthis.sendAnalytics({\n\t\t\t\tevent: this.isEditMode ? 'dataset_editing' : 'creation_end',\n\t\t\t\tstatus: 'success',\n\t\t\t\tp1: `datasetName_${datasetName.replaceAll('_', '')}`,\n\t\t\t});\n\t\t\tBX.SidePanel.Instance.postMessage(window, 'BIConnector.dataset-import:onDatasetCreated', {});\n\t\t},\n\t\tonSaveError()\n\t\t{\n\t\t\tthis.togglePopup('savingProgress', false);\n\t\t\tthis.togglePopup('savingFailure', true);\n\t\t\tthis.sendAnalytics({\n\t\t\t\tevent: this.isEditMode ? 'dataset_editing' : 'creation_end',\n\t\t\t\tstatus: 'error',\n\t\t\t});\n\t\t\tBX.SidePanel.Instance.postMessage(window, 'BIConnector.dataset-import:onDatasetCreated', {});\n\t\t},\n\t\tonSuccessPopupClose()\n\t\t{\n\t\t\tthis.togglePopup('savingSuccess', false);\n\t\t\tthis.closeApp();\n\t\t},\n\t\tcloseFailurePopup()\n\t\t{\n\t\t\tthis.togglePopup('savingFailure', false);\n\t\t},\n\t\tonSyncFields()\n\t\t{\n\t\t\tthis.isLoading = true;\n\t\t\tAjax.runAction('biconnector.externalsource.dataset.syncField', {\n\t\t\t\tdata: {\n\t\t\t\t\tid: this.datasetId,\n\t\t\t\t},\n\t\t\t})\n\t\t\t\t.then((response) => {\n\t\t\t\t\tthis.isLoading = false;\n\t\t\t\t\tthis.onSyncSuccess(response);\n\t\t\t\t\tthis.popupParams.syncFields.isChange = response.data.isChanged;\n\t\t\t\t\tthis.togglePopup('syncFields', true);\n\t\t\t\t})\n\t\t\t\t.catch((response) => {\n\t\t\t\t\tthis.isLoading = false;\n\t\t\t\t\tthis.processSyncResponse(response);\n\t\t\t\t\tthis.previewError = response.errors[0]?.message ?? this.$Bitrix.Loc.getMessage('DATASET_IMPORT_PREVIEW_ERROR_EXTERNAL');\n\t\t\t\t});\n\t\t},\n\t},\n\tcomponents: {\n\t\tAppLayout,\n\t\tImportConfig,\n\t\tImportPreview,\n\t\tConnectionStep,\n\t\tDatasetPropertiesStep,\n\t\tFieldsSettingsStep,\n\t\tImportProgressPopup,\n\t\tImportSuccessPopup,\n\t\tImportFailurePopup,\n\t\tSyncFieldsPopup,\n\t\tGenericPopup,\n\t},\n\t// language=Vue\n\ttemplate: `\n\t\t<AppLayout\n\t\t\tref=\"appLayout\"\n\t\t\t:save-locked=\"!isSaveEnabled\"\n\t\t\t:is-edit-mode=\"isEditMode\"\n\t\t>\n\t\t\t<template v-slot:left-panel>\n\t\t\t\t<ImportConfig>\n\t\t\t\t\t<ConnectionStep\n\t\t\t\t\t\t:disabled=\"steps.connection.disabled\"\n\t\t\t\t\t\t:connections=\"appParams.connections\"\n\t\t\t\t\t\tref=\"connectionsStep\"\n\t\t\t\t\t\t@table-selected=\"onTableSelected\"\n\t\t\t\t\t\t@table-deselected=\"onTableDeselected\"\n\t\t\t\t\t\t@validation=\"onStepValidation('connection', $event)\"\n\t\t\t\t\t/>\n\t\t\t\t\t<DatasetPropertiesStep\n\t\t\t\t\t\t:is-open-initially=\"isEditMode\"\n\t\t\t\t\t\t:disabled=\"steps.properties.disabled\"\n\t\t\t\t\t\t:reserved-names=\"appParams.reservedNames\"\n\t\t\t\t\t\t:name-max-length=230\n\t\t\t\t\t\tref=\"propertiesStep\"\n\t\t\t\t\t\t@validation=\"onStepValidation('properties', $event)\"\n\t\t\t\t\t\t@properties-changed=\"onDatasetPropertiesChanged\"\n\t\t\t\t\t\t:dataset-source-code=\"'external_' + sourceCode\"\n\t\t\t\t\t/>\n\t\t\t\t\t<FieldsSettingsStep\n\t\t\t\t\t\t:is-open-initially=\"isEditMode\"\n\t\t\t\t\t\t:disabled=\"steps.fields.disabled\"\n\t\t\t\t\t\t:disabled-elements=\"steps.fields.disabledElements\"\n\t\t\t\t\t\tref=\"fieldsStep\"\n\t\t\t\t\t\t@validation=\"onStepValidation('fields', $event)\"\n\t\t\t\t\t\t@parsing-options-changed=\"onParsingOptionsChanged\"\n\t\t\t\t\t\t@settings-changed=\"onFieldsChanged\"\n\t\t\t\t\t\t:hint=\"fieldsSettingsStepHint\"\n\t\t\t\t\t\t:sync-fields-props=\"syncFieldsProps\"\n\t\t\t\t\t\t@sync-fields=\"onSyncFields\"\n\t\t\t\t\t/>\n\t\t\t\t</ImportConfig>\n\t\t\t</template>\n\t\t\t<template v-slot:right-panel>\n\t\t\t\t<ImportPreview \n\t\t\t\t\t:empty-state-text=\"emptyStateText\"\n\t\t\t\t\t:is-loading=\"isLoading\"\n\t\t\t\t\t:error=\"previewError\"\n\t\t\t\t\t:needShowHeadersWithEmptyRows=\"true\"\n\t\t\t\t/>\n\t\t\t</template>\n\t\t</AppLayout>\n\n\t\t<ImportProgressPopup\n\t\t\tv-if=\"shownPopups.savingProgress\"\n\t\t\t:description=\"importProgressPopupDescription\"\n\t\t/>\n\n\t\t<ImportSuccessPopup\n\t\t\tv-if=\"shownPopups.savingSuccess\"\n\t\t\t@close=\"onSuccessPopupClose\"\n\t\t\t@click=\"closeApp\"\n\t\t\t:title=\"importSuccessPopupTitle\"\n\t\t\t:description=\"''\"\n\t\t\t:dataset-id=\"popupParams.savingSuccess.datasetId\"\n\t\t\t:dataset-link=\"popupParams.savingSuccess.link\"\n\t\t\t:show-more-button=\"!isEditMode\"\n\t\t\t@one-more-click=\"reload\"\n\t\t/>\n\n\t\t<ImportFailurePopup\n\t\t\tv-if=\"shownPopups.savingFailure\"\n\t\t\t@close=\"closeFailurePopup\"\n\t\t\t@click=\"closeFailurePopup\"\n\t\t\t:title=\"importFailurePopupTitle\"\n\t\t\t:description=\"$Bitrix.Loc.getMessage('DATASET_IMPORT_EXTERNAL_FAILURE_POPUP_DESCRIPTION').replace('[link]', '<a>').replace('[/link]', '</a>')\"\n\t\t/>\n\n\t\t<GenericPopup\n\t\t\tv-if=\"shownPopups.loadFailure\"\n\t\t\t:title=\"loadFailurePopupTitle\"\n\t\t\t@close=\"togglePopup('loadFailure')\"\n\t\t>\n\t\t\t<template v-slot:content>\n\t\t\t\t<p v-for=\"message in popupParams.loadFailure.messages\">\n\t\t\t\t\t{{ message }}\n\t\t\t\t</p>\n\t\t\t</template>\n\t\t\t<template v-slot:buttons>\n\t\t\t\t<button @click=\"togglePopup('loadFailure')\" class=\"ui-btn ui-btn-md ui-btn-primary\">{{ $Bitrix.Loc.getMessage('DATASET_IMPORT_FILE_ERROR_POPUP_CLOSE') }}</button>\n\t\t\t</template>\n\t\t</GenericPopup>\n\n\t\t<SyncFieldsPopup\n\t\t\tv-if=\"shownPopups.syncFields\"\n\t\t\t:is-change=\"popupParams.syncFields.isChange\"\n\t\t\t@close=\"togglePopup('syncFields', false)\"\n\t\t>\n\t\t</SyncFieldsPopup>\n\t`,\n};\n","/* eslint-disable no-param-reassign */\nimport { createStore } from 'ui.vue3.vuex';\nimport type { AppStateOptions, ConnectionProperties } from '../types/app-state-options';\n\nexport class Store\n{\n\tstatic buildStore(defaultValues: AppStateOptions)\n\t{\n\t\treturn createStore({\n\t\t\tstate()\n\t\t\t{\n\t\t\t\treturn defaultValues;\n\t\t\t},\n\t\t\tmutations: {\n\t\t\t\tsetFileProperties(state, fileProperties)\n\t\t\t\t{\n\t\t\t\t\tstate.config.fileProperties = fileProperties;\n\t\t\t\t},\n\t\t\t\tsetConnectionProperties(state, connectionProperties)\n\t\t\t\t{\n\t\t\t\t\tstate.config.connectionProperties = connectionProperties;\n\t\t\t\t},\n\t\t\t\tsetDatasetProperties(state, datasetProperties)\n\t\t\t\t{\n\t\t\t\t\tstate.config.datasetProperties = datasetProperties;\n\t\t\t\t},\n\t\t\t\ttoggleRowVisibility(state, rowIndex)\n\t\t\t\t{\n\t\t\t\t\tstate.config.fieldsSettings[rowIndex].visible = !state.config.fieldsSettings[rowIndex].visible;\n\t\t\t\t},\n\t\t\t\tsetAllRowsVisible(state)\n\t\t\t\t{\n\t\t\t\t\tstate.config.fieldsSettings = state.config.fieldsSettings.map((field) => {\n\t\t\t\t\t\tfield.visible = true;\n\n\t\t\t\t\t\treturn field;\n\t\t\t\t\t});\n\t\t\t\t},\n\t\t\t\tsetAllRowsInvisible(state)\n\t\t\t\t{\n\t\t\t\t\tstate.config.fieldsSettings = state.config.fieldsSettings.map((field) => {\n\t\t\t\t\t\tfield.visible = false;\n\n\t\t\t\t\t\treturn field;\n\t\t\t\t\t});\n\t\t\t\t},\n\t\t\t\tsetFieldRowSettings(state, payload)\n\t\t\t\t{\n\t\t\t\t\tstate.config.fieldsSettings[payload.index] = payload.settings;\n\t\t\t\t},\n\t\t\t\tsetDataFormats(state, formats)\n\t\t\t\t{\n\t\t\t\t\tstate.config.dataFormats = formats;\n\t\t\t\t},\n\t\t\t\tsetPreviewData(state, data)\n\t\t\t\t{\n\t\t\t\t\tstate.previewData.rows = data;\n\t\t\t\t},\n\t\t\t\tsetFieldsSettings(state, settings)\n\t\t\t\t{\n\t\t\t\t\tstate.config.fieldsSettings = settings;\n\t\t\t\t},\n\t\t\t},\n\t\t\tgetters: {\n\t\t\t\tisEditMode(state)\n\t\t\t\t{\n\t\t\t\t\treturn state.config.datasetProperties.id > 0;\n\t\t\t\t},\n\t\t\t\tareAllRowsVisible(state)\n\t\t\t\t{\n\t\t\t\t\treturn state.config.fieldsSettings.filter((field) => !(field.visible)).length === 0;\n\t\t\t\t},\n\t\t\t\tareNoRowsVisible(state)\n\t\t\t\t{\n\t\t\t\t\treturn state.config.fieldsSettings.filter((field) => (field.visible)).length === 0;\n\t\t\t\t},\n\t\t\t\tareSomeRowsVisible(state, getters)\n\t\t\t\t{\n\t\t\t\t\treturn !getters.areAllRowsVisible && !getters.areNoRowsVisible;\n\t\t\t\t},\n\t\t\t\tcolumnVisibilityMap(state)\n\t\t\t\t{\n\t\t\t\t\tconst map = [];\n\t\t\t\t\tstate.config.fieldsSettings.forEach((field) => {\n\t\t\t\t\t\tmap.push(Boolean(field.visible));\n\t\t\t\t\t});\n\n\t\t\t\t\treturn map;\n\t\t\t\t},\n\t\t\t\tpreviewHeaders(state)\n\t\t\t\t{\n\t\t\t\t\treturn state.config.fieldsSettings.map((item) => item.name);\n\t\t\t\t},\n\t\t\t\thasData(state)\n\t\t\t\t{\n\t\t\t\t\treturn state.previewData?.rows?.length > 0;\n\t\t\t\t},\n\t\t\t\tconnectionProperties(state): ConnectionProperties\n\t\t\t\t{\n\t\t\t\t\treturn state.config?.connectionProperties;\n\t\t\t\t},\n\t\t\t\tdatasetProperties(state)\n\t\t\t\t{\n\t\t\t\t\treturn state.config?.datasetProperties;\n\t\t\t\t},\n\t\t\t},\n\t\t});\n\t}\n}\n","import { BitrixVue } from 'ui.vue3';\nimport type { AppStateOptions } from '../types/app-state-options';\nimport type { DataFormatTemplate } from '../types/data-types';\nimport { CsvApp } from './csv-app';\nimport { ExternalConnectionApp } from './external-connection-app';\nimport { Store } from './store';\n\nconst codeMap = {\n\tcsv: CsvApp,\n\t'1c': ExternalConnectionApp,\n\trest: ExternalConnectionApp,\n};\n\ntype AppParams = {\n\tdataFormatTemplates: DataFormatTemplate,\n\tencodings: Array,\n\tseparators: Array,\n\treservedNames: Array,\n\tconnections: Array,\n};\n\nexport class AppFactory\n{\n\tstatic getApp(code: string, stateOptions: AppStateOptions = {}, appParams: AppParams = {})\n\t{\n\t\tconst defaultStructure = {\n\t\t\tpreviewData: {},\n\t\t\tconfig: {\n\t\t\t\tfileProperties: {},\n\t\t\t\tdataFormats: {},\n\t\t\t\tdatasetProperties: {},\n\t\t\t\tfieldsSettings: [],\n\t\t\t},\n\t\t};\n\n\t\tconst state = BX.util.objectMerge(defaultStructure, stateOptions);\n\n\t\tlet app = null;\n\n\t\tconst appComponent = codeMap[code];\n\n\t\tif (appComponent)\n\t\t{\n\t\t\tapp = BitrixVue.createApp({\n\t\t\t\tname: 'DatasetImport',\n\t\t\t\tdata()\n\t\t\t\t{\n\t\t\t\t\treturn {\n\t\t\t\t\t\tappParams,\n\t\t\t\t\t};\n\t\t\t\t},\n\t\t\t\tcomponents: {\n\t\t\t\t\tappComponent,\n\t\t\t\t},\n\t\t\t\tcomputed: {\n\t\t\t\t\tcomponentName()\n\t\t\t\t\t{\n\t\t\t\t\t\treturn appComponent;\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\t// language=Vue\n\t\t\t\ttemplate: `\n\t\t\t\t\t<component :is=\"componentName\" :app-params=\"appParams\" />\n\t\t\t\t`,\n\t\t\t});\n\t\t}\n\n\t\tif (app)\n\t\t{\n\t\t\tconst store = Store.buildStore(state);\n\n\t\t\tapp.use(store);\n\t\t}\n\n\t\treturn app;\n\t}\n}\n","import { Uri } from 'main.core';\nimport { SidePanel } from 'ui.sidepanel';\n\nexport class Slider\n{\n\tstatic open(sourceId: string, datasetId: ?number = 0, connection: ?Object = {}): void\n\t{\n\t\tconst componentLink = '/bitrix/components/bitrix/biconnector.dataset.import/slider.php';\n\n\t\tconst sliderLink = new Uri(componentLink);\n\t\tsliderLink.setQueryParam('sourceId', sourceId);\n\t\tif (datasetId)\n\t\t{\n\t\t\tsliderLink.setQueryParam('datasetId', datasetId);\n\t\t}\n\n\t\tif (Object.keys(connection).length > 0)\n\t\t{\n\t\t\tsliderLink.setQueryParam('connection', connection);\n\t\t}\n\n\t\tconst options = {\n\t\t\tallowChangeHistory: false,\n\t\t\tcacheable: false,\n\t\t\tcustomLeftBoundary: 0,\n\t\t};\n\n\t\tSidePanel.Instance.open(\n\t\t\tsliderLink.toString(),\n\t\t\toptions,\n\t\t);\n\t}\n}\n"],"names":["AppLayout","props","saveLocked","type","Boolean","required","default","isEditMode","computed","saveButtonClass","saveButtonText","$Bitrix","Loc","getMessage","mounted","Dom","addClass","document","querySelector","buttonsPanel","$refs","$root","$el","parentNode","appendChild","BX","UI","Pinner","fixBottom","fullWidth","methods","onCreateButtonClick","eventEmitter","emit","onCancelButtonClick","template","ImportConfig","Popup","emits","id","String","options","Object","wrapperClass","data","popupInstance","popupOptions","content","autoHide","events","onPopupClose","closePopup","onPopupDestroy","fixed","PopupManager","getPopupById","destroy","$emit","MainPopup","show","beforeUnmount","FileErrorsPopup","errors","Array","isSavingMode","reportDownloadLink","width","closeIcon","noAllPaddings","overlay","title","length","hintContent","prepareHintContent","errorsCountText","replace","onClose","onIgnoreErrorsClick","onDownloadLogButtonClick","downloadLogButton","setState","ButtonState","WAITING","downloadLog","Ajax","runAction","fields","$store","state","config","then","response","blob","Blob","window","URL","createObjectURL","catch","link","createElement","href","download","datasetProperties","name","append","body","click","remove","phraseCode","message","Button","size","ButtonSize","EXTRA_SMALL","color","ButtonColor","LIGHT","noCaps","onclick","text","className","renderTo","summaryBlock","revokeObjectURL","components","CheckingProgressPopup","background","loader","Loader","target","strokeWidth","mode","CheckingSuccessPopup","CheckingFailedPopup","GenericPopup","SavingPopup","description","minHeight","ImportFailurePopup","onClick","SaveProgressPopup","ImportProgressPopup","ImportSuccessPopup","datasetId","Number","showMoreButton","onButtonClick","openDatasetButton","open","focus","removeClass","onOneMoreButtonClick","oneMoreButton","StepHint","hintClass","StepBlock","section","hint","isOpenInitially","canCollapse","disabled","customClasses","additionalClasses","custom","reduce","acc","key","toggleCollapse","toggle","contentContainer","Section","isOpen","watch","newValue","getContent","innerHTML","Text","encode","BaseStep","disabledElements","displayedTitle","defaultTitle","displayedHint","defaultHint","stepBlock","close","validate","showValidationErrors","Step","ErrorPopup","create","element","Tag","render","bindElement","darkMode","bindOptions","position","angle","cacheable","setOptions","angleMinBottom","BaseField","defaultValue","placeholder","isValid","errorMessage","isDisabled","hintText","value","areValidationErrorsShown","onInputChange","fieldName","StringField","extends","errorPopup","errorPopupTimeout","onInput","event","onBlur","showErrorHint","setTimeout","hideErrorHint","clearTimeout","isDestroyed","createErrorPopup","errorIconWrapper","Hint","createNode","TextField","DatasetProperties","defaultName","defaultDescription","unvalidatedFields","disabledFields","datasetSourceCode","onValueChange","nameField","DatasetPropertiesStep","reservedNames","nameMaxLength","getters","result","nameValidationResult","validateName","onDatasetPropertiesFieldsChange","commit","keys","isReserved","includes","test","TableHeader","enabled","indeterminate","isNeedShowOriginalNameHint","fileProperties","firstLineHeader","onCheckboxClick","preventDefault","DataType","string","money","int","double","date","datetime","DataTypeDescriptions","icon","DataTypeMenu","constructor","selectedType","onSelect","getMenu","items","entries","forEach","push","html","item","getMenuWindow","Menu","DataTypeSelector","canEdit","typeMenu","isFocused","iconClass","typeTitle","isEditable","getPopupWindow","setWidth","formatButton","offsetWidth","createMenu","destroyMenu","TableRow","directives","index","fieldSettings","invalidFields","displayedValidationErrors","isNameValid","displayedErrorForName","set","Set","originalsHintText","originalType","originalName","typeText","nameText","connectionProperties","connectionType","hintOptions","offsetLeft","offsetTop","onTypeSelected","onFieldInput","input","onFieldBlur","field","originalsHint","DataTypeButton","BIcon","FormatTable","fieldsSettings","unvalidatedRows","areAllRowsVisible","areNoRowsVisible","areSomeRowsVisible","onRowCheckboxClicked","onHeaderCheckboxClicked","onRowFieldChanged","rowIndices","row","SyncFieldsButton","FieldsSettingsStep","syncFieldsProps","supported","rows","isSyncSupported","isSyncDisabled","isNotEmpty","isTooLong","areCharactersValid","isAlreadyUsed","previewHeaders","count","onRowToggled","onHeaderToggled","settings","formatTable","OptionType","CUSTOM","VALUE","FormatSelector","openSlider","selected","dataFormatTemplates","SidePanel","Instance","contentCallback","Layout","createContent","extensions","buttons","cancelButton","SaveButton","form","getTopSlider","getContainer","formData","FormData","fromEntries","customFieldsToExtract","formRoot","subtitle","fieldType","selectRoot","isCustomSelected","customElement","customOptionInput","option","optionElement","isSelected","Event","bind","setAttribute","SliderButton","SwitcherField","Switcher","node","switcher","SwitcherSize","small","checked","handlers","toggled","CustomField","DropdownField","FileUploader","FileUploadWidget","defaultEncoding","defaultSeparator","defaultFirstLineHeader","encodings","separators","inputElement","uploaderOptions","controller","controllerOptions","multiple","acceptOnlyImages","maxFileSize","autoUpload","acceptedFileTypes","onUploadComplete","onFileRemoved","onError","onUploadError","widgetOptions","file","uploader","getFiles","isComplete","getServerFileId","getName","openDataFormatSlider","dataFormats","selectedFormats","FileStep","isErrorDisplayed","fileValidationResult","validateFile","onFilePropertiesChange","onParsingOptionsChanged","fileToken","fileUploader","AppSection","headers","columnVisibility","visibleHeaders","filter","_","visibleValues","PreviewTable","displayedColumnVisibility","debouncedRefresh","debounce","refreshColumns","ears","Ears","container","smallSize","noScrollbar","init","newVisibility","table","oldValue","ImportPreview","emptyStateText","error","isLoading","needShowHeadersWithEmptyRows","previewData","isEverythingHidden","hasData","hasHeaders","displayedEmptyStateText","displayedEverythingHiddenText","columnVisibilityMap","isErrorInEditMode","isEditModeInitialDataDisplayed","hasDataDisplayedHint","loadingAnchor","BaseApp","appParams","steps","shownPopups","isChanged","isSaveComplete","lastChangedStep","sourceCode","loadParams","saveParams","isSaveEnabled","isValidatedForSave","previewError","unsavedChangesPopupTitle","unsavedChangesPopupText","subscribe","onSaveButtonClick","slider","top","addCustomEvent","onSliderClose","addEventListener","removeCustomEvent","unsubscribe","markAsChanged","sendAnalytics","status","denyAction","continueButton","PRIMARY","popup","closeButton","LINK","closeApp","popupHeader","popupText","toggleStepState","step","Type","isNull","togglePopup","shown","loadDataset","onLoadSuccess","onLoadError","onStepValidation","validationResult","valid","onSaveStart","handleSaveAction","updateDataset","saveDataset","onSaveEnd","onSaveError","Promise","resolve","onLoadStart","reload","location","params","sendData","getBaseAnalyticsParams","tool","c_section","category","toUpperCase","CsvApp","properties","savingProgress","savingSuccess","savingFailure","editModeFileReplacement","checkFileProgress","checkFileSuccess","checkFileFailure","fileErrors","isValidationComplete","popupParams","lastReloadSource","initialPreviewData","initialFieldsSettings","isEditModeSaveConfirmed","isDataLoadingAnimationDisplayed","hasMinimalLoadingAnimationTimePassed","checkFileErrors","isErrorsChecked","exportDownloadLink","importFailurePopupTitle","importSuccessPopupTitle","importSuccessPopupDescription","fileName","importProgressPopupDescription","onDatasetPropertiesChanged","c_element","p1","replaceAll","onFieldsSettingsChanged","onDatasetReloadNeeded","reloadSource","startPreviewLoadingAnimation","propertiesStep","fieldsStep","toggleCheckFileButton","processLoadResponse","responseData","header","prepareHeader","visible","externalCode","stopPreviewLoadingAnimation","fileStep","reject","checkFile","datasetName","postMessage","onSuccessPopupClose","closeFailurePopup","onReplacementButtonClick","onCheckFileClick","onExportFileClick","button","attr","FileExport","getInstance","saveIgnoringErrors","prepareCheckFileErrors","console","lineNumber","columnName","customData","EventEmitter","SyncFieldsPopup","isChange","getDescription","ConnectionSelectorField","connectionId","selector","TagSelector","selectorId","addButtonCaption","addButtonCaptionMore","dialogOptions","preparedItems","enableSearch","dropdownMode","showAvatars","compactView","height","tabs","stubOptions","arrow","iconOpacity","entities","onTagAdd","onTagRemove","getDialog","footer","allowChangeHistory","getTab","setFooter","messageEvent","getData","getEventId","onConnectionSave","selectorItems","itemOptions","ID","TITLE","entityId","linkTitle","TYPE","AVATAR","avatar","toString","connection","isStringFilled","dialog","getItem","setTitle","decode","removeTags","deselect","select","addItem","hide","TableSelectorField","selectedConnectionType","hasErrors","dynamicLoad","stub","dynamicSearch","onSearch","setLocked","hintCode","offset","newConnectionId","removeItems","getEntity","getTarget","tableTab","getStub","selectTab","setStub","ConnectionStep","connections","tableId","connectionSelectorId","tableSelectorId","connectionSelectorOptions","tableSelectorOptions","selectedConnectionAvatar","selectedConnectionId","find","parseFloat","selectedConnectionName","connectionName","selectedTableName","tableName","onConnectionSelected","tag","dialogItems","getItems","getId","getCustomData","sourceId","parseInt","get","onConnectionDeselected","onTableSelected","getTitle","code","externalName","onTableDeselected","openConnectionSlider","handleSliderMessage","ExternalConnectionApp","loadFailure","syncFields","messages","previewDataLoaded","isRestEntity","connectionSettings","loadFailurePopupTitle","fieldsSettingsStepHint","articleCode","onSliderEvent","onConnectionCreated","onConnectionCreationError","sendConnectionSelectorAnalytics","onFieldsChanged","onSyncSuccess","processSyncResponse","url","onSyncFields","Store","buildStore","defaultValues","createStore","mutations","setFileProperties","setConnectionProperties","setDatasetProperties","toggleRowVisibility","rowIndex","setAllRowsVisible","map","setAllRowsInvisible","setFieldRowSettings","payload","setDataFormats","formats","setPreviewData","setFieldsSettings","codeMap","csv","rest","AppFactory","getApp","stateOptions","defaultStructure","util","objectMerge","app","appComponent","BitrixVue","createApp","componentName","store","use","Slider","componentLink","sliderLink","Uri","setQueryParam","customLeftBoundary"],"mappings":"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"}