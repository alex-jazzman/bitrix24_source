{"version":3,"file":"dataset-import.bundle.js","sources":["../src/layout/app-layout.js","../src/layout/import-config.js","../src/layout/popup.js","../src/popups/file-checking/file-errors-popup.js","../src/popups/file-checking/checking-progress-popup.js","../src/popups/file-checking/checking-success-popup.js","../src/popups/file-checking/checking-failed-popup.js","../src/popups/generic-popup.js","../src/popups/saving/saving-popup.js","../src/popups/saving/import-failure-popup.js","../src/popups/saving/import-progress-popup.js","../src/popups/saving/import-success-popup.js","../src/layout/step-hint.js","../src/layout/step-block.js","../src/steps/base-step.js","../src/layout/error-popup.js","../src/fields/type/base-field.js","../src/fields/type/string-field.js","../src/fields/type/text-field.js","../src/fields/dataset-properties.js","../src/steps/dataset-properties.js","../src/steps/data-type/table-header.js","../src/types/data-types.js","../src/steps/data-type/data-type-menu.js","../src/steps/data-type/data-type-selector.js","../src/steps/data-type/table-row.js","../src/steps/data-type/format-table.js","../src/steps/data-type/sync-fields-button.js","../src/steps/fields-settings.js","../src/steps/data-type/format-selector.js","../src/steps/data-type/slider-button.js","../src/fields/type/switcher-field.js","../src/fields/type/custom-field.js","../src/fields/type/dropdown-field.js","../src/fields/file/file-uploader.js","../src/steps/file.js","../src/layout/app-section.js","../src/steps/import-preview/table-header.js","../src/steps/import-preview/table-row.js","../src/steps/import-preview/preview-table.js","../src/steps/import-preview.js","../src/app/base-app.js","../src/app/csv-app.js","../src/popups/sync/sync-fields-popup.js","../src/fields/type/connection-selector-field.js","../src/fields/type/table-selector-field.js","../src/steps/connection.js","../src/app/external-connection-app.js","../src/app/store.js","../src/app/app-factory.js","../src/app/slider.js"],"sourcesContent":["import 'ui.pinner';\n\nimport '../css/app-layout.css';\nimport { Dom } from 'main.core';\n\nexport const AppLayout = {\n\tprops: {\n\t\tsaveLocked: {\n\t\t\ttype: Boolean,\n\t\t\trequired: false,\n\t\t\tdefault: false,\n\t\t},\n\t\tisEditMode: {\n\t\t\ttype: Boolean,\n\t\t\trequired: false,\n\t\t\tdefault: false,\n\t\t},\n\t},\n\tcomputed: {\n\t\tsaveButtonClass()\n\t\t{\n\t\t\treturn {\n\t\t\t\t'ui-btn-base-light': this.saveLocked,\n\t\t\t\t'app-root__button--blocked': this.saveLocked,\n\t\t\t\t'ui-btn-success': !this.saveLocked,\n\t\t\t};\n\t\t},\n\t\tsaveButtonText()\n\t\t{\n\t\t\treturn this.isEditMode\n\t\t\t\t? this.$Bitrix.Loc.getMessage('DATASET_IMPORT_SAVE')\n\t\t\t\t: this.$Bitrix.Loc.getMessage('DATASET_IMPORT_CREATE');\n\t\t},\n\t},\n\tmounted()\n\t{\n\t\tDom.addClass(document.querySelector('body'), 'app-body');\n\n\t\tconst buttonsPanel = this.$refs.buttonsPanel;\n\t\tif (buttonsPanel)\n\t\t{\n\t\t\tthis.$root.$el.parentNode.appendChild(buttonsPanel);\n\t\t\tnew BX.UI.Pinner(\n\t\t\t\tbuttonsPanel,\n\t\t\t\t{\n\t\t\t\t\tfixBottom: true,\n\t\t\t\t\tfullWidth: true,\n\t\t\t\t},\n\t\t\t);\n\t\t}\n\t},\n\tmethods: {\n\t\tonCreateButtonClick()\n\t\t{\n\t\t\tthis.$Bitrix.eventEmitter.emit('biconnector:dataset-import:createButtonClick', {});\n\t\t},\n\t\tonCancelButtonClick()\n\t\t{\n\t\t\tthis.$Bitrix.eventEmitter.emit('biconnector:dataset-import:cancelButtonClick', {});\n\t\t},\n\t},\n\t// language=Vue\n\ttemplate: `\n\t\t<div class=\"app\">\n\t\t\t<div class=\"app__block app__block--narrow\">\n\t\t\t\t<slot name=\"left-panel\"></slot>\n\t\t\t</div>\n\t\t\t<div class=\"app__block\">\n\t\t\t\t<slot name=\"right-panel\"></slot>\n\t\t\t</div>\n\t\n\t\t\t<div class=\"ui-button-panel-wrapper\" ref=\"buttonsPanel\">\n\t\t\t\t<div class=\"ui-button-panel\">\n\t\t\t\t\t<div class=\"app-root__button-wrapper\" :class=\"saveLocked ? 'app-root__button-wrapper--blocked' : ''\">\n\t\t\t\t\t\t<button class=\"ui-btn ui-btn-md app-root__button\" :class=\"saveButtonClass\" @click=\"onCreateButtonClick\" ref=\"saveButton\">\n\t\t\t\t\t\t\t{{ saveButtonText }}\n\t\t\t\t\t\t</button>\n\t\t\t\t\t</div>\n\t\t\t\t\t<button class=\"ui-btn ui-btn-md ui-btn-link app-root__button\" @click=\"onCancelButtonClick\">\n\t\t\t\t\t\t{{ $Bitrix.Loc.getMessage('DATASET_IMPORT_CANCEL') }}\n\t\t\t\t\t</button>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import '../css/import-config.css';\n\nexport const ImportConfig = {\n\t// language=Vue\n\ttemplate: `\n\t\t<div class=\"import-config\">\n\t\t\t<slot></slot>\n\t\t</div>\n\t`,\n};\n","import { Popup as MainPopup, PopupManager } from 'main.popup';\n\nexport const Popup = {\n\temits: ['close'],\n\tprops: {\n\t\tid: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t\toptions: {\n\t\t\ttype: Object,\n\t\t\trequired: false,\n\t\t\tdefault: {},\n\t\t},\n\t\twrapperClass: {\n\t\t\ttype: String,\n\t\t\trequired: false,\n\t\t\tdefault: '',\n\t\t},\n\t},\n\tdata()\n\t{\n\t\treturn {\n\t\t\tpopupInstance: null,\n\t\t};\n\t},\n\tcomputed: {\n\t\tpopupOptions()\n\t\t{\n\t\t\treturn {\n\t\t\t\tid: this.id,\n\t\t\t\tcontent: this.$refs.content,\n\t\t\t\tautoHide: true,\n\t\t\t\tevents: {\n\t\t\t\t\tonPopupClose: this.closePopup,\n\t\t\t\t\tonPopupDestroy: this.closePopup,\n\t\t\t\t},\n\t\t\t\tfixed: true,\n\t\t\t\t...this.options,\n\t\t\t};\n\t\t},\n\t},\n\tmethods: {\n\t\tclosePopup()\n\t\t{\n\t\t\tPopupManager.getPopupById(this.id)?.destroy();\n\t\t\tthis.popupInstance = null;\n\t\t\tthis.$emit('close');\n\t\t},\n\t},\n\tmounted()\n\t{\n\t\tif (!this.popupInstance)\n\t\t{\n\t\t\tthis.popupInstance = new MainPopup(this.popupOptions);\n\t\t}\n\n\t\tthis.popupInstance.show();\n\t},\n\tbeforeUnmount(): void\n\t{\n\t\tthis.closePopup();\n\t},\n\ttemplate: `\n\t\t<div ref=\"content\" :class=\"wrapperClass\">\n\t\t\t<slot></slot>\n\t\t</div>\n\t`,\n};\n","import { ajax as Ajax, Dom } from 'main.core';\nimport type { PopupOptions } from 'main.popup';\nimport { Popup } from '../../layout/popup';\nimport { Button, ButtonState, ButtonSize, ButtonColor } from 'ui.buttons';\nimport '../../css/csv-errors-popup.css';\n\n// noinspection JSUnusedGlobalSymbols\nexport const FileErrorsPopup = {\n\temits: ['close', 'saveIgnoringErrors'],\n\tprops: {\n\t\terrors: {\n\t\t\ttype: Array,\n\t\t\trequired: true,\n\t\t},\n\t\tisEditMode: {\n\t\t\ttype: Boolean,\n\t\t\trequired: true,\n\t\t},\n\t\tisSavingMode: {\n\t\t\ttype: Boolean,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tdata()\n\t{\n\t\treturn {\n\t\t\treportDownloadLink: null,\n\t\t};\n\t},\n\tcomputed: {\n\t\tpopupOptions(): PopupOptions\n\t\t{\n\t\t\treturn {\n\t\t\t\twidth: 830,\n\t\t\t\tcloseIcon: false,\n\t\t\t\tnoAllPaddings: true,\n\t\t\t\toverlay: true,\n\t\t\t};\n\t\t},\n\t\ttitle(): string\n\t\t{\n\t\t\tif (!this.isSavingMode)\n\t\t\t{\n\t\t\t\tif (this.errors.length >= 200)\n\t\t\t\t{\n\t\t\t\t\treturn this.$Bitrix.Loc.getMessage('DATASET_IMPORT_CSV_ERROR_POPUP_TITLE_MANY');\n\t\t\t\t}\n\n\t\t\t\treturn this.$Bitrix.Loc.getMessage('DATASET_IMPORT_CSV_ERROR_POPUP_TITLE');\n\t\t\t}\n\n\t\t\tif (this.errors.length <= 200)\n\t\t\t{\n\t\t\t\treturn this.$Bitrix.Loc.getMessage('DATASET_IMPORT_CSV_ERROR_POPUP_TITLE');\n\t\t\t}\n\n\t\t\treturn this.isEditMode\n\t\t\t\t? this.$Bitrix.Loc.getMessage('DATASET_IMPORT_CSV_ERROR_POPUP_TITLE_STOPPED_UPDATING')\n\t\t\t\t: this.$Bitrix.Loc.getMessage('DATASET_IMPORT_CSV_ERROR_POPUP_TITLE_STOPPED_CREATING')\n\t\t\t;\n\t\t},\n\t\thintContent(): string\n\t\t{\n\t\t\tif (this.errors.length > 200)\n\t\t\t{\n\t\t\t\tif (this.isEditMode)\n\t\t\t\t{\n\t\t\t\t\treturn this.prepareHintContent('DATASET_IMPORT_CSV_ERROR_POPUP_HINT_UPDATING_MANY_ERRORS');\n\t\t\t\t}\n\n\t\t\t\treturn this.prepareHintContent('DATASET_IMPORT_CSV_ERROR_POPUP_HINT_CREATION_MANY_ERRORS');\n\t\t\t}\n\n\t\t\tif (this.isSavingMode)\n\t\t\t{\n\t\t\t\tif (this.isEditMode)\n\t\t\t\t{\n\t\t\t\t\treturn this.prepareHintContent('DATASET_IMPORT_CSV_ERROR_POPUP_HINT_UPDATING');\n\t\t\t\t}\n\n\t\t\t\treturn this.prepareHintContent('DATASET_IMPORT_CSV_ERROR_POPUP_HINT_CREATION');\n\t\t\t}\n\n\t\t\treturn this.prepareHintContent('DATASET_IMPORT_CSV_ERROR_POPUP_HINT_CHECKING');\n\t\t},\n\t\terrorsCountText(): string\n\t\t{\n\t\t\treturn this.$Bitrix.Loc.getMessage('DATASET_IMPORT_CSV_ERROR_POPUP_SUMMARY')\n\t\t\t\t.replace('[wrapper]', '<span class=\"errors-counter\">')\n\t\t\t\t.replace('#COUNT#', this.errors.length > 200 ? '200+' : this.errors.length)\n\t\t\t\t.replace('[/wrapper]', '</span>')\n\t\t\t;\n\t\t},\n\t},\n\tmethods: {\n\t\tonClose()\n\t\t{\n\t\t\tthis.$emit('close');\n\t\t},\n\t\tonIgnoreErrorsClick()\n\t\t{\n\t\t\tthis.$emit('saveIgnoringErrors');\n\t\t},\n\t\tonDownloadLogButtonClick()\n\t\t{\n\t\t\tthis.downloadLogButton.setState(ButtonState.WAITING);\n\n\t\t\tif (this.reportDownloadLink)\n\t\t\t{\n\t\t\t\tthis.downloadLogButton.setState(null);\n\t\t\t\tthis.downloadLog();\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tAjax.runAction(\n\t\t\t\t'biconnector.externalsource.dataset.logErrorsIntoFile',\n\t\t\t\t{\n\t\t\t\t\tdata: {\n\t\t\t\t\t\tfields: this.$store.state.config,\n\t\t\t\t\t\ttype: 'csv',\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t)\n\t\t\t\t.then((response) => {\n\t\t\t\t\tthis.downloadLogButton.setState(null);\n\t\t\t\t\tconst blob = new Blob([response.data], { type: 'text/html' });\n\t\t\t\t\tthis.reportDownloadLink = window.URL.createObjectURL(blob);\n\t\t\t\t\tthis.downloadLog();\n\t\t\t\t})\n\t\t\t\t.catch(() => {\n\t\t\t\t\tthis.downloadLogButton.setState(null);\n\t\t\t\t})\n\t\t\t;\n\t\t},\n\t\tdownloadLog()\n\t\t{\n\t\t\tconst link = document.createElement('a');\n\t\t\tlink.href = this.reportDownloadLink;\n\t\t\tlink.download = `${this.$store.state.config.datasetProperties.name ?? 'csv_dataset'}_errors.html`;\n\t\t\tDom.append(link, document.body);\n\t\t\tlink.click();\n\t\t\tDom.remove(link);\n\t\t},\n\t\tprepareHintContent(phraseCode: string): string\n\t\t{\n\t\t\tconst message = this.$Bitrix.Loc.getMessage(phraseCode);\n\n\t\t\treturn message\n\t\t\t\t.replace('[link]', '<a onclick=\"top.BX.Helper.show(`redirect=detail&code=23779844`)\">')\n\t\t\t\t.replace('[/link]', '</a>')\n\t\t\t;\n\t\t},\n\t},\n\tmounted()\n\t{\n\t\tthis.downloadLogButton = new Button({\n\t\t\tsize: ButtonSize.EXTRA_SMALL,\n\t\t\tcolor: ButtonColor.LIGHT,\n\t\t\tnoCaps: true,\n\t\t\tonclick: this.onDownloadLogButtonClick,\n\t\t\ttext: this.$Bitrix.Loc.getMessage('DATASET_IMPORT_CSV_ERROR_POPUP_DOWNLOAD_LOG'),\n\t\t\tclassName: 'popup-errors-log-button',\n\t\t});\n\t\tthis.downloadLogButton.renderTo(this.$refs.summaryBlock);\n\t},\n\tbeforeUnmount()\n\t{\n\t\twindow.URL.revokeObjectURL(this.reportDownloadLink);\n\t\tthis.reportDownloadLink = null;\n\t},\n\tcomponents: {\n\t\tPopup,\n\t},\n\t// language=Vue\n\ttemplate: `\n\t\t<Popup id=\"generic\" @close=\"this.onClose\" :options=\"popupOptions\" wrapper-class=\"errors-popup\">\n\t\t\t<h3 class=\"popup-header\">{{ title }}</h3>\n\t\t\t<div class=\"ui-alert ui-alert-primary popup-hint\">\n\t\t\t\t<span v-html=\"hintContent\"></span>\n\t\t\t</div>\n\n\t\t\t<div class=\"popup-errors-summary\" ref=\"summaryBlock\">\n\t\t\t\t<div\n\t\t\t\t\tclass=\"popup-errors-count\"\n\t\t\t\t\tv-html=\"errorsCountText\"\n\t\t\t\t></div>\n\t\t\t</div>\n\n\t\t\t<div \n\t\t\t\tclass=\"popup-error-header-wrapper\"\n\t\t\t\t:style=\"errors.length >= 6 ? {'padding-right': '13px'} : {}\"\n\t\t\t>\n\t\t\t\t<table class=\"popup-error-header\">\n\t\t\t\t\t<tbody>\n\t\t\t\t\t<tr>\n\t\t\t\t\t<td class=\"popup-error-header-cell cell-error-number\">\n\t\t\t\t\t\t{{ $Bitrix.Loc.getMessage('DATASET_IMPORT_CSV_ERROR_POPUP_TABLE_HEADER_ERROR_NUMBER') }}\n\t\t\t\t\t</td>\n\t\t\t\t\t<td class=\"popup-error-header-cell cell-error-message\">\n\t\t\t\t\t\t{{ $Bitrix.Loc.getMessage('DATASET_IMPORT_CSV_ERROR_POPUP_TABLE_HEADER_ERROR_MESSAGE') }}\n\t\t\t\t\t</td>\n\t\t\t\t\t<td class=\"popup-error-header-cell cell-error-line\">\n\t\t\t\t\t\t{{ $Bitrix.Loc.getMessage('DATASET_IMPORT_CSV_ERROR_POPUP_TABLE_HEADER_LINE') }}\n\t\t\t\t\t</td>\n\t\t\t\t\t<td class=\"popup-error-header-cell cell-error-column-name\">\n\t\t\t\t\t\t{{ $Bitrix.Loc.getMessage('DATASET_IMPORT_CSV_ERROR_POPUP_TABLE_HEADER_COL_NAME') }}\n\t\t\t\t\t</td>\n\t\t\t\t\t</tr>\n\t\t\t\t\t</tbody>\n\t\t\t\t</table>\n\t\t\t</div>\n\n\t\t\t<div \n\t\t\t\tclass=\"popup-error-table-wrapper\"\n\t\t\t\t:style=\"errors.length >= 6 ? {'padding-right': '3px'} : {}\"\n\t\t\t>\n\t\t\t\t<div class=\"popup-error-table-scroll\">\n\t\t\t\t\t<table class=\"popup-error-table\">\n\t\t\t\t\t\t<tr v-for=\"(error, index) in errors\">\n\t\t\t\t\t\t\t<template v-if=\"index < 200\">\n\t\t\t\t\t\t\t\t<td class=\"popup-error-table-row-cell cell-error-number\">{{ index + 1 }}</td>\n\t\t\t\t\t\t\t\t<td class=\"popup-error-table-row-cell cell-error-message\">{{ error.errorMessage }}</td>\n\t\t\t\t\t\t\t\t<td class=\"popup-error-table-row-cell cell-error-line\">{{ error.lineNumber }}</td>\n\t\t\t\t\t\t\t\t<td class=\"popup-error-table-row-cell cell-error-column-name\" :title=\"error.columnName\">{{ error.columnName }}</td>\n\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t</table>\n\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t\t<div class=\"popup-buttons-wrapper\">\n\t\t\t\t<template v-if=\"isSavingMode\">\n\t\t\t\t\t<template v-if=\"errors.length > 200\">\n\t\t\t\t\t\t<button @click=\"this.onClose\" class=\"ui-btn ui-btn-md ui-btn-primary\">\n\t\t\t\t\t\t\t{{ $Bitrix.Loc.getMessage('DATASET_IMPORT_CSV_ERROR_POPUP_BUTTON_CLOSE') }}\n\t\t\t\t\t\t</button>\n\t\t\t\t\t</template>\n\t\t\t\t\t<template v-else>\n\t\t\t\t\t\t<button v-if=\"isEditMode\" @click=\"this.onClose\" class=\"ui-btn ui-btn-md ui-btn-primary\">\n\t\t\t\t\t\t\t{{ $Bitrix.Loc.getMessage('DATASET_IMPORT_CSV_ERROR_POPUP_BUTTON_STOP_UPDATE') }}\n\t\t\t\t\t\t</button>\n\t\t\t\t\t\t<button v-else @click=\"this.onClose\" class=\"ui-btn ui-btn-md ui-btn-primary\">\n\t\t\t\t\t\t\t{{ $Bitrix.Loc.getMessage('DATASET_IMPORT_CSV_ERROR_POPUP_BUTTON_STOP') }}\n\t\t\t\t\t\t</button>\n\n\t\t\t\t\t\t<button @click=\"this.onIgnoreErrorsClick\" class=\"ui-btn ui-btn-md ui-btn-light-border\">\n\t\t\t\t\t\t\t{{ $Bitrix.Loc.getMessage('DATASET_IMPORT_CSV_ERROR_POPUP_BUTTON_IGNORE') }}\n\t\t\t\t\t\t</button>\n\t\t\t\t\t</template>\n\t\t\t\t</template>\n\t\t\t\t<template v-else>\n\t\t\t\t\t<button @click=\"this.onClose\" class=\"ui-btn ui-btn-md ui-btn-primary\">\n\t\t\t\t\t\t{{ $Bitrix.Loc.getMessage('DATASET_IMPORT_CSV_ERROR_POPUP_BUTTON_CLOSE') }}\n\t\t\t\t\t</button>\n\t\t\t\t</template>\n\t\t\t</div>\n\t\t</Popup>\n\t`,\n};\n","import { Loader } from 'main.loader';\nimport type { PopupOptions } from 'main.popup';\nimport { Popup } from '../../layout/popup';\nimport '../../css/file-checking-popup.css';\n\nexport const CheckingProgressPopup = {\n\temits: ['close'],\n\tprops: {},\n\tcomputed: {\n\t\tpopupOptions(): PopupOptions\n\t\t{\n\t\t\treturn {\n\t\t\t\twidth: 440,\n\t\t\t\tcloseIcon: false,\n\t\t\t\tnoAllPaddings: true,\n\t\t\t\toverlay: true,\n\t\t\t\tbackground: 'transparent',\n\t\t\t};\n\t\t},\n\t},\n\tmounted()\n\t{\n\t\tconst loader = new Loader({\n\t\t\ttarget: this.$refs.loader,\n\t\t\tsize: 65,\n\t\t\tcolor: 'var(--ui-color-primary)',\n\t\t\tstrokeWidth: 4,\n\t\t\tmode: 'inline',\n\t\t});\n\t\tloader.show();\n\t},\n\tmethods: {\n\t\tonClose()\n\t\t{\n\t\t\tthis.$emit('close');\n\t\t},\n\t},\n\tcomponents: {\n\t\tPopup,\n\t},\n\t// language=Vue\n\ttemplate: `\n\t\t<Popup\n\t\t\tid=\"file-check-progress\"\n\t\t\t@close=\"this.onClose\"\n\t\t\t:options=\"popupOptions\"\n\t\t>\n\t\t\t<div class=\"file-check file-check-progress\">\n\t\t\t\t<div ref=\"loader\" class=\"file-check-loader\"></div>\n\t\t\t</div>\n\t\t</Popup>\n\t`,\n};\n","import type { PopupOptions } from 'main.popup';\nimport { Popup } from '../../layout/popup';\nimport '../../css/file-checking-popup.css';\n\nexport const CheckingSuccessPopup = {\n\temits: ['close'],\n\tprops: {},\n\tcomputed: {\n\t\tpopupOptions(): PopupOptions\n\t\t{\n\t\t\treturn {\n\t\t\t\twidth: 440,\n\t\t\t\tcloseIcon: true,\n\t\t\t\tnoAllPaddings: true,\n\t\t\t\toverlay: true,\n\t\t\t};\n\t\t},\n\t},\n\tmethods: {\n\t\tonClose()\n\t\t{\n\t\t\tthis.$emit('close');\n\t\t},\n\t},\n\tcomponents: {\n\t\tPopup,\n\t},\n\t// language=Vue\n\ttemplate: `\n\t\t<Popup \n\t\t\tid=\"file-check-success\"\n\t\t\t@close=\"this.onClose\" \n\t\t\t:options=\"popupOptions\" \n\t\t>\n\t\t\t<div class=\"file-check file-check-success\">\n\t\t\t\t<div class=\"biconnector-save-progress-popup__success-logo file-check-icon-success\"></div>\n\t\t\t\t<div class=\"file-check-title\">{{ $Bitrix.Loc.getMessage('DATASET_IMPORT_CSV_ERROR_POPUP_CHECK_OK_TITLE') }}</div>\n\t\t\t\t<div class=\"file-check-subtitle\">{{ $Bitrix.Loc.getMessage('DATASET_IMPORT_CSV_ERROR_POPUP_CHECK_OK_SUBTITLE') }}</div>\n\t\t\t\t<button @click=\"this.onClose\" class=\"ui-btn ui-btn-md ui-btn-primary file-check-button\">\n\t\t\t\t\t{{ $Bitrix.Loc.getMessage('DATASET_IMPORT_CSV_ERROR_POPUP_CHECK_OK_BUTTON') }}\n\t\t\t\t</button>\n\t\t\t</div>\n\t\t</Popup>\n\t`,\n};\n","import type { PopupOptions } from 'main.popup';\nimport { Popup } from '../../layout/popup';\nimport '../../css/file-checking-popup.css';\n\nexport const CheckingFailedPopup = {\n\temits: ['close'],\n\tprops: {},\n\tcomputed: {\n\t\tpopupOptions(): PopupOptions\n\t\t{\n\t\t\treturn {\n\t\t\t\twidth: 440,\n\t\t\t\tcloseIcon: true,\n\t\t\t\tnoAllPaddings: true,\n\t\t\t\toverlay: true,\n\t\t\t};\n\t\t},\n\t},\n\tmethods: {\n\t\tonClose()\n\t\t{\n\t\t\tthis.$emit('close');\n\t\t},\n\t},\n\tcomponents: {\n\t\tPopup,\n\t},\n\t// language=Vue\n\ttemplate: `\n\t\t<Popup \n\t\t\tid=\"file-check-failed\"\n\t\t\t@close=\"this.onClose\" \n\t\t\t:options=\"popupOptions\" \n\t\t>\n\t\t\t<div class=\"file-check file-check-failed\">\n\t\t\t\t<div class=\"biconnector-save-progress-popup__failure-logo file-check-icon-failed\"></div>\n\t\t\t\t<div class=\"file-check-title\">{{ $Bitrix.Loc.getMessage('DATASET_IMPORT_CSV_ERROR_POPUP_CHECK_FAILED_TITLE') }}</div>\n\t\t\t\t<div class=\"file-check-subtitle\">{{ $Bitrix.Loc.getMessage('DATASET_IMPORT_CSV_ERROR_POPUP_CHECK_FAILED_SUBTITLE') }}</div>\n\t\t\t\t<button @click=\"this.onClose\" class=\"ui-btn ui-btn-md ui-btn-primary file-check-button\">\n\t\t\t\t\t{{ $Bitrix.Loc.getMessage('DATASET_IMPORT_CSV_ERROR_POPUP_CHECK_FAILED_BUTTON') }}\n\t\t\t\t</button>\n\t\t\t</div>\n\t\t</Popup>\n\t`,\n};\n","import type { PopupOptions } from 'main.popup';\nimport { Popup } from '../layout/popup';\nimport '../css/generic-popup.css';\n\nexport const GenericPopup = {\n\temits: ['close'],\n\tprops: {\n\t\ttitle: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tcomputed: {\n\t\tpopupOptions(): PopupOptions\n\t\t{\n\t\t\treturn {\n\t\t\t\twidth: 440,\n\t\t\t\tcloseIcon: true,\n\t\t\t\tnoAllPaddings: true,\n\t\t\t\toverlay: true,\n\t\t\t};\n\t\t},\n\t},\n\tmethods: {\n\t\tonClose()\n\t\t{\n\t\t\tthis.$emit('close');\n\t\t},\n\t},\n\tcomponents: {\n\t\tPopup,\n\t},\n\t// language=Vue\n\ttemplate: `\n\t\t<Popup id=\"generic\" @close=\"this.onClose\" :options=\"popupOptions\" wrapper-class=\"generic-popup\">\n\t\t\t<h3 class=\"generic-popup__header\">{{ title }}</h3>\n\t\t\t<div class=\"generic-popup__content\">\n\t\t\t\t<slot name=\"content\"></slot>\n\t\t\t</div>\n\t\t\t<div class=\"generic-popup__buttons-wrapper\">\n\t\t\t\t<slot name=\"buttons\"></slot>\n\t\t\t</div>\n\t\t</Popup>\n\t`,\n};\n","import type { PopupOptions } from 'main.popup';\nimport { Popup } from '../../layout/popup';\n\nexport const SavingPopup = {\n\temits: ['close'],\n\tprops: {\n\t\ttitle: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t\tdescription: {\n\t\t\ttype: String,\n\t\t\trequired: false,\n\t\t\tdefault: '',\n\t\t},\n\t\toptions: {\n\t\t\ttype: Object,\n\t\t\trequired: false,\n\t\t\tdefault: {},\n\t\t},\n\t},\n\tcomputed: {\n\t\tpopupOptions(): PopupOptions\n\t\t{\n\t\t\treturn {\n\t\t\t\twidth: 500,\n\t\t\t\tminHeight: 299,\n\t\t\t\tcloseIcon: true,\n\t\t\t\tnoAllPaddings: true,\n\t\t\t\toverlay: true,\n\t\t\t\t...this.options,\n\t\t\t};\n\t\t},\n\t},\n\tmethods: {\n\t\tonClose()\n\t\t{\n\t\t\tthis.$emit('close');\n\t\t},\n\t},\n\tcomponents: {\n\t\tPopup,\n\t},\n\t// language=Vue\n\ttemplate: `\n\t\t<Popup id=\"saveProgress\" @close=\"this.onClose\" :options=\"popupOptions\" wrapper-class=\"biconnector-popup--full-height\">\n\t\t\t<div class=\"biconnector-save-progress-popup\">\n\t\t\t\t<div class=\"biconnector-save-progress-popup__content\">\n\t\t\t\t\t<slot name=\"icon\"></slot>\n\t\t\t\t\t<div class=\"biconnector-save-progress-popup__texts\">\n\t\t\t\t\t\t<h3 class=\"biconnector-save-progress-popup__header\">{{ title }}</h3>\n\t\t\t\t\t\t<p class=\"biconnector-save-progress-popup__description\" v-if=\"description\">{{ description }}</p>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"biconnector-save-progress-popup__buttons\"><slot name=\"buttons\"></slot></div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</Popup>\n\t`,\n};\n","import { SavingPopup } from './saving-popup';\n\nexport const ImportFailurePopup = {\n\tprops: {\n\t\ttitle: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t\tdescription: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t},\n\temits: ['click'],\n\tcomputed: {},\n\tmethods:\n\t{\n\t\tonClick()\n\t\t{\n\t\t\tthis.$emit('click');\n\t\t},\n\t},\n\tcomponents: {\n\t\tSaveProgressPopup: SavingPopup,\n\t},\n\t// language=Vue\n\ttemplate: `\n\t\t<SaveProgressPopup\n\t\t\t:title=\"title\"\n\t\t\t:description=\"description\"\n\t\t>\n\t\t\t<template v-slot:icon>\n\t\t\t\t<div class=\"biconnector-save-progress-popup__failure-logo\"></div>\n\t\t\t</template>\n\t\t\t<template v-slot:buttons>\n\t\t\t\t<button @click=\"onClick\" class=\"ui-btn ui-btn-md ui-btn-primary\">{{ $Bitrix.Loc.getMessage('DATASET_IMPORT_FAILURE_POPUP_BUTTON') }}</button>\n\t\t\t</template>\n\t\t</SaveProgressPopup>\n\t`,\n};\n","import { SavingPopup } from './saving-popup';\nimport { Loader } from 'main.loader';\n\nexport const ImportProgressPopup = {\n\tprops: {\n\t\tdescription: {\n\t\t\ttype: String,\n\t\t\trequired: false,\n\t\t\tdefault: '',\n\t\t},\n\t},\n\tmounted()\n\t{\n\t\tconst loader = new Loader({\n\t\t\ttarget: this.$refs.loader,\n\t\t\tsize: 65,\n\t\t\tcolor: 'var(--ui-color-primary)',\n\t\t\tstrokeWidth: 4,\n\t\t\tmode: 'inline',\n\t\t});\n\t\tloader.show();\n\t},\n\tcomputed: {\n\t\tpopupOptions()\n\t\t{\n\t\t\treturn {\n\t\t\t\tautoHide: false,\n\t\t\t\tcloseIcon: false,\n\t\t\t};\n\t\t},\n\t},\n\tcomponents: {\n\t\tSaveProgressPopup: SavingPopup,\n\t},\n\t// language=Vue\n\ttemplate: `\n\t\t<SaveProgressPopup\n\t\t\t:title=\"$Bitrix.Loc.getMessage('DATASET_IMPORT_PROGRESS_POPUP_HEADER')\"\n\t\t\t:description=\"description\"\n\t\t\t:options=\"popupOptions\"\n\t\t>\n\t\t\t<template v-slot:icon>\n\t\t\t\t<div ref=\"loader\" class=\"biconnector-save-progress-loader\"></div>\n\t\t\t</template>\n\t\t</SaveProgressPopup>\n\t`,\n};\n","import { ajax as Ajax, Dom } from 'main.core';\nimport { SavingPopup } from './saving-popup';\n\nexport const ImportSuccessPopup = {\n\temits: ['click', 'oneMoreClick'],\n\tprops: {\n\t\ttitle: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t\tdescription: {\n\t\t\ttype: String,\n\t\t\trequired: false,\n\t\t\tdefault: '',\n\t\t},\n\t\tdatasetId: {\n\t\t\ttype: Number,\n\t\t\trequired: true,\n\t\t},\n\t\tshowMoreButton: {\n\t\t\ttype: Boolean,\n\t\t\trequired: false,\n\t\t\tdefault: false,\n\t\t}\n\t},\n\tcomputed: {},\n\tmethods: {\n\t\tonButtonClick()\n\t\t{\n\t\t\tDom.addClass(this.$refs.openDatasetButton, 'ui-btn-wait');\n\t\t\tAjax.runAction(\n\t\t\t\t'biconnector.externalsource.dataset.getEditUrl',\n\t\t\t\t{\n\t\t\t\t\tdata: {\n\t\t\t\t\t\tid: this.datasetId,\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t)\n\t\t\t\t.then((response) => {\n\t\t\t\t\tconst link = response.data;\n\t\t\t\t\tif (link)\n\t\t\t\t\t{\n\t\t\t\t\t\twindow.open(link, '_blank').focus();\n\t\t\t\t\t\tDom.removeClass(this.$refs.openDatasetButton, 'ui-btn-wait');\n\t\t\t\t\t\tthis.$emit('click');\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t\t.catch((response) => {\n\t\t\t\t\tDom.removeClass(this.$refs.openDatasetButton, 'ui-btn-wait');\n\t\t\t\t\tthis.$emit('click');\n\t\t\t\t});\n\t\t},\n\t\tonOneMoreButtonClick()\n\t\t{\n\t\t\tDom.addClass(this.$refs.oneMoreButton, 'ui-btn-wait');\n\t\t\tthis.$emit('oneMoreClick');\n\t\t},\n\t},\n\tcomponents: {\n\t\tSaveProgressPopup: SavingPopup,\n\t},\n\t// language=Vue\n\ttemplate: `\n\t\t<SaveProgressPopup\n\t\t\t:title=\"title\"\n\t\t\t:description=\"description\"\n\t\t>\n\t\t\t<template v-slot:icon>\n\t\t\t\t<div class=\"biconnector-save-progress-popup__success-logo\"></div>\n\t\t\t</template>\n\t\t\t<template v-slot:buttons>\n\t\t\t\t<a class=\"ui-btn ui-btn-md ui-btn-primary\" @click=\"onButtonClick\" ref=\"openDatasetButton\">\n\t\t\t\t\t{{ $Bitrix.Loc.getMessage('DATASET_IMPORT_SUCCESS_POPUP_BUTTON_MSGVER_1') }}\n\t\t\t\t</a>\n\t\t\t\t<a class=\"ui-btn ui-btn-md ui-btn-light-border\" @click=\"onOneMoreButtonClick\" ref=\"oneMoreButton\" v-if=\"showMoreButton\">\n\t\t\t\t\t{{ $Bitrix.Loc.getMessage('DATASET_IMPORT_SUCCESS_POPUP_ONE_MORE_BUTTON') }}\n\t\t\t\t</a>\n\t\t\t</template>\n\t\t</SaveProgressPopup>\n\t`,\n};\n","import 'ui.alerts';\nimport '../css/step-hint.css';\n\nexport const StepHint = {\n\tprops: {\n\t\thintClass: {\n\t\t\ttype: String,\n\t\t\trequired: false,\n\t\t\tdefault: 'ui-alert-primary',\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"ui-alert dataset-import-step__hint\" :class=\"hintClass\">\n\t\t\t<span class=\"ui-alert-message\">\n\t\t\t\t<slot></slot>\n\t\t\t</span>\n\t\t</div>\n\t`,\n};\n","import { Text } from 'main.core';\nimport { Section } from 'ui.section';\nimport { StepHint } from './step-hint';\nimport '../css/step.css';\n\nexport const StepBlock = {\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tsection: null,\n\t\t};\n\t},\n\tprops: {\n\t\ttitle: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t\thint: {\n\t\t\ttype: String,\n\t\t\trequired: false,\n\t\t\tdefault: '',\n\t\t},\n\t\tisOpenInitially: {\n\t\t\ttype: Boolean,\n\t\t\trequired: false,\n\t\t\tdefault: true,\n\t\t},\n\t\tcanCollapse: {\n\t\t\ttype: Boolean,\n\t\t\trequired: false,\n\t\t\tdefault: true,\n\t\t},\n\t\tdisabled: {\n\t\t\ttype: Boolean,\n\t\t\trequired: false,\n\t\t\tdefault: false,\n\t\t},\n\t\tcustomClasses: {\n\t\t\ttype: Array,\n\t\t\tdefault: [],\n\t\t},\n\t\thintClass: {\n\t\t\ttype: String,\n\t\t\trequired: false,\n\t\t},\n\t},\n\tcomputed: {\n\t\tadditionalClasses()\n\t\t{\n\t\t\tconst custom = this.customClasses.reduce((acc, key) => {\n\t\t\t\tacc[key] = true;\n\n\t\t\t\treturn acc;\n\t\t\t}, {});\n\n\t\t\treturn {\n\t\t\t\t'dataset-import-step__disabled': this.disabled,\n\t\t\t\t...custom,\n\t\t\t};\n\t\t},\n\t},\n\tmethods: {\n\t\ttoggleCollapse(open: ?boolean)\n\t\t{\n\t\t\tthis.section.toggle(open);\n\t\t},\n\t},\n\tmounted()\n\t{\n\t\tconst contentContainer = this.$refs.contentContainer;\n\n\t\tconst section = new Section({\n\t\t\ttitle: this.title,\n\t\t\tisOpen: this.isOpenInitially,\n\t\t\tcanCollapse: this.canCollapse,\n\t\t});\n\n\t\tsection.append(this.$refs.content);\n\t\tsection.renderTo(contentContainer);\n\t\tthis.section = section;\n\t},\n\twatch: {\n\t\ttitle(newValue)\n\t\t{\n\t\t\tif (!this.section)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.section.getContent().querySelector('.ui-section__title').innerHTML = Text.encode(newValue);\n\t\t},\n\t},\n\tcomponents: {\n\t\tStepHint,\n\t},\n\t// language=Vue\n\ttemplate: `\n\t\t<div class=\"dataset-import-step\" :class=\"additionalClasses\" ref=\"contentContainer\">\n\t\t</div>\n\t\t<div ref=\"content\" class=\"dataset-import-step__content\">\n\t\t\t<StepHint v-if=\"hint\" :hint-class=\"hintClass\">\n\t\t\t\t<span v-html=\"hint\"></span>\n\t\t\t</StepHint>\n\t\t\t<slot></slot>\n\t\t</div>\n\t`,\n};\n","import { StepBlock } from '../layout/step-block';\n\nexport const BaseStep = {\n\temits: ['validation'],\n\tprops: {\n\t\ttitle: {\n\t\t\ttype: String,\n\t\t\trequired: false,\n\t\t},\n\t\thint: {\n\t\t\ttype: String,\n\t\t\trequired: false,\n\t\t},\n\t\tisOpenInitially: {\n\t\t\ttype: Boolean,\n\t\t\trequired: false,\n\t\t\tdefault: true,\n\t\t},\n\t\tdisabled: {\n\t\t\ttype: Boolean,\n\t\t\trequired: false,\n\t\t\tdefault: false,\n\t\t},\n\t\tdisabledElements: {\n\t\t\ttype: Object,\n\t\t\trequired: false,\n\t\t\tdefault: null,\n\t\t},\n\t\tsourceType: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tcomputed: {\n\t\tdisplayedTitle()\n\t\t{\n\t\t\treturn this.title ?? this.defaultTitle;\n\t\t},\n\t\tdisplayedHint()\n\t\t{\n\t\t\treturn this.hint ?? this.defaultHint;\n\t\t},\n\t\tdefaultTitle()\n\t\t{\n\t\t\treturn '';\n\t\t},\n\t\tdefaultHint()\n\t\t{\n\t\t\treturn '';\n\t\t},\n\t\tsourceTypeCsv(): boolean\n\t\t{\n\t\t\treturn this.sourceType === 'csv';\n\t\t},\n\t\tsourceTypeExternal(): boolean\n\t\t{\n\t\t\treturn this.sourceType === 'external';\n\t\t},\n\t},\n\tmethods: {\n\t\topen()\n\t\t{\n\t\t\tif (this.$refs.stepBlock)\n\t\t\t{\n\t\t\t\tthis.$refs.stepBlock.toggleCollapse(true);\n\t\t\t}\n\t\t},\n\t\tclose()\n\t\t{\n\t\t\tif (this.$refs.stepBlock)\n\t\t\t{\n\t\t\t\tthis.$refs.stepBlock.toggleCollapse(false);\n\t\t\t}\n\t\t},\n\t\tvalidate()\n\t\t{\n\t\t\treturn true;\n\t\t},\n\t\tshowValidationErrors()\n\t\t{},\n\t},\n\tcomponents: {\n\t\tStep: StepBlock,\n\t},\n};\n","import { Tag } from 'main.core';\nimport { Popup, PopupOptions } from 'main.popup';\n\nexport class ErrorPopup\n{\n\tstatic create(message: string, element: HTMLElement): Popup\n\t{\n\t\tconst content = Tag.render`<span class='ui-hint-content'></span>`;\n\t\tcontent.innerHTML = message;\n\n\t\tconst popupOptions: PopupOptions = {\n\t\t\tbindElement: element,\n\t\t\tdarkMode: true,\n\t\t\tcontent,\n\t\t\tautoHide: false,\n\t\t\tbindOptions: {\n\t\t\t\tposition: 'top',\n\t\t\t},\n\t\t\tangle: {\n\t\t\t\tposition: 'bottom',\n\t\t\t},\n\t\t\tcacheable: false,\n\t\t};\n\n\t\tPopup.setOptions({\n\t\t\tangleMinBottom: 43,\n\t\t});\n\n\t\treturn new Popup(popupOptions);\n\t}\n}\n","import '../../css/dataset-import-field.css';\n\nexport const BaseField = {\n\tprops: {\n\t\tdefaultValue: {\n\t\t\trequired: false,\n\t\t\tdefault: '',\n\t\t},\n\t\tname: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t\ttitle: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t\tplaceholder: {\n\t\t\ttype: String,\n\t\t\trequired: false,\n\t\t\tdefault: '',\n\t\t},\n\t\tisValid: {\n\t\t\ttype: Boolean,\n\t\t\trequired: false,\n\t\t\tdefault: true,\n\t\t},\n\t\terrorMessage: {\n\t\t\ttype: String,\n\t\t\trequired: false,\n\t\t\tdefault: '',\n\t\t},\n\t\tisDisabled: {\n\t\t\ttype: Boolean,\n\t\t\trequired: false,\n\t\t\tdefault: false,\n\t\t},\n\t\thintText: {\n\t\t\ttype: String,\n\t\t\trequired: false,\n\t\t},\n\t},\n\temits: [\n\t\t'valueChange',\n\t],\n\tdata()\n\t{\n\t\treturn {\n\t\t\tvalue: this.defaultValue,\n\t\t\tareValidationErrorsShown: false,\n\t\t};\n\t},\n\tmethods: {\n\t\tshowValidationErrors()\n\t\t{\n\t\t\tthis.areValidationErrorsShown = true;\n\t\t},\n\t\tonInputChange(newValue)\n\t\t{\n\t\t\tthis.$emit('valueChange', {\n\t\t\t\tnewValue,\n\t\t\t\tfieldName: this.name,\n\t\t\t});\n\t\t},\n\t},\n\twatch: {\n\t\tdefaultValue(newValue)\n\t\t{\n\t\t\tthis.value = newValue;\n\t\t},\n\t},\n};\n","import { Dom } from 'main.core';\nimport { ErrorPopup } from '../../layout/error-popup';\nimport { BaseField } from './base-field';\nimport '../../css/dataset-import-field.css';\nimport 'ui.hint';\n\nexport const StringField = {\n\textends: BaseField,\n\tdata()\n\t{\n\t\treturn {\n\t\t\terrorPopup: null,\n\t\t\terrorPopupTimeout: null,\n\t\t};\n\t},\n\tmethods: {\n\t\tonInput(event)\n\t\t{\n\t\t\tthis.areValidationErrorsShown = false;\n\t\t\tthis.onInputChange(event.target.value);\n\t\t},\n\t\tonBlur()\n\t\t{\n\t\t\tthis.areValidationErrorsShown = true;\n\t\t\tif (!this.isValid)\n\t\t\t{\n\t\t\t\tthis.showErrorHint();\n\t\t\t\tthis.errorPopupTimeout = setTimeout(() => {\n\t\t\t\t\tthis.hideErrorHint();\n\t\t\t\t\tthis.errorPopupTimeout = null;\n\t\t\t\t}, 3000);\n\t\t\t}\n\t\t},\n\t\tshowErrorHint()\n\t\t{\n\t\t\tif (this.errorPopupTimeout)\n\t\t\t{\n\t\t\t\tclearTimeout(this.errorPopupTimeout);\n\t\t\t\tthis.errorPopupTimeout = null;\n\t\t\t}\n\t\t\telse if (!this.errorPopup || this.errorPopup.isDestroyed())\n\t\t\t{\n\t\t\t\tthis.errorPopup = this.createErrorPopup();\n\t\t\t\tthis.errorPopup.show();\n\t\t\t}\n\t\t},\n\t\thideErrorHint()\n\t\t{\n\t\t\tif (this.errorPopup)\n\t\t\t{\n\t\t\t\tthis.errorPopup.close();\n\t\t\t}\n\t\t\tclearTimeout(this.errorPopupTimeout);\n\t\t\tthis.errorPopupTimeout = null;\n\t\t},\n\t\tcreateErrorPopup()\n\t\t{\n\t\t\treturn ErrorPopup.create(this.errorMessage, this.$refs.errorIconWrapper);\n\t\t},\n\t},\n\tmounted()\n\t{\n\t\tif (this.hintText)\n\t\t{\n\t\t\tDom.append(BX.UI.Hint.createNode(this.hintText), this.$refs.title);\n\t\t}\n\t},\n\t// language=Vue\n\ttemplate: `\n\t\t<div class=\"ui-form-row\">\n\t\t\t<div class=\"ui-form-label\">\n\t\t\t\t<div class=\"ui-ctl-label-text\" ref=\"title\">\n\t\t\t\t\t{{ title }}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div class=\"ui-ctl ui-ctl-after-icon ui-ctl-textbox ui-ctl-w100 dataset-import-control\">\n\t\t\t\t<input\n\t\t\t\t\tclass=\"ui-ctl-element dataset-import-field\"\n\t\t\t\t\ttype=\"text\"\n\t\t\t\t\t:class=\"{ 'data-import-field--invalid': !isValid && areValidationErrorsShown }\"\n\t\t\t\t\t:disabled=\"isDisabled\"\n\t\t\t\t\t:placeholder=\"placeholder\"\n\t\t\t\t\tv-model=\"value\"\n\t\t\t\t\t@input=\"onInput\"\n\t\t\t\t\t@blur=\"onBlur\"\n\t\t\t\t>\n\t\t\t\t<div class=\"ui-ctl-after\" ref=\"errorIconWrapper\">\n\t\t\t\t\t<div\n\t\t\t\t\t\tclass=\"ui-icon-set --warning format-table__error-icon\"\n\t\t\t\t\t\t@mouseenter=\"showErrorHint\"\n\t\t\t\t\t\t@mouseleave=\"hideErrorHint\"\n\t\t\t\t\t\tv-if=\"!isValid && areValidationErrorsShown\"\n\t\t\t\t\t></div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import { BaseField } from './base-field';\n\nexport const TextField = {\n\textends: BaseField,\n\t// language=Vue\n\ttemplate: `\n\t\t<div class=\"ui-form-row\">\n\t\t\t<div class=\"ui-form-label\">\n\t\t\t\t<div class=\"ui-ctl-label-text\">{{ title }}</div>\n\t\t\t</div>\n\t\t\t<div class=\"ui-ctl ui-ctl-textarea dataset-import-textarea ui-ctl-w100 ui-ctl-no-resize\">\n\t\t\t\t<textarea \n\t\t\t\t\tclass=\"ui-ctl-element dataset-import-textarea-element\" \n\t\t\t\t\t:placeholder=\"placeholder\" \n\t\t\t\t\t@input=\"onInputChange($event.target.value)\"\n\t\t\t\t\tv-model=\"value\"\n\t\t\t\t></textarea>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import type { FieldValueChangeEvent } from '../types/field-value-change-event';\nimport { StringField } from './type/string-field';\nimport { TextField } from './type/text-field';\nimport '../css/dataset-properties.css';\n\nexport const DatasetProperties = {\n\tprops: {\n\t\tdefaultName: {\n\t\t\ttype: String,\n\t\t\trequired: false,\n\t\t\tdefault: '',\n\t\t},\n\t\tdefaultDescription: {\n\t\t\ttype: String,\n\t\t\trequired: false,\n\t\t\tdefault: '',\n\t\t},\n\t\tunvalidatedFields: {\n\t\t\ttype: Object,\n\t\t\trequired: false,\n\t\t\tdefault: {},\n\t\t},\n\t\tdisabledFields: {\n\t\t\ttype: Object,\n\t\t\trequired: false,\n\t\t\tdefault: {},\n\t\t},\n\t\tdatasetSourceCode: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t},\n\temits: [\n\t\t'valueChange',\n\t\t'validationNeeded',\n\t],\n\tmethods: {\n\t\tonValueChange(event: FieldValueChangeEvent)\n\t\t{\n\t\t\tthis.$emit('valueChange', event);\n\t\t},\n\t\tshowValidationErrors()\n\t\t{\n\t\t\tthis.$refs.nameField.showValidationErrors();\n\t\t},\n\t},\n\tcomponents: {\n\t\tStringField,\n\t\tTextField,\n\t},\n\t// language=Vue\n\ttemplate: `\n\t\t<div class=\"ui-form dataset-properties\">\n\t\t\t<StringField\n\t\t\t\tref=\"nameField\"\n\t\t\t\tname=\"name\"\n\t\t\t\t:defaultValue=\"defaultName\"\n\t\t\t\t@value-change=\"onValueChange\"\n\t\t\t\t:title=\"this.$Bitrix.Loc.getMessage('DATASET_IMPORT_DATASET_PROPERTIES_CODE')\"\n\t\t\t\t:placeholder=\"this.$Bitrix.Loc.getMessage('DATASET_IMPORT_DATASET_PROPERTIES_CODE_PLACEHOLDER', { '#CODE#': this.datasetSourceCode })\"\n\t\t\t\t:is-valid=\"unvalidatedFields.name?.result ?? true\"\n\t\t\t\t:is-disabled=\"disabledFields.name ?? false\"\n\t\t\t\t:error-message=\"unvalidatedFields.name?.message ?? ''\"\n\t\t\t/>\n\t\t\t<TextField\n\t\t\t\tname=\"description\"\n\t\t\t\t:defaultValue=\"defaultDescription\"\n\t\t\t\t@value-change=\"onValueChange\"\n\t\t\t\t:title=\"this.$Bitrix.Loc.getMessage('DATASET_IMPORT_DATASET_PROPERTIES_DESCRIPTION')\"\n\t\t\t/>\n\t\t</div>\n\t`,\n};\n","import { StepBlock } from '../layout/step-block';\nimport { BaseStep } from './base-step';\nimport { DatasetProperties } from '../fields/dataset-properties';\nimport type { FieldValueChangeEvent } from '../types/field-value-change-event';\n\nexport const DatasetPropertiesStep = {\n\textends: BaseStep,\n\tprops: {\n\t\tdatasetSourceCode: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t\treservedNames: {\n\t\t\ttype: Array,\n\t\t\trequired: false,\n\t\t\tdefault: [],\n\t\t},\n\t\tnameMaxLength: {\n\t\t\ttype: Number,\n\t\t\trequired: false,\n\t\t\tdefault: 30,\n\t\t},\n\t},\n\temits: ['propertiesChanged'],\n\tcomputed: {\n\t\tdatasetProperties()\n\t\t{\n\t\t\treturn this.$store.state.config.datasetProperties;\n\t\t},\n\t\tdefaultTitle()\n\t\t{\n\t\t\treturn this.$Bitrix.Loc.getMessage('DATASET_IMPORT_PROPERTIES_HEADER');\n\t\t},\n\t\tdefaultHint()\n\t\t{\n\t\t\tif (this.isEditMode)\n\t\t\t{\n\t\t\t\treturn '';\n\t\t\t}\n\n\t\t\treturn this.$Bitrix.Loc.getMessage('DATASET_IMPORT_PROPERTIES_HINT');\n\t\t},\n\t\tdisabledFields()\n\t\t{\n\t\t\treturn {\n\t\t\t\tname: this.$store.getters.isEditMode,\n\t\t\t};\n\t\t},\n\t\tunvalidatedFields()\n\t\t{\n\t\t\tconst result = {};\n\t\t\tconst nameValidationResult = this.validateName();\n\t\t\tif (!nameValidationResult.result)\n\t\t\t{\n\t\t\t\tresult.name = nameValidationResult;\n\t\t\t}\n\n\t\t\treturn result;\n\t\t},\n\t\tisEditMode()\n\t\t{\n\t\t\treturn this.$store.getters.isEditMode;\n\t\t},\n\t},\n\tcomponents: {\n\t\tStep: StepBlock,\n\t\tDatasetProperties,\n\t},\n\tmethods: {\n\t\tonDatasetPropertiesFieldsChange(event: FieldValueChangeEvent)\n\t\t{\n\t\t\tconst datasetProperties = this.datasetProperties;\n\t\t\tdatasetProperties[event.fieldName] = event.newValue;\n\t\t\tthis.$store.commit('setDatasetProperties', datasetProperties);\n\t\t\tthis.validate();\n\n\t\t\tthis.$emit('propertiesChanged');\n\t\t},\n\t\tvalidate()\n\t\t{\n\t\t\tlet result = true;\n\t\t\tif (!this.isEditMode)\n\t\t\t{\n\t\t\t\tresult = Object.keys(this.unvalidatedFields).length === 0;\n\t\t\t}\n\n\t\t\tthis.$emit('validation', result);\n\n\t\t\treturn result;\n\t\t},\n\t\tvalidateName()\n\t\t{\n\t\t\tconst name = this.$store.state.config.datasetProperties.name;\n\t\t\tif (!name)\n\t\t\t{\n\t\t\t\treturn {\n\t\t\t\t\tresult: true,\n\t\t\t\t};\n\t\t\t}\n\n\t\t\tconst isReserved = this.reservedNames.includes(name);\n\t\t\tif (isReserved)\n\t\t\t{\n\t\t\t\treturn {\n\t\t\t\t\tresult: false,\n\t\t\t\t\tmessage: this.$Bitrix.Loc.getMessage('DATASET_IMPORT_FIELD_VALIDATION_DATASET_EXISTS'),\n\t\t\t\t};\n\t\t\t}\n\n\t\t\tif (name.length > this.nameMaxLength)\n\t\t\t{\n\t\t\t\treturn {\n\t\t\t\t\tresult: false,\n\t\t\t\t\tmessage: this.$Bitrix.Loc.getMessage('DATASET_IMPORT_FIELD_VALIDATION_DATASET_TOO_LONG_MSGVER_1', { '#MAX_LENGHT#': this.nameMaxLength }),\n\t\t\t\t};\n\t\t\t}\n\n\t\t\tif (!/^[a-z][\\d_a-z]*$/.test(name))\n\t\t\t{\n\t\t\t\treturn {\n\t\t\t\t\tresult: false,\n\t\t\t\t\tmessage: this.$Bitrix.Loc.getMessage('DATASET_IMPORT_FIELD_VALIDATION_DATASET_INVALID_CHARS'),\n\t\t\t\t};\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\tresult: true,\n\t\t\t};\n\t\t},\n\t\tshowValidationErrors()\n\t\t{\n\t\t\tthis.$refs.datasetProperties.showValidationErrors();\n\t\t},\n\t},\n\ttemplate: `\n\t\t<Step\n\t\t\t:title=\"displayedTitle\"\n\t\t\t:hint=\"displayedHint\"\n\t\t\t:is-open-initially=\"isOpenInitially\"\n\t\t\t:disabled=\"disabled\"\n\t\t\tref=\"stepBlock\"\n\t\t>\n\t\t\t<slot name=\"additional-properties\"></slot>\n\t\t\t<DatasetProperties\n\t\t\t\t@value-change=\"onDatasetPropertiesFieldsChange\"\n\t\t\t\t:default-name=\"datasetProperties.name\"\n\t\t\t\t:default-description=\"datasetProperties.description\"\n\t\t\t\tref=\"datasetProperties\"\n\t\t\t\t:disabled-fields=\"disabledFields\"\n\t\t\t\t:unvalidated-fields=\"unvalidatedFields\"\n\t\t\t\t:dataset-source-code=\"datasetSourceCode\"\n\t\t\t/>\n\t\t</Step>\n\t`,\n};\n","import '../../css/format-table.css';\nimport 'ui.hint';\n\nexport const TableHeader = {\n\tprops: {\n\t\tenabled: {\n\t\t\ttype: Boolean,\n\t\t\trequired: false,\n\t\t\tdefault: true,\n\t\t},\n\t\tindeterminate: {\n\t\t\ttype: Boolean,\n\t\t\trequired: false,\n\t\t\tdefault: false,\n\t\t},\n\t},\n\temits: [\n\t\t'checkboxClick',\n\t],\n\tcomputed: {\n\t\tisNeedShowOriginalNameHint(): boolean\n\t\t{\n\t\t\treturn this.$store.state.config.fileProperties?.firstLineHeader ?? true;\n\t\t},\n\t},\n\tmethods: {\n\t\tonCheckboxClick(event)\n\t\t{\n\t\t\tevent.preventDefault();\n\t\t\tthis.$emit('checkboxClick');\n\t\t},\n\t},\n\t// language=Vue\n\ttemplate: `\n\t\t<tr>\n\t\t\t<th class=\"format-table__header format-table__checkbox-header\">\n\t\t\t\t<input class=\"format-table__checkbox\" type=\"checkbox\" @change=\"onCheckboxClick\" :checked=\"enabled\" :indeterminate.prop=\"indeterminate\">\n\t\t\t</th>\n\t\t\t<th class=\"format-table__header format-table__type-header format-table__type-subfield-header\">{{ $Bitrix.Loc.getMessage('DATASET_IMPORT_FIELD_SETTINGS_TYPE_HEADER') }}</th>\n\t\t\t<th class=\"format-table__header format-table__header format-table__title-header\">{{ $Bitrix.Loc.getMessage('DATASET_IMPORT_FIELD_SETTINGS_CODE_HEADER') }}</th>\n\t\t\t<th class=\"format-table__header format-table__header format-table__title-header\" v-if=\"isNeedShowOriginalNameHint\"></th>\n\t\t</tr>\n\t`,\n};\n","import { Loc } from 'main.core';\n\ntype DataTypeDescription = {\n\ttitle: string,\n\ticon: string,\n}\n\nconst DataType = {\n\tstring: 'string',\n\tmoney: 'money',\n\tint: 'int',\n\tdouble: 'double',\n\tdate: 'date',\n\tdatetime: 'datetime',\n};\n\nconst DataTypeDescriptions: Record<string, DataTypeDescription> = {\n\t[DataType.string]: {\n\t\ttitle: Loc.getMessage('DATASET_IMPORT_FIELD_SETTINGS_TYPE_TEXT'),\n\t\ticon: '--formatting',\n\t},\n\t[DataType.money]: {\n\t\ttitle: Loc.getMessage('DATASET_IMPORT_FIELD_SETTINGS_TYPE_MONEY'),\n\t\ticon: '--money',\n\t},\n\t[DataType.int]: {\n\t\ttitle: Loc.getMessage('DATASET_IMPORT_FIELD_SETTINGS_TYPE_NUMBER'),\n\t\ticon: '--numbers-123',\n\t},\n\t[DataType.double]: {\n\t\ttitle: Loc.getMessage('DATASET_IMPORT_FIELD_SETTINGS_TYPE_DECIMAL'),\n\t\ticon: '--numbers-05',\n\t},\n\t[DataType.date]: {\n\t\ttitle: Loc.getMessage('DATASET_IMPORT_FIELD_SETTINGS_TYPE_DATE'),\n\t\ticon: '--calendar-1',\n\t},\n\t[DataType.datetime]: {\n\t\ttitle: Loc.getMessage('DATASET_IMPORT_FIELD_SETTINGS_TYPE_DATETIME'),\n\t\ticon: '--planning-2',\n\t},\n};\n\ntype DataFormatTemplate = {\n\t[DataType.money]: string[],\n\t[DataType.double]: string[],\n\t[DataType.date]: string[],\n\t[DataType.datetime]: string[],\n};\n\nexport {\n\tDataType,\n\tDataTypeDescriptions,\n\tDataFormatTemplate,\n};\n","import { Menu } from 'main.popup';\nimport { DataTypeDescriptions } from '../../types/data-types';\n\ntype DataTypeMenuOptions = {\n\tselectedType: string,\n\tbindElement: HTMLElement,\n\tonSelect: Function,\n\tonClose: Function,\n};\n\nexport class DataTypeMenu\n{\n\t#selectedType: string;\n\t#bindElement: HTMLElement;\n\t#onSelect: Function;\n\t#onClose: Function;\n\n\tconstructor(options: DataTypeMenuOptions)\n\t{\n\t\tthis.#selectedType = options.selectedType;\n\t\tthis.#bindElement = options.bindElement;\n\t\tthis.#onSelect = options.onSelect;\n\t\tthis.#onClose = options.onClose;\n\t}\n\n\tgetMenu(): Menu\n\t{\n\t\tconst items = [];\n\t\tObject.entries(DataTypeDescriptions).forEach(([key, value]) => {\n\t\t\titems.push({\n\t\t\t\thtml: `\n\t\t\t\t\t<div class=\"ui-icon-set ${value.icon}\"></div>\n\t\t\t\t\t<span class=\"format-table__dropdown-item-text\">${value.title}</span>\n\t\t\t\t\t${key === this.#selectedType ? '<div class=\"format-table__dropdown-item-selected ui-icon-set --check\"></div>' : ''}\n\t\t\t\t`,\n\t\t\t\tonclick: (event, item) => {\n\t\t\t\t\tthis.#onSelect(key);\n\t\t\t\t\titem.getMenuWindow().close();\n\t\t\t\t},\n\t\t\t\tclassName: `format-table__dropdown-item${key === this.#selectedType ? ' format-table__dropdown-item--active' : ''}`,\n\t\t\t});\n\t\t});\n\n\t\treturn new Menu({\n\t\t\tclassName: 'format-table__dropdown-popup',\n\t\t\tbindElement: this.#bindElement,\n\t\t\titems,\n\t\t\tevents: {\n\t\t\t\tonClose: this.#onClose,\n\t\t\t},\n\t\t});\n\t}\n}\n","import { DataTypeMenu } from './data-type-menu';\nimport { DataTypeDescriptions } from '../../types/data-types';\n\nexport const DataTypeSelector = {\n\tprops: {\n\t\tselectedType: {\n\t\t\ttype: String,\n\t\t\trequired: false,\n\t\t\tdefault: 'text',\n\t\t},\n\t\tcanEdit: {\n\t\t\ttype: Boolean,\n\t\t\trequired: false,\n\t\t\tdefault: false,\n\t\t},\n\t\tdisabled: {\n\t\t\ttype: Boolean,\n\t\t\trequired: false,\n\t\t\tdefault: false,\n\t\t},\n\t},\n\temits: [\n\t\t'valueChange',\n\t],\n\tdata()\n\t{\n\t\treturn {\n\t\t\ttypeMenu: null,\n\t\t\tisFocused: false,\n\t\t};\n\t},\n\tcomputed: {\n\t\ticonClass()\n\t\t{\n\t\t\treturn DataTypeDescriptions[this.selectedType].icon;\n\t\t},\n\t\ttypeTitle()\n\t\t{\n\t\t\treturn DataTypeDescriptions[this.selectedType].title;\n\t\t},\n\t\tisEditable()\n\t\t{\n\t\t\treturn this.canEdit;\n\t\t},\n\t},\n\tmethods: {\n\t\tonClick(event)\n\t\t{\n\t\t\tif (!this.isEditable)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.isFocused = true;\n\n\t\t\tif (!this.typeMenu)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.typeMenu.getPopupWindow().setWidth(this.$refs.formatButton.offsetWidth);\n\t\t\tthis.typeMenu.show();\n\t\t},\n\t\tcreateMenu()\n\t\t{\n\t\t\tif (this.isEditable)\n\t\t\t{\n\t\t\t\tthis.typeMenu = (new DataTypeMenu({\n\t\t\t\t\tselectedType: this.selectedType,\n\t\t\t\t\tbindElement: this.$refs.formatButton,\n\t\t\t\t\tonSelect: (selectedType) => {\n\t\t\t\t\t\tthis.$emit('valueChange', selectedType);\n\t\t\t\t\t},\n\t\t\t\t\tonClose: () => {\n\t\t\t\t\t\tthis.isFocused = false;\n\t\t\t\t\t},\n\t\t\t\t})).getMenu();\n\t\t\t}\n\t\t},\n\t\tdestroyMenu()\n\t\t{\n\t\t\tthis.typeMenu?.destroy();\n\t\t},\n\t},\n\tmounted()\n\t{\n\t\tthis.createMenu();\n\t},\n\tbeforeUnmount()\n\t{\n\t\tthis.destroyMenu();\n\t},\n\twatch: {\n\t\tselectedType(newValue)\n\t\t{\n\t\t\tthis.destroyMenu();\n\t\t\tthis.createMenu();\n\t\t},\n\t\tisEditable(newValue)\n\t\t{\n\t\t\tif (newValue && !this.typeMenu)\n\t\t\t{\n\t\t\t\tthis.createMenu();\n\t\t\t}\n\n\t\t\tif (!newValue)\n\t\t\t{\n\t\t\t\tthis.destroyMenu();\n\t\t\t}\n\t\t}\n\t},\n\t// language=Vue\n\ttemplate: `\n\t\t<div\n\t\t\tclass=\"ui-ctl ui-ctl-before-icon ui-ctl-after-icon ui-ctl-w100 format-table__type-control ui-ctl-dropdown\"\n\t\t\tref=\"formatButton\"\n\t\t\t@click=\"onClick\"\n\t\t\t:class=\"{\n\t\t\t\t'format-table__type-control--disabled': !isEditable,\n\t\t\t\t'ui-ctl-hover': isFocused,\n\t\t\t}\"\n\t\t>\n\t\t\t<div class=\"ui-ctl-after ui-ctl-icon-angle\" v-if=\"isEditable\"></div>\n\t\t\t<div class=\"ui-ctl-before\">\n\t\t\t\t<div class=\"format-table__type-button\" :class=\"{ 'format-table__type-button--disabled': !isEditable }\">\n\t\t\t\t\t<div class=\"ui-icon-set\" :class=\"iconClass\"></div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div class=\"ui-ctl-element format-table__text-input\">\n\t\t\t\t<span>{{ typeTitle }}</span>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import '../../css/format-table.css';\nimport { ErrorPopup } from '../../layout/error-popup';\nimport { DataTypeDescriptions } from '../../types/data-types';\nimport { DataTypeSelector } from './data-type-selector';\nimport { BIcon, Set } from 'ui.icon-set.api.vue';\nimport { hint } from 'ui.vue3.directives.hint';\n\nexport const TableRow = {\n\tdirectives: {\n\t\thint,\n\t},\n\tprops: {\n\t\tenabled: {\n\t\t\ttype: Boolean,\n\t\t\trequired: false,\n\t\t\tdefault: true,\n\t\t},\n\t\tindex: {\n\t\t\ttype: Number,\n\t\t\trequired: true,\n\t\t},\n\t\tfieldSettings: {\n\t\t\ttype: Object,\n\t\t\trequired: false,\n\t\t\tdefault: null,\n\t\t},\n\t\tinvalidFields: {\n\t\t\ttype: Object,\n\t\t\trequired: false,\n\t\t\tdefault: {},\n\t\t},\n\t\tdisabledElements: {\n\t\t\ttype: Object,\n\t\t\trequired: false,\n\t\t\tdefault: null,\n\t\t},\n\t\tisEditMode: {\n\t\t\ttype: Boolean,\n\t\t\trequired: false,\n\t\t\tdefault: false,\n\t\t},\n\t\tsourceType: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tdata()\n\t{\n\t\treturn {\n\t\t\tdisplayedValidationErrors: {\n\t\t\t\tname: true,\n\t\t\t},\n\t\t\terrorPopup: {\n\t\t\t\tname: null,\n\t\t\t},\n\t\t\terrorPopupTimeout: null,\n\t\t};\n\t},\n\tcomputed: {\n\t\tisNameValid(): boolean\n\t\t{\n\t\t\treturn !('name' in this.invalidFields);\n\t\t},\n\t\tdisplayedErrorForName(): string\n\t\t{\n\t\t\treturn this.invalidFields.name.message;\n\t\t},\n\t\tset(): Set\n\t\t{\n\t\t\treturn Set;\n\t\t},\n\t\toriginalsHintText(): string\n\t\t{\n\t\t\tconst originalType = this.fieldSettings.originalType;\n\t\t\tconst originalName = this.fieldSettings.originalName;\n\n\t\t\tlet typeText = '';\n\t\t\tif (originalType)\n\t\t\t{\n\t\t\t\ttypeText = this.$Bitrix.Loc.getMessage('DATASET_IMPORT_FIELD_SETTINGS_ORIG_TYPE', {\n\t\t\t\t\t'#CLASS#': '<span class=\"format-table__orig_info_title\">',\n\t\t\t\t\t'#/CLASS#': '</span>',\n\t\t\t\t\t'#TYPENAME#': DataTypeDescriptions[originalType].title,\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tconst nameText = this.$Bitrix.Loc.getMessage('DATASET_IMPORT_FIELD_SETTINGS_ORIG_NAME', {\n\t\t\t\t'#CLASS#': '<span class=\"format-table__orig_info_title\">',\n\t\t\t\t'#/CLASS#': '</span>',\n\t\t\t\t'#FIELDNAME#': originalName,\n\t\t\t});\n\n\t\t\tif (!originalType)\n\t\t\t{\n\t\t\t\treturn nameText;\n\t\t\t}\n\n\t\t\treturn `${typeText}<br>${nameText}`;\n\t\t},\n\t\tisNeedShowOriginalNameHint(): boolean\n\t\t{\n\t\t\treturn (this.$store.state.config.fileProperties?.firstLineHeader ?? true)\n\t\t\t\t&& this.$store.state.config.connectionProperties?.connectionType\n\t\t\t\t&& this.$store.state.config.connectionProperties?.connectionType !== 'rest'\n\t\t\t;\n\t\t},\n\t\thintOptions(): Object\n\t\t{\n\t\t\treturn {\n\t\t\t\thtml: this.originalsHintText,\n\t\t\t\tpopupOptions: {\n\t\t\t\t\tangle: {\n\t\t\t\t\t\tposition: 'left',\n\t\t\t\t\t},\n\t\t\t\t\toffsetLeft: 30,\n\t\t\t\t\toffsetTop: -46,\n\t\t\t\t\tautoHide: false,\n\t\t\t\t},\n\t\t\t};\n\t\t},\n\t\tsourceTypeCsv(): boolean\n\t\t{\n\t\t\treturn this.sourceType === 'csv';\n\t\t},\n\t\tsourceTypeExternal(): boolean\n\t\t{\n\t\t\treturn this.sourceType === 'external';\n\t\t},\n\t\tcanEditType(): boolean\n\t\t{\n\t\t\treturn !this.isEditMode && this.sourceTypeCsv;\n\t\t},\n\t\tcanEditName(): boolean\n\t\t{\n\t\t\tconst isNew = !Boolean(this.fieldSettings?.id > 0);\n\n\t\t\treturn isNew || (this.fieldSettings?.visible && this.sourceTypeExternal);\n\t\t},\n\t},\n\temits: [\n\t\t'checkboxClick',\n\t\t'fieldChange',\n\t],\n\tmethods: {\n\t\tonCheckboxClick(event)\n\t\t{\n\t\t\tevent.preventDefault();\n\t\t\tthis.$emit('checkboxClick', {\n\t\t\t\tindex: this.index,\n\t\t\t});\n\t\t},\n\t\tonTypeSelected(type)\n\t\t{\n\t\t\tthis.$emit('fieldChange', {\n\t\t\t\tfieldName: 'type',\n\t\t\t\tvalue: type,\n\t\t\t\tindex: this.index,\n\t\t\t});\n\t\t},\n\t\tonFieldInput(event)\n\t\t{\n\t\t\tif (!this.canEditName || this.disabledElements?.name)\n\t\t\t{\n\t\t\t\tconst input = event.target;\n\t\t\t\tinput.value = this.fieldSettings.name;\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.displayedValidationErrors[event.target.name] = false;\n\t\t\tthis.$emit('fieldChange', {\n\t\t\t\tfieldName: event.target.name,\n\t\t\t\tvalue: event.target.value,\n\t\t\t\tindex: this.index,\n\t\t\t});\n\t\t},\n\t\tonFieldBlur(event)\n\t\t{\n\t\t\tthis.displayedValidationErrors[event.target.name] = true;\n\n\t\t\tif ('name' in this.invalidFields)\n\t\t\t{\n\t\t\t\tthis.showErrorHint();\n\t\t\t\tthis.errorPopupTimeout = setTimeout(() => {\n\t\t\t\t\tthis.hideErrorHint();\n\t\t\t\t\tthis.errorPopupTimeout = null;\n\t\t\t\t}, 3000);\n\t\t\t}\n\t\t},\n\t\tshowValidationErrors()\n\t\t{\n\t\t\tObject.keys(this.displayedValidationErrors).forEach((field) => {\n\t\t\t\tthis.displayedValidationErrors[field] = true;\n\t\t\t});\n\t\t},\n\t\tshowErrorHint()\n\t\t{\n\t\t\tif (this.errorPopupTimeout)\n\t\t\t{\n\t\t\t\tclearTimeout(this.errorPopupTimeout);\n\t\t\t\tthis.errorPopupTimeout = null;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.errorPopup.name = this.createErrorPopup();\n\t\t\t\tthis.errorPopup.name.show();\n\t\t\t}\n\t\t},\n\t\thideErrorHint()\n\t\t{\n\t\t\tif (this.errorPopup.name)\n\t\t\t{\n\t\t\t\tthis.errorPopup.name.close();\n\t\t\t}\n\t\t},\n\t\tcreateErrorPopup()\n\t\t{\n\t\t\treturn ErrorPopup.create(this.displayedErrorForName, this.$refs.errorIconWrapper);\n\t\t},\n\t},\n\twatch: {\n\t\tisNeedShowOriginalNameHint()\n\t\t{\n\t\t\tif (this.$refs.originalsHint)\n\t\t\t{\n\t\t\t\tthis.$refs.originalsHint.remove();\n\t\t\t}\n\t\t},\n\t},\n\tcomponents: {\n\t\tDataTypeButton: DataTypeSelector,\n\t\tBIcon,\n\t},\n\t// language=Vue\n\ttemplate: `\n\t\t<tr class=\"format-table__row\">\n\t\t\t<td class=\"format-table__checkbox-cell\">\n\t\t\t\t<input class=\"format-table__checkbox\" ref=\"visibilityCheckbox\" type=\"checkbox\" @change=\"onCheckboxClick\" :checked=\"enabled\">\n\t\t\t</td>\n\t\t\t<td class=\"format-table__cell\">\n\t\t\t\t<DataTypeButton :selected-type=\"fieldSettings.type\" @value-change=\"onTypeSelected\" :can-edit=\"canEditType && !disabledElements?.type\" :disabled=\"!canEditType || disabledElements?.type\"/>\n\t\t\t</td>\n\t\t\t<td class=\"format-table__cell\">\n\t\t\t\t<div\n\t\t\t\t\tclass=\"ui-ctl ui-ctl-textbox ui-ctl-w100 format-table__name-control\"\n\t\t\t\t\t:class=\"{\n\t\t\t\t\t\t'format-table__text-input--invalid': displayedValidationErrors.name && !isNameValid,\n\t\t\t\t\t\t'format-table__text-input--disabled': !canEditName || disabledElements?.name,\n\t\t\t\t\t\t'ui-ctl-after-icon': canEditName && !isNameValid,\n\t\t\t\t\t}\"\n\t\t\t\t>\n\t\t\t\t\t<input\n\t\t\t\t\t\tclass=\"ui-ctl-element format-table__text-input format-table__name-input\"\n\t\t\t\t\t\t:disabled=\"!canEditName || disabledElements?.name\"\n\t\t\t\t\t\ttype=\"text\"\n\t\t\t\t\t\t:placeholder=\"$Bitrix.Loc.getMessage('DATASET_IMPORT_FIELD_SETTINGS_PLACEHOLDER')\"\n\t\t\t\t\t\tname=\"name\"\n\t\t\t\t\t\t@input=\"onFieldInput\"\n\t\t\t\t\t\t@blur=\"onFieldBlur\"\n\t\t\t\t\t\t:value=\"fieldSettings.name\"\n\t\t\t\t\t>\n\t\t\t\t\t<div class=\"ui-ctl-after\" ref=\"errorIconWrapper\">\n\t\t\t\t\t\t<div\n\t\t\t\t\t\t\tclass=\"ui-icon-set --warning format-table__error-icon\"\n\t\t\t\t\t\t\t@mouseenter=\"showErrorHint\"\n\t\t\t\t\t\t\t@mouseleave=\"hideErrorHint\"\n\t\t\t\t\t\t\tv-if=\"displayedValidationErrors.name && !isNameValid\"\n\t\t\t\t\t\t></div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</td>\n\t\t\t<td class=\"format-table__cell\" v-if=\"isNeedShowOriginalNameHint\">\n\t\t\t\t<div class=\"format-table__orig-type-hint-wrapper\" v-hint=\"hintOptions\" ref=\"originalsHint\">\n\t\t\t\t\t<div class=\"format-table__orig-type-hint\">\n\t\t\t\t\t\t<BIcon\n\t\t\t\t\t\t\t:name=\"set.INFO_1\"\n\t\t\t\t\t\t\t:size=\"20\"\n\t\t\t\t\t\t\tcolor=\"#B5BABE\"\n\t\t\t\t\t\t></BIcon>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</td>\n\t\t</tr>\n\t`,\n};\n","import { TableHeader } from './table-header';\nimport { TableRow } from './table-row';\nimport '../../css/format-table.css';\n\nexport const FormatTable = {\n\tprops: {\n\t\tfieldsSettings: {\n\t\t\ttype: Array,\n\t\t\trequired: false,\n\t\t},\n\t\tunvalidatedRows: {\n\t\t\ttype: Object,\n\t\t\trequired: false,\n\t\t},\n\t\tdisabledElements: {\n\t\t\ttype: Object,\n\t\t\trequired: false,\n\t\t\tdefault: null,\n\t\t},\n\t\tisEditMode: {\n\t\t\ttype: Boolean,\n\t\t\trequired: false,\n\t\t\tdefault: false,\n\t\t},\n\t\tsourceType: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t},\n\temits: [\n\t\t'rowToggle',\n\t\t'headerToggle',\n\t\t'rowFieldChanged',\n\t],\n\tcomputed: {\n\t\tareAllRowsVisible()\n\t\t{\n\t\t\treturn this.$store.getters.areAllRowsVisible;\n\t\t},\n\t\tareNoRowsVisible()\n\t\t{\n\t\t\treturn this.$store.getters.areNoRowsVisible;\n\t\t},\n\t\tareSomeRowsVisible()\n\t\t{\n\t\t\treturn this.$store.getters.areSomeRowsVisible;\n\t\t},\n\t},\n\tmethods: {\n\t\tonRowCheckboxClicked(event)\n\t\t{\n\t\t\tthis.$emit('rowToggle', event);\n\t\t},\n\t\tonHeaderCheckboxClicked()\n\t\t{\n\t\t\tthis.$emit('headerToggle');\n\t\t},\n\t\tonRowFieldChanged(event)\n\t\t{\n\t\t\tthis.$emit('rowFieldChanged', event);\n\t\t},\n\t\tshowValidationErrors()\n\t\t{\n\t\t\tconst rowIndices = Object.keys(this.unvalidatedRows);\n\t\t\trowIndices.forEach((index) => {\n\t\t\t\tif (this.$refs.row[index])\n\t\t\t\t{\n\t\t\t\t\tthis.$refs.row[index].showValidationErrors();\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\t},\n\tcomponents: {\n\t\tTableHeader,\n\t\tTableRow,\n\t},\n\t// language=Vue\n\ttemplate: `\n\t\t<table class=\"format-table\">\n\t\t\t<thead>\n\t\t\t\t<TableHeader :enabled=\"areAllRowsVisible\" :indeterminate=\"areSomeRowsVisible\" @checkbox-click=\"onHeaderCheckboxClicked\" />\n\t\t\t</thead>\n\t\t\t<tbody>\n\t\t\t\t<template v-for=\"(field, index) in fieldsSettings\" :key=\"index\">\n\t\t\t\t\t<TableRow\n\t\t\t\t\t\tref=\"row\"\n\t\t\t\t\t\t:index=\"index\"\n\t\t\t\t\t\t:enabled=\"field.visible\"\n\t\t\t\t\t\t:field-settings=\"field\"\n\t\t\t\t\t\t@checkbox-click=\"onRowCheckboxClicked\"\n\t\t\t\t\t\t@field-change=\"onRowFieldChanged\"\n\t\t\t\t\t\t:invalid-fields=\"unvalidatedRows[index] ?? []\"\n\t\t\t\t\t\t:disabled-elements=\"disabledElements\"\n\t\t\t\t\t\t:is-edit-mode=\"isEditMode\"\n\t\t\t\t\t\t:source-type=\"sourceType\"\n\t\t\t\t\t/>\n\t\t\t\t</template>\n\t\t\t</tbody>\n\t\t</table>\n\t`,\n};\n","import '../../css/fields-settings.css';\n\nexport const SyncFieldsButton = {\n\temits: ['buttonClick'],\n\tprops: {\n\t\tdisabled: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t},\n\tcomputed: {\n\t\tisDisabled(): boolean\n\t\t{\n\t\t\treturn this.disabled;\n\t\t},\n\t},\n\tmethods: {\n\t\tonButtonClick()\n\t\t{\n\t\t\tthis.$emit('buttonClick');\n\t\t},\n\t},\n\t// language=Vue\n\ttemplate: `\n\t\t<div class=\"ui-form-row\">\n\t\t\t<button :disabled=\"isDisabled\" class=\"ui-btn ui-btn-sm ui-btn-primary ui-btn-no-caps\" @click=\"onButtonClick\">\n\t\t\t\t{{ $Bitrix.Loc.getMessage('DATASET_IMPORT_SYNC_FIELDS_BUTTON') }}\n\t\t\t</button>\n\t\t</div>\n\t`,\n};\n","import { StepBlock } from '../layout/step-block';\nimport { BaseStep } from './base-step';\nimport { FormatTable } from './data-type/format-table';\nimport { SyncFieldsButton } from './data-type/sync-fields-button';\nimport '../css/fields-settings.css';\n\nexport const FieldsSettingsStep = {\n\temits: ['parsingOptionsChanged', 'settingsChanged', 'syncFields'],\n\textends: BaseStep,\n\tprops: {\n\t\tsyncFieldsProps: {\n\t\t\ttype: Object,\n\t\t\tdefault: {\n\t\t\t\tsupported: false,\n\t\t\t\tdisabled: true,\n\t\t\t},\n\t\t},\n\t},\n\tcomputed: {\n\t\tfieldsSettings()\n\t\t{\n\t\t\treturn this.$store.state.config.fieldsSettings;\n\t\t},\n\t\tdefaultTitle()\n\t\t{\n\t\t\treturn this.$Bitrix.Loc.getMessage('DATASET_IMPORT_FIELDS_SETTINGS_HEADER');\n\t\t},\n\t\tdefaultHint()\n\t\t{\n\t\t\tif (this.isEditMode)\n\t\t\t{\n\t\t\t\treturn this.$Bitrix.Loc.getMessage('DATASET_IMPORT_FIELDS_SETTINGS_HINT_EDIT')\n\t\t\t\t\t.replace('[link]', '<a onclick=\"top.BX.Helper.show(`redirect=detail&code=23378698`)\">')\n\t\t\t\t\t.replace('[/link]', '</a>')\n\t\t\t\t;\n\t\t\t}\n\n\t\t\treturn this.$Bitrix.Loc.getMessage('DATASET_IMPORT_FIELDS_SETTINGS_HINT')\n\t\t\t\t.replace('[link]', '<a onclick=\"top.BX.Helper.show(`redirect=detail&code=23378698`)\">')\n\t\t\t\t.replace('[/link]', '</a>')\n\t\t\t;\n\t\t},\n\t\tunvalidatedRows()\n\t\t{\n\t\t\tconst rows = {};\n\n\t\t\tthis.$store.state.config.fieldsSettings.forEach((field, index) => {\n\t\t\t\tconst invalidFields = {};\n\n\t\t\t\tif (field.visible || this.sourceTypeCsv || !field.name)\n\t\t\t\t{\n\t\t\t\t\tconst nameValidationResult = this.validateName(field.name);\n\t\t\t\t\tif (!nameValidationResult.result)\n\t\t\t\t\t{\n\t\t\t\t\t\tinvalidFields.name = nameValidationResult;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (Object.keys(invalidFields).length > 0)\n\t\t\t\t{\n\t\t\t\t\trows[index] = invalidFields;\n\t\t\t\t}\n\t\t\t});\n\n\t\t\treturn rows;\n\t\t},\n\t\tisEditMode()\n\t\t{\n\t\t\treturn this.$store.getters.isEditMode;\n\t\t},\n\t\tisSyncSupported(): boolean\n\t\t{\n\t\t\treturn this.syncFieldsProps.supported;\n\t\t},\n\t\tisSyncDisabled(): boolean\n\t\t{\n\t\t\treturn this.syncFieldsProps.disabled;\n\t\t},\n\t},\n\tmethods: {\n\t\tvalidateName(name)\n\t\t{\n\t\t\tconst isNotEmpty = name.length > 0;\n\t\t\tif (!isNotEmpty)\n\t\t\t{\n\t\t\t\treturn {\n\t\t\t\t\tresult: false,\n\t\t\t\t\tmessage: this.$Bitrix.Loc.getMessage('DATASET_IMPORT_FIELD_VALIDATION_EMPTY_ERROR'),\n\t\t\t\t};\n\t\t\t}\n\n\t\t\tconst isTooLong = name.length > 32;\n\t\t\tif (isTooLong)\n\t\t\t{\n\t\t\t\treturn {\n\t\t\t\t\tresult: false,\n\t\t\t\t\tmessage: this.$Bitrix.Loc.getMessage('DATASET_IMPORT_FIELD_VALIDATION_FIELD_TOO_LONG'),\n\t\t\t\t};\n\t\t\t}\n\n\t\t\t// only numbers, uppercase letters and underscores; starts with a letter\n\t\t\tconst areCharactersValid = /^[A-Z](?=.*[A-Z_])[A-Z0-9_]*$/.test(name);\n\t\t\tif (!areCharactersValid)\n\t\t\t{\n\t\t\t\treturn {\n\t\t\t\t\tresult: false,\n\t\t\t\t\tmessage: this.$Bitrix.Loc.getMessage('DATASET_IMPORT_FIELD_VALIDATION_FIELD_INVALID_CHARS'),\n\t\t\t\t};\n\t\t\t}\n\n\t\t\tconst isAlreadyUsed = this.$store.getters.previewHeaders.reduce((\n\t\t\t\tcount,\n\t\t\t\tvalue,\n\t\t\t) => (name === value ? count + 1 : count), 0) > 1;\n\t\t\tif (isAlreadyUsed)\n\t\t\t{\n\t\t\t\treturn {\n\t\t\t\t\tresult: false,\n\t\t\t\t\tmessage: this.$Bitrix.Loc.getMessage('DATASET_IMPORT_FIELD_VALIDATION_FIELD_ALREADY_USED'),\n\t\t\t\t};\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\tresult: true,\n\t\t\t};\n\t\t},\n\t\tonRowToggled(event)\n\t\t{\n\t\t\tthis.$store.commit('toggleRowVisibility', event.index);\n\t\t\tthis.$emit('settingsChanged');\n\n\t\t\tthis.validate();\n\t\t},\n\t\tonHeaderToggled(event)\n\t\t{\n\t\t\tif (this.$store.getters.areAllRowsVisible)\n\t\t\t{\n\t\t\t\tthis.$store.commit('setAllRowsInvisible');\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.$store.commit('setAllRowsVisible');\n\t\t\t}\n\n\t\t\tthis.$emit('settingsChanged');\n\n\t\t\tthis.validate();\n\t\t},\n\t\tonRowFieldChanged(event)\n\t\t{\n\t\t\tthis.fieldsSettings[event.index][event.fieldName] = event.value;\n\t\t\tthis.$store.commit('setFieldRowSettings', {\n\t\t\t\tindex: event.index,\n\t\t\t\tsettings: this.fieldsSettings[event.index],\n\t\t\t});\n\n\t\t\tif (event.fieldName === 'type')\n\t\t\t{\n\t\t\t\tthis.$emit('parsingOptionsChanged');\n\t\t\t}\n\n\t\t\tthis.$emit('settingsChanged');\n\n\t\t\tthis.validate();\n\t\t},\n\t\tvalidate()\n\t\t{\n\t\t\tconst result = Object.keys(this.unvalidatedRows).length === 0;\n\n\t\t\tthis.$emit('validation', result);\n\t\t},\n\t\tshowValidationErrors()\n\t\t{\n\t\t\tthis.$refs.formatTable.showValidationErrors();\n\t\t},\n\t},\n\tcomponents: {\n\t\tStep: StepBlock,\n\t\tFormatTable,\n\t\tSyncFieldsButton,\n\t},\n\t// language=Vue\n\ttemplate: `\n\t\t<Step\n\t\t\t:title=\"displayedTitle\"\n\t\t\t:hint=\"displayedHint\"\n\t\t\t:is-open-initially=\"isOpenInitially\"\n\t\t\t:disabled=\"disabled\"\n\t\t\tref=\"stepBlock\"\n\t\t>\n\t\t\t<SyncFieldsButton v-if=\"isSyncSupported\" :disabled=\"isSyncDisabled\" @button-click=\"this.$emit('syncFields')\"/>\n\t\t\t<div class=\"ui-form-row fields-settings\">\n\t\t\t\t<FormatTable\n\t\t\t\t\t:fields-settings=\"fieldsSettings\"\n\t\t\t\t\t:disabled-elements=\"disabledElements\"\n\t\t\t\t\t@row-toggle=\"onRowToggled\"\n\t\t\t\t\t@header-toggle=\"onHeaderToggled\"\n\t\t\t\t\t@row-field-changed=\"onRowFieldChanged\"\n\t\t\t\t\t:unvalidated-rows=\"unvalidatedRows\"\n\t\t\t\t\tref=\"formatTable\"\n\t\t\t\t\t:is-edit-mode=\"isEditMode\"\n\t\t\t\t\t:source-type=\"sourceType\"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t</Step>\n\t`,\n};\n","import { Dom, Event, Loc, Tag } from 'main.core';\nimport { Layout } from 'ui.sidepanel.layout';\nimport '../../css/format-selector.css';\nimport { DataType } from '../../types/data-types';\nimport type { DataFormatTemplate } from '../../types/data-types';\n\ntype DropdownControlOptions = {\n\ttitle: string,\n\tsubtitle: string,\n\toptions: Option[],\n\tfieldType: string,\n\tselected: string,\n};\n\nconst OptionType = {\n\tCUSTOM: 'custom',\n\tVALUE: 'value',\n};\n\ntype Option = {\n\ttitle: string,\n\ttype: OptionType.CUSTOM | OptionType.VALUE,\n\tvalue: string,\n};\n\nexport class FormatSelector\n{\n\tstatic openSlider(selected: Object, dataFormatTemplates: DataFormatTemplate, onClose: function)\n\t{\n\t\tBX.SidePanel.Instance.open('biconnector:import-field-formats', {\n\t\t\twidth: 584,\n\t\t\tcontentCallback: () => {\n\t\t\t\treturn Layout.createContent({\n\t\t\t\t\textensions: ['ui.forms', 'ui.layout-form', 'ui.alerts', 'biconnector.dataset-import'],\n\t\t\t\t\ttitle: Loc.getMessage('DATASET_IMPORT_FIELD_FORMAT_SELECTOR_TITLE'),\n\t\t\t\t\tcontent()\n\t\t\t\t\t{\n\t\t\t\t\t\treturn FormatSelector.#getContent(selected, dataFormatTemplates);\n\t\t\t\t\t},\n\t\t\t\t\tbuttons({ cancelButton, SaveButton })\n\t\t\t\t\t{\n\t\t\t\t\t\treturn [\n\t\t\t\t\t\t\tnew SaveButton({\n\t\t\t\t\t\t\t\tonclick: () => {\n\t\t\t\t\t\t\t\t\t// hack: using a singleton instance to store the form didn't work\n\t\t\t\t\t\t\t\t\tconst form = BX.SidePanel.Instance.getTopSlider().getContainer().querySelector('#formatSelectorForm');\n\t\t\t\t\t\t\t\t\tonClose(FormatSelector.#extractValues(form));\n\t\t\t\t\t\t\t\t\tBX.SidePanel.Instance.close();\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\tcancelButton,\n\t\t\t\t\t\t];\n\t\t\t\t\t},\n\t\t\t\t});\n\t\t\t},\n\t\t\tcacheable: false,\n\t\t});\n\t}\n\n\tstatic #extractValues(form): Object\n\t{\n\t\tconst formData = new FormData(form);\n\n\t\tconst result = Object.fromEntries(formData);\n\n\t\tconst customFieldsToExtract = ['date', 'datetime'];\n\n\t\tcustomFieldsToExtract.forEach((field) => {\n\t\t\tif (result[field] === 'custom')\n\t\t\t{\n\t\t\t\tresult[field] = result[`${field}CustomValue`];\n\t\t\t}\n\n\t\t\tdelete result[`${field}CustomValue`];\n\t\t});\n\n\t\treturn result;\n\t}\n\n\tstatic #getContent(selected: Object, dataFormatTemplates: DataFormatTemplate): HTMLElement\n\t{\n\t\tconst formRoot = Tag.render`\n\t\t\t<form class=\"ui-form\" id=\"formatSelectorForm\">\n\t\t\t</form>\n\t\t`;\n\n\t\tDom.append(FormatSelector.#getDropdownControl({\n\t\t\ttitle: Loc.getMessage('DATASET_IMPORT_FIELD_FORMAT_SELECTOR_DATE'),\n\t\t\tsubtitle: Loc.getMessage('DATASET_IMPORT_FIELD_FORMAT_SELECTOR_DATE_HINT'),\n\t\t\toptions: dataFormatTemplates[DataType.date],\n\t\t\tfieldType: DataType.date,\n\t\t\tselected: selected[DataType.date],\n\t\t}), formRoot);\n\n\t\tDom.append(FormatSelector.#getDropdownControl({\n\t\t\ttitle: Loc.getMessage('DATASET_IMPORT_FIELD_FORMAT_SELECTOR_DATETIME'),\n\t\t\tsubtitle: Loc.getMessage('DATASET_IMPORT_FIELD_FORMAT_SELECTOR_DATETIME_HINT'),\n\t\t\toptions: dataFormatTemplates[DataType.datetime],\n\t\t\tfieldType: DataType.datetime,\n\t\t\tselected: selected[DataType.datetime],\n\t\t}), formRoot);\n\n\t\tDom.append(FormatSelector.#getDropdownControl({\n\t\t\ttitle: Loc.getMessage('DATASET_IMPORT_FIELD_FORMAT_SELECTOR_MONEY'),\n\t\t\tsubtitle: Loc.getMessage('DATASET_IMPORT_FIELD_FORMAT_SELECTOR_MONEY_HINT'),\n\t\t\toptions: dataFormatTemplates[DataType.money],\n\t\t\tfieldType: DataType.money,\n\t\t\tselected: selected[DataType.money],\n\t\t}), formRoot);\n\n\t\tDom.append(FormatSelector.#getDropdownControl({\n\t\t\ttitle: Loc.getMessage('DATASET_IMPORT_FIELD_FORMAT_SELECTOR_DOUBLE'),\n\t\t\tsubtitle: Loc.getMessage('DATASET_IMPORT_FIELD_FORMAT_SELECTOR_DOUBLE_HINT'),\n\t\t\toptions: dataFormatTemplates[DataType.double],\n\t\t\tfieldType: DataType.double,\n\t\t\tselected: selected[DataType.double],\n\t\t}), formRoot);\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"format-selector\">\n\t\t\t\t<div class=\"ui-alert ui-alert-primary format-selector__hint\">\n\t\t\t\t\t<span class=\"ui-alert-message\">\n\t\t\t\t\t\t${Loc.getMessage('DATASET_IMPORT_FIELD_FORMAT_SELECTOR_HINT', {\n\t\t\t\t\t\t\t'[link]': '<a onclick=\"top.BX.Helper.show(`redirect=detail&code=23378698`)\">',\n\t\t\t\t\t\t\t'[/link]': '</a>',\n\t\t\t\t\t\t})}\n\t\t\t\t\t</span>\n\t\t\t\t</div>\n\t\t\t\t${formRoot}\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tstatic #getDropdownControl(options: DropdownControlOptions): HTMLElement\n\t{\n\t\tconst selectRoot = Tag.render`\n\t\t\t<select class=\"ui-ctl-element\" name=\"${options.fieldType}\">\n\t\t\t</select>\n\t\t`;\n\n\t\tlet isCustomSelected = true;\n\t\tlet customElement = null;\n\t\tlet customOptionInput = null;\n\n\t\toptions.options.forEach((option) => {\n\t\t\tlet optionElement = '';\n\n\t\t\tconst isSelected = option.value === options.selected;\n\t\t\tif (isSelected)\n\t\t\t{\n\t\t\t\tisCustomSelected = false;\n\t\t\t}\n\n\t\t\tif (option.type === OptionType.VALUE)\n\t\t\t{\n\t\t\t\toptionElement = Tag.render`\n\t\t\t\t\t<option ${option.value === options.selected ? 'selected' : ''} value=\"${option.value}\">${option.title}</option>\n\t\t\t\t`;\n\t\t\t}\n\t\t\telse if (option.type === OptionType.CUSTOM)\n\t\t\t{\n\t\t\t\tcustomElement = Tag.render`\n\t\t\t\t\t<option value=\"custom\">${Loc.getMessage('DATASET_IMPORT_FIELD_FORMAT_SELECTOR_CUSTOM_FORMAT')}</option>\n\t\t\t\t`;\n\t\t\t\toptionElement = customElement;\n\n\t\t\t\tcustomOptionInput = Tag.render`\n\t\t\t\t\t<div class=\"ui-ctl ui-ctl-textbox ui-ctl-w100 format-selector__custom-value-input format-selector__custom-value-input--hidden\">\n\t\t\t\t\t\t<input class=\"ui-ctl-element\" name=\"${options.fieldType}CustomValue\" type=\"text\" placeholder=\"...\" value=\"${option.value ?? ''}\">\n\t\t\t\t\t</div>\n\t\t\t\t`;\n\n\t\t\t\tEvent.bind(selectRoot, 'change', (event) => {\n\t\t\t\t\tconst value = event.target.value;\n\t\t\t\t\tif (value === 'custom')\n\t\t\t\t\t{\n\t\t\t\t\t\tDom.removeClass(customOptionInput, 'format-selector__custom-value-input--hidden');\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tDom.addClass(customOptionInput, 'format-selector__custom-value-input--hidden');\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tDom.append(optionElement, selectRoot);\n\t\t});\n\n\t\tif (isCustomSelected)\n\t\t{\n\t\t\tif (customElement)\n\t\t\t{\n\t\t\t\tcustomElement.setAttribute('selected', true);\n\t\t\t}\n\n\t\t\tif (customOptionInput)\n\t\t\t{\n\t\t\t\tcustomOptionInput.querySelector('input').value = options.selected;\n\t\t\t\tDom.removeClass(customOptionInput, 'format-selector__custom-value-input--hidden');\n\t\t\t}\n\t\t}\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"ui-form-row\">\n\t\t\t\t<div class=\"ui-form-label\">\n\t\t\t\t\t<div class=\"ui-ctl-label-text\">\n\t\t\t\t\t\t${options.title}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"format-selector__type-subtitle\">\n\t\t\t\t\t\t${options.subtitle}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"ui-ctl ui-ctl-after-icon ui-ctl-dropdown ui-ctl-w100\">\n\t\t\t\t\t<div class=\"ui-ctl-after ui-ctl-icon-angle\"></div>\n\t\t\t\t\t${selectRoot}\n\t\t\t\t</div>\n\t\t\t\t${customOptionInput}\n\t\t\t</div>\n\t\t`;\n\t}\n}\n","import '../../css/fields-settings.css';\nimport 'ui.icon-set.crm';\n\nexport const SliderButton = {\n\t// language=Vue\n\ttemplate: `\n\t\t<div class=\"ui-form-row\">\n\t\t\t<div class=\"ui-ctl ui-ctl-before-icon ui-ctl-after-icon ui-ctl-w100 fields-settings__slider-button\">\n\t\t\t\t<div class=\"ui-ctl-before\">\n\t\t\t\t\t<div class=\"ui-icon-set --form-settings fields-settings__slider-icon\"></div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"ui-ctl-after ui-ctl-icon-angle fields-settings__slider-chevron\">\n\t\t\t\t</div>\n\t\t\t\t<div class=\"ui-ctl-element\">\n\t\t\t\t\t{{ this.$Bitrix.Loc.getMessage('DATASET_IMPORT_FIELD_SETTINGS_FORMAT_BUTTON') }}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import { BaseField } from './base-field';\nimport { Switcher, SwitcherSize } from 'ui.switcher';\nimport '../../css/switcher-field.css';\n\nexport const SwitcherField = {\n\textends: BaseField,\n\tmounted()\n\t{\n\t\tnew Switcher({\n\t\t\tnode: this.$refs.switcher,\n\t\t\tsize: SwitcherSize.small,\n\t\t\tchecked: this.defaultValue,\n\t\t\thandlers: {\n\t\t\t\ttoggled: () => {\n\t\t\t\t\tthis.value = !this.value;\n\t\t\t\t\tthis.onInputChange(this.value);\n\t\t\t\t},\n\t\t\t},\n\t\t});\n\t},\n\t// language=Vue\n\ttemplate: `\n\t\t<div class=\"ui-form-row\">\n\t\t\t<div class=\"switcher-field\">\n\t\t\t\t<div ref=\"switcher\"></div>\n\t\t\t\t<div class=\"switcher-field__label\">\n\t\t\t\t\t<span>{{ title }}</span>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import { BaseField } from './base-field';\n\nexport const CustomField = {\n\textends: BaseField,\n\t// language=Vue\n\ttemplate: `\n\t\t<div class=\"ui-form-row\">\n\t\t\t<div class=\"ui-form-label\">\n\t\t\t\t<div class=\"ui-ctl-label-text\">{{ title }}</div>\n\t\t\t</div>\n\t\t\t<div class=\"ui-ctl ui-ctl-w100\">\n\t\t\t\t<slot name=\"field-content\"></slot>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import { BaseField } from './base-field';\n\nexport const DropdownField = {\n\textends: BaseField,\n\tprops: {\n\t\toptions: {\n\t\t\ttype: Array,\n\t\t\trequired: true,\n\t\t},\n\t},\n\t// language=Vue\n\ttemplate: `\n\t\t<div class=\"ui-form-row\">\n\t\t\t<div class=\"ui-form-label\">\n\t\t\t\t<div class=\"ui-ctl-label-text\">{{ title }}</div>\n\t\t\t</div>\n\t\t\t<div class=\"ui-ctl ui-ctl-after-icon ui-ctl-dropdown ui-ctl-w100\">\n\t\t\t\t<div class=\"ui-ctl-after ui-ctl-icon-angle\"></div>\n\t\t\t\t<select class=\"ui-ctl-element\" v-model=\"value\" @change=\"onInputChange($event.target.value)\">\n\t\t\t\t\t<option v-for=\"option in options\" :value=\"option.value\" :selected=\"option.value === defaultValue\">{{ option.title }}</option>\n\t\t\t\t</select>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import { FormatSelector } from '../../steps/data-type/format-selector';\nimport { SliderButton } from '../../steps/data-type/slider-button';\nimport type { FieldValueChangeEvent } from '../../types/field-value-change-event';\nimport { SwitcherField } from '../type/switcher-field';\nimport { StackWidgetComponent as FileUploadWidget } from 'ui.uploader.stack-widget';\nimport { CustomField } from '../type/custom-field';\nimport { DropdownField } from '../type/dropdown-field';\nimport '../../css/dataset-file-upload.css';\n\nexport const FileUploader = {\n\tcomponents: {\n\t\tFileUploadWidget,\n\t\tCustomField,\n\t\tDropdownField,\n\t\tSwitcherField,\n\t\tSliderButton,\n\t},\n\tprops: {\n\t\tdefaultEncoding: {\n\t\t\ttype: String,\n\t\t\trequired: false,\n\t\t\tdefault: '',\n\t\t},\n\t\tdefaultSeparator: {\n\t\t\ttype: String,\n\t\t\trequired: false,\n\t\t\tdefault: '',\n\t\t},\n\t\tdefaultFirstLineHeader: {\n\t\t\ttype: Boolean,\n\t\t\trequired: false,\n\t\t\tdefault: true,\n\t\t},\n\t\tencodings: {\n\t\t\ttype: Array,\n\t\t\trequired: true,\n\t\t},\n\t\tseparators: {\n\t\t\ttype: Array,\n\t\t\trequired: true,\n\t\t},\n\t\tisEditMode: {\n\t\t\ttype: Boolean,\n\t\t\trequired: false,\n\t\t\tdefault: false,\n\t\t},\n\t\tunvalidatedFields: {\n\t\t\ttype: Object,\n\t\t\trequired: false,\n\t\t\tdefault: {},\n\t\t},\n\t\tdataFormatTemplates: {\n\t\t\ttype: Object,\n\t\t},\n\t},\n\tdata()\n\t{\n\t\treturn {\n\t\t\tinputElement: null,\n\t\t\tareValidationErrorsShown: false,\n\t\t};\n\t},\n\temits: [\n\t\t'valueChange',\n\t\t'uploadError',\n\t\t'parsingOptionsChanged',\n\t],\n\tcomputed: {\n\t\tuploaderOptions()\n\t\t{\n\t\t\treturn {\n\t\t\t\tcontroller: 'biconnector.integration.ui.fileUploaderController.datasetUploaderController',\n\t\t\t\tcontrollerOptions: {},\n\t\t\t\tmultiple: false,\n\t\t\t\tacceptOnlyImages: false,\n\t\t\t\tmaxFileSize: 1024 * 1024 * 60,\n\t\t\t\tautoUpload: true,\n\t\t\t\tacceptedFileTypes: ['.csv'],\n\t\t\t\tevents: {\n\t\t\t\t\tonUploadComplete: () => {\n\t\t\t\t\t\tthis.onUploadComplete();\n\t\t\t\t\t},\n\t\t\t\t\t'File:onRemove': () => {\n\t\t\t\t\t\tthis.onFileRemoved();\n\t\t\t\t\t},\n\t\t\t\t\tonError: () => {\n\t\t\t\t\t\tthis.onUploadError();\n\t\t\t\t\t},\n\t\t\t\t\t'File:onError': () => {\n\t\t\t\t\t\tthis.onUploadError();\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t};\n\t\t},\n\t\twidgetOptions()\n\t\t{\n\t\t\treturn {\n\t\t\t\tsize: 'large',\n\t\t\t};\n\t\t},\n\t},\n\tmethods: {\n\t\tonValueChange(event: FieldValueChangeEvent)\n\t\t{\n\t\t\tthis.$emit('valueChange', event);\n\t\t},\n\t\tonUploadComplete()\n\t\t{\n\t\t\tconst file = this.$refs.uploader.uploader.getFiles()[0];\n\t\t\tif (file && file.isComplete())\n\t\t\t{\n\t\t\t\tthis.areValidationErrorsShown = false;\n\t\t\t\tthis.$emit('valueChange', {\n\t\t\t\t\tnewValue: file.getServerFileId(),\n\t\t\t\t\tfieldName: 'fileToken',\n\t\t\t\t});\n\t\t\t\tthis.$emit('valueChange', {\n\t\t\t\t\tnewValue: file.getName(),\n\t\t\t\t\tfieldName: 'fileName',\n\t\t\t\t});\n\t\t\t}\n\t\t},\n\t\tonFileRemoved()\n\t\t{\n\t\t\tthis.$emit('valueChange', {\n\t\t\t\tnewValue: null,\n\t\t\t\tfieldName: 'fileToken',\n\t\t\t});\n\t\t},\n\t\tonUploadError()\n\t\t{\n\t\t\tthis.$emit('uploadError');\n\t\t},\n\t\tshowValidationErrors()\n\t\t{\n\t\t\tthis.areValidationErrorsShown = true;\n\t\t},\n\t\topenDataFormatSlider()\n\t\t{\n\t\t\tFormatSelector.openSlider(this.$store.state.config.dataFormats, this.dataFormatTemplates, (selectedFormats) => {\n\t\t\t\tthis.$store.commit('setDataFormats', selectedFormats);\n\t\t\t\tthis.$emit('parsingOptionsChanged');\n\t\t\t});\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"ui-form\">\n\t\t\t<CustomField :title=\"$Bitrix.Loc.getMessage('DATASET_IMPORT_FILE_FIELD')\" name=\"file\">\n\t\t\t\t<template #field-content>\n\t\t\t\t\t<div class=\"dataset-file-upload\">\n\t\t\t\t\t\t<FileUploadWidget\n\t\t\t\t\t\t\t:uploaderOptions=\"uploaderOptions\"\n\t\t\t\t\t\t\t:widgetOptions=\"widgetOptions\"\n\t\t\t\t\t\t\tref=\"uploader\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<p class=\"dataset-import-field__error-text\" v-if=\"areValidationErrorsShown && !unvalidatedFields.file?.result\">\n\t\t\t\t\t\t\t{{ unvalidatedFields.file?.message }}\n\t\t\t\t\t\t</p>\n\t\t\t\t\t</div>\n\t\t\t\t</template>\n\t\t\t</CustomField>\n\t\t\t<div class=\"ui-form-row-inline\">\n\t\t\t\t<DropdownField\n\t\t\t\t\t:title=\"$Bitrix.Loc.getMessage('DATASET_IMPORT_FILE_ENCODING')\"\n\t\t\t\t\tname=\"encoding\"\n\t\t\t\t\t:options=\"encodings\"\n\t\t\t\t\t:default-value=\"defaultEncoding\"\n\t\t\t\t\t@value-change=\"onValueChange\"\n\t\t\t\t/>\n\t\t\t\t<DropdownField\n\t\t\t\t\t:title=\"$Bitrix.Loc.getMessage('DATASET_IMPORT_FILE_SEPARATOR')\"\n\t\t\t\t\tname=\"separator\"\n\t\t\t\t\t:options=\"separators\"\n\t\t\t\t\t:default-value=\"defaultSeparator\"\n\t\t\t\t\t@value-change=\"onValueChange\"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t\t<SliderButton @click=\"openDataFormatSlider\" />\n\t\t\t<SwitcherField\n\t\t\t\t:title=\"$Bitrix.Loc.getMessage('DATASET_IMPORT_FILE_FIRST_ROW_HEADER')\"\n\t\t\t\tname=\"firstLineHeader\"\n\t\t\t\t:default-value=\"defaultFirstLineHeader\"\n\t\t\t\t@value-change=\"onValueChange\"\n\t\t\t/>\n\t\t</div>\n\t`,\n};\n","import { FileUploader } from '../fields/file/file-uploader';\nimport type { FieldValueChangeEvent } from '../types/field-value-change-event';\nimport { BaseStep } from './base-step';\nimport { StepBlock } from '../layout/step-block';\n\nexport const FileStep = {\n\textends: BaseStep,\n\tprops: {\n\t\tencodings: {\n\t\t\ttype: Array,\n\t\t\trequired: true,\n\t\t},\n\t\tseparators: {\n\t\t\ttype: Array,\n\t\t\trequired: true,\n\t\t},\n\t\tdataFormatTemplates: {\n\t\t\ttype: Object,\n\t\t},\n\t},\n\tdata()\n\t{\n\t\treturn {\n\t\t\tfileProperties: this.$store.state.config.fileProperties,\n\t\t\tisErrorDisplayed: false,\n\t\t};\n\t},\n\temits: [\n\t\t'filePropertiesChange',\n\t\t'parsingOptionsChanged',\n\t],\n\tcomputed: {\n\t\tdefaultTitle()\n\t\t{\n\t\t\treturn this.$Bitrix.Loc.getMessage('DATASET_IMPORT_FILE_HEADER');\n\t\t},\n\t\tdefaultHint()\n\t\t{\n\t\t\tif (this.isErrorDisplayed)\n\t\t\t{\n\t\t\t\treturn this.$Bitrix.Loc.getMessage('DATASET_IMPORT_FILE_HINT_ERROR');\n\t\t\t}\n\n\t\t\tif (this.isEditMode)\n\t\t\t{\n\t\t\t\treturn this.$Bitrix.Loc.getMessage('DATASET_IMPORT_FILE_HINT_EDIT')\n\t\t\t\t\t.replace('[link]', '<a onclick=\"top.BX.Helper.show(`redirect=detail&code=23378680`)\">')\n\t\t\t\t\t.replace('[/link]', '</a>')\n\t\t\t\t;\n\t\t\t}\n\n\t\t\treturn this.$Bitrix.Loc.getMessage('DATASET_IMPORT_FILE_HINT')\n\t\t\t\t.replace('[link]', '<a onclick=\"top.BX.Helper.show(`redirect=detail&code=23378680`)\">')\n\t\t\t\t.replace('[/link]', '</a>')\n\t\t\t;\n\t\t},\n\t\thintClass()\n\t\t{\n\t\t\treturn this.isErrorDisplayed ? 'ui-alert-danger' : 'ui-alert-primary';\n\t\t},\n\t\tisEditMode()\n\t\t{\n\t\t\treturn this.$store.getters.isEditMode;\n\t\t},\n\t\tunvalidatedFields()\n\t\t{\n\t\t\tconst result = {};\n\n\t\t\tconst fileValidationResult = this.validateFile();\n\t\t\tif (!fileValidationResult.result)\n\t\t\t{\n\t\t\t\tresult.file = fileValidationResult;\n\t\t\t}\n\n\t\t\treturn result;\n\t\t},\n\t},\n\tmethods: {\n\t\tonFilePropertiesChange(event: FieldValueChangeEvent)\n\t\t{\n\t\t\tif (event.fieldName === 'fileToken')\n\t\t\t{\n\t\t\t\tthis.isErrorDisplayed = false;\n\t\t\t}\n\n\t\t\tthis.fileProperties[event.fieldName] = event.newValue;\n\t\t\tthis.$store.commit('setFileProperties', this.fileProperties);\n\t\t\tif (event.fieldName !== 'fileName')\n\t\t\t{\n\t\t\t\tthis.$emit('filePropertiesChange');\n\t\t\t}\n\t\t\tthis.validate();\n\t\t},\n\t\tonUploadError()\n\t\t{\n\t\t\tthis.isErrorDisplayed = true;\n\t\t},\n\t\tonParsingOptionsChanged()\n\t\t{\n\t\t\tthis.$emit('parsingOptionsChanged');\n\t\t},\n\t\tvalidate()\n\t\t{\n\t\t\tlet result = true;\n\t\t\tif (!this.isEditMode)\n\t\t\t{\n\t\t\t\tresult = Object.keys(this.unvalidatedFields).length === 0;\n\t\t\t}\n\n\t\t\tthis.$emit('validation', result);\n\n\t\t\treturn result;\n\t\t},\n\t\tvalidateFile()\n\t\t{\n\t\t\tif (!this.isEditMode && !this.$store.state.config.fileProperties.fileToken)\n\t\t\t{\n\t\t\t\treturn {\n\t\t\t\t\tresult: false,\n\t\t\t\t\tmessage: this.$Bitrix.Loc.getMessage('DATASET_IMPORT_FILE_NOT_SELECTED'),\n\t\t\t\t};\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\tresult: true,\n\t\t\t};\n\t\t},\n\t\tshowValidationErrors()\n\t\t{\n\t\t\tthis.$refs.fileUploader.showValidationErrors();\n\t\t},\n\t},\n\tcomponents: {\n\t\tStep: StepBlock,\n\t\tFileUploader,\n\t},\n\ttemplate: `\n\t\t<Step\n\t\t\t:title=\"displayedTitle\"\n\t\t\t:hint=\"displayedHint\"\n\t\t\t:is-open-initially=\"isOpenInitially\"\n\t\t\t:disabled=\"disabled\"\n\t\t\t:hint-class=\"hintClass\"\n\t\t\tref=\"stepBlock\"\n\t\t>\n\t\t\t<FileUploader\n\t\t\t\t@value-change=\"onFilePropertiesChange\"\n\t\t\t\t@upload-error=\"onUploadError\"\n\t\t\t\t@parsing-options-changed=\"onParsingOptionsChanged\"\n\t\t\t\tref=\"fileUploader\"\n\t\t\t\t:encodings=\"encodings\"\n\t\t\t\t:separators=\"separators\"\n\t\t\t\t:default-encoding=\"fileProperties.encoding\"\n\t\t\t\t:default-first-line-header=\"fileProperties.firstLineHeader\"\n\t\t\t\t:default-separator=\"fileProperties.separator\"\n\t\t\t\t:is-edit-mode=\"isEditMode\"\n\t\t\t\t:unvalidated-fields=\"unvalidatedFields\"\n\t\t\t\t:data-format-templates=\"dataFormatTemplates\"\n\t\t\t/>\n\t\t</Step>\n\t`,\n};\n","import { StepBlock } from './step-block';\n\nexport const AppSection = {\n\tprops: {\n\t\ttitle: {\n\t\t\ttype: String,\n\t\t\trequired: false,\n\t\t},\n\t\tcustomClasses: {\n\t\t\ttype: Array,\n\t\t\trequired: false,\n\t\t},\n\t},\n\tcomponents: {\n\t\tStep: StepBlock,\n\t},\n\t// language=Vue\n\ttemplate: `\n\t\t<Step\n\t\t\t:title=\"title\"\n\t\t\t:can-collapse=\"false\"\n\t\t\t:custom-classes=\"customClasses\"\n\t\t>\n\t\t\t<slot></slot>\n\t\t</Step>\n\t`,\n};\n","import '../../css/dataset-preview-table.css';\n\nexport const TableHeader = {\n\tprops: {\n\t\theaders: {\n\t\t\ttype: Array,\n\t\t\trequired: false,\n\t\t\tdefault: [],\n\t\t},\n\t\tcolumnVisibility: {\n\t\t\ttype: Array,\n\t\t\trequired: false,\n\t\t\tdefault: [],\n\t\t},\n\t},\n\tcomputed: {\n\t\tvisibleHeaders()\n\t\t{\n\t\t\treturn this.headers.filter((_, index) => this.columnVisibility[index]);\n\t\t},\n\t},\n\t// language=Vue\n\ttemplate: `\n\t\t<thead>\n\t\t\t<tr class=\"dataset-preview-table__header-row\">\n\t\t\t\t<th class=\"dataset-preview-table__header\" v-for=\"header in visibleHeaders\" :title=\"header\">{{ header }}</th>\n\t\t\t</tr>\n\t\t</thead>\n\t`,\n};\n","import '../../css/dataset-preview-table.css';\n\nexport const TableRow = {\n\tprops: {\n\t\trow: {\n\t\t\ttype: Array,\n\t\t\trequired: true,\n\t\t},\n\t\tcolumnVisibility: {\n\t\t\ttype: Array,\n\t\t\trequired: false,\n\t\t\tdefault: [],\n\t\t},\n\t},\n\tcomputed: {\n\t\tvisibleValues()\n\t\t{\n\t\t\treturn this.row.filter((_, index) => this.columnVisibility[index]);\n\t\t},\n\t},\n\t// language=Vue\n\ttemplate: `\n\t\t<tr>\n\t\t\t<td class=\"dataset-preview-table__cell\" v-for=\"value in visibleValues\" :title=\"value\">{{ value }}</td>\n\t\t</tr>\n\t`,\n};\n","import '../../css/dataset-preview-table.css';\nimport { Ears } from 'ui.ears';\nimport { TableHeader } from './table-header';\nimport { TableRow } from './table-row';\nimport { Dom, debounce } from 'main.core';\n\nexport const PreviewTable = {\n\tprops: {\n\t\theaders: {\n\t\t\ttype: Array,\n\t\t\trequired: false,\n\t\t\tdefault: [],\n\t\t},\n\t\trows: {\n\t\t\ttype: Array,\n\t\t\trequired: false,\n\t\t\tdefault: [],\n\t\t},\n\t\tcolumnVisibility: {\n\t\t\ttype: Array,\n\t\t\trequired: false,\n\t\t\tdefault: [],\n\t\t},\n\t},\n\tdata()\n\t{\n\t\treturn {\n\t\t\tdisplayedColumnVisibility: this.columnVisibility,\n\t\t\tdebouncedRefresh: debounce(this.refreshColumns, 1000),\n\t\t};\n\t},\n\tmounted()\n\t{\n\t\tconst ears = new Ears({\n\t\t\tcontainer: document.querySelector('.dataset-preview-table'),\n\t\t\tsmallSize: true,\n\t\t\tnoScrollbar: false,\n\t\t});\n\n\t\tears.init();\n\t},\n\tmethods: {\n\t\trefreshColumns(newVisibility)\n\t\t{\n\t\t\tthis.displayedColumnVisibility = newVisibility;\n\t\t\tDom.removeClass(this.$refs.table, 'dataset-preview-table--fade');\n\t\t},\n\t},\n\twatch: {\n\t\tcolumnVisibility(newValue, oldValue)\n\t\t{\n\t\t\tDom.addClass(this.$refs.table, 'dataset-preview-table--fade');\n\t\t\tthis.debouncedRefresh(newValue);\n\t\t},\n\t},\n\tcomponents: {\n\t\tTableHeader,\n\t\tTableRow,\n\t},\n\t// language=Vue\n\ttemplate: `\n\t\t<div class=\"dataset-preview-table\" ref=\"table\">\n\t\t\t<table class=\"dataset-preview-table__table\">\n\t\t\t\t<TableHeader v-if=\"headers.length > 0\" :headers=\"headers\" :column-visibility=\"displayedColumnVisibility\" />\n\t\t\t\t<tbody>\n\t\t\t\t\t<TableRow v-for=\"row in rows\" :row=\"row\" :column-visibility=\"displayedColumnVisibility\" />\n\t\t\t\t</tbody>\n\t\t\t</table>\n\t\t</div>\n\t`,\n};\n","import { Loader } from 'main.loader';\nimport { AppSection } from '../layout/app-section';\nimport '../css/import-preview.css';\nimport { PreviewTable } from './import-preview/preview-table';\n\nexport const ImportPreview = {\n\tcomponents: {\n\t\tAppSection,\n\t\tPreviewTable,\n\t},\n\tprops: {\n\t\temptyStateText: {\n\t\t\ttype: String,\n\t\t\trequired: false,\n\t\t\tdefault: null,\n\t\t},\n\t\terror: {\n\t\t\ttype: String,\n\t\t\trequired: false,\n\t\t\tdefault: '',\n\t\t},\n\t\tisLoading: {\n\t\t\ttype: Boolean,\n\t\t\trequired: false,\n\t\t\tdefault: false,\n\t\t},\n\t\tneedShowHeadersWithEmptyRows: {\n\t\t\ttype: Boolean,\n\t\t\trequired: false,\n\t\t\tdefault: false,\n\t\t},\n\t},\n\tcomputed: {\n\t\tisEditMode(): boolean\n\t\t{\n\t\t\treturn this.$store.getters.isEditMode;\n\t\t},\n\t\theaders()\n\t\t{\n\t\t\treturn this.$store.getters.previewHeaders;\n\t\t},\n\t\trows()\n\t\t{\n\t\t\treturn this.$store.state.previewData.rows;\n\t\t},\n\t\tisEverythingHidden()\n\t\t{\n\t\t\treturn this.headers.length > 0 && this.$store.getters.areNoRowsVisible;\n\t\t},\n\t\thasData()\n\t\t{\n\t\t\treturn this.$store.getters.hasData;\n\t\t},\n\t\thasHeaders(): boolean\n\t\t{\n\t\t\treturn this.headers.length > 0;\n\t\t},\n\t\tdisplayedEmptyStateText()\n\t\t{\n\t\t\treturn this.emptyStateText ?? this.$Bitrix.Loc.getMessage('DATASET_IMPORT_PREVIEW_EMPTY_STATE');\n\t\t},\n\t\tdisplayedEverythingHiddenText()\n\t\t{\n\t\t\treturn this.$Bitrix.Loc.getMessage('DATASET_IMPORT_PREVIEW_EVERYTHING_HIDDEN');\n\t\t},\n\t\tcolumnVisibility()\n\t\t{\n\t\t\treturn this.$store.getters.columnVisibilityMap;\n\t\t},\n\t\tisErrorInEditMode()\n\t\t{\n\t\t\treturn this.hasData && this.error && this.isEditMode;\n\t\t},\n\t\tisEditModeInitialDataDisplayed()\n\t\t{\n\t\t\treturn this.isEditMode && !this.$store.state.config.fileProperties.fileToken;\n\t\t},\n\t\tdisplayedTitle()\n\t\t{\n\t\t\treturn this.isEditModeInitialDataDisplayed\n\t\t\t\t? this.$Bitrix.Loc.getMessage('DATASET_IMPORT_INITIAL_DATA_PREVIEW_TITLE')\n\t\t\t\t: this.$Bitrix.Loc.getMessage('DATASET_IMPORT_PREVIEW_TITLE')\n\t\t\t;\n\t\t},\n\t\thasDataDisplayedHint()\n\t\t{\n\t\t\treturn this.isEditModeInitialDataDisplayed\n\t\t\t\t? this.$Bitrix.Loc.getMessage('DATASET_IMPORT_INITIAL_DATA_PREVIEW_HINT')\n\t\t\t\t: this.$Bitrix.Loc.getMessage('DATASET_IMPORT_PREVIEW_HINT')\n\t\t\t;\n\t\t},\n\t},\n\twatch: {\n\t\tisLoading(newValue)\n\t\t{\n\t\t\tif (this.loader)\n\t\t\t{\n\t\t\t\tthis.loader.destroy();\n\t\t\t}\n\n\t\t\tif (newValue)\n\t\t\t{\n\t\t\t\tthis.loader = new Loader({\n\t\t\t\t\ttarget: this.$refs.loadingAnchor,\n\t\t\t\t\tsize: 77,\n\t\t\t\t\tcolor: 'var(--ui-color-primary)',\n\t\t\t\t\tstrokeWidth: 4,\n\t\t\t\t});\n\t\t\t\tthis.loader.show();\n\t\t\t}\n\t\t},\n\t},\n\t// language=Vue\n\ttemplate: `\n\t\t<AppSection\n\t\t\t:title=\"displayedTitle\"\n\t\t\t:custom-classes=\"['dataset-import-step--full-height', 'dataset-import-step--sticky', 'import-preview']\"\n\t\t>\n\t\t\t<div class=\"import-preview__loading\" ref=\"loadingAnchor\"></div>\n\t\t\t<template v-if=\"!isLoading\">\n\t\t\t\t<template v-if=\"error\">\n\t\t\t\t\t<div class=\"import-preview__no-data\" v-if=\"isEverythingHidden\">\n\t\t\t\t\t\t<div class=\"import-preview__no-data-logo\"></div>\n\t\t\t\t\t\t<p class=\"import-preview__no-data-text\">{{ displayedEverythingHiddenText }}</p>\n\t\t\t\t\t</div>\n\t\t\t\t\t<template v-else>\n\t\t\t\t\t\t<div class=\"import-preview__has-data import-preview__has-data--edit-mode-error\" v-if=\"isEditMode\">\n\t\t\t\t\t\t\t<span class=\"import-preview__hint\">{{ $Bitrix.Loc.getMessage('DATASET_IMPORT_PREVIEW_HINT') }}</span>\n\t\t\t\t\t\t\t<PreviewTable\n\t\t\t\t\t\t\t\t:headers=\"headers\"\n\t\t\t\t\t\t\t\t:column-visibility=\"columnVisibility\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t<div class=\"import-preview__edit-mode-error\">\n\t\t\t\t\t\t\t\t<div class=\"import-preview__error-logo\"></div>\n\t\t\t\t\t\t\t\t<p class=\"import-preview__no-data-text\">{{ error }}</p>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"import-preview__has-data\" v-else>\n\t\t\t\t\t\t\t<PreviewTable\n\t\t\t\t\t\t\t\t:headers=\"headers\"\n\t\t\t\t\t\t\t\t:column-visibility=\"columnVisibility\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t<div class=\"import-preview__edit-mode-error\">\n\t\t\t\t\t\t\t\t<div class=\"import-preview__error-logo\"></div>\n\t\t\t\t\t\t\t\t<p class=\"import-preview__no-data-text\">{{ error }}</p>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</template>\n\t\t\t\t</template>\n\t\t\t\t<template v-else>\n\t\t\t\t\t<div class=\"import-preview__no-data\" v-if=\"isEverythingHidden\">\n\t\t\t\t\t\t<div class=\"import-preview__no-data-logo\"></div>\n\t\t\t\t\t\t<p class=\"import-preview__no-data-text\">{{ displayedEverythingHiddenText }}</p>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"import-preview__has-data\" v-else-if=\"hasData\">\n\t\t\t\t\t\t<span class=\"import-preview__hint\">{{ hasDataDisplayedHint }}</span>\n\t\t\t\t\t\t<PreviewTable\n\t\t\t\t\t\t\t:headers=\"headers\"\n\t\t\t\t\t\t\t:rows=\"rows\"\n\t\t\t\t\t\t\t:column-visibility=\"columnVisibility\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"import-preview__has-data\" v-else-if=\"hasHeaders && needShowHeadersWithEmptyRows\">\n\t\t\t\t\t\t<PreviewTable\n\t\t\t\t\t\t\t:headers=\"headers\"\n\t\t\t\t\t\t\t:column-visibility=\"columnVisibility\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<div class=\"import-preview__edit-mode-error\">\n\t\t\t\t\t\t\t<div class=\"import-preview__no-data-logo\"></div>\n\t\t\t\t\t\t\t<p class=\"import-preview__no-data-text\">{{ displayedEmptyStateText }}</p>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"import-preview__no-data\" v-else>\n\t\t\t\t\t\t<div class=\"import-preview__no-data-logo\"></div>\n\t\t\t\t\t\t<p class=\"import-preview__no-data-text\">{{ displayedEmptyStateText }}</p>\n\t\t\t\t\t</div>\n\t\t\t\t</template>\n\t\t\t</template>\n\t\t</AppSection>\n\t`,\n};\n","import { ajax as Ajax, Tag, Type } from 'main.core';\nimport { Popup as MainPopup, PopupManager } from 'main.popup';\nimport type { AnalyticsOptions } from 'ui.analytics';\nimport { sendData } from 'ui.analytics';\nimport { SidePanel } from 'ui.sidepanel';\nimport { Button, ButtonColor } from 'ui.buttons';\n\n// language=Vue\nexport const BaseApp = {\n\tprops: {\n\t\tappParams: {\n\t\t\ttype: Object,\n\t\t\trequired: false,\n\t\t\tdefault: {},\n\t\t},\n\t},\n\tdata()\n\t{\n\t\treturn {\n\t\t\tsteps: {},\n\t\t\tshownPopups: {},\n\t\t\tisChanged: false,\n\t\t\tisSaveComplete: false,\n\t\t\tlastChangedStep: null,\n\t\t};\n\t},\n\tcomputed: {\n\t\tsourceCode()\n\t\t{\n\t\t\treturn '';\n\t\t},\n\t\tloadParams()\n\t\t{\n\t\t\treturn {};\n\t\t},\n\t\tsaveParams()\n\t\t{\n\t\t\treturn {};\n\t\t},\n\t\tisEditMode()\n\t\t{\n\t\t\treturn false;\n\t\t},\n\t\tdatasetId()\n\t\t{\n\t\t\treturn this.$store.state.config.datasetProperties.id;\n\t\t},\n\t\tisSaveEnabled(): boolean\n\t\t{\n\t\t\treturn !(this.$store.getters.areNoRowsVisible) && this.isValidatedForSave && !this.previewError;\n\t\t},\n\t\tisValidatedForSave(): boolean\n\t\t{\n\t\t\treturn true;\n\t\t},\n\t\tunsavedChangesPopupTitle(): string\n\t\t{\n\t\t\treturn this.isEditMode\n\t\t\t\t? this.$Bitrix.Loc.getMessage('DATASET_IMPORT_UNSAVED_CHANGES_TITLE_EDIT')\n\t\t\t\t: this.$Bitrix.Loc.getMessage('DATASET_IMPORT_UNSAVED_CHANGES_TITLE')\n\t\t\t;\n\t\t},\n\t\tunsavedChangesPopupText(): string\n\t\t{\n\t\t\treturn this.isEditMode\n\t\t\t\t? this.$Bitrix.Loc.getMessage('DATASET_IMPORT_UNSAVED_CHANGES_TEXT_EDIT')\n\t\t\t\t: this.$Bitrix.Loc.getMessage('DATASET_IMPORT_UNSAVED_CHANGES_TEXT')\n\t\t\t;\n\t\t},\n\t\tsourceType(): string\n\t\t{\n\t\t\treturn '';\n\t\t},\n\t},\n\tmounted()\n\t{\n\t\tthis.$Bitrix.eventEmitter.subscribe('biconnector:dataset-import:createButtonClick', this.onSaveButtonClick);\n\t\tthis.$Bitrix.eventEmitter.subscribe('biconnector:dataset-import:cancelButtonClick', this.onCancelButtonClick);\n\n\t\tconst slider = SidePanel.Instance.getTopSlider();\n\t\tif (slider)\n\t\t{\n\t\t\ttop.BX.addCustomEvent(slider, 'SidePanel.Slider:onClose', this.onSliderClose);\n\n\t\t\taddEventListener('beforeunload', (event) => {\n\t\t\t\ttop.BX.removeCustomEvent(slider, 'SidePanel.Slider:onClose', this.onSliderClose);\n\t\t\t});\n\t\t}\n\t},\n\tbeforeUnmount()\n\t{\n\t\tthis.$Bitrix.eventEmitter.unsubscribe('biconnector:dataset-import:createButtonClick', this.onSaveButtonClick);\n\t\tthis.$Bitrix.eventEmitter.unsubscribe('biconnector:dataset-import:cancelButtonClick', this.onCancelButtonClick);\n\t},\n\tmethods: {\n\t\tmarkAsChanged()\n\t\t{\n\t\t\tthis.isChanged = true;\n\t\t},\n\t\tonSliderClose(event)\n\t\t{\n\t\t\tif (!this.isChanged)\n\t\t\t{\n\t\t\t\tif (!this.isSaveComplete)\n\t\t\t\t{\n\t\t\t\t\tthis.sendAnalytics({\n\t\t\t\t\t\tevent: this.isEditMode ? 'edit_end' : 'creation_end',\n\t\t\t\t\t\tstatus: 'error',\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tevent.denyAction();\n\n\t\t\tif (PopupManager.getPopupById('unsaved'))\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst continueButton = new Button({\n\t\t\t\tcolor: ButtonColor.PRIMARY,\n\t\t\t\ttext: this.$Bitrix.Loc.getMessage('DATASET_IMPORT_CONTINUE_IMPORT'),\n\t\t\t\tevents: {\n\t\t\t\t\tclick() {\n\t\t\t\t\t\tpopup.destroy();\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t});\n\n\t\t\tconst closeButton = new Button({\n\t\t\t\tcolor: ButtonColor.LINK,\n\t\t\t\ttext: this.$Bitrix.Loc.getMessage('DATASET_IMPORT_CONFIRM_CANCEL_IMPORT'),\n\t\t\t\tevents: {\n\t\t\t\t\tclick: () => {\n\t\t\t\t\t\tthis.isChanged = false;\n\t\t\t\t\t\tthis.closeApp();\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t});\n\n\t\t\tconst popupHeader = this.unsavedChangesPopupTitle;\n\t\t\tconst popupText = this.unsavedChangesPopupText;\n\n\t\t\tconst popup = new MainPopup({\n\t\t\t\tid: 'unsaved',\n\t\t\t\tcontent: Tag.render`\n\t\t\t\t\t<div class=\"generic-popup\">\n\t\t\t\t\t\t<h3 class=\"generic-popup__header\">${popupHeader}</h3>\n\t\t\t\t\t\t<div class=\"generic-popup__content\">\n\t\t\t\t\t\t\t${popupText}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"generic-popup__buttons-wrapper\">\n\t\t\t\t\t\t\t${continueButton.render()}\n\t\t\t\t\t\t\t${closeButton.render()}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t`,\n\t\t\t\twidth: 440,\n\t\t\t\tnoAllPaddings: true,\n\t\t\t\tautoHide: false,\n\t\t\t\tfixed: true,\n\t\t\t\toverlay: true,\n\t\t\t});\n\n\t\t\tpopup.show();\n\t\t},\n\t\tcloseApp()\n\t\t{\n\t\t\tSidePanel.Instance.getTopSlider().close();\n\t\t},\n\t\ttoggleStepState(step: string, disabled: ?boolean = null)\n\t\t{\n\t\t\tif (!this.steps[step])\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (Type.isNull(disabled))\n\t\t\t{\n\t\t\t\tthis.steps[step].disabled = !Boolean(this.steps[step].disabled);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.steps[step].disabled = disabled;\n\t\t\t}\n\t\t},\n\t\ttogglePopup(step: string, shown: ?boolean = null)\n\t\t{\n\t\t\tif (Type.isNull(shown))\n\t\t\t{\n\t\t\t\tthis.shownPopups[step] = !Boolean(this.shownPopups[step]);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.shownPopups[step] = shown;\n\t\t\t}\n\t\t},\n\t\tloadDataset()\n\t\t{\n\t\t\tAjax.runAction('biconnector.externalsource.dataset.view', {\n\t\t\t\tdata: {\n\t\t\t\t\ttype: this.sourceCode,\n\t\t\t\t\tfields: this.loadParams,\n\t\t\t\t},\n\t\t\t})\n\t\t\t\t.then((response) => {\n\t\t\t\t\tthis.onLoadSuccess(response);\n\t\t\t\t})\n\t\t\t\t.catch((error) => {\n\t\t\t\t\tthis.onLoadError(error);\n\t\t\t\t});\n\t\t},\n\t\tonStepValidation(step, validationResult)\n\t\t{\n\t\t\tif (!this.steps[step])\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.steps[step].valid = validationResult;\n\t\t},\n\t\tonSaveButtonClick()\n\t\t{\n\t\t\tthis.onSaveStart()\n\t\t\t\t.then(() => {\n\t\t\t\t\tthis.handleSaveAction();\n\t\t\t\t})\n\t\t\t\t.catch(() => {})\n\t\t\t;\n\t\t},\n\t\tonCancelButtonClick()\n\t\t{\n\t\t\tthis.closeApp();\n\t\t},\n\t\thandleSaveAction()\n\t\t{\n\t\t\tif (this.isEditMode)\n\t\t\t{\n\t\t\t\tthis.updateDataset();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.saveDataset();\n\t\t\t}\n\t\t},\n\t\tsaveDataset()\n\t\t{\n\t\t\tAjax.runAction('biconnector.externalsource.dataset.add', {\n\t\t\t\tdata: {\n\t\t\t\t\ttype: this.sourceCode,\n\t\t\t\t\tfields: this.saveParams,\n\t\t\t\t},\n\t\t\t})\n\t\t\t\t.then((response) => {\n\t\t\t\t\tthis.onSaveEnd(response);\n\t\t\t\t})\n\t\t\t\t.catch((error) => {\n\t\t\t\t\tthis.onSaveError();\n\t\t\t\t});\n\t\t},\n\t\tupdateDataset()\n\t\t{\n\t\t\tAjax.runAction('biconnector.externalsource.dataset.update', {\n\t\t\t\tdata: {\n\t\t\t\t\tid: this.datasetId,\n\t\t\t\t\ttype: this.sourceCode,\n\t\t\t\t\tfields: this.saveParams,\n\t\t\t\t},\n\t\t\t})\n\t\t\t\t.then((response) => {\n\t\t\t\t\tthis.onSaveEnd(response);\n\t\t\t\t})\n\t\t\t\t.catch((error) => {\n\t\t\t\t\tthis.onSaveError();\n\t\t\t\t});\n\t\t},\n\t\tonSaveStart(): Promise\n\t\t{\n\t\t\treturn Promise.resolve();\n\t\t},\n\t\tonSaveEnd()\n\t\t{\n\t\t},\n\t\tonSaveError()\n\t\t{\n\t\t},\n\t\tonLoadStart()\n\t\t{\n\t\t},\n\t\tonLoadSuccess(response)\n\t\t{\n\t\t},\n\t\tonLoadError(response)\n\t\t{\n\t\t},\n\t\treload()\n\t\t{\n\t\t\twindow.location.reload();\n\t\t},\n\t\tsendAnalytics(params: AnalyticsOptions)\n\t\t{\n\t\t\tif (this.sourceCode)\n\t\t\t{\n\t\t\t\tsendData({\n\t\t\t\t\t...this.getBaseAnalyticsParams(),\n\t\t\t\t\t...params,\n\t\t\t\t});\n\t\t\t}\n\t\t},\n\t\tgetBaseAnalyticsParams()\n\t\t{\n\t\t\treturn {\n\t\t\t\ttool: 'BI_Builder',\n\t\t\t\tc_section: 'BI_Builder',\n\t\t\t\tcategory: this.sourceCode.toUpperCase(),\n\t\t\t};\n\t\t},\n\t},\n};\n","import { FileExport } from 'biconnector.dataset-import.file-export';\nimport { AppLayout } from '../layout/app-layout';\nimport { ImportConfig } from '../layout/import-config';\nimport { FileErrorsPopup } from '../popups/file-checking/file-errors-popup';\nimport { CheckingProgressPopup } from '../popups/file-checking/checking-progress-popup';\nimport { CheckingSuccessPopup } from '../popups/file-checking/checking-success-popup';\nimport { CheckingFailedPopup } from '../popups/file-checking/checking-failed-popup';\nimport { GenericPopup } from '../popups/generic-popup';\nimport { ImportFailurePopup } from '../popups/saving/import-failure-popup';\nimport { ImportProgressPopup } from '../popups/saving/import-progress-popup';\nimport { ImportSuccessPopup } from '../popups/saving/import-success-popup';\nimport { DatasetPropertiesStep } from '../steps/dataset-properties';\nimport { FieldsSettingsStep } from '../steps/fields-settings';\nimport { FileStep } from '../steps/file';\nimport { ImportPreview } from '../steps/import-preview';\nimport { BaseApp } from './base-app';\nimport { ajax as Ajax, Dom } from 'main.core';\nimport { EventEmitter } from 'main.core.events';\n\nexport const CsvApp = {\n\textends: BaseApp,\n\tdata()\n\t{\n\t\treturn {\n\t\t\tsteps: {\n\t\t\t\tfile: {\n\t\t\t\t\tdisabled: false,\n\t\t\t\t\tvalid: this.$store.getters.isEditMode,\n\t\t\t\t},\n\t\t\t\tproperties: {\n\t\t\t\t\tdisabled: !this.$store.getters.isEditMode,\n\t\t\t\t\tvalid: true,\n\t\t\t\t},\n\t\t\t\tfields: {\n\t\t\t\t\tdisabled: !this.$store.getters.isEditMode,\n\t\t\t\t\tvalid: true,\n\t\t\t\t},\n\t\t\t},\n\t\t\tshownPopups: {\n\t\t\t\tsavingProgress: false,\n\t\t\t\tsavingSuccess: false,\n\t\t\t\tsavingFailure: false,\n\t\t\t\teditModeFileReplacement: false,\n\t\t\t\tcheckFileProgress: false,\n\t\t\t\tcheckFileSuccess: false,\n\t\t\t\tcheckFileFailure: false,\n\t\t\t\tfileErrors: false,\n\t\t\t},\n\t\t\tisValidationComplete: true,\n\t\t\tpopupParams: {\n\t\t\t\tsavingSuccess: {},\n\t\t\t\tfileErrors: {\n\t\t\t\t\tisSavingMode: false,\n\t\t\t\t},\n\t\t\t},\n\t\t\tlastReloadSource: null,\n\t\t\tinitialPreviewData: {},\n\t\t\tinitialFieldsSettings: [],\n\t\t\tpreviewError: '',\n\t\t\tisEditModeSaveConfirmed: false,\n\t\t\tisDataLoadingAnimationDisplayed: false,\n\t\t\thasMinimalLoadingAnimationTimePassed: true,\n\t\t\tcheckFileErrors: [],\n\t\t\tisErrorsChecked: false,\n\t\t\texportDownloadLink: null,\n\t\t};\n\t},\n\tcomputed: {\n\t\tsourceCode()\n\t\t{\n\t\t\treturn 'csv';\n\t\t},\n\t\tisEditMode()\n\t\t{\n\t\t\treturn this.$store.getters.isEditMode;\n\t\t},\n\t\tloadParams()\n\t\t{\n\t\t\treturn {\n\t\t\t\tfileProperties: this.$store.state.config.fileProperties,\n\t\t\t\tdatasetProperties: this.$store.state.config.datasetProperties,\n\t\t\t\tfieldsSettings: this.$store.state.config.fieldsSettings,\n\t\t\t\tdataFormats: this.$store.state.config.dataFormats,\n\t\t\t};\n\t\t},\n\t\tsaveParams()\n\t\t{\n\t\t\treturn {\n\t\t\t\tfileProperties: this.$store.state.config.fileProperties,\n\t\t\t\tdatasetProperties: this.$store.state.config.datasetProperties,\n\t\t\t\tfieldsSettings: this.$store.state.config.fieldsSettings,\n\t\t\t\tdataFormats: this.$store.state.config.dataFormats,\n\t\t\t};\n\t\t},\n\t\tdatasetId()\n\t\t{\n\t\t\treturn this.$store.state.config.datasetProperties.id;\n\t\t},\n\t\tisValidatedForSave()\n\t\t{\n\t\t\treturn this.steps.fields.valid && this.steps.properties.valid && this.steps.file.valid;\n\t\t},\n\t\timportFailurePopupTitle()\n\t\t{\n\t\t\treturn this.isEditMode ? this.$Bitrix.Loc.getMessage('DATASET_IMPORT_FAILURE_POPUP_HEADER_EDIT') : this.$Bitrix.Loc.getMessage('DATASET_IMPORT_FAILURE_POPUP_HEADER');\n\t\t},\n\t\timportSuccessPopupTitle()\n\t\t{\n\t\t\treturn this.isEditMode\n\t\t\t\t? this.$Bitrix.Loc.getMessage('DATASET_IMPORT_SUCCESS_POPUP_HEADER_EDIT').replace('#DATASET_TITLE#', this.popupParams.savingSuccess.title)\n\t\t\t\t: this.$Bitrix.Loc.getMessage('DATASET_IMPORT_SUCCESS_POPUP_HEADER').replace('#DATASET_TITLE#', this.popupParams.savingSuccess.title);\n\t\t},\n\t\timportSuccessPopupDescription()\n\t\t{\n\t\t\treturn this.$store.state.config.fileProperties.fileName\n\t\t\t\t? this.$Bitrix.Loc.getMessage('DATASET_IMPORT_SUCCESS_POPUP_DESCRIPTION').replace('#FILE_NAME#', this.popupParams.savingSuccess.fileName)\n\t\t\t\t: '';\n\t\t},\n\t\timportProgressPopupDescription()\n\t\t{\n\t\t\treturn this.isEditMode\n\t\t\t\t? this.$Bitrix.Loc.getMessage('DATASET_IMPORT_PROGRESS_POPUP_DESCRIPTION_EDIT')\n\t\t\t\t: this.$Bitrix.Loc.getMessage('DATASET_IMPORT_PROGRESS_POPUP_DESCRIPTION');\n\t\t},\n\t\tsourceType(): string\n\t\t{\n\t\t\treturn 'csv';\n\t\t},\n\t},\n\tmethods: {\n\t\tmarkAsChanged()\n\t\t{\n\t\t\tthis.isChanged = true;\n\t\t},\n\t\tonDatasetPropertiesChanged()\n\t\t{\n\t\t\tthis.markAsChanged();\n\t\t\tif (this.lastChangedStep !== 'properties')\n\t\t\t{\n\t\t\t\tthis.sendAnalytics({\n\t\t\t\t\tevent: this.isEditMode ? 'edit_start' : 'creation_start',\n\t\t\t\t\tc_element: 'step_2',\n\t\t\t\t\t...(this.isEditMode && { p1: `datasetName_${this.$store.state.config.datasetProperties.name.replaceAll('_', '')}`}),\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tthis.lastChangedStep = 'properties';\n\t\t},\n\t\tonFieldsSettingsChanged()\n\t\t{\n\t\t\tthis.markAsChanged();\n\t\t\tif (this.lastChangedStep !== 'fields')\n\t\t\t{\n\t\t\t\tthis.sendAnalytics({\n\t\t\t\t\tevent: this.isEditMode ? 'edit_start' : 'creation_start',\n\t\t\t\t\tc_element: 'step_3',\n\t\t\t\t\t...(this.isEditMode && { p1: `datasetName_${this.$store.state.config.datasetProperties.name.replaceAll('_', '')}`}),\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tthis.lastChangedStep = 'fields';\n\t\t\tthis.isErrorsChecked = false;\n\t\t},\n\t\tonDatasetReloadNeeded(reloadSource)\n\t\t{\n\t\t\tthis.markAsChanged();\n\t\t\tthis.previewError = '';\n\t\t\tthis.lastReloadSource = reloadSource;\n\t\t\tthis.isErrorsChecked = false;\n\n\t\t\tif (this.$store.state.config.fileProperties.fileToken)\n\t\t\t{\n\t\t\t\tif (reloadSource === 'file')\n\t\t\t\t{\n\t\t\t\t\tthis.lastChangedStep = 'file';\n\n\t\t\t\t\tthis.sendAnalytics({\n\t\t\t\t\t\tevent: this.isEditMode ? 'edit_start' : 'creation_start',\n\t\t\t\t\t\tc_element: 'step_1',\n\t\t\t\t\t\t...(this.isEditMode && { p1: `datasetName_${this.$store.state.config.datasetProperties.name.replaceAll('_', '')}` }),\n\t\t\t\t\t});\n\n\t\t\t\t\tthis.startPreviewLoadingAnimation();\n\t\t\t\t}\n\n\t\t\t\tthis.loadDataset();\n\t\t\t}\n\t\t\telse if (this.isEditMode)\n\t\t\t{\n\t\t\t\tthis.$store.commit('setPreviewData', this.initialPreviewData);\n\t\t\t\tthis.$store.commit('setFieldsSettings', this.initialFieldsSettings);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.$store.commit('setPreviewData', []);\n\t\t\t\tthis.$refs.propertiesStep.close();\n\t\t\t\tthis.$refs.fieldsStep.close();\n\t\t\t\tthis.toggleStepState('properties', true);\n\t\t\t\tthis.toggleStepState('fields', true);\n\t\t\t\tthis.toggleCheckFileButton(true);\n\t\t\t}\n\t\t},\n\t\tprocessLoadResponse(response)\n\t\t{\n\t\t\tconst responseData = response.data;\n\n\t\t\tif (!responseData || responseData.data.length === 0)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (this.lastReloadSource === 'file' && !this.isEditMode)\n\t\t\t{\n\t\t\t\tconst headers = [];\n\t\t\t\tresponseData.headers.forEach((header, index) => {\n\t\t\t\t\theaders.push(this.prepareHeader(header, index));\n\t\t\t\t});\n\n\t\t\t\tthis.$store.commit('setFieldsSettings', headers);\n\t\t\t}\n\t\t\tthis.$store.commit('setPreviewData', responseData.data);\n\t\t},\n\t\tprepareHeader(header, index)\n\t\t{\n\t\t\treturn {\n\t\t\t\tvisible: true,\n\t\t\t\ttype: header.type,\n\t\t\t\tname: header.name && header.name.length > 0 ? header.name : `FIELD_${index}`,\n\t\t\t\toriginalType: null,\n\t\t\t\toriginalName: header.externalCode,\n\t\t\t\texternalCode: header.externalCode,\n\t\t\t};\n\t\t},\n\t\tonLoadSuccess(response)\n\t\t{\n\t\t\tthis.stopPreviewLoadingAnimation();\n\t\t\tthis.processLoadResponse(response);\n\n\t\t\tthis.$refs.propertiesStep.open();\n\t\t\tthis.$refs.fieldsStep.open();\n\t\t\tthis.toggleStepState('properties', false);\n\t\t\tthis.toggleStepState('fields', false);\n\t\t\tthis.$refs.fieldsStep.validate();\n\t\t\tthis.toggleCheckFileButton(false);\n\t\t},\n\t\tonLoadError(response)\n\t\t{\n\t\t\tthis.stopPreviewLoadingAnimation();\n\t\t\tthis.previewError = response.errors[0]?.message ?? this.$Bitrix.Loc.getMessage('DATASET_IMPORT_PREVIEW_ERROR_FILE');\n\t\t},\n\t\tonSaveStart(): Promise\n\t\t{\n\t\t\tif (!this.isValidatedForSave)\n\t\t\t{\n\t\t\t\tthis.$refs.fileStep.showValidationErrors();\n\t\t\t\tthis.$refs.fieldsStep.showValidationErrors();\n\t\t\t\tthis.$refs.propertiesStep.showValidationErrors();\n\n\t\t\t\treturn Promise.reject();\n\t\t\t}\n\n\t\t\tif (this.isEditMode && !this.isEditModeSaveConfirmed && this.$store.state.config.fileProperties.fileToken)\n\t\t\t{\n\t\t\t\tthis.togglePopup('editModeFileReplacement', true);\n\n\t\t\t\treturn Promise.reject();\n\t\t\t}\n\n\t\t\tthis.togglePopup('savingProgress', true);\n\t\t\tif (this.isEditMode && !this.$store.state.config.fileProperties.fileToken)\n\t\t\t{\n\t\t\t\treturn Promise.resolve();\n\t\t\t}\n\n\t\t\tthis.popupParams.fileErrors.isSavingMode = true;\n\n\t\t\treturn new Promise((resolve, reject) => {\n\t\t\t\tthis.checkFile()\n\t\t\t\t\t.then(() => {\n\t\t\t\t\t\tresolve();\n\t\t\t\t\t})\n\t\t\t\t\t.catch(() => {\n\t\t\t\t\t\tthis.togglePopup('savingProgress', false);\n\t\t\t\t\t\tthis.togglePopup('fileErrors', true);\n\t\t\t\t\t\treject();\n\t\t\t\t\t});\n\t\t\t});\n\t\t},\n\t\tonSaveEnd(response)\n\t\t{\n\t\t\tconst datasetName = response.data.name ?? this.$store.state.config.datasetProperties.name;\n\t\t\tconst datasetId = response.data.id ?? this.$store.state.config.datasetProperties.id;\n\t\t\tthis.popupParams.savingSuccess = {\n\t\t\t\ttitle: datasetName,\n\t\t\t\tdatasetId,\n\t\t\t\tfileName: this.$store.state.config.fileProperties.fileName,\n\t\t\t};\n\n\t\t\tthis.togglePopup('savingProgress', false);\n\t\t\tthis.togglePopup('savingSuccess', true);\n\t\t\tthis.isChanged = false;\n\t\t\tthis.isSaveComplete = true;\n\t\t\tBX.SidePanel.Instance.postMessage(window, 'BIConnector.dataset-import:onDatasetCreated', {});\n\t\t\tthis.sendAnalytics({\n\t\t\t\tevent: this.isEditMode ? 'edit_end' : 'creation_end',\n\t\t\t\tstatus: 'success',\n\t\t\t\tp1: `datasetName_${datasetName.replaceAll('_', '')}`,\n\t\t\t});\n\t\t},\n\t\tonSaveError()\n\t\t{\n\t\t\tthis.togglePopup('savingProgress', false);\n\t\t\tthis.togglePopup('savingFailure', true);\n\t\t\tBX.SidePanel.Instance.postMessage(window, 'BIConnector.dataset-import:onDatasetCreated', {});\n\n\t\t\tthis.sendAnalytics({\n\t\t\t\tevent: this.isEditMode ? 'edit_end' : 'creation_end',\n\t\t\t\tstatus: 'error',\n\t\t\t});\n\t\t},\n\t\tonSuccessPopupClose()\n\t\t{\n\t\t\tthis.togglePopup('savingSuccess', false);\n\t\t\tthis.closeApp();\n\t\t},\n\t\tcloseFailurePopup()\n\t\t{\n\t\t\tthis.togglePopup('savingFailure', false);\n\t\t},\n\t\tonReplacementButtonClick()\n\t\t{\n\t\t\tthis.isEditModeSaveConfirmed = true;\n\t\t\tthis.togglePopup('editModeFileReplacement', false);\n\t\t\tthis.onSaveButtonClick();\n\t\t},\n\t\tstartPreviewLoadingAnimation()\n\t\t{\n\t\t\tthis.isDataLoadingAnimationDisplayed = true;\n\t\t\tthis.hasMinimalLoadingAnimationTimePassed = false;\n\t\t\tsetTimeout(() => {\n\t\t\t\tthis.hasMinimalLoadingAnimationTimePassed = true;\n\t\t\t}, 1500);\n\t\t},\n\t\tstopPreviewLoadingAnimation()\n\t\t{\n\t\t\tthis.isDataLoadingAnimationDisplayed = false;\n\t\t},\n\t\tonCheckFileClick()\n\t\t{\n\t\t\tthis.popupParams.fileErrors.isSavingMode = false;\n\t\t\tif (this.previewError)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tthis.togglePopup('checkFileProgress', true);\n\t\t\tthis.checkFile()\n\t\t\t\t.then(() => {\n\t\t\t\t\tthis.togglePopup('checkFileProgress', false);\n\t\t\t\t\tthis.togglePopup('checkFileSuccess', true);\n\t\t\t\t})\n\t\t\t\t.catch(() => {\n\t\t\t\t\tthis.togglePopup('checkFileProgress', false);\n\t\t\t\t\tthis.togglePopup('fileErrors', true);\n\t\t\t\t})\n\t\t\t;\n\t\t},\n\t\tonExportFileClick()\n\t\t{\n\t\t\tconst button = document.querySelector('.biconnector-export-file-button');\n\n\t\t\tif (!button)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tDom.addClass(button, 'ui-btn-wait');\n\t\t\tDom.attr(button, { disabled: true });\n\n\t\t\tFileExport.getInstance().download({\n\t\t\t\tid: this.datasetId,\n\t\t\t\ttitle: this.$store.state.config.datasetProperties.name ?? 'dataset',\n\t\t\t})\n\t\t\t\t.then(() => {\n\t\t\t\t\tDom.removeClass(button, 'ui-btn-wait');\n\t\t\t\t\tDom.attr(button, { disabled: null });\n\t\t\t\t})\n\t\t\t\t.catch(() => {\n\t\t\t\t\tDom.removeClass(button, 'ui-btn-wait');\n\t\t\t\t\tDom.attr(button, { disabled: null });\n\t\t\t\t})\n\t\t\t;\n\t\t},\n\t\tsaveIgnoringErrors()\n\t\t{\n\t\t\tthis.togglePopup('fileErrors', false);\n\t\t\tthis.togglePopup('savingProgress', true);\n\t\t\tthis.handleSaveAction();\n\t\t},\n\t\tcheckFile(): Promise\n\t\t{\n\t\t\tif (this.isErrorsChecked)\n\t\t\t{\n\t\t\t\tif (this.checkFileErrors.length > 0)\n\t\t\t\t{\n\t\t\t\t\treturn Promise.reject();\n\t\t\t\t}\n\n\t\t\t\treturn Promise.resolve();\n\t\t\t}\n\n\t\t\treturn new Promise((resolve, reject) => {\n\t\t\t\tAjax.runAction('biconnector.externalsource.dataset.checkFile', {\n\t\t\t\t\tdata: {\n\t\t\t\t\t\ttype: this.sourceCode,\n\t\t\t\t\t\tfields: this.loadParams,\n\t\t\t\t\t},\n\t\t\t\t})\n\t\t\t\t\t.then((response) => {\n\t\t\t\t\t\tthis.checkFileErrors = this.prepareCheckFileErrors(response.data.checkFileErrors);\n\t\t\t\t\t\tthis.isErrorsChecked = true;\n\t\t\t\t\t\tif (this.checkFileErrors.length > 0)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\treject();\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tresolve();\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\t\t\t\t\t.catch((response) => {\n\t\t\t\t\t\tconsole.error(response);\n\t\t\t\t\t\tthis.togglePopup('checkFileProgress', false);\n\t\t\t\t\t\tthis.togglePopup('savingProgress', false);\n\t\t\t\t\t\tthis.togglePopup('checkFileFailure', true);\n\t\t\t\t\t})\n\t\t\t\t;\n\t\t\t});\n\t\t},\n\t\tprepareCheckFileErrors(errors: Object): Array\n\t\t{\n\t\t\tconst result = [];\n\t\t\tObject.keys(errors).forEach((lineNumber) => {\n\t\t\t\terrors[lineNumber].forEach((error) => {\n\t\t\t\t\tresult.push({\n\t\t\t\t\t\tlineNumber,\n\t\t\t\t\t\terrorMessage: error.message,\n\t\t\t\t\t\tcolumnName: this.$store.state.config.fieldsSettings[error.customData.field].name,\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t});\n\n\t\t\treturn result;\n\t\t},\n\t\ttoggleCheckFileButton(disabled: boolean): void\n\t\t{\n\t\t\tconst button = document.querySelector('.biconnector-check-file-button');\n\t\t\tif (button)\n\t\t\t{\n\t\t\t\tif (disabled)\n\t\t\t\t{\n\t\t\t\t\tDom.addClass(button, 'ui-btn-disabled');\n\t\t\t\t\tDom.attr(button, 'disabled', true);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tDom.removeClass(button, 'ui-btn-disabled');\n\t\t\t\t\tDom.attr(button, 'disabled', null);\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t},\n\tmounted()\n\t{\n\t\tif (this.isEditMode)\n\t\t{\n\t\t\tthis.initialPreviewData = this.$store.state.previewData.rows;\n\t\t\tthis.initialFieldsSettings = this.$store.state.config.fieldsSettings;\n\t\t}\n\n\t\tEventEmitter.subscribe('biconnector:dataset-import:onCheckFileClick', this.onCheckFileClick);\n\t\tEventEmitter.subscribe('biconnector:dataset-import:onExportFileClick', this.onExportFileClick);\n\t\tEventEmitter.subscribe('SidePanel.Slider:onClose', () => {\n\t\t\tURL.revokeObjectURL(this.exportDownloadLink);\n\t\t});\n\t},\n\tbeforeUnmount()\n\t{\n\t\tEventEmitter.unsubscribe('biconnector:dataset-import:onCheckFileClick', this.onCheckFileClick);\n\t\tEventEmitter.unsubscribe('biconnector:dataset-import:onExportFileClick', this.onExportFileClick);\n\t\tURL.revokeObjectURL(this.exportDownloadLink);\n\t},\n\tcomponents: {\n\t\tAppLayout,\n\t\tImportConfig,\n\t\tImportPreview,\n\t\tFileStep,\n\t\tDatasetPropertiesStep,\n\t\tFieldsSettingsStep,\n\t\tImportProgressPopup,\n\t\tImportSuccessPopup,\n\t\tImportFailurePopup,\n\t\tGenericPopup,\n\t\tFileErrorsPopup,\n\t\tCheckingProgressPopup,\n\t\tCheckingSuccessPopup,\n\t\tCheckingFailedPopup,\n\t},\n\t// language=Vue\n\ttemplate: `\n\t\t<AppLayout :save-locked=\"!isSaveEnabled\" ref=\"appLayout\" :is-edit-mode=\"isEditMode\">\n\t\t\t<template v-slot:left-panel>\n\t\t\t\t<ImportConfig>\n\t\t\t\t\t<FileStep\n\t\t\t\t\t\t:separators=\"appParams.separators\"\n\t\t\t\t\t\t:encodings=\"appParams.encodings\"\n\t\t\t\t\t\t:disabled=\"steps.file.disabled\"\n\t\t\t\t\t\t:data-format-templates=\"appParams.dataFormatTemplates\"\n\t\t\t\t\t\tref=\"fileStep\"\n\t\t\t\t\t\t@validation=\"onStepValidation('file', $event)\"\n\t\t\t\t\t\t@file-properties-change=\"onDatasetReloadNeeded('file')\"\n\t\t\t\t\t\t@parsing-options-changed=\"onDatasetReloadNeeded('fields')\"\n\t\t\t\t\t/>\n\t\t\t\t\t<DatasetPropertiesStep\n\t\t\t\t\t\t:is-open-initially=\"isEditMode\"\n\t\t\t\t\t\t:disabled=\"steps.properties.disabled\"\n\t\t\t\t\t\t:reserved-names=\"appParams.reservedNames\"\n\t\t\t\t\t\t:name-max-length=30\n\t\t\t\t\t\tref=\"propertiesStep\"\n\t\t\t\t\t\t@validation=\"onStepValidation('properties', $event)\"\n\t\t\t\t\t\t@properties-changed=\"onDatasetPropertiesChanged\"\n\t\t\t\t\t\t:dataset-source-code=\"sourceCode\"\n\t\t\t\t\t/>\n\t\t\t\t\t<FieldsSettingsStep\n\t\t\t\t\t\t:is-open-initially=\"isEditMode\"\n\t\t\t\t\t\t:disabled=\"steps.fields.disabled\"\n\t\t\t\t\t\t:source-type=\"sourceType\"\n\t\t\t\t\t\tref=\"fieldsStep\"\n\t\t\t\t\t\t@validation=\"onStepValidation('fields', $event)\"\n\t\t\t\t\t\t@parsing-options-changed=\"onDatasetReloadNeeded('fields')\"\n\t\t\t\t\t\t@settings-changed=\"onFieldsSettingsChanged\"\n\t\t\t\t\t/>\n\t\t\t\t</ImportConfig>\n\t\t\t</template>\n\t\t\t<template v-slot:right-panel>\n\t\t\t\t<ImportPreview \n\t\t\t\t\t:error=\"previewError\"\n\t\t\t\t\t:is-loading=\"isDataLoadingAnimationDisplayed || !hasMinimalLoadingAnimationTimePassed\"\n\t\t\t\t/>\n\t\t\t</template>\n\t\t</AppLayout>\n\n\t\t<ImportProgressPopup\n\t\t\tv-if=\"shownPopups.savingProgress\"\n\t\t\t:description=\"importProgressPopupDescription\"\n\t\t/>\n\n\t\t<ImportSuccessPopup\n\t\t\tv-if=\"shownPopups.savingSuccess\"\n\t\t\t@close=\"onSuccessPopupClose\"\n\t\t\t@click=\"closeApp\"\n\t\t\t@one-more-click=\"reload\"\n\t\t\t:title=\"importSuccessPopupTitle\"\n\t\t\t:description=\"importSuccessPopupDescription\"\n\t\t\t:dataset-id=\"popupParams.savingSuccess.datasetId\"\n\t\t\t:show-more-button=\"!isEditMode\"\n\t\t/>\n\n\t\t<ImportFailurePopup\n\t\t\tv-if=\"shownPopups.savingFailure\"\n\t\t\t@close=\"closeFailurePopup\"\n\t\t\t@click=\"closeFailurePopup\"\n\t\t\t:title=\"importFailurePopupTitle\"\n\t\t\t:description=\"$Bitrix.Loc.getMessage('DATASET_IMPORT_FAILURE_POPUP_DESCRIPTION').replace('[link]', '<a>').replace('[/link]', '</a>')\"\n\t\t/>\n\n\t\t<GenericPopup\n\t\t\tv-if=\"shownPopups.editModeFileReplacement\"\n\t\t\t:title=\"$Bitrix.Loc.getMessage('DATASET_IMPORT_FILE_REPLACEMENT_TITLE')\"\n\t\t\t@close=\"togglePopup('editModeFileReplacement', false)\"\n\t\t>\n\t\t\t<template v-slot:content>\n\t\t\t\t{{ $Bitrix.Loc.getMessage('DATASET_IMPORT_FILE_REPLACEMENT_TEXT') }}\n\t\t\t</template>\n\t\t\t<template v-slot:buttons>\n\t\t\t\t<button @click=\"onReplacementButtonClick\" class=\"ui-btn ui-btn-md ui-btn-primary\">{{\n\t\t\t\t\t$Bitrix.Loc.getMessage('DATASET_IMPORT_FILE_REPLACEMENT_LOAD') }}\n\t\t\t\t</button>\n\t\t\t\t<button @click=\"togglePopup('editModeFileReplacement', false)\"\n\t\t\t\t\t\tclass=\"ui-btn ui-btn-md ui-btn-light-border\">{{\n\t\t\t\t\t$Bitrix.Loc.getMessage('DATASET_IMPORT_FILE_REPLACEMENT_CANCEL') }}\n\t\t\t\t</button>\n\t\t\t</template>\n\t\t</GenericPopup>\n\n\t\t<FileErrorsPopup\n\t\t\tv-if=\"shownPopups.fileErrors\"\n\t\t\t@close=\"togglePopup('fileErrors', false);\"\n\t\t\t@save-ignoring-errors=\"saveIgnoringErrors()\"\n\t\t\t:errors=\"checkFileErrors\"\n\t\t\t:is-edit-mode=\"this.isEditMode\"\n\t\t\t:is-saving-mode=\"popupParams.fileErrors.isSavingMode\"\n\t\t/>\n\t\t<CheckingProgressPopup\n\t\t\tv-if=\"shownPopups.checkFileProgress\"\n\t\t\t@close=\"togglePopup('checkFileProgress', false)\"\n\t\t/>\n\t\t<CheckingSuccessPopup\n\t\t\tv-if=\"shownPopups.checkFileSuccess\"\n\t\t\t@close=\"togglePopup('checkFileSuccess', false)\"\n\t\t/>\n\t\t<CheckingFailedPopup\n\t\t\tv-if=\"shownPopups.checkFileFailure\"\n\t\t\t@close=\"togglePopup('checkFileFailure', false)\"\n\t\t/>\n\t`,\n};\n","import type { PopupOptions } from 'main.popup';\nimport { Popup } from '../../layout/popup';\n\nexport const SyncFieldsPopup = {\n\temits: ['close'],\n\tprops: {\n\t\tisChange: {\n\t\t\ttype: Boolean,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tcomputed: {\n\t\tpopupOptions(): PopupOptions\n\t\t{\n\t\t\treturn {\n\t\t\t\twidth: 440,\n\t\t\t\tcloseIcon: true,\n\t\t\t\tnoAllPaddings: true,\n\t\t\t\toverlay: true,\n\t\t\t};\n\t\t},\n\t},\n\tmethods: {\n\t\tgetDescription(): string\n\t\t{\n\t\t\treturn this.isChange\n\t\t\t\t? this.$Bitrix.Loc.getMessage('DATASET_IMPORT_SYNC_FIELDS_POPUP_DESCRIPTION_CHANGED')\n\t\t\t\t: this.$Bitrix.Loc.getMessage('DATASET_IMPORT_SYNC_FIELDS_POPUP_DESCRIPTION_NOT_CHANGED');\n\t\t},\n\t\tonClose()\n\t\t{\n\t\t\tthis.$emit('close');\n\t\t},\n\t},\n\tcomponents: {\n\t\tPopup,\n\t},\n\t// language=Vue\n\ttemplate: `\n\t\t<Popup id=\"syncFields\" @close=\"this.onClose\" :options=\"popupOptions\" wrapper-class=\"generic-popup\">\n\t\t\t<h3 class=\"generic-popup__header\">{{ $Bitrix.Loc.getMessage('DATASET_IMPORT_SYNC_FIELDS_POPUP_HEADER') }}</h3>\n\t\t\t<div class=\"generic-popup__content\">\n\t\t\t\t{{ getDescription() }}\n\t\t\t</div>\n\t\t\t<div class=\"generic-popup__buttons-wrapper\">\n\t\t\t\t<button @click=\"onClose\" class=\"ui-btn ui-btn-md ui-btn-primary\">\n\t\t\t\t\t{{ $Bitrix.Loc.getMessage('DATASET_IMPORT_SYNC_FIELDS_POPUP_BUTTON') }}\n\t\t\t\t</button>\n\t\t\t</div>\n\t\t</Popup>\n\t`,\n};\n","import { Dom, Event, Tag, Type, Text } from 'main.core';\nimport { BaseEvent, EventEmitter } from 'main.core.events';\nimport { BaseField } from './base-field';\nimport { Dialog, Item, TagSelector } from 'ui.entity-selector';\nimport '../../css/entity-selector-field.css';\n\nexport const ConnectionSelectorField = {\n\textends: BaseField,\n\tprops: {\n\t\toptions: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t\titems: {\n\t\t\ttype: Array,\n\t\t\trequired: true,\n\t\t},\n\t\tconnectionId: {\n\t\t\ttype: Number,\n\t\t\trequired: false,\n\t\t},\n\t},\n\tmounted()\n\t{\n\t\tconst node = this.$refs['entity-selector'];\n\t\tconst selector: TagSelector = new TagSelector({\n\t\t\tid: this.options.selectorId,\n\t\t\tmultiple: false,\n\t\t\taddButtonCaption: this.$Bitrix.Loc.getMessage('DATASET_IMPORT_CONNECTIONS_SELECT'),\n\t\t\taddButtonCaptionMore: this.$Bitrix.Loc.getMessage('DATASET_IMPORT_CONNECTIONS_CHANGE'),\n\t\t\tdialogOptions: {\n\t\t\t\tid: this.options.selectorId,\n\t\t\t\titems: this.preparedItems,\n\t\t\t\tenableSearch: true,\n\t\t\t\tdropdownMode: true,\n\t\t\t\tshowAvatars: true,\n\t\t\t\tcompactView: false,\n\t\t\t\tmultiple: false,\n\t\t\t\twidth: 460,\n\t\t\t\theight: 420,\n\t\t\t\ttabs: [{\n\t\t\t\t\tid: 'connections',\n\t\t\t\t\tstubOptions: {\n\t\t\t\t\t\ttitle: this.$Bitrix.Loc.getMessage('DATASET_IMPORT_NO_CONNECTIONS_TITLE'),\n\t\t\t\t\t\tsubtitle: this.$Bitrix.Loc.getMessage('DATASET_IMPORT_NO_CONNECTIONS_SUBTITLE'),\n\t\t\t\t\t\tarrow: true,\n\t\t\t\t\t\ticon: '/bitrix/images/biconnector/database-connections/connections-empty-state.png',\n\t\t\t\t\t\ticonOpacity: 100,\n\t\t\t\t\t},\n\t\t\t\t}],\n\t\t\t\tentities: [{\n\t\t\t\t\tid: 'biconnector-external-connection',\n\t\t\t\t}],\n\t\t\t},\n\t\t\tevents: {\n\t\t\t\tonTagAdd: (event: BaseEvent) => {\n\t\t\t\t\tthis.$emit('valueChange', event);\n\t\t\t\t},\n\t\t\t\tonTagRemove: (event: BaseEvent) => {\n\t\t\t\t\tthis.$emit('valueClear', event);\n\t\t\t\t},\n\t\t\t},\n\t\t});\n\t\tDom.addClass(selector.getDialog().getContainer(), 'biconnector-dataset-entity-selector');\n\t\tselector.renderTo(node);\n\n\t\tconst footer = Tag.render`\n\t\t\t<span class=\"ui-selector-footer-link ui-selector-footer-link-add\">\n\t\t\t\t${this.$Bitrix.Loc.getMessage('DATASET_IMPORT_NO_CONNECTIONS_FOOTER')}\n\t\t\t</span>\n\t\t`;\n\t\tEvent.bind(footer, 'click', () => {\n\t\t\tconst link = '/bitrix/components/bitrix/biconnector.externalconnection/slider.php?closeAfterCreate=Y';\n\t\t\tBX.SidePanel.Instance.open(link, {\n\t\t\t\twidth: 564,\n\t\t\t\tallowChangeHistory: false,\n\t\t\t\tcacheable: false,\n\t\t\t});\n\t\t});\n\t\tselector.getDialog().getTab(this.name).setFooter(footer);\n\n\t\tthis.selector = selector;\n\n\t\tEventEmitter.subscribe('SidePanel.Slider:onMessage', (event) => {\n\t\t\tconst [messageEvent] = event.getData();\n\t\t\tif (messageEvent.getEventId() === 'BIConnector:ExternalConnection:onConnectionSave')\n\t\t\t{\n\t\t\t\tthis.onConnectionSave(messageEvent);\n\t\t\t}\n\t\t});\n\t},\n\tcomputed: {\n\t\tpreparedItems(): Array\n\t\t{\n\t\t\tconst selectorItems = [];\n\t\t\tthis.items.forEach((item) => {\n\t\t\t\tconst itemOptions = {\n\t\t\t\t\tid: item.ID,\n\t\t\t\t\ttitle: item.TITLE,\n\t\t\t\t\tentityId: this.options.selectorId,\n\t\t\t\t\ttabs: this.name,\n\t\t\t\t\tlink: `/bitrix/components/bitrix/biconnector.externalconnection/slider.php?sourceId=${item.ID}&closeAfterCreate=Y`,\n\t\t\t\t\tlinkTitle: this.$Bitrix.Loc.getMessage('DATASET_IMPORT_CONNECTIONS_ABOUT'),\n\t\t\t\t\tcustomData: {\n\t\t\t\t\t\tconnectionType: item.TYPE,\n\t\t\t\t\t},\n\t\t\t\t};\n\n\t\t\t\tif (item.AVATAR)\n\t\t\t\t{\n\t\t\t\t\titemOptions.avatar = item.AVATAR;\n\t\t\t\t}\n\n\t\t\t\tif (this.connectionId)\n\t\t\t\t{\n\t\t\t\t\titemOptions.selected = item.ID === this.connectionId.toString();\n\t\t\t\t}\n\n\t\t\t\tselectorItems.push(itemOptions);\n\t\t\t});\n\n\t\t\treturn selectorItems;\n\t\t},\n\t},\n\tmethods: {\n\t\tonConnectionSave(event)\n\t\t{\n\t\t\tconst itemOptions: {id: number, name: string, type: string, avatar: ?string} = event.getData().connection;\n\t\t\tif (!Type.isStringFilled(itemOptions?.avatar))\n\t\t\t{\n\t\t\t\titemOptions.avatar = `/bitrix/images/biconnector/database-connections/${itemOptions.type}.svg`;\n\t\t\t}\n\n\t\t\tconst selector: TagSelector = this.selector;\n\t\t\tconst dialog: Dialog = selector.getDialog();\n\t\t\tlet item: ?Item = dialog.getItem({\n\t\t\t\tid: itemOptions.id,\n\t\t\t\tentityId: this.options.selectorId,\n\t\t\t});\n\n\t\t\tif (item)\n\t\t\t{\n\t\t\t\titem.setTitle({ text: Text.decode(itemOptions.name), type: 'text' });\n\t\t\t\tif (item.isSelected())\n\t\t\t\t{\n\t\t\t\t\tselector.removeTags();\n\t\t\t\t\titem.deselect();\n\t\t\t\t\titem.select();\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\titem = dialog.addItem({\n\t\t\t\t\tid: itemOptions.id,\n\t\t\t\t\ttitle: itemOptions.name,\n\t\t\t\t\tentityId: this.options.selectorId,\n\t\t\t\t\ttabs: this.name,\n\t\t\t\t\tlink: `/bitrix/components/bitrix/biconnector.externalconnection/slider.php?sourceId=${itemOptions.id}&closeAfterCreate=Y`,\n\t\t\t\t\tlinkTitle: this.$Bitrix.Loc.getMessage('DATASET_IMPORT_CONNECTIONS_ABOUT'),\n\t\t\t\t\tavatar: `/bitrix/images/biconnector/database-connections/${itemOptions.type}.svg`,\n\t\t\t\t\tcustomData: {\n\t\t\t\t\t\tconnectionType: itemOptions.type,\n\t\t\t\t\t},\n\t\t\t\t});\n\t\t\t\titem.select();\n\t\t\t}\n\n\t\t\tdialog.hide();\n\t\t},\n\t},\n\t// language=Vue\n\ttemplate: `\n\t\t<div>\n\t\t\t<div class=\"ui-ctl-title\">\n\t\t\t\t<div class=\"ui-ctl-label-text\">{{ this.title }}</div>\n\t\t\t</div>\n\t\t\t<div ref=\"entity-selector\"></div>\n\t\t\t<div \n\t\t\t\tv-if=\"!isValid\"\n\t\t\t\tclass=\"connection-error\"\n\t\t\t>\n\t\t\t\t{{ this.errorMessage }}\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import { Dom } from 'main.core';\nimport { BaseEvent, EventEmitter } from 'main.core.events';\nimport { BaseField } from './base-field';\nimport { TagSelector, Dialog } from 'ui.entity-selector';\nimport { BIcon, Set } from 'ui.icon-set.api.vue';\nimport { hint } from 'ui.vue3.directives.hint';\nimport '../../css/entity-selector-field.css';\n\nexport const TableSelectorField = {\n\textends: BaseField,\n\tdirectives: {\n\t\thint,\n\t},\n\tprops: {\n\t\toptions: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t\tconnectionId: {\n\t\t\ttype: Number,\n\t\t\trequired: true,\n\t\t},\n\t\tselectedConnectionType: {\n\t\t\ttype: String,\n\t\t\trequired: false,\n\t\t},\n\t},\n\tdata(): {}\n\t{\n\t\treturn {\n\t\t\thasErrors: false,\n\t\t};\n\t},\n\tmounted()\n\t{\n\t\tconst node = this.$refs['entity-selector'];\n\t\tconst selector: TagSelector = new TagSelector({\n\t\t\tid: this.options.selectorId,\n\t\t\tmultiple: false,\n\t\t\taddButtonCaption: this.$Bitrix.Loc.getMessage('DATASET_IMPORT_CONNECTIONS_SELECT'),\n\t\t\taddButtonCaptionMore: this.$Bitrix.Loc.getMessage('DATASET_IMPORT_CONNECTIONS_CHANGE'),\n\t\t\tdialogOptions: {\n\t\t\t\tid: this.options.selectorId,\n\t\t\t\tenableSearch: true,\n\t\t\t\tdropdownMode: true,\n\t\t\t\tshowAvatars: false,\n\t\t\t\tcompactView: true,\n\t\t\t\tmultiple: false,\n\t\t\t\tdynamicLoad: true,\n\t\t\t\twidth: 460,\n\t\t\t\theight: 420,\n\t\t\t\ttabs: [{\n\t\t\t\t\tid: 'tables',\n\t\t\t\t\tstub: true,\n\t\t\t\t\tstubOptions: {\n\t\t\t\t\t\ttitle: this.$Bitrix.Loc.getMessage('DATASET_IMPORT_TABLES_STUB_TITLE'),\n\t\t\t\t\t\tsubtitle: this.$Bitrix.Loc.getMessage('DATASET_IMPORT_TABLES_STUB_SUBTITLE'),\n\t\t\t\t\t},\n\t\t\t\t}],\n\t\t\t\tentities: [{\n\t\t\t\t\tid: 'biconnector-external-table',\n\t\t\t\t\tdynamicLoad: false,\n\t\t\t\t\tdynamicSearch: true,\n\t\t\t\t\toptions: {\n\t\t\t\t\t\t...(this.connectionId && { connectionId: this.connectionId }),\n\t\t\t\t\t},\n\t\t\t\t}],\n\t\t\t\tevents: {\n\t\t\t\t\t'Entity:onError': (event: BaseEvent) => {\n\t\t\t\t\t\tthis.onError(event);\n\t\t\t\t\t},\n\t\t\t\t\tonSearch: (event: BaseEvent) => {\n\t\t\t\t\t\tthis.onSearch(event);\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t},\n\t\t\tevents: {\n\t\t\t\tonTagAdd: (event: BaseEvent) => {\n\t\t\t\t\tthis.$emit('valueChange', event);\n\t\t\t\t},\n\t\t\t\tonTagRemove: (event: BaseEvent) => {\n\t\t\t\t\tthis.$emit('valueClear', event);\n\t\t\t\t},\n\t\t\t},\n\t\t});\n\t\tDom.addClass(selector.getDialog().getContainer(), 'biconnector-dataset-entity-selector');\n\t\tselector.setLocked(!(this.connectionId > 0 && !this.isDisabled));\n\t\tselector.renderTo(node);\n\n\t\tthis.selector = selector;\n\n\t\tEventEmitter.subscribe('SidePanel.Slider:onMessage', (event) => {\n\t\t\tconst [messageEvent] = event.getData();\n\t\t\tif (messageEvent.getEventId() === 'BIConnector:ExternalConnection:onConnectionSave')\n\t\t\t{\n\t\t\t\tthis.selector.removeTags();\n\t\t\t}\n\t\t});\n\t},\n\tcomputed: {\n\t\tset(): Set\n\t\t{\n\t\t\treturn Set;\n\t\t},\n\t\thintOptions(): Object\n\t\t{\n\t\t\tconst hintCode: string =\n\t\t\t\tthis.selectedConnectionType === 'rest'\n\t\t\t\t\t? 'DATASET_IMPORT_REST_TABLES_HINT'\n\t\t\t\t\t: 'DATASET_IMPORT_TABLES_HINT'\n\t\t\t;\n\n\t\t\treturn {\n\t\t\t\ttext: this.$Bitrix.Loc.getMessage(hintCode),\n\t\t\t\tpopupOptions: {\n\t\t\t\t\tbindOptions: {\n\t\t\t\t\t\tposition: 'top',\n\t\t\t\t\t},\n\t\t\t\t\toffsetTop: -10,\n\t\t\t\t\tangle: {\n\t\t\t\t\t\tposition: 'top',\n\t\t\t\t\t\toffset: 34,\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t};\n\t\t},\n\t},\n\twatch: {\n\t\tconnectionId(newConnectionId)\n\t\t{\n\t\t\tconst selector: TagSelector = this.selector;\n\t\t\tselector.removeTags();\n\t\t\tselector.getDialog().removeItems();\n\n\t\t\tif (!newConnectionId)\n\t\t\t{\n\t\t\t\tselector.setLocked(true);\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tselector.getDialog().getEntity('biconnector-external-table').options.connectionId = newConnectionId;\n\t\t\tselector.setLocked(this.isDisabled);\n\t\t},\n\t},\n\tmethods: {\n\t\tonError(event: BaseEvent)\n\t\t{\n\t\t\tconst errors = event.getData().errors;\n\t\t\tconst dialog: Dialog = event.getTarget();\n\t\t\tconst tableTab = dialog.getTab('tables');\n\t\t\ttableTab.getStub().hide();\n\t\t\tdialog.selectTab('tables');\n\t\t\ttableTab.setStub(\n\t\t\t\ttrue,\n\t\t\t\t{\n\t\t\t\t\ttitle: errors[0].message,\n\t\t\t\t\ticon: '/bitrix/js/biconnector/dataset-import/dist/images/table-error-state.svg',\n\t\t\t\t\ticonOpacity: 100,\n\t\t\t\t},\n\t\t\t);\n\t\t\ttableTab.getStub().show();\n\n\t\t\tthis.hasErrors = true;\n\t\t},\n\t\tonSearch(event: BaseEvent)\n\t\t{\n\t\t\tif (!this.hasErrors)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst dialog: Dialog = event.getTarget();\n\t\t\tconst tableTab = dialog.getTab('tables');\n\t\t\ttableTab.getStub().hide();\n\t\t\ttableTab.setStub(true, {\n\t\t\t\ttitle: this.$Bitrix.Loc.getMessage('DATASET_IMPORT_TABLES_STUB_TITLE'),\n\t\t\t\tsubtitle: this.$Bitrix.Loc.getMessage('DATASET_IMPORT_TABLES_STUB_SUBTITLE'),\n\t\t\t});\n\n\t\t\tthis.hasErrors = false;\n\t\t},\n\t},\n\tcomponents: {\n\t\tBIcon,\n\t},\n\t// language=Vue\n\ttemplate: `\n\t\t<div>\n\t\t\t<div class=\"ui-ctl-title\">\n\t\t\t\t<div class=\"ui-ctl-label-text table-title\">\n\t\t\t\t\t<span>{{ this.title }}</span>\n\t\t\t\t\t<div v-if='selectedConnectionType' class=\"table-hint\" v-hint=\"hintOptions\">\n\t\t\t\t\t\t<BIcon\n\t\t\t\t\t\t\t:name=\"set.HELP\"\n\t\t\t\t\t\t\t:size=\"20\"\n\t\t\t\t\t\t\tcolor=\"#D5D7DB\"\n\t\t\t\t\t\t></BIcon>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div ref=\"entity-selector\"></div>\n\t\t</div>\n\t`,\n};\n","import { ajax as Ajax, Text } from 'main.core';\nimport { BaseStep } from './base-step';\nimport { ConnectionSelectorField } from '../fields/type/connection-selector-field';\nimport { CustomField } from '../fields/type/custom-field';\nimport { TableSelectorField } from '../fields/type/table-selector-field';\nimport { StringField } from '../fields/type/string-field';\nimport { EventEmitter } from 'main.core.events';\nimport '../css/connection.css';\n\nexport const ConnectionStep = {\n\textends: BaseStep,\n\tprops: {\n\t\tconnections: {\n\t\t\ttype: Array,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\ttableId: this.$store.state.config.table,\n\t\t\tconnectionSelectorId: 'biconnector-external-connection',\n\t\t\ttableSelectorId: 'biconnector-external-table',\n\t\t\tunvalidatedFields: {},\n\t\t};\n\t},\n\tcomponents: {\n\t\tConnectionSelectorField,\n\t\tCustomField,\n\t\tTableSelectorField,\n\t\tStringField,\n\t},\n\tcomputed: {\n\t\tdefaultTitle(): string\n\t\t{\n\t\t\treturn this.$Bitrix.Loc.getMessage('DATASET_IMPORT_CONNECTIONS_HEADER');\n\t\t},\n\t\tconnectionSelectorOptions(): Object\n\t\t{\n\t\t\treturn {\n\t\t\t\tselectorId: this.connectionSelectorId,\n\t\t\t};\n\t\t},\n\t\ttableSelectorOptions(): Object\n\t\t{\n\t\t\treturn {\n\t\t\t\tselectorId: this.tableSelectorId,\n\t\t\t};\n\t\t},\n\t\tselectedConnectionType(): string\n\t\t{\n\t\t\treturn this.$store.getters.connectionProperties?.connectionType;\n\t\t},\n\t\tselectedConnectionAvatar(): ?string\n\t\t{\n\t\t\tconst id = this.selectedConnectionId;\n\t\t\tif (id > 0)\n\t\t\t{\n\t\t\t\tconst connection = this.connections.find((item) => parseFloat(item.ID) === id);\n\t\t\t\tif (connection)\n\t\t\t\t{\n\t\t\t\t\treturn connection.AVATAR;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn `/bitrix/images/biconnector/database-connections/${this.selectedConnectionType}.svg`;\n\t\t},\n\t\tselectedConnectionId(): number\n\t\t{\n\t\t\treturn this.$store.getters.connectionProperties?.connectionId ?? 0;\n\t\t},\n\t\tselectedConnectionName(): number\n\t\t{\n\t\t\treturn this.$store.getters.connectionProperties?.connectionName;\n\t\t},\n\t\tselectedTableName(): string\n\t\t{\n\t\t\treturn this.$store.getters.connectionProperties?.tableName;\n\t\t},\n\t\tisEditMode(): boolean\n\t\t{\n\t\t\treturn this.$store.getters.isEditMode;\n\t\t},\n\t},\n\tmethods: {\n\t\tonConnectionSelected(event)\n\t\t{\n\t\t\tconst tag = event.data.tag;\n\t\t\tconst dialogItems = event.target.getDialog().getItems();\n\t\t\tdialogItems.forEach((item) => {\n\t\t\t\tif (item.getId() === tag.getId())\n\t\t\t\t{\n\t\t\t\t\ttag.customData = item.getCustomData();\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tconst sourceId = parseInt(event.data.tag.getId(), 10);\n\n\t\t\tthis.$store.commit('setConnectionProperties', {\n\t\t\t\tconnectionType: event.data.tag.getCustomData().get('connectionType'),\n\t\t\t\tconnectionId: sourceId,\n\t\t\t\ttableName: null,\n\t\t\t});\n\n\t\t\tAjax.runAction('biconnector.externalsource.source.checkExistingConnection', {\n\t\t\t\tdata: {\n\t\t\t\t\tsourceId,\n\t\t\t\t},\n\t\t\t})\n\t\t\t\t.then(() => {\n\t\t\t\t\tthis.unvalidatedFields = {};\n\t\t\t\t})\n\t\t\t\t.catch((response) => {\n\t\t\t\t\tthis.unvalidatedFields = {\n\t\t\t\t\t\tconnection: {\n\t\t\t\t\t\t\tresult: false,\n\t\t\t\t\t\t\tmessage: response.errors[0].message,\n\t\t\t\t\t\t},\n\t\t\t\t\t};\n\t\t\t\t})\n\t\t\t;\n\t\t\tthis.$emit('validation', false);\n\t\t},\n\t\tonConnectionDeselected()\n\t\t{\n\t\t\tthis.$store.commit('setConnectionProperties', {\n\t\t\t\tconnectionType: null,\n\t\t\t\tconnectionId: null,\n\t\t\t\ttableName: null,\n\t\t\t});\n\t\t\tthis.$emit('validation', false);\n\t\t\tthis.unvalidatedFields = {};\n\t\t},\n\t\tonTableSelected(event)\n\t\t{\n\t\t\tthis.$store.commit('setConnectionProperties', {\n\t\t\t\tconnectionType: this.selectedConnectionType,\n\t\t\t\tconnectionId: this.selectedConnectionId,\n\t\t\t\ttableName: event.data.tag.getTitle(),\n\t\t\t});\n\n\t\t\tconst tag = event.data.tag;\n\t\t\tconst dialogItems = event.target.getDialog().getItems();\n\t\t\tdialogItems.forEach((item) => {\n\t\t\t\tif (item.getId() === tag.getId())\n\t\t\t\t{\n\t\t\t\t\ttag.customData = item.getCustomData();\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tthis.$store.commit('setDatasetProperties', {\n\t\t\t\tid: null,\n\t\t\t\tname: event.data.tag.getCustomData().get('datasetName'),\n\t\t\t\tcode: event.data.tag.getId(),\n\t\t\t\tdescription: event.data.tag.getTitle(),\n\t\t\t\texternalCode: event.data.tag.getId(),\n\t\t\t\texternalName: event.data.tag.getTitle(),\n\t\t\t});\n\n\t\t\tthis.$emit('tableSelected', event);\n\t\t\tthis.$emit('validation', true);\n\t\t\tthis.unvalidatedFields = {};\n\t\t},\n\t\tonTableDeselected(event)\n\t\t{\n\t\t\tthis.$store.commit('setConnectionProperties', {\n\t\t\t\tconnectionType: this.selectedConnectionType,\n\t\t\t\tconnectionId: this.selectedConnectionId,\n\t\t\t\ttableName: null,\n\t\t\t});\n\t\t\tthis.$store.commit('setDatasetProperties', {\n\t\t\t\tid: null,\n\t\t\t\tname: null,\n\t\t\t\tcode: null,\n\t\t\t\tdescription: null,\n\t\t\t\texternalCode: null,\n\t\t\t\texternalName: null,\n\t\t\t});\n\t\t\tthis.$emit('tableDeselected', event);\n\t\t\tthis.$emit('validation', false);\n\t\t\tthis.unvalidatedFields = {};\n\t\t},\n\t\topenConnectionSlider()\n\t\t{\n\t\t\tconst link = `/bitrix/components/bitrix/biconnector.externalconnection/slider.php?sourceId=${this.selectedConnectionId}&closeAfterCreate=Y`;\n\t\t\tBX.SidePanel.Instance.open(link, {\n\t\t\t\twidth: 564,\n\t\t\t\tallowChangeHistory: false,\n\t\t\t\tcacheable: false,\n\t\t\t});\n\t\t},\n\t\thandleSliderMessage(event)\n\t\t{\n\t\t\tconst [messageEvent] = event.getData();\n\t\t\tif (messageEvent.getEventId() === 'BIConnector:ExternalConnection:onConnectionSave')\n\t\t\t{\n\t\t\t\tconst connectionProperties = this.$store.getters.connectionProperties;\n\t\t\t\tconnectionProperties.connectionName = Text.decode(messageEvent.data.connection.name);\n\t\t\t\tthis.$store.commit('setConnectionProperties', connectionProperties);\n\t\t\t}\n\t\t},\n\t},\n\tmounted()\n\t{\n\t\tEventEmitter.subscribe('SidePanel.Slider:onMessage', this.handleSliderMessage);\n\t},\n\tbeforeUnmount()\n\t{\n\t\tEventEmitter.unsubscribe('SidePanel.Slider:onMessage', this.handleSliderMessage);\n\t},\n\temits: [\n\t\t'tableSelected',\n\t\t'tableDeselected',\n\t],\n\ttemplate: `\n\t\t<Step\n\t\t\t:title=\"displayedTitle\"\n\t\t\t:hint=\"displayedHint\"\n\t\t\t:is-open-initially=\"isOpenInitially\"\n\t\t\t:disabled=\"disabled\"\n\t\t\tref=\"stepBlock\"\n\t\t>\n\t\t\t<ConnectionSelectorField\n\t\t\t\tv-if=\"!this.isEditMode\"\n\t\t\t\t:options=\"this.connectionSelectorOptions\"\n\t\t\t\tname=\"connections\"\n\t\t\t\t:title=\"this.$Bitrix.Loc.getMessage('DATASET_IMPORT_CONNECTIONS_FIELD_TITLE')\"\n\t\t\t\t:items=\"this.connections\"\n\t\t\t\t:is-disabled=\"disabled\"\n\t\t\t\t:connection-id=\"this.selectedConnectionId\"\n\t\t\t\t@value-change=\"onConnectionSelected\"\n\t\t\t\t@value-clear=\"onConnectionDeselected\"\n\t\t\t\tref=\"connectionField\"\n\t\t\t\t:is-valid=\"unvalidatedFields.connection?.result ?? true\"\n\t\t\t\t:error-message=\"unvalidatedFields.connection?.message ?? ''\"\n\t\t\t/>\n\t\t\t<TableSelectorField\n\t\t\t\tv-if=\"!this.isEditMode\"\n\t\t\t\t:options=\"this.tableSelectorOptions\"\n\t\t\t\tname=\"tables\"\n\t\t\t\t:title=\"this.$Bitrix.Loc.getMessage('DATASET_IMPORT_TABLES_FIELD_TITLE')\"\n\t\t\t\t:connection-id=\"this.selectedConnectionId\"\n\t\t\t\t:is-disabled=\"disabled\"\n\t\t\t\t:selected-connection-type=\"selectedConnectionType\"\n\t\t\t\t@value-change=\"onTableSelected\"\n\t\t\t\t@value-clear=\"onTableDeselected\"\n\t\t\t\tref=\"tableField\"\n\t\t\t/>\n\n\t\t\t<div\n\t\t\t\tv-if=\"this.isEditMode\"\n\t\t\t>\n\t\t\t\t<CustomField\n\t\t\t\t\tname=\"connections\"\n\t\t\t\t\t:title=\"this.$Bitrix.Loc.getMessage('DATASET_IMPORT_CONNECTIONS_FIELD_TITLE')\"\n\t\t\t\t>\n\t\t\t\t\t<template #field-content>\n\t\t\t\t\t\t<div class=\"connection-preview\">\n\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\tclass=\"connection-icon\"\n\t\t\t\t\t\t\t\t:style=\"'background-image: url(\\\\'' + selectedConnectionAvatar + '\\\\');'\"\n\t\t\t\t\t\t\t></div>\n\t\t\t\t\t\t\t<div class=\"connection-name\" @click=\"openConnectionSlider\">\n\t\t\t\t\t\t\t\t{{ this.selectedConnectionName }}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</template>\n\t\t\t\t</CustomField>\n\n\t\t\t\t<StringField\n\t\t\t\t\tname=\"tables\"\n\t\t\t\t\t:title=\"this.$Bitrix.Loc.getMessage('DATASET_IMPORT_TABLES_FIELD_TITLE')\"\n\t\t\t\t\t:is-disabled=\"true\"\n\t\t\t\t\t:defaultValue=\"this.selectedTableName\"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t</Step>\n\t`,\n};\n","import { toRaw } from 'ui.vue3';\nimport { ajax as Ajax } from 'main.core';\nimport { EventEmitter } from 'main.core.events';\nimport { AppLayout } from '../layout/app-layout';\nimport { ImportConfig } from '../layout/import-config';\nimport { GenericPopup } from '../popups/generic-popup';\nimport { ImportFailurePopup } from '../popups/saving/import-failure-popup';\nimport { ImportProgressPopup } from '../popups/saving/import-progress-popup';\nimport { ImportSuccessPopup } from '../popups/saving/import-success-popup';\nimport { SyncFieldsPopup } from '../popups/sync/sync-fields-popup';\nimport { ConnectionStep } from '../steps/connection';\nimport { DatasetPropertiesStep } from '../steps/dataset-properties';\nimport { FieldsSettingsStep } from '../steps/fields-settings';\nimport { ImportPreview } from '../steps/import-preview';\nimport { BaseApp } from './base-app';\n\nexport const ExternalConnectionApp = {\n\textends: BaseApp,\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tsteps: {\n\t\t\t\tconnection: {\n\t\t\t\t\tdisabled: false,\n\t\t\t\t\tvalid: this.$store.getters.isEditMode,\n\t\t\t\t},\n\t\t\t\tproperties: {\n\t\t\t\t\tdisabled: !this.$store.getters.isEditMode,\n\t\t\t\t\tvalid: true,\n\t\t\t\t},\n\t\t\t\tfields: {\n\t\t\t\t\tdisabled: !this.$store.getters.isEditMode,\n\t\t\t\t\tvalid: true,\n\t\t\t\t\tdisabledElements: null,\n\t\t\t\t},\n\t\t\t},\n\t\t\tshownPopups: {\n\t\t\t\tsavingProgress: false,\n\t\t\t\tsavingSuccess: false,\n\t\t\t\tsavingFailure: false,\n\t\t\t\tloadFailure: false,\n\t\t\t\tsyncFields: false,\n\t\t\t\tfieldsSettingsChanges: false,\n\t\t\t},\n\t\t\tisValidationComplete: true,\n\t\t\tpopupParams: {\n\t\t\t\tsavingSuccess: {},\n\t\t\t\tloadFailure: {\n\t\t\t\t\tmessages: [],\n\t\t\t\t},\n\t\t\t\tsyncFields: {\n\t\t\t\t\tisChange: false,\n\t\t\t\t},\n\t\t\t},\n\t\t\tisLoading: false,\n\t\t\tpreviewError: '',\n\t\t\tpreviewDataLoaded: false,\n\t\t\tpendingSavePromise: null,\n\t\t\tinitialFieldsSettings: null,\n\t\t};\n\t},\n\tcreated() {\n\t\tthis.initialFieldsSettings = structuredClone(toRaw(this.$store.state.config.fieldsSettings));\n\t},\n\tcomputed: {\n\t\tisRestEntity(): boolean\n\t\t{\n\t\t\treturn this.sourceCode === 'rest';\n\t\t},\n\t\tsourceCode(): string\n\t\t{\n\t\t\treturn this.$store.state.config.connectionProperties?.connectionType ?? '';\n\t\t},\n\t\tisEditMode(): boolean\n\t\t{\n\t\t\treturn this.$store.getters.isEditMode;\n\t\t},\n\t\tloadParams(): Object\n\t\t{\n\t\t\treturn {\n\t\t\t\tdatasetProperties: this.$store.state.config.datasetProperties,\n\t\t\t\tfieldsSettings: this.$store.state.config.fieldsSettings,\n\t\t\t\tdataFormats: this.$store.state.config.dataFormats,\n\t\t\t\ttableName: this.$store.state.config.connectionProperties.tableName,\n\t\t\t\tconnectionType: this.$store.state.config.connectionProperties.connectionType,\n\t\t\t};\n\t\t},\n\t\tsaveParams(): Object\n\t\t{\n\t\t\treturn {\n\t\t\t\tdatasetProperties: this.$store.state.config.datasetProperties,\n\t\t\t\tfieldsSettings: this.$store.state.config.fieldsSettings,\n\t\t\t\tdataFormats: this.$store.state.config.dataFormats,\n\t\t\t\tconnectionSettings: this.$store.state.config.connectionProperties,\n\t\t\t};\n\t\t},\n\t\tisValidatedForSave(): boolean\n\t\t{\n\t\t\treturn this.steps.fields.valid && this.steps.properties.valid && this.steps.connection.valid;\n\t\t},\n\t\timportFailurePopupTitle()\n\t\t{\n\t\t\treturn this.isEditMode ? this.$Bitrix.Loc.getMessage('DATASET_IMPORT_FAILURE_POPUP_HEADER_EDIT') : this.$Bitrix.Loc.getMessage('DATASET_IMPORT_FAILURE_POPUP_HEADER');\n\t\t},\n\t\timportSuccessPopupTitle(): string\n\t\t{\n\t\t\treturn this.isEditMode\n\t\t\t\t? this.$Bitrix.Loc.getMessage('DATASET_IMPORT_SUCCESS_POPUP_HEADER_EDIT').replace('#DATASET_TITLE#', this.popupParams.savingSuccess.title)\n\t\t\t\t: this.$Bitrix.Loc.getMessage('DATASET_IMPORT_SUCCESS_POPUP_HEADER').replace('#DATASET_TITLE#', this.popupParams.savingSuccess.title)\n\t\t\t;\n\t\t},\n\t\timportProgressPopupDescription()\n\t\t{\n\t\t\treturn this.isEditMode\n\t\t\t\t? this.$Bitrix.Loc.getMessage('DATASET_IMPORT_PROGRESS_POPUP_DESCRIPTION_EDIT')\n\t\t\t\t: this.$Bitrix.Loc.getMessage('DATASET_IMPORT_PROGRESS_POPUP_DESCRIPTION');\n\t\t},\n\t\tloadFailurePopupTitle(): string\n\t\t{\n\t\t\treturn this.isEditMode\n\t\t\t\t? this.$Bitrix.Loc.getMessage('DATASET_IMPORT_FILE_ERROR_EDIT_TITLE')\n\t\t\t\t: this.$Bitrix.Loc.getMessage('DATASET_IMPORT_FILE_ERROR_TITLE')\n\t\t\t;\n\t\t},\n\t\tfieldsSettingsStepHint(): string\n\t\t{\n\t\t\tif (this.isEditMode)\n\t\t\t{\n\t\t\t\tif (this.isRestEntity)\n\t\t\t\t{\n\t\t\t\t\treturn this.$Bitrix.Loc.getMessage('DATASET_IMPORT_FIELDS_SETTINGS_HINT_EDIT');\n\t\t\t\t}\n\n\t\t\t\treturn '';\n\t\t\t}\n\n\t\t\tlet articleCode = '23508958';\n\t\t\tlet hintCode = 'DATASET_IMPORT_FIELDS_SETTINGS_HINT_EXTERNAL_MSGVER_1';\n\t\t\tif (this.isRestEntity)\n\t\t\t{\n\t\t\t\tarticleCode = '24486426';\n\t\t\t\thintCode = 'DATASET_IMPORT_FIELDS_SETTINGS_HINT_EXTERNAL_REST';\n\t\t\t}\n\n\t\t\treturn this.$Bitrix.Loc.getMessage(hintCode)\n\t\t\t\t.replace('[link]', '<a onclick=\"top.BX.Helper.show(`redirect=detail&code=' + articleCode + '`)\">')\n\t\t\t\t.replace('[/link]', '</a>')\n\t\t\t;\n\t\t},\n\t\tunsavedChangesPopupTitle(): string\n\t\t{\n\t\t\treturn this.isEditMode\n\t\t\t\t? this.$Bitrix.Loc.getMessage('DATASET_IMPORT_UNSAVED_CHANGES_TITLE_EDIT')\n\t\t\t\t: this.$Bitrix.Loc.getMessage('DATASET_IMPORT_UNSAVED_CHANGES_TITLE_EXTERNAL')\n\t\t\t;\n\t\t},\n\t\tunsavedChangesPopupText(): string\n\t\t{\n\t\t\treturn this.isEditMode\n\t\t\t\t? this.$Bitrix.Loc.getMessage('DATASET_IMPORT_UNSAVED_CHANGES_TEXT_EDIT')\n\t\t\t\t: this.$Bitrix.Loc.getMessage('DATASET_IMPORT_UNSAVED_CHANGES_TEXT_EXTERNAL')\n\t\t\t;\n\t\t},\n\t\temptyStateText(): string\n\t\t{\n\t\t\treturn this.previewDataLoaded\n\t\t\t\t? this.$Bitrix.Loc.getMessage('DATASET_IMPORT_PREVIEW_ERROR_EMPTY_TABLE')\n\t\t\t\t: this.$Bitrix.Loc.getMessage('DATASET_IMPORT_PREVIEW_EMPTY_STATE_EXTERNAL')\n\t\t\t;\n\t\t},\n\t\tsyncFieldsProps(): Object\n\t\t{\n\t\t\treturn {\n\t\t\t\tsupported: this.isEditMode,\n\t\t\t\tdisabled: this.isLoading,\n\t\t\t};\n\t\t},\n\t\tsourceType(): string\n\t\t{\n\t\t\treturn 'external';\n\t\t},\n\t},\n\tmounted()\n\t{\n\t\tif (\n\t\t\t!this.$store.getters.hasData\n\t\t\t&& this.$store.state.config.connectionProperties?.connectionId\n\t\t\t&& this.$store.state.config.connectionProperties?.tableName\n\t\t)\n\t\t{\n\t\t\tthis.loadDataset();\n\t\t}\n\n\t\tEventEmitter.subscribe('SidePanel.Slider:onMessage', this.onSliderEvent);\n\t},\n\tbeforeUnmount()\n\t{\n\t\tEventEmitter.subscribe('SidePanel.Slider:onMessage', this.onSliderEvent);\n\t},\n\tmethods: {\n\t\tonSliderEvent(event)\n\t\t{\n\t\t\tconst [messageEvent] = event.getData();\n\t\t\tif (messageEvent.getEventId() === 'BIConnector:ExternalConnection:onConnectionSave')\n\t\t\t{\n\t\t\t\tthis.onConnectionCreated();\n\t\t\t}\n\t\t\telse if (messageEvent.getEventId() === 'BIConnector:ExternalConnection:onConnectionCreationError')\n\t\t\t{\n\t\t\t\tthis.onConnectionCreationError();\n\t\t\t}\n\t\t},\n\t\tonConnectionCreated()\n\t\t{\n\t\t\tthis.sendAnalytics({\n\t\t\t\tevent: 'connection',\n\t\t\t\tstatus: 'success',\n\t\t\t});\n\t\t},\n\t\tonConnectionCreationError()\n\t\t{\n\t\t\tthis.sendAnalytics({\n\t\t\t\tevent: 'connection',\n\t\t\t\tstatus: 'error',\n\t\t\t});\n\t\t},\n\t\tonTableSelected()\n\t\t{\n\t\t\tthis.sendConnectionSelectorAnalytics();\n\t\t\tthis.markAsChanged();\n\t\t\tthis.loadDataset();\n\t\t\tthis.$refs.propertiesStep.showValidationErrors();\n\t\t},\n\t\tonTableDeselected()\n\t\t{\n\t\t\tthis.sendConnectionSelectorAnalytics();\n\t\t\tthis.$refs.propertiesStep.close();\n\t\t\tthis.$refs.fieldsStep.close();\n\t\t\tthis.toggleStepState('properties', true);\n\t\t\tthis.toggleStepState('fields', true);\n\t\t\tthis.$store.commit('setPreviewData', []);\n\t\t\tthis.$store.commit('setFieldsSettings', []);\n\t\t\tthis.$refs.propertiesStep.validate();\n\t\t\tthis.previewError = '';\n\t\t\tthis.previewDataLoaded = false;\n\t\t},\n\t\tsendConnectionSelectorAnalytics()\n\t\t{\n\t\t\tif (this.lastChangedStep !== 'connection' && !this.isEditMode)\n\t\t\t{\n\t\t\t\tthis.sendAnalytics({\n\t\t\t\t\tevent: 'creation_start',\n\t\t\t\t\tc_element: 'step_1',\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tthis.lastChangedStep = 'connection';\n\t\t},\n\t\tonDatasetPropertiesChanged()\n\t\t{\n\t\t\tthis.markAsChanged();\n\t\t\tif (this.lastChangedStep !== 'properties' && !this.isEditMode)\n\t\t\t{\n\t\t\t\tthis.sendAnalytics({\n\t\t\t\t\tevent: 'creation_start',\n\t\t\t\t\tc_element: 'step_2',\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tthis.lastChangedStep = 'properties';\n\t\t},\n\t\tonParsingOptionsChanged()\n\t\t{\n\t\t\tthis.markAsChanged();\n\t\t\tthis.loadDataset();\n\t\t},\n\t\tonFieldsChanged()\n\t\t{\n\t\t\tthis.markAsChanged();\n\t\t\tif (this.lastChangedStep !== 'fields' && !this.isEditMode)\n\t\t\t{\n\t\t\t\tthis.sendAnalytics({\n\t\t\t\t\tevent: 'creation_start',\n\t\t\t\t\tc_element: 'step_3',\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tthis.lastChangedStep = 'fields';\n\t\t},\n\t\tloadDataset()\n\t\t{\n\t\t\tthis.isLoading = true;\n\t\t\tAjax.runAction('biconnector.externalsource.dataset.view', {\n\t\t\t\tdata: {\n\t\t\t\t\ttype: this.sourceCode,\n\t\t\t\t\tfields: this.loadParams,\n\t\t\t\t\tsourceId: this.$store.state.config.connectionProperties.connectionId,\n\t\t\t\t},\n\t\t\t})\n\t\t\t\t.then((response) => {\n\t\t\t\t\tthis.isLoading = false;\n\t\t\t\t\tthis.onLoadSuccess(response);\n\t\t\t\t})\n\t\t\t\t.catch((response) => {\n\t\t\t\t\tthis.processLoadResponse(response);\n\t\t\t\t\tthis.isLoading = false;\n\t\t\t\t\tthis.previewError = response.errors[0]?.message ?? this.$Bitrix.Loc.getMessage('DATASET_IMPORT_PREVIEW_ERROR_EXTERNAL');\n\t\t\t\t});\n\t\t},\n\t\tonLoadSuccess(response)\n\t\t{\n\t\t\tthis.processLoadResponse(response);\n\n\t\t\tthis.$refs.propertiesStep.open();\n\t\t\tthis.$refs.fieldsStep.open();\n\t\t\tthis.toggleStepState('properties', false);\n\t\t\tif (this.isRestEntity)\n\t\t\t{\n\t\t\t\tthis.steps.fields.disabledElements = {\n\t\t\t\t\tname: true,\n\t\t\t\t\ttype: true,\n\t\t\t\t};\n\t\t\t}\n\t\t\tthis.toggleStepState('fields', false);\n\t\t\tthis.$refs.propertiesStep.validate();\n\t\t\tthis.$refs.fieldsStep.validate();\n\t\t},\n\t\tprocessLoadResponse(response)\n\t\t{\n\t\t\tconst responseData = response.data;\n\n\t\t\tif (!responseData)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.previewDataLoaded = true;\n\t\t\tif (this.lastChangedStep === 'connection')\n\t\t\t{\n\t\t\t\tconst headers = [];\n\t\t\t\tresponseData.headers.forEach((header, index) => {\n\t\t\t\t\theaders.push(this.prepareHeader(header, index));\n\t\t\t\t});\n\n\t\t\t\tthis.$store.commit('setFieldsSettings', headers);\n\t\t\t}\n\n\t\t\tthis.$store.commit('setPreviewData', responseData.data);\n\t\t},\n\t\tonSyncSuccess(response)\n\t\t{\n\t\t\tthis.processSyncResponse(response);\n\n\t\t\tthis.$refs.propertiesStep.open();\n\t\t\tthis.$refs.fieldsStep.open();\n\t\t\tthis.toggleStepState('properties', false);\n\t\t\tthis.toggleStepState('fields', false);\n\t\t\tthis.$refs.propertiesStep.validate();\n\t\t\tthis.$refs.fieldsStep.validate();\n\t\t},\n\t\tprocessSyncResponse(response)\n\t\t{\n\t\t\tconst responseData = response.data;\n\t\t\tif (responseData)\n\t\t\t{\n\t\t\t\tthis.previewDataLoaded = true;\n\t\t\t\tconst headers = [];\n\t\t\t\tresponseData.headers.forEach((header, index) => {\n\t\t\t\t\theaders.push(this.prepareHeader(header, index));\n\t\t\t\t});\n\n\t\t\t\tthis.$store.commit('setFieldsSettings', headers);\n\t\t\t\tthis.$store.commit('setPreviewData', responseData.data);\n\t\t\t}\n\n\t\t\tthis.sendAnalytics({\n\t\t\t\tevent: 'sync_fields',\n\t\t\t\tstatus: response.status,\n\t\t\t});\n\t\t},\n\t\tprepareHeader(header, index)\n\t\t{\n\t\t\tconst result = {\n\t\t\t\tvisible: header.visible,\n\t\t\t\ttype: header.type,\n\t\t\t\tname: header.name && header.name.length > 0 ? header.name : `FIELD_${index}`,\n\t\t\t\toriginalType: header.type,\n\t\t\t\toriginalName: header.externalCode,\n\t\t\t\texternalCode: header.externalCode,\n\t\t\t};\n\n\t\t\tif (header.id)\n\t\t\t{\n\t\t\t\tresult.id = header.id;\n\t\t\t}\n\n\t\t\treturn result;\n\t\t},\n\t\tonSaveStart(): Promise\n\t\t{\n\t\t\tif (!this.isValidatedForSave)\n\t\t\t{\n\t\t\t\tthis.$refs.fieldsStep.showValidationErrors();\n\t\t\t\tthis.$refs.propertiesStep.showValidationErrors();\n\n\t\t\t\treturn Promise.reject();\n\t\t\t}\n\n\t\t\tif (this.isEditMode && this.hasFieldsSettingsChanges())\n\t\t\t{\n\t\t\t\tthis.togglePopup('fieldsSettingsChanges', true);\n\n\t\t\t\treturn new Promise((resolve, reject) => {\n\t\t\t\t\tthis.pendingSavePromise = { resolve, reject };\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tthis.togglePopup('savingProgress', true);\n\n\t\t\treturn Promise.resolve();\n\t\t},\n\t\tonSaveEnd(response)\n\t\t{\n\t\t\tconst datasetName = response.data.name ?? this.$store.state.config.datasetProperties.name;\n\t\t\tconst datasetId = response.data.id ?? this.$store.state.config.datasetProperties.id;\n\t\t\tthis.popupParams.savingSuccess = {\n\t\t\t\ttitle: datasetName,\n\t\t\t\tdatasetId,\n\t\t\t\tlink: response.data.url,\n\t\t\t};\n\n\t\t\tthis.togglePopup('savingProgress', false);\n\t\t\tthis.togglePopup('savingSuccess', true);\n\t\t\tthis.isChanged = false;\n\t\t\tthis.sendAnalytics({\n\t\t\t\tevent: this.isEditMode ? 'dataset_editing' : 'creation_end',\n\t\t\t\tstatus: 'success',\n\t\t\t\tp1: `datasetName_${datasetName.replaceAll('_', '')}`,\n\t\t\t});\n\t\t\tBX.SidePanel.Instance.postMessage(window, 'BIConnector.dataset-import:onDatasetCreated', {});\n\t\t},\n\t\tonSaveError()\n\t\t{\n\t\t\tthis.togglePopup('savingProgress', false);\n\t\t\tthis.togglePopup('savingFailure', true);\n\t\t\tthis.sendAnalytics({\n\t\t\t\tevent: this.isEditMode ? 'dataset_editing' : 'creation_end',\n\t\t\t\tstatus: 'error',\n\t\t\t});\n\t\t\tBX.SidePanel.Instance.postMessage(window, 'BIConnector.dataset-import:onDatasetCreated', {});\n\t\t},\n\t\tonSuccessPopupClose()\n\t\t{\n\t\t\tthis.togglePopup('savingSuccess', false);\n\t\t\tthis.closeApp();\n\t\t},\n\t\tcloseFailurePopup()\n\t\t{\n\t\t\tthis.togglePopup('savingFailure', false);\n\t\t},\n\t\tonSyncFields()\n\t\t{\n\t\t\tthis.isLoading = true;\n\t\t\tAjax.runAction('biconnector.externalsource.dataset.syncField', {\n\t\t\t\tdata: {\n\t\t\t\t\tid: this.datasetId,\n\t\t\t\t},\n\t\t\t})\n\t\t\t\t.then((response) => {\n\t\t\t\t\tthis.isLoading = false;\n\t\t\t\t\tthis.onSyncSuccess(response);\n\t\t\t\t\tthis.popupParams.syncFields.isChange = response.data.isChanged;\n\t\t\t\t\tthis.togglePopup('syncFields', true);\n\t\t\t\t})\n\t\t\t\t.catch((response) => {\n\t\t\t\t\tthis.isLoading = false;\n\t\t\t\t\tthis.processSyncResponse(response);\n\t\t\t\t\tthis.previewError = response.errors[0]?.message ?? this.$Bitrix.Loc.getMessage('DATASET_IMPORT_PREVIEW_ERROR_EXTERNAL');\n\t\t\t\t});\n\t\t},\n\t\thasFieldsSettingsChanges(): boolean\n\t\t{\n\t\t\tconst fieldsToCompare = ['id', 'visible', 'type', 'name'];\n\n\t\t\tlet currentFields = toRaw(this.$store.state.config.fieldsSettings);\n\t\t\tlet initialFields = toRaw(this.initialFieldsSettings);\n\n\t\t\t// eslint-disable-next-line max-len\n\t\t\tcurrentFields = currentFields.map(obj => fieldsToCompare.reduce((result, field) => (Object.prototype.hasOwnProperty.call(obj, field) ? { ...result, [field]: obj[field] } : result), {}));\n\t\t\t// eslint-disable-next-line max-len\n\t\t\tinitialFields = initialFields.map(obj => fieldsToCompare.reduce((result, field) => (Object.prototype.hasOwnProperty.call(obj, field) ? { ...result, [field]: obj[field] } : result), {}));\n\n\t\t\treturn JSON.stringify(currentFields) !== JSON.stringify(initialFields);\n\t\t},\n\t\tonConfirmFieldsSettingsChangesPopup()\n\t\t{\n\t\t\tthis.togglePopup('fieldsSettingsChanges', false);\n\t\t\tthis.togglePopup('savingProgress', true);\n\n\t\t\tif (this.pendingSavePromise)\n\t\t\t{\n\t\t\t\tthis.pendingSavePromise.resolve();\n\t\t\t\tthis.pendingSavePromise = null;\n\t\t\t}\n\t\t},\n\t\tonCancelFieldsSettingsChangesPopup()\n\t\t{\n\t\t\tthis.togglePopup('fieldsSettingsChanges', false);\n\n\t\t\tif (this.pendingSavePromise)\n\t\t\t{\n\t\t\t\tthis.pendingSavePromise.reject();\n\t\t\t\tthis.pendingSavePromise = null;\n\t\t\t}\n\t\t},\n\t},\n\tcomponents: {\n\t\tAppLayout,\n\t\tImportConfig,\n\t\tImportPreview,\n\t\tConnectionStep,\n\t\tDatasetPropertiesStep,\n\t\tFieldsSettingsStep,\n\t\tImportProgressPopup,\n\t\tImportSuccessPopup,\n\t\tImportFailurePopup,\n\t\tSyncFieldsPopup,\n\t\tGenericPopup,\n\t},\n\t// language=Vue\n\ttemplate: `\n\t\t<AppLayout\n\t\t\tref=\"appLayout\"\n\t\t\t:save-locked=\"!isSaveEnabled\"\n\t\t\t:is-edit-mode=\"isEditMode\"\n\t\t>\n\t\t\t<template v-slot:left-panel>\n\t\t\t\t<ImportConfig>\n\t\t\t\t\t<ConnectionStep\n\t\t\t\t\t\t:disabled=\"steps.connection.disabled\"\n\t\t\t\t\t\t:connections=\"appParams.connections\"\n\t\t\t\t\t\tref=\"connectionsStep\"\n\t\t\t\t\t\t@table-selected=\"onTableSelected\"\n\t\t\t\t\t\t@table-deselected=\"onTableDeselected\"\n\t\t\t\t\t\t@validation=\"onStepValidation('connection', $event)\"\n\t\t\t\t\t/>\n\t\t\t\t\t<DatasetPropertiesStep\n\t\t\t\t\t\t:is-open-initially=\"isEditMode\"\n\t\t\t\t\t\t:disabled=\"steps.properties.disabled\"\n\t\t\t\t\t\t:reserved-names=\"appParams.reservedNames\"\n\t\t\t\t\t\t:name-max-length=230\n\t\t\t\t\t\tref=\"propertiesStep\"\n\t\t\t\t\t\t@validation=\"onStepValidation('properties', $event)\"\n\t\t\t\t\t\t@properties-changed=\"onDatasetPropertiesChanged\"\n\t\t\t\t\t\t:dataset-source-code=\"'external_' + sourceCode\"\n\t\t\t\t\t/>\n\t\t\t\t\t<FieldsSettingsStep\n\t\t\t\t\t\t:is-open-initially=\"isEditMode\"\n\t\t\t\t\t\t:disabled=\"steps.fields.disabled\"\n\t\t\t\t\t\t:disabled-elements=\"steps.fields.disabledElements\"\n\t\t\t\t\t\t:source-type=\"sourceType\"\n\t\t\t\t\t\tref=\"fieldsStep\"\n\t\t\t\t\t\t@validation=\"onStepValidation('fields', $event)\"\n\t\t\t\t\t\t@parsing-options-changed=\"onParsingOptionsChanged\"\n\t\t\t\t\t\t@settings-changed=\"onFieldsChanged\"\n\t\t\t\t\t\t:hint=\"fieldsSettingsStepHint\"\n\t\t\t\t\t\t:sync-fields-props=\"syncFieldsProps\"\n\t\t\t\t\t\t@sync-fields=\"onSyncFields\"\n\t\t\t\t\t/>\n\t\t\t\t</ImportConfig>\n\t\t\t</template>\n\t\t\t<template v-slot:right-panel>\n\t\t\t\t<ImportPreview \n\t\t\t\t\t:empty-state-text=\"emptyStateText\"\n\t\t\t\t\t:is-loading=\"isLoading\"\n\t\t\t\t\t:error=\"previewError\"\n\t\t\t\t\t:needShowHeadersWithEmptyRows=\"true\"\n\t\t\t\t/>\n\t\t\t</template>\n\t\t</AppLayout>\n\n\t\t<ImportProgressPopup\n\t\t\tv-if=\"shownPopups.savingProgress\"\n\t\t\t:description=\"importProgressPopupDescription\"\n\t\t/>\n\n\t\t<ImportSuccessPopup\n\t\t\tv-if=\"shownPopups.savingSuccess\"\n\t\t\t@close=\"onSuccessPopupClose\"\n\t\t\t@click=\"closeApp\"\n\t\t\t:title=\"importSuccessPopupTitle\"\n\t\t\t:description=\"''\"\n\t\t\t:dataset-id=\"popupParams.savingSuccess.datasetId\"\n\t\t\t:dataset-link=\"popupParams.savingSuccess.link\"\n\t\t\t:show-more-button=\"!isEditMode\"\n\t\t\t@one-more-click=\"reload\"\n\t\t/>\n\n\t\t<ImportFailurePopup\n\t\t\tv-if=\"shownPopups.savingFailure\"\n\t\t\t@close=\"closeFailurePopup\"\n\t\t\t@click=\"closeFailurePopup\"\n\t\t\t:title=\"importFailurePopupTitle\"\n\t\t\t:description=\"$Bitrix.Loc.getMessage('DATASET_IMPORT_EXTERNAL_FAILURE_POPUP_DESCRIPTION').replace('[link]', '<a>').replace('[/link]', '</a>')\"\n\t\t/>\n\n\t\t<GenericPopup\n\t\t\tv-if=\"shownPopups.loadFailure\"\n\t\t\t:title=\"loadFailurePopupTitle\"\n\t\t\t@close=\"togglePopup('loadFailure')\"\n\t\t>\n\t\t\t<template v-slot:content>\n\t\t\t\t<p v-for=\"message in popupParams.loadFailure.messages\">\n\t\t\t\t\t{{ message }}\n\t\t\t\t</p>\n\t\t\t</template>\n\t\t\t<template v-slot:buttons>\n\t\t\t\t<button @click=\"togglePopup('loadFailure')\" class=\"ui-btn ui-btn-md ui-btn-primary\">{{ $Bitrix.Loc.getMessage('DATASET_IMPORT_FILE_ERROR_POPUP_CLOSE') }}</button>\n\t\t\t</template>\n\t\t</GenericPopup>\n\n\t\t<SyncFieldsPopup\n\t\t\tv-if=\"shownPopups.syncFields\"\n\t\t\t:is-change=\"popupParams.syncFields.isChange\"\n\t\t\t@close=\"togglePopup('syncFields', false)\"\n\t\t>\n\t\t</SyncFieldsPopup>\n\n\t\t<GenericPopup\n\t\t\tv-if=\"shownPopups.fieldsSettingsChanges\"\n\t\t\t:title=\"$Bitrix.Loc.getMessage('DATASET_IMPORT_HAS_CHANGES_POPUP_HEADER')\"\n\t\t\t@close=\"togglePopup('fieldsSettingsChanges', false)\"\n\t\t>\n\t\t\t<template v-slot:content>\n\t\t\t\t<p>{{ $Bitrix.Loc.getMessage('DATASET_IMPORT_HAS_CHANGES_POPUP_MESSAGE_MSGVER_1') }}</p>\n\t\t\t</template>\n\t\t\t<template v-slot:buttons>\n\t\t\t\t<button @click=\"onConfirmFieldsSettingsChangesPopup\" class=\"ui-btn ui-btn-md ui-btn-success\">\n\t\t\t\t\t{{ $Bitrix.Loc.getMessage('DATASET_IMPORT_HAS_CHANGES_POPUP_BUTTON_SAVE') }}\n\t\t\t\t</button>\n\t\t\t\t<button @click=\"onCancelFieldsSettingsChangesPopup\" class=\"ui-btn ui-btn-md ui-btn-link\">\n\t\t\t\t\t{{ $Bitrix.Loc.getMessage('DATASET_IMPORT_HAS_CHANGES_POPUP_BUTTON_CANCEL') }}\n\t\t\t\t</button>\n\t\t\t</template>\n\t\t</GenericPopup>\n\t`,\n};\n","/* eslint-disable no-param-reassign */\nimport { createStore } from 'ui.vue3.vuex';\nimport type { AppStateOptions, ConnectionProperties } from '../types/app-state-options';\n\nexport class Store\n{\n\tstatic buildStore(defaultValues: AppStateOptions)\n\t{\n\t\treturn createStore({\n\t\t\tstate()\n\t\t\t{\n\t\t\t\treturn defaultValues;\n\t\t\t},\n\t\t\tmutations: {\n\t\t\t\tsetFileProperties(state, fileProperties)\n\t\t\t\t{\n\t\t\t\t\tstate.config.fileProperties = fileProperties;\n\t\t\t\t},\n\t\t\t\tsetConnectionProperties(state, connectionProperties)\n\t\t\t\t{\n\t\t\t\t\tstate.config.connectionProperties = connectionProperties;\n\t\t\t\t},\n\t\t\t\tsetDatasetProperties(state, datasetProperties)\n\t\t\t\t{\n\t\t\t\t\tstate.config.datasetProperties = datasetProperties;\n\t\t\t\t},\n\t\t\t\ttoggleRowVisibility(state, rowIndex)\n\t\t\t\t{\n\t\t\t\t\tstate.config.fieldsSettings[rowIndex].visible = !state.config.fieldsSettings[rowIndex].visible;\n\t\t\t\t},\n\t\t\t\tsetAllRowsVisible(state)\n\t\t\t\t{\n\t\t\t\t\tstate.config.fieldsSettings = state.config.fieldsSettings.map((field) => {\n\t\t\t\t\t\tfield.visible = true;\n\n\t\t\t\t\t\treturn field;\n\t\t\t\t\t});\n\t\t\t\t},\n\t\t\t\tsetAllRowsInvisible(state)\n\t\t\t\t{\n\t\t\t\t\tstate.config.fieldsSettings = state.config.fieldsSettings.map((field) => {\n\t\t\t\t\t\tfield.visible = false;\n\n\t\t\t\t\t\treturn field;\n\t\t\t\t\t});\n\t\t\t\t},\n\t\t\t\tsetFieldRowSettings(state, payload)\n\t\t\t\t{\n\t\t\t\t\tstate.config.fieldsSettings[payload.index] = payload.settings;\n\t\t\t\t},\n\t\t\t\tsetDataFormats(state, formats)\n\t\t\t\t{\n\t\t\t\t\tstate.config.dataFormats = formats;\n\t\t\t\t},\n\t\t\t\tsetPreviewData(state, data)\n\t\t\t\t{\n\t\t\t\t\tstate.previewData.rows = data;\n\t\t\t\t},\n\t\t\t\tsetFieldsSettings(state, settings)\n\t\t\t\t{\n\t\t\t\t\tstate.config.fieldsSettings = settings;\n\t\t\t\t},\n\t\t\t},\n\t\t\tgetters: {\n\t\t\t\tisEditMode(state)\n\t\t\t\t{\n\t\t\t\t\treturn state.config.datasetProperties.id > 0;\n\t\t\t\t},\n\t\t\t\tareAllRowsVisible(state)\n\t\t\t\t{\n\t\t\t\t\treturn state.config.fieldsSettings.filter((field) => !(field.visible)).length === 0;\n\t\t\t\t},\n\t\t\t\tareNoRowsVisible(state)\n\t\t\t\t{\n\t\t\t\t\treturn state.config.fieldsSettings.filter((field) => (field.visible)).length === 0;\n\t\t\t\t},\n\t\t\t\tareSomeRowsVisible(state, getters)\n\t\t\t\t{\n\t\t\t\t\treturn !getters.areAllRowsVisible && !getters.areNoRowsVisible;\n\t\t\t\t},\n\t\t\t\tcolumnVisibilityMap(state)\n\t\t\t\t{\n\t\t\t\t\tconst map = [];\n\t\t\t\t\tstate.config.fieldsSettings.forEach((field) => {\n\t\t\t\t\t\tmap.push(Boolean(field.visible));\n\t\t\t\t\t});\n\n\t\t\t\t\treturn map;\n\t\t\t\t},\n\t\t\t\tpreviewHeaders(state)\n\t\t\t\t{\n\t\t\t\t\treturn state.config.fieldsSettings.map((item) => item.name);\n\t\t\t\t},\n\t\t\t\thasData(state)\n\t\t\t\t{\n\t\t\t\t\treturn state.previewData?.rows?.length > 0;\n\t\t\t\t},\n\t\t\t\tconnectionProperties(state): ConnectionProperties\n\t\t\t\t{\n\t\t\t\t\treturn state.config?.connectionProperties;\n\t\t\t\t},\n\t\t\t\tdatasetProperties(state)\n\t\t\t\t{\n\t\t\t\t\treturn state.config?.datasetProperties;\n\t\t\t\t},\n\t\t\t},\n\t\t});\n\t}\n}\n","import { BitrixVue } from 'ui.vue3';\nimport type { AppStateOptions } from '../types/app-state-options';\nimport type { DataFormatTemplate } from '../types/data-types';\nimport { CsvApp } from './csv-app';\nimport { ExternalConnectionApp } from './external-connection-app';\nimport { Store } from './store';\n\nconst codeMap = {\n\tcsv: CsvApp,\n\t'1c': ExternalConnectionApp,\n\trest: ExternalConnectionApp,\n};\n\ntype AppParams = {\n\tdataFormatTemplates: DataFormatTemplate,\n\tencodings: Array,\n\tseparators: Array,\n\treservedNames: Array,\n\tconnections: Array,\n};\n\nexport class AppFactory\n{\n\tstatic getApp(code: string, stateOptions: AppStateOptions = {}, appParams: AppParams = {})\n\t{\n\t\tconst defaultStructure = {\n\t\t\tpreviewData: {},\n\t\t\tconfig: {\n\t\t\t\tfileProperties: {},\n\t\t\t\tdataFormats: {},\n\t\t\t\tdatasetProperties: {},\n\t\t\t\tfieldsSettings: [],\n\t\t\t},\n\t\t};\n\n\t\tconst state = BX.util.objectMerge(defaultStructure, stateOptions);\n\n\t\tlet app = null;\n\n\t\tconst appComponent = codeMap[code];\n\n\t\tif (appComponent)\n\t\t{\n\t\t\tapp = BitrixVue.createApp({\n\t\t\t\tname: 'DatasetImport',\n\t\t\t\tdata()\n\t\t\t\t{\n\t\t\t\t\treturn {\n\t\t\t\t\t\tappParams,\n\t\t\t\t\t};\n\t\t\t\t},\n\t\t\t\tcomponents: {\n\t\t\t\t\tappComponent,\n\t\t\t\t},\n\t\t\t\tcomputed: {\n\t\t\t\t\tcomponentName()\n\t\t\t\t\t{\n\t\t\t\t\t\treturn appComponent;\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\t// language=Vue\n\t\t\t\ttemplate: `\n\t\t\t\t\t<component :is=\"componentName\" :app-params=\"appParams\" />\n\t\t\t\t`,\n\t\t\t});\n\t\t}\n\n\t\tif (app)\n\t\t{\n\t\t\tconst store = Store.buildStore(state);\n\n\t\t\tapp.use(store);\n\t\t}\n\n\t\treturn app;\n\t}\n}\n","import { Uri } from 'main.core';\nimport { SidePanel } from 'ui.sidepanel';\n\nexport class Slider\n{\n\tstatic open(sourceId: string, datasetId: ?number = 0, connection: ?Object = {}): void\n\t{\n\t\tconst componentLink = '/bitrix/components/bitrix/biconnector.dataset.import/slider.php';\n\n\t\tconst sliderLink = new Uri(componentLink);\n\t\tsliderLink.setQueryParam('sourceId', sourceId);\n\t\tif (datasetId)\n\t\t{\n\t\t\tsliderLink.setQueryParam('datasetId', datasetId);\n\t\t}\n\n\t\tif (Object.keys(connection).length > 0)\n\t\t{\n\t\t\tsliderLink.setQueryParam('connection', connection);\n\t\t}\n\n\t\tconst options = {\n\t\t\tallowChangeHistory: false,\n\t\t\tcacheable: false,\n\t\t\tcustomLeftBoundary: 0,\n\t\t};\n\n\t\tSidePanel.Instance.open(\n\t\t\tsliderLink.toString(),\n\t\t\toptions,\n\t\t);\n\t}\n}\n"],"names":["AppLayout","props","saveLocked","type","Boolean","required","default","isEditMode","computed","saveButtonClass","saveButtonText","$Bitrix","Loc","getMessage","mounted","Dom","addClass","document","querySelector","buttonsPanel","$refs","$root","$el","parentNode","appendChild","BX","UI","Pinner","fixBottom","fullWidth","methods","onCreateButtonClick","eventEmitter","emit","onCancelButtonClick","template","ImportConfig","Popup","emits","id","String","options","Object","wrapperClass","data","popupInstance","popupOptions","content","autoHide","events","onPopupClose","closePopup","onPopupDestroy","fixed","PopupManager","getPopupById","destroy","$emit","MainPopup","show","beforeUnmount","FileErrorsPopup","errors","Array","isSavingMode","reportDownloadLink","width","closeIcon","noAllPaddings","overlay","title","length","hintContent","prepareHintContent","errorsCountText","replace","onClose","onIgnoreErrorsClick","onDownloadLogButtonClick","downloadLogButton","setState","ButtonState","WAITING","downloadLog","Ajax","runAction","fields","$store","state","config","then","response","blob","Blob","window","URL","createObjectURL","catch","link","createElement","href","download","datasetProperties","name","append","body","click","remove","phraseCode","message","Button","size","ButtonSize","EXTRA_SMALL","color","ButtonColor","LIGHT","noCaps","onclick","text","className","renderTo","summaryBlock","revokeObjectURL","components","CheckingProgressPopup","background","loader","Loader","target","strokeWidth","mode","CheckingSuccessPopup","CheckingFailedPopup","GenericPopup","SavingPopup","description","minHeight","ImportFailurePopup","onClick","SaveProgressPopup","ImportProgressPopup","ImportSuccessPopup","datasetId","Number","showMoreButton","onButtonClick","openDatasetButton","open","focus","removeClass","onOneMoreButtonClick","oneMoreButton","StepHint","hintClass","StepBlock","section","hint","isOpenInitially","canCollapse","disabled","customClasses","additionalClasses","custom","reduce","acc","key","toggleCollapse","toggle","contentContainer","Section","isOpen","watch","newValue","getContent","innerHTML","Text","encode","BaseStep","disabledElements","sourceType","displayedTitle","defaultTitle","displayedHint","defaultHint","sourceTypeCsv","sourceTypeExternal","stepBlock","close","validate","showValidationErrors","Step","ErrorPopup","create","element","Tag","render","bindElement","darkMode","bindOptions","position","angle","cacheable","setOptions","angleMinBottom","BaseField","defaultValue","placeholder","isValid","errorMessage","isDisabled","hintText","value","areValidationErrorsShown","onInputChange","fieldName","StringField","extends","errorPopup","errorPopupTimeout","onInput","event","onBlur","showErrorHint","setTimeout","hideErrorHint","clearTimeout","isDestroyed","createErrorPopup","errorIconWrapper","Hint","createNode","TextField","DatasetProperties","defaultName","defaultDescription","unvalidatedFields","disabledFields","datasetSourceCode","onValueChange","nameField","DatasetPropertiesStep","reservedNames","nameMaxLength","getters","result","nameValidationResult","validateName","onDatasetPropertiesFieldsChange","commit","keys","isReserved","includes","test","TableHeader","enabled","indeterminate","isNeedShowOriginalNameHint","fileProperties","firstLineHeader","onCheckboxClick","preventDefault","DataType","string","money","int","double","date","datetime","DataTypeDescriptions","icon","DataTypeMenu","constructor","selectedType","onSelect","getMenu","items","entries","forEach","push","html","item","getMenuWindow","Menu","DataTypeSelector","canEdit","typeMenu","isFocused","iconClass","typeTitle","isEditable","getPopupWindow","setWidth","formatButton","offsetWidth","createMenu","destroyMenu","TableRow","directives","index","fieldSettings","invalidFields","displayedValidationErrors","isNameValid","displayedErrorForName","set","Set","originalsHintText","originalType","originalName","typeText","nameText","connectionProperties","connectionType","hintOptions","offsetLeft","offsetTop","canEditType","canEditName","isNew","visible","onTypeSelected","onFieldInput","input","onFieldBlur","field","originalsHint","DataTypeButton","BIcon","FormatTable","fieldsSettings","unvalidatedRows","areAllRowsVisible","areNoRowsVisible","areSomeRowsVisible","onRowCheckboxClicked","onHeaderCheckboxClicked","onRowFieldChanged","rowIndices","row","SyncFieldsButton","FieldsSettingsStep","syncFieldsProps","supported","rows","isSyncSupported","isSyncDisabled","isNotEmpty","isTooLong","areCharactersValid","isAlreadyUsed","previewHeaders","count","onRowToggled","onHeaderToggled","settings","formatTable","OptionType","CUSTOM","VALUE","FormatSelector","openSlider","selected","dataFormatTemplates","SidePanel","Instance","contentCallback","Layout","createContent","extensions","buttons","cancelButton","SaveButton","form","getTopSlider","getContainer","formData","FormData","fromEntries","customFieldsToExtract","formRoot","subtitle","fieldType","selectRoot","isCustomSelected","customElement","customOptionInput","option","optionElement","isSelected","Event","bind","setAttribute","SliderButton","SwitcherField","Switcher","node","switcher","SwitcherSize","small","checked","handlers","toggled","CustomField","DropdownField","FileUploader","FileUploadWidget","defaultEncoding","defaultSeparator","defaultFirstLineHeader","encodings","separators","inputElement","uploaderOptions","controller","controllerOptions","multiple","acceptOnlyImages","maxFileSize","autoUpload","acceptedFileTypes","onUploadComplete","onFileRemoved","onError","onUploadError","widgetOptions","file","uploader","getFiles","isComplete","getServerFileId","getName","openDataFormatSlider","dataFormats","selectedFormats","FileStep","isErrorDisplayed","fileValidationResult","validateFile","onFilePropertiesChange","onParsingOptionsChanged","fileToken","fileUploader","AppSection","headers","columnVisibility","visibleHeaders","filter","_","visibleValues","PreviewTable","displayedColumnVisibility","debouncedRefresh","debounce","refreshColumns","ears","Ears","container","smallSize","noScrollbar","init","newVisibility","table","oldValue","ImportPreview","emptyStateText","error","isLoading","needShowHeadersWithEmptyRows","previewData","isEverythingHidden","hasData","hasHeaders","displayedEmptyStateText","displayedEverythingHiddenText","columnVisibilityMap","isErrorInEditMode","isEditModeInitialDataDisplayed","hasDataDisplayedHint","loadingAnchor","BaseApp","appParams","steps","shownPopups","isChanged","isSaveComplete","lastChangedStep","sourceCode","loadParams","saveParams","isSaveEnabled","isValidatedForSave","previewError","unsavedChangesPopupTitle","unsavedChangesPopupText","subscribe","onSaveButtonClick","slider","top","addCustomEvent","onSliderClose","addEventListener","removeCustomEvent","unsubscribe","markAsChanged","sendAnalytics","status","denyAction","continueButton","PRIMARY","popup","closeButton","LINK","closeApp","popupHeader","popupText","toggleStepState","step","Type","isNull","togglePopup","shown","loadDataset","onLoadSuccess","onLoadError","onStepValidation","validationResult","valid","onSaveStart","handleSaveAction","updateDataset","saveDataset","onSaveEnd","onSaveError","Promise","resolve","onLoadStart","reload","location","params","sendData","getBaseAnalyticsParams","tool","c_section","category","toUpperCase","CsvApp","properties","savingProgress","savingSuccess","savingFailure","editModeFileReplacement","checkFileProgress","checkFileSuccess","checkFileFailure","fileErrors","isValidationComplete","popupParams","lastReloadSource","initialPreviewData","initialFieldsSettings","isEditModeSaveConfirmed","isDataLoadingAnimationDisplayed","hasMinimalLoadingAnimationTimePassed","checkFileErrors","isErrorsChecked","exportDownloadLink","importFailurePopupTitle","importSuccessPopupTitle","importSuccessPopupDescription","fileName","importProgressPopupDescription","onDatasetPropertiesChanged","c_element","p1","replaceAll","onFieldsSettingsChanged","onDatasetReloadNeeded","reloadSource","startPreviewLoadingAnimation","propertiesStep","fieldsStep","toggleCheckFileButton","processLoadResponse","responseData","header","prepareHeader","externalCode","stopPreviewLoadingAnimation","fileStep","reject","checkFile","datasetName","postMessage","onSuccessPopupClose","closeFailurePopup","onReplacementButtonClick","onCheckFileClick","onExportFileClick","button","attr","FileExport","getInstance","saveIgnoringErrors","prepareCheckFileErrors","console","lineNumber","columnName","customData","EventEmitter","SyncFieldsPopup","isChange","getDescription","ConnectionSelectorField","connectionId","selector","TagSelector","selectorId","addButtonCaption","addButtonCaptionMore","dialogOptions","preparedItems","enableSearch","dropdownMode","showAvatars","compactView","height","tabs","stubOptions","arrow","iconOpacity","entities","onTagAdd","onTagRemove","getDialog","footer","allowChangeHistory","getTab","setFooter","messageEvent","getData","getEventId","onConnectionSave","selectorItems","itemOptions","ID","TITLE","entityId","linkTitle","TYPE","AVATAR","avatar","toString","connection","isStringFilled","dialog","getItem","setTitle","decode","removeTags","deselect","select","addItem","hide","TableSelectorField","selectedConnectionType","hasErrors","dynamicLoad","stub","dynamicSearch","onSearch","setLocked","hintCode","offset","newConnectionId","removeItems","getEntity","getTarget","tableTab","getStub","selectTab","setStub","ConnectionStep","connections","tableId","connectionSelectorId","tableSelectorId","connectionSelectorOptions","tableSelectorOptions","selectedConnectionAvatar","selectedConnectionId","find","parseFloat","selectedConnectionName","connectionName","selectedTableName","tableName","onConnectionSelected","tag","dialogItems","getItems","getId","getCustomData","sourceId","parseInt","get","onConnectionDeselected","onTableSelected","getTitle","code","externalName","onTableDeselected","openConnectionSlider","handleSliderMessage","ExternalConnectionApp","loadFailure","syncFields","fieldsSettingsChanges","messages","previewDataLoaded","pendingSavePromise","created","structuredClone","toRaw","isRestEntity","connectionSettings","loadFailurePopupTitle","fieldsSettingsStepHint","articleCode","onSliderEvent","onConnectionCreated","onConnectionCreationError","sendConnectionSelectorAnalytics","onFieldsChanged","onSyncSuccess","processSyncResponse","hasFieldsSettingsChanges","url","onSyncFields","fieldsToCompare","currentFields","initialFields","map","obj","prototype","hasOwnProperty","call","JSON","stringify","onConfirmFieldsSettingsChangesPopup","onCancelFieldsSettingsChangesPopup","Store","buildStore","defaultValues","createStore","mutations","setFileProperties","setConnectionProperties","setDatasetProperties","toggleRowVisibility","rowIndex","setAllRowsVisible","setAllRowsInvisible","setFieldRowSettings","payload","setDataFormats","formats","setPreviewData","setFieldsSettings","codeMap","csv","rest","AppFactory","getApp","stateOptions","defaultStructure","util","objectMerge","app","appComponent","BitrixVue","createApp","componentName","store","use","Slider","componentLink","sliderLink","Uri","setQueryParam","customLeftBoundary"],"mappings":"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"}