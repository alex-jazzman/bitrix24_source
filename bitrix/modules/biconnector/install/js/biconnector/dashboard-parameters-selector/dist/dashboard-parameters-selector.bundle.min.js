this.BX=this.BX||{},function(e,t,a,s){"use strict";var r;function i(e,t){var a="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!a){if(Array.isArray(e)||(a=function(e,t){if(!e)return;if("string"==typeof e)return l(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return l(e,t)}(e))||t&&e&&"number"==typeof e.length){a&&(e=a);var s=0,r=function(){};return{s:r,n:function(){return s>=e.length?{done:!0}:{done:!1,value:e[s++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,n=!0,o=!1;return{s:function(){a=a.call(e)},n:function(){var e=a.next();return n=e.done,e},e:function(e){o=!0,i=e},f:function(){try{n||null==a.return||a.return()}finally{if(o)throw i}}}}function l(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,s=new Array(t);a<t;a++)s[a]=e[a];return s}function n(e,t){c(e,t),t.add(e)}function o(e,t,a){c(e,t),t.set(e,a)}function c(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function d(e,t,a){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return a}var p=new WeakMap,b=new WeakMap,u=new WeakMap,v=new WeakMap,h=new WeakMap,g=new WeakMap,m=new WeakMap,f=new WeakMap,S=new WeakMap,P=new WeakMap,H=new WeakSet,w=new WeakSet,y=new WeakSet,A=new WeakSet,F=new WeakSet,D=new WeakSet,I=new WeakSet,G=new WeakSet,E=function(){function e(t){babelHelpers.classCallCheck(this,e),n(this,G),n(this,I),n(this,D),n(this,F),n(this,A),n(this,y),n(this,w),n(this,H),o(this,p,{writable:!0,value:void 0}),o(this,b,{writable:!0,value:void 0}),o(this,u,{writable:!0,value:void 0}),o(this,v,{writable:!0,value:void 0}),o(this,h,{writable:!0,value:void 0}),o(this,g,{writable:!0,value:void 0}),o(this,m,{writable:!0,value:void 0}),o(this,f,{writable:!0,value:void 0}),o(this,S,{writable:!0,value:void 0}),o(this,P,{writable:!0,value:void 0}),babelHelpers.classPrivateFieldSet(this,p,t.groups),babelHelpers.classPrivateFieldSet(this,b,new Set(t.groups)),babelHelpers.classPrivateFieldSet(this,u,t.scopes),babelHelpers.classPrivateFieldSet(this,v,new Set(t.scopes)),babelHelpers.classPrivateFieldSet(this,h,t.params),babelHelpers.classPrivateFieldSet(this,g,new Set(t.params)),babelHelpers.classPrivateFieldSet(this,m,t.scopeParamsMap)}return babelHelpers.createClass(e,[{key:"getValues",value:function(){return{groups:babelHelpers.classPrivateFieldGet(this,p),scopes:babelHelpers.classPrivateFieldGet(this,u),params:babelHelpers.classPrivateFieldGet(this,h)}}},{key:"getLayout",value:function(){var e=t.Loc.getMessage("DASHBOARD_PARAMS_SELECTOR_PARAMS_HINT_MSGVER_2",{"[link]":'<a class="ui-link" onclick="top.BX.Helper.show(`redirect=detail&code=22658454`)">',"[/link]":"</a>"}),a=t.Tag.render(r||(r=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<div class="dashboard-params-container">\n\t\t\t\t<div class="dashboard-params-title-container">\n\t\t\t\t\t<div class="dashboard-params-title">\n\t\t\t\t\t\t','\n\t\t\t\t\t\t<span data-hint="','"></span>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class="dashboard-params-groups-selector"></div>\n\n\t\t\t\t<div class="dashboard-params-title-container">\n\t\t\t\t\t<div class="dashboard-params-title">\n\t\t\t\t\t\t','\n\t\t\t\t\t\t<span data-hint="','"></span>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class="dashboard-params-scope-selector"></div>\n\n\t\t\t\t<div class="dashboard-params-title-container">\n\t\t\t\t\t<div>\n\t\t\t\t\t\t<div class="dashboard-params-title">\n\t\t\t\t\t\t\t',"\n\t\t\t\t\t\t\t<span data-hint-html data-hint-interactivity data-hint='",'\'></span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="dashboard-params-list-link">\n\t\t\t\t\t\t','\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class="dashboard-params-params-selector"></div>\n\t\t\t</div>\n\t\t'])),t.Loc.getMessage("DASHBOARD_PARAMS_SELECTOR_GROUPS"),t.Loc.getMessage("DASHBOARD_PARAMS_SELECTOR_GROUPS_HINT"),t.Loc.getMessage("DASHBOARD_PARAMS_SELECTOR_SCOPE"),t.Loc.getMessage("DASHBOARD_PARAMS_SELECTOR_SCOPE_HINT"),t.Loc.getMessage("DASHBOARD_PARAMS_SELECTOR_PARAMS"),e,t.Loc.getMessage("DASHBOARD_PARAMS_SELECTOR_PARAMS_LIST"));return BX.UI.Hint.init(a),d(this,H,C).call(this),babelHelpers.classPrivateFieldGet(this,f).renderTo(a.querySelector(".dashboard-params-groups-selector")),new s.TagSelector({locked:!0}).renderTo(a.querySelector(".dashboard-params-scope-selector")),new s.TagSelector({locked:!0}).renderTo(a.querySelector(".dashboard-params-params-selector")),t.Event.bind(a.querySelector(".dashboard-params-list-link"),"click",d(this,G,O).bind(this)),a}},{key:"selectGroups",value:function(e){var t,a=i(e);try{for(a.s();!(t=a.n()).done;){var s=t.value,r=babelHelpers.classPrivateFieldGet(this,f).getDialog().getItem({id:s,entityId:"biconnector-superset-group"});r&&r.select()}}catch(e){a.e(e)}finally{a.f()}}}]),e}();function C(){var e=this,a=[];babelHelpers.classPrivateFieldGet(this,p).forEach((function(e){a.push(["biconnector-superset-group",e])}));var r=new s.TagSelector({multiple:!0,dialogOptions:{id:"biconnector-superset-group",context:"biconnector-superset-group",enableSearch:!1,dropdownMode:!0,showAvatars:!0,compactView:!1,dynamicLoad:!0,preload:!0,width:383,height:419,entities:[{id:"biconnector-superset-group",dynamicLoad:!0,options:{}}],preselectedItems:a,events:{onLoad:function(){d(e,w,M).call(e)},"Item:onSelect":function(t){var a,s=t.getData().item;babelHelpers.classPrivateFieldGet(e,p).add(s.getId());var r,l=i(null!==(a=s.getCustomData().get("groupScopes"))&&void 0!==a?a:[]);try{for(l.s();!(r=l.n()).done;){var n=r.value,o=babelHelpers.classPrivateFieldGet(e,S).getDialog().getItem({id:n,entityId:"biconnector-superset-scope"});o.setDeselectable(!1),o.select();var c=babelHelpers.classPrivateFieldGet(e,S).getTag({id:n,entityId:"biconnector-superset-scope"});c.setDeselectable(!1),c.render()}}catch(e){l.e(e)}finally{l.f()}d(e,I,L).call(e)},"Item:onDeselect":function(t){var a,s=t.getData().item;babelHelpers.classPrivateFieldGet(e,p).delete(s.getId());var r,l=i(null!==(a=s.getCustomData().get("groupScopes"))&&void 0!==a?a:[]);try{for(l.s();!(r=l.n()).done;){var n=r.value,o=babelHelpers.classPrivateFieldGet(e,S).getDialog().getItem({id:n,entityId:"biconnector-superset-scope"});o.setDeselectable(!0),o.deselect()}}catch(e){l.e(e)}finally{l.f()}d(e,I,L).call(e)}}}});t.Dom.addClass(r.getDialog().getContainer(),"biconnector-settings-entity-selector"),babelHelpers.classPrivateFieldSet(this,f,r)}function M(){var e,a=this,r=babelHelpers.classPrivateFieldGet(this,f).getDialog().getSelectedItems(),l=new Set,n=i(r);try{for(n.s();!(e=n.n()).done;){var o,c,p=i(null!==(o=e.value.getCustomData().get("groupScopes"))&&void 0!==o?o:[]);try{for(p.s();!(c=p.n()).done;){var b=c.value;l.add(b)}}catch(e){p.e(e)}finally{p.f()}}}catch(e){n.e(e)}finally{n.f()}var v=[],h=[],g=!1;babelHelpers.classPrivateFieldGet(this,u).forEach((function(e){e.startsWith("automated_solution_")&&(g=!0),l.has(e)&&h.push(["biconnector-superset-scope",e]),v.push(["biconnector-superset-scope",e])}));var m=new s.TagSelector({multiple:!0,dialogOptions:{id:"biconnector-superset-scope",context:"biconnector-superset-scope",enableSearch:!1,dropdownMode:!0,showAvatars:!1,compactView:!0,dynamicLoad:!0,preload:!0,width:383,height:419,entities:[{id:"biconnector-superset-scope",dynamicLoad:!0,options:{}}],preselectedItems:v,undeselectedItems:h,events:{onLoad:function(e){if(g){var t,s,r,i,l=null===(s=(null===(t=e.getTarget())||void 0===t?void 0:t.getItems()).find((function(e){return"automated_solution"===e.getId()})).getNodes())||void 0===s||null===(r=s.values())||void 0===r||null===(i=r.next())||void 0===i?void 0:i.value;null==l||l.setOpen(!0)}d(a,y,T).call(a)},"Item:onSelect":function(e){var t=e.getData().item;d(a,A,R).call(a,t)}}},events:{onBeforeTagAdd:function(e){var t=e.getData().tag;babelHelpers.classPrivateFieldGet(a,u).add(t.getId()),d(a,I,L).call(a)},onBeforeTagRemove:function(e){var t=e.getData().tag;babelHelpers.classPrivateFieldGet(a,u).delete(t.getId()),d(a,I,L).call(a)},onAfterTagRemove:function(e){var t=e.getData().tag;d(a,F,_).call(a,t.getId())}}});t.Dom.addClass(m.getDialog().getContainer(),"biconnector-settings-entity-selector"),t.Dom.clean(document.querySelector(".dashboard-params-scope-selector")),m.renderTo(document.querySelector(".dashboard-params-scope-selector")),babelHelpers.classPrivateFieldSet(this,S,m)}function T(){var e=this,r=[];babelHelpers.classPrivateFieldGet(this,u).forEach((function(t){var a;(null!==(a=babelHelpers.classPrivateFieldGet(e,m)[t])&&void 0!==a?a:[]).forEach((function(t){var a=d(e,D,k).call(e,t.code);r.push({id:t.code,entityId:"biconnector-superset-params",title:a.title,supertitle:a.supertitle,tabs:"params",textColor:"#535C69"})}))})),babelHelpers.classPrivateFieldGet(this,m).global.forEach((function(t){var a=d(e,D,k).call(e,t.code);r.push({id:t.code,entityId:"biconnector-superset-params",title:a.title,supertitle:a.supertitle,tabs:"params"})}));var i=[],l=[];babelHelpers.classPrivateFieldGet(this,h).forEach((function(t){i.push(["biconnector-superset-params",t]);var a=d(e,D,k).call(e,t);l.push({id:t,entityId:"biconnector-superset-params",title:a.title,supertitle:a.supertitle})}));var n=new s.TagSelector({id:"biconnector-superset-params",multiple:!0,items:l,dialogOptions:{id:"biconnector-superset-params",context:"biconnector-superset-params",enableSearch:!1,dropdownMode:!0,showAvatars:!1,compactView:!1,dynamicLoad:!0,items:r,preselectedItems:i,width:383,height:419,entities:[{id:"biconnector-superset-params"}],tabs:[{id:"params",title:"params"}]},events:{onBeforeTagAdd:function(t){var a=t.getData().tag;babelHelpers.classPrivateFieldGet(e,h).add(a.getId()),d(e,I,L).call(e)},onBeforeTagRemove:function(t){var a=t.getData().tag;babelHelpers.classPrivateFieldGet(e,h).delete(a.getId()),d(e,I,L).call(e)}}});t.Dom.addClass(n.getDialog().getContainer(),"biconnector-settings-entity-selector"),t.Dom.clean(document.querySelector(".dashboard-params-params-selector")),n.renderTo(document.querySelector(".dashboard-params-params-selector")),babelHelpers.classPrivateFieldSet(this,P,n),a.EventEmitter.emit("BIConnector.DashboardParamsSelector:initCompleted")}function R(e){var t,a=this;(null!==(t=babelHelpers.classPrivateFieldGet(this,m)[e.getId()])&&void 0!==t?t:[]).forEach((function(e){var t=babelHelpers.classPrivateFieldGet(a,P).getDialog().getItem(["biconnector-superset-params",e.code]);t?t.select(!0):babelHelpers.classPrivateFieldGet(a,P).getDialog().addItem({id:e.code,title:e.title,entityId:"biconnector-superset-params",supertitle:d(a,D,k).call(a,e.code).supertitle,tabs:"params",selected:!0})}))}function _(e){var t,a=this,s=null!==(t=babelHelpers.classPrivateFieldGet(this,m)[e])&&void 0!==t?t:[],r=babelHelpers.classPrivateFieldGet(this,P).getDialog().getItems();s.forEach((function(e){r.forEach((function(t){t.getId()===e.code&&(t.deselect(),babelHelpers.classPrivateFieldGet(a,P).getDialog().removeItem(t))}))}))}function k(e){var a=this,s=e,r=new Set;babelHelpers.classPrivateFieldGet(this,m).global.forEach((function(t){e===t.code&&(s=t.title,r.add("global"))})),Object.keys(babelHelpers.classPrivateFieldGet(this,m)).forEach((function(t){var i;(null!==(i=babelHelpers.classPrivateFieldGet(a,m)[t])&&void 0!==i?i:[]).forEach((function(a){e===a.code&&(s=a.title,r.has("global")||r.add(t))}))}));var i=[];return babelHelpers.classPrivateFieldGet(this,S).getDialog().getItems().forEach((function(e){r.has(e.getId())&&i.push(e.getTitle())})),r.has("global")&&i.push(t.Loc.getMessage("DASHBOARD_PARAMS_SELECTOR_PARAMS_GLOBAL")),{title:s,supertitle:i.join(", ")}}function L(){var e=this,t=babelHelpers.classPrivateFieldGet(this,p).size!==babelHelpers.classPrivateFieldGet(this,b).size||babelHelpers.toConsumableArray(babelHelpers.classPrivateFieldGet(this,p)).some((function(t){return!babelHelpers.classPrivateFieldGet(e,b).has(t)})),s=babelHelpers.classPrivateFieldGet(this,u).size!==babelHelpers.classPrivateFieldGet(this,v).size||babelHelpers.toConsumableArray(babelHelpers.classPrivateFieldGet(this,u)).some((function(t){return!babelHelpers.classPrivateFieldGet(e,v).has(t)})),r=babelHelpers.classPrivateFieldGet(this,h).size!==babelHelpers.classPrivateFieldGet(this,g).size||babelHelpers.toConsumableArray(babelHelpers.classPrivateFieldGet(this,h)).some((function(t){return!babelHelpers.classPrivateFieldGet(e,g).has(t)})),i=s||r||t;a.EventEmitter.emit("BIConnector.DashboardParamsSelector:onChange",{isChanged:i})}function O(){var e=new t.Uri("/bitrix/components/bitrix/biconnector.apachesuperset.dashboard.url.parameter.list/slider.php");BX.SidePanel.Instance.open(e.toString(),{width:600,allowChangeHistory:!1})}e.DashboardParametersSelector=E}(this.BX.BIConnector=this.BX.BIConnector||{},BX,BX.Event,BX.UI.EntitySelector);
//# sourceMappingURL=dashboard-parameters-selector.bundle.map.js