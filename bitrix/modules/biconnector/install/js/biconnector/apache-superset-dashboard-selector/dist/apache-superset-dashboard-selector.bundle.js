this.BX=this.BX||{},function(e,t,a,i,s){"use strict";function r(e,t){l(e,t),t.add(e)}function n(e,t,a){l(e,t),t.set(e,a)}function l(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function o(e,t,a){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return a}var d=new WeakMap,c=new WeakMap,h=new WeakMap,b=new WeakMap,u=new WeakMap,v=new WeakMap,p=new WeakMap,m=new WeakSet,w=new WeakSet,S=new WeakSet,f=new WeakSet,P=new WeakSet,H=new WeakSet,B=new WeakSet;function F(e){return babelHelpers.classPrivateFieldGet(this,d)||babelHelpers.classPrivateFieldSet(this,d,new s.Dialog({id:"biconnector-superset-dashboard",multiple:!1,targetNode:e,offsetTop:14,context:"biconnector-superset-dashboard",entities:[{id:"biconnector-superset-dashboard",dynamicLoad:!0,dynamicSearch:!0}],enableSearch:!0,dropdownMode:!0,showAvatars:!0,compactView:!1,dynamicLoad:!0,clearUnavailableItems:!0,preselectedItems:[["biconnector-superset-dashboard",babelHelpers.classPrivateFieldGet(this,b)]],events:{"Item:onSelect":o(this,w,k).bind(this)}})),babelHelpers.classPrivateFieldGet(this,d)}function k(e){var t=this;i.EventEmitter.emit("BiConnector:DashboardSelector.onSelect");var s=e.data.item;return o(this,H,g).call(this,s.getTitle()),o(this,S,I).call(this,s).then((function(){return o(t,f,E).call(t,s.id)})).then((function(e){return e.data.dashboard&&(o(t,H,g).call(t,e.data.dashboard.title),i.EventEmitter.emit("BiConnector:DashboardSelector.onSelectDataLoaded",{item:s,dashboardId:s.id,credentials:e.data.dashboard})),e})).catch((function(e){var t;throw e.errors&&a.Type.isStringFilled(null===(t=e.errors[0])||void 0===t?void 0:t.message)&&BX.UI.Notification.Center.notify({content:a.Text.encode(e.errors[0].message)}),e}))}function I(e){return new Promise((function(a,i){"N"!==e.getCustomData().get("status")?a():t.DashboardManager.installDashboard(e.id).then((function(e){return a(e)})).catch((function(e){return i(e)}))}))}function E(e){return BX.ajax.runAction("biconnector.dashboard.getDashboardEmbeddedData",{data:{id:e,urlParams:babelHelpers.classPrivateFieldGet(this,p)}})}function C(){babelHelpers.classPrivateFieldGet(this,d).show()}function g(e){var t=a.Text.encode(e);babelHelpers.classPrivateFieldGet(this,h).innerHTML=t,babelHelpers.classPrivateFieldGet(this,h).title=t,document.title=t}function D(e){var t=this,a=e.data.dashboard;return new Promise((function(e){o(t,H,g).call(t,a.title),babelHelpers.classPrivateFieldSet(t,d,null),babelHelpers.classPrivateFieldSet(t,b,a.id),o(t,m,F).call(t,babelHelpers.classPrivateFieldGet(t,c)),i.EventEmitter.emit("BiConnector:DashboardSelector.onSelectDataLoaded",{item:a,dashboardId:a.id,credentials:a}),e()}))}a.Reflection.namespace("BX.BIConnector").SupersetDashboardSelector=function e(t){babelHelpers.classCallCheck(this,e),r(this,B),r(this,H),r(this,P),r(this,f),r(this,S),r(this,w),r(this,m),n(this,d,{writable:!0,value:void 0}),n(this,c,{writable:!0,value:void 0}),n(this,h,{writable:!0,value:void 0}),n(this,b,{writable:!0,value:void 0}),n(this,u,{writable:!0,value:void 0}),n(this,v,{writable:!0,value:void 0}),n(this,p,{writable:!0,value:void 0}),babelHelpers.classPrivateFieldSet(this,c,document.getElementById(t.containerId)),babelHelpers.classPrivateFieldSet(this,h,document.getElementById(t.textNodeId)),babelHelpers.classPrivateFieldSet(this,b,t.dashboardId),babelHelpers.classPrivateFieldSet(this,u,t.marketCollectionUrl),babelHelpers.classPrivateFieldSet(this,v,t.isMarketInstalled),babelHelpers.classPrivateFieldSet(this,p,t.dashboardUrlParams),o(this,m,F).call(this,babelHelpers.classPrivateFieldGet(this,c)),babelHelpers.classPrivateFieldGet(this,c)&&(a.Event.bind(babelHelpers.classPrivateFieldGet(this,c),"click",o(this,P,C).bind(this)),i.EventEmitter.subscribe("BIConnector.DashboardManager:onCopyDashboard",o(this,B,D).bind(this)))}}(this.BX.BIConnector=this.BX.BIConnector||{},BX.BIConnector,BX,BX.Event,BX.UI.EntitySelector);
