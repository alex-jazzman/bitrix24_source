{"version":3,"file":"conference.bundle.js","sources":["../src/utils/restclient.js","../src/controller.js"],"sourcesContent":["import { RestClient } from \"rest.client\";\nimport { Utils } from \"im.lib.utils\";\n\nconst RestAuth = Object.freeze({\n\tguest: 'guest',\n});\n\nexport class CallRestClient\n{\n\tconstructor(params)\n\t{\n\t\tthis.queryAuthRestore = false;\n\n\t\tthis.setAuthId(RestAuth.guest);\n\n\t\tthis.restClient = new RestClient({\n\t\t\tendpoint: params.endpoint,\n\t\t\tqueryParams: this.queryParams,\n\t\t\tcors: true\n\t\t});\n\t}\n\n\tsetAuthId(authId, customAuthId = '')\n\t{\n\t\tif (typeof this.queryParams !== 'object')\n\t\t{\n\t\t\tthis.queryParams = {};\n\t\t}\n\n\t\tif (\n\t\t\tauthId == RestAuth.guest\n\t\t\t|| typeof authId === 'string' && authId.match(/^[a-f0-9]{32}$/)\n\t\t)\n\t\t{\n\t\t\tthis.queryParams.call_auth_id = authId;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tconsole.error(`%CallRestClient.setAuthId: auth is not correct (%c${authId}%c)`, \"color: black;\", \"font-weight: bold; color: red\", \"color: black\");\n\t\t\treturn false;\n\t\t}\n\n\t\tif (\n\t\t\tauthId == RestAuth.guest\n\t\t\t&& typeof customAuthId === 'string' && customAuthId.match(/^[a-f0-9]{32}$/)\n\t\t)\n\t\t{\n\t\t\tthis.queryParams.call_custom_auth_id = customAuthId;\n\t\t}\n\n\t\treturn true;\n\t}\n\n\tsetChatId(chatId)\n\t{\n\t\tif (typeof this.queryParams !== 'object')\n\t\t{\n\t\t\tthis.queryParams = {};\n\t\t}\n\n\t\tthis.queryParams.call_chat_id = chatId;\n\t}\n\n\tsetConfId(alias)\n\t{\n\t\tif (typeof this.queryParams !== 'object')\n\t\t{\n\t\t\tthis.queryParams = {};\n\t\t}\n\n\t\tthis.queryParams.videoconf_id = alias;\n\t}\n\n\tsetPassword(password)\n\t{\n\t\tif (typeof this.queryParams !== 'object')\n\t\t{\n\t\t\tthis.queryParams = {};\n\t\t}\n\n\t\tthis.queryParams.videoconf_password = password;\n\t}\n\n\tcallMethod(method, params, callback, sendCallback, logTag = null)\n\t{\n\t\tif (!logTag)\n\t\t{\n\t\t\tlogTag = Utils.getLogTrackingParams({\n\t\t\t\tname: method,\n\t\t\t});\n\t\t}\n\n\t\tconst promise = new BX.Promise();\n\n\t\t// TODO: Callbacks methods will not work!\n\t\tthis.restClient.callMethod(method, params, null, sendCallback, logTag).then(result => {\n\n\t\t\tthis.queryAuthRestore = false;\n\t\t\tpromise.fulfill(result);\n\n\t\t}).catch(result => {\n\n\t\t\tlet error = result.error();\n\t\t\tif (error.ex.error == 'LIVECHAT_AUTH_WIDGET_USER')\n\t\t\t{\n\t\t\t\tthis.setAuthId(error.ex.hash);\n\n\t\t\t\tif (method === RestMethod.widgetUserRegister)\n\t\t\t\t{\n\t\t\t\t\tconsole.warn(`BX.LiveChatRestClient: ${error.ex.error_description} (${error.ex.error})`);\n\n\t\t\t\t\tthis.queryAuthRestore = false;\n\t\t\t\t\tpromise.reject(result);\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tif (!this.queryAuthRestore)\n\t\t\t\t{\n\t\t\t\t\tconsole.warn('BX.LiveChatRestClient: your auth-token has expired, send query with a new token');\n\n\t\t\t\t\tthis.queryAuthRestore = true;\n\t\t\t\t\tthis.restClient.callMethod(method, params, null, sendCallback, logTag).then(result => {\n\t\t\t\t\t\tthis.queryAuthRestore = false;\n\t\t\t\t\t\tpromise.fulfill(result);\n\t\t\t\t\t}).catch(result => {\n\t\t\t\t\t\tthis.queryAuthRestore = false;\n\t\t\t\t\t\tpromise.reject(result);\n\t\t\t\t\t});\n\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.queryAuthRestore = false;\n\t\t\tpromise.reject(result);\n\t\t});\n\n\t\treturn promise;\n\t};\n\n\tcallBatch(calls, callback, bHaltOnError, sendCallback, logTag)\n\t{\n\t\tlet resultCallback = (result) => {\n\t\t\tlet error = null;\n\t\t\tfor (let method in calls)\n\t\t\t{\n\t\t\t\tif (!calls.hasOwnProperty(method))\n\t\t\t\t{\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tlet error = result[method].error();\n\t\t\t\tif (error && error.ex.error == 'LIVECHAT_AUTH_WIDGET_USER')\n\t\t\t\t{\n\t\t\t\t\tthis.setAuthId(error.ex.hash);\n\t\t\t\t\tif (method === RestMethod.widgetUserRegister)\n\t\t\t\t\t{\n\t\t\t\t\t\tconsole.warn(`BX.LiveChatRestClient: ${error.ex.error_description} (${error.ex.error})`);\n\n\t\t\t\t\t\tthis.queryAuthRestore = false;\n\t\t\t\t\t\tcallback(result);\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (!this.queryAuthRestore)\n\t\t\t\t\t{\n\t\t\t\t\t\tconsole.warn('BX.LiveChatRestClient: your auth-token has expired, send query with a new token');\n\n\t\t\t\t\t\tthis.queryAuthRestore = true;\n\t\t\t\t\t\tthis.restClient.callBatch(calls, callback, bHaltOnError, sendCallback, logTag);\n\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.queryAuthRestore = false;\n\t\t\tcallback(result);\n\n\t\t\treturn true;\n\t\t};\n\n\t\treturn this.restClient.callBatch(calls, resultCallback, bHaltOnError, sendCallback, logTag);\n\t};\n}","/**\n * Bitrix Im\n * Conference application\n *\n * @package bitrix\n * @subpackage mobile\n * @copyright 2001-2021 Bitrix\n */\n\n// call\nimport * as Call from 'call.core';\nimport { Analytics } from 'call.lib.analytics';\nimport './css/view.css';\n\n// im\nimport 'im.debug';\nimport 'im.application.launch';\nimport 'im.component.conference.conference-public';\nimport {DesktopApi} from 'im.v2.lib.desktop-api';\nimport { ConferenceModel, CallModel } from \"im.model\";\nimport { Controller } from 'im.controller';\nimport { Utils } from \"im.lib.utils\";\nimport { Cookie } from \"im.lib.cookie\";\nimport { LocalStorage } from \"im.lib.localstorage\";\nimport { Logger } from \"im.lib.logger\";\nimport { Clipboard } from 'im.lib.clipboard';\nimport { Desktop } from \"im.lib.desktop\";\nimport {\n\tEventType,\n\tConferenceErrorCode,\n\tConferenceRightPanelMode as RightPanelMode\n} from \"im.const\";\n\n//ui\nimport {Notifier, NotificationOptions} from 'ui.notification-manager';\nimport 'ui.notification';\nimport 'ui.buttons';\nimport 'ui.progressround';\nimport 'ui.viewer';\nimport { VueVendorV2 } from \"ui.vue\";\nimport { VuexBuilder } from \"ui.vue.vuex\";\n\n// core\nimport { Loc, Tag, Dom, Text } from \"main.core\";\nimport \"promise\";\nimport 'main.date';\nimport {BaseEvent, EventEmitter} from 'main.core.events';\n\n// pull and rest\nimport { PullClient } from \"pull.client\";\nimport { ImCallPullHandler } from \"im.provider.pull\";\nimport { CallRestClient } from \"./utils/restclient\"\n\nclass ConferenceApplication\n{\n\t/* region 01. Initialize */\n\tconstructor(params = {})\n\t{\n\t\tthis.inited = false;\n\t\tthis.hardwareInited = false;\n\t\tthis.dialogInited = false;\n\t\tthis.initPromise = new BX.Promise;\n\n\t\tthis.params = params;\n\t\tthis.params.userId = this.params.userId? parseInt(this.params.userId): 0;\n\t\tthis.params.siteId = this.params.siteId || '';\n\t\tthis.params.chatId = this.params.chatId? parseInt(this.params.chatId): 0;\n\t\tthis.params.dialogId = this.params.chatId? 'chat'+this.params.chatId.toString(): '0';\n\t\tthis.params.passwordRequired = !!this.params.passwordRequired;\n\t\tthis.params.isBroadcast = !!this.params.isBroadcast;\n\n\t\tBX.Messenger.Lib.Logger.setConfig(params.loggerConfig);\n\n\t\tthis.messagesQueue = [];\n\n\t\tthis.template = null;\n\t\tthis.rootNode = this.params.node || document.createElement('div');\n\n\t\tthis.event = new VueVendorV2;\n\t\tthis.callContainer = null;\n\t\t// this.callView = null;\n\t\tthis.preCall = null;\n\t\tthis.currentCall = null;\n\t\tthis.videoStrategy = null;\n\t\tthis.callDetails = {};\n\t\tthis.showFeedback = true;\n\n\t\tthis.featureConfig = {};\n\t\t(params.featureConfig || []).forEach(limit => {\n\t\t\tthis.featureConfig[limit.id] = limit;\n\t\t});\n\n\t\tthis.localVideoStream = null;\n\n\t\t// save reconnect camera\n\t\tthis.lastUsedCameraId = null;\n\t\tthis.reconnectingCameraId = null;\n\n\t\tthis.conferencePageTagInterval = null;\n\n\t\tthis.onCallUserInvitedHandler = this.onCallUserInvited.bind(this);\n\t\tthis.onCallUserStateChangedHandler = this.onCallUserStateChanged.bind(this);\n\t\tthis.onCallUserMicrophoneStateHandler = this.onCallUserMicrophoneState.bind(this);\n\t\tthis.onCallUserCameraStateHandler = this.onCallUserCameraState.bind(this);\n\t\tthis.onNeedResetMediaDevicesStateHandler = this.onNeedResetMediaDevicesState.bind(this);\n\t\tthis.onCallUserVideoPausedHandler = this.onCallUserVideoPaused.bind(this);\n\t\tthis.onCallLocalMediaReceivedHandler = BX.debounce(this.onCallLocalMediaReceived.bind(this), 1000);\n\t\tthis.onCallRemoteMediaReceivedHandler = this.onCallRemoteMediaReceived.bind(this);\n\t\tthis.onCallRemoteMediaStoppedHandler = this.onCallRemoteMediaStopped.bind(this);\n\t\tthis.onCallUserVoiceStartedHandler = this.onCallUserVoiceStarted.bind(this);\n\t\tthis.onCallUserVoiceStoppedHandler = this.onCallUserVoiceStopped.bind(this);\n\t\tthis.onUserStatsReceivedHandler = this.onUserStatsReceived.bind(this);\n\t\tthis.onCallUserScreenStateHandler = this.onCallUserScreenState.bind(this);\n\t\tthis.onCallUserRecordStateHandler = this.onCallUserRecordState.bind(this);\n\t\tthis.onCallUserFloorRequestHandler = this.onCallUserFloorRequest.bind(this);\n\t\tthis.onMicrophoneLevelHandler = this.onMicrophoneLevel.bind(this);\n\t\tthis._onCallJoinHandler = this.onCallJoin.bind(this);\n\t\tthis.onCallFailureHandler = this.onCallFailure.bind(this);\n\t\tthis.onCallLeaveHandler = this.onCallLeave.bind(this);\n\t\tthis.onCallDestroyHandler = this.onCallDestroy.bind(this);\n\t\tthis.onInputFocusHandler = this.onInputFocus.bind(this);\n\t\tthis.onInputBlurHandler = this.onInputBlur.bind(this);\n\t\tthis.onReconnectingHandler = this.onReconnecting.bind(this);\n\t\tthis.onReconnectedHandler = this.onReconnected.bind(this);\n\t\tthis.onUpdateLastUsedCameraIdHandler = this.onUpdateLastUsedCameraId.bind(this);\n\t\tthis.onCallConnectionQualityChangedHandler = this.onCallConnectionQualityChanged.bind(this);\n\t\tthis.onCallToggleRemoteParticipantVideoHandler = this.onCallToggleRemoteParticipantVideo.bind(this);\n\t\tthis._onGetUserMediaEndedHandler = this.onGetUserMediaEnded.bind(this);\n\t\tthis._onSwitchTrackRecordStatusHandler = this.onUpdateCallCopilotState.bind(this);\n\n\t\tthis.onPreCallDestroyHandler = this.onPreCallDestroy.bind(this);\n\t\tthis.onPreCallUserStateChangedHandler = this.onPreCallUserStateChanged.bind(this);\n\n\t\tthis.waitingForCallStatus = false;\n\t\tthis.waitingForCallStatusTimeout = null;\n\t\tthis.callEventReceived = false;\n\t\tthis.callRecordState = Call.View.RecordState.Stopped;\n\t\tthis.callRecordInfo = null;\n\n\t\tthis.floatingScreenShareWindow = null;\n\t\tthis.webScreenSharePopup = null;\n\t\tthis.screenShareStartTime = null;\n\n\t\tthis.mutePopup = null;\n\t\tthis.allowMutePopup = true;\n\n\t\tthis.loopTimers = {};\n\n\t\tthis.initDesktopEvents()\n\t\t\t.then(() => this.initRestClient())\n\t\t\t.then(() => this.subscribePreCallChanges())\n\t\t\t.then(() => this.subscribeNotifierEvents())\n\t\t\t.then(() => this.initPullClient())\n\t\t\t.then(() => this.initCore())\n\t\t\t.then(() => this.setModelData())\n\t\t\t.then(() => this.initComponent())\n\t\t\t.then(() => this.initCallInterface())\n\t\t\t.then(() => this.initHardware())\n\t\t\t.then(() => this.initUserComplete())\n\t\t\t.catch((error) => {\n\t\t\t\tconsole.error('Init error', error);\n\t\t\t})\n\t\t;\n\t}\n\t\t/* region 01. Initialize methods */\n\t\tinitDesktopEvents()\n\t\t{\n\t\t\tif (!DesktopApi.isDesktop())\n\t\t\t{\n\t\t\t\treturn new Promise((resolve, reject) => resolve());\n\t\t\t}\n\n\t\t\tthis.floatingScreenShareWindow = new Call.FloatingScreenShare({\n\t\t\t\tonBackToCallClick: this.onFloatingScreenShareBackToCallClick.bind(this),\n\t\t\t\tonStopSharingClick: this.onFloatingScreenShareStopClick.bind(this),\n\t\t\t\tonChangeScreenClick: this.onFloatingScreenShareChangeScreenClick.bind(this)\n\t\t\t});\n\n\t\t\tif (this.floatingScreenShareWindow)\n\t\t\t{\n\t\t\t\tDesktopApi.subscribe(\"BXScreenMediaSharing\", (id, title, x, y, width, height, app) =>\n\t\t\t\t{\n\t\t\t\t\tthis.floatingScreenShareWindow.setSharingData({\n\t\t\t\t\t\ttitle: title,\n\t\t\t\t\t\tx: x,\n\t\t\t\t\t\ty: y,\n\t\t\t\t\t\twidth: width,\n\t\t\t\t\t\theight: height,\n\t\t\t\t\t\tapp: app\n\t\t\t\t\t}).then(() => {\n\t\t\t\t\t\tthis.floatingScreenShareWindow.show();\n\t\t\t\t\t}).catch(error => {\n\t\t\t\t\t\tLogger.error('setSharingData error', error);\n\t\t\t\t\t});\n\t\t\t\t});\n\n\t\t\t\twindow.addEventListener('focus', () => {\n\t\t\t\t\tthis.onWindowFocus();\n\t\t\t\t});\n\n\t\t\t\twindow.addEventListener('blur', () => {\n\t\t\t\t\tthis.onWindowBlur();\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tDesktopApi.subscribe('bxImUpdateCounterMessage', (counter) =>\n\t\t\t{\n\t\t\t\tif (!this.controller)\n\t\t\t\t{\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tthis.controller.getStore().commit('conference/common', {\n\t\t\t\t\tmessageCount: counter\n\t\t\t\t});\n\t\t\t});\n\n\t\t\tEventEmitter.subscribe(EventType.textarea.focus, this.onInputFocusHandler);\n\t\t\tEventEmitter.subscribe(EventType.textarea.blur, this.onInputBlurHandler);\n\t\t\tEventEmitter.subscribe(EventType.conference.userRenameFocus, this.onInputFocusHandler);\n\t\t\tEventEmitter.subscribe(EventType.conference.userRenameBlur, this.onInputBlurHandler);\n\n\t\t\treturn new Promise((resolve, reject) => resolve());\n\t\t}\n\n\t\tinitRestClient()\n\t\t{\n\t\t\tthis.restClient = new CallRestClient({endpoint: this.getHost()+'/rest'});\n\t\t\tthis.restClient.setConfId(this.params.conferenceId);\n\n\t\t\treturn new Promise((resolve, reject) => resolve());\n\t\t}\n\n\t\tsubscribePreCallChanges()\n\t\t{\n\t\t\tBX.addCustomEvent(window, 'CallEvents::callCreated', this.onCallCreated.bind(this));\n\t\t}\n\n\t\tsubscribeNotifierEvents()\n\t\t{\n\t\t\tNotifier.subscribe('click', (event: BaseEvent<NotifierClickParams>) => {\n\t\t\t\tconst { id } = event.getData();\n\t\t\t\tif (id.startsWith('im-videconf'))\n\t\t\t\t{\n\t\t\t\t\tthis.toggleChat();\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tinitPullClient()\n\t\t{\n\t\t\tif (!this.params.isIntranetOrExtranet)\n\t\t\t{\n\t\t\t\tthis.pullClient = new PullClient({\n\t\t\t\t\tserverEnabled: true,\n\t\t\t\t\tuserId: this.params.userId,\n\t\t\t\t\tsiteId: this.params.siteId,\n\t\t\t\t\trestClient: this.restClient,\n\t\t\t\t\tskipStorageInit: true,\n\t\t\t\t\tconfigTimestamp: 0,\n\t\t\t\t\tskipCheckRevision: true,\n\t\t\t\t\tgetPublicListMethod: 'im.call.channel.public.list'\n\t\t\t\t});\n\n\t\t\t\treturn new Promise((resolve, reject) => resolve());\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.pullClient = BX.PULL;\n\n\t\t\t\treturn this.pullClient.start().then(() => {\n\t\t\t\t\treturn new Promise((resolve, reject) => resolve());\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\tinitCore()\n\t\t{\n\t\t\tthis.controller = new Controller({\n\t\t\t\thost: this.getHost(),\n\t\t\t\tsiteId: this.params.siteId,\n\t\t\t\tuserId: this.params.userId,\n\t\t\t\tlanguageId: this.params.language,\n\t\t\t\tpull: {client: this.pullClient},\n\t\t\t\trest: {client: this.restClient},\n\t\t\t\tvuexBuilder: {\n\t\t\t\t\tdatabase: !Utils.browser.isIe(),\n\t\t\t\t\tdatabaseName: 'imol/call',\n\t\t\t\t\tdatabaseType: VuexBuilder.DatabaseType.localStorage,\n\t\t\t\t\tmodels: [\n\t\t\t\t\t\tConferenceModel.create(),\n\t\t\t\t\t\tCallModel.create()\n\t\t\t\t\t],\n\t\t\t\t}\n\t\t\t});\n\n\t\t\twindow.BX.Messenger.Application.Core = {\n\t\t\t\tcontroller: this.controller\n\t\t\t};\n\n\t\t\treturn new Promise((resolve, reject) => {\n\t\t\t\tthis.controller.ready().then(() => resolve());\n\t\t\t});\n\t\t}\n\n\t\tsetModelData()\n\t\t{\n\t\t\tthis.controller.getStore().commit('application/set', {\n\t\t\t\tdialog: {\n\t\t\t\t\tchatId: this.getChatId(),\n\t\t\t\t\tdialogId: this.getDialogId()\n\t\t\t\t},\n\t\t\t\toptions: {\n\t\t\t\t\tdarkBackground: true\n\t\t\t\t}\n\t\t\t});\n\n\t\t\t//set presenters ID list\n\t\t\tconst presentersIds = this.params.presenters.map(presenter => presenter['id']);\n\t\t\tthis.controller.getStore().dispatch('conference/setBroadcastMode', {broadcastMode: this.params.isBroadcast});\n\t\t\tthis.controller.getStore().dispatch('conference/setPresenters', {presenters: presentersIds});\n\n\t\t\t//set presenters info in users model\n\t\t\tthis.params.presenters.forEach(presenter => {\n\t\t\t\tthis.controller.getStore().dispatch('users/set', presenter);\n\t\t\t});\n\n\t\t\tif (this.params.passwordRequired)\n\t\t\t{\n\t\t\t\tthis.controller.getStore().commit('conference/common', {\n\t\t\t\t\tpassChecked: false,\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tif (this.params.conferenceTitle)\n\t\t\t{\n\t\t\t\tthis.controller.getStore().dispatch('conference/setConferenceTitle', {\n\t\t\t\t\tconferenceTitle: this.params.conferenceTitle,\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tif (this.params.alias)\n\t\t\t{\n\t\t\t\tthis.controller.getStore().commit('conference/setAlias', {\n\t\t\t\t\talias: this.params.alias,\n\t\t\t\t});\n\t\t\t}\n\n\t\t\treturn new Promise((resolve, reject) => resolve());\n\t\t}\n\n\t\tinitComponent()\n\t\t{\n\t\t\tif (this.getStartupErrorCode())\n\t\t\t{\n\t\t\t\tthis.setError(this.getStartupErrorCode());\n\t\t\t}\n\n\t\t\treturn new Promise((resolve, reject) =>\n\t\t\t{\n\t\t\t\tthis.controller.createVue(this, {\n\t\t\t\t\tel: this.rootNode,\n\t\t\t\t\tdata: () =>\n\t\t\t\t\t{\n\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\tdialogId: this.getDialogId()\n\t\t\t\t\t\t};\n\t\t\t\t\t},\n\t\t\t\t\ttemplate: `<bx-im-component-conference-public :dialogId=\"dialogId\"/>`,\n\t\t\t\t}).then(vue =>\n\t\t\t\t{\n\t\t\t\t\tthis.template = vue;\n\t\t\t\t\tresolve();\n\t\t\t\t}).catch(error => reject(error));\n\t\t\t});\n\t\t}\n\n\t\tinitCallInterface()\n\t\t{\n\t\t\treturn new Promise((resolve, reject) =>\n\t\t\t{\n\t\t\t\ttry {\n\t\t\t\t\tthis.callContainer = document.getElementById('bx-im-component-call-container');\n\n\t\t\t\t\tlet hiddenButtons = ['document'];\n\t\t\t\t\tif (this.isViewerMode())\n\t\t\t\t\t{\n\t\t\t\t\t\thiddenButtons = ['camera', 'microphone', 'screen', 'record', 'floorRequest', 'document'];\n\t\t\t\t\t}\n\t\t\t\t\tif (!this.params.isIntranetOrExtranet)\n\t\t\t\t\t{\n\t\t\t\t\t\thiddenButtons.push('record');\n\t\t\t\t\t}\n\n\t\t\t\t\tif (!Call.Util.isConferenceChatEnabled())\n\t\t\t\t\t{\n\t\t\t\t\t\thiddenButtons.push('chat');\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.callView = new Call.View({\n\t\t\t\t\t\tcontainer: this.callContainer,\n\t\t\t\t\t\tshowChatButtons: true,\n\t\t\t\t\t\tshowUsersButton: true,\n\t\t\t\t\t\tshowShareButton: this.getFeatureState('screenSharing') !== ConferenceApplication.FeatureState.Disabled,\n\t\t\t\t\t\tshowRecordButton: this.getFeatureState('record') !== ConferenceApplication.FeatureState.Disabled,\n\t\t\t\t\t\tuserLimit: Call.Util.getUserLimit(),\n\t\t\t\t\t\tisIntranetOrExtranet: !!this.params.isIntranetOrExtranet,\n\t\t\t\t\t\tlanguage: this.params.language,\n\t\t\t\t\t\tlayout: Utils.device.isMobile() ? Call.View.Layout.Mobile : Call.View.Layout.Centered,\n\t\t\t\t\t\tuiState: Call.View.UiState.Preparing,\n\t\t\t\t\t\tblockedButtons: ['camera', 'microphone', 'floorRequest', 'screen', 'record', 'copilot'],\n\t\t\t\t\t\tlocalUserState: Call.UserState.Idle,\n\t\t\t\t\t\thiddenTopButtons: !this.isBroadcast() || this.getBroadcastPresenters().length > 1? []: ['grid'],\n\t\t\t\t\t\thiddenButtons: hiddenButtons,\n\t\t\t\t\t\tbroadcastingMode: this.isBroadcast(),\n\t\t\t\t\t\tbroadcastingPresenters: this.getBroadcastPresenters(),\n\t\t\t\t\t\tisCopilotFeaturesEnabled: false,\n\t\t\t\t\t\tisCopilotActive: false,\n\t\t\t\t\t});\n\n\t\t\t\t\tthis.callView.subscribe(Call.View.Event.onButtonClick, this.onCallButtonClick.bind(this));\n\t\t\t\t\tthis.callView.subscribe(Call.View.Event.onReplaceCamera, this.onCallReplaceCamera.bind(this));\n\t\t\t\t\tthis.callView.subscribe(Call.View.Event.onReplaceMicrophone, this.onCallReplaceMicrophone.bind(this));\n\t\t\t\t\tthis.callView.subscribe(Call.View.Event.onReplaceSpeaker, this.onCallReplaceSpeaker.bind(this));\n\t\t\t\t\tthis.callView.subscribe(Call.View.Event.onHasMainStream, this.onCallViewHasMainStream.bind(this));\n\t\t\t\t\tthis.callView.subscribe(Call.View.Event.onChangeHdVideo, this.onCallViewChangeHdVideo.bind(this));\n\t\t\t\t\tthis.callView.subscribe(Call.View.Event.onChangeMicAutoParams, this.onCallViewChangeMicAutoParams.bind(this));\n\t\t\t\t\tthis.callView.subscribe(Call.View.Event.onChangeFaceImprove, this.onCallViewChangeFaceImprove.bind(this));\n\t\t\t\t\tthis.callView.subscribe(Call.View.Event.onUserRename, this.onCallViewUserRename.bind(this));\n\t\t\t\t\tthis.callView.subscribe(Call.View.Event.onUserPinned, this.onCallViewUserPinned.bind(this));\n\t\t\t\t\tthis.callView.subscribe(Call.View.Event.onToggleSubscribe, this.onCallToggleSubscribe.bind(this));\n\n\t\t\t\t\tthis.callView.blockAddUser();\n\t\t\t\t\tthis.callView.blockHistoryButton();\n\n\t\t\t\t\tif (!Utils.device.isMobile())\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.callView.show();\n\t\t\t\t\t}\n\n\t\t\t\t\tresolve()\n\t\t\t\t} catch (error)\n\t\t\t\t{\n\t\t\t\t\tLogger.error('creating call interface conference', error);\n\n\t\t\t\t\tlet errorCode;\n\t\t\t\t\tif (typeof (error) == \"string\")\n\t\t\t\t\t{\n\t\t\t\t\t\terrorCode = error;\n\t\t\t\t\t}\n\t\t\t\t\telse if (typeof (error) == \"object\" && error.code)\n\t\t\t\t\t{\n\t\t\t\t\t\terrorCode = error.code == 'access_denied' ? 'ACCESS_DENIED' : error.code\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\terrorCode = 'UNKNOWN_ERROR';\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.onCallFailure({\n\t\t\t\t\t\tcode: errorCode,\n\t\t\t\t\t\tmessage: error.message || \"\",\n\t\t\t\t\t})\n\n\t\t\t\t\treject('call interface error');\n\t\t\t\t}\n\t\t\t})\n\t\t}\n\n\t\tinitUserComplete()\n\t\t{\n\t\t\treturn new Promise((resolve, reject) => {\n\t\t\t\tthis.initUser()\n\t\t\t\t\t.then(() => this.startPageTagInterval())\n\t\t\t\t\t.then(() => this.tryJoinExistingCall())\n\t\t\t\t\t.then(() => this.initCall())\n\t\t\t\t\t.then(() => this.initPullHandlers())\n\t\t\t\t\t.then(() => this.subscribeToStoreChanges())\n\t\t\t\t\t.then(() => this.initComplete())\n\t\t\t\t\t.then(() => resolve)\n\t\t\t\t\t.catch((error) => reject(error));\n\t\t\t})\n\t\t}\n\t\t/* endregion 01. Initialize methods */\n\n\t\t/* region 02. initUserComplete methods */\n\t\tinitUser()\n\t\t{\n\t\t\treturn new Promise((resolve, reject) => {\n\t\t\t\tif (this.getStartupErrorCode() || !this.getConference().common.passChecked)\n\t\t\t\t{\n\t\t\t\t\treturn reject();\n\t\t\t\t}\n\n\t\t\t\tif (this.params.userId > 0)\n\t\t\t\t{\n\t\t\t\t\tthis.controller.setUserId(this.params.userId);\n\n\t\t\t\t\tif (this.params.isIntranetOrExtranet)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.switchToSessAuth();\n\n\t\t\t\t\t\tthis.controller.getStore().commit('conference/user', {\n\t\t\t\t\t\t\tid: this.params.userId\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tlet hashFromCookie = this.getUserHashCookie();\n\t\t\t\t\t\tif (hashFromCookie)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.restClient.setAuthId(hashFromCookie);\n\t\t\t\t\t\t\tthis.restClient.setChatId(this.getChatId());\n\t\t\t\t\t\t\tthis.controller.getStore().commit('conference/user', {\n\t\t\t\t\t\t\t\tid: this.params.userId,\n\t\t\t\t\t\t\t\thash: hashFromCookie\n\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\tthis.pullClient.start();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.controller.getStore().commit('conference/common', {\n\t\t\t\t\t\tinited: true\n\t\t\t\t\t});\n\n\t\t\t\t\treturn resolve();\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.restClient.setAuthId('guest');\n\t\t\t\t\tthis.restClient.setChatId(this.getChatId());\n\n\t\t\t\t\tif (typeof BX.SidePanel !== 'undefined')\n\t\t\t\t\t{\n\t\t\t\t\t\tBX.SidePanel.Instance.disableAnchorBinding();\n\t\t\t\t\t}\n\n\t\t\t\t\treturn this.restClient.callMethod('im.call.user.register', {\n\t\t\t\t\t\talias: this.params.alias,\n\t\t\t\t\t\tuser_hash: this.getUserHashCookie() || '',\n\t\t\t\t\t}).then(result =>\n\t\t\t\t\t{\n\t\t\t\t\t\tBX.message['USER_ID'] = result.data().id;\n\t\t\t\t\t\tthis.controller.getStore().commit('conference/user', {\n\t\t\t\t\t\t\tid: result.data().id,\n\t\t\t\t\t\t\thash: result.data().hash\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\tthis.controller.setUserId(result.data().id);\n\t\t\t\t\t\tthis.callView.setLocalUserId(result.data().id);\n\n\t\t\t\t\t\tif (result.data().created)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.params.userCount++;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tthis.controller.getStore().commit('conference/common', {\n\t\t\t\t\t\t\tinited: true\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\tthis.restClient.setAuthId(result.data().hash);\n\t\t\t\t\t\tthis.pullClient.start();\n\n\t\t\t\t\t\treturn resolve();\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tstartPageTagInterval()\n\t\t{\n\t\t\treturn new Promise((resolve) => {\n\t\t\t\tclearInterval(this.conferencePageTagInterval);\n\t\t\t\tthis.conferencePageTagInterval = setInterval(() => {\n\t\t\t\t\tLocalStorage.set(this.params.siteId, this.params.userId, BX.CallEngine.getConferencePageTag(this.params.dialogId), \"Y\", 2);\n\t\t\t\t}, 1000);\n\t\t\t\tresolve();\n\t\t\t})\n\t\t}\n\n\t\ttryJoinExistingCall()\n\t\t{\n\t\t\tconst provider = Call.Provider.Bitrix;\n\n\t\t\tthis.restClient.callMethod(\"im.call.tryJoinCall\", {\n\t\t\t\t\tentityType: 'chat',\n\t\t\t\t\tentityId: this.params.dialogId,\n\t\t\t\t\tprovider: provider,\n\t\t\t\t\ttype: Call.Type.Permanent\n\t\t\t\t})\n\t\t\t\t.then(result => {\n\t\t\t\t\tLogger.warn('tryJoinCall', result.data());\n\t\t\t\t\tif (result.data().success)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.waitingForCallStatus = true;\n\t\t\t\t\t\tthis.waitingForCallStatusTimeout = setTimeout(() => {\n\t\t\t\t\t\t\tthis.waitingForCallStatus = false;\n\t\t\t\t\t\t\tif (!this.callEventReceived)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tthis.setConferenceStatus(false);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tthis.callEventReceived = false;\n\t\t\t\t\t\t}, 5000);\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.setConferenceStatus(false);\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t}\n\n\t\tinitCall()\n\t\t{\n\t\t\tCall.Engine.setRestClient(this.restClient);\n\t\t\tCall.Engine.setPullClient(this.pullClient);\n\t\t\tCall.Engine.setCurrentUserId(this.controller.getUserId());\n\t\t\tthis.callView.unblockButtons(['chat']);\n\t\t}\n\n\t\tinitPullHandlers()\n\t\t{\n\t\t\tthis.pullClient.subscribe(\n\t\t\t\tnew ImCallPullHandler({\n\t\t\t\t\tstore: this.controller.getStore(),\n\t\t\t\t\tapplication: this,\n\t\t\t\t\tcontroller: this.controller,\n\t\t\t\t})\n\t\t\t);\n\n\t\t\treturn new Promise((resolve, reject) => resolve());\n\t\t}\n\n\t\tsubscribeToStoreChanges()\n\t\t{\n\t\t\tthis.controller.getStore().subscribe((mutation, state) => {\n\t\t\t\tconst { payload, type } = mutation;\n\t\t\t\tif (type === 'users/update' && payload.fields.name)\n\t\t\t\t{\n\t\t\t\t\tif (!this.callView)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.callView.updateUserData(\n\t\t\t\t\t\t{[payload.id]: {name: payload.fields.name}}\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t\telse if (type === 'dialogues/set')\n\t\t\t\t{\n\t\t\t\t\tif (payload[0].dialogId !== this.getDialogId())\n\t\t\t\t\t{\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (!Utils.platform.isBitrixDesktop())\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.callView.setButtonCounter('chat', payload[0].counter);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse if (type === 'dialogues/update')\n\t\t\t\t{\n\t\t\t\t\tif (payload.dialogId !== this.getDialogId())\n\t\t\t\t\t{\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (typeof payload.fields.counter === 'number' && this.callView)\n\t\t\t\t\t{\n\t\t\t\t\t\tif (Utils.platform.isBitrixDesktop())\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tif (\n\t\t\t\t\t\t\t\tpayload.actionName === \"decreaseCounter\"\n\t\t\t\t\t\t\t\t&& !payload.dialogMuted\n\t\t\t\t\t\t\t\t&& typeof payload.fields.previousCounter === 'number'\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tlet counter = payload.fields.counter;\n\t\t\t\t\t\t\t\tif (this.getConference().common.messageCount)\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tcounter = this.getConference().common.messageCount - (payload.fields.previousCounter - counter);\n\t\t\t\t\t\t\t\t\tif (counter < 0)\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tcounter = 0;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tthis.callView.setButtonCounter('chat', counter);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.callView.setButtonCounter('chat', payload.fields.counter);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tif (typeof payload.fields.name !== 'undefined')\n\t\t\t\t\t{\n\t\t\t\t\t\tdocument.title = payload.fields.name.toString();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse if (type === 'conference/common' && typeof payload.messageCount === 'number')\n\t\t\t\t{\n\t\t\t\t\tif (this.callView)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.callView.setButtonCounter('chat', payload.messageCount);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tinitComplete()\n\t\t{\n\t\t\tif (this.isExternalUser())\n\t\t\t{\n\t\t\t\tthis.callView.localUser.userModel.allowRename = true;\n\t\t\t}\n\n\t\t\tif (this.getConference().common.inited)\n\t\t\t{\n\t\t\t\tthis.inited = true;\n\t\t\t\tthis.initPromise.resolve(this);\n\t\t\t}\n\n\t\t\tif (DesktopApi.isDesktop())\n\t\t\t{\n\t\t\t\tDesktopApi.emitToMainWindow('bxConferenceLoadComplete', []);\n\t\t\t}\n\n\t\t\treturn new Promise((resolve, reject) => resolve());\n\t\t}\n\t\t/* endregion 02. initUserComplete methods */\n\t/* endregion 01. Initialize */\n\n\t/* region 02. Methods */\n\n\t/* region 01. Call methods */\n\tinitHardware()\n\t{\n\t\treturn new Promise((resolve, reject) =>\n\t\t{\n\t\t\tCall.Hardware.init().then(() => {\n\t\t\t\tif (this.hardwareInited)\n\t\t\t\t{\n\t\t\t\t\tresolve();\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\n\t\t\t\tif (Object.values(Call.Hardware.microphoneList).length === 0)\n\t\t\t\t{\n\t\t\t\t\tthis.setError(ConferenceErrorCode.missingMicrophone);\n\t\t\t\t}\n\n\t\t\t\tif (!this.isViewerMode())\n\t\t\t\t{\n\t\t\t\t\tthis.checkAvailableCamera();\n\t\t\t\t\tthis.checkAvailableMicrophone();\n\t\t\t\t\tthis.callView.enableMediaSelection();\n\t\t\t\t}\n\n\t\t\t\tCall.Hardware.subscribe(Call.Hardware.Events.deviceChanged, this._onDeviceChange.bind(this));\n\n\t\t\t\tthis.hardwareInited = true;\n\t\t\t\tresolve();\n\t\t\t}).catch(error => {\n\t\t\t\tif (error === 'NO_WEBRTC' && this.isHttps())\n\t\t\t\t{\n\t\t\t\t\tthis.setError(ConferenceErrorCode.unsupportedBrowser);\n\t\t\t\t}\n\t\t\t\telse if (error === 'NO_WEBRTC' && !this.isHttps())\n\t\t\t\t{\n\t\t\t\t\tthis.setError(ConferenceErrorCode.unsafeConnection);\n\t\t\t\t}\n\t\t\t\tLogger.error('Init hardware error', error);\n\t\t\t\treject(error)\n\t\t\t})\n\t\t});\n\t}\n\n\t_onDeviceChange(e)\n\t{\n\t\tif (!this.currentCall || !this.currentCall.ready)\n\t\t{\n\t\t\tthis.checkAvailableCamera();\n\t\t\tthis.checkAvailableMicrophone();\n\t\t\treturn;\n\t\t}\n\n\t\tconst allAddedDevice = e.data.added;\n\t\tconst allRemovedDevice = e.data.removed;\n\t\tconst removed = Call.Hardware.getRemovedUsedDevices(\n\t\t\te.data.removed,\n\t\t\t{\n\t\t\t\tmicrophoneId: this.currentCall.microphoneId,\n\t\t\t\tcameraId: this.currentCall.cameraId,\n\t\t\t\tspeakerId: this.callView.speakerId,\n\t\t\t}\n\t\t);\n\n\t\tif (allAddedDevice)\n\t\t{\n\t\t\tsetTimeout(() => this.useDevicesInCurrentCall(allAddedDevice), 500);\n\t\t}\n\n\t\tif (removed.length > 0)\n\t\t{\n\t\t\tBX.UI.Notification.Center.notify({\n\t\t\t\tcontent: BX.message(\"IM_CALL_DEVICES_DETACHED\") + \"<br><ul>\" + removed.map(function (deviceInfo)\n\t\t\t\t{\n\t\t\t\t\treturn \"<li>\" + deviceInfo.label\n\t\t\t\t}) + \"</ul>\",\n\t\t\t\tposition: \"top-right\",\n\t\t\t\tautoHideDelay: 10000,\n\t\t\t\tcloseButton: true,\n\t\t\t\t//category: \"call-device-change\",\n\t\t\t\tactions: [{\n\t\t\t\t\ttitle: BX.message(\"IM_CALL_DEVICES_CLOSE\"),\n\t\t\t\t\tevents: {\n\t\t\t\t\t\tclick: function (event, balloon)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tballoon.close();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}]\n\t\t\t});\n\t\t}\n\n\t\tif (allRemovedDevice)\n\t\t{\n\t\t\tsetTimeout(() => this.removeDevicesFromCurrentCall(allRemovedDevice), 500);\n\t\t}\n\t}\n\n\tsetDefaultCameraIfNeeded()\n\t{\n\t\tif (!Call.Hardware.hasCamera() || (!!Call.Hardware.defaultCamera && !!Call.Hardware.cameraList.length && Call.Hardware.cameraList.some(cameraItem => cameraItem.deviceId === Call.Hardware.defaultCamera)))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\n\t\tif (!Call.Hardware.defaultCamera && !!Call.Hardware.cameraList.length)\n\t\t{\n\t\t\tCall.Hardware.defaultCamera = Call.Hardware.cameraList[0].deviceId;\n\n\t\t\treturn;\n\t\t}\n\n\t\tCall.Hardware.defaultCamera = '';\n\t}\n\n\tsetDefaultMicrophoneIfNeeded()\n\t{\n\t\tif (!Call.Hardware.hasMicrophone() || (!!Call.Hardware.defaultMicrophone && !!Call.Hardware.microphoneList.length && Call.Hardware.microphoneList.some(micItem => micItem.deviceId === Call.Hardware.defaultMicrophone)))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\n\t\tif (!Call.Hardware.defaultMicrophone && !!Call.Hardware.microphoneList.length)\n\t\t{\n\t\t\tCall.Hardware.defaultMicrophone = Call.Hardware.microphoneList[0].deviceId;\n\n\t\t\treturn;\n\t\t}\n\n\t\tCall.Hardware.defaultMicrophone = '';\n\t}\n\n\tcheckAvailableCamera()\n\t{\n\t\tconst isCameraButtonHasBlocked = this.callView.isButtonBlocked('camera');\n\n\t\tif (!this.currentCall && !Call.Hardware.hasCamera())\n\t\t{\n\t\t\tthis.callView.blockSwitchCamera();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.callView.unblockSwitchCamera();\n\t\t}\n\n\t\tthis.setDefaultCameraIfNeeded();\n\n\t\tconst isActiveState = Call.Hardware.hasCamera() && Call.Hardware.defaultCamera;\n\n\t\tif (!this.currentCall && isCameraButtonHasBlocked)\n\t\t{\n\t\t\tthis.template.$emit('setCameraState', isActiveState);\n\t\t\tthis.template.$emit('cameraSelected', Call.Hardware.defaultCamera);\n\t\t}\n\n\t\tthis.callView.updateButtons();\n\t}\n\n\tcheckAvailableMicrophone()\n\t{\n\t\tif (!this.currentCall && !Call.Hardware.hasMicrophone())\n\t\t{\n\t\t\tthis.callView.blockSwitchMicrophone();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.callView.unblockSwitchMicrophone();\n\t\t}\n\n\t\tthis.setDefaultMicrophoneIfNeeded();\n\n\t\tconst isActiveState = Call.Hardware.hasMicrophone();\n\n\t\tif (!this.currentCall)\n\t\t{\n\t\t\tthis.template.$emit('setMicState', isActiveState);\n\t\t\tthis.template.$emit('micSelected', Call.Hardware.defaultCamera);\n\t\t}\n\n\t\tthis.callView.updateButtons();\n\t}\n\n\tuseDevicesInCurrentCall(deviceList, isForceUse = false)\n\t{\n\t\tif (!this.currentCall || !this.currentCall.ready)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tfor (let i = 0; i < deviceList.length; i++)\n\t\t{\n\t\t\tconst deviceInfo = deviceList[i];\n\n\t\t\tswitch (deviceInfo.kind)\n\t\t\t{\n\t\t\t\tcase \"audioinput\":\n\t\t\t\t\tif (deviceInfo.deviceId === 'default' || isForceUse)\n\t\t\t\t\t{\n\t\t\t\t\t\tconst newDeviceId = Call.Hardware.getDefaultDeviceIdByGroupId(deviceInfo.groupId, 'audioinput');\n\t\t\t\t\t\tthis.currentCall.setMicrophoneId(newDeviceId);\n\t\t\t\t\t\tthis.callView.setMicrophoneId(newDeviceId);\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.checkAvailableMicrophone();\n\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"videoinput\":\n\t\t\t\t\tif (deviceInfo.deviceId === 'default' || isForceUse)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.currentCall.setCameraId(deviceInfo.deviceId);\n\t\t\t\t\t}\n\n\t\t\t\t\tif (this.reconnectingCameraId === deviceInfo.deviceId && !Call.Hardware.isCameraOn)\n\t\t\t\t\t{\n\t\t\t\t\t   this.updateCameraSettingsInCurrentCallAfterReconnecting(deviceInfo.deviceId)\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.checkAvailableCamera();\n\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"audiooutput\":\n\t\t\t\t\tif (this.callView && deviceInfo.deviceId === 'default' || isForceUse)\n\t\t\t\t\t{\n\t\t\t\t\t\tconst newDeviceId = Call.Hardware.getDefaultDeviceIdByGroupId(deviceInfo.groupId, 'audiooutput');\n\t\t\t\t\t\tthis.callView.setSpeakerId(newDeviceId);\n\t\t\t\t\t}\n\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\n\tremoveDevicesFromCurrentCall(deviceList)\n\t{\n\t\tif (!this.currentCall || !this.currentCall.ready)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tfor (let i = 0; i < deviceList.length; i++)\n\t\t{\n\t\t\tconst deviceInfo = deviceList[i];\n\n\t\t\tswitch (deviceInfo.kind)\n\t\t\t{\n\t\t\t\tcase \"audioinput\":\n\t\t\t\t\tif (this.currentCall.microphoneId == deviceInfo.deviceId)\n\t\t\t\t\t{\n\t\t\t\t\t\tconst microphoneIds = Object.keys(Call.Hardware.microphoneList);\n\t\t\t\t\t\tlet deviceId;\n\n\t\t\t\t\t\tif (microphoneIds.includes('default'))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tconst deviceGroup = Call.Hardware.getDeviceGroupIdByDeviceId('default', 'audioinput');\n\t\t\t\t\t\t\tdeviceId = Call.Hardware.getDefaultDeviceIdByGroupId(deviceGroup, 'audioinput');\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (!deviceId)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tdeviceId = microphoneIds.length > 0 ? microphoneIds[0] : \"\";\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tthis.currentCall.setMicrophoneId(deviceId);\n\n\t\t\t\t\t\tif (this.currentCall.provider === Call.Provider.Bitrix)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.callView.setMicrophoneId(deviceId);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.checkAvailableMicrophone();\n\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"videoinput\":\n\t\t\t\t\tif (this.currentCall.cameraId == deviceInfo.deviceId)\n\t\t\t\t\t{\n\t\t\t\t\t\tconst cameraIds = Object.keys(Call.Hardware.cameraList);\n\t\t\t\t\t\tthis.currentCall.setCameraId(cameraIds.length > 0 ? cameraIds[0] : \"\");\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.checkAvailableCamera();\n\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"audiooutput\":\n\t\t\t\t\tif (this.callView && this.callView.speakerId == deviceInfo.deviceId)\n\t\t\t\t\t{\n\t\t\t\t\t\tconst speakerIds = Object.keys(Call.Hardware.audioOutputList);\n\t\t\t\t\t\tlet deviceId;\n\n\t\t\t\t\t\tif (speakerIds.includes('default'))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tconst deviceGroup = Call.Hardware.getDeviceGroupIdByDeviceId('default', 'audiooutput');\n\t\t\t\t\t\t\tdeviceId = Call.Hardware.getDefaultDeviceIdByGroupId(deviceGroup, 'audiooutput');\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (!deviceId)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.callView.setSpeakerId(speakerIds.length > 0 ? speakerIds[0] : \"\");\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\n\tstartCall(videoEnabled, viewerMode = false, withCopilot)\n\t{\n\t\tif (this.initCallPromise)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst provider = Call.Provider.Bitrix;\n\n\t\tif (Utils.device.isMobile())\n\t\t{\n\t\t\tthis.callView.show();\n\t\t\tthis.callView.setButtonCounter('chat', this.getDialogData().counter);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.callView.setLayout(Call.View.Layout.Grid);\n\t\t}\n\n\t\tthis.callView.setUiState(Call.View.UiState.Calling);\n\n\t\tif (videoEnabled && !Call.Hardware.hasCamera())\n\t\t{\n\t\t\tthis.showNotification(BX.message('IM_CALL_NO_CAMERA_ERROR'));\n\t\t\tvideoEnabled = false;\n\t\t}\n\n\t\tif (this.localVideoStream)\n\t\t{\n\t\t\tif (!videoEnabled)\n\t\t\t{\n\t\t\t\tthis.stopLocalVideoStream();\n\t\t\t}\n\t\t}\n\t\tthis.controller.getStore().commit('conference/startCall');\n\n\t\tthis.initCallPromise = Call.Engine.createCall({\n\t\t\ttype: Call.Type.Permanent,\n\t\t\tentityType: 'chat',\n\t\t\tentityId: this.getDialogId(),\n\t\t\tprovider: provider,\n\t\t\tvideoEnabled: videoEnabled,\n\t\t\tenableMicAutoParameters: Call.Hardware.enableMicAutoParameters,\n\t\t\tjoinExisting: true\n\t\t}).then(e => {\n\t\t\tLogger.warn('call created', e);\n\n\t\t\tthis.currentCall = e.call;\n\t\t\t//this.currentCall.useHdVideo(Call.Hardware.preferHdQuality);\n\t\t\tthis.currentCall.useHdVideo(true);\n\t\t\tthis.onUpdateCallCopilotState({\n\t\t\t\tisTrackRecordOn: this.currentCall.isCopilotActive,\n\t\t\t});\n\t\t\tif(Call.Hardware.defaultMicrophone)\n\t\t\t{\n\t\t\t\tthis.currentCall.setMicrophoneId(Call.Hardware.defaultMicrophone);\n\t\t\t}\n\t\t\tif(Call.Hardware.defaultCamera)\n\t\t\t{\n\t\t\t\tthis.currentCall.setCameraId(Call.Hardware.defaultCamera);\n\t\t\t}\n\n\t\t\tthis.checkAvailableMicrophone();\n\t\t\tthis.checkAvailableCamera();\n\n\t\t\tif(!Utils.device.isMobile())\n\t\t\t{\n\t\t\t\tthis.callView.setLayout(Call.View.Layout.Grid);\n\t\t\t}\n\t\t\tthis.callView.appendUsers(this.currentCall.getUsers());\n\t\t\tCall.Util.getUsers(this.currentCall.id, this.getCallUsers(true)).then(userData => {\n\t\t\t\tthis.controller.getStore().dispatch('users/set', Object.values(userData));\n\t\t\t\tthis.controller.getStore().dispatch('conference/setUsers', {users: Object.keys(userData)});\n\t\t\t\tthis.callView.updateUserData(userData)\n\t\t\t});\n\t\t\tthis.releasePreCall();\n\t\t\tthis.bindCallEvents();\n\t\t\tthis.updateCallUser(this.currentCall.userId, {microphoneState: !Call.Hardware.isMicrophoneMuted});\n\t\t\tif(e.isNew)\n\t\t\t{\n\t\t\t\tAnalytics.getInstance().onStartVideoconf({\n\t\t\t\t\tcallId: this.currentCall?.id,\n\t\t\t\t\twithVideo: videoEnabled,\n\t\t\t\t\tmediaParams: {\n\t\t\t\t\t\tvideo: Call.Hardware.isCameraOn,\n\t\t\t\t\t\taudio: !Call.Hardware.isMicrophoneMuted,\n\t\t\t\t\t},\n\t\t\t\t\tstatus: Analytics.AnalyticsStatus.success,\n\t\t\t\t\tisCopilotActive: this.currentCall.isCopilotActive,\n\t\t\t\t});\n\n\t\t\t\tthis.currentCall.inviteUsers();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.currentCall.answer({\n\t\t\t\t\tjoinAsViewer: viewerMode\n\t\t\t\t});\n\t\t\t\tAnalytics.getInstance().onJoinVideoconf({\n\t\t\t\t\tcallId: this.currentCall?.id,\n\t\t\t\t\twithVideo: videoEnabled,\n\t\t\t\t\tmediaParams: {\n\t\t\t\t\t\tvideo: Call.Hardware.isCameraOn,\n\t\t\t\t\t\taudio: !Call.Hardware.isMicrophoneMuted,\n\t\t\t\t\t},\n\t\t\t\t\tstatus: Analytics.AnalyticsStatus.success,\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tthis.onUpdateLastUsedCameraId();\n\n\t\t}).catch(error => {\n\t\t\tLogger.error('creating call error', error);\n\t\t\tlet errorCode;\n\t\t\tif (typeof (error) == \"string\")\n\t\t\t{\n\t\t\t\terrorCode = error;\n\t\t\t}\n\t\t\telse if (typeof (error) == \"object\" && error.code)\n\t\t\t{\n\t\t\t\terrorCode = error.code == 'access_denied' ? 'ACCESS_DENIED' : error.code\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\terrorCode = 'UNKNOWN_ERROR';\n\t\t\t}\n\t\t\tthis.onCallFailure({\n\t\t\t\tcode: errorCode,\n\t\t\t\tmessage: error.message || \"\",\n\t\t\t})\n\t\t\tthis.initCallPromise = null;\n\t\t});\n\t}\n\n\t/**\n\t * @param {int} callId\n\t * @param {object} options\n\t */\n\tjoinCall(callId, options)\n\t{\n\t\tif (this.initCallPromise)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tlet video = BX.prop.getBoolean(options, \"video\", false);\n\t\tlet joinAsViewer = BX.prop.getBoolean(options, \"joinAsViewer\", false);\n\t\tif (!!video)\n\t\t{\n\t\t\tCall.Hardware.isCameraOn = false;\n\t\t}\n\n\t\tif (Utils.device.isMobile())\n\t\t{\n\t\t\tthis.callView.show();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.callView.setLayout(Call.View.Layout.Grid);\n\t\t}\n\n\t\tif (joinAsViewer)\n\t\t{\n\t\t\tthis.callView.setLocalUserDirection(Call.EndpointDirection.RecvOnly);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.callView.setLocalUserDirection(Call.EndpointDirection.SendRecv);\n\t\t}\n\n\t\tthis.callView.setUiState(Call.View.UiState.Calling);\n\t\tthis.initCallPromise = Call.Engine.getCallWithId(callId).then((result) =>\n\t\t{\n\t\t\tthis.currentCall = result.call;\n\t\t\tthis.releasePreCall();\n\t\t\tthis.bindCallEvents();\n\n\t\t\tthis.controller.getStore().commit('conference/startCall');\n\n\t\t\tthis.callView.appendUsers(this.currentCall.getUsers());\n\t\t\tCall.Util.getUsers(this.currentCall.id, this.getCallUsers(true)).then(userData => {\n\t\t\t\tthis.controller.getStore().dispatch('users/set', Object.values(userData));\n\t\t\t\tthis.controller.getStore().dispatch('conference/setUsers', {users: Object.keys(userData)});\n\t\t\t\tthis.callView.updateUserData(userData)\n\t\t\t});\n\n\t\t\tif (!joinAsViewer)\n\t\t\t{\n\t\t\t\t//this.currentCall.useHdVideo(Call.Hardware.preferHdQuality);\n\t\t\t\tthis.currentCall.useHdVideo(true);\n\t\t\t\tif (Call.Hardware.defaultMicrophone)\n\t\t\t\t{\n\t\t\t\t\tthis.currentCall.setMicrophoneId(Call.Hardware.defaultMicrophone);\n\t\t\t\t}\n\t\t\t\tif (Call.Hardware.defaultCamera)\n\t\t\t\t{\n\t\t\t\t\tthis.currentCall.setCameraId(Call.Hardware.defaultCamera);\n\t\t\t\t}\n\n\t\t\t\tthis.checkAvailableMicrophone();\n\t\t\t\tthis.checkAvailableCamera();\n\n\t\t\t\tthis.updateCallUser(this.currentCall.userId, {microphoneState: !Call.Hardware.isMicrophoneMuted});\n\t\t\t}\n\n\t\t\tthis.currentCall.answer({\n\t\t\t\tjoinAsViewer: joinAsViewer\n\t\t\t});\n\t\t\tthis.onUpdateLastUsedCameraId();\n\t\t}).catch((error) =>\n\t\t{\n\t\t\tconsole.error(error);\n\t\t\tthis.initCallPromise = null;\n\t\t});\n\t}\n\n\tendCall(finishCall = false)\n\t{\n\t\tif (this.currentCall)\n\t\t{\n\t\t\tthis.showFeedback = this.currentCall.wasConnected;\n\t\t\tthis.callDetails = {\n\t\t\t\tid: this.currentCall.id,\n\t\t\t\tprovider: this.currentCall.provider,\n\t\t\t\tuserCount: this.currentCall.users.length,\n\t\t\t\tbrowser: Call.Util.getBrowserForStatistics(),\n\t\t\t\tisMobile: BX.browser.IsMobile(),\n\t\t\t\tisConference: true\n\t\t\t}\n\n\t\t\tthis.removeCallEvents();\n\t\t\tthis.currentCall.hangup(false, '', finishCall);\n\t\t}\n\n\t\tif (this.isRecording())\n\t\t{\n\t\t\tAnalytics.getInstance().onRecordStop({\n\t\t\t\tcallId: this.currentCall.id,\n\t\t\t\tcallType: Analytics.AnalyticsType.videoconf,\n\t\t\t\tsubSection: finishCall ? Analytics.AnalyticsSubSection.contextMenu : Analytics.AnalyticsSubSection.window,\n\t\t\t\telement: finishCall ? Analytics.AnalyticsElement.finishForAllButton : Analytics.AnalyticsElement.disconnectButton,\n\t\t\t\trecordTime: Call.Util.getRecordTimeText(this.callRecordInfo),\n\t\t\t});\n\t\t\tthis.callRecordInfo = null;\n\n\t\t\tBXDesktopSystem.CallRecordStop();\n\t\t}\n\t\tthis.callRecordState = Call.View.RecordState.Stopped;\n\n\t\tif (Utils.platform.isBitrixDesktop())\n\t\t{\n\t\t\tif (this.floatingScreenShareWindow)\n\t\t\t{\n\t\t\t\tthis.floatingScreenShareWindow.destroy();\n\t\t\t\tthis.floatingScreenShareWindow = null;\n\t\t\t}\n\n\t\t\twindow.close();\n\t\t\t// if the conference was opened incorrectly, then \"window.close();\" may not work in some cases\n\t\t\t// as a workaround, we can redirect the user back to the portal's front page.\n\t\t\tlocation.href = '/';\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.callView.releaseLocalMedia();\n\t\t\tthis.callView.close();\n\t\t\tthis.closeReconnectionBaloon();\n\t\t\tthis.setError(ConferenceErrorCode.userLeftCall);\n\t\t\tthis.controller.getStore().commit('conference/endCall');\n\t\t}\n\n\t\tEventEmitter.unsubscribe(EventType.textarea.focus, this.onInputFocusHandler);\n\t\tEventEmitter.unsubscribe(EventType.textarea.blur, this.onInputBlurHandler);\n\t\tEventEmitter.unsubscribe(EventType.conference.userRenameFocus, this.onInputFocusHandler);\n\t\tEventEmitter.unsubscribe(EventType.conference.userRenameBlur, this.onInputBlurHandler);\n\t}\n\n\trestart()\n\t{\n\t\tconsole.trace(\" restart\");\n\t\tif(this.currentCall)\n\t\t{\n\t\t\tthis.removeCallEvents();\n\t\t\tthis.currentCall = null;\n\t\t}\n\n\t\tif(this.callView)\n\t\t{\n\t\t\tthis.callView.releaseLocalMedia();\n\t\t\tthis.callView.close();\n\t\t\tthis.closeReconnectionBaloon();\n\t\t\tthis.callView.destroy();\n\t\t\tthis.callView = null;\n\t\t}\n\t\tthis.initCallInterface();\n\t\tthis.initCall();\n\t\tthis.controller.getStore().commit('conference/endCall');\n\t}\n\n\tkickFromCall()\n\t{\n\t\tthis.setError(ConferenceErrorCode.kickedFromCall);\n\t\tthis.pullClient.disconnect();\n\t\tthis.endCall();\n\t}\n\n\tgetCallUsers(includeSelf)\n\t{\n\t\tif (!this.currentCall)\n\t\t{\n\t\t\treturn [];\n\t\t}\n\n\t\tlet result = Object.keys(this.currentCall.getUsers());\n\t\tif (includeSelf)\n\t\t{\n\t\t\tresult.push(this.currentCall.userId);\n\t\t}\n\t\treturn result;\n\t}\n\n\tgetActiveCallUsers()\n\t{\n\t\tconst userStates = this.currentCall.getUsers();\n\t\tlet activeUsers = [];\n\n\t\tfor (let userId in userStates)\n\t\t{\n\t\t\tif (userStates.hasOwnProperty(userId))\n\t\t\t{\n\t\t\t\tif (\n\t\t\t\t\tuserStates[userId] === Call.UserState.Connected\n\t\t\t\t\t|| userStates[userId] === Call.UserState.Connecting\n\t\t\t\t\t|| userStates[userId] === Call.UserState.Calling\n\t\t\t\t)\n\t\t\t\t{\n\t\t\t\t\tactiveUsers.push(userId);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn activeUsers;\n\t}\n\n\tsetLocalVideoStream(stream)\n\t{\n\t\tthis.localVideoStream = stream;\n\t}\n\n\tupdateMediaDevices() {\n\t\tCall.Hardware.getCurrentDeviceList()\n\t\tconsole.log('updateMediaDevices')\n\t}\n\n\tstopLocalVideoStream()\n\t{\n\t\tif (this.localVideoStream)\n\t\t{\n\t\t\tthis.localVideoStream.getTracks().forEach(tr => tr.stop());\n\t\t}\n\t\tthis.localVideoStream = null;\n\t}\n\n\tsetSelectedCamera(cameraId)\n\t{\n\t\tif (this.callView)\n\t\t{\n\t\t\tthis.callView.setCameraId(cameraId)\n\t\t}\n\t}\n\n\tsetSelectedMic(micId)\n\t{\n\t\tif (this.callView)\n\t\t{\n\t\t\tthis.callView.setMicrophoneId(micId);\n\t\t}\n\t}\n\n\tgetFeature(id)\n\t{\n\t\tif (typeof this.featureConfig[id] === 'undefined')\n\t\t{\n\t\t\treturn {\n\t\t\t\tid,\n\t\t\t\tstate: ConferenceApplication.FeatureState.Enabled,\n\t\t\t\tarticleCode: ''\n\t\t\t}\n\t\t}\n\n\t\treturn this.featureConfig[id];\n\t}\n\n\tgetFeatureState(id)\n\t{\n\t\treturn this.getFeature(id).state;\n\t}\n\n\tcanRecord()\n\t{\n\t\treturn Utils.platform.isBitrixDesktop() && Utils.platform.getDesktopVersion() >= 54;\n\t}\n\n\tisRecording()\n\t{\n\t\treturn this.canRecord() && this.callRecordState != Call.View.RecordState.Stopped;\n\t}\n\n\tshowFeatureLimitSlider(id)\n\t{\n\t\tconst articleCode = this.getFeature(id).articleCode;\n\t\tif (!articleCode || !window.BX.UI.InfoHelper)\n\t\t{\n\t\t\tconsole.warn('Limit article not found', id);\n\t\t\treturn false;\n\t\t}\n\n\t\twindow.BX.UI.InfoHelper.show(articleCode);\n\n\t\treturn true;\n\t}\n\n\tshowNotification(notificationText, actions)\n\t{\n\t\tif (!actions)\n\t\t{\n\t\t\tactions = [];\n\t\t}\n\t\tBX.UI.Notification.Center.notify({\n\t\t\tcontent: Text.encode(notificationText),\n\t\t\tposition: \"top-right\",\n\t\t\tautoHideDelay: 5000,\n\t\t\tcloseButton: true,\n\t\t\tactions: actions\n\t\t});\n\t}\n\n\tshowMicMutedNotification()\n\t{\n\t\tif (this.mutePopup || !this.callView)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.mutePopup = new Call.Hint({\n\t\t\tbindElement: this.callView.buttons.microphone.elements.icon,\n\t\t\ttargetContainer: this.callView.container,\n\t\t\tbuttons: [\n\t\t\t\tthis.createUnmuteButton()\n\t\t\t],\n\t\t\tonClose: () =>\n\t\t\t{\n\t\t\t\tthis.allowMutePopup = false;\n\t\t\t\tthis.mutePopup.destroy();\n\t\t\t\tthis.mutePopup = null;\n\t\t\t},\n\t\t});\n\t\tthis.mutePopup.show();\n\t}\n\tcreateUnmuteButton()\n\t{\n\t\treturn new BX.UI.Button({\n\t\t\tbaseClass: \"ui-btn ui-btn-icon-mic\",\n\t\t\ttext: BX.message(\"IM_CALL_UNMUTE_MIC\"),\n\t\t\tsize: BX.UI.Button.Size.EXTRA_SMALL,\n\t\t\tcolor: BX.UI.Button.Color.LIGHT_BORDER,\n\t\t\tnoCaps: true,\n\t\t\tround: true,\n\t\t\tevents: {\n\t\t\t\tclick: () =>\n\t\t\t\t{\n\t\t\t\t\tthis.onCallViewToggleMuteButtonClick({\n\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\tmuted: false\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\tthis.mutePopup.destroy();\n\t\t\t\t\tthis.mutePopup = null;\n\t\t\t\t}\n\t\t\t}\n\t\t})\n\t}\n\n\tshowWebScreenSharePopup()\n\t{\n\t\tif (this.webScreenSharePopup)\n\t\t{\n\t\t\tthis.webScreenSharePopup.show();\n\n\t\t\treturn;\n\t\t}\n\n\t\tthis.webScreenSharePopup = new Call.WebScreenSharePopup({\n\t\t\tbindElement: this.callView.buttons.screen.elements.root,\n\t\t\ttargetContainer: this.callView.container,\n\t\t\tonClose: function ()\n\t\t\t{\n\t\t\t\tthis.webScreenSharePopup.destroy();\n\t\t\t\tthis.webScreenSharePopup = null;\n\t\t\t}.bind(this),\n\t\t\tonStopSharingClick: function ()\n\t\t\t{\n\t\t\t\tthis.onCallViewToggleScreenSharingButtonClick();\n\t\t\t\tthis.webScreenSharePopup.destroy();\n\t\t\t\tthis.webScreenSharePopup = null;\n\t\t\t}.bind(this)\n\t\t});\n\t\tthis.webScreenSharePopup.show();\n\t}\n\n\tisViewerMode()\n\t{\n\t\tlet viewerMode = false;\n\t\tconst isBroadcast = this.isBroadcast();\n\t\tif (isBroadcast)\n\t\t{\n\t\t\tconst presenters = this.getBroadcastPresenters();\n\t\t\tconst currentUserId = this.controller.getStore().state.application.common.userId;\n\t\t\tconst isCurrentUserPresenter = presenters.includes(currentUserId);\n\t\t\tviewerMode = isBroadcast && !isCurrentUserPresenter;\n\t\t}\n\t\treturn viewerMode;\n\t}\n\n\tonCallCreated(e)\n\t{\n\t\tLogger.warn('we got event onCallCreated', e);\n\t\tif(this.preCall || this.currentCall)\n\t\t{\n\t\t\treturn;\n\t\t}\n\t\tlet call = e.call;\n\t\tif (call.associatedEntity.type === 'chat' && call.associatedEntity.id === this.params.dialogId)\n\t\t{\n\t\t\tthis.preCall = e.call;\n\t\t\tthis.updatePreCallCounter();\n\t\t\tthis.preCall.addEventListener(Call.Event.onUserStateChanged, this.onPreCallUserStateChangedHandler);\n\t\t\tthis.preCall.addEventListener(Call.Event.onDestroy, this.onPreCallDestroyHandler);\n\n\t\t\tif (this.waitingForCallStatus)\n\t\t\t{\n\t\t\t\tthis.callEventReceived = true;\n\t\t\t}\n\t\t\tthis.setConferenceStatus(true);\n\t\t\tthis.setConferenceStartDate(e.call.startDate);\n\t\t}\n\n\t\tconst userReadyToJoin = this.getConference().common.userReadyToJoin;\n\t\tif (userReadyToJoin)\n\t\t{\n\t\t\tlet viewerMode = this.isViewerMode();\n\n\t\t\tconst videoEnabled = this.getConference().common.joinWithVideo;\n\t\t\tLogger.warn('ready to join call after waiting', videoEnabled, viewerMode);\n\t\t\tsetTimeout(() => {\n\t\t\t\tCall.Hardware.init().then(() => {\n\t\t\t\t\tif (viewerMode && this.preCall)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.joinCall(this.preCall.id, {\n\t\t\t\t\t\t\tjoinAsViewer: true\n\t\t\t\t\t\t})\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.startCall(videoEnabled);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}, 1000);\n\t\t}\n\t}\n\n\treleasePreCall()\n\t{\n\t\tif(this.preCall)\n\t\t{\n\t\t\tthis.preCall.removeEventListener(Call.Event.onUserStateChanged, this.onPreCallUserStateChangedHandler);\n\t\t\tthis.preCall.removeEventListener(Call.Event.onDestroy, this.onPreCallDestroyHandler);\n\t\t\tthis.preCall = null;\n\t\t}\n\t}\n\n\tonPreCallDestroy(e)\n\t{\n\t\tif (this.waitingForCallStatusTimeout)\n\t\t{\n\t\t\tclearTimeout(this.waitingForCallStatusTimeout);\n\t\t}\n\t\tthis.setConferenceStatus(false);\n\n\t\tthis.releasePreCall();\n\t}\n\n\tonPreCallUserStateChanged(e)\n\t{\n\t\tthis.updatePreCallCounter();\n\t}\n\n\tupdatePreCallCounter()\n\t{\n\t\tif(this.preCall)\n\t\t{\n\t\t\tthis.controller.getStore().commit('conference/common', {\n\t\t\t\tuserInCallCount: this.preCall.getParticipatingUsers().length\n\t\t\t});\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.controller.getStore().commit('conference/common', {\n\t\t\t\tuserInCallCount: 0\n\t\t\t});\n\t\t}\n\t}\n\n\tcreateVideoStrategy()\n\t{\n\t\tif (this.videoStrategy)\n\t\t{\n\t\t\tthis.videoStrategy.destroy();\n\t\t}\n\n\t\tvar strategyType = Utils.device.isMobile() ? VideoStrategy.Type.OnlySpeaker : VideoStrategy.Type.AllowAll;\n\n\t\tthis.videoStrategy = new VideoStrategy({\n\t\t\tcall: this.currentCall,\n\t\t\tcallView: this.callView,\n\t\t\tstrategyType: strategyType\n\t\t});\n\t}\n\n\tremoveVideoStrategy()\n\t{\n\t\tif (this.videoStrategy)\n\t\t{\n\t\t\tthis.videoStrategy.destroy();\n\t\t}\n\t\tthis.videoStrategy = null;\n\t}\n\n\tonCallReplaceCamera(event)\n\t{\n\t\tlet cameraId = event.data.deviceId;\n\n\t\tif (this.reconnectingCameraId) {\n\t\t\tthis.setReconnectingCameraId(null);\n\t\t}\n\n\t\tCall.Hardware.defaultCamera = cameraId;\n\t\tif (this.currentCall)\n\t\t{\n\t\t\tthis.currentCall.setCameraId(cameraId);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.template.$emit('cameraSelected', cameraId);\n\t\t}\n\t}\n\n\tonCallReplaceMicrophone(event)\n\t{\n\t\tlet microphoneId = event.data.deviceId;\n\t\tCall.Hardware.defaultMicrophone = microphoneId.deviceId;\n\t\tif (this.callView)\n\t\t{\n\t\t\tthis.callView.setMicrophoneId(microphoneId);\n\t\t}\n\t\tif (this.currentCall)\n\t\t{\n\t\t\tthis.currentCall.setMicrophoneId(microphoneId);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.template.$emit('micSelected', event.data.deviceId);\n\t\t}\n\t}\n\n\tonCallReplaceSpeaker(event)\n\t{\n\t\tCall.Hardware.defaultSpeaker = event.data.deviceId;\n\t}\n\n\tonCallViewHasMainStream(event)\n\t{\n\t\tif (this.currentCall && this.currentCall.provider === Call.Provider.Bitrix)\n\t\t{\n\t\t\tthis.currentCall.setMainStream(event.data.userId);\n\t\t}\n\t}\n\n\tonCallViewChangeHdVideo(event)\n\t{\n\t\tCall.Hardware.preferHdQuality = event.data.allowHdVideo;\n\t}\n\n\tonCallViewChangeMicAutoParams(event)\n\t{\n\t\tCall.Hardware.enableMicAutoParameters = event.data.allowMicAutoParams;\n\t}\n\n\tonCallViewChangeFaceImprove(event)\n\t{\n\t\tif (!DesktopApi.isDesktop())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tDesktopApi.setCameraSmoothingStatus(event.data.faceImproveEnabled);\n\t}\n\n\tonCallViewUserRename(event)\n\t{\n\t\tconst newName = event.data.newName;\n\n\t\tif (!this.isExternalUser())\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tif (Utils.device.isMobile())\n\t\t{\n\t\t\tthis.renameGuestMobile(newName)\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.renameGuest(newName);\n\t\t}\n\t}\n\n\tonCallViewUserPinned(event)\n\t{\n\t\tif (event.data.userId)\n\t\t{\n\t\t\tthis.updateCallUser(event.data.userId, {pinned: true});\n\n\t\t\treturn true;\n\t\t}\n\n\t\tthis.controller.getStore().dispatch('call/unpinUser');\n\n\t\treturn true;\n\t}\n\n\tonCallToggleSubscribe(e) {\n\t\tif (this.currentCall && this.currentCall.provider === Call.Provider.Bitrix && e.data)\n\t\t{\n\t\t\tthis.currentCall.toggleRemoteParticipantVideo(e.data.participantIds, e.data.showVideo, true)\n\t\t}\n\t}\n\n\trenameGuest(newName)\n\t{\n\t\tthis.callView.localUser.userModel.renameRequested = true;\n\t\tthis.setUserName(newName).then(() => {\n\t\t\tthis.callView.localUser.userModel.wasRenamed = true;\n\t\t\tLogger.log('setting name to', newName);\n\t\t}).catch(error => {\n\t\t\tLogger.error('error setting name', error);\n\t\t});\n\t}\n\n\trenameGuestMobile(newName)\n\t{\n\t\tthis.setUserName(newName).then(() => {\n\t\t\tLogger.log('setting mobile name to', newName);\n\t\t\tif (this.callView.renameSlider)\n\t\t\t{\n\t\t\t\tthis.callView.renameSlider.close();\n\t\t\t}\n\t\t}).catch(error => {\n\t\t\tLogger.error('error setting name', error);\n\t\t});\n\t}\n\n\tonCallButtonClick(event)\n\t{\n\t\tconst buttonName = event.data.buttonName;\n\t\tLogger.warn('Button clicked!', buttonName);\n\n\t\tconst handlers = {\n\t\t\thangup: this.onCallViewHangupButtonClick.bind(this),\n\t\t\thangupOptions: this._onCallViewHangupOptionsButtonClick.bind(this),\n\t\t\tclose: this.onCallViewCloseButtonClick.bind(this),\n\t\t\t//inviteUser: this.onCallViewInviteUserButtonClick.bind(this),\n\t\t\ttoggleMute: this.onCallViewToggleMuteButtonClick.bind(this),\n\t\t\ttoggleScreenSharing: this.onCallViewToggleScreenSharingButtonClick.bind(this),\n\t\t\trecord: this.onCallViewRecordButtonClick.bind(this),\n\t\t\ttoggleVideo: this.onCallViewToggleVideoButtonClick.bind(this),\n\t\t\ttoggleSpeaker: this.onCallViewToggleSpeakerButtonClick.bind(this),\n\t\t\tshowChat: this.onCallViewShowChatButtonClick.bind(this),\n\t\t\ttoggleUsers: this.onCallViewToggleUsersButtonClick.bind(this),\n\t\t\tshare: this.onCallViewShareButtonClick.bind(this),\n\t\t\tfullscreen: this.onCallViewFullScreenButtonClick.bind(this),\n\t\t\tfloorRequest: this.onCallViewFloorRequestButtonClick.bind(this),\n\t\t\tfeedback: this.onCallViewFeedbackButtonClick.bind(this),\n\t\t\tonUserClick: this.onCallUserClick.bind(this),\n\t\t\tcopilot: this.onCallCopilotButtonClick.bind(this),\n\t\t};\n\n\t\tif(handlers[buttonName])\n\t\t{\n\t\t\thandlers[buttonName](event);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tLogger.error('Button handler not found!', buttonName);\n\t\t}\n\t}\n\n\tonCallViewHangupButtonClick(e)\n\t{\n\t\tAnalytics.getInstance().onDisconnectCall({\n\t\t\tcallId: this.currentCall?.id,\n\t\t\tcallType: Analytics.AnalyticsType.videoconf,\n\t\t\tsubSection: Analytics.AnalyticsSubSection.finishButton,\n\t\t\tmediaParams: {\n\t\t\t\tvideo: Call.Hardware.isCameraOn,\n\t\t\t\taudio: !Call.Hardware.isMicrophoneMuted,\n\t\t\t},\n\t\t});\n\t\tthis.stopLocalVideoStream();\n\t\tthis.endCall();\n\t}\n\n\t_onCallViewHangupOptionsButtonClick()\n\t{\n\t\tif (this.hangupOptionsMenu)\n\t\t{\n\t\t\tthis.hangupOptionsMenu.destroy();\n\t\t\treturn;\n\t\t}\n\n\t\tconst targetNodeWidth = this.callView.buttons.hangupOptions.elements.root.offsetWidth;\n\n\t\tlet menuItems = [\n\t\t\t{\n\t\t\t\ttext: BX.message(\"CALL_M_BTN_HANGUP_OPTION_FINISH\"),\n\t\t\t\tonclick: () => {\n\t\t\t\t\tAnalytics.getInstance().onFinishCall({\n\t\t\t\t\t\tcallId: this.currentCall?.id,\n\t\t\t\t\t\tcallType: Analytics.AnalyticsType.videoconf,\n\t\t\t\t\t\tstatus: Analytics.AnalyticsStatus.finishedForAll,\n\t\t\t\t\t\tchatId: this.currentCall?.associatedEntity.id,\n\t\t\t\t\t\tcallUsersCount: this.getCallUsers(true).length,\n\t\t\t\t\t\tcallLength: Call.Util.getTimeText(this.currentCall?.startDate),\n\t\t\t\t\t});\n\n\t\t\t\t\tthis.stopLocalVideoStream();\n\t\t\t\t\tthis.endCall(true);\n\t\t\t\t},\n\t\t\t},\n\t\t\t{\n\t\t\t\ttext: BX.message(\"CALL_M_BTN_HANGUP_OPTION_LEAVE\"),\n\t\t\t\tonclick: () => {\n\t\t\t\t\tAnalytics.getInstance().onDisconnectCall({\n\t\t\t\t\t\tcallId: this.currentCall?.id,\n\t\t\t\t\t\tcallType: Analytics.AnalyticsType.videoconf,\n\t\t\t\t\t\tsubSection: Analytics.AnalyticsSubSection.contextMenu,\n\t\t\t\t\t\tmediaParams: {\n\t\t\t\t\t\t\tvideo: Call.Hardware.isCameraOn,\n\t\t\t\t\t\t\taudio: !Call.Hardware.isMicrophoneMuted,\n\t\t\t\t\t\t},\n\t\t\t\t\t});\n\t\t\t\t\tthis.stopLocalVideoStream();\n\t\t\t\t\tthis.endCall(false);\n\t\t\t\t},\n\t\t\t},\n\t\t];\n\n\t\tthis.hangupOptionsMenu = new BX.PopupMenuWindow({\n\t\t\tclassName: 'bx-messenger-videocall-hangup-options-container',\n\t\t\tbackground: '#22272B',\n\t\t\tcontentBackground: '#22272B',\n\t\t\tdarkMode: true,\n\t\t\tcontentBorderRadius: '6px',\n\t\t\tangle: false,\n\t\t\tbindElement: this.callView.buttons.hangupOptions.elements.root,\n\t\t\ttargetContainer: this.container,\n\t\t\toffsetTop: -15,\n\t\t\tbindOptions: {position: \"top\"},\n\t\t\tcacheable: false,\n\t\t\tsubMenuOptions: {\n\t\t\t\tmaxWidth: 450\n\t\t\t},\n\t\t\tevents: {\n\t\t\t\tonShow: (event) =>\n\t\t\t\t{\n\t\t\t\t\tconst popup = event.getTarget();\n\t\t\t\t\tpopup.getPopupContainer().style.display = 'block'; // bad hack\n\n\t\t\t\t\tconst offsetLeft = (targetNodeWidth / 2) - popup.getPopupContainer().offsetWidth / 2;\n\t\t\t\t\tpopup.setOffset({offsetLeft: offsetLeft + 40, offsetTop: 0});\n\t\t\t\t\tpopup.setAngle({offset: popup.getPopupContainer().offsetWidth / 2 - 17});\n\t\t\t\t},\n\t\t\t\tonDestroy: () => this.hangupOptionsMenu = null\n\t\t\t},\n\t\t\titems: menuItems,\n\t\t});\n\n\t\tthis.hangupOptionsMenu.show();\n\t}\n\n\tonCallViewCloseButtonClick(e)\n\t{\n\t\tthis.stopLocalVideoStream();\n\t\tthis.endCall();\n\t}\n\n\tonCallViewToggleMuteButtonClick(event)\n\t{\n\t\tif (!Call.Hardware.hasMicrophone() &&  !event.data.muted)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tAnalytics.getInstance().onToggleMicrophone({\n\t\t\tmuted: event.data.muted,\n\t\t\tcallId: this.currentCall ? this.currentCall.id : 0,\n\t\t\tcallType: Analytics.AnalyticsType.videoconf,\n\t\t});\n\n\t\tif (this.currentCall && !this.currentCall.microphoneId && !event.data.muted)\n\t\t{\n\t\t\tthis.currentCall.setMicrophoneId(Call.Hardware.defaultMicrophone);\n\t\t}\n\n\t\tCall.Hardware.isMicrophoneMuted = event.data.muted;\n\t\tif (!this.currentCall)\n\t\t{\n\t\t\tthis.template.$emit('setMicState', !event.data.muted);\n\t\t}\n\n\t\tif (this.isRecording())\n\t\t{\n\t\t\tBXDesktopSystem.CallRecordMute(event.data.muted);\n\t\t}\n\n\t\tif (this.currentCall?.userId)\n\t\t{\n\t\t\tthis.updateCallUser(this.currentCall.userId, {microphoneState: !event.data.muted});\n\t\t}\n\t}\n\n\tonCallViewToggleScreenSharingButtonClick()\n\t{\n\t\tAnalytics.getInstance().onScreenShareBtnClick({\n\t\t\tcallId: this.currentCall.id,\n\t\t\tcallType: Analytics.AnalyticsType.videoconf,\n\t\t});\n\n\t\tif (this.getFeatureState('screenSharing') === ConferenceApplication.FeatureState.Limited)\n\t\t{\n\t\t\tthis.showFeatureLimitSlider('screenSharing');\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.getFeatureState('screenSharing') === ConferenceApplication.FeatureState.Disabled)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.currentCall.isScreenSharingStarted())\n\t\t{\n\t\t\tthis.currentCall.stopScreenSharing();\n\n\t\t\tif (this.isRecording())\n\t\t\t{\n\t\t\t\tBXDesktopSystem.CallRecordStopSharing();\n\t\t\t}\n\n\t\t\tif (this.floatingScreenShareWindow)\n\t\t\t{\n\t\t\t\tthis.floatingScreenShareWindow.close();\n\t\t\t}\n\n\t\t\tif (this.webScreenSharePopup)\n\t\t\t{\n\t\t\t\tthis.webScreenSharePopup.close();\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.restClient.callMethod(\"im.call.onShareScreen\", {callId: this.currentCall.id});\n\t\t\tthis.currentCall.startScreenSharing();\n\t\t}\n\t}\n\n\tonCallViewRecordButtonClick(event)\n\t{\n\t\tAnalytics.getInstance().onRecordBtnClick({\n\t\t\tcallId: this.currentCall.id,\n\t\t\tcallType: Analytics.AnalyticsType.videoconf,\n\t\t});\n\n\t\tif (event.data.recordState === Call.View.RecordState.Started)\n\t\t{\n\t\t\tif (this.getFeatureState('record') === ConferenceApplication.FeatureState.Limited)\n\t\t\t{\n\t\t\t\tthis.showFeatureLimitSlider('record');\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (this.getFeatureState('record') === ConferenceApplication.FeatureState.Disabled)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (this.canRecord())\n\t\t\t{\n\t\t\t\t// TODO: create popup menu with choice type of record - im/install/js/im/call/controller.js:1635\n\t\t\t\t// Call.View.RecordType.Video / Call.View.RecordType.Audio\n\n\t\t\t\tthis.callView.setButtonActive('record', true);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tif (window.BX.Helper)\n\t\t\t\t{\n\t\t\t\t\twindow.BX.Helper.show(\"redirect=detail&code=22079566\");\n\t\t\t\t}\n\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t\telse if (event.data.recordState === Call.View.RecordState.Paused)\n\t\t{\n\t\t\tif (this.canRecord())\n\t\t\t{\n\t\t\t\tBXDesktopSystem.CallRecordPause(true);\n\t\t\t}\n\t\t}\n\t\telse if (event.data.recordState === Call.View.RecordState.Resumed)\n\t\t{\n\t\t\tif (this.canRecord())\n\t\t\t{\n\t\t\t\tBXDesktopSystem.CallRecordPause(false);\n\t\t\t}\n\t\t}\n\t\telse if (event.data.recordState === Call.View.RecordState.Stopped)\n\t\t{\n\t\t\tthis.callView.setButtonActive('record', false);\n\t\t}\n\n\t\tthis.currentCall.sendRecordState({\n\t\t\taction: event.data.recordState,\n\t\t\tdate: new Date()\n\t\t});\n\n\t\tthis.callRecordState = event.data.recordState;\n\t}\n\n\tonCallViewToggleVideoButtonClick(event)\n\t{\n\t\tif (!Call.Hardware.hasCamera() &&  event.data.video)\n\t\t{\n\t\t\tthis.showNotification(BX.message('IM_CALL_NO_CAMERA_ERROR'));\n\t\t\treturn;\n\t\t}\n\n\t\tAnalytics.getInstance().onToggleCamera({\n\t\t\tvideo: event.data.video,\n\t\t\tcallId: this.currentCall ? this.currentCall.id : 0,\n\t\t\tcallType: Analytics.AnalyticsType.videoconf,\n\t\t});\n\n\t\tCall.Hardware.isCameraOn = event.data.video;\n\t\tif (this.currentCall)\n\t\t{\n\t\t\tif (!Call.Hardware.initialized)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif (event.data.video && Object.values(Call.Hardware.cameraList).length === 0)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif(!event.data.video)\n\t\t\t{\n\t\t\t\tthis.callView.releaseLocalMedia();\n\t\t\t}\n\n\t\t\tif (!this.currentCall.cameraId && event.data.video)\n\t\t\t{\n\t\t\t\tthis.currentCall.setCameraId(Call.Hardware.defaultCamera);\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.template.$emit('setCameraState', event.data.video);\n\t\t}\n\t}\n\n\tonCallViewToggleSpeakerButtonClick(event)\n\t{\n\t\tthis.callView.muteSpeaker(!event.data.speakerMuted);\n\n\t\tif (event.data.fromHotKey)\n\t\t{\n\t\t\tBX.UI.Notification.Center.notify({\n\t\t\t\tcontent: BX.message(this.callView.speakerMuted? 'IM_M_CALL_MUTE_SPEAKERS_OFF': 'IM_M_CALL_MUTE_SPEAKERS_ON'),\n\t\t\t\tposition: \"top-right\",\n\t\t\t\tautoHideDelay: 3000,\n\t\t\t\tcloseButton: true\n\t\t\t});\n\t\t}\n\t}\n\n\tonCallViewShareButtonClick()\n\t{\n\t\tlet notifyWidth = 400;\n\t\tif (Utils.device.isMobile() && document.body.clientWidth < 400)\n\t\t{\n\t\t\tnotifyWidth = document.body.clientWidth - 40;\n\t\t}\n\n\t\tBX.UI.Notification.Center.notify({\n\t\t\tcontent: Loc.getMessage('BX_IM_VIDEOCONF_LINK_COPY_DONE'),\n\t\t\tautoHideDelay: 4000,\n\t\t\twidth: notifyWidth\n\t\t});\n\n\t\tClipboard.copy(this.getDialogData().public.link);\n\t}\n\n\tonCallViewFullScreenButtonClick()\n\t{\n\t\tthis.toggleFullScreen();\n\t}\n\n\tonFloatingScreenShareBackToCallClick()\n\t{\n\t\tBXDesktopWindow.ExecuteCommand('show.active')\n\t\tif (this.floatingScreenShareWindow)\n\t\t{\n\t\t\tthis.floatingScreenShareWindow.hide();\n\t\t}\n\t}\n\n\tonFloatingScreenShareStopClick()\n\t{\n\t\tBXDesktopWindow.ExecuteCommand('show.active')\n\t\tthis.onCallViewToggleScreenSharingButtonClick();\n\t}\n\n\tonFloatingScreenShareChangeScreenClick()\n\t{\n\t\tif (this.currentCall)\n\t\t{\n\t\t\tthis.currentCall.startScreenSharing(true);\n\t\t}\n\t}\n\n\tonWindowFocus()\n\t{\n\t\tif (this.floatingScreenShareWindow)\n\t\t{\n\t\t\tthis.floatingScreenShareWindow.hide();\n\t\t}\n\t}\n\n\tonWindowBlur()\n\t{\n\t\tif(this.floatingScreenShareWindow && this.currentCall && this.currentCall.isScreenSharingStarted())\n\t\t{\n\t\t\tthis.floatingScreenShareWindow.show();\n\t\t}\n\t}\n\n\tisFullScreen ()\n\t{\n\t\tif (\"webkitFullscreenElement\" in document)\n\t\t{\n\t\t\treturn (!!document.webkitFullscreenElement);\n\t\t}\n\t\telse if (\"fullscreenElement\" in document)\n\t\t{\n\t\t\treturn (!!document.fullscreenElement);\n\t\t}\n\t\treturn false;\n\t}\n\n\ttoggleFullScreen ()\n\t{\n\t\tif(this.isFullScreen())\n\t\t{\n\t\t\tthis.exitFullScreen();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.enterFullScreen();\n\t\t}\n\t}\n\n\tenterFullScreen ()\n\t{\n\t\tif (BX.browser.IsChrome() || BX.browser.IsSafari())\n\t\t{\n\t\t\tdocument.body.webkitRequestFullScreen();\n\t\t}\n\t\telse if (BX.browser.IsFirefox())\n\t\t{\n\t\t\tdocument.body.requestFullscreen();\n\t\t}\n\t}\n\n\texitFullScreen()\n\t{\n\t\tif (document.cancelFullScreen)\n\t\t{\n\t\t\tdocument.cancelFullScreen();\n\t\t}\n\t\telse if (document.mozCancelFullScreen)\n\t\t{\n\t\t\tdocument.mozCancelFullScreen();\n\t\t}\n\t\telse if (document.webkitCancelFullScreen)\n\t\t{\n\t\t\tdocument.webkitCancelFullScreen();\n\t\t}\n\t\telse if (document.document.exitFullscreen())\n\t\t{\n\t\t\tdocument.exitFullscreen()\n\t\t}\n\t}\n\n\tonCallViewShowChatButtonClick()\n\t{\n\t\tAnalytics.getInstance().onShowChat({\n\t\t\tcallId: this.currentCall?.id,\n\t\t\tcallType: Analytics.AnalyticsType.videoconf,\n\t\t});\n\n\t\tthis.toggleChat();\n\t}\n\n\tonCallViewToggleUsersButtonClick()\n\t{\n\t\tthis.toggleUserList();\n\t}\n\n\tonCallViewFeedbackButtonClick()\n\t{\n\t\tBX.loadExt('ui.feedback.form').then(() => {\n\t\t\tBX.UI.Feedback.Form.open({\n\t\t\t\tid: `call_feedback_${this.currentCall.id}-${this.currentCall.instanceId}-${Math.random()}`,\n\t\t\t\tforms: [\n\t\t\t\t\t{ zones: ['ru', 'by', 'kz'], id: 406, sec: '9lhjhn', lang: 'ru' },\n\t\t\t\t\t{ zones: ['de'], id: 754, sec: '6upe49', lang: 'de' },\n\t\t\t\t\t{ zones: ['es'], id: 750, sec: 'whk4la', lang: 'es' },\n\t\t\t\t\t{ zones: ['com.br'], id: 752, sec: 'is01cs', lang: 'com.br' },\n\t\t\t\t\t{ zones: ['en'], id: 748, sec: 'pds0h6', lang: 'en' },\n\t\t\t\t],\n\t\t\t\tpresets: {\n\t\t\t\t\tsender_page: 'call',\n\t\t\t\t\tcall_type: this.currentCall.provider,\n\t\t\t\t\tcall_amount: this.currentCall.users.length + 1,\n\t\t\t\t\tcall_id: `id: ${this.currentCall.id}, instanceId: ${this.currentCall.instanceId}`,\n\t\t\t\t\tid_of_user: this.currentCall.userId,\n\t\t\t\t\tfrom_domain: location.origin\n\t\t\t\t},\n\t\t\t});\n\t\t})\n\t}\n\n\tonCallUserClick(e)\n\t{\n\t\tAnalytics.getInstance().onClickUser({\n\t\t\tcallId: this.currentCall.id,\n\t\t\tcallType: Analytics.AnalyticsType.videoconf,\n\t\t\tlayout: Object.keys(Call.View.Layout).find(key => Call.View.Layout[key] === e.layout),\n\t\t});\n\t}\n\n\tonCallCopilotButtonClick()\n\t{\n\t\tthis.onChangeStateCopilot();\n\n\t\t/* if (!Call.Util.isAIServiceEnabled())\n\t\t{\n\t\t\tBX.SidePanel.Instance.open(CallAI.serviceEnabled, {\n\t\t\t\tcacheable: false\n\t\t\t});\n\t\t\treturn;\n\t\t}\n\n\t\tthis.copilotPopup = new Call.CopilotPopup({\n\t\t\tisCopilotActive: this.currentCall.isCopilotActive,\n\t\t\tisCopilotFeaturesEnabled: this.currentCall.isCopilotFeaturesEnabled,\n\t\t\tupdateCopilotState: () => {\n\t\t\t\tthis.onChangeStateCopilot();\n\t\t\t},\n\t\t\tonClose: () => {\n\t\t\t\tthis.copilotPopup = null;\n\t\t\t}\n\t\t});\n\n\t\tif (this.copilotPopup)\n\t\t{\n\t\t\tthis.copilotPopup.toggle();\n\t\t} */\n\t}\n\n\tonUpdateCallCopilotState({ isTrackRecordOn })\n\t{\n\t\tthis.currentCall.isCopilotActive = isTrackRecordOn;\n\t\tthis.callView.updateCopilotState(this.currentCall.isCopilotActive);\n\t}\n\n\tonChangeStateCopilot()\n\t{\n\t\tconst action = !this.currentCall.isCopilotActive ? 'call.Track.start' : 'call.Track.stop';\n\t\tBX.ajax.runAction(action, {\n\t\t\tdata: { callId: this.currentCall.id }\n\t\t}).then(() => {\n\t\t\tthis.onUpdateCallCopilotState({\n\t\t\t\tisTrackRecordOn: !this.currentCall.isCopilotActive,\n\t\t\t});\n\t\t});\n\t}\n\n\tonCallViewFloorRequestButtonClick()\n\t{\n\t\tAnalytics.getInstance().onFloorRequest({\n\t\t\tcallId: this.currentCall.id,\n\t\t\tcallType: Analytics.AnalyticsType.videoconf,\n\t\t});\n\n\t\tconst floorState = this.callView.getUserFloorRequestState(Call.Engine.getCurrentUserId());\n\t\tconst talkingState = this.callView.getUserTalking(Call.Engine.getCurrentUserId());\n\n\t\tthis.callView.setUserFloorRequestState(Call.Engine.getCurrentUserId(), !floorState);\n\n\t\tif (this.currentCall)\n\t\t{\n\t\t\tthis.currentCall.requestFloor(!floorState);\n\t\t}\n\n\t\tclearTimeout(this.callViewFloorRequestTimeout);\n\t\tif (talkingState && !floorState)\n\t\t{\n\t\t\tthis.callViewFloorRequestTimeout = setTimeout(() =>\n\t\t\t{\n\t\t\t\tif (this.currentCall)\n\t\t\t\t{\n\t\t\t\t\tthis.currentCall.requestFloor(false);\n\t\t\t\t}\n\t\t\t}, 1500);\n\t\t}\n\t}\n\n\tbindCallEvents()\n\t{\n\t\tthis.currentCall.addEventListener(Call.Event.onUserInvited, this.onCallUserInvitedHandler);\n\t\tthis.currentCall.addEventListener(Call.Event.onDestroy, this.onCallDestroyHandler);\n\t\tthis.currentCall.addEventListener(Call.Event.onUserStateChanged, this.onCallUserStateChangedHandler);\n\t\tthis.currentCall.addEventListener(Call.Event.onUserMicrophoneState, this.onCallUserMicrophoneStateHandler);\n\t\tthis.currentCall.addEventListener(Call.Event.onUserCameraState, this.onCallUserCameraStateHandler);\n\t\tthis.currentCall.addEventListener(Call.Event.onNeedResetMediaDevicesState, this.onNeedResetMediaDevicesStateHandler);\n\t\tthis.currentCall.addEventListener(Call.Event.onUserVideoPaused, this.onCallUserVideoPausedHandler);\n\t\tthis.currentCall.addEventListener(Call.Event.onLocalMediaReceived, this.onCallLocalMediaReceivedHandler);\n\t\tthis.currentCall.addEventListener(Call.Event.onRemoteMediaReceived, this.onCallRemoteMediaReceivedHandler);\n\t\tthis.currentCall.addEventListener(Call.Event.onRemoteMediaStopped, this.onCallRemoteMediaStoppedHandler);\n\t\tthis.currentCall.addEventListener(Call.Event.onUserVoiceStarted, this.onCallUserVoiceStartedHandler);\n\t\tthis.currentCall.addEventListener(Call.Event.onUserVoiceStopped, this.onCallUserVoiceStoppedHandler);\n\t\tthis.currentCall.addEventListener(Call.Event.onUserStatsReceived, this.onUserStatsReceivedHandler);\n\t\tthis.currentCall.addEventListener(Call.Event.onUserScreenState, this.onCallUserScreenStateHandler);\n\t\tthis.currentCall.addEventListener(Call.Event.onUserRecordState, this.onCallUserRecordStateHandler);\n\t\tthis.currentCall.addEventListener(Call.Event.onUserFloorRequest, this.onCallUserFloorRequestHandler);\n\t\tthis.currentCall.addEventListener(Call.Event.onMicrophoneLevel, this.onMicrophoneLevelHandler);\n\t\t//this.currentCall.addEventListener(Call.Event.onDeviceListUpdated, this._onCallDeviceListUpdatedHandler);\n\t\tthis.currentCall.addEventListener(Call.Event.onCallFailure, this.onCallFailureHandler);\n\t\tthis.currentCall.addEventListener(Call.Event.onJoin, this._onCallJoinHandler);\n\t\tthis.currentCall.addEventListener(Call.Event.onLeave, this.onCallLeaveHandler);\n\t\tthis.currentCall.addEventListener(Call.Event.onReconnecting, this.onReconnectingHandler);\n\t\tthis.currentCall.addEventListener(Call.Event.onReconnected, this.onReconnectedHandler);\n\t\tthis.currentCall.addEventListener(Call.Event.onUpdateLastUsedCameraId, this.onUpdateLastUsedCameraIdHandler);\n\t\tthis.currentCall.addEventListener(Call.Event.onConnectionQualityChanged, this.onCallConnectionQualityChangedHandler);\n\t\tthis.currentCall.addEventListener(Call.Event.onToggleRemoteParticipantVideo, this.onCallToggleRemoteParticipantVideoHandler);\n\t\tthis.currentCall.addEventListener(Call.Event.onGetUserMediaEnded, this._onGetUserMediaEndedHandler);\n\t\tthis.currentCall.addEventListener(Call.Event.onSwitchTrackRecordStatus, this._onSwitchTrackRecordStatusHandler);\n\t}\n\n\tremoveCallEvents()\n\t{\n\t\tthis.currentCall.removeEventListener(Call.Event.onUserInvited, this.onCallUserInvitedHandler);\n\t\tthis.currentCall.removeEventListener(Call.Event.onDestroy, this.onCallDestroyHandler);\n\t\tthis.currentCall.removeEventListener(Call.Event.onUserStateChanged, this.onCallUserStateChangedHandler);\n\t\tthis.currentCall.removeEventListener(Call.Event.onUserMicrophoneState, this.onCallUserMicrophoneStateHandler);\n\t\tthis.currentCall.removeEventListener(Call.Event.onUserCameraState, this.onCallUserCameraStateHandler);\n\t\tthis.currentCall.removeEventListener(Call.Event.onNeedResetMediaDevicesState, this.onNeedResetMediaDevicesStateHandler);\n\t\tthis.currentCall.removeEventListener(Call.Event.onUserVideoPaused, this.onCallUserVideoPausedHandler);\n\t\tthis.currentCall.removeEventListener(Call.Event.onLocalMediaReceived, this.onCallLocalMediaReceivedHandler);\n\t\tthis.currentCall.removeEventListener(Call.Event.onRemoteMediaReceived, this.onCallRemoteMediaReceivedHandler);\n\t\tthis.currentCall.removeEventListener(Call.Event.onRemoteMediaStopped, this.onCallRemoteMediaStoppedHandler);\n\t\tthis.currentCall.removeEventListener(Call.Event.onUserVoiceStarted, this.onCallUserVoiceStartedHandler);\n\t\tthis.currentCall.removeEventListener(Call.Event.onUserVoiceStopped, this.onCallUserVoiceStoppedHandler);\n\t\tthis.currentCall.removeEventListener(Call.Event.onUserStatsReceived, this.onUserStatsReceivedHandler);\n\t\tthis.currentCall.removeEventListener(Call.Event.onUserScreenState, this.onCallUserScreenStateHandler);\n\t\tthis.currentCall.removeEventListener(Call.Event.onUserRecordState, this.onCallUserRecordStateHandler);\n\t\tthis.currentCall.removeEventListener(Call.Event.onUserFloorRequest, this.onCallUserFloorRequestHandler);\n\t\tthis.currentCall.removeEventListener(Call.Event.onMicrophoneLevel, this.onMicrophoneLevelHandler);\n\t\tthis.currentCall.removeEventListener(Call.Event.onConnectionQualityChanged, this.onCallConnectionQualityChangedHandler);\n\t\tthis.currentCall.removeEventListener(Call.Event.onToggleRemoteParticipantVideo, this.onCallToggleRemoteParticipantVideoHandler);\n\t\t//this.currentCall.removeEventListener(Call.Event.onDeviceListUpdated, this._onCallDeviceListUpdatedHandler);\n\t\tthis.currentCall.removeEventListener(Call.Event.onCallFailure, this.onCallFailureHandler);\n\t\tthis.currentCall.removeEventListener(Call.Event.onLeave, this.onCallLeaveHandler);\n\t\tthis.currentCall.removeEventListener(Call.Event.onReconnecting, this.onReconnectingHandler);\n\t\tthis.currentCall.removeEventListener(Call.Event.onReconnected, this.onReconnectedHandler);\n\t\tthis.currentCall.addEventListener(Call.Event.onUpdateLastUsedCameraId, this.onUpdateLastUsedCameraIdHandler);\n\t\tthis.currentCall.removeEventListener(Call.Event.onGetUserMediaEnded, this._onGetUserMediaEndedHandler);\n\t\tthis.currentCall.removeEventListener(Call.Event.onSwitchTrackRecordStatus, this._onSwitchTrackRecordStatusHandler);\n\t}\n\n\tonCallUserInvited(e)\n\t{\n\t\tthis.callView.addUser(e.userId);\n\n\t\tCall.Util.getUsers(this.currentCall.id, [e.userId]).then(userData => {\n\t\t\tthis.controller.getStore().dispatch('users/set', Object.values(userData));\n\t\t\tthis.controller.getStore().dispatch('conference/setUsers', {users: Object.keys(userData)});\n\t\t\tthis.callView.updateUserData(userData)\n\t\t});\n\t}\n\n\tonCallUserStateChanged(e)\n\t{\n\t\tif (e.state !== Call.UserState.Connected && this.loopTimers[e.userId] === undefined)\n\t\t{\n\t\t\tthis.loopConnectionQuality(e.userId, 1);\n\t\t}\n\n\t\tif (e.state === Call.UserState.Connected)\n\t\t{\n\t\t\tthis.clearConnectionQualityTimer(e.userId);\n\t\t\tthis.callView.setUserConnectionQuality(e.userId, 5);\n\n\t\t\tif (false && CallAI.serviceEnabled)\n\t\t\t{\n\t\t\t\tthis.callView.unblockButtons(['copilot']);\n\t\t\t}\n\t\t}\n\n\t\tif (\n\t\t\te.state === Call.UserState.Ready\n\t\t\t&& e.previousState === Call.UserState.Connected\n\t\t\t&& !Object.keys(this.currentCall).includes(e.userId)\n\t\t)\n\t\t{\n\t\t\te.state = Call.UserState.Idle;\n\t\t}\n\n\t\tthis.callView.setUserState(e.userId, e.state);\n\t\tthis.updateCallUser(e.userId,{state: e.state});\n\n\t\tif (!this.isRecording())\n\t\t{\n\t\t\tthis.callView.getConnectedUserCount(false)\n\t\t\t\t? this.callView.unblockButtons(['record'])\n\t\t\t\t: this.callView.blockButtons(['record'])\n\t\t\t;\n\t\t}\n\t\t/*if (e.direction)\n\t\t{\n\t\t\tthis.callView.setUserDirection(e.userId, e.direction);\n\t\t}*/\n\t}\n\n\tonCallUserMicrophoneState(e)\n\t{\n\t\tif (e.userId == this.currentCall.userId)\n\t\t{\n\t\t\tCall.Hardware.isMicrophoneMuted = !e.microphoneState;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.callView.setUserMicrophoneState(e.userId, e.microphoneState);\n\t\t\tthis.updateCallUser(e.userId, {microphoneState: e.microphoneState});\n\t\t}\n\t}\n\n\tonCallUserCameraState(e)\n\t{\n\t\tthis.callView.setUserCameraState(e.userId, e.cameraState);\n\t\tthis.updateCallUser(e.userId, {cameraState: e.cameraState});\n\t}\n\n\tonNeedResetMediaDevicesState(e)\n\t{\n\t\tCall.Hardware.isMicrophoneMuted = true;\n\t\tCall.Hardware.isCameraOn = false;\n\t}\n\n\tonCallUserVideoPaused(e)\n\t{\n\t\tthis.callView.setUserVideoPaused(e.userId, e.videoPaused);\n\t}\n\n\tonCallLocalMediaReceived(e)\n\t{\n\t\tconsole.log(\"Received local media stream \" + e);\n\t\tif (this.callView)\n\t\t{\n\t\t\tconst flipVideo = (e.tag == \"main\" || e.mediaRenderer) ? Call.Hardware.enableMirroring : false;\n\n\t\t\tthis.callView.setLocalStream(e);\n\t\t\tthis.callView.flipLocalVideo(flipVideo);\n\n\t\t\tthis.callView.setButtonActive(\"screen\", this.currentCall.isScreenSharingStarted());\n\t\t\tif (this.currentCall.isScreenSharingStarted())\n\t\t\t{\n\t\t\t\tthis.screenShareStartTime = new Date();\n\t\t\t\tAnalytics.getInstance().onScreenShareStarted({\n\t\t\t\t\tcallId: this.currentCall.id,\n\t\t\t\t\tcallType: Analytics.AnalyticsType.videoconf,\n\t\t\t\t});\n\n\t\t\t\tif (!DesktopApi.isDesktop())\n\t\t\t\t{\n\t\t\t\t\tthis.showWebScreenSharePopup();\n\t\t\t\t}\n\n\t\t\t\tthis.callView.updateButtons();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tAnalytics.getInstance().onScreenShareStopped({\n\t\t\t\t\tcallId: this.currentCall.id,\n\t\t\t\t\tcallType: Analytics.AnalyticsType.videoconf,\n\t\t\t\t\tstatus: Analytics.AnalyticsStatus.success,\n\t\t\t\t\tscreenShareLength: Call.Util.getTimeText(this.screenShareStartTime),\n\t\t\t\t});\n\t\t\t\tthis.screenShareStartTime = null;\n\n\t\t\t\tif (this.floatingScreenShareWindow)\n\t\t\t\t{\n\t\t\t\t\tthis.floatingScreenShareWindow.close();\n\t\t\t\t}\n\n\t\t\t\tif (this.webScreenSharePopup)\n\t\t\t\t{\n\t\t\t\t\tthis.webScreenSharePopup.close();\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif(!this.currentCall.callFromMobile && !this.isViewerMode())\n\t\t\t{\n\t\t\t\tthis.checkAvailableCamera();\n\t\t\t\tthis.checkAvailableMicrophone();\n\t\t\t}\n\t\t}\n\n\t\tif (this.currentCall && Call.Hardware.isCameraOn && e.tag === 'main' && e.stream.getVideoTracks().length === 0)\n\t\t{\n\t\t\tCall.Hardware.isCameraOn = false;\n\t\t}\n\t}\n\n\tonCallRemoteMediaReceived(e)\n\t{\n\t\tconst getStreamType = (stream) =>\n\t\t{\n\t\t\tif (stream?.getVideoTracks()?.length)\n\t\t\t{\n\t\t\t\treturn 'video';\n\t\t\t}\n\n\t\t\tif (stream?.getAudioTracks()?.length)\n\t\t\t{\n\t\t\t\treturn 'audio';\n\t\t\t}\n\n\t\t\treturn null;\n\t\t}\n\n\t\tif (this.callView)\n\t\t{\n\t\t\tif ('track' in e)\n\t\t\t{\n\t\t\t\tthis.callView.setUserMedia(e.userId, e.kind, e.track)\n\t\t\t}\n\t\t\tif ('mediaRenderer' in e && e.mediaRenderer.kind === 'audio' && getStreamType(e.mediaRenderer.stream) === 'audio')\n\t\t\t{\n\t\t\t\tthis.callView.setUserMedia(e.userId, 'audio', e.mediaRenderer.stream.getAudioTracks()[0]);\n\t\t\t}\n\t\t\tif ('mediaRenderer' in e && e.mediaRenderer.kind === 'sharing' && getStreamType(e.mediaRenderer.stream) === 'audio')\n\t\t\t{\n\t\t\t\tthis.callView.setUserMedia(e.userId, 'sharingAudio', e.mediaRenderer.stream.getAudioTracks()[0]);\n\t\t\t}\n\t\t\tif ('mediaRenderer' in e && (e.mediaRenderer.kind === 'video' || e.mediaRenderer.kind === 'sharing') && getStreamType(e.mediaRenderer.stream) === 'video')\n\t\t\t{\n\t\t\t\tthis.callView.setVideoRenderer(e.userId, e.mediaRenderer);\n\t\t\t}\n\t\t}\n\t}\n\n\tonCallRemoteMediaStopped(e)\n\t{\n\t\tif (this.callView)\n\t\t{\n\t\t\tif ('mediaRenderer' in e)\n\t\t\t{\n\t\t\t\tif (e.kind === 'video' || e.kind === 'sharing')\n\t\t\t\t{\n\t\t\t\t\te.mediaRenderer.stream = null;\n\t\t\t\t\tthis.callView.setVideoRenderer(e.userId, e.mediaRenderer);\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.callView.setUserMedia(e.userId, e.kind, null);\n\t\t\t}\n\t\t}\n\t}\n\n\tloopConnectionQuality(userId, quality, timeout = 200)\n\t{\n\t\tif (this.callView)\n\t\t{\n\t\t\tthis.loopTimers[userId] = setTimeout(() => {\n\t\t\t\tthis.callView.setUserConnectionQuality(userId, quality);\n\t\t\t\tconst newQuality = quality >= 4 ? 1 : quality + 1;\n\t\t\t\tthis.loopConnectionQuality(userId, newQuality, timeout);\n\t\t\t}, timeout);\n\t\t}\n\t}\n\n\tclearConnectionQualityTimer(userId)\n\t{\n\t\tif (this.loopTimers[userId] !== undefined)\n\t\t{\n\t\t\tclearTimeout(this.loopTimers[userId]);\n\t\t\tdelete this.loopTimers[userId];\n\t\t}\n\t}\n\n\tonCallConnectionQualityChanged(e)\n\t{\n\t\tthis.clearConnectionQualityTimer(e.userId);\n\n\t\tthis.callView.setUserConnectionQuality(e.userId, e.score);\n\t}\n\n\tonGetUserMediaEnded()\n\t{\n\t\tthis.updateMediaDevices();\n\t}\n\n\tonCallToggleRemoteParticipantVideo(e)\n\t{\n\t\tif (this.toogleParticipantsVideoBaloon)\n\t\t{\n\t\t\tif (e.isVideoShown)\n\t\t\t{\n\t\t\t\tthis.toogleParticipantsVideoBaloon.close();\n\t\t\t}\n\n\t\t\treturn;\n\t\t}\n\n\t\tif (!e.isVideoShown)\n\t\t{\n\t\t\tthis.toogleParticipantsVideoBaloon = BX.UI.Notification.Center.notify({\n\t\t\t\tcontent: Text.encode(BX.message('IM_M_CALL_REMOTE_PARTICIPANTS_VIDEO_MUTED')),\n\t\t\t\tautoHide: false,\n\t\t\t\tposition: \"top-right\",\n\t\t\t\tcloseButton: false,\n\t\t\t})\n\t\t}\n\t}\n\n\tonCallUserVoiceStarted(e)\n\t{\n\t\tif (e.local)\n\t\t{\n\t\t\tif (this.currentCall.muted && this.allowMutePopup)\n\t\t\t{\n\t\t\t\tthis.showMicMutedNotification();\n\t\t\t}\n\t\t\treturn;\n\t\t}\n\n\t\tthis.callView.setUserTalking(e.userId, true);\n\t\tthis.callView.setUserFloorRequestState(e.userId, false);\n\t\tthis.updateCallUser(e.userId, {talking: true, floorRequestState: false});\n\t}\n\n\tonCallUserVoiceStopped(e)\n\t{\n\t\tthis.callView.setUserTalking(e.userId, false);\n\t\tthis.updateCallUser(e.userId, {talking: false});\n\t}\n\n\tonUserStatsReceived(e)\n\t{\n\t\tif (this.callView)\n\t\t{\n\t\t\tthis.callView.setUserStats(e.userId, e.report);\n\t\t}\n\t}\n\n\tonCallUserScreenState(e)\n\t{\n\t\tif(this.callView)\n\t\t{\n\t\t\tthis.callView.setUserScreenState(e.userId, e.screenState);\n\t\t}\n\t\tthis.updateCallUser(e.userId, {screenState: e.screenState});\n\t}\n\n\tonCallUserRecordState(event)\n\t{\n\t\tthis.callRecordState = event.recordState.state;\n\t\tthis.callView.setRecordState(event.recordState);\n\n\t\tif (!this.canRecord() || event.userId != this.controller.getUserId())\n\t\t{\n\t\t\treturn true;\n\t\t}\n\n\t\tif (event.recordState.state !== Call.View.RecordState.Stopped)\n\t\t{\n\t\t\tthis.callRecordInfo = event.recordState;\n\t\t}\n\n\t\tif (\n\t\t\tevent.recordState.state === Call.View.RecordState.Started\n\t\t\t&& event.recordState.userId == this.controller.getUserId()\n\t\t)\n\t\t{\n\t\t\tconst windowId = window.bxdWindowId || window.document.title;\n\t\t\tlet fileName = BX.message('IM_CALL_RECORD_NAME');\n\t\t\tlet dialogId = this.currentCall.associatedEntity.id;\n\t\t\tlet dialogName = this.currentCall.associatedEntity.name;\n\t\t\tlet callId = this.currentCall.id;\n\t\t\tlet callDate = BX.Main.Date.format(this.params.formatRecordDate || 'd.m.Y');\n\n\t\t\tif (fileName)\n\t\t\t{\n\t\t\t\tfileName = fileName\n\t\t\t\t\t.replace('#CHAT_TITLE#', dialogName)\n\t\t\t\t\t.replace('#CALL_ID#', callId)\n\t\t\t\t\t.replace('#DATE#', callDate)\n\t\t\t\t;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tfileName = \"call_record_\"+this.currentCall.id;\n\t\t\t}\n\n\t\t\tCall.Engine.getRestClient().callMethod(\"im.call.onStartRecord\", {callId: this.currentCall.id});\n\n\t\t\tAnalytics.getInstance().onRecordStart({\n\t\t\t\tcallId: this.currentCall.id,\n\t\t\t\tcallType: Analytics.AnalyticsType.videoconf,\n\t\t\t});\n\n\t\t\tBXDesktopSystem.CallRecordStart({\n\t\t\t\twindowId,\n\t\t\t\tfileName,\n\t\t\t\tcallId,\n\t\t\t\tcallDate,\n\t\t\t\tdialogId,\n\t\t\t\tdialogName,\n\t\t\t\tmuted: Call.Hardware.isMicrophoneMuted,\n\t\t\t\tcropTop: 72,\n\t\t\t\tcropBottom: 90,\n\t\t\t\tshareMethod: 'im.disk.record.share'\n\t\t\t});\n\t\t}\n\t\telse if (event.recordState.state === Call.View.RecordState.Stopped)\n\t\t{\n\t\t\tAnalytics.getInstance().onRecordStop({\n\t\t\t\tcallId: this.currentCall.id,\n\t\t\t\tcallType: Analytics.AnalyticsType.videoconf,\n\t\t\t\tsubSection: Analytics.AnalyticsSubSection.window,\n\t\t\t\telement: Analytics.AnalyticsElement.recordButton,\n\t\t\t\trecordTime: Call.Util.getRecordTimeText(this.callRecordInfo),\n\t\t\t});\n\t\t\tthis.callRecordInfo = null;\n\n\t\t\tBXDesktopSystem.CallRecordStop();\n\t\t}\n\n\t\treturn true;\n\t}\n\n\tonCallUserFloorRequest(e)\n\t{\n\t\tthis.callView.setUserFloorRequestState(e.userId, e.requestActive);\n\t\tthis.updateCallUser(e.userId, {floorRequestState: e.requestActive});\n\t}\n\n\tonMicrophoneLevel(e)\n\t{\n\t\tthis.callView.setMicrophoneLevel(e.level);\n\t}\n\n\tonCallJoin(e)\n\t{\n\t\tif (!e.local)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (!this.isViewerMode())\n\t\t{\n\t\t\tthis.callView.unblockButtons(['floorRequest', 'screen']);\n\t\t\tthis.checkAvailableCamera();\n\t\t\tthis.checkAvailableMicrophone();\n\t\t}\n\n\t\tif (this.callView.getConnectedUserCount(false))\n\t\t{\n\t\t\tthis.callView.unblockButtons(['record']);\n\t\t}\n\n\t\tthis.callView.setUiState(Call.View.UiState.Connected);\n\t}\n\n\tonCallFailure(e)\n\t{\n\t\tthis.setConferenceHasErrorInCall(true);\n\t\tconst errorCode = e.code || e.name || e.error;\n\n\t\tlet errorMessage;\n\n\t\tif (e.name == \"VoxConnectionError\" || e.name == \"AuthResult\")\n\t\t{\n\t\t\tCall.Util.reportConnectionResult(e.call.id, false);\n\t\t}\n\n\t\tif (e.name == \"AuthResult\" || errorCode == \"AUTHORIZE_ERROR\")\n\t\t{\n\t\t\terrorMessage = BX.message(\"IM_CALL_ERROR_AUTHORIZATION\");\n\t\t}\n\t\telse if (e.name == \"Failed\" && errorCode == 403)\n\t\t{\n\t\t\terrorMessage = BX.message(\"IM_CALL_ERROR_HARDWARE_ACCESS_DENIED\");\n\t\t}\n\t\telse if (errorCode == \"ERROR_UNEXPECTED_ANSWER\")\n\t\t{\n\t\t\terrorMessage = BX.message(\"IM_CALL_ERROR_UNEXPECTED_ANSWER\");\n\t\t}\n\t\telse if (errorCode == \"BLANK_ANSWER_WITH_ERROR_CODE\")\n\t\t{\n\t\t\terrorMessage = BX.message(\"IM_CALL_ERROR_BLANK_ANSWER\");\n\t\t}\n\t\telse if (errorCode == \"BLANK_ANSWER\")\n\t\t{\n\t\t\terrorMessage = BX.message(\"IM_CALL_ERROR_BLANK_ANSWER\");\n\t\t}\n\t\telse if (errorCode == \"ACCESS_DENIED\")\n\t\t{\n\t\t\terrorMessage = BX.message(\"IM_CALL_ERROR_ACCESS_DENIED\");\n\t\t}\n\t\telse if (errorCode == \"NO_WEBRTC\")\n\t\t{\n\t\t\terrorMessage = this.isHttps ? BX.message(\"IM_CALL_NO_WEBRT\") : BX.message(\"IM_CALL_ERROR_HTTPS_REQUIRED\");\n\t\t}\n\t\telse if (errorCode == \"UNKNOWN_ERROR\")\n\t\t{\n\t\t\terrorMessage = BX.message(\"IM_CALL_ERROR_UNKNOWN\");\n\t\t}\n\t\telse if (errorCode == \"NETWORK_ERROR\")\n\t\t{\n\t\t\terrorMessage = BX.message(\"IM_CALL_ERROR_NETWORK\");\n\t\t}\n\t\telse if (errorCode == \"NotAllowedError\")\n\t\t{\n\t\t\terrorMessage = BX.message(\"IM_CALL_ERROR_HARDWARE_ACCESS_DENIED\");\n\t\t}\n\t\telse\n\t\t{\n\t\t\t//errorMessage = BX.message(\"IM_CALL_ERROR_HARDWARE_ACCESS_DENIED\");\n\t\t\terrorMessage = BX.message(\"IM_CALL_ERROR_UNKNOWN_WITH_CODE\").replace(\"#ERROR_CODE#\", errorCode);\n\t\t}\n\n\t\tif (this.callView)\n\t\t{\n\t\t\tthis.callView.showFatalError({text: errorMessage});\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.showNotification(errorMessage);\n\t\t}\n\n\t\tthis.autoCloseCallView = false;\n\t\tif (this.currentCall)\n\t\t{\n\t\t\tthis.removeVideoStrategy();\n\t\t\tthis.removeCallEvents();\n\n\t\t\tif (this.currentCallIsNew)\n\t\t\t{\n\t\t\t\tBX.CallEngine.getRestClient().callMethod('im.call.interrupt', {callId: this.currentCall.id});\n\t\t\t}\n\n\t\t\tthis.currentCall.destroy();\n\t\t\tthis.currentCall = null;\n\t\t\tthis.currentCallIsNew = false;\n\t\t}\n\n\t\tCall.Hardware.isMicrophoneMuted = false;\n\t}\n\n\tonCallLeave(e)\n\t{\n\t\tif (!e.local)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.webScreenSharePopup)\n\t\t{\n\t\t\tthis.webScreenSharePopup.close();\n\t\t}\n\n\t\tif (!this.getActiveCallUsers().length)\n\t\t{\n\t\t\tAnalytics.getInstance().onFinishCall({\n\t\t\t\tcallId: this.currentCall?.id,\n\t\t\t\tcallType: Analytics.AnalyticsType.videoconf,\n\t\t\t\tstatus: Analytics.AnalyticsStatus.lastUserLeft,\n\t\t\t\tchatId: this.currentCall?.associatedEntity.id,\n\t\t\t\tcallUsersCount: this.getCallUsers(true).length,\n\t\t\t\tcallLength: Call.Util.getTimeText(this.currentCall.startDate),\n\t\t\t});\n\t\t}\n\n\t\tthis.endCall();\n\t}\n\n\tonCallDestroy(e)\n\t{\n\t\tthis.currentCall = null;\n\n\t\tif (this.floatingScreenShareWindow)\n\t\t{\n\t\t\tthis.floatingScreenShareWindow.close;\n\t\t}\n\n\t\tif (this.webScreenSharePopup)\n\t\t{\n\t\t\tthis.webScreenSharePopup.close();\n\t\t}\n\n\t\tthis.restart();\n\t}\n\n\tonCheckDevicesSave(changedValues)\n\t{\n\t\tif (changedValues['camera'])\n\t\t{\n\t\t\tCall.Hardware.defaultCamera = changedValues['camera'];\n\t\t}\n\n\t\tif (changedValues['microphone'])\n\t\t{\n\t\t\tCall.Hardware.defaultMicrophone = changedValues['microphone'];\n\t\t}\n\n\t\tif (changedValues['audioOutput'])\n\t\t{\n\t\t\tCall.Hardware.defaultSpeaker = changedValues['audioOutput'];\n\t\t}\n\n\t\tif (changedValues['preferHDQuality'])\n\t\t{\n\t\t\tCall.Hardware.preferHdQuality = changedValues['preferHDQuality'];\n\t\t}\n\n\t\tif (changedValues['enableMicAutoParameters'])\n\t\t{\n\t\t\tCall.Hardware.enableMicAutoParameters = changedValues['enableMicAutoParameters'];\n\t\t}\n\t}\n\n\tsetCameraState(state)\n\t{\n\t\tCall.Hardware.isCameraOn = state;\n\t}\n\t/* endregion 01. Call methods */\n\n\t/* region 02. Component methods */\n\t\t/* region 01. General actions */\n\t\tisChatShowed()\n\t\t{\n\t\t\treturn this.getConference().common.showChat;\n\t\t}\n\n\t\ttoggleChat()\n\t\t{\n\t\t\tconst rightPanelMode = this.getConference().common.rightPanelMode;\n\t\t\tif (rightPanelMode === RightPanelMode.hidden)\n\t\t\t{\n\t\t\t\tthis.controller.getStore().dispatch('conference/changeRightPanelMode', {mode: RightPanelMode.chat});\n\t\t\t\tthis.callView.setButtonActive('chat', true);\n\t\t\t}\n\t\t\telse if (rightPanelMode === RightPanelMode.chat)\n\t\t\t{\n\t\t\t\tthis.controller.getStore().dispatch('conference/changeRightPanelMode', {mode: RightPanelMode.hidden});\n\t\t\t\tthis.callView.setButtonActive('chat', false);\n\t\t\t}\n\t\t\telse if (rightPanelMode === RightPanelMode.users)\n\t\t\t{\n\t\t\t\tthis.controller.getStore().dispatch('conference/changeRightPanelMode', {mode: RightPanelMode.split});\n\t\t\t\tthis.callView.setButtonActive('chat', true);\n\t\t\t}\n\t\t\telse if (rightPanelMode === RightPanelMode.split)\n\t\t\t{\n\t\t\t\tthis.controller.getStore().dispatch('conference/changeRightPanelMode', {mode: RightPanelMode.users});\n\t\t\t\tthis.callView.setButtonActive('chat', false);\n\t\t\t}\n\t\t}\n\n\t\ttoggleUserList()\n\t\t{\n\t\t\tconst rightPanelMode = this.getConference().common.rightPanelMode;\n\t\t\tif (rightPanelMode === RightPanelMode.hidden)\n\t\t\t{\n\t\t\t\tthis.controller.getStore().dispatch('conference/changeRightPanelMode', {mode: RightPanelMode.users});\n\t\t\t\tthis.callView.setButtonActive('users', true);\n\t\t\t}\n\t\t\telse if (rightPanelMode === RightPanelMode.users)\n\t\t\t{\n\t\t\t\tthis.controller.getStore().dispatch('conference/changeRightPanelMode', {mode: RightPanelMode.hidden});\n\t\t\t\tthis.callView.setButtonActive('users', false);\n\t\t\t}\n\t\t\telse if (rightPanelMode === RightPanelMode.chat)\n\t\t\t{\n\t\t\t\tthis.controller.getStore().dispatch('conference/changeRightPanelMode', {mode: RightPanelMode.split});\n\t\t\t\tthis.callView.setButtonActive('users', true);\n\t\t\t}\n\t\t\telse if (rightPanelMode === RightPanelMode.split)\n\t\t\t{\n\t\t\t\tthis.controller.getStore().dispatch('conference/changeRightPanelMode', {mode: RightPanelMode.chat});\n\t\t\t\tthis.callView.setButtonActive('users', false);\n\t\t\t}\n\t\t}\n\n\t\tpinUser(user)\n\t\t{\n\t\t\tif (!this.callView)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tthis.callView.pinUser(user.id);\n\t\t\tthis.callView.setLayout(Call.View.Layout.Centered);\n\t\t}\n\n\t\tunpinUser()\n\t\t{\n\t\t\tif (!this.callView)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tthis.callView.unpinUser();\n\t\t}\n\n\t\tchangeBackground()\n\t\t{\n\t\t\tif (!Call.Hardware)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tCall.BackgroundDialog.open();\n\t\t}\n\n\t\topenChat(user)\n\t\t{\n\t\t\tDesktopApi.emitToMainWindow('bxConferenceOpenChat', [user.id]);\n\t\t}\n\n\t\topenProfile(user)\n\t\t{\n\t\t\tDesktopApi.emitToMainWindow('bxConferenceOpenProfile', [user.id]);\n\t\t}\n\n\t\tsetDialogInited()\n\t\t{\n\t\t\tthis.dialogInited = true;\n\t\t\tlet dialogData = this.getDialogData();\n\t\t\tdocument.title = dialogData.name;\n\t\t}\n\n\t\tchangeVideoconfUrl(newUrl)\n\t\t{\n\t\t\twindow.history.pushState(\"\", \"\", newUrl);\n\t\t}\n\n\t\tsendNewMessageNotify(params)\n\t\t{\n\t\t\tconst MAX_LENGTH = 40;\n\t\t\tconst AUTO_HIDE_TIME = 4000;\n\n\t\t\tif (!this.checkIfMessageNotifyIsNeeded(params))\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tconst text = Utils.text.purify(params.message.text, params.message.params, params.files);\n\t\t\tlet avatar = '';\n\t\t\tlet userName = '';\n\n\t\t\t// avatar and username only for non-system messages\n\t\t\tif (params.message.senderId > 0 && params.message.system !== 'Y')\n\t\t\t{\n\t\t\t\tconst messageAuthor = this.controller.getStore().getters['users/get'](params.message.senderId, true);\n\t\t\t\tuserName = messageAuthor.name;\n\t\t\t\tavatar = messageAuthor.avatar;\n\t\t\t}\n\n\t\t\tNotifier.notify({\n\t\t\t\tid: `im-videconf-${params.message.id}`,\n\t\t\t\ttitle: userName,\n\t\t\t\ticon: avatar,\n\t\t\t\ttext\n\t\t\t});\n\n\t\t\treturn true;\n\t\t}\n\n\t\tcheckIfMessageNotifyIsNeeded(params)\n\t\t{\n\t\t\tif (!Call.Util.isConferenceChatEnabled())\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tconst rightPanelMode = this.getConference().common.rightPanelMode;\n\t\t\treturn !Utils.device.isMobile()\n\t\t\t\t&& params.chatId === this.getChatId()\n\t\t\t\t&& (rightPanelMode !== RightPanelMode.chat || rightPanelMode !== RightPanelMode.split)\n\t\t\t\t&& params.message.senderId !== this.controller.getUserId()\n\t\t\t\t&& !this.getConference().common.error;\n\t\t}\n\n\t\tonInputFocus(e)\n\t\t{\n\t\t\tthis.callView.setHotKeyTemporaryBlock(true);\n\t\t}\n\n\t\tonInputBlur(e)\n\t\t{\n\t\t\tthis.callView.setHotKeyTemporaryBlock(false);\n\t\t}\n\n\tcloseReconnectionBaloon()\n\t{\n\t\tif (this.reconnectionBaloon)\n\t\t{\n\t\t\tthis.reconnectionBaloon.close();\n\t\t\tthis.reconnectionBaloon = null;\n\t\t}\n\t}\n\n\tsetReconnectingCameraId(id)\n\t{\n\t\tthis.reconnectingCameraId = id;\n\n\t\tif (id) {\n\t\t\tthis.updateCameraSettingsInCurrentCallAfterReconnecting(id)\n\t\t}\n\t}\n\n\tupdateCameraSettingsInCurrentCallAfterReconnecting(cameraId)\n\t{\n\t\tif (this.currentCall.cameraId === cameraId) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst devicesList = Call.Hardware.getCameraList();\n\n\t\tif (!devicesList.find(device => device.deviceId === cameraId))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.currentCall.setCameraId(cameraId);\n\t\tthis.setReconnectingCameraId(null);\n\t}\n\n\tonUpdateLastUsedCameraId()\n\t{\n\t\tconst cameraId = this.currentCall.cameraId;\n\t\tif (cameraId)\n\t\t{\n\t\t\tthis.lastUsedCameraId = cameraId;\n\t\t}\n\t}\n\n\tonReconnecting(e)\n\t{\n\t\tif (!(this.currentCall.provider === Call.Provider.Bitrix || this.currentCall.provider === Call.Provider.Plain))\n\t\t{\n\t\t\t// todo: restore after fixing balloon resurrection issue\n\t\t\t// related to multiple simultaneous calls to the balloon manager\n\t\t\t// now it's enabled for Bitrix24 calls as a temp solution\n\t\t\treturn false;\n\t\t}\n\n\t\tAnalytics.getInstance().onReconnect({\n\t\t\tcallId: this.currentCall.id,\n\t\t\tcallType: Analytics.AnalyticsType.videoconf,\n\t\t\treconnectionEventCount: e.reconnectionEventCount\n\t\t});\n\n\t\t// noinspection UnreachableCodeJS\n\n\t\tif (this.reconnectionBaloon)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.reconnectionBaloon = BX.UI.Notification.Center.notify({\n\t\t\tcontent: Text.encode(BX.message('IM_CALL_RECONNECTING')),\n\t\t\tautoHide: false,\n\t\t\tposition: \"top-right\",\n\t\t\tcloseButton: false,\n\t\t})\n\t}\n\n\tonReconnected()\n\t{\n\t\tthis.setReconnectingCameraId(this.lastUsedCameraId)\n\t\tif (!(this.currentCall.provider === Call.Provider.Bitrix || this.currentCall.provider === Call.Provider.Plain))\n\t\t{\n\t\t\t// todo: restore after fixing balloon resurrection issue\n\t\t\t// related to multiple simultaneous calls to the balloon manager\n\t\t\t// now it's enabled for Bitrix24 calls as a temp solution\n\t\t\treturn false;\n\t\t}\n\n\t\t// noinspection UnreachableCodeJS\n\t\tthis.closeReconnectionBaloon();\n\t}\n\n\t\tsetUserWasRenamed()\n\t\t{\n\t\t\tif (this.callView)\n\t\t\t{\n\t\t\t\tthis.callView.localUser.userModel.wasRenamed = true;\n\t\t\t}\n\t\t}\n\t\t/* endregion 01. General actions */\n\n\t\t/* region 02. Store actions */\n\t\tsetError(errorCode)\n\t\t{\n\t\t\tconst currentError = this.getConference().common.error;\n\t\t\t// if user kicked from call - dont show him end of call form\n\t\t\tif (currentError && currentError === ConferenceErrorCode.kickedFromCall)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.controller.getStore().commit('conference/setError', {errorCode});\n\t\t}\n\n\t\ttoggleSmiles()\n\t\t{\n\t\t\tthis.controller.getStore().commit('conference/toggleSmiles');\n\t\t}\n\n\t\tsetJoinType(joinWithVideo)\n\t\t{\n\t\t\tthis.controller.getStore().commit('conference/setJoinType', {joinWithVideo});\n\t\t}\n\n\t\tsetConferenceStatus(conferenceStarted)\n\t\t{\n\t\t\tthis.controller.getStore().commit('conference/setConferenceStatus', {conferenceStarted});\n\t\t}\n\n\t\tsetConferenceHasErrorInCall(hasErrorInCall)\n\t\t{\n\t\t\tthis.controller.getStore().commit('conference/setConferenceHasErrorInCall', {hasErrorInCall});\n\t\t}\n\n\t\tsetConferenceStartDate(conferenceStartDate)\n\t\t{\n\t\t\tthis.controller.getStore().commit('conference/setConferenceStartDate', {conferenceStartDate});\n\t\t}\n\n\t\tsetUserReadyToJoin()\n\t\t{\n\t\t\tthis.controller.getStore().commit('conference/setUserReadyToJoin');\n\t\t}\n\n\t\tupdateCallUser(userId, fields)\n\t\t{\n\t\t\tthis.controller.getStore().dispatch('call/updateUser', {id: userId, fields});\n\t\t}\n\t\t/* endregion 02. Store actions */\n\n\t\t/* region 03. Rest actions */\n\t\tsetUserName(name)\n\t\t{\n\t\t\treturn new Promise((resolve, reject) => {\n\t\t\t\tthis.restClient.callMethod('im.call.user.update', {\n\t\t\t\t\tname: name,\n\t\t\t\t\tchat_id: this.getChatId()\n\t\t\t\t}).then(() => {\n\t\t\t\t\tresolve();\n\t\t\t\t}).catch((error) => {\n\t\t\t\t\treject(error)\n\t\t\t\t});\n\t\t\t});\n\t\t}\n\n\t\tcheckPassword(password)\n\t\t{\n\t\t\treturn new Promise((resolve, reject) => {\n\t\t\t\tthis.restClient.callMethod('im.videoconf.password.check', { password, alias: this.params.alias })\n\t\t\t\t\t.then(result => {\n\t\t\t\t\t\tif (result.data() === true)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.restClient.setPassword(password);\n\t\t\t\t\t\t\tthis.controller.getStore().commit('conference/common', {\n\t\t\t\t\t\t\t\tpassChecked: true\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\tthis.initUserComplete();\n\t\t\t\t\t\t\tresolve();\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\treject();\n\t\t\t\t\t\t}\n\t\t\t\t\t}).catch(result => {\n\t\t\t\t\t\tconsole.error('Password check error', result);\n\t\t\t\t\t});\n\t\t\t});\n\t\t}\n\n\t\tchangeLink()\n\t\t{\n\t\t\treturn new Promise((resolve, reject) => {\n\t\t\t\tthis.restClient.callMethod('im.videoconf.share.change', {\n\t\t\t\t\tdialog_id: this.getDialogId()\n\t\t\t\t}).then(() => {\n\t\t\t\t\tresolve();\n\t\t\t\t}).catch((error) => {\n\t\t\t\t\treject(error)\n\t\t\t\t});\n\t\t\t});\n\t\t}\n\t\t/* endregion 03. Rest actions */\n\t/* endregion 02. Component methods */\n\n/* endregion 02. Methods */\n\n/* region 03. Utils */\n\tready()\n\t{\n\t\tif (this.inited)\n\t\t{\n\t\t\tlet promise = new BX.Promise;\n\t\t\tpromise.resolve(this);\n\n\t\t\treturn promise;\n\t\t}\n\n\t\treturn this.initPromise;\n\t}\n\n\tgetConference()\n\t{\n\t\treturn this.controller.getStore().state.conference;\n\t}\n\n\tisBroadcast()\n\t{\n\t\treturn this.getConference().common.isBroadcast;\n\t}\n\n\tgetBroadcastPresenters()\n\t{\n\t\treturn this.getConference().common.presenters;\n\t}\n\n\tisExternalUser()\n\t{\n\t\treturn !!this.getUserHash();\n\t}\n\n\tgetChatId()\n\t{\n\t\treturn parseInt(this.params.chatId);\n\t}\n\n\tgetDialogId()\n\t{\n\t\treturn this.params.dialogId;\n\t}\n\n\tgetDialogData()\n\t{\n\t\tif (!this.dialogInited)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\treturn this.controller.getStore().getters['dialogues/get'](this.getDialogId());\n\t}\n\n\tgetHost()\n\t{\n\t\treturn location.origin || '';\n\t}\n\n\tgetStartupErrorCode()\n\t{\n\t\treturn this.params.startupErrorCode? this.params.startupErrorCode : '';\n\t}\n\n\tisHttps()\n\t{\n\t\treturn location.protocol === 'https:';\n\t}\n\n\tgetUserHash()\n\t{\n\t\treturn this.getConference().user.hash;\n\t}\n\n\tgetUserHashCookie()\n\t{\n\t\tlet userHash = '';\n\n\t\tlet cookie = Cookie.get(null, 'BITRIX_CALL_HASH');\n\t\tif (typeof cookie === 'string' && cookie.match(/^[a-f0-9]{32}$/))\n\t\t{\n\t\t\tuserHash = cookie;\n\t\t}\n\n\t\treturn userHash;\n\t}\n\n\tswitchToSessAuth()\n\t{\n\t\tthis.restClient.restClient.queryParams = undefined;\n\n\t\treturn true;\n\t}\n\n/* endregion 03. Utils */\n}\n\nConferenceApplication.FeatureState = {\n\tEnabled: 'enabled',\n\tDisabled: 'disabled',\n\tLimited: 'limited',\n};\n\nexport {ConferenceApplication};\n"],"names":["RestAuth","Object","freeze","guest","CallRestClient","params","queryAuthRestore","setAuthId","restClient","RestClient","endpoint","queryParams","cors","authId","customAuthId","match","call_auth_id","console","error","call_custom_auth_id","chatId","call_chat_id","alias","videoconf_id","password","videoconf_password","method","callback","sendCallback","logTag","Utils","getLogTrackingParams","name","promise","BX","Promise","callMethod","then","result","fulfill","ex","hash","RestMethod","widgetUserRegister","warn","error_description","reject","calls","bHaltOnError","resultCallback","hasOwnProperty","callBatch","ConferenceApplication","inited","hardwareInited","dialogInited","initPromise","userId","parseInt","siteId","dialogId","toString","passwordRequired","isBroadcast","Messenger","Lib","Logger","setConfig","loggerConfig","messagesQueue","template","rootNode","node","document","createElement","event","VueVendorV2","callContainer","preCall","currentCall","videoStrategy","callDetails","showFeedback","featureConfig","forEach","limit","id","localVideoStream","lastUsedCameraId","reconnectingCameraId","conferencePageTagInterval","onCallUserInvitedHandler","onCallUserInvited","bind","onCallUserStateChangedHandler","onCallUserStateChanged","onCallUserMicrophoneStateHandler","onCallUserMicrophoneState","onCallUserCameraStateHandler","onCallUserCameraState","onNeedResetMediaDevicesStateHandler","onNeedResetMediaDevicesState","onCallUserVideoPausedHandler","onCallUserVideoPaused","onCallLocalMediaReceivedHandler","debounce","onCallLocalMediaReceived","onCallRemoteMediaReceivedHandler","onCallRemoteMediaReceived","onCallRemoteMediaStoppedHandler","onCallRemoteMediaStopped","onCallUserVoiceStartedHandler","onCallUserVoiceStarted","onCallUserVoiceStoppedHandler","onCallUserVoiceStopped","onUserStatsReceivedHandler","onUserStatsReceived","onCallUserScreenStateHandler","onCallUserScreenState","onCallUserRecordStateHandler","onCallUserRecordState","onCallUserFloorRequestHandler","onCallUserFloorRequest","onMicrophoneLevelHandler","onMicrophoneLevel","_onCallJoinHandler","onCallJoin","onCallFailureHandler","onCallFailure","onCallLeaveHandler","onCallLeave","onCallDestroyHandler","onCallDestroy","onInputFocusHandler","onInputFocus","onInputBlurHandler","onInputBlur","onReconnectingHandler","onReconnecting","onReconnectedHandler","onReconnected","onUpdateLastUsedCameraIdHandler","onUpdateLastUsedCameraId","onCallConnectionQualityChangedHandler","onCallConnectionQualityChanged","onCallToggleRemoteParticipantVideoHandler","onCallToggleRemoteParticipantVideo","_onGetUserMediaEndedHandler","onGetUserMediaEnded","_onSwitchTrackRecordStatusHandler","onUpdateCallCopilotState","onPreCallDestroyHandler","onPreCallDestroy","onPreCallUserStateChangedHandler","onPreCallUserStateChanged","waitingForCallStatus","waitingForCallStatusTimeout","callEventReceived","callRecordState","Call","RecordState","Stopped","callRecordInfo","floatingScreenShareWindow","webScreenSharePopup","screenShareStartTime","mutePopup","allowMutePopup","loopTimers","initDesktopEvents","initRestClient","subscribePreCallChanges","subscribeNotifierEvents","initPullClient","initCore","setModelData","initComponent","initCallInterface","initHardware","initUserComplete","DesktopApi","isDesktop","resolve","onBackToCallClick","onFloatingScreenShareBackToCallClick","onStopSharingClick","onFloatingScreenShareStopClick","onChangeScreenClick","onFloatingScreenShareChangeScreenClick","subscribe","title","x","y","width","height","app","setSharingData","show","window","addEventListener","onWindowFocus","onWindowBlur","counter","controller","getStore","commit","messageCount","EventEmitter","EventType","textarea","focus","blur","conference","userRenameFocus","userRenameBlur","getHost","setConfId","conferenceId","addCustomEvent","onCallCreated","Notifier","getData","startsWith","toggleChat","isIntranetOrExtranet","pullClient","PullClient","serverEnabled","skipStorageInit","configTimestamp","skipCheckRevision","getPublicListMethod","PULL","start","Controller","host","languageId","language","pull","client","rest","vuexBuilder","database","browser","isIe","databaseName","databaseType","VuexBuilder","DatabaseType","localStorage","models","ConferenceModel","create","CallModel","Application","Core","ready","dialog","getChatId","getDialogId","options","darkBackground","presentersIds","presenters","map","presenter","dispatch","broadcastMode","passChecked","conferenceTitle","getStartupErrorCode","setError","createVue","el","data","vue","getElementById","hiddenButtons","isViewerMode","push","isConferenceChatEnabled","callView","container","showChatButtons","showUsersButton","showShareButton","getFeatureState","FeatureState","Disabled","showRecordButton","userLimit","getUserLimit","layout","device","isMobile","Layout","Mobile","Centered","uiState","UiState","Preparing","blockedButtons","localUserState","Idle","hiddenTopButtons","getBroadcastPresenters","length","broadcastingMode","broadcastingPresenters","isCopilotFeaturesEnabled","isCopilotActive","Event","onButtonClick","onCallButtonClick","onReplaceCamera","onCallReplaceCamera","onReplaceMicrophone","onCallReplaceMicrophone","onReplaceSpeaker","onCallReplaceSpeaker","onHasMainStream","onCallViewHasMainStream","onChangeHdVideo","onCallViewChangeHdVideo","onChangeMicAutoParams","onCallViewChangeMicAutoParams","onChangeFaceImprove","onCallViewChangeFaceImprove","onUserRename","onCallViewUserRename","onUserPinned","onCallViewUserPinned","onToggleSubscribe","onCallToggleSubscribe","blockAddUser","blockHistoryButton","errorCode","code","message","initUser","startPageTagInterval","tryJoinExistingCall","initCall","initPullHandlers","subscribeToStoreChanges","initComplete","getConference","common","setUserId","switchToSessAuth","hashFromCookie","getUserHashCookie","setChatId","SidePanel","Instance","disableAnchorBinding","user_hash","setLocalUserId","created","userCount","clearInterval","setInterval","LocalStorage","set","CallEngine","getConferencePageTag","provider","Bitrix","entityType","entityId","type","Permanent","success","setTimeout","setConferenceStatus","setRestClient","setPullClient","setCurrentUserId","getUserId","unblockButtons","ImCallPullHandler","store","application","mutation","state","payload","fields","updateUserData","platform","isBitrixDesktop","setButtonCounter","actionName","dialogMuted","previousCounter","isExternalUser","localUser","userModel","allowRename","emitToMainWindow","init","values","microphoneList","ConferenceErrorCode","missingMicrophone","checkAvailableCamera","checkAvailableMicrophone","enableMediaSelection","Events","deviceChanged","_onDeviceChange","isHttps","unsupportedBrowser","unsafeConnection","e","allAddedDevice","added","allRemovedDevice","removed","getRemovedUsedDevices","microphoneId","cameraId","speakerId","useDevicesInCurrentCall","UI","Notification","Center","notify","content","deviceInfo","label","position","autoHideDelay","closeButton","actions","events","click","balloon","close","removeDevicesFromCurrentCall","hasCamera","defaultCamera","cameraList","some","cameraItem","deviceId","hasMicrophone","defaultMicrophone","micItem","isCameraButtonHasBlocked","isButtonBlocked","blockSwitchCamera","unblockSwitchCamera","setDefaultCameraIfNeeded","isActiveState","$emit","updateButtons","blockSwitchMicrophone","unblockSwitchMicrophone","setDefaultMicrophoneIfNeeded","deviceList","isForceUse","i","kind","newDeviceId","getDefaultDeviceIdByGroupId","groupId","setMicrophoneId","setCameraId","isCameraOn","updateCameraSettingsInCurrentCallAfterReconnecting","setSpeakerId","microphoneIds","keys","includes","deviceGroup","getDeviceGroupIdByDeviceId","cameraIds","speakerIds","audioOutputList","videoEnabled","viewerMode","initCallPromise","getDialogData","setLayout","Grid","setUiState","Calling","showNotification","stopLocalVideoStream","createCall","enableMicAutoParameters","joinExisting","call","useHdVideo","isTrackRecordOn","appendUsers","getUsers","getCallUsers","userData","users","releasePreCall","bindCallEvents","updateCallUser","microphoneState","isMicrophoneMuted","isNew","Analytics","getInstance","onStartVideoconf","callId","withVideo","mediaParams","video","audio","status","AnalyticsStatus","inviteUsers","answer","joinAsViewer","onJoinVideoconf","prop","getBoolean","setLocalUserDirection","RecvOnly","SendRecv","getCallWithId","finishCall","wasConnected","getBrowserForStatistics","IsMobile","isConference","removeCallEvents","hangup","isRecording","onRecordStop","callType","AnalyticsType","videoconf","subSection","AnalyticsSubSection","contextMenu","element","AnalyticsElement","finishForAllButton","disconnectButton","recordTime","getRecordTimeText","BXDesktopSystem","CallRecordStop","destroy","location","href","releaseLocalMedia","closeReconnectionBaloon","userLeftCall","unsubscribe","trace","kickedFromCall","disconnect","endCall","includeSelf","userStates","activeUsers","Connected","Connecting","stream","getCurrentDeviceList","log","getTracks","tr","stop","micId","Enabled","articleCode","getFeature","getDesktopVersion","canRecord","InfoHelper","notificationText","Text","encode","bindElement","buttons","microphone","elements","icon","targetContainer","createUnmuteButton","onClose","Button","baseClass","text","size","Size","EXTRA_SMALL","color","Color","LIGHT_BORDER","noCaps","round","onCallViewToggleMuteButtonClick","muted","screen","root","onCallViewToggleScreenSharingButtonClick","currentUserId","isCurrentUserPresenter","associatedEntity","updatePreCallCounter","onUserStateChanged","onDestroy","setConferenceStartDate","startDate","userReadyToJoin","joinWithVideo","joinCall","startCall","removeEventListener","clearTimeout","userInCallCount","getParticipatingUsers","strategyType","VideoStrategy","Type","OnlySpeaker","AllowAll","setReconnectingCameraId","defaultSpeaker","setMainStream","preferHdQuality","allowHdVideo","allowMicAutoParams","setCameraSmoothingStatus","faceImproveEnabled","newName","renameGuestMobile","renameGuest","pinned","toggleRemoteParticipantVideo","participantIds","showVideo","renameRequested","setUserName","wasRenamed","renameSlider","buttonName","handlers","onCallViewHangupButtonClick","hangupOptions","_onCallViewHangupOptionsButtonClick","onCallViewCloseButtonClick","toggleMute","toggleScreenSharing","record","onCallViewRecordButtonClick","toggleVideo","onCallViewToggleVideoButtonClick","toggleSpeaker","onCallViewToggleSpeakerButtonClick","showChat","onCallViewShowChatButtonClick","toggleUsers","onCallViewToggleUsersButtonClick","share","onCallViewShareButtonClick","fullscreen","onCallViewFullScreenButtonClick","floorRequest","onCallViewFloorRequestButtonClick","feedback","onCallViewFeedbackButtonClick","onUserClick","onCallUserClick","copilot","onCallCopilotButtonClick","onDisconnectCall","finishButton","hangupOptionsMenu","targetNodeWidth","offsetWidth","menuItems","onclick","onFinishCall","finishedForAll","callUsersCount","callLength","getTimeText","PopupMenuWindow","className","background","contentBackground","darkMode","contentBorderRadius","angle","offsetTop","bindOptions","cacheable","subMenuOptions","maxWidth","onShow","popup","getTarget","getPopupContainer","style","display","offsetLeft","setOffset","setAngle","offset","items","onToggleMicrophone","CallRecordMute","onScreenShareBtnClick","Limited","showFeatureLimitSlider","isScreenSharingStarted","stopScreenSharing","CallRecordStopSharing","startScreenSharing","onRecordBtnClick","recordState","Started","setButtonActive","Helper","Paused","CallRecordPause","Resumed","sendRecordState","action","date","Date","onToggleCamera","initialized","muteSpeaker","speakerMuted","fromHotKey","notifyWidth","body","clientWidth","Loc","getMessage","Clipboard","copy","link","toggleFullScreen","BXDesktopWindow","ExecuteCommand","hide","webkitFullscreenElement","fullscreenElement","isFullScreen","exitFullScreen","enterFullScreen","IsChrome","IsSafari","webkitRequestFullScreen","IsFirefox","requestFullscreen","cancelFullScreen","mozCancelFullScreen","webkitCancelFullScreen","exitFullscreen","onShowChat","toggleUserList","loadExt","Feedback","Form","open","instanceId","Math","random","forms","zones","sec","lang","presets","sender_page","call_type","call_amount","call_id","id_of_user","from_domain","origin","onClickUser","find","key","onChangeStateCopilot","updateCopilotState","ajax","runAction","onFloorRequest","floorState","getUserFloorRequestState","getCurrentUserId","talkingState","getUserTalking","setUserFloorRequestState","requestFloor","callViewFloorRequestTimeout","onUserInvited","onUserMicrophoneState","onUserCameraState","onUserVideoPaused","onLocalMediaReceived","onRemoteMediaReceived","onRemoteMediaStopped","onUserVoiceStarted","onUserVoiceStopped","onUserScreenState","onUserRecordState","onUserFloorRequest","onJoin","onLeave","onConnectionQualityChanged","onToggleRemoteParticipantVideo","onSwitchTrackRecordStatus","addUser","undefined","loopConnectionQuality","clearConnectionQualityTimer","setUserConnectionQuality","Ready","previousState","setUserState","getConnectedUserCount","blockButtons","setUserMicrophoneState","setUserCameraState","cameraState","setUserVideoPaused","videoPaused","flipVideo","tag","mediaRenderer","enableMirroring","setLocalStream","flipLocalVideo","onScreenShareStarted","showWebScreenSharePopup","onScreenShareStopped","screenShareLength","callFromMobile","getVideoTracks","getStreamType","getAudioTracks","setUserMedia","track","setVideoRenderer","quality","timeout","newQuality","score","updateMediaDevices","toogleParticipantsVideoBaloon","isVideoShown","autoHide","local","showMicMutedNotification","setUserTalking","talking","floorRequestState","setUserStats","report","setUserScreenState","screenState","setRecordState","windowId","bxdWindowId","fileName","dialogName","callDate","Main","format","formatRecordDate","replace","getRestClient","onRecordStart","CallRecordStart","cropTop","cropBottom","shareMethod","recordButton","requestActive","setMicrophoneLevel","level","setConferenceHasErrorInCall","errorMessage","reportConnectionResult","showFatalError","autoCloseCallView","removeVideoStrategy","currentCallIsNew","getActiveCallUsers","lastUserLeft","restart","changedValues","rightPanelMode","RightPanelMode","hidden","mode","chat","split","user","pinUser","unpinUser","dialogData","newUrl","history","pushState","checkIfMessageNotifyIsNeeded","purify","files","avatar","userName","senderId","system","messageAuthor","getters","setHotKeyTemporaryBlock","reconnectionBaloon","devicesList","getCameraList","Plain","onReconnect","reconnectionEventCount","currentError","conferenceStarted","hasErrorInCall","conferenceStartDate","chat_id","setPassword","dialog_id","getUserHash","startupErrorCode","protocol","userHash","cookie","Cookie","get"],"mappings":"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"}