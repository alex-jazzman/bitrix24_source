{"version":3,"file":"org-chart.bundle.js","sources":["../src/consts.js","../src/components/title-panel/add-button/add-button.js","../src/actions.js","../src/components/title-panel/search/search-bar.js","../src/components/title-panel/burger-menu-button/burger-menu-button.js","../src/components/title-panel/title-panel.js","../src/classes/url-provided-params-service.js","../src/components/tree/tree-node/head-list.js","../src/components/tree/tree-node/directives/drag-and-drop.js","../src/components/menu/abstract-action-menu.js","../src/components/menu/items/abstract-menu-item.js","../src/components/menu/menu-actions.js","../src/components/menu/items/department/add-department-menu-item.js","../src/components/menu/items/department/edit-department-menu-item.js","../src/components/menu/items/department/remove-department-menu-item.js","../src/components/menu/items/department/team-rights-menu-item.js","../src/components/menu/items/employees/add-employee-menu-item.js","../src/components/menu/items/department/edit-employees-menu-item.js","../src/components/menu/items/employees/move-employee-menu-item.js","../src/components/menu/items/employees/user-invite-menu-item.js","../src/components/menu/menu/entity-action-menu.js","../src/components/tree/tree-node/department-menu-button.js","../src/components/tree/tree-node/department-info-icon-button.js","../src/components/tree/tree-node/subdivision-add-button.js","../src/components/tree/tree-node/tree-node.js","../src/components/tree/connectors.js","../src/api.js","../src/components/tree/tree.js","../src/components/transfrom-panel.js","../src/components/detail-panel/detail-panel-collapsed-title.js","../src/components/detail-panel/detail-panel-edit-button.js","../src/components/detail-panel/detail-panel.js","../src/components/first-popup/first-popup.js","../src/app.js","../src/components/menu/menu/users-tab-action-menu.js","../src/components/menu/menu/empty-users-tab-action-menu.js","../src/components/menu/items/user-item/fire-user-from-company.js","../src/components/menu/items/user-item/move-from-department.js","../src/components/menu/items/user-item/remove-from-department.js","../src/components/menu/menu/user-list-item-action-menu.js","../src/not-converted-state.js","../src/main.js"],"sourcesContent":["export const events = Object.freeze({\n\tHR_DEPARTMENT_CONNECT: 'hr-department-connect',\n\tHR_DEPARTMENT_DISCONNECT: 'hr-department-disconnect',\n\tHR_DEPARTMENT_ADAPT_SIBLINGS: 'hr-department-adapt-siblings',\n\tHR_DEPARTMENT_ADAPT_CONNECTOR_HEIGHT: 'hr-department-adapt-connector-height',\n\tHR_DEPARTMENT_FOCUS: 'hr-department-focus',\n\tHR_DEPARTMENT_CONTROL: 'hr-department-control',\n\tHR_DEPARTMENT_MENU_CLOSE: 'hr-department-menu-close',\n\tHR_ORG_CHART_CLOSE_BY_ESC: 'SidePanel.Slider:onCloseByEsc',\n\tHR_ORG_CHART_CLOSE: 'SidePanel.Slider:onClose',\n\tHR_FIRST_POPUP_SHOW: 'HR.company-structure:first-popup-showed',\n\tHR_DRAG_DEPARTMENT: 'hr-drag-department',\n\tHR_DROP_DEPARTMENT: 'hr-drop-department',\n\tHR_DEPARTMENT_TOGGLE_CONNECTORS: 'hr-department-toggle-connectors',\n\tHR_DEPARTMENT_SLIDER_ON_MESSAGE: 'SidePanel.Slider:onMessage',\n\n\tHR_ENTITY_SHOW_WIZARD: 'hr-entity-show-wizard',\n\tHR_ENTITY_REMOVE: 'hr-entity-remove',\n\tHR_PUBLIC_FOCUS_NODE: 'HumanResources.CompanyStructure:focusNode',\n\n\tINTRANET_USER_MINIPROFILE_CLOSE: 'Intranet.User.MiniProfile:close',\n});\n\nexport const detailPanelWidth = 364;\n","import { RouteActionMenu } from 'humanresources.company-structure.structure-components';\nimport { Main, CRM } from 'ui.icon-set.api.core';\nimport { getColorCode } from 'humanresources.company-structure.utils';\nimport { PermissionActions, PermissionChecker } from 'humanresources.company-structure.permission-checker';\nimport 'ui.icon-set.main';\nimport 'ui.icon-set.crm';\n\nconst MenuOption = Object.freeze({\n\taddDepartment: 'add-department',\n\taddEmployee: 'add-employee',\n});\n\n// @vue/component\nexport const AddButton = {\n\tname: 'AddButton',\n\n\tcomponents: {\n\t\tRouteActionMenu,\n\t},\n\n\temits: ['addDepartment'],\n\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tactionMenu: {\n\t\t\t\tvisible: false,\n\t\t\t},\n\t\t};\n\t},\n\n\tcomputed: {\n\t\tMenuOption(): typeof MenuOption\n\t\t{\n\t\t\treturn MenuOption;\n\t\t},\n\t},\n\n\tmounted(): void\n\t{\n\t\tconst permissionChecker = PermissionChecker.getInstance();\n\n\t\tif (!permissionChecker)\n\t\t{\n\t\t\treturn;\n\t\t}\n\t\tthis.dropdownItems = [\n\t\t\t{\n\t\t\t\tid: MenuOption.addDepartment,\n\t\t\t\ttitle: this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_ADD_BUTTON_MENU_ADD_DEPARTMENT_TITLE'),\n\t\t\t\tdescription: this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_ADD_BUTTON_MENU_ADD_DEPARTMENT_DESCR'),\n\t\t\t\tbIcon: {\n\t\t\t\t\tname: Main.CUBE_PLUS,\n\t\t\t\t\tsize: 20,\n\t\t\t\t\tcolor: getColorCode('paletteBlue50'),\n\t\t\t\t},\n\t\t\t\tpermission: {\n\t\t\t\t\taction: PermissionActions.departmentCreate,\n\t\t\t\t},\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: MenuOption.addEmployee,\n\t\t\t\ttitle: this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_ADD_BUTTON_MENU_ADD_EMPLOYEE_TITLE'),\n\t\t\t\tdescription: this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_ADD_BUTTON_MENU_ADD_EMPLOYEE_DESCR'),\n\t\t\t\tbIcon: {\n\t\t\t\t\tname: CRM.PERSON_PLUS_2,\n\t\t\t\t\tsize: 20,\n\t\t\t\t\tcolor: getColorCode('paletteBlue50'),\n\t\t\t\t},\n\t\t\t\tpermission: {\n\t\t\t\t\taction: PermissionActions.employeeAddToDepartment,\n\t\t\t\t},\n\t\t\t},\n\t\t];\n\n\t\tthis.dropdownItems = this.dropdownItems.filter((item) => {\n\t\t\tif (!item.permission)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\treturn permissionChecker.hasPermissionOfAction(item.permission.action);\n\t\t});\n\t},\n\n\tmethods: {\n\t\tloc(phraseCode: string, replacements: { [p: string]: string } = {}): string\n\t\t{\n\t\t\treturn this.$Bitrix.Loc.getMessage(phraseCode, replacements);\n\t\t},\n\t\taddDepartment(): void\n\t\t{\n\t\t\tthis.$emit('addDepartment');\n\t\t},\n\t\tactionMenuItemClickHandler(actionId: string): void\n\t\t{\n\t\t\tif (actionId === MenuOption.addDepartment)\n\t\t\t{\n\t\t\t\tthis.$emit('addDepartment');\n\t\t\t}\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div\n\t\t\tclass=\"ui-btn ui-btn-success ui-btn-round ui-btn-sm humanresources-title-panel__add-button\"\n\t\t\tdata-test-id=\"hr-org-chart_title-panel__add-button\"\n\t\t\t@click=\"addDepartment\"\n\t\t>\n\t\t\t{{ loc('HUMANRESOURCES_COMPANY_STRUCTURE_ADD_BUTTON') }}\n\t\t</div>\n\t`,\n};\n","import { useChartStore } from 'humanresources.company-structure.chart-store';\nimport { memberRoles, postData } from 'humanresources.company-structure.api';\nimport { EntityTypes } from 'humanresources.company-structure.utils';\nimport type { TreeItem } from './types';\nimport type { UserData } from 'humanresources.company-structure.utils';\n\nexport const OrgChartActions = {\n\tapplyData: (departments: Map<Number, TreeItem>, currentDepartments: number[], userId: number): void => {\n\t\tconst store = useChartStore();\n\t\tstore.$patch({\n\t\t\tdepartments,\n\t\t\tcurrentDepartments,\n\t\t\tuserId,\n\t\t\tsearchedUserId: userId,\n\t\t});\n\t},\n\tfocusDepartment: (departmentId: number): void => {\n\t\tconst store = useChartStore();\n\t\tstore.focusedNode = departmentId;\n\t},\n\tsearchUserInDepartment: (userId: number): void => {\n\t\tconst store = useChartStore();\n\t\tstore.searchedUserId = userId;\n\t},\n\tmoveSubordinatesToParent: (removableDepartmentId: number): void => {\n\t\tconst store = useChartStore();\n\t\tconst { departments, currentDepartments } = store;\n\t\tconst removableDepartment = departments.get(removableDepartmentId);\n\t\tconst {\n\t\t\tparentId,\n\t\t\tentityType,\n\t\t\tchildren: removableDeparmentChildren = [],\n\t\t\tuserCount: removableDepartmentUserCount,\n\t\t\theads: removableDeparmentHeads,\n\t\t\temployees: removableDeparmentEmployees = [],\n\t\t} = removableDepartment;\n\t\tconst parentDepartment = departments.get(parentId);\n\n\t\tremovableDeparmentChildren.forEach((childId) => {\n\t\t\tconst department = departments.get(childId);\n\t\t\tdepartment.parentId = parentId;\n\t\t});\n\t\tif ((removableDepartmentUserCount > 0) && (entityType === EntityTypes.department))\n\t\t{\n\t\t\tconst parentDepartmentUsersIds = new Set([\n\t\t\t\t...parentDepartment.heads,\n\t\t\t\t...(parentDepartment.employees ?? []),\n\t\t\t].map((user) => user.id));\n\t\t\tconst removableDeparmentUsers = [...removableDeparmentHeads, ...removableDeparmentEmployees];\n\t\t\tconst movableUsers = removableDeparmentUsers.filter((user) => {\n\t\t\t\treturn !parentDepartmentUsersIds.has(user.id);\n\t\t\t});\n\t\t\tfor (const user of movableUsers)\n\t\t\t{\n\t\t\t\tuser.role = memberRoles.employee;\n\t\t\t}\n\t\t\tparentDepartment.userCount += movableUsers.length;\n\t\t\tparentDepartment.employees = [\n\t\t\t\t...(parentDepartment.employees ?? []),\n\t\t\t\t...movableUsers,\n\t\t\t];\n\t\t}\n\n\t\tparentDepartment.children = [...parentDepartment.children, ...removableDeparmentChildren];\n\t\tif (currentDepartments.includes(removableDepartmentId) && (entityType === EntityTypes.department))\n\t\t{\n\t\t\tstore.changeCurrentDepartment(removableDepartmentId, parentId);\n\t\t}\n\t},\n\tmarkDepartmentAsRemoved: (removableDepartmentId: number): void => {\n\t\tconst { departments } = useChartStore();\n\t\tconst removableDepartment = departments.get(removableDepartmentId);\n\t\tconst { parentId } = removableDepartment;\n\t\tconst parentDepartment = departments.get(parentId);\n\t\tparentDepartment.children = parentDepartment.children.filter((childId) => {\n\t\t\treturn childId !== removableDepartmentId;\n\t\t});\n\t\tdelete removableDepartment.parentId;\n\t\tdepartments.set(removableDepartmentId, { ...removableDepartment, prevParentId: parentId });\n\t},\n\tremoveDepartment: (departmentId: number): void => {\n\t\tconst { departments } = useChartStore();\n\t\tdepartments.delete(departmentId);\n\t},\n\tinviteUser: (userData: UserData): void => {\n\t\tconst { nodeId, ...restData } = userData;\n\t\tconst { departments } = useChartStore();\n\t\tconst department = departments.get(nodeId);\n\t\tif (department.employees)\n\t\t{\n\t\t\tdepartments.set(nodeId, {\n\t\t\t\t...department,\n\t\t\t\temployees: [...department.employees, { ...restData }],\n\t\t\t\tuserCount: department.userCount + 1,\n\t\t\t});\n\t\t}\n\t},\n\torderDepartments: async (draggedId: number, targetId: number, direction: number, count: number): Promise<boolean> => {\n\t\tconst { departments } = useChartStore();\n\t\tconst department = departments.get(draggedId);\n\t\tconst { parentId } = department;\n\t\tconst parentDepartment = departments.get(parentId);\n\t\tconst { children } = parentDepartment;\n\t\tconst targetIndex = children.indexOf(targetId);\n\t\tconst newChildren = children.filter((childId) => childId !== draggedId);\n\t\tnewChildren.splice(targetIndex, 0, draggedId);\n\t\tdepartments.set(parentId, { ...parentDepartment, children: newChildren });\n\t\ttry\n\t\t{\n\t\t\tawait postData('humanresources.api.Structure.Node.changeOrder', {\n\t\t\t\tnodeId: draggedId,\n\t\t\t\tdirection,\n\t\t\t\tcount,\n\t\t\t});\n\n\t\t\treturn true;\n\t\t}\n\t\tcatch\n\t\t{\n\t\t\tdepartments.set(parentId, { ...parentDepartment, children });\n\n\t\t\treturn false;\n\t\t}\n\t},\n\tclearNodesChatLists: (nodeIds: Array<Number>): void => {\n\t\tconst { departments } = useChartStore();\n\t\tnodeIds.forEach((nodeId) => {\n\t\t\tconst department = departments.get(nodeId);\n\t\t\tdepartments.set(nodeId, { ...department, chats: null, channels: null });\n\t\t});\n\t},\n};\n","import { useChartStore } from 'humanresources.company-structure.chart-store';\nimport { Event, Dom } from 'main.core';\nimport { type BaseEvent } from 'main.core.events';\nimport { Dialog, type Item } from 'ui.entity-selector';\nimport { BIcon, Set } from 'ui.icon-set.api.vue';\nimport { mapState } from 'ui.vue3.pinia';\nimport { sendData as analyticsSendData } from 'ui.analytics';\nimport { OrgChartActions } from '../../../actions';\n\nimport './style.css';\n\n// @vue/component\nexport const SearchBar = {\n\tname: 'search-bar',\n\n\tcomponents: {\n\t\tBIcon,\n\t},\n\n\tdirectives: {\n\t\tfocus: {\n\t\t\tmounted(el)\n\t\t\t{\n\t\t\t\tel.focus();\n\t\t\t},\n\t\t},\n\t},\n\n\temits: [\n\t\t'locate',\n\t],\n\n\tdata(): { canEditPermissions: boolean; showSearchBar: boolean; }\n\t{\n\t\treturn {\n\t\t\tcanEditPermissions: false,\n\t\t\tshowSearchBar: false,\n\t\t};\n\t},\n\n\tcomputed: {\n\t\tset(): Set\n\t\t{\n\t\t\treturn Set;\n\t\t},\n\t\t...mapState(useChartStore, ['departments']),\n\t},\n\n\twatch: {\n\t\tdepartments: {\n\t\t\thandler(): void\n\t\t\t{\n\t\t\t\tthis.searchDialog.destroy();\n\t\t\t},\n\t\t\tdeep: true,\n\t\t},\n\t},\n\n\tcreated()\n\t{\n\t\tthis.searchDialog = this.getSearchDialog();\n\t},\n\n\tmethods: {\n\t\tloc(phraseCode: string, replacements: { [p: string]: string } = {}): string\n\t\t{\n\t\t\treturn this.$Bitrix.Loc.getMessage(phraseCode, replacements);\n\t\t},\n\t\tshowSearchbar(): void\n\t\t{\n\t\t\tif (this.showSearchBar)\n\t\t\t{\n\t\t\t\tthis.showSearchBar = false;\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tanalyticsSendData({ tool: 'structure', category: 'structure', event: 'search' });\n\n\t\t\tthis.showSearchBar = true;\n\t\t},\n\t\thideSearchbar(): void\n\t\t{\n\t\t\tthis.showSearchBar = false;\n\t\t},\n\t\tgetSearchDialog(): Dialog\n\t\t{\n\t\t\tconst dialog = new Dialog({\n\t\t\t\twidth: 425,\n\t\t\t\theight: 320,\n\t\t\t\tmultiple: false,\n\t\t\t\tentities: [\n\t\t\t\t\t{\n\t\t\t\t\t\tid: 'user',\n\t\t\t\t\t\tsearchFields: [\n\t\t\t\t\t\t\t{ name: 'supertitle', type: 'string', system: true, searchable: true },\n\t\t\t\t\t\t\t{ name: 'position', type: 'string' },\n\t\t\t\t\t\t],\n\t\t\t\t\t\toptions: {\n\t\t\t\t\t\t\tintranetUsersOnly: true,\n\t\t\t\t\t\t\temailUsers: false,\n\t\t\t\t\t\t\tinviteEmployeeLink: false,\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tid: 'structure-node',\n\t\t\t\t\t\toptions: {\n\t\t\t\t\t\t\tselectMode: 'onlyDepartments',\n\t\t\t\t\t\t\tflatMode: true,\n\t\t\t\t\t\t\tfillRecentTab: true,\n\t\t\t\t\t\t\trestricted: 'view',\n\t\t\t\t\t\t\tincludedNodeEntityTypes: ['department', 'team'],\n\t\t\t\t\t\t\tuseMultipleTabs: true,\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t\trecentTabOptions: {\n\t\t\t\t\tid: 'recents',\n\t\t\t\t\tvisible: true,\n\t\t\t\t},\n\t\t\t\tdropdownMode: true,\n\t\t\t\tenableSearch: false,\n\t\t\t\thideOnDeselect: false,\n\t\t\t\tcontext: 'HR_STRUCTURE',\n\t\t\t\tevents: {\n\t\t\t\t\t'Item:onSelect': (event: BaseEvent<{ item: Item }>) => {\n\t\t\t\t\t\tconst item = event.getData().item;\n\n\t\t\t\t\t\tif (item.entityType === 'employee')\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.$emit('locate', item.customData.get('nodeId'));\n\t\t\t\t\t\t\tOrgChartActions.searchUserInDepartment(item.id);\n\t\t\t\t\t\t\tdialog.recentItemsToSave.push(item);\n\t\t\t\t\t\t\tdialog.saveRecentItems();\n\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tdialog.recentItemsToSave.push(item);\n\t\t\t\t\t\tdialog.saveRecentItems();\n\n\t\t\t\t\t\tthis.$emit('locate', item.id);\n\t\t\t\t\t},\n\t\t\t\t\tonLoad: (event) => {\n\t\t\t\t\t\tevent.target.items.get('user').forEach((item) => {\n\t\t\t\t\t\t\tif (!item.getSubtitle())\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\titem.setSubtitle(item.customData.get('position'));\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t},\n\t\t\t\t\t'SearchTab:onLoad': (event) => {\n\t\t\t\t\t\tevent.target.items.get('user')?.forEach((item) => {\n\t\t\t\t\t\t\tif (!item.getSubtitle())\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\titem.setSubtitle(item.customData.get('position'));\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t},\n\t\t\t\t\tonDestroy: () => {\n\t\t\t\t\t\tthis.searchDialog = this.getSearchDialog();\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t});\n\n\t\t\tconst dialogContainer = dialog.getContainer();\n\t\t\tDom.attr(dialogContainer, 'data-test-id', 'hr-org-chart_title-panel__search-dialog-container');\n\n\t\t\treturn dialog;\n\t\t},\n\n\t\tonEnter(): void\n\t\t{\n\t\t\tif (this.$refs.searchName)\n\t\t\t{\n\t\t\t\tthis.searchDialog.setTargetNode(this.$refs.searchName);\n\t\t\t\tif (!this.searchDialog.isOpen())\n\t\t\t\t{\n\t\t\t\t\tthis.searchDialog.show();\n\t\t\t\t}\n\t\t\t\tEvent.bind(window, 'mousedown', this.handleClickOutside);\n\t\t\t}\n\t\t},\n\t\thandleClickOutside(event): void\n\t\t{\n\t\t\tif (this.$refs.searchName\n\t\t\t\t&& !this.$refs.searchName.parentElement.contains(event.target) && !this.searchDialog.isOpen())\n\t\t\t{\n\t\t\t\tthis.clearSearch();\n\t\t\t\tthis.hideSearchbar();\n\t\t\t\tEvent.unbind(window, 'mousedown', this.handleClickOutside);\n\t\t\t}\n\t\t},\n\t\tsearch(value: string): void\n\t\t{\n\t\t\tif (!this.searchDialog.isOpen())\n\t\t\t{\n\t\t\t\tthis.searchDialog.show();\n\t\t\t}\n\n\t\t\tthis.searchDialog.search(value);\n\t\t},\n\t\tclearSearch()\n\t\t{\n\t\t\tthis.searchDialog.getSearchTab().clearResults();\n\t\t\tthis.searchDialog.selectTab('recents');\n\n\t\t\tif (this.$refs.searchName)\n\t\t\t{\n\t\t\t\tthis.$refs.searchName.value = '';\n\t\t\t\tthis.$refs.searchName.focus();\n\t\t\t}\n\t\t},\n\t},\n\n\ttemplate: `\n\t\t<div\n\t\t    class=\"humanresources-title-panel-search-bar-container\"\n\t\t    :class=\"{'--opened': showSearchBar}\"\n\t\t>\n\t\t  <div\n\t\t      class=\"humanresources-title-panel-search-bar-block__search\"\n\t\t      @click=\"showSearchbar\"\n\t\t\t\tdata-test-id=\"hr-org-chart_title-panel__search-bar-button\"\n\t\t  >\n\t\t    <BIcon :name=\"set.SEARCH_2\" :size=\"24\" class=\"hr-title-search-icon\"></BIcon>\n\t\t  </div>\n\t\t  <transition name=\"humanresources-title-panel-search-bar-fade\" mode=\"in-out\" @after-enter=\"onEnter\">\n\t\t    <div v-if=\"showSearchBar\"\n\t\t         class=\"humanresources-title-panel-search-bar-block__search-bar\"\n\t\t    >\n\t\t      <input\n\t\t          ref=\"searchName\"\n\t\t          key=\"searchInput\"\n\t\t          type=\"text\"\n\t\t          :placeholder=\"loc('HUMANRESOURCES_SEARCH_PLACEHOLDER_MSGVER_1')\"\n\t\t          v-focus\n\t\t          class=\"humanresources-title-panel-search-bar-block__search-input\"\n\t\t          @click=\"onEnter\"\n\t\t          @input=\"search($event.target.value)\"\n\t\t\t\t\tdata-test-id=\"hr-org-chart_title-panel__search-bar-input\"\n\t\t      >\n\t\t      <div\n\t\t          key=\"searchReset\"\n\t\t          @click=\"clearSearch\"\n\t\t          class=\"humanresources-title-panel-search-bar-block__search-reset\"\n\t\t      >\n\t\t        <div class=\"humanresources-title-panel-search-bar-block__search-cursor\"></div>\n\t\t        <BIcon\n\t\t            :name=\"set.CROSS_CIRCLE_50\"\n\t\t            :size=\"24\"\n\t\t            color=\"#2FC6F6\"\n\t\t        ></BIcon>\n\t\t      </div>\n\t\t    </div>\n\t\t  </transition>\n\t\t</div>\n\t`,\n};\n","import { RouteActionMenu } from 'humanresources.company-structure.structure-components';\nimport { Main } from 'ui.icon-set.api.core';\nimport { getColorCode } from 'humanresources.company-structure.utils';\nimport { sendData as analyticsSendData } from 'ui.analytics';\n\nimport 'ui.icon-set.main';\nimport { PermissionActions, PermissionChecker } from 'humanresources.company-structure.permission-checker';\n\nconst MenuOption = Object.freeze({\n\taccessRights: 'access-rights',\n\tteamAccessRights: 'team-access-rights',\n});\n\n// @vue/component\nexport const BurgerMenuButton = {\n\tname: 'BurgerMenuButton',\n\n\tcomponents: {\n\t\tRouteActionMenu,\n\t},\n\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tactionMenu: {\n\t\t\t\tvisible: false,\n\t\t\t},\n\t\t};\n\t},\n\n\tmounted(): void\n\t{\n\t\tconst permissionChecker = PermissionChecker.getInstance();\n\n\t\tthis.dropdownItems = [\n\t\t\t{\n\t\t\t\tid: MenuOption.accessRights,\n\t\t\t\ttitle: this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_CONFIG_PERMISSION_TITLE_MSGVER_1'),\n\t\t\t\tdescription: this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_CONFIG_PERMISSION_DESCR_MSGVER_1'),\n\t\t\t\tbIcon: {\n\t\t\t\t\tname: Main.PERSONS_2,\n\t\t\t\t\tsize: 20,\n\t\t\t\t\tcolor: getColorCode('paletteBlue50'),\n\t\t\t\t},\n\t\t\t\tdataTestId: 'hr-org-chart_title-panel__access-rights-button',\n\t\t\t\tpermission: permissionChecker.hasPermissionOfAction(PermissionActions.accessEdit),\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: MenuOption.teamAccessRights,\n\t\t\t\ttitle: this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_CONFIG_TEAM_PERMISSION_TITLE'),\n\t\t\t\tdescription: this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_CONFIG_TEAM_PERMISSION_DESCR'),\n\t\t\t\tbIcon: {\n\t\t\t\t\tname: Main.MY_PLAN,\n\t\t\t\t\tsize: 20,\n\t\t\t\t\tcolor: getColorCode('paletteBlue50'),\n\t\t\t\t},\n\t\t\t\tdataTestId: 'hr-org-chart_title-panel__team-access-rights-button',\n\t\t\t\tpermission: permissionChecker.hasPermissionOfAction(PermissionActions.teamAccessEdit),\n\t\t\t},\n\t\t];\n\t},\n\n\tmethods: {\n\t\tloc(phraseCode: string, replacements: { [p: string]: string } = {}): string\n\t\t{\n\t\t\treturn this.$Bitrix.Loc.getMessage(phraseCode, replacements);\n\t\t},\n\n\t\tactionMenuItemClickHandler(actionId: string): void\n\t\t{\n\t\t\tif (actionId === MenuOption.accessRights)\n\t\t\t{\n\t\t\t\tanalyticsSendData({ tool: 'structure', category: 'structure', event: 'open_roles' });\n\n\t\t\t\tBX.SidePanel.Instance.open('/hr/config/permission/', { usePadding: true });\n\t\t\t}\n\n\t\t\tif (actionId === MenuOption.teamAccessRights)\n\t\t\t{\n\t\t\t\tanalyticsSendData({ tool: 'structure', category: 'structure', event: 'open_roles' });\n\n\t\t\t\tBX.SidePanel.Instance.open('/hr/config/permission/?category=TEAM', { usePadding: true });\n\t\t\t}\n\t\t},\n\t},\n\n\ttemplate: `\n\t\t<span\n\t\t\tref=\"burgerMenuButton\"\n\t\t\t@click=\"actionMenu.visible = true\"\n\t\t\tclass=\"humanresources-title-panel__burger-menu-button\"\n\t\t\tdata-test-id=\"hr-org-chart_title-panel__burger-menu-button\"\n\t\t>\n\t\t\t<svg\n\t\t\t\tviewBox=\"0 0 24 24\"\n\t\t\t\tfill=\"none\"\n\t\t\t\tclass=\"humanresources-title-panel__icon\"\n\t\t\t\t:class=\"{'--selected': actionMenu.visible }\"\n\t\t\t\t>\n\t\t\t\t\t<path fill-rule=\"evenodd\" clip-rule=\"evenodd\" d=\"M18.7067 15.5577C18.8172 15.5577 18.9067 15.6473 18.9067 15.7577L18.9067 17.2424C18.9067 17.3528 18.8172 17.4424 18.7067 17.4424H5.29375C5.1833 17.4424 5.09375 17.3528 5.09375 17.2424L5.09379 15.7577C5.09379 15.6473 5.18333 15.5577 5.29379 15.5577H18.7067ZM18.7067 11.5577C18.8172 11.5577 18.9067 11.6473 18.9067 11.7577L18.9067 13.2424C18.9067 13.3528 18.8172 13.4424 18.7067 13.4424H5.29375C5.1833 13.4424 5.09375 13.3528 5.09375 13.2424L5.09379 11.7577C5.09379 11.6473 5.18333 11.5577 5.29379 11.5577H18.7067ZM18.7067 7.55774C18.8172 7.55774 18.9067 7.64729 18.9067 7.75774L18.9067 9.24238C18.9067 9.35284 18.8172 9.44238 18.7067 9.44238H5.29375C5.1833 9.44238 5.09375 9.35283 5.09375 9.24237L5.09379 7.75773C5.09379 7.64728 5.18333 7.55774 5.29379 7.55774H18.7067Z\" fill=\"#959ca4\"/>\n\t\t\t</svg>\n\t\t </span>\n\t\t<RouteActionMenu\n\t\t\tv-if=\"actionMenu.visible\"\n\t\t\tid=\"title-panel-burger-menu\"\n\t\t\t:items=\"dropdownItems.filter(item => item.permission)\"\n\t\t\t:bindElement=\"this.$refs.burgerMenuButton\"\n\t\t\t@action=\"actionMenuItemClickHandler($event)\"\n\t\t\t@close=\"this.actionMenu.visible = false\"\n\t\t\tcontainerDataTestId=\"hr-org-chart_title-panel__burger-menu-container\"\n\t\t/>\n\t`,\n\n};\n","import { AddButton } from './add-button/add-button.js';\nimport { SearchBar } from './search/search-bar.js';\nimport { BurgerMenuButton } from './burger-menu-button/burger-menu-button.js';\nimport { PermissionActions, PermissionChecker } from 'humanresources.company-structure.permission-checker';\nimport { AnalyticsSourceType } from 'humanresources.company-structure.api';\nimport { UI } from 'ui.notification';\nimport { Dom } from 'main.core';\nimport { BIcon, Set } from 'ui.icon-set.api.vue';\n\nimport './style.css';\n\nexport const TitlePanel = {\n\tcomponents: {\n\t\tAddButton,\n\t\tBurgerMenuButton,\n\t\tSearchBar,\n\t\tBIcon,\n\t\tSet,\n\t},\n\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tcanEditPermissions: false,\n\t\t\tcanAddNode: false,\n\t\t\ttoolbarStarActive: false,\n\t\t\tisHovered: false,\n\t\t};\n\t},\n\n\tcreated(): void\n\t{\n\t\tthis.toolbarStarElement = document.getElementById('uiToolbarStar');\n\t},\n\n\tmounted()\n\t{\n\t\ttry\n\t\t{\n\t\t\tconst permissionChecker = PermissionChecker.getInstance();\n\t\t\tthis.canEditPermissions = permissionChecker\n\t\t\t\t&& (permissionChecker.hasPermissionOfAction(PermissionActions.accessEdit)\n\t\t\t\t|| permissionChecker.hasPermissionOfAction(PermissionActions.teamAccessEdit)\n\t\t\t\t);\n\t\t\tthis.canAddNode = permissionChecker\n\t\t\t\t&& (\n\t\t\t\t\tpermissionChecker.hasPermissionWithAnyNode(PermissionActions.departmentCreate)\n\t\t\t\t\t|| permissionChecker.hasPermissionWithAnyNode(PermissionActions.teamCreate)\n\t\t\t\t);\n\t\t}\n\t\tcatch (error)\n\t\t{\n\t\t\tconsole.error('Failed to fetch data:', error);\n\t\t}\n\n\t\tconst observer = new MutationObserver(() => {\n\t\t\tthis.toolbarStarActive = Dom.hasClass(this.toolbarStarElement, 'ui-toolbar-star-active');\n\t\t});\n\n\t\tobserver.observe(this.toolbarStarElement, { attributes: true, attributeFilter: ['class'] });\n\n\t\tthis.toolbarStarActive = Dom.hasClass(this.toolbarStarElement, 'ui-toolbar-star-active');\n\t},\n\n\tname: 'title-panel',\n\n\temits: ['showWizard', 'locate'],\n\n\tcomputed: {\n\t\tset(): Set\n\t\t{\n\t\t\treturn Set;\n\t\t},\n\t\ttoolbarStarIcon(): string | null\n\t\t{\n\t\t\tif (this.isAirTemplate)\n\t\t\t{\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\tif (this.isHovered || this.toolbarStarActive)\n\t\t\t{\n\t\t\t\treturn this.set.FAVORITE_1;\n\t\t\t}\n\n\t\t\treturn this.set.FAVORITE_0;\n\t\t},\n\t\tisAirTemplate(): boolean\n\t\t{\n\t\t\treturn BX.Reflection.getClass('top.BX.Intranet.Bitrix24.Template') !== null;\n\t\t},\n\t\ttoolbarClassIcon(): string\n\t\t{\n\t\t\tif (!this.isAirTemplate)\n\t\t\t{\n\t\t\t\treturn 'humanresources-title-panel__star';\n\t\t\t}\n\n\t\t\treturn this.toolbarStarActive ? 'humanresources-title-panel__unpin' : 'humanresources-title-panel__pin';\n\t\t},\n\t},\n\n\tmethods: {\n\t\tloc(phraseCode: string, replacements: { [p: string]: string } = {}): string\n\t\t{\n\t\t\treturn this.$Bitrix.Loc.getMessage(phraseCode, replacements);\n\t\t},\n\t\taddDepartment(): void\n\t\t{\n\t\t\tthis.$emit('showWizard', { source: AnalyticsSourceType.HEADER });\n\t\t},\n\t\tonLocate(nodeId: number)\n\t\t{\n\t\t\tthis.$emit('locate', nodeId);\n\t\t},\n\t\ttriggerFavoriteStar()\n\t\t{\n\t\t\tthis.toolbarStarElement.click();\n\n\t\t\tUI.Notification.Center.notify({\n\t\t\t\tcontent: this.toolbarStarActive\n\t\t\t\t\t? this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_LEFT_MENU_UN_SAVED')\n\t\t\t\t\t: this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_LEFT_MENU_SAVED'),\n\t\t\t\tautoHideDelay: 2000,\n\t\t\t});\n\t\t},\n\t},\n\n\ttemplate: `\n\t\t<div class=\"humanresources-title-panel\">\n\t\t\t<p class=\"humanresources-title-panel__title\">\n\t\t\t\t{{ loc('HUMANRESOURCES_COMPANY_STRUCTURE_TITLE') }}\n\t\t\t</p>\n\t\t\t<BIcon\n\t\t\t\t:name=\"toolbarStarIcon\"\n\t\t\t\t:size=\"24\"\n\t\t\t\tcolor=\"rgba(149, 156, 164, 1)\"\n\t\t\t\t:class=\"toolbarClassIcon\"\n\t\t\t\t@mouseover=\"isHovered = true\"\n\t\t\t\t@mouseleave=\"isHovered = false\" @click=\"triggerFavoriteStar\"\n\t\t\t></BIcon>\n\t\t\t<AddButton\n\t\t\t\tv-if=\"canAddNode\"\n\t\t\t\t@addDepartment=\"addDepartment\"\n\t\t\t/>\n\t\t\t<div class=\"humanresources-title-panel__icon-buttons\">\n\t\t\t\t<BurgerMenuButton v-if=\"canEditPermissions\"/>\n\t\t\t\t<SearchBar @locate=\"onLocate\"/>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import { Type } from 'main.core';\n\ntype UrlProvidedParamsType = {\n\tfocusNodeId: ?number,\n};\n\nconst UrlParamNames = Object.freeze({\n\tFocusNodeId: 'focusNodeId',\n});\n\nexport class UrlProvidedParamsService\n{\n\tstatic getParams(): UrlProvidedParamsType\n\t{\n\t\tconst paramMap = this.#getParamsFromUrl();\n\n\t\treturn {\n\t\t\tfocusNodeId: this.#castAndValidate(UrlParamNames.FocusNodeId, paramMap.get(UrlParamNames.FocusNodeId)),\n\t\t};\n\t}\n\n\tstatic #getParamsFromUrl(): Map<$Values<typeof UrlParamNames>, string>\n\t{\n\t\tconst paramMap = new Map();\n\n\t\tconst urlSearchParams = new URLSearchParams(document.location.search);\n\t\tObject.values(UrlParamNames).forEach((paramName: string) => {\n\t\t\tconst paramValue = urlSearchParams.get(paramName);\n\t\t\tif (!paramValue)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tparamMap.set(paramName, paramValue);\n\t\t});\n\n\t\treturn paramMap;\n\t}\n\n\tstatic #castAndValidate(paramName: string, value: ?string): string | number | null\n\t{\n\t\tif (Type.isUndefined(value))\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tlet castedValue = value;\n\t\tif (paramName === UrlParamNames.FocusNodeId)\n\t\t{\n\t\t\tcastedValue = Number(value);\n\t\t\tif (!Type.isInteger(castedValue))\n\t\t\t{\n\t\t\t\treturn null;\n\t\t\t}\n\t\t}\n\n\t\treturn castedValue;\n\t}\n}\n","import './style.css';\nimport { UserListActionMenu } from 'humanresources.company-structure.structure-components';\nimport { events } from '../../../consts';\nimport { EventEmitter } from 'main.core.events';\nimport type { UserData } from 'humanresources.company-structure.utils';\n\n// @vue/component\nexport const HeadList = {\n\tname: 'headList',\n\n\tcomponents: {\n\t\tUserListActionMenu,\n\t},\n\n\tprops: {\n\t\titems: {\n\t\t\ttype: Array,\n\t\t\trequired: false,\n\t\t\tdefault: () => [],\n\t\t},\n\t\ttitle: {\n\t\t\ttype: String,\n\t\t\trequired: false,\n\t\t\tdefault: '',\n\t\t},\n\t\tcollapsed: {\n\t\t\ttype: Boolean,\n\t\t\trequired: false,\n\t\t\tdefault: false,\n\t\t},\n\t\ttype: {\n\t\t\ttype: String,\n\t\t\trequired: false,\n\t\t\tdefault: 'head',\n\t\t},\n\t\tisTeamEntity: {\n\t\t\ttype: Boolean,\n\t\t\trequired: false,\n\t\t\tdefault: false,\n\t\t},\n\t},\n\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tisCollapsed: false,\n\t\t\tisUpdating: true,\n\t\t\theadsVisible: false,\n\t\t};\n\t},\n\n\tcomputed:\n\t{\n\t\tdefaultAvatar(): String\n\t\t{\n\t\t\treturn '/bitrix/js/humanresources/company-structure/org-chart/src/images/default-user.svg';\n\t\t},\n\t\tdropdownItems(): Array<UserData>\n\t\t{\n\t\t\treturn this.items.map((item: UserData): UserData => {\n\t\t\t\tconst workPosition = this.getPositionText(item);\n\n\t\t\t\treturn { ...item, workPosition };\n\t\t\t});\n\t\t},\n\t\ttitleBar(): string\n\t\t{\n\t\t\treturn this.type === this.userTypes.deputy\n\t\t\t\t? this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_WIZARD_EMPLOYEE_DEPUTY_TITLE')\n\t\t\t\t: this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_WIZARD_EMPLOYEE_HEAD_TITLE')\n\t\t\t;\n\t\t},\n\t},\n\n\tcreated(): void\n\t{\n\t\tthis.userTypes = {\n\t\t\thead: 'head',\n\t\t\tdeputy: 'deputy',\n\t\t};\n\t},\n\n\tmethods:\n\t{\n\t\tloc(phraseCode: string, replacements: {[p: string]: string} = {}): string\n\t\t{\n\t\t\treturn this.$Bitrix.Loc.getMessage(phraseCode, replacements);\n\t\t},\n\t\thandleUserClick(url: string): void\n\t\t{\n\t\t\tBX.SidePanel.Instance.open(url, {\n\t\t\t\tcacheable: false,\n\t\t\t});\n\t\t},\n\t\tcloseHeadList(): void\n\t\t{\n\t\t\tif (this.headsVisible) // to prevent double unsubscription\n\t\t\t{\n\t\t\t\tthis.headsVisible = false;\n\t\t\t\tEventEmitter.unsubscribe(events.HR_DEPARTMENT_MENU_CLOSE, this.closeHeadList);\n\t\t\t\tEventEmitter.unsubscribe(events.HR_DRAG_DEPARTMENT, this.closeHeadList);\n\t\t\t}\n\t\t},\n\t\topenHeadList(): void\n\t\t{\n\t\t\tif (!this.headsVisible) // to prevent double subscription\n\t\t\t{\n\t\t\t\tthis.headsVisible = true;\n\t\t\t\tEventEmitter.subscribe(events.HR_DEPARTMENT_MENU_CLOSE, this.closeHeadList);\n\t\t\t\tEventEmitter.subscribe(events.HR_DRAG_DEPARTMENT, this.closeHeadList);\n\t\t\t}\n\t\t},\n\t\tgetPositionText(item: UserData): string\n\t\t{\n\t\t\treturn item.workPosition || this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_HEAD_POSITION');\n\t\t},\n\t},\n\n\ttemplate: `\n\t\t<div v-if=\"items.length\">\n\t\t\t<p v-if=\"title\" class=\"humanresources-tree__node_employees-title\">\n\t\t\t\t{{ title }}\n\t\t\t</p>\n\t\t\t<div\n\t\t\t\tclass=\"humanresources-tree__node_head\"\n\t\t\t\t:class=\"{ '--collapsed': collapsed }\"\n\t\t\t\tv-for=\"(item, index) in items.slice(0, 2)\"\n\t\t\t>\n\t\t\t\t<img\n\t\t\t\t\t:src=\"item.avatar ? encodeURI(item.avatar) : defaultAvatar\"\n\t\t\t\t\tclass=\"humanresources-tree__node_avatar --head\"\n\t\t\t\t\t:class=\"{ '--collapsed': collapsed }\"\n\t\t\t\t\t@click.stop=\"handleUserClick(item.url)\"\n\t\t\t\t/>\n\t\t\t\t<div class=\"humanresources-tree__node_head-text\">\n\t\t\t\t\t<span\n\t\t\t\t\t\t:bx-tooltip-user-id=\"item.id\"\n\t\t\t\t\t\tbx-tooltip-context=\"b24\"\n\t\t\t\t\t\tclass=\"humanresources-tree__node_head-name\"\n\t\t\t\t\t\t@click.stop=\"handleUserClick(item.url)\"\n\t\t\t\t\t>\n\t\t\t\t\t\t{{ item.name }}\n\t\t\t\t\t</span>\n\t\t\t\t\t<span v-if=\"!collapsed\" class=\"humanresources-tree__node_head-position\">\n\t\t\t\t\t\t{{ getPositionText(item) }}\n\t\t\t\t\t</span>\n\t\t\t\t</div>\n\t\t\t\t<span\n\t\t\t\t\tv-if=\"index === 1 && items.length > 2\"\n\t\t\t\t\tclass=\"humanresources-tree__node_head-rest\"\n\t\t\t\t\t:class=\"{ '--active': headsVisible }\"\n\t\t\t\t\t:data-test-id=\"'hr-company-structure_org-chart-tree__node-' + type + '-rest'\"\n\t\t\t\t\tref=\"showMoreHeadList\"\n\t\t\t\t\t@click.stop=\"openHeadList\"\n\t\t\t\t>\n\t\t\t\t\t{{ '+' + String(items.length - 2) }}\n\t\t\t\t</span>\n\t\t\t</div>\n\t\t</div>\n\t\t<UserListActionMenu\n\t\t\tv-if=\"headsVisible\"\n\t\t\t:id=\"type === userTypes.head ? 'head-list-popup-head' : 'head-list-popup-deputy'\"\n\t\t\t:items=\"dropdownItems\"\n\t\t\t:width=\"228\"\n\t\t\t:bindElement=\"$refs.showMoreHeadList[0]\"\n\t\t\t@close=\"closeHeadList\"\n\t\t\t:titleBar=\"titleBar\"\n\t\t/>\n\t`,\n};\n","import { Event, Dom, Tag } from 'main.core';\nimport { EventEmitter } from 'main.core.events';\nimport { events } from '../../../../consts';\n\nconst itemWidth = 278;\nconst gap = 24;\nconst mousedownHandler = ({ target, currentTarget: dragContainer }: MouseEvent) => {\n\tif (!Dom.hasClass(target, 'humanresources-tree__node_dnd-icon'))\n\t{\n\t\treturn;\n\t}\n\n\tevent.stopPropagation();\n\tconst draggedItem = target.closest('.humanresources-tree__node');\n\tconst draggedId = Number(draggedItem.dataset.id);\n\tconst children = [...dragContainer.children];\n\tconst draggedIndex = children.indexOf(draggedItem);\n\tconst ghost = createGhost(draggedItem);\n\tDom.append(ghost, dragContainer);\n\tlet transformX = 0;\n\tlet prevAffectedItems = [];\n\tlet targetIndex = null;\n\n\tconst mouseMoveHandler = (event: MouseEvent) => {\n\t\tDom.style(document.body, 'userSelect', 'none');\n\t\tDom.style(document.body, 'cursor', 'grabbing');\n\t\tDom.addClass(dragContainer, '--drag-progress');\n\t\tDom.addClass(draggedItem, '--dragging');\n\t\ttransformX += event.movementX / dragContainer.dataset.zoom;\n\t\tsetTransform(draggedItem, transformX);\n\t\tprevAffectedItems.forEach((affectedItem) => setTransform(affectedItem));\n\t\ttargetIndex = Math.trunc((draggedItem.offsetLeft + transformX) / (itemWidth + gap));\n\t\tif (targetIndex === draggedIndex)\n\t\t{\n\t\t\tsetTransform(ghost, draggedItem.offsetLeft);\n\n\t\t\treturn;\n\t\t}\n\n\t\tconst direction = draggedIndex < targetIndex ? 1 : -1;\n\t\tconst affectedItems = direction > 0\n\t\t\t? children.slice(draggedIndex + 1, targetIndex + 1)\n\t\t\t: children.slice(targetIndex, draggedIndex);\n\t\tconst fullWidth = itemWidth + gap;\n\t\taffectedItems.forEach((affectedItem) => setTransform(affectedItem, -direction * fullWidth));\n\t\tsetTransform(ghost, draggedItem.offsetLeft + (direction * affectedItems.length * fullWidth));\n\t\tprevAffectedItems = affectedItems;\n\t};\n\n\tconst mouseUpHandler = () => {\n\t\tDom.style(document.body, 'userSelect', '');\n\t\tDom.style(document.body, 'cursor', '');\n\t\tEvent.unbind(document, 'mousemove', mouseMoveHandler);\n\t\tEvent.unbind(document, 'mouseup', mouseUpHandler);\n\t\t[...prevAffectedItems, draggedItem].forEach((item) => setTransform(item));\n\t\tDom.removeClass(dragContainer, '--drag-progress');\n\t\tDom.removeClass(draggedItem, '--dragging');\n\t\tDom.remove(ghost);\n\t\tEventEmitter.emit(events.HR_DEPARTMENT_TOGGLE_CONNECTORS, { draggedId, shouldShow: true });\n\t\tif (draggedIndex === targetIndex)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst targetId = children[targetIndex] ? Number(children[targetIndex].dataset.id) : 0;\n\t\tif (targetId)\n\t\t{\n\t\t\tEventEmitter.emit(events.HR_DROP_DEPARTMENT, {\n\t\t\t\tdraggedId,\n\t\t\t\ttargetId,\n\t\t\t\taffectedItems: prevAffectedItems.map((item) => Number(item.dataset.id)),\n\t\t\t\tdirection: draggedIndex < targetIndex ? 1 : -1,\n\t\t\t});\n\t\t}\n\t};\n\tEvent.bind(document, 'mousemove', mouseMoveHandler);\n\tEvent.bind(document, 'mouseup', mouseUpHandler);\n\tEventEmitter.emit(events.HR_DEPARTMENT_TOGGLE_CONNECTORS, { draggedId, shouldShow: false });\n\tEventEmitter.emit(events.HR_DRAG_DEPARTMENT, { draggedId });\n};\n\nconst createGhost = (draggedItem: HTMLElement) => {\n\tconst { offsetWidth, offsetHeight, offsetLeft } = draggedItem;\n\n\treturn Tag.render`\n\t\t<div\n\t\t\tclass=\"humanresources-tree__node_dnd-ghost\"\n\t\t\tstyle=\"width: ${offsetWidth}px; height: ${offsetHeight}px; transform: translateX(${offsetLeft}px);\"\n\t\t></div>\n\t`;\n};\n\nconst setTransform = (element: HTMLElement, x: ?number) => {\n\tDom.style(element, 'transform', x ? `translate3d(${x}px, 0, 0)` : '');\n};\n\nexport const DragAndDrop = {\n\tmounted(el: HTMLElement): void\n\t{\n\t\tEvent.bind(el, 'mousedown', mousedownHandler);\n\t},\n\tupdated(el: HTMLElement, { value }): void\n\t{\n\t\tel.setAttribute('data-zoom', value);\n\t},\n};\n","import { PermissionChecker } from 'humanresources.company-structure.permission-checker';\nimport type { PermissionCheckerClass } from 'humanresources.company-structure.permission-checker';\nimport { Type } from 'main.core';\n\nexport class AbstractActionMenu\n{\n\tpermissionChecker: PermissionCheckerClass;\n\tentityId: number;\n\tanalyticSource: string;\n\tentityType: string;\n\n\tconstructor(entityId: number)\n\t{\n\t\tthis.permissionChecker = PermissionChecker.getInstance();\n\t\tthis.entityId = entityId;\n\t}\n\n\tgetItems(): Array\n\t{\n\t\tthrow new Error('Must override this function');\n\t}\n\n\tgetFilteredItems(): Array\n\t{\n\t\tif (!this.permissionChecker)\n\t\t{\n\t\t\treturn [];\n\t\t}\n\n\t\tconst items = this.getItems();\n\n\t\treturn items.filter((item) => {\n\t\t\tif (Type.isFunction(item.hasPermission))\n\t\t\t{\n\t\t\t\treturn item.hasPermission(this.permissionChecker, this.entityId);\n\t\t\t}\n\n\t\t\treturn false;\n\t\t});\n\t}\n\n\tonActionMenuItemClick(actionId: string): void\n\t{\n\t\tconst targetItem = this.items.find((item) => item.id === actionId);\n\t\ttargetItem?.invoke({\n\t\t\tentityId: this.entityId,\n\t\t\tanalyticSource: this.analyticSource,\n\t\t\tentityType: this.entityType,\n\t\t});\n\t}\n}\n","import type { PermissionCheckerClass } from 'humanresources.company-structure.permission-checker';\n\ntype BIcon = {\n\tname: string,\n\tsize: number,\n\tcolor: string,\n};\n\nexport class AbstractMenuItem\n{\n\tid: string;\n\ttitle: string;\n\tdescription: string;\n\tbIcon: BIcon;\n\tpermissionAction: string;\n\tdataTestId: string;\n\n\tconstructor({ id, title, description, bIcon, permissionAction, dataTestId })\n\t{\n\t\tthis.id = id;\n\t\tthis.title = title;\n\t\tthis.description = description;\n\t\tthis.bIcon = bIcon;\n\t\tthis.permissionAction = permissionAction;\n\t\tthis.dataTestId = dataTestId;\n\t}\n\n\tinvoke(options: Object): void\n\t{\n\t\tthrow new Error('Must override this function');\n\t}\n\n\thasPermission(permissionChecker: PermissionCheckerClass, entityId: number): boolean\n\t{\n\t\treturn permissionChecker.hasPermission(this.permissionAction, entityId);\n\t}\n}\n","export const MenuActions = Object.freeze({\n\teditDepartment: 'editDepartment',\n\taddDepartment: 'addDepartment',\n\taddEmployee: 'addEmployee',\n\teditEmployee: 'editEmployee',\n\tremoveDepartment: 'removeDepartment',\n\tmoveEmployee: 'moveEmployee',\n\tuserInvite: 'userInvite',\n\tteamRights: 'teamRights',\n\n\tmoveUserToAnotherDepartment: 'moveUserToAnotherDepartment',\n\tremoveUserFromDepartment: 'removeUserFromDepartment',\n\tfireUserFromCompany: 'fireUserFromCompany',\n});\n","import {\n\tPermissionActions,\n\tPermissionChecker,\n\tPermissionCheckerClass,\n} from 'humanresources.company-structure.permission-checker';\nimport { EntityTypes, getColorCode } from 'humanresources.company-structure.utils';\nimport { Loc } from 'main.core';\nimport { EventEmitter } from 'main.core.events';\nimport { Main } from 'ui.icon-set.api.core';\nimport { UI } from 'ui.notification';\nimport { events } from '../../../../consts';\nimport { AbstractMenuItem } from '../abstract-menu-item';\nimport { MenuActions } from '../../menu-actions';\n\nexport class AddDepartmentMenuItem extends AbstractMenuItem\n{\n\tpermissionChecker: PermissionCheckerClass;\n\n\tconstructor(entityType: string)\n\t{\n\t\tlet title = '';\n\t\tlet description = '';\n\n\t\t// temporary check for option\n\t\tconst permissionChecker = PermissionChecker.getInstance();\n\t\tif (permissionChecker.isTeamsAvailable)\n\t\t{\n\t\t\ttitle = entityType === EntityTypes.team\n\t\t\t\t? Loc.getMessage('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_DETAIL_EDIT_MENU_ADD_TEAM_TITLE')\n\t\t\t\t: Loc.getMessage('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_DETAIL_EDIT_MENU_ADD_DEPARTMENT_TITLE_MSGVER_1');\n\n\t\t\tdescription = entityType === EntityTypes.team\n\t\t\t\t? Loc.getMessage('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_DETAIL_EDIT_MENU_ADD_TEAM_SUBTITLE')\n\t\t\t\t: Loc.getMessage('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_DETAIL_EDIT_MENU_ADD_DEPARTMENT_SUBTITLE_MSGVER_1');\n\t\t}\n\t\telse\n\t\t{\n\t\t\ttitle = Loc.getMessage('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_DETAIL_EDIT_MENU_ADD_DEPARTMENT_TITLE_NO_TEAM');\n\t\t\tdescription = Loc.getMessage('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_DETAIL_EDIT_MENU_ADD_DEPARTMENT_SUBTITLE_NO_TEAM');\n\t\t}\n\n\t\tsuper({\n\t\t\tid: MenuActions.addDepartment,\n\t\t\ttitle,\n\t\t\tdescription,\n\t\t\tbIcon: {\n\t\t\t\tname: Main.CUBE_PLUS,\n\t\t\t\tsize: 20,\n\t\t\t\tcolor: getColorCode('paletteBlue50'),\n\t\t\t},\n\t\t\tpermissionAction: null,\n\t\t\tdataTestId: 'hr-company-structure_menu__add-department-item',\n\t\t});\n\n\t\tthis.permissionChecker = permissionChecker;\n\t}\n\n\tinvoke({ entityId, analyticSource, entityType }): void\n\t{\n\t\t// for a team we can create only another team\n\t\tif (entityType === EntityTypes.team)\n\t\t{\n\t\t\tif (!this.permissionChecker.isTeamsAvailable)\n\t\t\t{\n\t\t\t\tUI.Notification.Center.notify({\n\t\t\t\t\tcontent: Loc.getMessage('HUMANRESOURCES_COMPANY_STRUCTURE_TEAMS_DISABLED_ERROR_MSGVER_1'),\n\t\t\t\t\tautoHideDelay: 2000,\n\t\t\t\t});\n\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tEventEmitter.emit(events.HR_ENTITY_SHOW_WIZARD, {\n\t\t\t\tnodeId: entityId,\n\t\t\t\tisEditMode: false,\n\t\t\t\tshowEntitySelector: false,\n\t\t\t\tsource: analyticSource,\n\t\t\t\tentityType,\n\t\t\t});\n\t\t}\n\t\t// for a department we offer to chose entity\n\t\telse\n\t\t{\n\t\t\tEventEmitter.emit(events.HR_ENTITY_SHOW_WIZARD, {\n\t\t\t\tnodeId: entityId,\n\t\t\t\tisEditMode: false,\n\t\t\t\tshowEntitySelector: true,\n\t\t\t\tsource: analyticSource,\n\t\t\t});\n\t\t}\n\t}\n\n\thasPermission(permissionChecker: PermissionCheckerClass, entityId: number): boolean\n\t{\n\t\tif (this.entityType === EntityTypes.team)\n\t\t{\n\t\t\treturn permissionChecker.hasPermission(PermissionActions.teamCreate, entityId);\n\t\t}\n\n\t\treturn permissionChecker.hasPermission(PermissionActions.departmentCreate, entityId)\n\t\t\t|| permissionChecker.hasPermission(PermissionActions.teamCreate, entityId)\n\t\t;\n\t}\n}\n","import { PermissionActions } from 'humanresources.company-structure.permission-checker';\nimport { EntityTypes, getColorCode } from 'humanresources.company-structure.utils';\nimport { Loc } from 'main.core';\nimport { EventEmitter } from 'main.core.events';\nimport { Main } from 'ui.icon-set.api.core';\nimport { events } from '../../../../consts';\nimport { AbstractMenuItem } from '../abstract-menu-item';\nimport { MenuActions } from '../../menu-actions';\n\nexport class EditDepartmentMenuItem extends AbstractMenuItem\n{\n\tconstructor(entityType: string)\n\t{\n\t\tconst title = entityType === EntityTypes.team\n\t\t\t? Loc.getMessage('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_DETAIL_EDIT_MENU_EDIT_TEAM_TITLE')\n\t\t\t: Loc.getMessage('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_DETAIL_EDIT_MENU_EDIT_DEPARTMENT_TITLE');\n\n\t\tconst description = entityType === EntityTypes.team\n\t\t\t? Loc.getMessage('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_DETAIL_EDIT_MENU_EDIT_TEAM_SUBTITLE')\n\t\t\t: Loc.getMessage('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_DETAIL_EDIT_MENU_EDIT_DEPARTMENT_SUBTITLE');\n\n\t\tconst permissionAction = entityType === EntityTypes.team\n\t\t\t? PermissionActions.teamEdit\n\t\t\t: PermissionActions.departmentEdit\n\t\t;\n\n\t\tsuper({\n\t\t\tid: MenuActions.editDepartment,\n\t\t\ttitle,\n\t\t\tdescription,\n\t\t\tbIcon: {\n\t\t\t\tname: Main.EDIT_PENCIL,\n\t\t\t\tsize: 20,\n\t\t\t\tcolor: getColorCode('paletteBlue50'),\n\t\t\t},\n\t\t\tpermissionAction,\n\t\t\tdataTestId: 'hr-company-structure_menu__edit-department-item',\n\t\t});\n\t}\n\n\tinvoke({ entityId, analyticSource, refToFocus = 'title' }): void\n\t{\n\t\tEventEmitter.emit(events.HR_ENTITY_SHOW_WIZARD, {\n\t\t\tnodeId: entityId,\n\t\t\tisEditMode: true,\n\t\t\ttype: 'department',\n\t\t\tsource: analyticSource,\n\t\t\trefToFocus,\n\t\t});\n\t}\n}\n","import { PermissionActions } from 'humanresources.company-structure.permission-checker';\nimport { EntityTypes, getColorCode } from 'humanresources.company-structure.utils';\nimport { Loc } from 'main.core';\nimport { EventEmitter } from 'main.core.events';\nimport { Main } from 'ui.icon-set.api.core';\nimport { events } from '../../../../consts';\nimport { AbstractMenuItem } from '../abstract-menu-item';\nimport { MenuActions } from '../../menu-actions';\n\nexport class RemoveDepartmentMenuItem extends AbstractMenuItem\n{\n\tconstructor(entityType: string)\n\t{\n\t\tconst title = entityType === EntityTypes.team\n\t\t\t? Loc.getMessage('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_DETAIL_EDIT_MENU_REMOVE_TEAM_TITLE')\n\t\t\t: Loc.getMessage('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_DETAIL_EDIT_MENU_REMOVE_DEPARTMENT_TITLE');\n\n\t\tconst description = entityType === EntityTypes.team\n\t\t\t? Loc.getMessage('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_DETAIL_EDIT_MENU_REMOVE_TEAM_SUBTITLE')\n\t\t\t: Loc.getMessage('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_DETAIL_EDIT_MENU_REMOVE_DEPARTMENT_SUBTITLE');\n\n\t\tconst permissionAction = entityType === EntityTypes.team\n\t\t\t? PermissionActions.teamDelete\n\t\t\t: PermissionActions.departmentDelete\n\t\t;\n\n\t\tsuper({\n\t\t\tid: MenuActions.removeDepartment,\n\t\t\ttitle,\n\t\t\tdescription,\n\t\t\tbIcon: {\n\t\t\t\tname: Main.TRASH_BIN,\n\t\t\t\tsize: 20,\n\t\t\t\tcolor: getColorCode('paletteRed40'),\n\t\t\t},\n\t\t\tpermissionAction,\n\t\t\tdataTestId: 'hr-company-structure_menu__remove-department-item',\n\t\t});\n\t}\n\n\tinvoke({ entityId, entityType }): void\n\t{\n\t\tEventEmitter.emit(events.HR_ENTITY_REMOVE, { nodeId: entityId, entityType });\n\t}\n}\n","import { PermissionActions } from 'humanresources.company-structure.permission-checker';\nimport { getColorCode } from 'humanresources.company-structure.utils';\nimport { Loc } from 'main.core';\nimport { EventEmitter } from 'main.core.events';\nimport { Actions } from 'ui.icon-set.api.core';\nimport { events } from '../../../../consts';\nimport { AbstractMenuItem } from '../abstract-menu-item';\nimport { MenuActions } from '../../menu-actions';\n\nexport class TeamRightsMenuItem extends AbstractMenuItem\n{\n\tconstructor()\n\t{\n\t\tsuper({\n\t\t\tid: MenuActions.teamRights,\n\t\t\ttitle: Loc.getMessage('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_DETAIL_EDIT_MENU_TEAM_RIGHTS_TITLE'),\n\t\t\tdescription: Loc.getMessage('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_DETAIL_EDIT_MENU_TEAM_RIGHTS_SUBTITLE'),\n\t\t\tbIcon: {\n\t\t\t\tname: Actions.SETTINGS_2,\n\t\t\t\tsize: 20,\n\t\t\t\tcolor: getColorCode('paletteBlue50'),\n\t\t\t},\n\t\t\tpermissionAction: PermissionActions.teamSettingsEdit,\n\t\t\tdataTestId: 'hr-company-structure_menu__team-rights-item',\n\t\t});\n\t}\n\n\tinvoke({ entityId, analyticSource, entityType }): void\n\t{\n\t\tEventEmitter.emit(events.HR_ENTITY_SHOW_WIZARD, {\n\t\t\tnodeId: entityId,\n\t\t\tisEditMode: true,\n\t\t\ttype: 'teamRights',\n\t\t\tsource: analyticSource,\n\t\t});\n\t}\n}\n","import { memberRoles, teamMemberRoles } from 'humanresources.company-structure.api';\nimport { PermissionActions } from 'humanresources.company-structure.permission-checker';\nimport { EntityTypes, getColorCode } from 'humanresources.company-structure.utils';\nimport { Loc } from 'main.core';\nimport { CRM } from 'ui.icon-set.api.core';\nimport { AbstractMenuItem } from '../abstract-menu-item';\nimport { MenuActions } from '../../menu-actions';\nimport { UserManagementDialog } from 'humanresources.company-structure.user-management-dialog';\n\nexport class AddEmployeeMenuItem extends AbstractMenuItem\n{\n\trole: ?string;\n\n\tconstructor(entityType: string, role: ?string)\n\t{\n\t\tconst permissionAction = entityType === EntityTypes.team\n\t\t\t? PermissionActions.teamAddMember\n\t\t\t: PermissionActions.employeeAddToDepartment\n\t\t;\n\n\t\tsuper({\n\t\t\tid: MenuActions.addEmployee,\n\t\t\tbIcon: {\n\t\t\t\tname: CRM.PERSON_PLUS_2,\n\t\t\t\tsize: 20,\n\t\t\t\tcolor: getColorCode('paletteBlue50'),\n\t\t\t},\n\t\t\tpermissionAction,\n\t\t\tdataTestId: 'hr-company-structure_menu__add-employee-item',\n\t\t});\n\n\t\tthis.localize(entityType, role);\n\t}\n\n\tlocalize(entityType: string, role: ?string): [string, string]\n\t{\n\t\tconst i18nRole = ['head', 'employee'].includes(role) ? role : 'default';\n\t\tconst i18nType = entityType === EntityTypes.team ? 'team' : 'default';\n\n\t\tconst i18nMap = {\n\t\t\thead: {\n\t\t\t\tteam: {\n\t\t\t\t\ttitle: Loc.getMessage('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_DETAIL_TAB_USERS_MEMBER_ACTION_MENU_ADD_HEAD_TITLE'),\n\t\t\t\t\tdescription: Loc.getMessage('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_DETAIL_TAB_USERS_MEMBER_ACTION_MENU_ADD_TEAM_HEAD_SUBTITLE'),\n\t\t\t\t\trole: teamMemberRoles.head,\n\t\t\t\t},\n\t\t\t\tdefault: {\n\t\t\t\t\ttitle: Loc.getMessage('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_DETAIL_TAB_USERS_MEMBER_ACTION_MENU_ADD_HEAD_TITLE'),\n\t\t\t\t\tdescription: Loc.getMessage('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_DETAIL_TAB_USERS_MEMBER_ACTION_MENU_ADD_HEAD_SUBTITLE'),\n\t\t\t\t\trole: memberRoles.head,\n\t\t\t\t},\n\t\t\t},\n\t\t\temployee: {\n\t\t\t\tteam: {\n\t\t\t\t\ttitle: Loc.getMessage('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_DETAIL_TAB_USERS_MEMBER_ACTION_MENU_ADD_TEAM_EMPLOYEE_TITLE'),\n\t\t\t\t\tdescription: Loc.getMessage('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_DETAIL_TAB_USERS_MEMBER_ACTION_MENU_ADD_TEAM_EMPLOYEE_SUBTITLE'),\n\t\t\t\t\trole: teamMemberRoles.employee,\n\t\t\t\t},\n\t\t\t\tdefault: {\n\t\t\t\t\ttitle: Loc.getMessage('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_DETAIL_TAB_USERS_MEMBER_ACTION_MENU_ADD_EMPLOYEE_TITLE'),\n\t\t\t\t\tdescription: Loc.getMessage('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_DETAIL_TAB_USERS_MEMBER_ACTION_MENU_ADD_EMPLOYEE_SUBTITLE'),\n\t\t\t\t\trole: memberRoles.employee,\n\t\t\t\t},\n\t\t\t},\n\t\t\tdefault: {\n\t\t\t\tteam: {\n\t\t\t\t\ttitle: Loc.getMessage('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_DETAIL_EDIT_MENU_ADD_TEAM_EMPLOYEE_TITLE'),\n\t\t\t\t\tdescription: Loc.getMessage('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_DETAIL_EDIT_MENU_ADD_TEAM_EMPLOYEE_SUBTITLE'),\n\t\t\t\t\trole: null,\n\t\t\t\t},\n\t\t\t\tdefault: {\n\t\t\t\t\ttitle: Loc.getMessage('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_DETAIL_EDIT_MENU_ADD_EMPLOYEE_TITLE'),\n\t\t\t\t\tdescription: Loc.getMessage('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_DETAIL_EDIT_MENU_ADD_EMPLOYEE_SUBTITLE'),\n\t\t\t\t\trole: null,\n\t\t\t\t},\n\t\t\t},\n\t\t};\n\n\t\tthis.title = i18nMap[i18nRole][i18nType].title;\n\t\tthis.description = i18nMap[i18nRole][i18nType].description;\n\t\tthis.role = i18nMap[i18nRole][i18nType].role;\n\t}\n\n\tinvoke({ entityId, entityType }): void\n\t{\n\t\tUserManagementDialog.openDialog({\n\t\t\tnodeId: entityId,\n\t\t\ttype: 'add',\n\t\t\trole: this.role,\n\t\t\tentityType,\n\t\t});\n\t}\n}\n","import { PermissionActions } from 'humanresources.company-structure.permission-checker';\nimport { EntityTypes, getColorCode } from 'humanresources.company-structure.utils';\nimport { Loc } from 'main.core';\nimport { EventEmitter } from 'main.core.events';\nimport { Main } from 'ui.icon-set.api.core';\nimport { events } from '../../../../consts';\nimport { AbstractMenuItem } from '../abstract-menu-item';\nimport { MenuActions } from '../../menu-actions';\n\nexport class EditEmployeesMenuItem extends AbstractMenuItem\n{\n\trole: ?string;\n\n\tconstructor(entityType: string, role: ?string)\n\t{\n\t\tconst permissionAction = entityType === EntityTypes.team\n\t\t\t? PermissionActions.teamAddMember\n\t\t\t: PermissionActions.employeeAddToDepartment\n\t\t;\n\n\t\tsuper({\n\t\t\tid: MenuActions.editEmployee,\n\t\t\timageClass: '-hr-department-org-chart-menu-edit-list',\n\t\t\tbIcon: {\n\t\t\t\tname: Main.EDIT_MENU,\n\t\t\t\tsize: 20,\n\t\t\t\tcolor: getColorCode('paletteBlue50'),\n\t\t\t},\n\t\t\tpermissionAction,\n\t\t\tdataTestId: 'hr-company-structure_menu__edit-employee-item',\n\t\t});\n\n\t\tthis.localize(entityType, role);\n\t}\n\n\tlocalize(entityType: string, role: ?string): [string, string]\n\t{\n\t\tconst i18nRole = ['head', 'employee'].includes(role) ? role : 'default';\n\t\tconst i18nType = entityType === EntityTypes.team ? 'team' : 'default';\n\n\t\tconst i18nMap = {\n\t\t\thead: {\n\t\t\t\tteam: {\n\t\t\t\t\ttitle: Loc.getMessage('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_DETAIL_TAB_USERS_MEMBER_ACTION_MENU_EDIT_TEAM_HEAD_TITLE'),\n\t\t\t\t\tdescription: Loc.getMessage('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_DETAIL_TAB_USERS_MEMBER_ACTION_MENU_EDIT_TEAM_HEAD_SUBTITLE'),\n\t\t\t\t},\n\t\t\t\tdefault: {\n\t\t\t\t\ttitle: Loc.getMessage('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_DETAIL_TAB_USERS_MEMBER_ACTION_MENU_EDIT_HEAD_TITLE'),\n\t\t\t\t\tdescription: Loc.getMessage('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_DETAIL_TAB_USERS_MEMBER_ACTION_MENU_EDIT_HEAD_SUBTITLE'),\n\t\t\t\t},\n\t\t\t},\n\t\t\temployee: {\n\t\t\t\tteam: {\n\t\t\t\t\ttitle: Loc.getMessage('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_DETAIL_TAB_USERS_MEMBER_ACTION_MENU_EDIT_TEAM_EMPLOYEE_TITLE'),\n\t\t\t\t\tdescription: Loc.getMessage('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_DETAIL_TAB_USERS_MEMBER_ACTION_MENU_EDIT_TEAM_EMPLOYEE_SUBTITLE'),\n\t\t\t\t},\n\t\t\t\tdefault: {\n\t\t\t\t\ttitle: Loc.getMessage('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_DETAIL_TAB_USERS_MEMBER_ACTION_MENU_EDIT_EMPLOYEE_TITLE'),\n\t\t\t\t\tdescription: Loc.getMessage('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_DETAIL_TAB_USERS_MEMBER_ACTION_MENU_EDIT_TEAM_EMPLOYEE_SUBTITLE'),\n\t\t\t\t},\n\t\t\t},\n\t\t\tdefault: {\n\t\t\t\tteam: {\n\t\t\t\t\ttitle: Loc.getMessage('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_DETAIL_EDIT_MENU_EDIT_TEAM_EMPLOYEE_LIST_TITLE'),\n\t\t\t\t\tdescription: Loc.getMessage('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_DETAIL_EDIT_MENU_EDIT_TEAM_EMPLOYEE_LIST_SUBTITLE'),\n\t\t\t\t},\n\t\t\t\tdefault: {\n\t\t\t\t\ttitle: Loc.getMessage('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_DETAIL_EDIT_MENU_EDIT_EMPLOYEE_LIST_TITLE'),\n\t\t\t\t\tdescription: Loc.getMessage('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_DETAIL_EDIT_MENU_EDIT_EMPLOYEE_LIST_SUBTITLE'),\n\t\t\t\t},\n\t\t\t},\n\t\t};\n\n\t\tthis.title = i18nMap[i18nRole][i18nType].title;\n\t\tthis.description = i18nMap[i18nRole][i18nType].description;\n\t}\n\n\tinvoke({ entityId, analyticSource }): void\n\t{\n\t\tEventEmitter.emit(events.HR_ENTITY_SHOW_WIZARD, {\n\t\t\tnodeId: entityId,\n\t\t\tisEditMode: true,\n\t\t\ttype: 'employees',\n\t\t\tsource: analyticSource,\n\t\t});\n\t}\n}\n","import type { PermissionCheckerClass } from 'humanresources.company-structure.permission-checker';\nimport { PermissionActions } from 'humanresources.company-structure.permission-checker';\nimport { getColorCode } from 'humanresources.company-structure.utils';\nimport { Loc } from 'main.core';\nimport { Main } from 'ui.icon-set.api.core';\nimport { AbstractMenuItem } from '../abstract-menu-item';\nimport { MenuActions } from '../../menu-actions';\nimport { UserManagementDialog } from 'humanresources.company-structure.user-management-dialog';\n\nexport class MoveEmployeeMenuItem extends AbstractMenuItem\n{\n\tconstructor()\n\t{\n\t\tsuper({\n\t\t\tid: MenuActions.moveEmployee,\n\t\t\ttitle: Loc.getMessage('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_DETAIL_EDIT_MENU_MOVE_EMPLOYEE_TITLE'),\n\t\t\tdescription: Loc.getMessage('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_DETAIL_EDIT_MENU_MOVE_EMPLOYEE_SUBTITLE'),\n\t\t\tbIcon: {\n\t\t\t\tname: Main.PERSON_ARROW_LEFT_1,\n\t\t\t\tsize: 20,\n\t\t\t\tcolor: getColorCode('paletteBlue50'),\n\t\t\t},\n\t\t\tpermissionAction: PermissionActions.employeeAddToDepartment,\n\t\t\tdataTestId: 'hr-company-structure_menu__move-employee-item',\n\t\t});\n\t}\n\n\tinvoke({ entityId, analyticSource }): void\n\t{\n\t\tUserManagementDialog.openDialog({\n\t\t\tnodeId: entityId,\n\t\t\ttype: 'move',\n\t\t});\n\t}\n\n\thasPermission(permissionChecker: PermissionCheckerClass, entityId: number): boolean\n\t{\n\t\treturn permissionChecker.currentUserPermissions.ACTION_EMPLOYEE_REMOVE_FROM_DEPARTMENT\n\t\t\t&& permissionChecker.hasPermission(this.permissionAction, entityId)\n\t\t;\n\t}\n}\n","import { PermissionActions } from 'humanresources.company-structure.permission-checker';\nimport { getColorCode } from 'humanresources.company-structure.utils';\nimport { Loc } from 'main.core';\nimport { Main } from 'ui.icon-set.api.core';\nimport { AbstractMenuItem } from '../abstract-menu-item';\nimport { MenuActions } from '../../menu-actions';\n\nexport class UserInviteMenuItem extends AbstractMenuItem\n{\n\tconstructor()\n\t{\n\t\tsuper({\n\t\t\tid: MenuActions.userInvite,\n\t\t\ttitle: Loc.getMessage('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_DETAIL_EDIT_MENU_USER_INVITE_TITLE'),\n\t\t\tdescription: Loc.getMessage('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_DETAIL_EDIT_MENU_USER_INVITE_SUBTITLE'),\n\t\t\tbIcon: {\n\t\t\t\tname: Main.PERSON_LETTER,\n\t\t\t\tsize: 20,\n\t\t\t\tcolor: getColorCode('paletteBlue50'),\n\t\t\t},\n\t\t\tpermissionAction: PermissionActions.inviteToDepartment,\n\t\t\tdataTestId: 'hr-company-structure_menu__user-invite-item',\n\t\t});\n\t}\n\n\tinvoke({ entityId }): void\n\t{\n\t\tBX.SidePanel.Instance.open(\n\t\t\t'/bitrix/services/main/ajax.php?action=getSliderContent'\n\t\t\t+ '&c=bitrix%3Aintranet.invitation&mode=ajax'\n\t\t\t+ `&departments[]=${Number(entityId)}&firstInvitationBlock=invite-with-group-dp`,\n\t\t\t{ cacheable: false, allowChangeHistory: false, width: 1100 },\n\t\t);\n\t}\n}\n","import { EntityTypes } from 'humanresources.company-structure.utils';\nimport { AbstractActionMenu } from '../abstract-action-menu';\nimport { AddDepartmentMenuItem } from '../items/department/add-department-menu-item';\nimport { EditDepartmentMenuItem } from '../items/department/edit-department-menu-item';\nimport { RemoveDepartmentMenuItem } from '../items/department/remove-department-menu-item';\nimport { TeamRightsMenuItem } from '../items/department/team-rights-menu-item';\nimport { AddEmployeeMenuItem } from '../items/employees/add-employee-menu-item';\nimport { EditEmployeesMenuItem } from '../items/department/edit-employees-menu-item';\nimport { MoveEmployeeMenuItem } from '../items/employees/move-employee-menu-item';\nimport { UserInviteMenuItem } from '../items/employees/user-invite-menu-item';\n\nexport class EntityActionMenu extends AbstractActionMenu\n{\n\tconstructor(entityId: number, entityType: string, analyticSource: string)\n\t{\n\t\tsuper(entityId);\n\t\tthis.entityType = entityType;\n\t\tthis.analyticSource = analyticSource;\n\t\tthis.items = this.getFilteredItems();\n\t}\n\n\tgetItems(): Array\n\t{\n\t\tif (this.entityType === EntityTypes.team)\n\t\t{\n\t\t\treturn [\n\t\t\t\tnew EditDepartmentMenuItem(this.entityType),\n\t\t\t\tnew AddDepartmentMenuItem(this.entityType),\n\t\t\t\tnew EditEmployeesMenuItem(this.entityType, null),\n\t\t\t\tnew TeamRightsMenuItem(),\n\t\t\t\tnew AddEmployeeMenuItem(this.entityType),\n\t\t\t\tnew RemoveDepartmentMenuItem(this.entityType),\n\t\t\t];\n\t\t}\n\n\t\treturn [\n\t\t\tnew EditDepartmentMenuItem(this.entityType),\n\t\t\tnew AddDepartmentMenuItem(this.entityType),\n\t\t\tnew AddEmployeeMenuItem(this.entityType),\n\t\t\tnew EditEmployeesMenuItem(this.entityType, null),\n\t\t\tnew MoveEmployeeMenuItem(),\n\t\t\tnew UserInviteMenuItem(),\n\t\t\tnew RemoveDepartmentMenuItem(this.entityType),\n\t\t];\n\t}\n}\n","import { AnalyticsSourceType } from 'humanresources.company-structure.api';\nimport { EventEmitter } from 'main.core.events';\nimport { RouteActionMenu } from 'humanresources.company-structure.structure-components';\nimport { EntityTypes } from 'humanresources.company-structure.utils';\nimport 'ui.icon-set.main';\nimport { events } from '../../../consts';\nimport { EntityActionMenu } from '../../menu/menu/entity-action-menu';\n\n// @vue/component\nexport const DepartmentMenuButton = {\n\tname: 'DepartmentMenuButton',\n\n\tcomponents: {\n\t\tRouteActionMenu,\n\t},\n\n\tprops: {\n\t\tentityId: {\n\t\t\ttype: Number,\n\t\t\trequired: true,\n\t\t},\n\t\tentityType: {\n\t\t\ttype: String,\n\t\t\tdefault: EntityTypes.department,\n\t\t},\n\t},\n\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tmenuVisible: false,\n\t\t};\n\t},\n\n\tcomputed: {\n\t\tmenu(): EntityActionMenu\n\t\t{\n\t\t\treturn new EntityActionMenu(this.entityId, this.entityType, AnalyticsSourceType.DETAIL);\n\t\t},\n\t},\n\n\tmethods: {\n\t\tloc(phraseCode: string, replacements: { [p: string]: string } = {}): string\n\t\t{\n\t\t\treturn this.$Bitrix.Loc.getMessage(phraseCode, replacements);\n\t\t},\n\t\tonActionMenuItemClick(actionId: string): void\n\t\t{\n\t\t\tthis.menu.onActionMenuItemClick(actionId);\n\t\t},\n\t\tcloseMenu(): void\n\t\t{\n\t\t\tif (this.menuVisible)\n\t\t\t{\n\t\t\t\tthis.menuVisible = false;\n\t\t\t\tEventEmitter.unsubscribe(events.HR_DEPARTMENT_MENU_CLOSE, this.closeMenu);\n\t\t\t\tEventEmitter.unsubscribe(events.HR_DRAG_DEPARTMENT, this.closeMenu);\n\t\t\t}\n\t\t},\n\t\topenMenu(): void\n\t\t{\n\t\t\tif (!this.menuVisible)\n\t\t\t{\n\t\t\t\tthis.menuVisible = true;\n\t\t\t\tEventEmitter.subscribe(events.HR_DEPARTMENT_MENU_CLOSE, this.closeMenu);\n\t\t\t\tEventEmitter.subscribe(events.HR_DRAG_DEPARTMENT, this.closeMenu);\n\t\t\t}\n\t\t},\n\t},\n\n\ttemplate: `\n\t\t<div\n\t\t\tv-if=\"menu.items.length\"\n\t\t\tclass=\"ui-icon-set --more humanresources-tree__node_department-menu-button\"\n\t\t\t:class=\"{ '--focused': this.menuVisible }\"\n\t\t\tref=\"departmentMenuButton\"\n\t\t\tdata-test-id=\"tree-node-more-button\"\n\t\t\t@click.stop=\"openMenu\"\n\t\t>\n\t\t</div>\n\n\t\t<RouteActionMenu\n\t\t\tv-if=\"menuVisible\"\n\t\t\t:id=\"'tree-node-department-menu-' + entityId\"\n\t\t\t:width=\"302\"\n\t\t\t:items=\"menu.items\"\n\t\t\t:bindElement=\"this.$refs.departmentMenuButton\"\n\t\t\t@action=\"onActionMenuItemClick\"\n\t\t\t@close=\"closeMenu\"\n\t\t/>\n\t`,\n};\n","import { AnalyticsSourceType } from 'humanresources.company-structure.api';\nimport { PermissionChecker } from 'humanresources.company-structure.permission-checker';\nimport { BasePopup } from 'humanresources.company-structure.structure-components';\nimport { EntityTypes } from 'humanresources.company-structure.utils';\nimport { EventEmitter } from 'main.core.events';\nimport type { PopupOptions } from 'main.popup';\nimport { events } from '../../../consts';\nimport { EditDepartmentMenuItem } from '../../menu/items/department/edit-department-menu-item';\n\n// @vue/component\nexport const DepartmentInfoIconButton = {\n\tname: 'DepartmentInfoIconButton',\n\n\tcomponents: {\n\t\tBasePopup,\n\t},\n\n\tprops: {\n\t\tentityId: {\n\t\t\ttype: Number,\n\t\t\trequired: true,\n\t\t},\n\t\tcanvasZoom: {\n\t\t\ttype: Number,\n\t\t\trequired: true,\n\t\t},\n\t\tdescription: {\n\t\t\ttype: [String, null],\n\t\t\tdefault: null,\n\t\t},\n\t},\n\n\tdata(): { showPopup: boolean }\n\t{\n\t\treturn {\n\t\t\tshowPopup: false,\n\t\t};\n\t},\n\n\tcomputed:\n\t{\n\t\tpopupConfig(): PopupOptions\n\t\t{\n\t\t\tconst popupWidth = 340;\n\t\t\tconst buttonWidth = 22 * this.canvasZoom;\n\t\t\tconst initialPopupOffset = 41 - this.canvasZoom; // subtract 1px * zoom\n\t\t\tconst angleWidth = 33;\n\n\t\t\treturn {\n\t\t\t\twidth: popupWidth,\n\t\t\t\tbindElement: this.$refs.departmentMenuButton,\n\t\t\t\tbindOptions: { position: 'top' },\n\t\t\t\tborderRadius: '12px',\n\t\t\t\tcontentNoPaddings: true,\n\t\t\t\tcontentPadding: 0,\n\t\t\t\tpadding: 16,\n\t\t\t\toffsetTop: -2 * this.canvasZoom,\n\t\t\t\toffsetLeft: buttonWidth / 2 - popupWidth / 2 + initialPopupOffset,\n\t\t\t\tangleOffset: popupWidth / 2 - angleWidth / 2,\n\t\t\t};\n\t\t},\n\t},\n\n\tcreated(): void\n\t{\n\t\tthis.menuItem = new EditDepartmentMenuItem(EntityTypes.team);\n\t\tconst permissionChecker = PermissionChecker.getInstance();\n\n\t\tthis.canEdit = this.menuItem.hasPermission(permissionChecker, this.entityId);\n\t},\n\n\tmethods:\n\t{\n\t\tloc(phraseCode: string, replacements: { [p: string]: string } = {}): string\n\t\t{\n\t\t\treturn this.$Bitrix.Loc.getMessage(phraseCode, replacements);\n\t\t},\n\t\tonClose(): void\n\t\t{\n\t\t\tif (this.showPopup)\n\t\t\t{\n\t\t\t\tthis.showPopup = false;\n\t\t\t\tEventEmitter.unsubscribe(events.HR_DEPARTMENT_MENU_CLOSE, this.onClose);\n\t\t\t\tEventEmitter.unsubscribe(events.HR_DRAG_DEPARTMENT, this.onClose);\n\t\t\t}\n\t\t},\n\t\tonOpen(): void\n\t\t{\n\t\t\tif (!this.showPopup)\n\t\t\t{\n\t\t\t\tthis.showPopup = true;\n\t\t\t\tEventEmitter.subscribe(events.HR_DEPARTMENT_MENU_CLOSE, this.onClose);\n\t\t\t\tEventEmitter.subscribe(events.HR_DRAG_DEPARTMENT, this.onClose);\n\t\t\t}\n\t\t},\n\t\taddDescription(): void\n\t\t{\n\t\t\tthis.onClose();\n\t\t\tthis.menuItem.invoke({\n\t\t\t\tentityId: this.entityId,\n\t\t\t\tanalyticSource: AnalyticsSourceType.CARD,\n\t\t\t\trefToFocus: 'description',\n\t\t\t});\n\t\t},\n\t},\n\n\ttemplate: `\n\t\t<div\n\t\t\tv-if=\"canEdit || description\"\n\t\t\tclass=\"ui-icon-set --info-1 humanresources-tree__node_department-menu-button\"\n\t\t\t:class=\"{ '--focused': this.showPopup }\"\n\t\t\tref=\"departmentMenuButton\"\n\t\t\t@click.stop=\"onOpen\"\n\t\t\tdata-test-id=\"tree-node-info-button\"\n\t\t>\n\t\t</div>\n\t\t<BasePopup\n\t\t\tv-if=\"showPopup\"\n\t\t\t:config=\"popupConfig\"\n\t\t\t:id=\"'humanresources-tree__node_info-popup' + entityId\"\n\t\t\t@close=\"onClose\"\n\t\t>\n\t\t\t<div class=\"humanresources-tree__node_info-popup-content_description\" v-if=\"description\">\n\t\t\t\t{{ description }}\n\t\t\t</div>\n\t\t\t<div v-else class=\"humanresources-tree__node_info-popup-content\">\n\t\t\t\t<div class=\"humanresources-tree__node_info-popup-content_left\"></div>\n\t\t\t\t<div class=\"humanresources-tree__node_info-popup-content_right\">\n\t\t\t\t\t<div class=\"humanresources-tree__node_info-popup-content_right_title\">\n\t\t\t\t\t\t{{ loc('HUMANRESOURCES_COMPANY_STRUCTURE_INFO_POPUP_ADD_DESCRIPTION_TITLE') }}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"humanresources-tree__node_info-popup-content_right_text\">\n\t\t\t\t\t\t{{ loc('HUMANRESOURCES_COMPANY_STRUCTURE_INFO_POPUP_ADD_DESCRIPTION_TEXT') }}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div\n\t\t\t\t\t\tclass=\"ui-btn ui-btn-primary ui-btn-round ui-btn-xs ui-btn-no-caps\"\n\t\t\t\t\t\tdata-test-id=\"tree-node-info-popup_add-button\"\n\t\t\t\t\t\t@click=\"addDescription\"\n\t\t\t\t\t>\n\t\t\t\t\t\t{{ loc('HUMANRESOURCES_COMPANY_STRUCTURE_INFO_POPUP_ADD_DESCRIPTION_BUTTON') }}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</BasePopup>\n\t`,\n};\n","import { AnalyticsSourceType } from 'humanresources.company-structure.api';\nimport { EntityTypes } from 'humanresources.company-structure.utils';\nimport { BIcon, Set } from 'ui.icon-set.api.vue';\nimport 'ui.icon-set.main';\nimport { PermissionChecker } from 'humanresources.company-structure.permission-checker';\nimport { AddDepartmentMenuItem } from '../../menu/items/department/add-department-menu-item';\n\n// @vue/component\nexport const SubdivisionAddButton = {\n\tname: 'SubdivisionAddButton',\n\n\tcomponents: {\n\t\tBIcon,\n\t},\n\n\tprops: {\n\t\tentityId: {\n\t\t\ttype: Number,\n\t\t\trequired: true,\n\t\t},\n\t\tentityType: {\n\t\t\ttype: String,\n\t\t\tdefault: EntityTypes.department,\n\t\t},\n\t},\n\n\tcomputed:\n\t{\n\t\tset(): Set\n\t\t{\n\t\t\treturn Set;\n\t\t},\n\t},\n\n\tcreated(): void\n\t{\n\t\tthis.menuItem = new AddDepartmentMenuItem(this.entityType);\n\t\tconst permissionChecker = PermissionChecker.getInstance();\n\n\t\tthis.canShow = this.menuItem.hasPermission(permissionChecker, this.entityId);\n\t},\n\n\tmethods: {\n\t\tloc(phraseCode: string, replacements: { [p: string]: string } = {}): string\n\t\t{\n\t\t\treturn this.$Bitrix.Loc.getMessage(phraseCode, replacements);\n\t\t},\n\t\taddSubdivision(): void\n\t\t{\n\t\t\tthis.menuItem.invoke({\n\t\t\t\tentityId: this.entityId,\n\t\t\t\tanalyticSource: AnalyticsSourceType.PLUS,\n\t\t\t\tentityType: this.entityType,\n\t\t\t});\n\t\t},\n\t},\n\n\ttemplate: `\n\t\t<div class=\"humanresources-tree__node_add-subdivision\" v-if=\"canShow\">\n\t\t  <button class=\"humanresources-tree__node_add-button\" @click=\"addSubdivision\">\n\t\t    <BIcon :name=\"set.PLUS_20\" :size=\"32\" class=\"humanresources-tree__node_add-icon\"></BIcon>\n\t\t  </button>\n\t\t</div>\n\t`,\n};\n","import { Dom, Loc } from 'main.core';\nimport { useChartStore } from 'humanresources.company-structure.chart-store';\nimport { mapState } from 'ui.vue3.pinia';\nimport { getMemberRoles, type MemberRolesType } from 'humanresources.company-structure.api';\nimport { Hint } from 'humanresources.company-structure.structure-components';\nimport { EventEmitter } from 'main.core.events';\nimport { events } from '../../../consts';\nimport { EntityTypes } from 'humanresources.company-structure.utils';\nimport { HeadList } from './head-list';\nimport { DragAndDrop } from './directives/drag-and-drop';\nimport { DepartmentMenuButton } from './department-menu-button';\nimport { DepartmentInfoIconButton } from './department-info-icon-button';\nimport { SubdivisionAddButton } from './subdivision-add-button';\nimport {\n\tPermissionActions,\n\tPermissionChecker,\n\tPermissionLevels,\n} from 'humanresources.company-structure.permission-checker';\nimport type { MountedDepartment, TreeItem, TreeNodeData } from '../../../types';\nimport './style.css';\n\n// @vue/component\nexport const TreeNode = {\n\tname: 'treeNode',\n\n\tcomponents: {\n\t\tDepartmentMenuButton,\n\t\tHeadList,\n\t\tSubdivisionAddButton,\n\t\tDepartmentInfoIconButton,\n\t},\n\n\tdirectives: { hint: Hint, dnd: DragAndDrop },\n\n\tinject: ['getTreeBounds'],\n\n\tprops: {\n\t\tnodeId: {\n\t\t\ttype: Number,\n\t\t\trequired: true,\n\t\t},\n\t\texpandedNodes: {\n\t\t\ttype: Array,\n\t\t\trequired: true,\n\t\t},\n\t\tcanvasZoom: {\n\t\t\ttype: Number,\n\t\t\trequired: true,\n\t\t},\n\t\tcurrentDepartments: {\n\t\t\ttype: Array,\n\t\t\trequired: true,\n\t\t},\n\t\tisShown: {\n\t\t\ttype: Boolean,\n\t\t\trequired: false,\n\t\t\tdefault: true,\n\t\t},\n\t},\n\n\temits: ['calculatePosition'],\n\n\tdata(): TreeNodeData\n\t{\n\t\treturn {\n\t\t\tchildrenOffset: 0,\n\t\t\tchildrenMounted: false,\n\t\t\tshowInfo: true,\n\t\t\tshowDnd: true,\n\t\t};\n\t},\n\n\tcomputed:\n\t{\n\t\tmemberRoles(): MemberRolesType\n\t\t{\n\t\t\treturn getMemberRoles(this.nodeData.entityType);\n\t\t},\n\t\tnodeData(): TreeItem\n\t\t{\n\t\t\treturn this.departments.get(this.nodeId);\n\t\t},\n\t\tnodeClass(): { [key: string]: boolean; }\n\t\t{\n\t\t\treturn {\n\t\t\t\t'--expanded': this.expandedNodes.includes(this.nodeId),\n\t\t\t\t'--current-department': this.isCurrentDepartment,\n\t\t\t\t'--focused': this.focusedNode === this.nodeId,\n\t\t\t\t'--with-restricted-access-rights': !this.showInfo,\n\t\t\t\t'--team': this.isTeamEntity,\n\t\t\t};\n\t\t},\n\t\tsubdivisionsClass(): { [key: string]: boolean; }\n\t\t{\n\t\t\treturn {\n\t\t\t\t'humanresources-tree__node_arrow': this.hasChildren,\n\t\t\t\t'--up': this.hasChildren && this.isExpanded,\n\t\t\t\t'--down': this.hasChildren && !this.isExpanded,\n\t\t\t\t'--transparent': !this.hasChildren,\n\t\t\t};\n\t\t},\n\t\thasChildren(): boolean\n\t\t{\n\t\t\treturn this.nodeData.children?.length > 0;\n\t\t},\n\t\tisExpanded(): boolean\n\t\t{\n\t\t\treturn this.expandedNodes.includes(this.nodeId);\n\t\t},\n\t\tisCurrentDepartment(): Boolean\n\t\t{\n\t\t\treturn this.currentDepartments.includes(this.nodeId);\n\t\t},\n\t\thead(): ?TreeItem['heads']\n\t\t{\n\t\t\treturn this.nodeData.heads?.filter((head) => {\n\t\t\t\treturn head.role === this.memberRoles.head;\n\t\t\t});\n\t\t},\n\t\tdeputy(): ?TreeItem['heads']\n\t\t{\n\t\t\treturn this.nodeData.heads?.filter((head) => {\n\t\t\t\treturn head.role === this.memberRoles.deputyHead;\n\t\t\t});\n\t\t},\n\t\temployeeCount(): number\n\t\t{\n\t\t\treturn this.nodeData.userCount - this.nodeData.heads.length;\n\t\t},\n\t\tchildNodeStyle(): { left: String; }\n\t\t{\n\t\t\treturn { left: `${this.childrenOffset}px` };\n\t\t},\n\t\tshowSubdivisionAddButton(): boolean\n\t\t{\n\t\t\treturn this.expandedNodes.includes(this.nodeId) || this.focusedNode === this.nodeId;\n\t\t},\n\t\tisTeamEntity(): boolean\n\t\t{\n\t\t\treturn this.nodeData.entityType === EntityTypes.team;\n\t\t},\n\t\tnodeDataTitle(): ?string\n\t\t{\n\t\t\tif (!this.isCurrentDepartment)\n\t\t\t{\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\treturn this.isTeamEntity\n\t\t\t\t? this.loc('HUMANRESOURCES_COMPANY_CURRENT_TEAM')\n\t\t\t\t: this.loc('HUMANRESOURCES_COMPANY_CURRENT_DEPARTMENT');\n\t\t},\n\t\tsubdivisionsText(): string\n\t\t{\n\t\t\tif (this.isTeamEntity)\n\t\t\t{\n\t\t\t\treturn this.nodeData.children?.length\n\t\t\t\t\t? this.locPlural('HUMANRESOURCES_COMPANY_TEAM_CHILDREN_COUNT', this.nodeData.children.length)\n\t\t\t\t\t: this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_TREE_TEAM_NO_SUBDEPARTMENTS');\n\t\t\t}\n\n\t\t\tif (!(this.nodeData.children?.length))\n\t\t\t{\n\t\t\t\treturn this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_TREE_NO_SUBDEPARTMENTS');\n\t\t\t}\n\n\t\t\tconst childDepartmentsCount = [...this.departments.values()].filter((department) => {\n\t\t\t\treturn department.entityType === EntityTypes.department && this.nodeData.children.includes(department.id);\n\t\t\t}).length;\n\n\t\t\tconst childTeamsCount = [...this.departments.values()].filter((department) => {\n\t\t\t\treturn department.entityType === EntityTypes.team && this.nodeData.children.includes(department.id);\n\t\t\t}).length;\n\n\t\t\tif ((childTeamsCount > 0) && (childDepartmentsCount > 0))\n\t\t\t{\n\t\t\t\treturn this.loc('HUMANRESOURCES_COMPANY_DEPARTMENT_CHILDREN_COUNT_WITH_CONJUNCTION', {\n\t\t\t\t\t'#DEPT_COUNT#': this.locPlural('HUMANRESOURCES_COMPANY_DEPARTMENT_CHILDREN_COUNT', childDepartmentsCount),\n\t\t\t\t\t'#TEAM_COUNT#': this.locPlural('HUMANRESOURCES_COMPANY_TEAM_CHILDREN_COUNT', childTeamsCount),\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tif (childDepartmentsCount > 0)\n\t\t\t{\n\t\t\t\treturn this.locPlural('HUMANRESOURCES_COMPANY_DEPARTMENT_CHILDREN_COUNT', childDepartmentsCount);\n\t\t\t}\n\n\t\t\tif (childTeamsCount > 0)\n\t\t\t{\n\t\t\t\treturn this.locPlural('HUMANRESOURCES_COMPANY_TEAM_CHILDREN_COUNT', childTeamsCount);\n\t\t\t}\n\n\t\t\treturn this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_TREE_NO_SUBDEPARTMENTS');\n\t\t},\n\t\t...mapState(useChartStore, ['departments', 'focusedNode']),\n\t},\n\n\twatch:\n\t{\n\t\thead(): void\n\t\t{\n\t\t\tthis.adaptHeight();\n\t\t},\n\t\tisShown(): void\n\t\t{\n\t\t\tthis.adaptHeight();\n\t\t},\n\t\tisExpanded:\n\t\t{\n\t\t\thandler(isExpanded: boolean): void\n\t\t\t{\n\t\t\t\tif (isExpanded && !this.childrenMounted)\n\t\t\t\t{\n\t\t\t\t\tthis.childrenMounted = true;\n\t\t\t\t}\n\t\t\t},\n\t\t\timmediate: true,\n\t\t},\n\t},\n\n\tcreated(): void\n\t{\n\t\tthis.width = 278;\n\t\tthis.gap = 24;\n\t\tthis.prevChildrenOffset = 0;\n\t\tthis.prevHeight = 0;\n\t},\n\n\tasync mounted(): Promise<void>\n\t{\n\t\tif (this.isTeamEntity)\n\t\t{\n\t\t\tthis.showInfo = PermissionChecker.getInstance().hasPermission(PermissionActions.teamView, this.nodeId);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.showInfo = PermissionChecker.getInstance().hasPermission(PermissionActions.structureView, this.nodeId);\n\t\t}\n\n\t\tthis.showDnd =\tPermissionChecker.getInstance().hasPermission(\n\t\t\tPermissionActions.departmentEdit,\n\t\t\tthis.nodeData.parentId,\n\t\t\tPermissionLevels.selfAndSub,\n\t\t) && PermissionChecker.getInstance().hasPermission(\n\t\t\tPermissionActions.structureView,\n\t\t\tthis.nodeData.parentId,\n\t\t\tPermissionLevels.selfAndSub,\n\t\t);\n\n\t\tthis.$emit('calculatePosition', this.nodeId);\n\t\tawait this.$nextTick();\n\t\tthis.prevHeight = this.$el.offsetHeight;\n\t\tEventEmitter.emit(events.HR_DEPARTMENT_CONNECT, {\n\t\t\tid: this.nodeId,\n\t\t\tparentId: this.nodeData.parentId,\n\t\t\thtml: this.$el,\n\t\t\tparentsPath: this.getParentsPath(this.nodeData.parentId),\n\t\t\t...this.calculateNodePoints(),\n\t\t});\n\t},\n\tunmounted(): void\n\t{\n\t\tDom.remove(this.$el);\n\t\tconst { prevParentId } = this.nodeData;\n\t\tif (!prevParentId)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.$emit('calculatePosition', this.nodeId);\n\t\tEventEmitter.emit(events.HR_DEPARTMENT_DISCONNECT, {\n\t\t\tid: this.nodeId,\n\t\t\tparentId: prevParentId,\n\t\t});\n\t},\n\n\tmethods:\n\t{\n\t\tloc(phraseCode: string, replacements: {[p: string]: string} = {}): string\n\t\t{\n\t\t\treturn this.$Bitrix.Loc.getMessage(phraseCode, replacements);\n\t\t},\n\t\tonDepartmentClick(targetId: string): void\n\t\t{\n\t\t\tif (!this.showInfo)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tEventEmitter.emit(events.HR_DEPARTMENT_FOCUS, {\n\t\t\t\tnodeId: this.nodeId,\n\t\t\t\tshowEmployees: targetId === 'employees',\n\t\t\t\tsubdivisionsSelected: targetId === 'subdivisions',\n\t\t\t});\n\t\t},\n\t\tcalculatePosition(nodeId: number): void\n\t\t{\n\t\t\tconst node = this.departments.get(this.nodeId);\n\n\t\t\tif (node.children.length === 0)\n\t\t\t{\n\t\t\t\tthis.childrenOffset = 0;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tconst gap = this.gap * (node.children.length - 1);\n\t\t\t\tthis.prevChildrenOffset = this.childrenOffset;\n\t\t\t\tthis.childrenOffset = (this.width - (this.width * node.children.length + gap)) / 2;\n\t\t\t}\n\n\t\t\tconst offset = this.childrenOffset - this.prevChildrenOffset;\n\t\t\tif (offset !== 0)\n\t\t\t{\n\t\t\t\tEventEmitter.emit(events.HR_DEPARTMENT_ADAPT_SIBLINGS, {\n\t\t\t\t\tparentId: this.nodeId,\n\t\t\t\t\tnodeId,\n\t\t\t\t\toffset,\n\t\t\t\t});\n\t\t\t}\n\t\t},\n\t\tlocPlural(phraseCode: string, count: number): string\n\t\t{\n\t\t\treturn Loc.getMessagePlural(phraseCode, count, { '#COUNT#': count });\n\t\t},\n\t\tcalculateNodePoints(): { startPoint: MountedDepartment['startPoint'], endPoint: MountedDepartment['endPoint'] }\n\t\t{\n\t\t\tconst { left, top, width } = this.$el.getBoundingClientRect();\n\t\t\tconst { $el: parentNode } = this.$parent.$parent;\n\t\t\tconst {\n\t\t\t\tleft: parentLeft,\n\t\t\t\ttop: parentTop,\n\t\t\t\twidth: parentWidth,\n\t\t\t\theight: parentHeight,\n\t\t\t} = parentNode.getBoundingClientRect();\n\t\t\tconst { x: chartX, y: chartY } = this.getTreeBounds();\n\n\t\t\treturn {\n\t\t\t\tstartPoint: {\n\t\t\t\t\tx: (parentLeft - chartX + parentWidth / 2) / this.canvasZoom,\n\t\t\t\t\ty: (parentTop - chartY + parentHeight) / this.canvasZoom,\n\t\t\t\t},\n\t\t\t\tendPoint: {\n\t\t\t\t\tx: (left - chartX + width / 2) / this.canvasZoom,\n\t\t\t\t\ty: (top - chartY) / this.canvasZoom,\n\t\t\t\t},\n\t\t\t};\n\t\t},\n\t\tgetParentsPath(parentId: number): Array<number>\n\t\t{\n\t\t\tlet topLevelId = parentId;\n\t\t\tconst parentsPath = [parentId];\n\t\t\twhile (topLevelId)\n\t\t\t{\n\t\t\t\tconst parentNode = this.departments.get(topLevelId);\n\t\t\t\ttopLevelId = parentNode.parentId;\n\t\t\t\tif (topLevelId)\n\t\t\t\t{\n\t\t\t\t\tparentsPath.push(topLevelId);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn parentsPath;\n\t\t},\n\t\tasync adaptHeight(): Promise<void>\n\t\t{\n\t\t\tif (!this.isShown)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tawait this.$nextTick();\n\t\t\tconst shift = this.$el.offsetHeight - this.prevHeight;\n\t\t\tif (shift !== 0)\n\t\t\t{\n\t\t\t\tEventEmitter.emit(events.HR_DEPARTMENT_ADAPT_CONNECTOR_HEIGHT, {\n\t\t\t\t\tnodeId: this.nodeId,\n\t\t\t\t\tshift,\n\t\t\t\t});\n\t\t\t\tthis.prevHeight = this.$el.offsetHeight;\n\t\t\t}\n\t\t},\n\t},\n\n\ttemplate: `\n\t\t<div\n\t\t\t:data-id=\"nodeId\"\n\t\t\t:class=\"nodeClass\"\n\t\t\t:data-title=\"nodeDataTitle\"\n\t\t\tclass=\"humanresources-tree__node\"\n\t\t\t:style=\"{\n\t\t\t\t'--team-bubble-background': nodeData.teamColor?.bubbleBackground,\n\t\t\t\t'--team-focused-border-color': nodeData.teamColor?.focusedBorderColor,\n\t\t\t\t'--node-expanded-color': nodeData.teamColor?.expandedBorderColor,\n\t\t\t}\"\n\t\t>\n\t\t\t<div\n\t\t\t\tclass=\"humanresources-tree__node_summary\"\n\t\t\t\t@click.stop=\"onDepartmentClick('department')\"\n\t\t\t>\n\t\t\t\t<template v-if=\"showInfo\">\n\t\t\t\t\t<div\n\t\t\t\t\t\tclass=\"humanresources-tree__node_department\"\n\t\t\t\t\t\t:style=\"{ 'background-color': nodeData.teamColor?.treeHeadBackground}\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<div class=\"humanresources-tree__node_department-title\">\n\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\tv-if=\"nodeData.parentId !== 0 && showDnd\"\n\t\t\t\t\t\t\t\tclass=\"humanresources-tree__node_dnd-icon ui-icon-set --more-points\"\n\t\t\t\t\t\t\t\t:class=\"{ '--team': isTeamEntity }\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<span\n\t\t\t\t\t\t\t\tv-hint\n\t\t\t\t\t\t\t\tclass=\"humanresources-tree__node_department-title_text\"\n\t\t\t\t\t\t\t\t:class=\"{ '--no-dnd': !showDnd }\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t{{nodeData.name}}\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"humanresources-tree__node_department-menu-icons\">\n\t\t\t\t\t\t\t<DepartmentInfoIconButton\n\t\t\t\t\t\t\t\tv-if=\"isTeamEntity\"\n\t\t\t\t\t\t\t\t:description=\"nodeData.description\"\n\t\t\t\t\t\t\t\t:entityId=\"nodeId\"\n\t\t\t\t\t\t\t\t:canvasZoom=\"canvasZoom\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t<DepartmentMenuButton\n\t\t\t\t\t\t\t\tv-if=\"head && deputy\"\n\t\t\t\t\t\t\t\t:entityId=\"nodeId\"\n\t\t\t\t\t\t\t\t:entityType=\"nodeData.entityType\"\n\t\t\t\t\t\t\t></DepartmentMenuButton>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"humanresources-tree__node_description\">\n\t\t\t\t\t\t<HeadList v-if=\"head\" :items=\"head\" :isTeamEntity=\"isTeamEntity\"></HeadList>\n\t\t\t\t\t\t<div\n\t\t\t\t\t\t\tv-else\n\t\t\t\t\t\t\tclass=\"humanresources-tree__node_load-skeleton --heads\"\n\t\t\t\t\t\t></div>\n\t\t\t\t\t\t<div v-if=\"deputy\" class=\"humanresources-tree__node_employees\">\n\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t<p class=\"humanresources-tree__node_employees-title\">\n\t\t\t\t\t\t\t\t\t{{\n\t\t\t\t\t\t\t\t\t\tisTeamEntity\n\t\t\t\t\t\t\t\t\t\t\t? loc('HUMANRESOURCES_COMPANY_STRUCTURE_TREE_TEAM_EMPLOYEES_TITLE')\n\t\t\t\t\t\t\t\t\t\t\t: loc('HUMANRESOURCES_COMPANY_STRUCTURE_TREE_EMPLOYEES_TITLE')\n\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t\t<span\n\t\t\t\t\t\t\t\t\tclass=\"humanresources-tree__node_employees-count\"\n\t\t\t\t\t\t\t\t\t@click.stop=\"onDepartmentClick('employees')\"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t{{locPlural('HUMANRESOURCES_COMPANY_STRUCTURE_TREE_EMPLOYEES_COUNT', employeeCount)}}\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div v-if=\"!deputy.length\"></div>\n\t\t\t\t\t\t\t<HeadList\n\t\t\t\t\t\t\t\t:items=\"deputy\"\n\t\t\t\t\t\t\t\t:title=\"loc('HUMANRESOURCES_COMPANY_STRUCTURE_TREE_DEPUTY_TITLE')\"\n\t\t\t\t\t\t\t\t:collapsed=\"true\"\n\t\t\t\t\t\t\t\t:type=\"'deputy'\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t</HeadList>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div\n\t\t\t\t\t\t\tv-else\n\t\t\t\t\t\t\tclass=\"humanresources-tree__node_load-skeleton --deputies\"\n\t\t\t\t\t\t></div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div\n\t\t\t\t\t\tclass=\"humanresources-tree__node_subdivisions\"\n\t\t\t\t\t\t:class=\"subdivisionsClass\"\n\t\t\t\t\t\t@click.stop=\"onDepartmentClick('subdivisions')\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<span>{{ subdivisionsText }}</span>\n\t\t\t\t\t</div>\n\t\t\t\t</template>\n\t\t\t\t<svg v-else width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" class=\"humanresources-tree__node_lock\">\n\t\t\t\t\t<path d=\"M12.0646 4.231C13.9529 4.231 15.4836 5.76968 15.4836 7.66775V10.5612H17.2905V7.66775C17.2905 4.76657 14.9507 2.41476 12.0645 2.41476C9.17827 2.41476 6.83847 4.76657 6.83847 7.66775V10.5612H8.64544V7.66775C8.64544 5.76968 10.1762 4.231 12.0646 4.231Z\" fill=\"#D5D7DB\"/>\n\t\t\t\t\t<path fill-rule=\"evenodd\" clip-rule=\"evenodd\" d=\"M7.14721 10.3237C6.12854 10.3237 5.30273 11.1495 5.30273 12.1682V18.506C5.30273 19.5246 6.12854 20.3504 7.14722 20.3504H17.1029C18.1216 20.3504 18.9474 19.5246 18.9474 18.506V12.1682C18.9474 11.1495 18.1216 10.3237 17.1029 10.3237H7.14721ZM12.9216 15.5869C12.9216 15.5685 12.93 15.5512 12.944 15.5392C13.2142 15.3085 13.3859 14.9643 13.3859 14.5797C13.3859 13.8847 12.8259 13.3214 12.1353 13.3214C11.4446 13.3214 10.8846 13.8847 10.8846 14.5797C10.8846 14.9643 11.0563 15.3085 11.3266 15.5392C11.3406 15.5512 11.3489 15.5685 11.3489 15.5869V16.7572C11.3489 17.1915 11.701 17.5435 12.1353 17.5435C12.5696 17.5435 12.9216 17.1915 12.9216 16.7572V15.5869Z\" fill=\"#D5D7DB\"/>\n\t\t\t\t</svg>\n\t\t\t\t<SubdivisionAddButton\n\t\t\t\t\tv-if=\"showSubdivisionAddButton\"\n\t\t\t\t\t:entityId=\"nodeId\"\n\t\t\t\t\t:entityType=\"nodeData.entityType\"\n\t\t\t\t\t@click.stop\n\t\t\t\t></SubdivisionAddButton>\n\t\t\t</div>\n\t\t\t<div\n\t\t\t\tv-if=\"nodeData.parentId === 0 && !hasChildren\"\n\t\t\t\tclass=\"humanresources-tree__node_empty-skeleton\"\n\t\t\t></div>\n\t\t\t<div\n\t\t\t\tv-if=\"hasChildren\"\n\t\t\t\tv-dnd=\"canvasZoom\"\n\t\t\t\tref=\"childrenNode\"\n\t\t\t\tclass=\"humanresources-tree__node_children\"\n\t\t\t\t:style=\"childNodeStyle\"\n\t\t\t>\n\t\t\t\t<TransitionGroup>\n\t\t\t\t\t<treeNode\n\t\t\t\t\t\tv-for=\"id in nodeData.children\"\n\t\t\t\t\t\tv-if=\"isExpanded || childrenMounted\"\n\t\t\t\t\t\tv-show=\"isExpanded\"\n\t\t\t\t\t\t:ref=\"'node-' + id\"\n\t\t\t\t\t\t:key=\"id\"\n\t\t\t\t\t\t:nodeId=\"id\"\n\t\t\t\t\t\t:expandedNodes=\"expandedNodes\"\n\t\t\t\t\t\t:canvasZoom=\"canvasZoom\"\n\t\t\t\t\t\t:currentDepartments=\"currentDepartments\"\n\t\t\t\t\t\t:isShown=\"isExpanded\"\n\t\t\t\t\t\t@calculatePosition=\"calculatePosition\"\n\t\t\t\t\t/>\n\t\t\t\t</TransitionGroup>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import { Event } from 'main.core';\nimport { mapState } from 'ui.vue3.pinia';\nimport { EventEmitter, type BaseEvent } from 'main.core.events';\nimport { useChartStore } from 'humanresources.company-structure.chart-store';\nimport { events } from '../../consts';\nimport type { ConnectorsData, MountedDepartment } from '../../types';\n\n// @vue/component\nexport const Connectors = {\n\tname: 'companyTreeConnectors',\n\n\texpose: [\n\t\t'toggleConnectorsVisibility',\n\t\t'toggleConnectorHighlighting',\n\t\t'adaptConnectorsAfterReorder',\n\t],\n\n\tprops: {\n\t\tisLocatedDepartmentVisible: {\n\t\t\ttype: Boolean,\n\t\t\trequired: true,\n\t\t},\n\t\t/** @type Map */\n\t\ttreeNodes: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t},\n\n\tdata(): { connectors: Record<string, ConnectorsData> }\n\t{\n\t\treturn { connectors: {} };\n\t},\n\n\tcomputed:\n\t{\n\t\t...mapState(useChartStore, ['focusedNode', 'departments']),\n\t},\n\n\tcreated(): void\n\t{\n\t\tthis.subscribeOnEvents();\n\t\tthis.prevWindowWidth = window.innerWidth;\n\t},\n\n\tbeforeUnmount(): void\n\t{\n\t\tthis.unsubscribeFromEvents();\n\t},\n\n\tmethods:\n\t{\n\t\tonAddConnector({ data }: MountedDepartment): void\n\t\t{\n\t\t\tconst { id, parentId } = data;\n\t\t\tif (!parentId)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst connector = this.connectors[`${parentId}-${id}`] ?? {};\n\t\t\tObject.assign(connector, data);\n\t\t\tif (connector.highlighted)\n\t\t\t{\n\t\t\t\tdelete this.connectors[`${parentId}-${id}`];\n\t\t\t}\n\n\t\t\tthis.connectors[`${parentId}-${id}`] = {\n\t\t\t\tshow: true,\n\t\t\t\thighlighted: false,\n\t\t\t\t...connector,\n\t\t\t};\n\t\t},\n\t\tonRemoveConnector({ data }: MountedDepartment): void\n\t\t{\n\t\t\tconst { parentId, id } = data;\n\t\t\tdelete this.connectors[`${parentId}-${id}`];\n\t\t},\n\t\tonAdaptSiblingConnectors({ data }: { nodeId: number; parentId: number; offset: number; }): void\n\t\t{\n\t\t\tconst { nodeId, parentId, offset } = data;\n\t\t\tconst parentDepartment = this.departments.get(parentId);\n\t\t\tif (parentDepartment.children.includes(nodeId))\n\t\t\t{\n\t\t\t\tthis.adaptConnectorsAfterMount(parentId, nodeId, offset);\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.adaptConnectorsAfterUnmount(parentId, nodeId, offset);\n\t\t},\n\t\tadaptConnectorsAfterMount(parentId: number, nodeId: number, offset: number): void\n\t\t{\n\t\t\tObject.values(this.connectors).forEach((connector) => {\n\t\t\t\tif (!connector.id)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (connector.parentId === parentId)\n\t\t\t\t{\n\t\t\t\t\tconst { x } = connector.endPoint;\n\t\t\t\t\tObject.assign(connector.endPoint, { x: x + offset });\n\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (connector.parentsPath.includes(parentId))\n\t\t\t\t{\n\t\t\t\t\tconst { startPoint: currentStartPoint, endPoint } = connector;\n\t\t\t\t\tObject.assign(currentStartPoint, { x: currentStartPoint.x + offset });\n\t\t\t\t\tObject.assign(endPoint, { x: endPoint.x + offset });\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\t\tadaptConnectorsAfterUnmount(parentId: number, nodeId: number, offset: number): void\n\t\t{\n\t\t\tconst values = Object.values(this.connectors);\n\t\t\tconst { endPoint } = this.connectors[`${parentId}-${nodeId}`];\n\t\t\tconst parsedSiblingConnectors = values.reduce((acc, connector) => {\n\t\t\t\tconst { endPoint: currentEndPoint, id, parentId: currentParentId } = connector;\n\t\t\t\tif (currentParentId !== parentId || id === nodeId)\n\t\t\t\t{\n\t\t\t\t\treturn acc;\n\t\t\t\t}\n\n\t\t\t\tconst sign = endPoint.x > currentEndPoint.x ? 1 : -1;\n\n\t\t\t\treturn {\n\t\t\t\t\t...acc,\n\t\t\t\t\t[id]: sign,\n\t\t\t\t};\n\t\t\t}, {});\n\t\t\tvalues.forEach((connector) => {\n\t\t\t\tconst {\n\t\t\t\t\tid: currentId,\n\t\t\t\t\tparentId: currentParentId,\n\t\t\t\t\tparentsPath,\n\t\t\t\t\tendPoint: currentEndPoint,\n\t\t\t\t\tstartPoint: currentStartPoint,\n\t\t\t\t} = connector;\n\t\t\t\tif (currentId === nodeId)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (currentParentId === parentId)\n\t\t\t\t{\n\t\t\t\t\tconst { x } = currentEndPoint;\n\t\t\t\t\tconst sign = parsedSiblingConnectors[currentId];\n\t\t\t\t\tObject.assign(currentEndPoint, { x: x + offset * sign });\n\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tconst ancestorId = parentsPath?.find((id) => {\n\t\t\t\t\treturn Boolean(parsedSiblingConnectors[id]);\n\t\t\t\t});\n\t\t\t\tif (ancestorId)\n\t\t\t\t{\n\t\t\t\t\tconst ancestorSign = parsedSiblingConnectors[ancestorId];\n\t\t\t\t\tObject.assign(currentStartPoint, { x: currentStartPoint.x + offset * ancestorSign });\n\t\t\t\t\tObject.assign(currentEndPoint, { x: currentEndPoint.x + offset * ancestorSign });\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\t\tadaptConnectorsAfterReorder(ids: number[], shift: Number, isRoot: boolean): void\n\t\t{\n\t\t\tids.forEach((departmentId) => {\n\t\t\t\tconst { parentId, children } = this.departments.get(departmentId);\n\t\t\t\tconst connector = this.connectors[`${parentId}-${departmentId}`];\n\t\t\t\tif (!connector)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tObject.assign(connector.endPoint, { x: connector.endPoint.x + shift });\n\t\t\t\tif (!isRoot)\n\t\t\t\t{\n\t\t\t\t\tObject.assign(connector.startPoint, { x: connector.startPoint.x + shift });\n\t\t\t\t}\n\n\t\t\t\tif (children?.length > 0)\n\t\t\t\t{\n\t\t\t\t\tthis.adaptConnectorsAfterReorder(children, shift, false);\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\t\tonAdaptConnectorHeight({ data }: BaseEvent): void\n\t\t{\n\t\t\tconst { shift, nodeId } = data;\n\t\t\tObject.values(this.connectors).forEach((connector) => {\n\t\t\t\tif (connector.parentId === nodeId)\n\t\t\t\t{\n\t\t\t\t\tObject.assign(connector.startPoint, { y: connector.startPoint.y + shift });\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\t\ttoggleConnectorsVisibility(parentId: number, show: boolean, expandedNodes: number[]): void\n\t\t{\n\t\t\tconst { children } = this.departments.get(parentId);\n\t\t\tchildren.forEach((childId) => {\n\t\t\t\tconst connector = this.connectors[`${parentId}-${childId}`] ?? {};\n\t\t\t\tthis.connectors = {\n\t\t\t\t\t...this.connectors,\n\t\t\t\t\t[`${parentId}-${childId}`]: { ...connector, show },\n\t\t\t\t};\n\t\t\t\tif (expandedNodes.includes(childId))\n\t\t\t\t{\n\t\t\t\t\tthis.toggleConnectorsVisibility(childId, show, expandedNodes);\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\t\ttoggleConnectorHighlighting(nodeId: number, expanded: boolean): void\n\t\t{\n\t\t\tconst { parentId } = this.departments.get(nodeId);\n\t\t\tif (!parentId)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (!expanded)\n\t\t\t{\n\t\t\t\tthis.connectors[`${parentId}-${nodeId}`] = {\n\t\t\t\t\t...this.connectors[`${parentId}-${nodeId}`],\n\t\t\t\t\thighlighted: false,\n\t\t\t\t};\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst highlightedConnector = this.connectors[`${parentId}-${nodeId}`] ?? {};\n\t\t\tdelete this.connectors[`${parentId}-${nodeId}`];\n\t\t\tthis.connectors = {\n\t\t\t\t...this.connectors,\n\t\t\t\t[`${parentId}-${nodeId}`]: {\n\t\t\t\t\t...highlightedConnector,\n\t\t\t\t\thighlighted: true,\n\t\t\t\t},\n\t\t\t};\n\t\t},\n\t\tgetPath(id: string): string\n\t\t{\n\t\t\tconst connector = this.connectors[id];\n\t\t\tconst { startPoint, endPoint, parentId } = connector;\n\n\t\t\tif (!startPoint || !endPoint)\n\t\t\t{\n\t\t\t\treturn '';\n\t\t\t}\n\n\t\t\tlet verticalLineHeight = 115;\n\t\t\tconst parentNode = this.treeNodes.get(parentId);\n\t\t\tconst parentNodeStyle = getComputedStyle(parentNode);\n\t\t\tconst minDepartmentHeight = parseInt(parentNodeStyle.getPropertyValue('--min-height'), 10);\n\t\t\tconst diffHeight = parentNode.offsetHeight - minDepartmentHeight;\n\t\t\tverticalLineHeight = diffHeight > 0 ? verticalLineHeight - diffHeight : verticalLineHeight;\n\t\t\tconst shiftY = 1;\n\n\t\t\tconst startY = startPoint.y - shiftY;\n\t\t\tconst shadowOffset = this.focusedNode === connector.id ? 12 : 0;\n\t\t\tconst rounded = { start: '', end: '' };\n\t\t\tlet arcRadius = 0;\n\n\t\t\tif (Math.round(startPoint.x) > Math.round(endPoint.x))\n\t\t\t{\n\t\t\t\tarcRadius = 15;\n\t\t\t\trounded.start = 'a15,15 0 0 1 -15,15';\n\t\t\t\trounded.end = 'a15,15 0 0 0 -15,15';\n\t\t\t}\n\t\t\telse if (Math.round(startPoint.x) < Math.round(endPoint.x))\n\t\t\t{\n\t\t\t\tarcRadius = -15;\n\t\t\t\trounded.start = 'a15,15 0 0 0 15,15';\n\t\t\t\trounded.end = 'a15,15 0 0 1 15,15';\n\t\t\t}\n\n\t\t\tconst adjustedEndY = endPoint.y - shadowOffset;\n\n\t\t\treturn [\n\t\t\t\t`M${startPoint.x} ${startY}`,\n\t\t\t\t`V${startY + verticalLineHeight}`,\n\t\t\t\t`${String(rounded.start)}`,\n\t\t\t\t`H${endPoint.x + arcRadius}`,\n\t\t\t\t`${String(rounded.end)}`,\n\t\t\t\t`V${adjustedEndY}`,\n\t\t\t].join('');\n\t\t},\n\t\tsubscribeOnEvents(): void\n\t\t{\n\t\t\tthis.events = {\n\t\t\t\t[events.HR_DEPARTMENT_CONNECT]: this.onAddConnector,\n\t\t\t\t[events.HR_DEPARTMENT_DISCONNECT]: this.onRemoveConnector,\n\t\t\t\t[events.HR_DEPARTMENT_ADAPT_SIBLINGS]: this.onAdaptSiblingConnectors,\n\t\t\t\t[events.HR_DEPARTMENT_ADAPT_CONNECTOR_HEIGHT]: this.onAdaptConnectorHeight,\n\t\t\t};\n\t\t\tObject.entries(this.events).forEach(([event, handle]) => {\n\t\t\t\tEventEmitter.subscribe(event, handle);\n\t\t\t});\n\t\t\tEvent.bind(window, 'resize', this.onResizeWindow);\n\t\t},\n\t\tunsubscribeFromEvents(): void\n\t\t{\n\t\t\tObject.entries(this.events).forEach(([event, handle]) => {\n\t\t\t\tEventEmitter.unsubscribe(event, handle);\n\t\t\t});\n\t\t\tEvent.unbind(window, 'resize', this.onResizeWindow);\n\t\t},\n\t\tonResizeWindow(): void\n\t\t{\n\t\t\tconst offset = (window.innerWidth - this.prevWindowWidth) / 2;\n\t\t\tthis.prevWindowWidth = window.innerWidth;\n\t\t\tif (offset === 0)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tObject.keys(this.connectors).forEach((key) => {\n\t\t\t\tconst connector = this.connectors[key];\n\t\t\t\tif (connector.startPoint && connector.endPoint)\n\t\t\t\t{\n\t\t\t\t\tconst startPointX = connector.startPoint.x;\n\t\t\t\t\tconst endPointX = connector.endPoint.x;\n\t\t\t\t\tObject.assign(connector.startPoint, { x: startPointX + offset });\n\t\t\t\t\tObject.assign(connector.endPoint, { x: endPointX + offset });\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\t},\n\n\ttemplate: `\n\t\t<svg class=\"humanresources-tree__connectors\" fill=\"none\">\n\t\t\t<marker\n\t\t\t\tid='arrow'\n\t\t\t\tmarkerUnits='userSpaceOnUse'\n\t\t\t\tmarkerWidth='20'\n\t\t\t\tmarkerHeight='12'\n\t\t\t\trefX='10'\n\t\t\t\trefY='10.5'\n\t\t\t>\n\t\t\t\t<path d=\"M1 1L10 10L19 1\" class=\"--highlighted\" />\n\t\t\t</marker>\n\t\t\t<path\n\t\t\t\tv-for=\"(connector, id) in connectors\"\n\t\t\t\tv-show=\"connector.show\"\n\t\t\t\t:ref=\"id\"\n\t\t\t\t:marker-end=\"connector.highlighted ? 'url(#arrow)' : null\"\n\t\t\t\t:class=\"{ '--highlighted': connector.highlighted }\"\n\t\t\t\t:id=\"id\"\n\t\t\t\t:d=\"getPath(id)\"\n\t\t\t></path>\n\t\t</svg>\n\t`,\n};\n","import { getData, postData } from 'humanresources.company-structure.api';\nimport { getNodeColorSettings } from 'humanresources.company-structure.utils';\nimport type { TreeItem } from './types';\n\nconst createTreeDataStore = (treeData: Array<TreeItem>): Map<number, TreeItem> => {\n\tconst dataMap = new Map();\n\ttreeData.forEach((item) => {\n\t\tconst { id, parentId, colorName, entityType } = item;\n\t\tconst mapItem = dataMap.get(id) ?? {};\n\t\tconst teamColor = getNodeColorSettings(colorName, entityType);\n\t\tdataMap.set(id, { ...mapItem, ...item, teamColor });\n\t\tif (parentId === 0)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst mapParentItem = dataMap.get(parentId) ?? {};\n\t\tconst children = mapParentItem.children ?? [];\n\t\tdataMap.set(parentId, {\n\t\t\t...mapParentItem,\n\t\t\tchildren: [...children, id],\n\t\t});\n\t});\n\n\treturn dataMap;\n};\n\nexport const chartAPI = {\n\tremoveDepartment: (id: Number): Promise<void> => {\n\t\treturn getData('humanresources.api.Structure.Node.delete', { nodeId: id });\n\t},\n\tgetDepartmentsData: (): Promise<Array<TreeItem>> => {\n\t\treturn getData('humanresources.api.Structure.get', {}, { tool: 'structure', category: 'structure', event: 'open_structure' });\n\t},\n\tgetCurrentDepartments: (): Promise<number[]> => {\n\t\treturn getData('humanresources.api.Structure.Node.current');\n\t},\n\tgetDictionary: (): Promise<string> => {\n\t\treturn getData('humanresources.api.Structure.dictionary');\n\t},\n\tgetUserId: (): Promise<number> => {\n\t\treturn getData('humanresources.api.User.getCurrentId');\n\t},\n\tfirstTimeOpened: (): Promise<void> => {\n\t\treturn postData('humanresources.api.User.firstTimeOpen');\n\t},\n\tcreateTreeDataStore,\n};\n","import { Runtime } from 'main.core';\nimport { EntityTypes } from 'humanresources.company-structure.utils';\nimport { MessageBox, MessageBoxButtons } from 'ui.dialogs.messagebox';\nimport { UI } from 'ui.notification';\nimport { ButtonColor } from 'ui.buttons';\nimport { UrlProvidedParamsService } from '../../classes/url-provided-params-service';\nimport { TreeNode } from './tree-node/tree-node';\nimport { Connectors } from './connectors';\nimport { useChartStore } from 'humanresources.company-structure.chart-store';\nimport { mapState } from 'ui.vue3.pinia';\nimport { EventEmitter, type BaseEvent } from 'main.core.events';\nimport { events } from '../../consts';\nimport { chartAPI } from '../../api';\nimport { sendData as analyticsSendData } from 'ui.analytics';\nimport { OrgChartActions } from '../../actions';\nimport type { MountedDepartment, TreeData } from '../../types';\nimport './style.css';\n\n// @vue/component\nexport const Tree = {\n\tname: 'companyTree',\n\n\tcomponents: { TreeNode, Connectors },\n\n\tprovide(): { [key: string]: Function }\n\t{\n\t\treturn {\n\t\t\tgetTreeBounds: () => this.getTreeBounds(),\n\t\t};\n\t},\n\n\tprops: {\n\t\tcanvasZoom: {\n\t\t\ttype: Number,\n\t\t\trequired: true,\n\t\t},\n\t},\n\n\temits: ['moveTo', 'showWizard', 'controlDetail'],\n\n\tdata(): TreeData\n\t{\n\t\treturn {\n\t\t\texpandedNodes: [],\n\t\t\tisLocatedDepartmentVisible: false,\n\t\t};\n\t},\n\n\tcomputed:\n\t{\n\t\trootId(): number\n\t\t{\n\t\t\tconst { id: rootId } = [...this.departments.values()].find((department) => {\n\t\t\t\treturn department.parentId === 0;\n\t\t\t});\n\n\t\t\treturn rootId;\n\t\t},\n\t\tconnectors(): Connectors\n\t\t{\n\t\t\treturn this.$refs.connectors;\n\t\t},\n\t\t...mapState(useChartStore, ['currentDepartments', 'userId', 'focusedNode', 'departments']),\n\t},\n\n\tcreated(): void\n\t{\n\t\tthis.treeNodes = new Map();\n\t\tthis.subscribeOnEvents();\n\t\tthis.loadHeads([this.rootId]);\n\t},\n\n\tmounted(): void\n\t{\n\t\tconst departmentToFocus = this.getDepartmentIdForInitialFocus();\n\t\tthis.currentDepartmentsLocated = [departmentToFocus];\n\n\t\tif (departmentToFocus !== this.rootId)\n\t\t{\n\t\t\tthis.expandDepartmentParents(departmentToFocus);\n\t\t\tthis.focus(departmentToFocus, { expandAfterFocus: true });\n\n\t\t\treturn;\n\t\t}\n\n\t\tthis.expandLowerDepartments();\n\t\tthis.focus(departmentToFocus);\n\t},\n\n\tbeforeUnmount(): void\n\t{\n\t\tthis.unsubscribeFromEvents();\n\t},\n\n\tmethods:\n\t{\n\t\tgetDepartmentIdForInitialFocus(): ?number\n\t\t{\n\t\t\tconst providedFocusNodeId = UrlProvidedParamsService.getParams().focusNodeId;\n\t\t\tif (providedFocusNodeId)\n\t\t\t{\n\t\t\t\tconst node = this.departments.get(providedFocusNodeId);\n\t\t\t\tif (node)\n\t\t\t\t{\n\t\t\t\t\treturn providedFocusNodeId;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfor (const currentDepartmentId: number of this.currentDepartments)\n\t\t\t{\n\t\t\t\tconst node = this.departments.get(currentDepartmentId);\n\n\t\t\t\tif (node.entityType === EntityTypes.department)\n\t\t\t\t{\n\t\t\t\t\treturn currentDepartmentId;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn this.rootId;\n\t\t},\n\t\tloc(phraseCode: string, replacements: {[p: string]: string} = {}): string\n\t\t{\n\t\t\treturn this.$Bitrix.Loc.getMessage(phraseCode, replacements);\n\t\t},\n\t\tgetTreeBounds(): DOMRect\n\t\t{\n\t\t\treturn this.$el.getBoundingClientRect();\n\t\t},\n\t\tonConnectDepartment({ data }: MountedDepartment): void\n\t\t{\n\t\t\tconst { id, html } = data;\n\t\t\tthis.treeNodes.set(id, html);\n\t\t\tconst departmentIdToFocus = this.getDepartmentIdForInitialFocus();\n\t\t\tif (id === departmentIdToFocus) // zoom to  department when loading\n\t\t\t{\n\t\t\t\tconst movingDelay = 1800;\n\t\t\t\tRuntime.debounce(() => {\n\t\t\t\t\tthis.moveTo(departmentIdToFocus);\n\t\t\t\t}, movingDelay)();\n\t\t\t}\n\t\t},\n\t\tonDisconnectDepartment({ data }: MountedDepartment): void\n\t\t{\n\t\t\tconst { id } = data;\n\t\t\tconst department = this.departments.get(id);\n\t\t\tdelete department.prevParentId;\n\t\t\tif (!department.parentId)\n\t\t\t{\n\t\t\t\tOrgChartActions.removeDepartment(id);\n\t\t\t}\n\t\t},\n\t\tonDragDepartment({ data }: BaseEvent): void\n\t\t{\n\t\t\tconst { draggedId } = data;\n\t\t\tconst department = this.departments.get(draggedId);\n\t\t\tconst { parentId } = department;\n\t\t\tconst parentDepartment = this.departments.get(parentId);\n\t\t\tparentDepartment.children.forEach((childId) => {\n\t\t\t\tif (this.expandedNodes.includes(childId))\n\t\t\t\t{\n\t\t\t\t\tthis.collapse(childId);\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\t\tonToggleConnectors({ data }: BaseEvent): void\n\t\t{\n\t\t\tconst { draggedId, shouldShow } = data;\n\t\t\tconst department = this.departments.get(draggedId);\n\t\t\tconst { parentId } = department;\n\t\t\tthis.connectors.toggleConnectorsVisibility(parentId, shouldShow, this.expandedNodes);\n\t\t},\n\t\tasync onDropDepartment({ data }: BaseEvent): Promise<void>\n\t\t{\n\t\t\tconst { draggedId, targetId, affectedItems, direction } = data;\n\t\t\tconst promise = OrgChartActions.orderDepartments(draggedId, targetId, direction, affectedItems.length);\n\t\t\tconst fullDepartmentWidth = 302;\n\t\t\tconst draggedShift = affectedItems.length * direction * fullDepartmentWidth;\n\t\t\tthis.connectors.adaptConnectorsAfterReorder([draggedId], draggedShift, true);\n\t\t\tconst affectedShift = -direction * fullDepartmentWidth;\n\t\t\tthis.connectors.adaptConnectorsAfterReorder(affectedItems, affectedShift, true);\n\t\t\tconst ordered = await promise;\n\t\t\tif (!ordered)\n\t\t\t{\n\t\t\t\tthis.connectors.adaptConnectorsAfterReorder([draggedId], -draggedShift, true);\n\t\t\t\tthis.connectors.adaptConnectorsAfterReorder(affectedItems, -affectedShift, true);\n\t\t\t}\n\t\t},\n\t\tonPublicFocusNode({ data }: BaseEvent): void\n\t\t{\n\t\t\tconst { nodeId } = data;\n\n\t\t\tconst node = this.departments.get(nodeId);\n\t\t\tif (!node)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tvoid this.locateToDepartment(nodeId);\n\t\t},\n\t\tcollapse(nodeId: number): void\n\t\t{\n\t\t\tthis.expandedNodes = this.expandedNodes.filter((expandedId) => expandedId !== nodeId);\n\t\t\tthis.connectors.toggleConnectorsVisibility(nodeId, false, this.expandedNodes);\n\t\t\tthis.connectors.toggleConnectorHighlighting(nodeId, false);\n\t\t},\n\t\tcollapseRecursively(nodeId: number): void\n\t\t{\n\t\t\tconst deepCollapse = (id: number) => {\n\t\t\t\tthis.collapse(id);\n\t\t\t\tconst node = this.departments.get(id);\n\t\t\t\tnode.children?.forEach((childId) => {\n\t\t\t\t\tif (this.expandedNodes.includes(childId))\n\t\t\t\t\t{\n\t\t\t\t\t\tdeepCollapse(childId);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t};\n\t\t\tconst { parentId } = this.departments.get(nodeId);\n\t\t\tconst expandedNode = this.expandedNodes.find((id) => {\n\t\t\t\tconst node = this.departments.get(id);\n\n\t\t\t\treturn node.parentId === parentId;\n\t\t\t});\n\t\t\tif (expandedNode)\n\t\t\t{\n\t\t\t\tdeepCollapse(expandedNode);\n\t\t\t}\n\t\t},\n\t\texpand(departmentId: number): void\n\t\t{\n\t\t\tthis.collapseRecursively(departmentId);\n\t\t\tthis.expandedNodes = [...this.expandedNodes, departmentId];\n\t\t\tthis.connectors.toggleConnectorsVisibility(departmentId, true, this.expandedNodes);\n\t\t\tthis.connectors.toggleConnectorHighlighting(departmentId, true);\n\t\t\tconst department = this.departments.get(departmentId);\n\t\t\tconst childrenWithoutHeads = department.children.filter((childId) => {\n\t\t\t\treturn !this.departments.get(childId).heads;\n\t\t\t});\n\t\t\tif (childrenWithoutHeads.length > 0)\n\t\t\t{\n\t\t\t\tthis.loadHeads(childrenWithoutHeads);\n\t\t\t}\n\n\t\t\tanalyticsSendData({ tool: 'structure', category: 'structure', event: 'expand_department' });\n\t\t},\n\t\tfocus(nodeId: number, options: Object = {}): void\n\t\t{\n\t\t\tconst { expandAfterFocus = false, showEmployees = false, subdivisionsSelected = false } = options;\n\t\t\tconst hasChildren = this.departments.get(nodeId).children?.length > 0;\n\n\t\t\tlet shouldExpand = expandAfterFocus || !this.expandedNodes.includes(nodeId);\n\t\t\tif (showEmployees)\n\t\t\t{\n\t\t\t\tshouldExpand = this.expandedNodes.includes(nodeId);\n\t\t\t}\n\n\t\t\tif (subdivisionsSelected || !hasChildren)\n\t\t\t{\n\t\t\t\tthis.collapseRecursively(nodeId);\n\t\t\t}\n\n\t\t\tif (hasChildren && shouldExpand)\n\t\t\t{\n\t\t\t\tthis.expand(nodeId);\n\t\t\t}\n\n\t\t\tif (this.focusedNode && !this.expandedNodes.includes(this.focusedNode))\n\t\t\t{\n\t\t\t\tthis.connectors.toggleConnectorHighlighting(this.focusedNode, false);\n\t\t\t}\n\n\t\t\tOrgChartActions.focusDepartment(nodeId);\n\t\t\tthis.connectors.toggleConnectorHighlighting(this.focusedNode, true);\n\t\t},\n\t\tonFocusDepartment({ data }: { nodeId: number }): void\n\t\t{\n\t\t\tconst { nodeId, showEmployees, subdivisionsSelected } = data;\n\t\t\tthis.focus(nodeId, { showEmployees, subdivisionsSelected });\n\t\t\tthis.$emit('controlDetail', {\n\t\t\t\tshowEmployees,\n\t\t\t\tpreventSwitch: subdivisionsSelected,\n\t\t\t});\n\t\t},\n\t\ttryRemoveDepartment(nodeId: number, entityType: string): void\n\t\t{\n\t\t\tconst localizationMap = {\n\t\t\t\tteam: {\n\t\t\t\t\ttitle: this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_CONFIRM_REMOVE_TEAM_TITLE'),\n\t\t\t\t\tmessage: this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_CONFIRM_REMOVE_TEAM_MESSAGE'),\n\t\t\t\t\tsuccess: this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_CONFIRM_REMOVE_TEAM_REMOVED'),\n\t\t\t\t\terror: this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_CONFIRM_REMOVE_TEAM_ERROR'),\n\t\t\t\t},\n\t\t\t\tdefault: {\n\t\t\t\t\ttitle: this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_CONFIRM_REMOVE_DEPARTMENT_TITLE'),\n\t\t\t\t\tmessage: this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_CONFIRM_REMOVE_DEPARTMENT_MESSAGE'),\n\t\t\t\t\tsuccess: this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_CONFIRM_REMOVE_DEPARTMENT_REMOVED'),\n\t\t\t\t\terror: this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_CONFIRM_REMOVE_DEPARTMENT_ERROR'),\n\t\t\t\t},\n\t\t\t};\n\t\t\tconst mapIndex = entityType === EntityTypes.team ? 'team' : 'default';\n\t\t\tconst messageBox = MessageBox.create({\n\t\t\t\ttitle: localizationMap[mapIndex].title,\n\t\t\t\tmessage: localizationMap[mapIndex].message,\n\t\t\t\tbuttons: MessageBoxButtons.OK_CANCEL,\n\t\t\t\tonOk: async (dialog: MessageBox) => {\n\t\t\t\t\ttry\n\t\t\t\t\t{\n\t\t\t\t\t\tawait this.removeDepartment(nodeId);\n\t\t\t\t\t\tUI.Notification.Center.notify({\n\t\t\t\t\t\t\tcontent: localizationMap[mapIndex].success,\n\t\t\t\t\t\t\tautoHideDelay: 2000,\n\t\t\t\t\t\t});\n\t\t\t\t\t\tdialog.close();\n\t\t\t\t\t}\n\t\t\t\t\tcatch\n\t\t\t\t\t{\n\t\t\t\t\t\tUI.Notification.Center.notify({\n\t\t\t\t\t\t\tcontent: localizationMap[mapIndex].error,\n\t\t\t\t\t\t\tautoHideDelay: 2000,\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tonCancel: (dialog: MessageBox) => dialog.close(),\n\t\t\t\tminWidth: 250,\n\t\t\t\tmaxWidth: 320,\n\t\t\t\tminHeight: 175,\n\t\t\t\tokCaption: this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_CONFIRM_REMOVE_DEPARTMENT_OK_CAPTION'),\n\t\t\t\tpopupOptions: { className: 'humanresources-tree__message-box', overlay: { opacity: 40 } },\n\t\t\t});\n\t\t\tconst okButton = messageBox.getOkButton();\n\t\t\tconst cancelButton = messageBox.getCancelButton();\n\t\t\tokButton.setRound(true);\n\t\t\tcancelButton.setRound(true);\n\t\t\tokButton.setColor(ButtonColor.DANGER);\n\t\t\tcancelButton.setColor(ButtonColor.LIGHT_BORDER);\n\t\t\tmessageBox.show();\n\t\t},\n\t\tasync removeDepartment(nodeId: number): Promise<void>\n\t\t{\n\t\t\tawait chartAPI.removeDepartment(nodeId);\n\t\t\tconst removableDepartment = this.departments.get(nodeId);\n\t\t\tconst { parentId, children: removableDepartmentChildren = [] } = removableDepartment;\n\t\t\tif (removableDepartmentChildren.length > 0)\n\t\t\t{\n\t\t\t\tthis.collapse(nodeId);\n\t\t\t}\n\n\t\t\tOrgChartActions.moveSubordinatesToParent(nodeId);\n\t\t\tawait this.$nextTick();\n\t\t\tOrgChartActions.markDepartmentAsRemoved(nodeId);\n\t\t\tthis.focus(parentId, { expandAfterFocus: true });\n\t\t\tthis.moveTo(parentId);\n\t\t},\n\t\texpandDepartmentParents(nodeId: number): void\n\t\t{\n\t\t\tlet { parentId } = this.departments.get(nodeId);\n\t\t\twhile (parentId)\n\t\t\t{\n\t\t\t\tif (!this.expandedNodes.includes(parentId))\n\t\t\t\t{\n\t\t\t\t\tthis.expand(parentId);\n\t\t\t\t}\n\n\t\t\t\tparentId = this.departments.get(parentId).parentId;\n\t\t\t}\n\t\t},\n\t\texpandLowerDepartments(): void\n\t\t{\n\t\t\tlet expandLevel = 0;\n\t\t\tconst expandRecursively = (departmentId: number) => {\n\t\t\t\tconst { children = [] } = this.departments.get(departmentId);\n\t\t\t\tif (expandLevel === 4 || children.length === 0)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tthis.expand(departmentId);\n\t\t\t\texpandLevel += 1;\n\t\t\t\tconst middleBound = Math.trunc(children.length / 2);\n\t\t\t\tconst childId = children[middleBound];\n\t\t\t\tif (this.departments.get(childId).children?.length > 0)\n\t\t\t\t{\n\t\t\t\t\texpandRecursively(childId);\n\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tfor (let i = middleBound - 1; i >= 0; i--)\n\t\t\t\t{\n\t\t\t\t\tif (traverseSibling(children[i]))\n\t\t\t\t\t{\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tfor (let i = middleBound + 1; i < children.length; i++)\n\t\t\t\t{\n\t\t\t\t\tif (traverseSibling(children[i]))\n\t\t\t\t\t{\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t};\n\n\t\t\tconst traverseSibling = (siblingId: number) => {\n\t\t\t\tconst { children: currentChildren = [] } = this.departments.get(siblingId);\n\n\t\t\t\tif (currentChildren.length > 0)\n\t\t\t\t{\n\t\t\t\t\texpandRecursively(siblingId);\n\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\n\t\t\t\treturn false;\n\t\t\t};\n\t\t\texpandRecursively(this.rootId);\n\t\t},\n\t\tasync locateToCurrentDepartment(): Promise<void>\n\t\t{\n\t\t\t// currentDepartmentsLocated manipulation needed to cycle through current departments\n\t\t\tif (this.currentDepartmentsLocated.length === this.currentDepartments.length)\n\t\t\t{\n\t\t\t\tthis.currentDepartmentsLocated = [];\n\t\t\t}\n\t\t\tconst currentDepartment = this.currentDepartments.find((item) => !this.currentDepartmentsLocated.includes(item));\n\t\t\tif (!currentDepartment)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.currentDepartmentsLocated.push(currentDepartment);\n\t\t\tawait this.locateToDepartment(currentDepartment);\n\t\t\tOrgChartActions.searchUserInDepartment(this.userId);\n\t\t},\n\t\tasync locateToDepartment(nodeId: number): Promise<void>\n\t\t{\n\t\t\tthis.isLocatedDepartmentVisible = false;\n\t\t\tthis.expandDepartmentParents(nodeId);\n\t\t\tthis.focus(nodeId, { expandAfterFocus: true });\n\t\t\t// $nextTick makes sure that this.getTreeBounds() returns correct value when nodeId is not visible\n\t\t\tawait this.$nextTick();\n\t\t\tthis.isLocatedDepartmentVisible = true;\n\t\t\tawait this.moveTo(nodeId);\n\t\t},\n\t\tasync moveTo(nodeId: number): Promise<void>\n\t\t{\n\t\t\tawait this.$nextTick();\n\t\t\tconst treeRect = this.getTreeBounds();\n\t\t\tconst centerX = treeRect.x + treeRect.width / 2;\n\t\t\tconst centerY = treeRect.y + treeRect.height / 2;\n\t\t\tconst treeNode = this.treeNodes.get(nodeId);\n\t\t\tconst treeNodeRect = treeNode.getBoundingClientRect();\n\t\t\tthis.$emit('moveTo', {\n\t\t\t\tx: centerX - treeNodeRect.x - treeNodeRect.width / 2,\n\t\t\t\ty: centerY - treeNodeRect.y - treeNodeRect.height / 2,\n\t\t\t\tnodeId,\n\t\t\t});\n\t\t},\n\t\tloadHeads(departmentIds: number[]): void\n\t\t{\n\t\t\tconst store = useChartStore();\n\t\t\tstore.loadHeads(departmentIds);\n\t\t},\n\t\tsubscribeOnEvents(): void\n\t\t{\n\t\t\tthis.events = {\n\t\t\t\t[events.HR_DEPARTMENT_CONNECT]: this.onConnectDepartment,\n\t\t\t\t[events.HR_DEPARTMENT_DISCONNECT]: this.onDisconnectDepartment,\n\t\t\t\t[events.HR_DEPARTMENT_FOCUS]: this.onFocusDepartment,\n\t\t\t\t[events.HR_DRAG_DEPARTMENT]: this.onDragDepartment,\n\t\t\t\t[events.HR_DROP_DEPARTMENT]: this.onDropDepartment,\n\t\t\t\t[events.HR_DEPARTMENT_TOGGLE_CONNECTORS]: this.onToggleConnectors,\n\t\t\t\t[events.HR_PUBLIC_FOCUS_NODE]: this.onPublicFocusNode,\n\t\t\t};\n\t\t\tObject.entries(this.events).forEach(([event, handle]) => {\n\t\t\t\tEventEmitter.subscribe(event, handle);\n\t\t\t});\n\t\t},\n\t\tunsubscribeFromEvents(): void\n\t\t{\n\t\t\tObject.entries(this.events).forEach(([event, handle]) => {\n\t\t\t\tEventEmitter.unsubscribe(event, handle);\n\t\t\t});\n\t\t},\n\t},\n\n\ttemplate: `\n\t\t<div\n\t\t\tclass=\"humanresources-tree\"\n\t\t\tv-if=\"departments.size > 0\"\n\t\t>\n\t\t\t<TreeNode\n\t\t\t\tclass=\"--root\"\n\t\t\t\t:key=\"rootId\"\n\t\t\t\t:nodeId=\"rootId\"\n\t\t\t\t:expandedNodes=\"[...expandedNodes]\"\n\t\t\t\t:canvasZoom=\"canvasZoom\"\n\t\t\t\t:currentDepartments=\"currentDepartments\"\n\t\t\t></TreeNode>\n\t\t\t<Connectors\n\t\t\t\tref=\"connectors\"\n\t\t\t\t:isLocatedDepartmentVisible=\"isLocatedDepartmentVisible\"\n\t\t\t\t:treeNodes=\"treeNodes\"\n\t\t\t></Connectors>\n\t\t</div>\n\t`,\n};\n","import { detailPanelWidth } from '../consts';\n\n// @vue/component\nexport const TransformPanel = {\n\tname: 'transform-panel',\n\n\tprops:\n\t{\n\t\tmodelValue: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t},\n\n\temits: ['locate', 'update:modelValue'],\n\n\tdata(): { selectedId: string; }\n\t{\n\t\treturn {\n\t\t\tselectedId: '',\n\t\t};\n\t},\n\n\tcomputed:\n\t{\n\t\tzoomInPercent(): string\n\t\t{\n\t\t\tconst percent = '<span class=\"humanresources-transform-panel__zoom_percent\">%</span>';\n\n\t\t\treturn `${(this.modelValue.zoom * 100).toFixed(0)}${percent}`;\n\t\t},\n\t},\n\n\tcreated(): void\n\t{\n\t\tthis.actions = Object.freeze({\n\t\t\tzoomIn: 'zoomIn',\n\t\t\tzoomOut: 'zoomOut',\n\t\t\tlocate: 'locate',\n\t\t\tnavigate: 'navigate',\n\t\t});\n\t},\n\n\tmethods:\n\t{\n\t\tloc(phraseCode: string, replacements: {[p: string]: string} = {}): string\n\t\t{\n\t\t\treturn this.$Bitrix.Loc.getMessage(phraseCode, replacements);\n\t\t},\n\t\tonZoom(zoomIn: boolean): void\n\t\t{\n\t\t\tconst leftBound = 0.2;\n\t\t\tconst rightBound = 3;\n\t\t\tlet direction = -1;\n\t\t\tif (zoomIn)\n\t\t\t{\n\t\t\t\tdirection = 1;\n\t\t\t\tthis.selectedId = this.actions.zoomIn;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.selectedId = this.actions.zoomOut;\n\t\t\t}\n\n\t\t\tconst zoom = Number((this.modelValue.zoom + leftBound * direction).toFixed(1));\n\t\t\tif (zoom < leftBound || zoom > rightBound)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// calibrate x and y according to viewpoint center\n\t\t\tconst treeRect = this.$parent.$refs.tree.getTreeBounds();\n\t\t\tconst centerX = (treeRect.width / 2) / this.modelValue.zoom - detailPanelWidth / 2;\n\t\t\tconst centerY = (treeRect.height / 2) / this.modelValue.zoom;\n\n\t\t\tconst oldCenterX = (centerX - this.modelValue.x) / this.modelValue.zoom;\n\t\t\tconst oldCenterY = (centerY - this.modelValue.y) / this.modelValue.zoom;\n\n\t\t\tconst x = centerX - oldCenterX * zoom;\n\t\t\tconst y = centerY - oldCenterY * zoom;\n\n\t\t\tthis.$emit('update:modelValue', { ...this.modelValue, zoom, x, y });\n\t\t},\n\t\tonLocate(): void\n\t\t{\n\t\t\tconst { locate } = this.actions;\n\t\t\tthis.$emit(locate);\n\t\t\tthis.selectedId = locate;\n\t\t},\n\t\tonfocusout(): void\n\t\t{\n\t\t\tthis.selectedId = '';\n\t\t},\n\t},\n\n\ttemplate: `\n\t\t<div class=\"humanresources-transform-panel\" @focusout=\"onfocusout\" tabindex=\"-1\">\n\t\t\t<div\n\t\t\t\tclass=\"humanresources-transform-panel__locate\"\n\t\t\t\t:class=\"{ '--selected': selectedId === actions.locate }\"\n\t\t\t\t@click=\"onLocate\"\n\t\t\t>\n\t\t\t\t{{loc('HUMANRESOURCES_COMPANY_STRUCTURE_TREE_LOCATE')}}\n\t\t\t</div>\n\t\t\t<div class=\"humanresources-transform-panel__separator\"></div>\n\t\t\t<div class=\"humanresources-transform-panel__zoom\">\n\t\t\t\t<svg\n\t\t\t\t\tviewBox=\"0 0 16 16\"\n\t\t\t\t\tfill=\"none\"\n\t\t\t\t\tclass=\"humanresources-transform-panel__icon --zoom-out\"\n\t\t\t\t\t:class=\"{ '--selected': selectedId === actions.zoomOut }\"\n\t\t\t\t\t@click=\"onZoom(false)\"\n\t\t\t\t>\n\t\t\t\t\t<path fill-rule=\"evenodd\" clip-rule=\"evenodd\" d=\"M4 8.66671V7.33337H7.33333H8.66667H12V8.66671H8.66667H7.33333H4Z\" fill=\"#6A737F\"/>\n\t\t\t\t</svg>\n\t\t\t\t<span v-html=\"zoomInPercent\"></span>\n\t\t\t\t<svg\n\t\t\t\t\tviewBox=\"0 0 16 16\"\n\t\t\t\t\tfill=\"none\"\n\t\t\t\t\tclass=\"humanresources-transform-panel__icon --zoom-in\"\n\t\t\t\t\t:class=\"{ '--selected': selectedId === actions.zoomIn }\"\n\t\t\t\t\t@click=\"onZoom(true)\"\n\t\t\t\t>\n\t\t\t\t\t<path fill-rule=\"evenodd\" clip-rule=\"evenodd\" d=\"M7.83333 4H9.16667V7.33333H12.5V8.66667H9.16667V12H7.83333V8.66667H4.5V7.33333H7.83333V4Z\" fill=\"#6A737F\"/>\n\t\t\t\t</svg>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","// @vue/component\nexport const DetailPanelCollapsedTitle = {\n\tname: 'detailPanelCollapsedTitle',\n\n\tprops:\n\t{\n\t\ttitle:\n\t\t{\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t\tavatars:\n\t\t{\n\t\t\ttype: Array,\n\t\t\trequired: true,\n\t\t},\n\t},\n\n\tcomputed:\n\t{\n\t\tmaxVisibleAvatarsCount(): Number\n\t\t{\n\t\t\treturn 2;\n\t\t},\n\t\tadditionalCount(): Number\n\t\t{\n\t\t\treturn this.avatars.length > this.maxVisibleAvatarsCount ? this.avatars.length - this.maxVisibleAvatarsCount : 0;\n\t\t},\n\t},\n\n\ttemplate: `\n\t\t<div class=\"humanresources-detail-panel__collapsed-title\">\n\t\t\t<template v-for=\"(avatar, index) in avatars\">\n\t\t\t\t<img\n\t\t\t\t\tv-if=\"index < this.maxVisibleAvatarsCount\"\n\t\t\t\t\t:key=\"index\"\n\t\t\t\t\t:src=\"encodeURI(avatar)\"\n\t\t\t\t\tclass=\"humanresources-detail-panel__collapsed-title-avatar\"\n\t\t\t\t/>\n\t\t\t</template>\n\t\t\t<div\n\t\t\t\tv-if=\"avatars.length > maxVisibleAvatarsCount\"\n\t\t\t\tclass=\"humanresources-detail-panel__collapsed-title-avatar --additional\"\n\t\t\t>\n\t\t\t +{{ additionalCount }}\n\t\t\t</div>\n\t\t\t<div class=\"humanresources-detail-panel__title\">{{ title }}</div>\n\t\t</div>\n\t`,\n};\n","import { AnalyticsSourceType } from 'humanresources.company-structure.api';\nimport { BIcon, Set } from 'ui.icon-set.api.vue';\nimport { EntityTypes } from 'humanresources.company-structure.utils';\nimport { RouteActionMenu } from 'humanresources.company-structure.structure-components';\nimport { EntityActionMenu } from '../menu/menu/entity-action-menu';\n\nimport '../../style.css';\nimport 'ui.icon-set.main';\nimport 'ui.icon-set.crm';\n\n/**\n * Component for displaying icon that shows EntityActionMenu\n */\n// @vue/component\nexport const DetailPanelEditButton = {\n\tname: 'detailPanelEditButton',\n\n\tcomponents: {\n\t\tBIcon,\n\t\tRouteActionMenu,\n\t},\n\n\tprops: {\n\t\tentityId: {\n\t\t\ttype: Number,\n\t\t\trequired: true,\n\t\t},\n\t\tentityType: {\n\t\t\ttype: String,\n\t\t\tdefault: EntityTypes.department,\n\t\t},\n\t},\n\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tmenuVisible: false,\n\t\t};\n\t},\n\n\tcomputed: {\n\t\tset(): Set\n\t\t{\n\t\t\treturn Set;\n\t\t},\n\t\tmenu(): EntityActionMenu\n\t\t{\n\t\t\treturn new EntityActionMenu(this.entityId, this.entityType, AnalyticsSourceType.DETAIL);\n\t\t},\n\t},\n\n\tmethods: {\n\t\tloc(phraseCode: string, replacements: { [p: string]: string } = {}): string\n\t\t{\n\t\t\treturn this.$Bitrix.Loc.getMessage(phraseCode, replacements);\n\t\t},\n\t\tonActionMenuItemClick(actionId: string): void\n\t\t{\n\t\t\tthis.menu.onActionMenuItemClick(actionId);\n\t\t},\n\t},\n\n\ttemplate: `\n\t\t<div\n\t\t\tv-if=\"menu.items.length\"\n\t\t\tclass=\"humanresources-detail-panel__edit-button\"\n\t\t\t:class=\"{ '--focused': menuVisible }\"\n\t\t\t:ref=\"'detailPanelEditButton'\"\n\t\t\tdata-id=\"hr-department-detail-panel__edit-menu-button\"\n\t\t\t@click.stop=\"menuVisible = true\"\n\t\t>\n\t\t\t<BIcon\n\t\t\t\tclass=\"humanresources-detail-panel__edit-button-icon\"\n\t\t\t\t:name=\"set.MORE\"\n\t\t\t\t:size=\"20\"\n\t\t\t/>\n\t\t</div>\n\t\t<RouteActionMenu\n\t\t\tv-if=\"menuVisible\"\n\t\t\tid=\"department-detail-content-edit-menu\"\n\t\t\t:items=\"menu.items\"\n\t\t\t:width=\"302\"\n\t\t\t:bindElement=\"$refs.detailPanelEditButton\"\n\t\t\t@action=\"onActionMenuItemClick\"\n\t\t\t@close=\"menuVisible = false\"\n\t\t/>\n\t`,\n};\n","import { EntityTypes } from 'humanresources.company-structure.utils';\nimport { DetailPanelCollapsedTitle } from './detail-panel-collapsed-title';\nimport { useChartStore } from 'humanresources.company-structure.chart-store';\nimport { mapState } from 'ui.vue3.pinia';\nimport { getMemberRoles, type MemberRolesType } from 'humanresources.company-structure.api';\nimport { DepartmentContent } from 'humanresources.company-structure.department-content';\nimport { Hint } from 'humanresources.company-structure.structure-components';\nimport { DetailPanelEditButton } from './detail-panel-edit-button';\n\nimport './style.css';\n\n// @vue/component\nexport const DetailPanel = {\n\tname: 'detailPanel',\n\n\tcomponents: { DepartmentContent, DetailPanelCollapsedTitle, DetailPanelEditButton },\n\n\tdirectives: { hint: Hint },\n\n\tprops: {\n\t\tpreventPanelSwitch: Boolean,\n\t\tmodelValue: Boolean,\n\t},\n\n\temits: ['showWizard', 'removeDepartment', 'update:modelValue'],\n\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\ttitle: '',\n\t\t\tisTeamEntity: false,\n\t\t\tteamColor: null,\n\t\t\tisCollapsed: true,\n\t\t\tisLoading: true,\n\t\t\tneedToShowLoader: false,\n\t\t};\n\t},\n\n\tcomputed:\n\t{\n\t\t...mapState(useChartStore, ['focusedNode', 'departments']),\n\t\tdefaultAvatar(): String\n\t\t{\n\t\t\treturn '/bitrix/js/humanresources/company-structure/org-chart/src/images/default-user.svg';\n\t\t},\n\t\theadAvatarsArray(): Array\n\t\t{\n\t\t\tconst heads = this.departments.get(this.focusedNode).heads ?? [];\n\n\t\t\treturn heads\n\t\t\t\t?.filter((employee) => employee.role === this.memberRoles.head)\n\t\t\t\t?.map((employee) => employee.avatar || this.defaultAvatar) ?? []\n\t\t\t;\n\t\t},\n\t\tentityType(): string\n\t\t{\n\t\t\treturn this.departments.get(this.focusedNode).entityType;\n\t\t},\n\t\tmemberRoles(): MemberRolesType\n\t\t{\n\t\t\treturn getMemberRoles(this.entityType);\n\t\t},\n\t},\n\n\twatch: {\n\t\tfocusedNode(newId: number, oldId: number): void\n\t\t{\n\t\t\tthis.updateDetailPageHandler(newId, oldId);\n\t\t},\n\t\tmodelValue(collapsed: boolean): void\n\t\t{\n\t\t\tthis.isCollapsed = collapsed;\n\t\t},\n\t\tdepartments: {\n\t\t\thandler(newDepartments): void\n\t\t\t{\n\t\t\t\tconst department = newDepartments.get(this.focusedNode);\n\t\t\t\tif (department)\n\t\t\t\t{\n\t\t\t\t\tthis.title = department.name ?? '';\n\t\t\t\t}\n\t\t\t},\n\t\t\tdeep: true,\n\t\t},\n\t},\n\n\tmethods:\n\t{\n\t\ttoggleCollapse(): void\n\t\t{\n\t\t\tthis.$emit('update:modelValue', !this.isCollapsed);\n\t\t},\n\t\tupdateDetailPageHandler(nodeId: number, oldId: number): void\n\t\t{\n\t\t\tif (!this.preventPanelSwitch && oldId !== 0)\n\t\t\t{\n\t\t\t\tthis.$emit('update:modelValue', false);\n\t\t\t}\n\n\t\t\tthis.isLoading = true;\n\t\t\tconst department = this.departments.get(nodeId);\n\n\t\t\tthis.isTeamEntity = department.entityType === EntityTypes.team;\n\t\t\tthis.title = department.name ?? '';\n\t\t\tthis.teamColor = department.teamColor ?? null;\n\t\t\tthis.isLoading = false;\n\t\t},\n\t\tshowLoader(): void\n\t\t{\n\t\t\tthis.needToShowLoader = true;\n\t\t},\n\t\thideLoader(): void\n\t\t{\n\t\t\tthis.needToShowLoader = false;\n\t\t},\n\t},\n\n\ttemplate: `\n\t\t<div\n\t\t\t:class=\"['humanresources-detail-panel', { '--collapsed': isCollapsed }]\"\n\t\t\tv-on=\"isCollapsed ? { click: toggleCollapse } : {}\"\n\t\t\tdata-id=\"hr-department-detail-panel__container\"\n\t\t>\n\t\t\t<div\n\t\t\t\tv-if=\"!isLoading\"\n\t\t\t\tclass=\"humanresources-detail-panel-container\"\n\t\t\t\t:class=\"{ '--hide': needToShowLoader && !isCollapsed }\"\n\t\t\t>\n\t\t\t\t<div class=\"humanresources-detail-panel__head\" \n\t\t\t\t\t :class=\"{ '--team': isTeamEntity, '--collapsed': isCollapsed }\"\n\t\t\t\t\t :style=\"{ '--team-head-background': teamColor?.treeHeadBackground }\"\n\t\t\t\t>\n\t\t\t\t\t<span\n\t\t\t\t\t\tv-if=\"!isCollapsed\"\n\t\t\t\t\t\tv-hint\n\t\t\t\t\t\tclass=\"humanresources-detail-panel__title\"\n\t\t\t\t\t>\n\t\t\t\t\t\t{{ title }}\n\t\t\t\t\t</span>\n\t\t\t\t\t<DetailPanelCollapsedTitle\n\t\t\t\t\t\tv-else\n\t\t\t\t\t\t:title=\"title\"\n\t\t\t\t\t\t:avatars=\"headAvatarsArray\"\n\t\t\t\t\t>\n\t\t\t\t\t</DetailPanelCollapsedTitle>\n\t\t\t\t\t<div class=\"humanresources-detail-panel__header_buttons_container\">\n\t\t\t\t\t\t<DetailPanelEditButton\n\t\t\t\t\t\t\tv-if=\"!isCollapsed\"\n\t\t\t\t\t\t\t:entityId=\"focusedNode\"\n\t\t\t\t\t\t\t:entityType=\"entityType\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<div\n\t\t\t\t\t\t\tclass=\"humanresources-detail-panel__collapse_button --icon\"\n\t\t\t\t\t\t\t@click=\"toggleCollapse\"\n\t\t\t\t\t\t\t:class=\"{ '--collapsed': isCollapsed }\"\n\t\t\t\t\t\t\tdata-id=\"hr-department-detail-panel__collapse-button\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"humanresources-detail-panel__content\" v-show=\"!isCollapsed\">\n\t\t\t\t\t<DepartmentContent\n\t\t\t\t\t\t@showDetailLoader=\"showLoader\"\n\t\t\t\t\t\t@hideDetailLoader=\"hideLoader\"\n\t\t\t\t\t\t:isCollapsed=\"isCollapsed\"\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div v-if=\"needToShowLoader && !isCollapsed\" class=\"humanresources-detail-panel-loader-container\"/>\n\t\t</div>\n\t`,\n};\n","import 'ui.buttons';\nimport 'ui.forms';\nimport './style.css';\nimport { chartAPI } from '../../api';\nimport { events } from '../../consts';\nimport { BIcon, Set } from 'ui.icon-set.api.vue';\nimport type { FirstPopupData } from '../../types';\n\n// @vue/component\nexport const FirstPopup = {\n\tname: 'FirstPopup',\n\tcomponents: {\n\t\tBIcon,\n\t},\n\n\tdata(): FirstPopupData\n\t{\n\t\treturn {\n\t\t\tshow: false,\n\t\t\ttitle: '',\n\t\t\tdescription: '',\n\t\t\tsubDescription: '',\n\t\t\tfeatures: [],\n\t\t};\n\t},\n\n\tcomputed:\n\t{\n\t\tset(): Set\n\t\t{\n\t\t\treturn Set;\n\t\t},\n\t},\n\n\tasync mounted(): Promise<void>\n\t{\n\t\tthis.title = this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_FIRST_OPEN_TITLE');\n\t\tthis.description = this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_FIRST_OPEN_DESCRIPTION');\n\t\tthis.subDescription = this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_FIRST_OPEN_SUB_DESCRIPTION');\n\t\tthis.features = [\n\t\t\tthis.loc('HUMANRESOURCES_COMPANY_STRUCTURE_FIRST_OPEN_FEATURE_1'),\n\t\t\tthis.loc('HUMANRESOURCES_COMPANY_STRUCTURE_FIRST_OPEN_FEATURE_2'),\n\t\t\tthis.loc('HUMANRESOURCES_COMPANY_STRUCTURE_FIRST_OPEN_FEATURE_3'),\n\t\t\tthis.loc('HUMANRESOURCES_COMPANY_STRUCTURE_FIRST_OPEN_FEATURE_4'),\n\t\t\tthis.loc('HUMANRESOURCES_COMPANY_STRUCTURE_FIRST_OPEN_FEATURE_5'),\n\t\t\tthis.loc('HUMANRESOURCES_COMPANY_STRUCTURE_FIRST_OPEN_FEATURE_6'),\n\t\t\tthis.loc('HUMANRESOURCES_COMPANY_STRUCTURE_FIRST_OPEN_FEATURE_7'),\n\t\t];\n\n\t\tconst { firstTimeOpened } = await chartAPI.getDictionary();\n\t\tthis.show = firstTimeOpened === 'N' && this.title.length > 0;\n\t},\n\n\tmethods: {\n\t\tclosePopup(): void\n\t\t{\n\t\t\tchartAPI.firstTimeOpened();\n\t\t\tthis.show = false;\n\t\t\ttop.BX.Event.EventEmitter.emit(events.HR_FIRST_POPUP_SHOW);\n\t\t},\n\t\tloc(phraseCode: string, replacements: { [p: string]: string } = {}): string\n\t\t{\n\t\t\treturn this.$Bitrix.Loc.getMessage(phraseCode, replacements);\n\t\t},\n\t},\n\n\ttemplate: `\n\t\t<div v-if=\"show\" class=\"first-popup\">\n\t\t\t<div class=\"first-popup-overlay\" @click=\"closePopup\"></div>\n\t\t\t<div class=\"first-popup-content\">\n\t\t\t\t<div class=\"title\">{{ title }}</div>\n\t\t\t\t<div class=\"first-popup-left\">\n\t\t\t\t\t<p class=\"description\">{{ description }}</p>\n\t\t\t\t\t<p class=\"sub-description\">{{ subDescription }}</p>\n\t\t\t\t\t<div class=\"first-popup-list\">\n\t\t\t\t\t\t<div class=\"first-popup-list-item\" v-for=\"(feature, index) in features\" :key=\"index\">\n\t\t\t\t\t\t\t<div class=\"first-popup-list-item-point\">•</div>\n\t\t\t\t\t\t\t<div class=\"first-popup-list-item-feature\">{{ feature }}</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<button class=\"ui-btn ui-btn-success first-popup-ui-btn\" @click=\"closePopup\">\n\t\t\t\t\t\t{{ loc('HUMANRESOURCES_COMPANY_STRUCTURE_FIRST_OPEN_BUTTON_START') }}\n\t\t\t\t\t</button>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"first-popup-right\">\n\t\t\t\t\t<video\n\t\t\t\t\t\tsrc=\"/bitrix/js/humanresources/company-structure/org-chart/src/components/first-popup/images/preview.webm\"\n\t\t\t\t\t\tautoplay\n\t\t\t\t\t\tloop\n\t\t\t\t\t\tmuted\n\t\t\t\t\t\tplaysinline\n\t\t\t\t\t\tclass=\"first-popup-animation\"\n\t\t\t\t\t></video>\n\t\t\t\t</div>\n\t\t\t\t<BIcon :name=\"set.CROSS_25\" :size=\"24\" class=\"first-popup-close\" @click=\"closePopup\"></BIcon>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import { EventEmitter, type BaseEvent } from 'main.core.events';\nimport { Confetti } from 'ui.confetti';\nimport { mapState } from 'ui.vue3.pinia';\nimport { TransformCanvas } from 'ui.canvas';\nimport { AnalyticsSourceType } from 'humanresources.company-structure.api';\nimport { TitlePanel } from './components/title-panel/title-panel';\nimport { Tree } from './components/tree/tree';\nimport { TransformPanel } from './components/transfrom-panel';\nimport { DetailPanel } from './components/detail-panel/detail-panel';\nimport { FirstPopup } from './components/first-popup/first-popup';\nimport { useChartStore } from 'humanresources.company-structure.chart-store';\nimport { ChartWizard } from 'humanresources.company-structure.chart-wizard';\nimport { getInvitedUserData } from 'humanresources.company-structure.utils';\nimport { chartAPI } from './api';\nimport { events, detailPanelWidth } from './consts';\nimport { OrgChartActions } from './actions';\nimport { sendData as analyticsSendData } from 'ui.analytics';\n\nimport type { ChartData } from './types';\nimport './style.css';\nimport 'ui.design-tokens';\n\n// @vue/component\nexport const Chart = {\n\tcomponents: {\n\t\tTransformCanvas,\n\t\tTree,\n\t\tTransformPanel,\n\t\tChartWizard,\n\t\tFirstPopup,\n\t\tDetailPanel,\n\t\tTitlePanel,\n\t},\n\n\tdata(): ChartData\n\t{\n\t\treturn {\n\t\t\tcanvas: {\n\t\t\t\tshown: false,\n\t\t\t\tmoving: false,\n\t\t\t\tmodelTransform: {\n\t\t\t\t\tx: 0,\n\t\t\t\t\ty: 0,\n\t\t\t\t\tzoom: 0.3,\n\t\t\t\t},\n\t\t\t},\n\t\t\twizard: {\n\t\t\t\tshown: false,\n\t\t\t\tisEditMode: false,\n\t\t\t\tshowEntitySelector: true,\n\t\t\t\tentity: '',\n\t\t\t\tnodeId: 0,\n\t\t\t\tsource: '',\n\t\t\t},\n\t\t\tdetailPanel: {\n\t\t\t\tcollapsed: true,\n\t\t\t\tpreventSwitch: false,\n\t\t\t},\n\t\t\t// there is no way to determine if transition was initial transition was due to initial zoom in\n\t\t\t// so we block all controls until initial zoom in is completed\n\t\t\tinitTransitionCompleted: false,\n\t\t};\n\t},\n\n\tcomputed:\n\t{\n\t\trootId(): number\n\t\t{\n\t\t\tconst { id: rootId } = [...this.departments.values()].find((department) => {\n\t\t\t\treturn department.parentId === 0;\n\t\t\t});\n\n\t\t\treturn rootId;\n\t\t},\n\t\t...mapState(useChartStore, ['departments', 'currentDepartments']),\n\t},\n\n\tasync created(): Promise<void>\n\t{\n\t\tconst slider = BX.SidePanel.Instance.getTopSlider();\n\t\tslider?.showLoader();\n\t\tconst [departments, currentDepartments, userId] = await Promise.all([\n\t\t\tchartAPI.getDepartmentsData(),\n\t\t\tchartAPI.getCurrentDepartments(),\n\t\t\tchartAPI.getUserId(),\n\t\t]);\n\t\tslider?.closeLoader();\n\t\tconst parsedDepartments = chartAPI.createTreeDataStore(departments);\n\t\tconst availableDepartments = currentDepartments.filter((item) => parsedDepartments.has(item));\n\t\tOrgChartActions.applyData(parsedDepartments, availableDepartments, userId);\n\t\tthis.rootOffset = 100;\n\t\tthis.transformCanvas();\n\t\tthis.canvas.shown = true;\n\t\tthis.showConfetti = false;\n\t\tEventEmitter.subscribe(events.HR_DEPARTMENT_SLIDER_ON_MESSAGE, this.handleInviteSliderMessage);\n\t\tBX.PULL.subscribe({\n\t\t\ttype: BX.PullClient.SubscriptionType.Server,\n\t\t\tmoduleId: 'humanresources',\n\t\t\tcommand: 'linkChatsToNodes',\n\t\t\tcallback: (data) => this.clearChatLists(data),\n\t\t});\n\t\tEventEmitter.subscribe(events.HR_ENTITY_SHOW_WIZARD, this.showWizardEventHandler);\n\t\tEventEmitter.subscribe(events.HR_ENTITY_REMOVE, this.removeDepartmentEventHandler);\n\t},\n\n\tunmounted(): void\n\t{\n\t\tEventEmitter.unsubscribe(events.HR_DEPARTMENT_SLIDER_ON_MESSAGE, this.handleInviteSliderMessage);\n\t\tEventEmitter.unsubscribe(events.HR_ENTITY_SHOW_WIZARD, this.showWizardEventHandler);\n\t\tEventEmitter.unsubscribe(events.HR_ENTITY_REMOVE, this.removeDepartmentEventHandler);\n\t},\n\n\tmethods:\n\t{\n\t\tonMoveTo({ x, y, nodeId }: { x: Number; y: Number; nodeId: Number; }): void\n\t\t{\n\t\t\tconst { x: prevX, y: prevY, zoom } = this.canvas.modelTransform;\n\t\t\tconst detailPanelWidthZoomed = detailPanelWidth * zoom;\n\t\t\tconst newX = x - detailPanelWidthZoomed / 2;\n\t\t\tconst newY = nodeId === this.rootId ? this.rootOffset : y / zoom;\n\t\t\tconst samePoint = Math.round(newX) === Math.round(prevX) && Math.round(y) === Math.round(prevY);\n\t\t\tthis.detailPanel = {\n\t\t\t\t...this.detailPanel,\n\t\t\t\tcollapsed: false,\n\t\t\t};\n\t\t\tif (samePoint)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.canvas = {\n\t\t\t\t...this.canvas,\n\t\t\t\tmoving: true,\n\t\t\t\tmodelTransform: { ...this.canvas.modelTransform, x: newX / zoom, y: newY, zoom: 1 },\n\t\t\t};\n\t\t\tthis.onUpdateTransform();\n\t\t},\n\t\tonLocate(nodeId: ?number): void\n\t\t{\n\t\t\tif (nodeId)\n\t\t\t{\n\t\t\t\tthis.$refs.tree.locateToDepartment(nodeId);\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.$refs.tree.locateToCurrentDepartment();\n\t\t},\n\t\tshowWizardEventHandler({ data }: BaseEvent): void\n\t\t{\n\t\t\tthis.onShowWizard(data);\n\t\t},\n\t\tonShowWizard({\n\t\t\tnodeId = 0,\n\t\t\tisEditMode = false,\n\t\t\ttype,\n\t\t\tshowEntitySelector = true,\n\t\t\tsource = '',\n\t\t\tentityType,\n\t\t\trefToFocus,\n\t\t}: { nodeId: number; isEditMode: boolean, showEntitySelector: boolean, source: string } = {}): void\n\t\t{\n\t\t\tthis.wizard = {\n\t\t\t\t...this.wizard,\n\t\t\t\tshown: true,\n\t\t\t\tisEditMode,\n\t\t\t\tshowEntitySelector,\n\t\t\t\tentity: type,\n\t\t\t\tnodeId,\n\t\t\t\tsource,\n\t\t\t\tentityType,\n\t\t\t\trefToFocus,\n\t\t\t};\n\n\t\t\tif (!isEditMode && source !== AnalyticsSourceType.HEADER)\n\t\t\t{\n\t\t\t\tanalyticsSendData({\n\t\t\t\t\ttool: 'structure',\n\t\t\t\t\tcategory: 'structure',\n\t\t\t\t\tevent: 'create_dept_step1',\n\t\t\t\t\tc_element: source,\n\t\t\t\t});\n\t\t\t}\n\n\t\t\t// eslint-disable-next-line default-case\n\t\t\tswitch (type)\n\t\t\t{\n\t\t\t\tcase 'department':\n\t\t\t\t\tanalyticsSendData({\n\t\t\t\t\t\ttool: 'structure',\n\t\t\t\t\t\tcategory: 'structure',\n\t\t\t\t\t\tevent: 'create_dept_step1',\n\t\t\t\t\t\tc_element: source,\n\t\t\t\t\t});\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'employees':\n\t\t\t\t\tanalyticsSendData({\n\t\t\t\t\t\ttool: 'structure',\n\t\t\t\t\t\tcategory: 'structure',\n\t\t\t\t\t\tevent: 'create_dept_step2',\n\t\t\t\t\t\tc_element: source,\n\t\t\t\t\t});\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'bindChat':\n\t\t\t\t\tanalyticsSendData({\n\t\t\t\t\t\ttool: 'structure',\n\t\t\t\t\t\tcategory: 'structure',\n\t\t\t\t\t\tevent: 'create_dept_step3',\n\t\t\t\t\t\tc_element: source,\n\t\t\t\t\t});\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'teamRights':\n\t\t\t\t\tanalyticsSendData({\n\t\t\t\t\t\ttool: 'structure',\n\t\t\t\t\t\tcategory: 'structure',\n\t\t\t\t\t\tevent: 'create_dept_step4',\n\t\t\t\t\t\tc_element: source,\n\t\t\t\t\t});\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t},\n\t\tasync onModifyTree({ id, parentId, showConfetti }): Promise<void>\n\t\t{\n\t\t\tthis.showConfetti = showConfetti ?? false;\n\t\t\tconst { tree } = this.$refs;\n\t\t\ttree.expandDepartmentParents(id);\n\t\t\ttree.focus(id, { expandAfterFocus: true });\n\t\t\tawait this.$nextTick();\n\t\t\ttree.moveTo(id);\n\t\t},\n\t\tonWizardClose(): void\n\t\t{\n\t\t\tthis.wizard.shown = false;\n\t\t},\n\t\tremoveDepartmentEventHandler({ data }: BaseEvent): void\n\t\t{\n\t\t\tthis.onRemoveDepartment(data.nodeId, data.entityType);\n\t\t},\n\t\tonRemoveDepartment(nodeId: number, entityType: string): void\n\t\t{\n\t\t\tconst { tree } = this.$refs;\n\t\t\ttree.tryRemoveDepartment(nodeId, entityType);\n\t\t},\n\t\tonTransitionEnd(): void\n\t\t{\n\t\t\tif (this.canvas.moving)\n\t\t\t{\n\t\t\t\tthis.initTransitionCompleted = true;\n\t\t\t}\n\n\t\t\tthis.canvas.moving = false;\n\t\t\tif (this.showConfetti)\n\t\t\t{\n\t\t\t\tConfetti.fire({\n\t\t\t\t\tparticleCount: 300,\n\t\t\t\t\tstartVelocity: 10,\n\t\t\t\t\tspread: 400,\n\t\t\t\t\tticks: 100,\n\t\t\t\t\torigin: { y: 0.4, x: 0.37 },\n\t\t\t\t});\n\t\t\t\tthis.showConfetti = false;\n\t\t\t}\n\t\t},\n\t\tonControlDetail({ showEmployees, preventSwitch }): void\n\t\t{\n\t\t\tthis.detailPanel = {\n\t\t\t\t...this.detailPanel,\n\t\t\t\tpreventSwitch,\n\t\t\t};\n\t\t\tif (!showEmployees)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.detailPanel = {\n\t\t\t\t...this.detailPanel,\n\t\t\t\tcollapsed: false,\n\t\t\t};\n\t\t},\n\t\ttransformCanvas(): void\n\t\t{\n\t\t\tconst { zoom } = this.canvas.modelTransform;\n\t\t\tconst { offsetWidth, offsetHeight } = this.$el;\n\t\t\tconst [currentDepartment] = this.currentDepartments;\n\t\t\tconst y = currentDepartment === this.rootId ? this.rootOffset : offsetHeight / 2 - (offsetHeight * zoom) / 2;\n\t\t\tthis.canvas.modelTransform = {\n\t\t\t\t...this.canvas.modelTransform,\n\t\t\t\tx: offsetWidth / 2 - (offsetWidth * zoom) / 2,\n\t\t\t\ty,\n\t\t\t};\n\t\t},\n\t\tonUpdateTransform(): void\n\t\t{\n\t\t\tEventEmitter.emit(events.INTRANET_USER_MINIPROFILE_CLOSE);\n\t\t\tEventEmitter.emit(events.HR_DEPARTMENT_MENU_CLOSE);\n\t\t},\n\t\thandleInviteSliderMessage(event: BaseEvent): void\n\t\t{\n\t\t\tconst [messageEvent] = event.getData();\n\t\t\tconst eventId = messageEvent.getEventId();\n\t\t\tif (eventId !== 'BX.Intranet.Invitation:onAdd')\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst { users } = messageEvent.getData();\n\t\t\tusers.forEach((user) => {\n\t\t\t\tconst invitedUserData = getInvitedUserData(user);\n\t\t\t\tOrgChartActions.inviteUser(invitedUserData);\n\t\t\t});\n\t\t},\n\t\tclearChatLists(data): void\n\t\t{\n\t\t\tconst nodeIds = Object.keys(data).map((key) => Number(key));\n\t\t\tOrgChartActions.clearNodesChatLists(nodeIds);\n\t\t},\n\t\tonKeyDown(event: KeyboardEvent): void\n\t\t{\n\t\t\tif (!this.initTransitionCompleted)\n\t\t\t{\n\t\t\t\tevent.preventDefault();\n\t\t\t}\n\t\t},\n\t},\n\n\ttemplate: `\n\t\t<div\n\t\t\tclass=\"humanresources-chart\"\n\t\t\t:class=\"{ '--locked': !initTransitionCompleted }\"\n\t\t\t@keydown=\"onKeyDown\"\n\t\t>\n\t\t\t<TitlePanel @showWizard=\"onShowWizard\" @locate=\"onLocate\"></TitlePanel>\n\t\t\t<TransformCanvas\n\t\t\t\tv-if=\"canvas.shown\"\n\t\t\t\tv-slot=\"{transform}\"\n\t\t\t\tv-model=\"canvas.modelTransform\"\n\t\t\t\t@update:modelValue=\"onUpdateTransform\"\n\t\t\t\t:class=\"{ '--moving': canvas.moving }\"\n\t\t\t\t@transitionend=\"onTransitionEnd\"\n\t\t\t>\n\t\t\t\t<Tree\n\t\t\t\t\t:canvasZoom=\"transform.zoom\"\n\t\t\t\t\tref=\"tree\"\n\t\t\t\t\t@moveTo=\"onMoveTo\"\n\t\t\t\t\t@showWizard=\"onShowWizard\"\n\t\t\t\t\t@controlDetail=\"onControlDetail\"\n\t\t\t\t></Tree>\n\t\t\t</TransformCanvas>\n\t\t\t<DetailPanel\n\t\t\t\t@showWizard=\"onShowWizard\"\n\t\t\t\t@removeDepartment=\"onRemoveDepartment\"\n\t\t\t\tv-model=\"detailPanel.collapsed\"\n\t\t\t\t:preventPanelSwitch=\"detailPanel.preventSwitch\"\n\t\t\t></DetailPanel>\n\t\t\t<TransformPanel\n\t\t\t\tv-model=\"canvas.modelTransform\"\n\t\t\t\t@locate=\"onLocate\"\n\t\t\t></TransformPanel>\n\t\t\t<ChartWizard\n\t\t\t\tv-if=\"wizard.shown\"\n\t\t\t\t:nodeId=\"wizard.nodeId\"\n\t\t\t\t:isEditMode=\"wizard.isEditMode\"\n\t\t\t\t:showEntitySelector=\"wizard.showEntitySelector\"\n\t\t\t\t:entity=\"wizard.entity\"\n\t\t\t\t:entityType=\"wizard.entityType\"\n\t\t\t\t:source=\"wizard.source\"\n\t\t\t\t:refToFocus=\"wizard.refToFocus\"\n\t\t\t\t@modifyTree=\"onModifyTree\"\n\t\t\t\t@close=\"onWizardClose\"\n\t\t\t></ChartWizard>\n\t\t\t<FirstPopup></FirstPopup>\n\t\t\t<div class=\"humanresources-chart__back\"></div>\n\t\t</div>\n\t`,\n};\n","import { AbstractActionMenu } from '../abstract-action-menu';\nimport { AddEmployeeMenuItem } from '../items/employees/add-employee-menu-item';\nimport { EditEmployeesMenuItem } from '../items/department/edit-employees-menu-item';\n\nexport class UsersTabActionMenu extends AbstractActionMenu\n{\n\tconstructor(entityId: number, analyticSource: string, role: string, entityType: string)\n\t{\n\t\tsuper(entityId);\n\t\tthis.analyticSource = analyticSource;\n\t\tthis.role = role;\n\t\tthis.entityType = entityType;\n\t\tthis.items = this.getFilteredItems();\n\t}\n\n\tgetItems(): Array\n\t{\n\t\treturn [\n\t\t\tnew AddEmployeeMenuItem(this.entityType, this.role),\n\t\t\tnew EditEmployeesMenuItem(this.entityType, this.role),\n\t\t];\n\t}\n}\n","import { EntityTypes } from 'humanresources.company-structure.utils';\nimport { AbstractActionMenu } from '../abstract-action-menu';\nimport { AddEmployeeMenuItem } from '../items/employees/add-employee-menu-item';\nimport { MoveEmployeeMenuItem } from '../items/employees/move-employee-menu-item';\nimport { UserInviteMenuItem } from '../items/employees/user-invite-menu-item';\n\nexport class EmptyUsersTabActionMenu extends AbstractActionMenu\n{\n\tconstructor(entityId: number, analyticSource: string, role: string, entityType: string)\n\t{\n\t\tsuper(entityId);\n\t\tthis.entityType = entityType;\n\t\tthis.analyticSource = analyticSource;\n\t\tthis.role = role;\n\t\tthis.items = this.getFilteredItems();\n\t}\n\n\tgetItems(): Array\n\t{\n\t\tif (this.entityType === EntityTypes.team)\n\t\t{\n\t\t\treturn [\n\t\t\t\tnew AddEmployeeMenuItem(this.entityType, this.role),\n\t\t\t];\n\t\t}\n\n\t\treturn [\n\t\t\tnew MoveEmployeeMenuItem(),\n\t\t\tnew UserInviteMenuItem(),\n\t\t\tnew AddEmployeeMenuItem(this.entityType, this.role),\n\t\t];\n\t}\n}\n","import type { PermissionCheckerClass } from 'humanresources.company-structure.permission-checker';\nimport { PermissionActions } from 'humanresources.company-structure.permission-checker';\nimport { getColorCode } from 'humanresources.company-structure.utils';\nimport { Loc } from 'main.core';\nimport { Main } from 'ui.icon-set.api.core';\nimport { AbstractMenuItem } from '../abstract-menu-item';\nimport { MenuActions } from '../../menu-actions';\n\nexport class FireUserFromCompanyMenuItem extends AbstractMenuItem\n{\n\tconstructor(isUserInvited: boolean)\n\t{\n\t\tsuper({\n\t\t\tid: MenuActions.fireUserFromCompany,\n\t\t\ttitle: isUserInvited\n\t\t\t\t? Loc.getMessage(\n\t\t\t\t\t'HUMANRESOURCES_COMPANY_STRUCTURE_USER_LIST_ACTION_MENU_DELETE_FROM_COMPANY_TITLE',\n\t\t\t\t)\n\t\t\t\t: Loc.getMessage(\n\t\t\t\t\t'HUMANRESOURCES_COMPANY_STRUCTURE_USER_LIST_ACTION_MENU_FIRE_FROM_COMPANY_TITLE',\n\t\t\t\t),\n\t\t\tdescription: Loc.getMessage(\n\t\t\t\t'HUMANRESOURCES_COMPANY_STRUCTURE_USER_LIST_ACTION_MENU_FIRE_FROM_COMPANY_SUBTITLE',\n\t\t\t),\n\t\t\tbIcon: {\n\t\t\t\tname: Main.PERSONS_DENY,\n\t\t\t\tsize: 20,\n\t\t\t\tcolor: getColorCode('paletteRed40'),\n\t\t\t},\n\t\t\tpermissionAction: isUserInvited ? '' : PermissionActions.employeeFire,\n\t\t\tdataTestId: 'hr-department-detail-content__user-list_fire-user-from-department',\n\t\t});\n\t}\n\n\thasPermission(permissionChecker: PermissionCheckerClass, entityId: number): boolean\n\t{\n\t\treturn permissionChecker.hasPermissionOfAction(this.permissionAction);\n\t}\n}\n","import type { PermissionCheckerClass } from 'humanresources.company-structure.permission-checker';\nimport { PermissionActions } from 'humanresources.company-structure.permission-checker';\nimport { EntityTypes, getColorCode } from 'humanresources.company-structure.utils';\nimport { Loc } from 'main.core';\nimport { Main } from 'ui.icon-set.api.core';\nimport { AbstractMenuItem } from '../abstract-menu-item';\nimport { MenuActions } from '../../menu-actions';\n\nexport class MoveFromDepartmentMenuItem extends AbstractMenuItem\n{\n\tconstructor(entityType: string)\n\t{\n\t\tconst title = entityType === EntityTypes.team\n\t\t\t? Loc.getMessage('HUMANRESOURCES_COMPANY_STRUCTURE_USER_LIST_ACTION_MENU_MOVE_TO_ANOTHER_TEAM_TITLE')\n\t\t\t: Loc.getMessage('HUMANRESOURCES_COMPANY_STRUCTURE_USER_LIST_ACTION_MENU_MOVE_TO_ANOTHER_DEPARTMENT_TITLE')\n\t\t;\n\n\t\tconst description = entityType === EntityTypes.team\n\t\t\t? Loc.getMessage('HUMANRESOURCES_COMPANY_STRUCTURE_USER_LIST_ACTION_MENU_MOVE_TO_ANOTHER_TEAM_SUBTITLE')\n\t\t\t: Loc.getMessage('HUMANRESOURCES_COMPANY_STRUCTURE_USER_LIST_ACTION_MENU_MOVE_TO_ANOTHER_DEPARTMENT_SUBTITLE')\n\t\t;\n\n\t\tsuper({\n\t\t\tid: MenuActions.moveUserToAnotherDepartment,\n\t\t\ttitle,\n\t\t\tdescription,\n\t\t\tbIcon: {\n\t\t\t\tname: Main.PERSON_ARROW_LEFT_1,\n\t\t\t\tsize: 20,\n\t\t\t\tcolor: getColorCode('paletteBlue50'),\n\t\t\t},\n\t\t\tpermissionAction: null,\n\t\t\tdataTestId: 'hr-department-detail-content__user-list_move-from-department',\n\t\t});\n\n\t\tthis.entityType = entityType;\n\t}\n\n\thasPermission(permissionChecker: PermissionCheckerClass, entityId: number): boolean\n\t{\n\t\tconst permissions = permissionChecker.currentUserPermissions;\n\n\t\tconst addMemberPermissionAction = this.entityType === EntityTypes.team\n\t\t\t? PermissionActions.teamAddMember\n\t\t\t: PermissionActions.employeeAddToDepartment\n\t\t;\n\n\t\tconst removeMemberPermissionAction = this.entityType === EntityTypes.team\n\t\t\t? PermissionActions.teamRemoveMember\n\t\t\t: PermissionActions.employeeRemoveFromDepartment\n\t\t;\n\n\t\tconst addMemberPermissionValue = this.entityType === EntityTypes.team\n\t\t\t? permissions.ACTION_TEAM_MEMBER_ADD\n\t\t\t: permissions.ACTION_EMPLOYEE_ADD_TO_DEPARTMENT\n\t\t;\n\n\t\tconst removeMemberPermissionValue = this.entityType === EntityTypes.team\n\t\t\t? permissions.ACTION_TEAM_MEMBER_REMOVE\n\t\t\t: permissions.ACTION_EMPLOYEE_REMOVE_FROM_DEPARTMENT\n\t\t;\n\n\t\tconst moveUserPermission = addMemberPermissionValue < removeMemberPermissionValue\n\t\t\t? addMemberPermissionAction\n\t\t\t: removeMemberPermissionAction\n\t\t;\n\n\t\treturn permissionChecker.hasPermission(moveUserPermission, entityId);\n\t}\n}\n","import { PermissionActions } from 'humanresources.company-structure.permission-checker';\nimport { EntityTypes, getColorCode } from 'humanresources.company-structure.utils';\nimport { Loc } from 'main.core';\nimport { Main } from 'ui.icon-set.api.core';\nimport { AbstractMenuItem } from '../abstract-menu-item';\nimport { MenuActions } from '../../menu-actions';\n\nexport class RemoveFromDepartmentMenuItem extends AbstractMenuItem\n{\n\tconstructor(entityType: string)\n\t{\n\t\tconst title = entityType === EntityTypes.team\n\t\t\t? Loc.getMessage('HUMANRESOURCES_COMPANY_STRUCTURE_USER_LIST_ACTION_MENU_REMOVE_FROM_TEAM_TITLE')\n\t\t\t: Loc.getMessage('HUMANRESOURCES_COMPANY_STRUCTURE_USER_LIST_ACTION_MENU_REMOVE_FROM_DEPARTMENT_TITLE')\n\t\t;\n\n\t\tconst description = entityType === EntityTypes.team\n\t\t\t? Loc.getMessage('HUMANRESOURCES_COMPANY_STRUCTURE_USER_LIST_ACTION_MENU_REMOVE_FROM_TEAM_SUBTITLE')\n\t\t\t: Loc.getMessage('HUMANRESOURCES_COMPANY_STRUCTURE_USER_LIST_ACTION_MENU_REMOVE_FROM_DEPARTMENT_SUBTITLE')\n\t\t;\n\n\t\tconst color = entityType === EntityTypes.team\n\t\t\t? getColorCode('paletteRed40')\n\t\t\t: getColorCode('paletteBlue50')\n\t\t;\n\n\t\tconst permissionAction = entityType === EntityTypes.team\n\t\t\t? PermissionActions.teamRemoveMember\n\t\t\t: PermissionActions.employeeRemoveFromDepartment\n\t\t;\n\n\t\tsuper({\n\t\t\tid: MenuActions.removeUserFromDepartment,\n\t\t\ttitle,\n\t\t\tdescription,\n\t\t\tbIcon: {\n\t\t\t\tname: Main.TRASH_BIN,\n\t\t\t\tsize: 20,\n\t\t\t\tcolor,\n\t\t\t},\n\t\t\tpermissionAction,\n\t\t\tdataTestId: 'hr-department-detail-content__user-list_remove-from-department',\n\t\t});\n\t}\n}\n","import { EntityTypes } from 'humanresources.company-structure.utils';\nimport { AbstractActionMenu } from '../abstract-action-menu';\nimport { FireUserFromCompanyMenuItem } from '../items/user-item/fire-user-from-company';\nimport { MoveFromDepartmentMenuItem } from '../items/user-item/move-from-department';\nimport { RemoveFromDepartmentMenuItem } from '../items/user-item/remove-from-department';\n\nexport class UserListActionMenu extends AbstractActionMenu\n{\n\tisUserInvited: boolean;\n\n\tconstructor(entityId: number, entityType: string, isUserInvited: boolean)\n\t{\n\t\tsuper(entityId);\n\t\tthis.isUserInvited = isUserInvited;\n\t\tthis.entityType = entityType;\n\t\tthis.items = this.getFilteredItems();\n\t}\n\n\tgetItems(): Array\n\t{\n\t\tif (this.entityType === EntityTypes.team)\n\t\t{\n\t\t\treturn [\n\t\t\t\tnew MoveFromDepartmentMenuItem(this.entityType),\n\t\t\t\tnew RemoveFromDepartmentMenuItem(this.entityType),\n\t\t\t];\n\t\t}\n\n\t\treturn [\n\t\t\tnew MoveFromDepartmentMenuItem(this.entityType),\n\t\t\tnew RemoveFromDepartmentMenuItem(this.entityType),\n\t\t\tnew FireUserFromCompanyMenuItem(this.isUserInvited),\n\t\t];\n\t}\n}\n","import { EventEmitter, type BaseEvent } from 'main.core.events';\nimport { events } from './consts';\nimport { Dom, Loc, Tag } from 'main.core';\nimport { chartAPI } from './api';\n\nexport class NotConvertedState\n{\n\tstatic updateConvertedStatusInterval;\n\n\tstatic #subscribeOnEvents(): void\n\t{\n\t\tconst onCloseByEsc = (event: BaseEvent) => {\n\t\t\tconst [sidePanelEvent] = event.data;\n\t\t\tsidePanelEvent.denyAction();\n\t\t};\n\n\t\tconst onClose = () => {\n\t\t\tEventEmitter.unsubscribe(events.HR_ORG_CHART_CLOSE_BY_ESC, onCloseByEsc);\n\t\t\tEventEmitter.unsubscribe(events.HR_ORG_CHART_CLOSE, onClose);\n\t\t\tclearInterval(this.updateConvertedStatusInterval);\n\t\t};\n\t\tEventEmitter.subscribe(events.HR_ORG_CHART_CLOSE_BY_ESC, onCloseByEsc);\n\t\tEventEmitter.subscribe(events.HR_ORG_CHART_CLOSE, onClose);\n\t}\n\n\tstatic async mount(containerId: string): Promise<void>\n\t{\n\t\tconst container = document.getElementById(containerId);\n\t\tDom.append(this.#getNotConvertedStateScreen(), container);\n\t\tthis.#subscribeOnEvents();\n\n\t\tconst updateTimeMs = 30000;\n\t\tthis.updateConvertedStatusInterval = setInterval(async () => {\n\t\t\ttry\n\t\t\t{\n\t\t\t\tawait chartAPI.getDictionary();\n\t\t\t}\n\t\t\tcatch (e)\n\t\t\t{\n\t\t\t\tif (e.code === 'STRUCTURE_IS_NOT_CONVERTED')\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (e.code === 'STRUCTURE_ACCESS_DENIED')\n\t\t\t\t{\n\t\t\t\t\tclearInterval(this.updateConvertedStatusInterval);\n\t\t\t\t\twindow.location.reload();\n\t\t\t\t}\n\n\t\t\t\tthrow e;\n\t\t\t}\n\n\t\t\tclearInterval(this.updateConvertedStatusInterval);\n\t\t\twindow.location.reload();\n\t\t}, updateTimeMs);\n\t}\n\n\tstatic #getNotConvertedStateScreen(): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"humanresources-not-converted-state-screen\">\n\t\t\t\t<div class=\"humanresources-not-converted-state-screen__icon\"></div>\n\t\t\t\t<div class=\"humanresources-not-converted-state-screen__title\">\n\t\t\t\t\t${Loc.getMessage('HUMANRESOURCES_COMPANY_STRUCTURE_NOT_CONVERTED_SCREEN_LOADING_TITLE')}\n\t\t\t\t</div>\n\t\t\t\t<div class=\"humanresources-not-converted-state-screen__description\">\n\t\t\t\t\t${Loc.getMessage('HUMANRESOURCES_COMPANY_STRUCTURE_NOT_CONVERTED_SCREEN_LOADING_DESCRIPTION')}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t}\n}\n","import { EventEmitter, type BaseEvent } from 'main.core.events';\nimport { events } from './consts';\nimport { BitrixVue } from 'ui.vue3';\nimport { createPinia } from 'ui.vue3.pinia';\nimport { Dom } from 'main.core';\nimport { Chart } from './app';\nimport { PermissionChecker } from 'humanresources.company-structure.permission-checker';\n\nexport { UsersTabActionMenu } from './components/menu/menu/users-tab-action-menu';\nexport { EmptyUsersTabActionMenu } from './components/menu/menu/empty-users-tab-action-menu';\nexport { UserListActionMenu } from './components/menu/menu/user-list-item-action-menu';\nexport { MenuActions } from './components/menu/menu-actions';\nexport { NotConvertedState } from './not-converted-state';\n\nexport class App\n{\n\tstatic #subscribeOnEvents(app: Object): void\n\t{\n\t\tconst onCloseByEsc = (event: BaseEvent) => {\n\t\t\tconst [sidePanelEvent] = event.data;\n\t\t\tsidePanelEvent.denyAction();\n\t\t};\n\n\t\tconst onClose = () => {\n\t\t\tEventEmitter.unsubscribe(events.HR_ORG_CHART_CLOSE_BY_ESC, onCloseByEsc);\n\t\t\tEventEmitter.unsubscribe(events.HR_ORG_CHART_CLOSE, onClose);\n\t\t\tapp.unmount();\n\t\t};\n\t\tEventEmitter.subscribe(events.HR_ORG_CHART_CLOSE_BY_ESC, onCloseByEsc);\n\t\tEventEmitter.subscribe(events.HR_ORG_CHART_CLOSE, onClose);\n\t}\n\n\tstatic async mount(containerId: string): Promise<void>\n\t{\n\t\tconst container = document.getElementById(containerId);\n\t\tconst app = BitrixVue.createApp(Chart);\n\t\tconst store = createPinia();\n\t\tapp.use(store);\n\t\tApp.#subscribeOnEvents(app);\n\n\t\tconst slider = BX.SidePanel.Instance.getTopSlider();\n\t\tif (slider)\n\t\t{\n\t\t\tslider.showLoader();\n\t\t}\n\t\tDom.addClass(container, 'humanresources-chart__back');\n\n\t\tawait PermissionChecker.init();\n\t\tif (slider)\n\t\t{\n\t\t\tslider.closeLoader();\n\t\t}\n\t\tDom.removeClass(container, 'humanresources-chart__back');\n\t\tapp.mount(container);\n\t}\n}\n"],"names":["events","Object","freeze","HR_DEPARTMENT_CONNECT","HR_DEPARTMENT_DISCONNECT","HR_DEPARTMENT_ADAPT_SIBLINGS","HR_DEPARTMENT_ADAPT_CONNECTOR_HEIGHT","HR_DEPARTMENT_FOCUS","HR_DEPARTMENT_CONTROL","HR_DEPARTMENT_MENU_CLOSE","HR_ORG_CHART_CLOSE_BY_ESC","HR_ORG_CHART_CLOSE","HR_FIRST_POPUP_SHOW","HR_DRAG_DEPARTMENT","HR_DROP_DEPARTMENT","HR_DEPARTMENT_TOGGLE_CONNECTORS","HR_DEPARTMENT_SLIDER_ON_MESSAGE","HR_ENTITY_SHOW_WIZARD","HR_ENTITY_REMOVE","HR_PUBLIC_FOCUS_NODE","INTRANET_USER_MINIPROFILE_CLOSE","detailPanelWidth","MenuOption","addDepartment","addEmployee","AddButton","name","components","RouteActionMenu","emits","data","actionMenu","visible","computed","mounted","permissionChecker","PermissionChecker","getInstance","dropdownItems","id","title","loc","description","bIcon","Main","CUBE_PLUS","size","color","getColorCode","permission","action","PermissionActions","departmentCreate","CRM","PERSON_PLUS_2","employeeAddToDepartment","filter","item","hasPermissionOfAction","methods","phraseCode","replacements","$Bitrix","Loc","getMessage","$emit","actionMenuItemClickHandler","actionId","template","OrgChartActions","applyData","departments","currentDepartments","userId","store","useChartStore","$patch","searchedUserId","focusDepartment","departmentId","focusedNode","searchUserInDepartment","moveSubordinatesToParent","removableDepartmentId","removableDepartment","get","parentId","entityType","children","removableDeparmentChildren","userCount","removableDepartmentUserCount","heads","removableDeparmentHeads","employees","removableDeparmentEmployees","parentDepartment","forEach","childId","department","EntityTypes","parentDepartmentUsersIds","Set","map","user","removableDeparmentUsers","movableUsers","has","role","memberRoles","employee","length","includes","changeCurrentDepartment","markDepartmentAsRemoved","set","prevParentId","removeDepartment","delete","inviteUser","userData","nodeId","restData","orderDepartments","draggedId","targetId","direction","count","targetIndex","indexOf","newChildren","splice","postData","clearNodesChatLists","nodeIds","chats","channels","SearchBar","BIcon","directives","focus","el","canEditPermissions","showSearchBar","mapState","watch","handler","searchDialog","destroy","deep","created","getSearchDialog","showSearchbar","analyticsSendData","tool","category","event","hideSearchbar","dialog","Dialog","width","height","multiple","entities","searchFields","type","system","searchable","options","intranetUsersOnly","emailUsers","inviteEmployeeLink","selectMode","flatMode","fillRecentTab","restricted","includedNodeEntityTypes","useMultipleTabs","recentTabOptions","dropdownMode","enableSearch","hideOnDeselect","context","getData","customData","recentItemsToSave","push","saveRecentItems","onLoad","target","items","getSubtitle","setSubtitle","onDestroy","dialogContainer","getContainer","Dom","attr","onEnter","$refs","searchName","setTargetNode","isOpen","show","Event","bind","window","handleClickOutside","parentElement","contains","clearSearch","unbind","search","value","getSearchTab","clearResults","selectTab","accessRights","teamAccessRights","BurgerMenuButton","PERSONS_2","dataTestId","accessEdit","MY_PLAN","teamAccessEdit","BX","SidePanel","Instance","open","usePadding","TitlePanel","canAddNode","toolbarStarActive","isHovered","toolbarStarElement","document","getElementById","hasPermissionWithAnyNode","teamCreate","error","console","observer","MutationObserver","hasClass","observe","attributes","attributeFilter","toolbarStarIcon","isAirTemplate","FAVORITE_1","FAVORITE_0","Reflection","getClass","toolbarClassIcon","source","AnalyticsSourceType","HEADER","onLocate","triggerFavoriteStar","click","UI","Notification","Center","notify","content","autoHideDelay","UrlParamNames","FocusNodeId","UrlProvidedParamsService","getParams","paramMap","focusNodeId","Map","urlSearchParams","URLSearchParams","location","values","paramName","paramValue","Type","isUndefined","castedValue","Number","isInteger","HeadList","UserListActionMenu","props","Array","required","default","String","collapsed","Boolean","isTeamEntity","isCollapsed","isUpdating","headsVisible","defaultAvatar","workPosition","getPositionText","titleBar","userTypes","deputy","head","handleUserClick","url","cacheable","closeHeadList","EventEmitter","unsubscribe","openHeadList","subscribe","itemWidth","gap","mousedownHandler","currentTarget","dragContainer","stopPropagation","draggedItem","closest","dataset","draggedIndex","ghost","createGhost","append","transformX","prevAffectedItems","mouseMoveHandler","style","body","addClass","movementX","zoom","setTransform","affectedItem","Math","trunc","offsetLeft","affectedItems","slice","fullWidth","mouseUpHandler","removeClass","remove","emit","shouldShow","offsetWidth","offsetHeight","Tag","render","element","x","DragAndDrop","updated","setAttribute","AbstractActionMenu","constructor","entityId","getItems","Error","getFilteredItems","isFunction","hasPermission","onActionMenuItemClick","targetItem","find","invoke","analyticSource","AbstractMenuItem","permissionAction","MenuActions","editDepartment","editEmployee","moveEmployee","userInvite","teamRights","moveUserToAnotherDepartment","removeUserFromDepartment","fireUserFromCompany","AddDepartmentMenuItem","isTeamsAvailable","team","isEditMode","showEntitySelector","EditDepartmentMenuItem","teamEdit","departmentEdit","EDIT_PENCIL","refToFocus","RemoveDepartmentMenuItem","teamDelete","departmentDelete","TRASH_BIN","TeamRightsMenuItem","Actions","SETTINGS_2","teamSettingsEdit","AddEmployeeMenuItem","teamAddMember","localize","i18nRole","i18nType","i18nMap","teamMemberRoles","UserManagementDialog","openDialog","EditEmployeesMenuItem","imageClass","EDIT_MENU","MoveEmployeeMenuItem","PERSON_ARROW_LEFT_1","currentUserPermissions","ACTION_EMPLOYEE_REMOVE_FROM_DEPARTMENT","UserInviteMenuItem","PERSON_LETTER","inviteToDepartment","allowChangeHistory","EntityActionMenu","DepartmentMenuButton","menuVisible","menu","DETAIL","closeMenu","openMenu","DepartmentInfoIconButton","BasePopup","canvasZoom","showPopup","popupConfig","popupWidth","buttonWidth","initialPopupOffset","angleWidth","bindElement","departmentMenuButton","bindOptions","position","borderRadius","contentNoPaddings","contentPadding","padding","offsetTop","angleOffset","menuItem","canEdit","onClose","onOpen","addDescription","CARD","SubdivisionAddButton","canShow","addSubdivision","PLUS","TreeNode","hint","Hint","dnd","inject","expandedNodes","isShown","childrenOffset","childrenMounted","showInfo","showDnd","getMemberRoles","nodeData","nodeClass","isCurrentDepartment","subdivisionsClass","hasChildren","isExpanded","deputyHead","employeeCount","childNodeStyle","left","showSubdivisionAddButton","nodeDataTitle","subdivisionsText","locPlural","childDepartmentsCount","childTeamsCount","adaptHeight","immediate","prevChildrenOffset","prevHeight","teamView","structureView","PermissionLevels","selfAndSub","$nextTick","$el","html","parentsPath","getParentsPath","calculateNodePoints","unmounted","onDepartmentClick","showEmployees","subdivisionsSelected","calculatePosition","node","offset","getMessagePlural","top","getBoundingClientRect","parentNode","$parent","parentLeft","parentTop","parentWidth","parentHeight","chartX","y","chartY","getTreeBounds","startPoint","endPoint","topLevelId","shift","Connectors","expose","isLocatedDepartmentVisible","treeNodes","connectors","subscribeOnEvents","prevWindowWidth","innerWidth","beforeUnmount","unsubscribeFromEvents","onAddConnector","connector","assign","highlighted","onRemoveConnector","onAdaptSiblingConnectors","adaptConnectorsAfterMount","adaptConnectorsAfterUnmount","currentStartPoint","parsedSiblingConnectors","reduce","acc","currentEndPoint","currentParentId","sign","currentId","ancestorId","ancestorSign","adaptConnectorsAfterReorder","ids","isRoot","onAdaptConnectorHeight","toggleConnectorsVisibility","toggleConnectorHighlighting","expanded","highlightedConnector","getPath","verticalLineHeight","parentNodeStyle","getComputedStyle","minDepartmentHeight","parseInt","getPropertyValue","diffHeight","shiftY","startY","shadowOffset","rounded","start","end","arcRadius","round","adjustedEndY","join","entries","handle","onResizeWindow","keys","key","startPointX","endPointX","createTreeDataStore","treeData","dataMap","colorName","mapItem","teamColor","getNodeColorSettings","mapParentItem","chartAPI","getDepartmentsData","getCurrentDepartments","getDictionary","getUserId","firstTimeOpened","Tree","provide","rootId","loadHeads","departmentToFocus","getDepartmentIdForInitialFocus","currentDepartmentsLocated","expandDepartmentParents","expandAfterFocus","expandLowerDepartments","providedFocusNodeId","currentDepartmentId","onConnectDepartment","departmentIdToFocus","movingDelay","Runtime","debounce","moveTo","onDisconnectDepartment","onDragDepartment","collapse","onToggleConnectors","onDropDepartment","promise","fullDepartmentWidth","draggedShift","affectedShift","ordered","onPublicFocusNode","locateToDepartment","expandedId","collapseRecursively","deepCollapse","expandedNode","expand","childrenWithoutHeads","shouldExpand","onFocusDepartment","preventSwitch","tryRemoveDepartment","localizationMap","message","success","mapIndex","messageBox","MessageBox","create","buttons","MessageBoxButtons","OK_CANCEL","onOk","close","onCancel","minWidth","maxWidth","minHeight","okCaption","popupOptions","className","overlay","opacity","okButton","getOkButton","cancelButton","getCancelButton","setRound","setColor","ButtonColor","DANGER","LIGHT_BORDER","removableDepartmentChildren","expandLevel","expandRecursively","middleBound","i","traverseSibling","siblingId","currentChildren","locateToCurrentDepartment","currentDepartment","treeRect","centerX","centerY","treeNode","treeNodeRect","departmentIds","TransformPanel","modelValue","selectedId","zoomInPercent","percent","toFixed","actions","zoomIn","zoomOut","locate","navigate","onZoom","leftBound","rightBound","tree","oldCenterX","oldCenterY","onfocusout","DetailPanelCollapsedTitle","avatars","maxVisibleAvatarsCount","additionalCount","DetailPanelEditButton","DetailPanel","DepartmentContent","preventPanelSwitch","isLoading","needToShowLoader","headAvatarsArray","avatar","newId","oldId","updateDetailPageHandler","newDepartments","toggleCollapse","showLoader","hideLoader","FirstPopup","subDescription","features","closePopup","Chart","TransformCanvas","ChartWizard","canvas","shown","moving","modelTransform","wizard","entity","detailPanel","initTransitionCompleted","slider","getTopSlider","Promise","all","closeLoader","parsedDepartments","availableDepartments","rootOffset","transformCanvas","showConfetti","handleInviteSliderMessage","PULL","PullClient","SubscriptionType","Server","moduleId","command","callback","clearChatLists","showWizardEventHandler","removeDepartmentEventHandler","onMoveTo","prevX","prevY","detailPanelWidthZoomed","newX","newY","samePoint","onUpdateTransform","onShowWizard","c_element","onModifyTree","onWizardClose","onRemoveDepartment","onTransitionEnd","Confetti","fire","particleCount","startVelocity","spread","ticks","origin","onControlDetail","messageEvent","eventId","getEventId","users","invitedUserData","getInvitedUserData","onKeyDown","preventDefault","UsersTabActionMenu","EmptyUsersTabActionMenu","FireUserFromCompanyMenuItem","isUserInvited","PERSONS_DENY","employeeFire","MoveFromDepartmentMenuItem","permissions","addMemberPermissionAction","removeMemberPermissionAction","teamRemoveMember","employeeRemoveFromDepartment","addMemberPermissionValue","ACTION_TEAM_MEMBER_ADD","ACTION_EMPLOYEE_ADD_TO_DEPARTMENT","removeMemberPermissionValue","ACTION_TEAM_MEMBER_REMOVE","moveUserPermission","RemoveFromDepartmentMenuItem","NotConvertedState","mount","containerId","container","updateTimeMs","updateConvertedStatusInterval","setInterval","e","code","clearInterval","reload","onCloseByEsc","sidePanelEvent","denyAction","App","app","BitrixVue","createApp","createPinia","use","init","unmount"],"mappings":"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"}