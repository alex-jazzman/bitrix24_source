this.BX=this.BX||{};this.BX.Humanresources=this.BX.Humanresources||{};(function(e,t,s,r,n){"use strict";const a=s.defineStore("hr-org-chart",{state:()=>({departments:new Map,currentDepartments:[],focusedNode:0,searchedUserId:0,userId:0,structureMap:new Map}),actions:{async refreshDepartments(e){if(e.length===0){return}const[t,s]=await Promise.all([r.getData("humanresources.api.Structure.Node.getByIds",{nodeIds:e}),r.getData("humanresources.api.Structure.Node.current")]);this.currentDepartments=s;Object.keys(t).forEach((e=>{const s=t[e];const r=this.departments.get(Number(e))||{};this.departments.set(Number(e),{...r,...s,heads:s.heads,userCount:s.userCount,employees:[],employeeListOptions:{page:0,shouldUpdateList:true,isListUpdated:false}})}))},changeCurrentDepartment(e,t){const s=this.currentDepartments.filter((s=>s!==e&&s!==t));if(!t){this.currentDepartments=s;return}this.currentDepartments=[...s,t]},async loadHeads(e){if(e.length===0){return}const t=await r.getData("humanresources.api.Structure.Node.getHeadsByIds",{nodeIds:e});e.forEach((e=>{const s=this.departments.get(e);if(t[e]){this.departments.set(e,{...s,heads:t[e]})}}))},updateDepartment(e,s){const{id:r,parentId:n}=e;const a=this.departments.get(r);const u=a.entityType;const i=this.departments.get(a.parentId);this.departments.set(r,{...a,...e});this.structureMap.set(r,{id:r,parentId:n!=null?n:a.parentId,entityType:u});if(n!==0&&i.id!==n){var c;i.children=i.children.filter((e=>e!==r));const e=this.departments.get(n);e.children=(c=e.children)!=null?c:[];if(t.Type.isNumber(s)){e.children.splice(s,0,r)}else{e.children.push(r)}this.departments.set(r,{...this.departments.get(r),prevParentId:i.id})}}}});e.useChartStore=a})(this.BX.Humanresources.CompanyStructure=this.BX.Humanresources.CompanyStructure||{},BX,BX.Vue3.Pinia,BX.Humanresources.CompanyStructure,BX.Humanresources.CompanyStructure);
//# sourceMappingURL=chart-store.bundle.map.js