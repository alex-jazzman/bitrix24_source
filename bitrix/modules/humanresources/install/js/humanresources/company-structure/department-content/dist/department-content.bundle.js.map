{"version":3,"file":"department-content.bundle.js","sources":["../src/components/users/consts.js","../src/components/users/empty-tab-add-button.js","../src/api.js","../src/components/users/item/action-button.js","../src/components/users/item/item.js","../src/components/base-components/empty-state/empty-state.js","../src/components/base-components/list/empty-list-item.js","../src/components/base-components/list/list-action-button.js","../src/components/base-components/list/list.js","../src/components/base-components/search/search-input.js","../src/actions.js","../src/components/users/tab.js","../src/components/chats/consts.js","../src/components/chats/empty-tab-add-buttons.js","../src/components/chats/dictionaries/action-button-dictionary.js","../src/components/chats/action-button.js","../src/components/chats/dictionaries/item-dictionary.js","../src/components/chats/list-item.js","../src/components/chats/dictionaries/list-dictionary.js","../src/components/chats/communication-list.js","../src/components/chats/children-mode-selector.js","../src/components/chats/dictionaries/dialog-dictionary.js","../src/components/chats/link-dialog.js","../src/components/chats/tab.js","../src/components/department-content.js"],"sourcesContent":["export const HeadListDataTestIds = Object.freeze({\n\tcontainerDataTestId: 'hr-department-content_users-tab__head-list-container',\n\tlistActionButtonDataTestId: 'hr-department-content_users-tab__head-list-action-button',\n\tlistActonMenuDataTestId: 'hr-department-content_users-tab__head-list-action-menu-container',\n\tlistCounterDataTestId: 'hr-department-content_users-tab__head-list-counter',\n});\n\nexport const EmployeeListDataTestIds = Object.freeze({\n\tcontainerDataTestId: 'hr-department-content_users-tab__employee-list-container',\n\tlistActionButtonDataTestId: 'hr-department-content_users-tab__employee-list-action-button',\n\tlistActonMenuDataTestId: 'hr-department-content_users-tab__employee-list-action-menu-container',\n\tlistCounterDataTestId: 'hr-department-content_users-tab__employee-list-counter',\n});\n","import { AnalyticsSourceType } from 'humanresources.company-structure.api';\nimport { EmptyUsersTabActionMenu } from 'humanresources.company-structure.org-chart';\nimport { useChartStore } from 'humanresources.company-structure.chart-store';\nimport { EntityTypes } from 'humanresources.company-structure.utils';\nimport { mapState } from 'ui.vue3.pinia';\nimport { RouteActionMenu } from 'humanresources.company-structure.structure-components';\n\nimport 'ui.icon-set.crm';\nimport 'ui.icon-set.main';\nimport './styles/empty-tab-add-buttons.css';\n\nexport const EmptyTabAddButton = {\n\tname: 'emptyStateContainer',\n\n\tcomponents: { RouteActionMenu },\n\n\tprops: {\n\t\tdepartmentId: {\n\t\t\ttype: Number,\n\t\t\trequired: true,\n\t\t},\n\t\tentityType: {\n\t\t\ttype: String,\n\t\t\tdefault: EntityTypes.department,\n\t\t},\n\t},\n\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tmenuVisible: false,\n\t\t};\n\t},\n\n\tcomputed: {\n\t\tmenu(): EmptyUsersTabActionMenu\n\t\t{\n\t\t\treturn new EmptyUsersTabActionMenu(this.departmentId, AnalyticsSourceType.DETAIL, null, this.entityType);\n\t\t},\n\t\t...mapState(useChartStore, ['focusedNode']),\n\t},\n\n\tmethods:\n\t{\n\t\tloc(phraseCode: string, replacements: {[p: string]: string} = {}): string\n\t\t{\n\t\t\treturn this.$Bitrix.Loc.getMessage(phraseCode, replacements);\n\t\t},\n\t\tonClick(): void\n\t\t{\n\t\t\tif ((this.entityType === EntityTypes.team) && (this.menu.items.length === 1))\n\t\t\t{\n\t\t\t\t// for teams for now there can be only one item, so we invoke action right away\n\t\t\t\tthis.onActionMenuItemClick(this.menu.items[0].id);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.menuVisible = true;\n\t\t\t}\n\t\t},\n\t\tonActionMenuItemClick(actionId: string): void\n\t\t{\n\t\t\tthis.menu.onActionMenuItemClick(actionId);\n\t\t},\n\t},\n\n\ttemplate: `\n\t\t<div class=\"hr-department-detail-content__users-empty-tab-add_buttons-container\">\n\t\t\t<button\n\t\t\t\tclass=\"hr-add-employee-empty-tab-entity-btn ui-btn ui-btn ui-btn-sm ui-btn-primary ui-btn-round\"\n\t\t\t\tref=\"actionMenuButton\"\n\t\t\t\t@click.stop=\"onClick\"\n\t\t\t\tdata-id=\"hr-department-detail-content__user-empty-tab_add-user-button\"\n\t\t\t>\n\t\t\t\t<span class=\"hr-add-employee-empty-tab-entity-btn-text\">{{loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_EMPTY_EMPLOYEES_ADD_USER_ADD_BUTTON')}}</span>\n\t\t\t</button>\n\t\t\t<RouteActionMenu\n\t\t\t\tv-if=\"menuVisible\"\n\t\t\t\t:id=\"'empty-state-department-detail-add-menu-' + focusedNode\"\n\t\t\t\t:items=\"menu.items\"\n\t\t\t\t:width=\"302\"\n\t\t\t\t:bindElement=\"$refs['actionMenuButton']\"\n\t\t\t\t@action=\"onActionMenuItemClick\"\n\t\t\t\t@close=\"menuVisible = false\"\n\t\t\t/>\n\t\t</div>\n\t`,\n};\n","import { getData, postData } from 'humanresources.company-structure.api';\nimport type { ChatListResponse } from 'humanresources.company-structure.utils';\n\nexport const DepartmentAPI = {\n\tgetPagedEmployees: (id: Number, page: Number, countPerPage: Number) => {\n\t\treturn getData('humanresources.api.Structure.Node.Member.Employee.list', { nodeId: id, page, countPerPage });\n\t},\n\tremoveUserFromDepartment: (nodeId: number, userId: number): Promise<void> => {\n\t\treturn postData('humanresources.api.Structure.Node.Member.deleteUser', {\n\t\t\tnodeId,\n\t\t\tuserId,\n\t\t});\n\t},\n\tmoveUserToDepartment: (nodeId: number, userId: number, targetNodeId: number, role: string): Promise<void> => {\n\t\treturn postData('humanresources.api.Structure.Node.Member.moveUser', {\n\t\t\tnodeId,\n\t\t\tuserId,\n\t\t\ttargetNodeId,\n\t\t\troleXmlId: role,\n\t\t});\n\t},\n\tisUserInMultipleDepartments: (userId: number): Promise<void> => {\n\t\treturn getData('humanresources.api.User.isUserInMultipleDepartments', {\n\t\t\tuserId,\n\t\t});\n\t},\n\tgetUserInfo: (nodeId: number, userId: number): Promise<void> => {\n\t\treturn getData('humanresources.api.User.getInfoByUserMember', {\n\t\t\tnodeId,\n\t\t\tuserId,\n\t\t});\n\t},\n\tfireUser: (userId: number): Promise<void> => {\n\t\treturn postData('intranet.user.fire', {\n\t\t\tuserId,\n\t\t});\n\t},\n\tfindMemberByQuery: (nodeId: number, query: string): Promise<void> => {\n\t\treturn getData('humanresources.api.Structure.Node.Member.find', {\n\t\t\tnodeId,\n\t\t\tquery,\n\t\t});\n\t},\n\tgetChatsAndChannels: (nodeId: number): Promise<ChatListResponse> => {\n\t\treturn getData('humanresources.api.Structure.Node.Member.Chat.getList', {\n\t\t\tnodeId,\n\t\t});\n\t},\n\tsaveChats: (\n\t\tnodeId: number,\n\t\tids: number[],\n\t\tremoveIds: number[],\n\t\twithChildren: number = 0,\n\t): Promise<Array> => {\n\t\treturn postData('humanresources.api.Structure.Node.Member.Chat.saveChatList', {\n\t\t\tnodeId,\n\t\t\tids,\n\t\t\tremoveIds,\n\t\t\twithChildren,\n\t\t});\n\t},\n\tsaveChannel: (\n\t\tnodeId: number,\n\t\tids: number[],\n\t\tremoveIds: number[],\n\t\twithChildren: number = 0,\n\t): Promise<Array> => {\n\t\treturn postData('humanresources.api.Structure.Node.Member.Chat.saveChannelList', {\n\t\t\tnodeId,\n\t\t\tids,\n\t\t\tremoveIds,\n\t\t\twithChildren,\n\t\t});\n\t},\n\tsaveCollab: (\n\t\tnodeId: number,\n\t\tids: number[],\n\t\tremoveIds: number[],\n\t\twithChildren: number = 0,\n\t): Promise<Array> => {\n\t\treturn postData('humanresources.api.Structure.Node.Member.Chat.saveCollabList', {\n\t\t\tnodeId,\n\t\t\tids,\n\t\t\tremoveIds,\n\t\t\twithChildren,\n\t\t});\n\t},\n};\n","import { RouteActionMenu, ConfirmationPopup, MoveUserPopup } from 'humanresources.company-structure.structure-components';\nimport { Text } from 'main.core';\nimport { UserListActionMenu, MenuActions } from 'humanresources.company-structure.org-chart';\nimport { DepartmentAPI } from '../../../api';\nimport { memberRoles } from 'humanresources.company-structure.api';\nimport { useChartStore, UserService } from 'humanresources.company-structure.chart-store';\nimport { mapState } from 'ui.vue3.pinia';\nimport { UI } from 'ui.notification';\nimport { EntityTypes } from 'humanresources.company-structure.utils';\n\nimport './styles/action-button.css';\n\nexport const UserListItemActionButton = {\n\tname: 'userList',\n\n\tprops: {\n\t\tuser: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t\tdepartmentId: {\n\t\t\ttype: Number,\n\t\t\trequired: true,\n\t\t},\n\t},\n\n\tcomponents: {\n\t\tRouteActionMenu,\n\t\tConfirmationPopup,\n\t\tMoveUserPopup,\n\t},\n\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tmenuVisible: {},\n\t\t\tshowRemoveUserConfirmationPopup: false,\n\t\t\tshowRemoveUserConfirmationActionLoader: false,\n\t\t\tshowMoveUserPopup: false,\n\t\t\tshowMoveUserPopupOnlyMoveMode: false,\n\t\t\tshowFireUserPopup: false,\n\t\t\tfireUserLoad: false,\n\t\t};\n\t},\n\n\tmethods: {\n\t\ttoggleMenu(userId)\n\t\t{\n\t\t\tthis.menuVisible[userId] = !this.menuVisible[userId];\n\t\t},\n\t\tloc(phraseCode: string, replacements: { [p: string]: string } = {}): string\n\t\t{\n\t\t\treturn this.$Bitrix.Loc.getMessage(phraseCode, replacements);\n\t\t},\n\t\tonActionMenuItemClick(actionId: string): void\n\t\t{\n\t\t\tif (actionId === MenuActions.removeUserFromDepartment)\n\t\t\t{\n\t\t\t\tif (this.isTeamEntity)\n\t\t\t\t{\n\t\t\t\t\tthis.showRemoveUserConfirmationPopup = true;\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.showMoveUserPopupOnlyMoveMode = false;\n\t\t\t\t\tthis.showMoveUserPopup = true;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (actionId === MenuActions.moveUserToAnotherDepartment)\n\t\t\t{\n\t\t\t\tthis.showMoveUserPopupOnlyMoveMode = true;\n\t\t\t\tthis.showMoveUserPopup = true;\n\t\t\t}\n\n\t\t\tif (actionId === MenuActions.fireUserFromCompany)\n\t\t\t{\n\t\t\t\tthis.showFireUserPopup = true;\n\t\t\t}\n\t\t},\n\t\tasync removeUser(): Promise<void>\n\t\t{\n\t\t\tthis.showRemoveUserConfirmationActionLoader = true;\n\t\t\tconst userId = this.user.id;\n\t\t\tconst isUserInMultipleDepartments = await DepartmentAPI.isUserInMultipleDepartments(userId);\n\t\t\tconst departmentId = this.focusedNode;\n\t\t\tthis.showRemoveUserConfirmationActionLoader = false;\n\t\t\tthis.showRemoveUserConfirmationPopup = false;\n\t\t\tthis.showMoveUserPopup = false;\n\n\t\t\ttry\n\t\t\t{\n\t\t\t\tawait DepartmentAPI.removeUserFromDepartment(departmentId, userId);\n\t\t\t}\n\t\t\tcatch\n\t\t\t{\n\t\t\t\tconst phraseCode = this.isTeamEntity\n\t\t\t\t\t? this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_USERS_USER_ACTION_MENU_REMOVE_FROM_TEAM_ERROR')\n\t\t\t\t\t: this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_USERS_USER_ACTION_MENU_REMOVE_FROM_DEPARTMENT_ERROR')\n\t\t\t\t;\n\t\t\t\tUI.Notification.Center.notify({\n\t\t\t\t\tcontent: phraseCode,\n\t\t\t\t\tautoHideDelay: 2000,\n\t\t\t\t});\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst phraseCode = this.isTeamEntity\n\t\t\t\t? 'HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_USERS_USER_ACTION_MENU_REMOVE_FROM_TEAM_SUCCESS'\n\t\t\t\t: 'HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_USERS_USER_ACTION_MENU_REMOVE_FROM_DEPARTMENT_SUCCESS';\n\t\t\tconst departmentName = Text.encode(this.departments.get(this.focusedNode).name ?? '');\n\t\t\tUI.Notification.Center.notify({\n\t\t\t\tcontent: this.loc(phraseCode, { '#DEPARTMENT_NAME#': departmentName }),\n\t\t\t\tautoHideDelay: 2000,\n\t\t\t});\n\n\t\t\tconst role = this.user.role;\n\t\t\tif (isUserInMultipleDepartments || this.isTeamEntity)\n\t\t\t{\n\t\t\t\tUserService.removeUserFromEntity(departmentId, userId, role);\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst rootDepartment = [...this.departments.values()].find((department) => department.parentId === 0);\n\t\t\tif (!rootDepartment)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tUserService.moveUserToEntity(\n\t\t\t\tdepartmentId,\n\t\t\t\tuserId,\n\t\t\t\trootDepartment.id,\n\t\t\t\trole,\n\t\t\t);\n\t\t},\n\t\tcancelRemoveUser(): void\n\t\t{\n\t\t\tthis.showRemoveUserConfirmationPopup = false;\n\t\t},\n\t\tasync fireUser(): void\n\t\t{\n\t\t\tthis.fireUserLoad = true;\n\n\t\t\tconst userId = this.user.id;\n\n\t\t\ttry\n\t\t\t{\n\t\t\t\tawait DepartmentAPI.fireUser(userId);\n\t\t\t}\n\t\t\tcatch (error)\n\t\t\t{\n\t\t\t\tif (error.code !== 'STRUCTURE_ACCESS_DENIED')\n\t\t\t\t{\n\t\t\t\t\tUI.Notification.Center.notify({\n\t\t\t\t\t\tcontent: this.user.isInvited\n\t\t\t\t\t\t\t? this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_USERS_USER_ACTION_MENU_DELETE_ERROR')\n\t\t\t\t\t\t\t: this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_USERS_USER_ACTION_MENU_FIRE_ERROR'),\n\t\t\t\t\t\tautoHideDelay: 2000,\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\tthis.showFireUserPopup = false;\n\t\t\t\tthis.fireUserLoad = false;\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tUserService.removeUserFromEntity(this.focusedNode, userId, this.user.role);\n\t\t\tawait UserService.removeUserFromAllEntities(userId);\n\t\t\tthis.showFireUserPopup = false;\n\t\t\tthis.fireUserLoad = false;\n\t\t},\n\t\tcancelFireUser(): void\n\t\t{\n\t\t\tthis.showFireUserPopup = false;\n\t\t},\n\t\thandleMoveUserAction(): void\n\t\t{\n\t\t\tthis.showMoveUserPopup = false;\n\t\t},\n\t\thandleMoveUserClose(): void\n\t\t{\n\t\t\tthis.showMoveUserPopup = false;\n\t\t},\n\t\tgetMemberKeyByValue(value: string): string\n\t\t{\n\t\t\treturn Object.keys(memberRoles).find((key) => memberRoles[key] === value) || '';\n\t\t},\n\t},\n\n\tcreated(): void\n\t{\n\t\tthis.menu = new UserListActionMenu(this.focusedNode, this.entityType, this.user.isInvited);\n\t},\n\n\tcomputed: {\n\t\t...mapState(useChartStore, ['focusedNode', 'departments']),\n\t\tmemberRoles(): typeof memberRoles\n\t\t{\n\t\t\treturn memberRoles;\n\t\t},\n\t\tgetFirePopupDescription(): string\n\t\t{\n\t\t\tconst userName = Text.encode(this.user.name ?? '');\n\t\t\tconst userUrl = Text.encode(this.user.url ?? '');\n\t\t\tconst genderSuffix = this.user.gender === 'F' ? '_F' : '_M';\n\n\t\t\tconst phrase = this.user.isInvited\n\t\t\t\t? `HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_USERS_USER_ACTION_MENU_DELETE_POPUP_DESCRIPTION${genderSuffix}`\n\t\t\t\t: `HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_USERS_USER_ACTION_MENU_FIRE_POPUP_DESCRIPTION${genderSuffix}`\n\t\t\t;\n\n\t\t\tconst description = this.loc(phrase, {\n\t\t\t\t'#USER_NAME#': userName,\n\t\t\t});\n\n\t\t\treturn description.replace('[link]', `<a class=\"hr-department-detail-content__fire-user-link\" href=\"${userUrl}\">`)\n\t\t\t\t.replace('[/link]', '</a>')\n\t\t\t;\n\t\t},\n\t\tgetFirePopupTitle(): string\n\t\t{\n\t\t\treturn this.user.isInvited\n\t\t\t\t? this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_USERS_USER_ACTION_MENU_DELETE_POPUP_TITLE')\n\t\t\t\t: this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_USERS_USER_ACTION_MENU_FIRE_POPUP_TITLE');\n\t\t},\n\t\tgetFirePopupButtonText(): string\n\t\t{\n\t\t\treturn this.user.isInvited\n\t\t\t\t? this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_USERS_USER_ACTION_MENU_DELETE_POPUP_CONFIRM_BUTTON')\n\t\t\t\t: this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_USERS_USER_ACTION_MENU_FIRE_POPUP_CONFIRM_BUTTON');\n\t\t},\n\t\tgetRemovePopupTitle(): string\n\t\t{\n\t\t\treturn this.isTeamEntity\n\t\t\t\t? this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_USERS_USER_ACTION_MENU_REMOVE_FROM_TEAM_POPUP_TITLE')\n\t\t\t\t: this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_USERS_USER_ACTION_MENU_REMOVE_FROM_DEPARTMENT_POPUP_TITLE');\n\t\t},\n\t\tgetRemovePopupDescription(): string\n\t\t{\n\t\t\tconst departmentName = Text.encode(this.departments.get(this.focusedNode).name ?? '');\n\t\t\tconst userName = Text.encode(this.user.name ?? '');\n\n\t\t\tif (this.isTeamEntity)\n\t\t\t{\n\t\t\t\tconst phraseCode = 'HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_USERS_USER_ACTION_MENU_REMOVE_FROM_TEAM_POPUP_DESCRIPTION';\n\t\t\t\tconst genderSuffix = this.user.gender === 'F' ? '_F' : '_M';\n\n\t\t\t\treturn this.loc(\n\t\t\t\t\tphraseCode + genderSuffix,\n\t\t\t\t\t{\n\t\t\t\t\t\t'#USER_NAME#': userName,\n\t\t\t\t\t\t'#DEPARTMENT_NAME#': departmentName,\n\t\t\t\t\t},\n\t\t\t\t)\n\t\t\t\t\t.replace(\n\t\t\t\t\t\t'[link]',\n\t\t\t\t\t\t`<a class=\"hr-department-detail-content__move-user-department-user-link\" href=\"${this.user.url}\">`,\n\t\t\t\t\t)\n\t\t\t\t\t.replace('[/link]', '</a>')\n\t\t\t\t;\n\t\t\t}\n\n\t\t\treturn this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_USERS_USER_ACTION_MENU_REMOVE_FROM_DEPARTMENT_POPUP_DESCRIPTION');\n\t\t},\n\t\tentityType(): string\n\t\t{\n\t\t\treturn this.departments.get(this.focusedNode)?.entityType;\n\t\t},\n\t\tisTeamEntity(): boolean\n\t\t{\n\t\t\treturn this.entityType === EntityTypes.team;\n\t\t},\n\t},\n\n\ttemplate: `\n\t\t<button\n\t\t\tv-if=\"menu.items.length\"\n\t\t\tclass=\"ui-icon-set --more hr-department-detail-content__user-action-btn\"\n\t\t\t:class=\"{ '--focused': menuVisible[user.id] }\"\n\t\t\t@click.stop=\"toggleMenu(user.id)\"\n\t\t\tref=\"actionUserButton\"\n\t\t\t:data-id=\"'hr-department-detail-content__'+ getMemberKeyByValue(user.role) + '-list_user-' + user.id + '-action-btn'\"\n\t\t/>\n\t\t<RouteActionMenu\n\t\t\tv-if=\"menuVisible[user.id]\"\n\t\t\t:id=\"'tree-node-department-menu-' + user.id\"\n\t\t\t:items=\"menu.items\"\n\t\t\t:width=\"302\"\n\t\t\t:bindElement=\"$refs.actionUserButton\"\n\t\t\t@action=\"onActionMenuItemClick\"\n\t\t\t@close=\"menuVisible[user.id] = false\"\n\t\t/>\n\t\t<ConfirmationPopup\n\t\t\tref=\"removeUserConfirmationPopup\"\n\t\t\tv-if=\"showRemoveUserConfirmationPopup\"\n\t\t\t:showActionButtonLoader=\"showRemoveUserConfirmationActionLoader\"\n\t\t\t:title=\"getRemovePopupTitle\"\n\t\t\t:confirmBtnText=\"loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_USERS_USER_ACTION_MENU_REMOVE_FROM_DEPARTMENT_POPUP_CONFIRM_BUTTON')\"\n\t\t\t:confirmButtonClass=\"isTeamEntity ? 'ui-btn-danger' : 'ui-btn-primary'\"\n\t\t\t@action=\"removeUser\"\n\t\t\t@close=\"cancelRemoveUser\"\n\t\t\t:width=\"364\"\n\t\t>\n\t\t\t<template v-slot:content>\n\t\t\t\t<div class=\"hr-department-detail-content__user-action-text-container\">\n\t\t\t\t<div\n\t\t\t\t\tv-html=\"getRemovePopupDescription\"\n\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t</template>\n\t\t</ConfirmationPopup>\n\t\t<ConfirmationPopup\n\t\t\tref=\"fireUserConfirmationPopup\"\n\t\t\tv-if=\"showFireUserPopup\"\n\t\t\t:showActionButtonLoader=\"fireUserLoad\"\n\t\t\t:title=\"getFirePopupTitle\"\n\t\t\t:confirmBtnText=\"getFirePopupButtonText\"\n\t\t\t:confirmButtonClass=\"'ui-btn-danger'\"\n\t\t\t@action=\"fireUser\"\n\t\t\t@close=\"cancelFireUser\"\n\t\t\t:width=\"364\"\n\t\t>\n\t\t\t<template v-slot:content>\n\t\t\t\t<div class=\"hr-department-detail-content__user-action-text-container\">\n\t\t\t\t\t<div\n\t\t\t\t\t\tv-html=\"getFirePopupDescription\"\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t</template>\n\t\t</ConfirmationPopup>\n\t\t<MoveUserPopup\n\t\t\tv-if=\"showMoveUserPopup\"\n\t\t\t:originalNodeId=\"focusedNode\"\n\t\t\t:user=\"user\"\n\t\t\t:entityType=\"entityType\"\n\t\t\t:onlyMove=\"showMoveUserPopupOnlyMoveMode\"\n\t\t\t@action=\"handleMoveUserAction\"\n\t\t\t@close=\"handleMoveUserClose\"\n\t\t\t@remove=\"removeUser\"\n\t\t/>\n\t`,\n};\n","import { mapState } from 'ui.vue3.pinia';\n\nimport { getMemberRoles, type MemberRolesType } from 'humanresources.company-structure.api';\nimport { UserListItemActionButton } from './action-button';\nimport { useChartStore } from 'humanresources.company-structure.chart-store';\n\nimport 'ui.tooltip';\nimport './styles/item.css';\n\nexport const UserListItem = {\n\tname: 'userList',\n\temits: ['itemDragStart'],\n\tprops: {\n\t\tuser: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t\tselectedUserId: {\n\t\t\ttype: Number,\n\t\t\trequired: false,\n\t\t\tdefault: null,\n\t\t},\n\t\tentityType: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t\tlistType: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t\tcanDrag: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t},\n\n\tcomponents: { UserListItemActionButton },\n\n\tcomputed: {\n\t\tmemberRoles(): MemberRolesType\n\t\t{\n\t\t\treturn getMemberRoles(this.entityType);\n\t\t},\n\t\tdefaultAvatar(): string\n\t\t{\n\t\t\treturn '/bitrix/js/humanresources/company-structure/org-chart/src/images/default-user.svg';\n\t\t},\n\t\t...mapState(useChartStore, ['focusedNode']),\n\t},\n\n\tmethods: {\n\t\tloc(phraseCode: string, replacements: { [p: string]: string } = {}): string\n\t\t{\n\t\t\treturn this.$Bitrix.Loc.getMessage(phraseCode, replacements);\n\t\t},\n\t\thandleUserClick(item): void\n\t\t{\n\t\t\tBX.SidePanel.Instance.open(item.url, {\n\t\t\t\tcacheable: false,\n\t\t\t});\n\t\t},\n\t\thandleMouseDown(event: MouseEvent): void\n\t\t{\n\t\t\tevent.preventDefault();\n\n\t\t\tthis.$emit('itemDragStart', {\n\t\t\t\tuserId: this.user.id,\n\t\t\t\tinitialListType: this.listType,\n\t\t\t\tevent,\n\t\t\t\telement: this.$el,\n\t\t\t});\n\t\t},\n\t},\n\n\ttemplate: `\n\t\t<div \n\t\t\t:key=\"user.id\"\n\t\t\tclass=\"hr-department-detail-content__user-container\"\n\t\t\t:class=\"{ '--searched': user.id === selectedUserId }\"\n\t\t\t:data-id=\"'hr-department-detail-content__user-' + user.id + '-item'\"\n\t\t>\n\t\t\t<span v-if=\"canDrag\"\n\t\t\t\t  @mousedown=\"handleMouseDown\"\n\t\t\t\t  class=\"hr-department-detail-content__dnd-icon ui-icon-set --more-points\">\n\t\t\t</span>\n\t\t\t<div class=\"hr-department-detail-content__user-avatar-container\" @click=\"handleUserClick(user)\">\n\t\t\t\t<img \n\t\t\t\t\tclass=\"hr-department-detail-content__user-avatar-img\"\n\t\t\t\t\t:src=\"user.avatar ? encodeURI(user.avatar) : defaultAvatar\"\n\t\t\t\t    alt=\"\"\n\t\t\t\t/>\n\t\t\t\t<div v-if=\"user.role === memberRoles.head\" class=\"hr-department-detail-content__user-avatar-overlay\"></div>\n\t\t\t</div>\n\t\t\t<div class=\"hr-department-detail-content-user__text-container\">\n\t\t\t\t<div class=\"hr-department-detail-content__user-title\">\n\t\t\t\t\t<div \n\t\t\t\t\t\tclass=\"hr-department-detail-content__user-name\" \n\t\t\t\t\t\t@click=\"handleUserClick(user)\"\n\t\t\t\t\t\t:bx-tooltip-user-id=\"user.id\"\n\t\t\t\t\t\tbx-tooltip-context=\"b24\"\n\t\t\t\t\t\t:data-id=\"'hr-department-detail-content__user-' + user.id + '-item-name'\"\n\t\t\t\t\t>\n\t\t\t\t\t\t{{ user.name }}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div v-if=\"user.badgeText\" class=\"hr-department-detail-content-user__name-badge\">{{ user.badgeText }}</div>\n\t\t\t\t</div>\n\t\t\t\t<div \n\t\t\t\t\tclass=\"hr-department-detail-content__user-subtitle\" \n\t\t\t\t\t:class=\"{ '--without-work-position': !user.subtitle }\"\n\t\t\t\t>\n\t\t\t\t\t{{ (user.subtitle?.length ?? 0) > 0 ? user.subtitle : this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_USERS_LIST_DEFAULT_WORK_POSITION') }}\n\t\t\t\t</div>\n\t\t\t\t<div v-if=\"user.isInvited\" class=\"hr-department-detail-content-user__item-badge\">\n\t\t\t\t\t{{ this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_USERS_LIST_INVITED_BADGE_TEXT') }}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<UserListItemActionButton\n\t\t\t\t:user=\"user\"\n\t\t\t\t:departmentId=\"focusedNode\"\n\t\t\t/>\n\t\t</div>\n\t`,\n};\n","import 'ui.icon-set.main';\nimport './empty-state.css';\n\nexport const EmptyState = {\n\tname: 'emptyState',\n\n\tprops: {\n\t\ttitle: {\n\t\t\ttype: String,\n\t\t\trequired: false,\n\t\t},\n\t\timageClass: {\n\t\t\ttype: String,\n\t\t\trequired: false,\n\t\t},\n\t\tdescription: {\n\t\t\ttype: String,\n\t\t\trequired: false,\n\t\t},\n\t\tlist: {\n\t\t\ttype: Array,\n\t\t\trequired: false,\n\t\t\tdefault: [],\n\t\t},\n\t},\n\n\tmethods: {\n\t\tloc(phraseCode: string, replacements: {[p: string]: string} = {}): string\n\t\t{\n\t\t\treturn this.$Bitrix.Loc.getMessage(phraseCode, replacements);\n\t\t},\n\t},\n\n\ttemplate: `\n\t\t<div class=\"hr-department-detail-content_tab__empty-state-container\">\n\t\t\t<div v-if=\"imageClass\" :class=\"['hr-department-detail-content_tab__empty-state-icon', imageClass]\"/>\n\t\t\t<span v-if=\"title\" class=\"hr-department-detail-content__empty-tab-entity-title\">\n\t\t\t\t{{ title }}\n\t\t\t</span>\n\t\t\t<span v-if=\"description\" class=\"hr-department-detail-content_tab__empty-state-description\">\n\t\t\t\t{{ description }}\n\t\t\t</span>\n\t\t\t<div v-if=\"list.length > 0\" class=\"hr-department-detail-content_tab__empty-state-list\">\n\t\t\t\t<div class=\"hr-department-detail-content_tab__empty-state-list-item\"  v-for=\"item in list\">\n\t\t\t\t\t<div \n\t\t\t\t\t\tclass=\"ui-icon-set --circle-check hr-department-detail-content_tab__empty-state-list-item-check\"\n\t\t\t\t\t\tstyle=\"--ui-icon-set__icon-size: 24px;\"\n\t\t\t\t\t/>\n\t\t\t\t\t<div class=\"hr-department-detail-content_tab__empty-state-list--item-text\">\n\t\t\t\t\t\t{{ item.text }}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<slot name=\"content\"/>\n\t\t</div>\n\t`,\n};\n","import './styles/empty-list-item.css';\n\nexport const EmptyListItem = {\n\tname: 'tabEmptyListItem',\n\n\tprops: {\n\t\ttitle: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t\timageClass: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t\twithAddPermission: {\n\t\t\ttype: Boolean,\n\t\t\trequired: false,\n\t\t\tdefault: true,\n\t\t},\n\t},\n\n\ttemplate: `\n\t\t<div :class=\"['hr-department-detail-content__tab-empty-list_item-wrapper', { '--with-add': withAddPermission }]\">\n\t\t\t<div class=\"hr-department-detail-content__tab-empty-list_item-image\" :class=\"imageClass\"/>\n\t\t\t<div class=\"hr-department-detail-content__tab-empty-list_item-content\">\n\t\t\t\t<div class=\"hr-department-detail-content__tab-empty-list_item-title\">\n\t\t\t\t\t{{ title }}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};","import { useChartStore } from 'humanresources.company-structure.chart-store';\nimport { mapState } from 'ui.vue3.pinia';\nimport { RouteActionMenu } from 'humanresources.company-structure.structure-components';\nimport './styles/list-action-button.css';\n\nexport const ListActionButton = {\n\tname: 'userListActionButton',\n\temits: ['tabListAction', 'close'],\n\n\tprops:\n\t\t{\n\t\t\tid: {\n\t\t\t\ttype: String,\n\t\t\t\trequired: true,\n\t\t\t},\n\t\t\tmenuItems: {\n\t\t\t\ttype: Array,\n\t\t\t\trequired: true,\n\t\t\t},\n\t\t\tdataTestIds: {\n\t\t\t\ttype: Object,\n\t\t\t\trequired: false,\n\t\t\t\tdefault: {},\n\t\t\t},\n\t\t},\n\n\tcomponents:\n\t{\n\t\tRouteActionMenu,\n\t},\n\n\tcomputed:\n\t{\n\t\t...mapState(useChartStore, ['focusedNode']),\n\t},\n\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tmenuVisible: false,\n\t\t};\n\t},\n\n\tmethods: {\n\t\tloc(phraseCode: string, replacements: { [p: string]: string } = {}): string\n\t\t{\n\t\t\treturn this.$Bitrix.Loc.getMessage(phraseCode, replacements);\n\t\t},\n\t\tonActionMenuItemClick(itemId: string): void\n\t\t{\n\t\t\tthis.$emit('tabListAction', itemId);\n\t\t},\n\t},\n\n\ttemplate: `\n\t\t<button\n\t\t\tv-if=\"menuItems.length\"\n\t\t\tclass=\"hr-department-detail-content__tab-list_header-button\"\n\t\t\t:class=\"{ '--focused': menuVisible }\"\n\t\t\t:ref=\"id + '-route-action-menu'\"\n\t\t\t@click.stop=\"menuVisible = true\"\n\t\t\t:data-test-id=\"dataTestIds.buttonDataTestId\"\n\t\t>\n\t\t\t{{ loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_USERS_LIST_ACTION_BUTTON_TITLE') }}\n\t\t</button>\n\t\t<RouteActionMenu\n\t\t\tv-if=\"menuVisible\"\n\t\t\t:id=\"id + '-route-action-menu'\"\n\t\t\t:items=\"menuItems\"\n\t\t\t:width=\"302\"\n\t\t\t:bindElement=\"$refs[id + '-route-action-menu']\"\n\t\t\t:containerDataTestId=\"dataTestIds.containerDataTestId\"\n\t\t\t@action=\"onActionMenuItemClick\"\n\t\t\t@close=\"menuVisible = false\"\n\t\t/>\n\t`,\n};\n","import { Event, Runtime, Type } from 'main.core';\nimport { EmptyListItem } from './empty-list-item';\nimport { ListActionButton } from './list-action-button';\n\n// eslint-disable-next-line no-unused-vars\nimport type { TabListDataTestIds } from './types';\nimport './styles/list.css';\n\nexport const TabList = {\n\tname: 'tabList',\n\tcomponents: { ListActionButton, EmptyListItem },\n\temits: ['tabListAction'],\n\n\tprops: {\n\t\tid: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t\ttitle: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t\tcount: {\n\t\t\ttype: Number,\n\t\t\trequired: false,\n\t\t},\n\t\tmenuItems: {\n\t\t\ttype: Array,\n\t\t\trequired: false,\n\t\t\tdefault: [],\n\t\t},\n\t\tlistItems: {\n\t\t\ttype: Array,\n\t\t\trequired: true,\n\t\t},\n\t\temptyItemTitle: {\n\t\t\ttype: String,\n\t\t\trequired: false,\n\t\t},\n\t\temptyItemImageClass: {\n\t\t\ttype: String,\n\t\t\trequired: false,\n\t\t},\n\t\thideEmptyItem: {\n\t\t\ttype: Boolean,\n\t\t\trequired: false,\n\t\t\tdefault: false,\n\t\t},\n\t\twithAddPermission: {\n\t\t\ttype: Boolean,\n\t\t\trequired: false,\n\t\t\tdefault: true,\n\t\t},\n\t\t/** @var { TabListDataTestIds } dataTestIds */\n\t\tdataTestIds: {\n\t\t\ttype: Object,\n\t\t\trequired: false,\n\t\t\tdefault: {},\n\t\t},\n\t\tisDropTarget: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t\tlistType: {\n\t\t\ttype: String,\n\t\t},\n\t},\n\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tplaceholderIndex: null,\n\t\t\tboundHandleDragOverList: null,\n\t\t};\n\t},\n\n\tcomputed: {\n\t\tneedToShowCount(): boolean\n\t\t{\n\t\t\treturn Type.isNumber(this.count);\n\t\t},\n\t},\n\n\twatch: {\n\t\tisDropTarget(newValue, oldValue): void\n\t\t{\n\t\t\tif (newValue === oldValue)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tconst itemsWrapper = this.$refs.itemsWrapper;\n\t\t\tif (!itemsWrapper)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (newValue)\n\t\t\t{\n\t\t\t\tthis.boundHandleDragOverList = Runtime.throttle(this.handleDragOverList.bind(this), 10);\n\t\t\t\tEvent.bind(itemsWrapper, 'mousemove', this.boundHandleDragOverList);\n\n\t\t\t\tif (this.listItems.length === 0)\n\t\t\t\t{\n\t\t\t\t\tthis.placeholderIndex = 0;\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tEvent.unbind(itemsWrapper, 'mousemove', this.boundHandleDragOverList);\n\t\t\t\tthis.boundHandleDragOverList = null;\n\t\t\t\tthis.placeholderIndex = null;\n\t\t\t}\n\t\t},\n\t},\n\n\tmethods: {\n\t\tonActionMenuItemClick(actionId: string): void\n\t\t{\n\t\t\tthis.$emit('tabListAction', actionId);\n\t\t},\n\t\thandleDragOverList(event: MouseEvent): void\n\t\t{\n\t\t\tif (!this.isDropTarget || !this.$refs.itemsWrapper)\n\t\t\t{\n\t\t\t\tif (this.placeholderIndex !== null)\n\t\t\t\t{\n\t\t\t\t\tthis.placeholderIndex = null;\n\t\t\t\t}\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst itemsWrapper = this.$refs.itemsWrapper;\n\t\t\tconst children = [...itemsWrapper.querySelectorAll('.hr-department-detail-content__user-container:not(.--dragging)')];\n\t\t\tconst mouseY = event.clientY;\n\n\t\t\tif (children.length === 0)\n\t\t\t{\n\t\t\t\tif (this.placeholderIndex !== 0)\n\t\t\t\t{\n\t\t\t\t\tthis.placeholderIndex = 0;\n\t\t\t\t}\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tlet newIndex = children.length;\n\n\t\t\tfor (const [i, child] of children.entries())\n\t\t\t{\n\t\t\t\tconst rect = child.getBoundingClientRect();\n\t\t\t\tconst childMidpointY = rect.top + rect.height / 2;\n\n\t\t\t\tif (mouseY < childMidpointY)\n\t\t\t\t{\n\t\t\t\t\tnewIndex = i;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (newIndex !== this.placeholderIndex)\n\t\t\t{\n\t\t\t\tthis.placeholderIndex = newIndex;\n\t\t\t}\n\t\t},\n\t},\n\n\ttemplate: `\n\t\t<div\n\t\t\tclass=\"hr-department-detail-content__tab-list_container\"\n\t\t\t :data-test-id=\"dataTestIds.containerDataTestId\"\n\t\t>\n\t\t\t<div class=\"hr-department-detail-content__tab-list_header-container\">\n\t\t\t\t<div class=\"hr-department-detail-content__tab-list_list-title\">\n\t\t\t\t\t{{ title }}\n\t\t\t\t\t<span\n\t\t\t\t\t\tv-if=\"needToShowCount\"\n\t\t\t\t\t\tclass=\"hr-department-detail-content__tab-list_header-count\"\n\t\t\t\t\t\t:data-test-id=\"dataTestIds.listCounterDataTestId\"\n\t\t\t\t\t>\n\t\t\t\t\t{{ count }}\n\t\t\t\t</span>\n\t\t\t\t</div>\n\t\t\t\t<ListActionButton\n\t\t\t\t\t:id=\"id\"\n\t\t\t\t\t:menuItems=\"menuItems\"\n\t\t\t\t\t@tabListAction=\"onActionMenuItemClick\"\n\t\t\t\t\t:dataTestIds=\"{buttonDataTestId: dataTestIds.listActionButtonDataTestId, containerDataTestId: dataTestIds.listActonMenuDataTestId}\"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t\t<div class=\"hr-department-detail-content__tab_list-container\" ref=\"itemsWrapper\">\n\t\t\t\t<div\n\t\t\t\t\tv-if=\"placeholderIndex === 0 && isDropTarget\"\n\t\t\t\t\tclass=\"hr-department-detail-content__drop-placeholder\"\n\t\t\t\t></div>\n\t\t\t\t<template v-for=\"(item, index) in listItems\" :key=\"item.id\">\n\t\t\t\t\t<slot :item=\"item\"\n\t\t\t\t\t/>\n\t\t\t\t\t<div\n\t\t\t\t\t\tv-if=\"placeholderIndex === (index + 1) && isDropTarget\"\n\t\t\t\t\t\tclass=\"hr-department-detail-content__drop-placeholder\"\n\t\t\t\t\t></div>\n\t\t\t\t</template>\n\t\t\t\t<slot name=\"footer\" />\n\t\t\t\t<EmptyListItem v-if=\"emptyItemTitle && emptyItemImageClass && !listItems.length && !hideEmptyItem\"\n\t\t\t\t\t:title=\"emptyItemTitle\"\n\t\t\t\t\t:imageClass=\"emptyItemImageClass\"\n\t\t\t\t\t:withAddPermission=\"withAddPermission\"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import 'ui.icon-set.main';\nimport './search-input.css';\n\nexport const SearchInput = {\n\tname: 'searchInput',\n\tprops: {\n\t\tvalue: {\n\t\t\ttype: String,\n\t\t\trequired: false,\n\t\t\tdefault: '',\n\t\t},\n\t\tplaceholder: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t\tdataTestId: {\n\t\t\ttype: String,\n\t\t\trequired: false,\n\t\t},\n\t},\n\n\tdata(): {hasFocus: boolean}\n\t{\n\t\treturn {\n\t\t\thasFocus: false,\n\t\t};\n\t},\n\n\tmethods: {\n\t\thandleInput(event: InputEvent): void\n\t\t{\n\t\t\tthis.$emit('inputChange', event.target.value);\n\t\t},\n\t\thandleBlur(): void\n\t\t{\n\t\t\tif (this.value.length === 0)\n\t\t\t{\n\t\t\t\tthis.hasFocus = false;\n\t\t\t}\n\t\t},\n\t\tclearInput(): void\n\t\t{\n\t\t\tthis.hasFocus = false;\n\t\t\tthis.$emit('inputChange', '');\n\t\t},\n\t},\n\n\ttemplate: `\n\t\t<div\n\t\t\tclass=\"hr-department-detail-content__content-search\"\n\t\t\t:class=\"{'--focused': hasFocus}\"\n\t\t>\n\t\t\t<div class=\"hr-department-detail-content__content-search-icon ui-icon-set --search-1\"/>\n\t\t\t<input\n\t\t\t\tclass=\"hr-department-detail-content__content-search-input\"\n\t\t\t\ttype=\"text\"\n\t\t\t\t:placeholder=\"!hasFocus ?  placeholder : ''\"\n\t\t\t\t:data-test-id=\"dataTestId\"\n\t\t\t\t:value=\"value\"\n\t\t\t\t@input=\"handleInput\"\n\t\t\t\t@focus=\"hasFocus = true\"\n\t\t\t\t@blur=\"handleBlur\"\n\t\t\t>\n\t\t\t<div\n\t\t\t\tclass=\"hr-department-detail-content__content-search-close-button ui-icon-set --cross-circle-50\"\n\t\t\t\t:class=\"{'--hide': !hasFocus}\"\n\t\t\t\t@click=\"clearInput\"\n\t\t\t/>\n\t\t</div>\n\t`,\n};\n","import { useChartStore } from 'humanresources.company-structure.chart-store';\nimport { ChatTypes } from 'humanresources.company-structure.utils';\nimport type { CommunicationDetailed } from 'humanresources.company-structure.utils';\n\nexport const DepartmentContentActions = {\n\tupdateEmployees: (departmentId: number, employees: Array): void => {\n\t\tconst { departments } = useChartStore();\n\t\tconst department = departments.get(departmentId);\n\n\t\tif (!department)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tdepartments.set(departmentId, { ...department, employees });\n\t},\n\tupdateHeads: (departmentId: number, heads: Array): void => {\n\t\tconst { departments } = useChartStore();\n\t\tconst department = departments.get(departmentId);\n\n\t\tif (!department)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tdepartments.set(departmentId, { ...department, heads });\n\t},\n\tupdateEmployeeListOptions: (\n\t\tdepartmentId: number,\n\t\toptions: { page?: number, shouldUpdateList?: boolean, isListUpdated?: boolean },\n\t): void => {\n\t\tconst { departments } = useChartStore();\n\t\tconst department = departments.get(departmentId);\n\n\t\tif (!department)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tdepartment.employeeListOptions = {\n\t\t\t...department.employeeListOptions,\n\t\t\t...options,\n\t\t};\n\n\t\tdepartments.set(departmentId, department);\n\t},\n\tsetChatsAndChannels: (\n\t\tnodeId: number,\n\t\tchats: Array<CommunicationDetailed>,\n\t\tchannels: Array<CommunicationDetailed>,\n\t\tcollabs: Array<CommunicationDetailed>,\n\t\tchatsNoAccess: number = 0,\n\t\tchannelsNoAccess: number = 0,\n\t\tcollabsNoAccess: number = 0,\n\t): void => {\n\t\tconst store = useChartStore();\n\t\tconst department = store.departments.get(nodeId);\n\t\tif (!department)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tdepartment.channelsDetailed = channels;\n\t\tdepartment.chatsDetailed = chats;\n\t\tdepartment.collabsDetailed = collabs;\n\t\tdepartment.channelsNoAccess = channelsNoAccess;\n\t\tdepartment.chatsNoAccess = chatsNoAccess;\n\t\tdepartment.collabsNoAccess = collabsNoAccess;\n\t\tdepartment.communicationsCount = chats.length + channels.length + collabs.length\n\t\t\t+ chatsNoAccess + channelsNoAccess + collabsNoAccess\n\t\t;\n\t},\n\tunbindChatFromNode: (nodeId: number, chatId: number, type: string): void => {\n\t\tconst store = useChartStore();\n\t\tconst department = store.departments.get(nodeId);\n\t\tif (!department)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (type === ChatTypes.collab)\n\t\t{\n\t\t\tdepartment.collabsDetailed = department.collabsDetailed.filter((chat) => chat.id !== chatId);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tdepartment.channelsDetailed = department.channelsDetailed.filter((chat) => chat.id !== chatId);\n\t\t\tdepartment.chatsDetailed = department.chatsDetailed.filter((chat) => chat.id !== chatId);\n\t\t}\n\t\tdepartment.communicationsCount--;\n\t},\n};\n","import { EntityTypes } from 'humanresources.company-structure.utils';\nimport { Dom, Event, Text } from 'main.core';\nimport { UI } from 'ui.notification';\nimport { EventEmitter } from 'main.core.events';\nimport { mapState, mapWritableState } from 'ui.vue3.pinia';\nimport { useChartStore } from 'humanresources.company-structure.chart-store';\nimport { getMemberRoles, MemberRolesType, AnalyticsSourceType } from 'humanresources.company-structure.api';\nimport { UserManagementDialogAPI } from 'humanresources.company-structure.user-management-dialog';\nimport { PermissionActions, PermissionChecker } from 'humanresources.company-structure.permission-checker';\nimport { UsersTabActionMenu, events } from 'humanresources.company-structure.org-chart';\nimport { MoveEmployeeConfirmationPopup } from 'humanresources.company-structure.structure-components';\nimport { HeadListDataTestIds, EmployeeListDataTestIds } from './consts';\nimport { EmptyTabAddButton } from './empty-tab-add-button';\nimport { UserListItem } from './item/item';\nimport { EmptyState } from '../base-components/empty-state/empty-state';\nimport { TabList } from '../base-components/list/list';\nimport { SearchInput } from '../base-components/search/search-input';\nimport { DepartmentAPI } from '../../api';\nimport { DepartmentContentActions } from '../../actions';\n\nimport type { TabListDataTestIds } from '../base-components/list/types';\n\nimport 'ui.buttons';\nimport './styles/tab.css';\n\ntype DepartmentUsersStatus = {\n\tdepartmentId: number;\n\tloaded: boolean;\n};\n\nconst AUTOSCROLL_AREA_SIZE = 70;\n\n// @vue/component\nexport const UsersTab = {\n\tname: 'usersTab',\n\n\tcomponents: {\n\t\tSearchInput,\n\t\tEmptyState,\n\t\tTabList,\n\t\tEmptyTabAddButton,\n\t\tUserListItem,\n\t\tMoveEmployeeConfirmationPopup,\n\t},\n\n\temits: ['showDetailLoader', 'hideDetailLoader'],\n\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tsearchQuery: '',\n\t\t\tselectedUserId: null,\n\t\t\tneedToScroll: false,\n\t\t\tdragState: this.getInitialDragState(),\n\t\t\tshowDndConfirmationPopup: false,\n\t\t\tdndPreviousState: null,\n\t\t\tdndPopupDescription: '',\n\t\t\tboundHandleDragMove: null,\n\t\t\tboundHandleDragEnd: null,\n\t\t};\n\t},\n\n\tcomputed: {\n\t\tmemberRoles(): MemberRolesType\n\t\t{\n\t\t\treturn getMemberRoles(this.entityType);\n\t\t},\n\t\theads(): Array\n\t\t{\n\t\t\treturn this.departments.get(this.focusedNode).heads ?? [];\n\t\t},\n\t\theadCount(): number\n\t\t{\n\t\t\treturn this.heads.length ?? 0;\n\t\t},\n\t\tdepartmentId(): number\n\t\t{\n\t\t\treturn this.focusedNode;\n\t\t},\n\t\tformattedHeads(): Array\n\t\t{\n\t\t\treturn this.heads.map((head) => ({\n\t\t\t\t...head,\n\t\t\t\tsubtitle: head.workPosition,\n\t\t\t\tbadgeText: this.getBadgeText(head.role),\n\t\t\t})).sort((a, b) => {\n\t\t\t\tconst roleOrder = {\n\t\t\t\t\t[this.memberRoles.head]: 1,\n\t\t\t\t\t[this.memberRoles.deputyHead]: 2,\n\t\t\t\t};\n\n\t\t\t\tconst roleA = roleOrder[a.role] || 3;\n\t\t\t\tconst roleB = roleOrder[b.role] || 3;\n\n\t\t\t\treturn roleA - roleB;\n\t\t\t});\n\t\t},\n\t\tfilteredHeads(): Array\n\t\t{\n\t\t\treturn this.formattedHeads.filter(\n\t\t\t\t(head) => head.name.toLowerCase().includes(this.searchQuery.toLowerCase())\n\t\t\t\t\t|| head.workPosition?.toLowerCase().includes(this.searchQuery.toLowerCase()),\n\t\t\t);\n\t\t},\n\t\temployeeCount(): number\n\t\t{\n\t\t\tconst memberCount = this.departments.get(this.focusedNode).userCount ?? 0;\n\n\t\t\treturn memberCount - (this.headCount ?? 0);\n\t\t},\n\t\tformattedEmployees(): Array\n\t\t{\n\t\t\treturn this.employees.map((employee) => ({\n\t\t\t\t...employee,\n\t\t\t\tsubtitle: employee.workPosition,\n\t\t\t})).reverse();\n\t\t},\n\t\tfilteredEmployees(): Array\n\t\t{\n\t\t\treturn this.formattedEmployees.filter(\n\t\t\t\t(employee) => employee.name.toLowerCase().includes(this.searchQuery.toLowerCase())\n\t\t\t\t\t|| employee.workPosition?.toLowerCase().includes(this.searchQuery.toLowerCase()),\n\t\t\t);\n\t\t},\n\t\tmemberCount(): number\n\t\t{\n\t\t\treturn this.departments.get(this.focusedNode).userCount ?? 0;\n\t\t},\n\t\t...mapState(useChartStore, ['focusedNode', 'departments', 'searchedUserId']),\n\t\t...mapWritableState(useChartStore, ['searchedUserId']),\n\t\temployees(): Array\n\t\t{\n\t\t\treturn this.departments.get(this.focusedNode)?.employees ?? [];\n\t\t},\n\t\tshowSearchBar(): boolean\n\t\t{\n\t\t\treturn this.memberCount > 0;\n\t\t},\n\t\tshowSearchEmptyState(): boolean\n\t\t{\n\t\t\treturn this.filteredHeads.length === 0 && this.filteredEmployees.length === 0;\n\t\t},\n\t\tcanAddUsers(): boolean\n\t\t{\n\t\t\tconst permissionChecker = PermissionChecker.getInstance();\n\t\t\tif (!permissionChecker)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tconst nodeId = this.focusedNode;\n\t\t\tconst permission = this.isTeamEntity\n\t\t\t\t? PermissionActions.teamAddMember\n\t\t\t\t: PermissionActions.employeeAddToDepartment\n\t\t\t;\n\n\t\t\treturn permissionChecker.hasPermission(permission, nodeId);\n\t\t},\n\t\theadListEmptyStateTitle(): string\n\t\t{\n\t\t\tif (this.canAddUsers)\n\t\t\t{\n\t\t\t\treturn this.isTeamEntity\n\t\t\t\t\t? this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_USERS_TEAM_HEAD_EMPTY_LIST_ITEM_TITLE')\n\t\t\t\t\t: this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_USERS_HEAD_EMPTY_LIST_ITEM_TITLE');\n\t\t\t}\n\n\t\t\treturn this.isTeamEntity\n\t\t\t\t? this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_USERS_TEAM_HEAD_EMPTY_LIST_ITEM_TITLE_WITHOUT_ADD_PERMISSION')\n\t\t\t\t: this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_USERS_HEAD_EMPTY_LIST_ITEM_TITLE_WITHOUT_ADD_PERMISSION');\n\t\t},\n\t\temployeesListEmptyStateTitle(): string\n\t\t{\n\t\t\tif (this.canAddUsers)\n\t\t\t{\n\t\t\t\treturn this.isTeamEntity\n\t\t\t\t\t? this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_USERS_TEAM_EMPLOYEE_EMPTY_LIST_ITEM_TITLE')\n\t\t\t\t\t: this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_USERS_EMPLOYEE_EMPTY_LIST_ITEM_TITLE');\n\t\t\t}\n\n\t\t\treturn this.isTeamEntity\n\t\t\t\t? this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_USERS_TEAM_EMPLOYEE_EMPTY_LIST_ITEM_TITLE_WITHOUT_ADD_PERMISSION')\n\t\t\t\t: this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_USERS_EMPLOYEE_EMPTY_LIST_ITEM_TITLE_WITHOUT_ADD_PERMISSION');\n\t\t},\n\t\tshouldUpdateList(): boolean\n\t\t{\n\t\t\treturn this.departments.get(this.focusedNode).employeeListOptions?.shouldUpdateList ?? true;\n\t\t},\n\t\tdepartmentUsersStatus(): DepartmentUsersStatus\n\t\t{\n\t\t\tconst department = this.departments.get(this.focusedNode);\n\t\t\tif (department?.heads && department.employees)\n\t\t\t{\n\t\t\t\treturn { departmentId: this.focusedNode, loaded: true };\n\t\t\t}\n\n\t\t\treturn { departmentId: this.focusedNode, loaded: false };\n\t\t},\n\t\theadMenu(): UsersTabActionMenu\n\t\t{\n\t\t\treturn new UsersTabActionMenu(\n\t\t\t\tthis.focusedNode,\n\t\t\t\tAnalyticsSourceType.DETAIL,\n\t\t\t\t'head',\n\t\t\t\tthis.entityType,\n\t\t\t);\n\t\t},\n\t\temployeeMenu(): UsersTabActionMenu\n\t\t{\n\t\t\treturn new UsersTabActionMenu(\n\t\t\t\tthis.focusedNode,\n\t\t\t\tAnalyticsSourceType.DETAIL,\n\t\t\t\t'employee',\n\t\t\t\tthis.entityType,\n\t\t\t);\n\t\t},\n\t\tisEmployeeListOptionsSet(): boolean\n\t\t{\n\t\t\tconst department = this.departments.get(this.focusedNode) || {};\n\n\t\t\treturn department.employeeListOptions && Object.keys(department.employeeListOptions).length > 0;\n\t\t},\n\t\temployeeTitle(): string\n\t\t{\n\t\t\treturn this.isTeamEntity\n\t\t\t\t? this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_USERS_TEAM_EMPLOYEE_LIST_TITLE')\n\t\t\t\t: this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_USERS_EMPLOYEE_LIST_TITLE');\n\t\t},\n\t\tentityType(): string\n\t\t{\n\t\t\treturn this.departments.get(this.focusedNode)?.entityType;\n\t\t},\n\t\tisTeamEntity(): boolean\n\t\t{\n\t\t\treturn this.entityType === EntityTypes.team;\n\t\t},\n\t\temptyStateTitle(): string\n\t\t{\n\t\t\treturn this.isTeamEntity\n\t\t\t\t? this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_EMPTY_EMPLOYEES_TEAM_ADD_USER_TITLE')\n\t\t\t\t: this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_EMPTY_EMPLOYEES_ADD_USER_TITLE');\n\t\t},\n\t\temptyStateDescription(): string\n\t\t{\n\t\t\tif (this.canAddUsers)\n\t\t\t{\n\t\t\t\treturn this.isTeamEntity\n\t\t\t\t\t? this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_EMPTY_EMPLOYEES_TEAM_ADD_USER_SUBTITLE')\n\t\t\t\t\t: this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_EMPTY_EMPLOYEES_ADD_USER_SUBTITLE');\n\t\t\t}\n\n\t\t\t// text is in progress\n\t\t\treturn this.isTeamEntity\n\t\t\t\t? ''\n\t\t\t\t: this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_EMPTY_EMPLOYEES_ADD_USER_SUBTITLE');\n\t\t},\n\t\tisHeadListPotentialTarget(): boolean\n\t\t{\n\t\t\treturn this.dragState.isDragging\n\t\t\t\t&& this.dragState.initialList === 'employees'\n\t\t\t;\n\t\t},\n\t\tisEmployeeListPotentialTarget(): boolean\n\t\t{\n\t\t\treturn this.dragState.isDragging\n\t\t\t\t&& (this.dragState.initialList === 'head' || this.dragState.initialList === 'deputyHead')\n\t\t\t;\n\t\t},\n\t\tdndConfirmationPopupTitle(): ?string\n\t\t{\n\t\t\tconst toHead = this.dragState.targetList === 'head';\n\n\t\t\treturn toHead\n\t\t\t\t? undefined\n\t\t\t\t: this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_DND_POPUP_CONFIRM_TITLE');\n\t\t},\n\t\tdndConfirmationPopupBtn(): string\n\t\t{\n\t\t\tconst toHead = this.dragState.targetList === 'head';\n\n\t\t\treturn toHead\n\t\t\t\t? this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_DND_POPUP_CONFIRM_BTN_TO_HEAD')\n\t\t\t\t: this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_DND_POPUP_CONFIRM_BTN');\n\t\t},\n\t\tshowDndRoleSelect(): boolean\n\t\t{\n\t\t\treturn this.dragState.targetList === 'head';\n\t\t},\n\t\theadListTitle(): string\n\t\t{\n\t\t\treturn this.isTeamEntity\n\t\t\t\t? this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_USERS_TEAM_HEAD_LIST_TITLE')\n\t\t\t\t: this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_USERS_HEAD_LIST_TITLE')\n\t\t\t;\n\t\t},\n\t},\n\n\twatch: {\n\t\tfocusedNode(newId: number): void\n\t\t{\n\t\t\tconst department = this.departments.get(newId) || {};\n\t\t\tif (!this.isEmployeeListOptionsSet)\n\t\t\t{\n\t\t\t\tconst employeeListOptions = {\n\t\t\t\t\tpage: 0,\n\t\t\t\t\tshouldUpdateList: true,\n\t\t\t\t\tisListUpdated: false,\n\t\t\t\t};\n\t\t\t\tDepartmentContentActions.updateEmployeeListOptions(newId, employeeListOptions);\n\t\t\t\tthis.departments.set(newId, department);\n\t\t\t}\n\n\t\t\tif (\n\t\t\t\tdepartment.employeeListOptions.page === 0\n\t\t\t\t&& department.employeeListOptions.isListUpdated === false\n\t\t\t\t&& department.employeeListOptions.shouldUpdateList === true\n\t\t\t)\n\t\t\t{\n\t\t\t\tthis.loadEmployeesAction();\n\t\t\t}\n\n\t\t\tthis.isDescriptionExpanded = false;\n\t\t\tthis.searchQuery = '';\n\n\t\t\tif (this.searchedUserId)\n\t\t\t{\n\t\t\t\tthis.needToFocusUserId = this.searchedUserId;\n\t\t\t\tthis.$nextTick(() => {\n\t\t\t\t\tthis.scrollToUser();\n\t\t\t\t});\n\t\t\t}\n\t\t},\n\t\tsearchedUserId: {\n\t\t\thandler(userId: number): void\n\t\t\t{\n\t\t\t\tif (!userId)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tthis.needToFocusUserId = userId;\n\t\t\t\tif (this.isListUpdated)\n\t\t\t\t{\n\t\t\t\t\tthis.needToScroll = true;\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.$nextTick(() => {\n\t\t\t\t\t\tthis.scrollToUser();\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t},\n\t\t\timmediate: true,\n\t\t},\n\t\tasync searchQuery(newQuery: string): Promise<void>\n\t\t{\n\t\t\tawait this.searchMembers(newQuery);\n\t\t},\n\t\tdepartmentUsersStatus(usersStatus: DepartmentUsersStatus, prevUsersStatus: DepartmentUsersStatus): void\n\t\t{\n\t\t\tconst { departmentId, loaded } = usersStatus;\n\t\t\tconst { departmentId: prevDepartmentId, loaded: prevLoaded } = prevUsersStatus;\n\t\t\tif (departmentId === prevDepartmentId && loaded === prevLoaded)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (loaded)\n\t\t\t{\n\t\t\t\tthis.$emit('hideDetailLoader');\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.$emit('showDetailLoader');\n\t\t\t\tthis.loadEmployeesAction();\n\t\t\t}\n\t\t},\n\t},\n\n\tcreated(): void\n\t{\n\t\tthis.loadEmployeesAction();\n\t\tthis.clearSearchTimeout = null;\n\t\tthis.autoscrollIntervalId = null;\n\n\t\tthis.boundHandleDragMove = this.handleDragMove.bind(this);\n\t\tthis.boundHandleDragEnd = this.handleDragEnd.bind(this);\n\t},\n\n\tmounted(): void\n\t{\n\t\tthis.tabContainer = this.$refs['tab-container'];\n\t},\n\n\tmethods: {\n\t\tloc(phraseCode, replacements = {}): string\n\t\t{\n\t\t\treturn this.$Bitrix.Loc.getMessage(phraseCode, replacements);\n\t\t},\n\t\tgetBadgeText(role): ?string\n\t\t{\n\t\t\tif (role === this.memberRoles.head)\n\t\t\t{\n\t\t\t\treturn this.isTeamEntity\n\t\t\t\t\t? this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_EMPLOYEES_TEAM_HEAD_BADGE')\n\t\t\t\t\t: this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_EMPLOYEES_HEAD_BADGE')\n\t\t\t\t;\n\t\t\t}\n\n\t\t\tif (role === this.memberRoles.deputyHead)\n\t\t\t{\n\t\t\t\treturn this.isTeamEntity\n\t\t\t\t\t? this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_EMPLOYEES_TEAM_DEPUTY_HEAD_BADGE')\n\t\t\t\t\t: this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_EMPLOYEES_DEPUTY_HEAD_BADGE')\n\t\t\t\t;\n\t\t\t}\n\n\t\t\treturn null;\n\t\t},\n\t\tupdateList(event): void\n\t\t{\n\t\t\tconst employeesList = event.target;\n\t\t\tconst scrollPosition = employeesList.scrollTop + employeesList.clientHeight;\n\n\t\t\tif (employeesList.scrollHeight - scrollPosition < 40)\n\t\t\t{\n\t\t\t\tthis.loadEmployeesAction();\n\t\t\t}\n\t\t},\n\t\tasync loadEmployeesAction(): void\n\t\t{\n\t\t\tconst nodeId = this.focusedNode;\n\n\t\t\tif (!this.departments.get(nodeId))\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst employeeListOptions = this.departments.get(nodeId).employeeListOptions ?? {};\n\n\t\t\temployeeListOptions.page = employeeListOptions.page ?? 0;\n\t\t\temployeeListOptions.shouldUpdateList = employeeListOptions.shouldUpdateList ?? true;\n\t\t\temployeeListOptions.isListUpdated = employeeListOptions.isListUpdated ?? false;\n\t\t\tDepartmentContentActions.updateEmployeeListOptions(nodeId, employeeListOptions);\n\t\t\tif (employeeListOptions.isListUpdated || !employeeListOptions.shouldUpdateList)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (\n\t\t\t\t!employeeListOptions.isListUpdated\n\t\t\t\t&& employeeListOptions.page === 0\n\t\t\t\t&& employeeListOptions.shouldUpdateList === true\n\t\t\t)\n\t\t\t{\n\t\t\t\tthis.$emit('showDetailLoader');\n\t\t\t}\n\n\t\t\temployeeListOptions.isListUpdated = true;\n\t\t\temployeeListOptions.page += 1;\n\t\t\tDepartmentContentActions.updateEmployeeListOptions(nodeId, employeeListOptions);\n\n\t\t\tlet loadedEmployees = await DepartmentAPI.getPagedEmployees(nodeId, employeeListOptions.page, 25);\n\n\t\t\tif (!loadedEmployees)\n\t\t\t{\n\t\t\t\temployeeListOptions.shouldUpdateList = false;\n\t\t\t\temployeeListOptions.isListUpdated = false;\n\t\t\t\tDepartmentContentActions.updateEmployeeListOptions(nodeId, employeeListOptions);\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tloadedEmployees = loadedEmployees.map((user) => {\n\t\t\t\treturn { ...user, role: this.memberRoles.employee };\n\t\t\t});\n\n\t\t\tconst employees = this.departments.get(nodeId)?.employees ?? [];\n\t\t\tconst employeeIds = new Set(employees.map((employee) => employee.id));\n\n\t\t\tconst newEmployees = loadedEmployees.reverse().filter((employee) => !employeeIds.has(employee.id));\n\t\t\temployees.unshift(...newEmployees);\n\t\t\temployeeListOptions.shouldUpdateList = newEmployees.length === 25;\n\t\t\temployeeListOptions.isListUpdated = false;\n\n\t\t\tDepartmentContentActions.updateEmployeeListOptions(nodeId, employeeListOptions);\n\t\t\tDepartmentContentActions.updateEmployees(nodeId, employees);\n\t\t\tif (this.departmentUsersStatus.loaded)\n\t\t\t{\n\t\t\t\tthis.$emit('hideDetailLoader');\n\t\t\t}\n\n\t\t\tif (this.needToScroll)\n\t\t\t{\n\t\t\t\tthis.scrollToUser();\n\t\t\t}\n\t\t},\n\t\tasync scrollToUser(): void\n\t\t{\n\t\t\tconst userId = this.needToFocusUserId;\n\t\t\tthis.needToFocusUserId = null;\n\t\t\tthis.needToScroll = false;\n\t\t\tconst selectors = `.hr-department-detail-content__user-container[data-id=\"hr-department-detail-content__user-${userId}-item\"]`;\n\t\t\tlet element = this.tabContainer.querySelector(selectors);\n\n\t\t\tif (!element)\n\t\t\t{\n\t\t\t\tlet user = null;\n\t\t\t\ttry\n\t\t\t\t{\n\t\t\t\t\tuser = await DepartmentAPI.getUserInfo(this.focusedNode, userId);\n\t\t\t\t}\n\t\t\t\tcatch\n\t\t\t\t{ /* empty */ }\n\n\t\t\t\tconst department = this.departments.get(this.focusedNode);\n\t\t\t\tif (!user || !department)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (user.role === this.memberRoles.head || user.role === this.memberRoles.deputyHead)\n\t\t\t\t{\n\t\t\t\t\tdepartment.heads = department.heads ?? [];\n\t\t\t\t\tif (!department.heads.some((head) => head.id === user.id))\n\t\t\t\t\t{\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tdepartment.employees = department.employees ?? [];\n\t\t\t\t\tif (!department.employees.some((employee) => employee.id === user.id))\n\t\t\t\t\t{\n\t\t\t\t\t\tdepartment.employees.push(user);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// eslint-disable-next-line vue/valid-next-tick\n\t\t\t\tawait this.$nextTick(() => {\n\t\t\t\t\telement = this.tabContainer.querySelector(selectors);\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tif (!element)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\telement.scrollIntoView({ behavior: 'smooth', block: 'center' });\n\t\t\tsetTimeout(() => {\n\t\t\t\tthis.selectedUserId = userId;\n\t\t\t}, 750);\n\n\t\t\tif (this.clearSearchTimeout)\n\t\t\t{\n\t\t\t\tclearTimeout(this.clearSearchTimeout);\n\t\t\t}\n\n\t\t\tthis.clearSearchTimeout = setTimeout(() => {\n\t\t\t\tif (this.searchedUserId === userId)\n\t\t\t\t{\n\t\t\t\t\tthis.selectedUserId = null;\n\t\t\t\t\tthis.searchedUserId = null;\n\t\t\t\t}\n\t\t\t}, 4000);\n\t\t},\n\t\tasync searchMembers(query)\n\t\t{\n\t\t\tif (query.length === 0)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.findQueryResult = this.findQueryResult || {};\n\t\t\tthis.findQueryResult[this.focusedNode] = this.findQueryResult[this.focusedNode] || {\n\t\t\t\tsuccess: [],\n\t\t\t\tfailure: [],\n\t\t\t};\n\n\t\t\tconst nodeResults = this.findQueryResult[this.focusedNode];\n\n\t\t\tif (nodeResults.failure.some((failedQuery) => query.startsWith(failedQuery)))\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (nodeResults.success.includes(query) || nodeResults.failure.includes(query))\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst founded = await DepartmentAPI.findMemberByQuery(this.focusedNode, query);\n\n\t\t\tif (founded.length === 0)\n\t\t\t{\n\t\t\t\tnodeResults.failure.push(query);\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst department = this.departments.get(this.focusedNode);\n\t\t\tconst newMembers = founded.filter((found) => !department.heads.some((head) => head.id === found.id)\n\t\t\t\t&& !department.employees.some((employee) => employee.id === found.id));\n\n\t\t\tdepartment.employees.push(...newMembers);\n\t\t\tnodeResults.success.push(query);\n\t\t},\n\t\tsearchUser(searchQuery: string): void\n\t\t{\n\t\t\tthis.searchQuery = searchQuery;\n\t\t},\n\t\tonHeadListActionMenuItemClick(actionId: string): void\n\t\t{\n\t\t\tthis.headMenu.onActionMenuItemClick(actionId);\n\t\t},\n\t\tonEmployeeListActionMenuItemClick(actionId: string): void\n\t\t{\n\t\t\tthis.employeeMenu.onActionMenuItemClick(actionId);\n\t\t},\n\t\tgetHeadListDataTestIds(): TabListDataTestIds\n\t\t{\n\t\t\treturn HeadListDataTestIds;\n\t\t},\n\t\tgetEmployeeListDataTestIds(): TabListDataTestIds\n\t\t{\n\t\t\treturn EmployeeListDataTestIds;\n\t\t},\n\t\thandleItemDragStart(payload): void\n\t\t{\n\t\t\tif (this.dragState.isDragging)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst { event, element, userId, initialListType } = payload;\n\n\t\t\tevent.preventDefault();\n\t\t\tthis.dragState.isDragging = true;\n\t\t\tthis.dragState.userId = userId;\n\t\t\tthis.dragState.initialList = initialListType;\n\t\t\tthis.dragState.draggedElement = element;\n\n\t\t\tconst rect = this.dragState.draggedElement.getBoundingClientRect();\n\t\t\tthis.dragState.offsetX = event.clientX - rect.left;\n\t\t\tthis.dragState.offsetY = event.clientY - rect.top;\n\n\t\t\tconst ghost = this.dragState.draggedElement.cloneNode(true);\n\t\t\tDom.addClass(ghost, '--ghost');\n\t\t\tDom.style(ghost, 'left', `${event.clientX - this.dragState.offsetX}px`);\n\t\t\tDom.style(ghost, 'top', `${event.clientY - this.dragState.offsetY}px`);\n\n\t\t\tDom.append(ghost, document.body);\n\t\t\tthis.dragState.ghostElement = ghost;\n\n\t\t\tDom.addClass(this.dragState.draggedElement, '--dragging');\n\t\t\tDom.addClass(document.body, '--user-dragging');\n\n\t\t\tEvent.bind(document, 'mousemove', this.boundHandleDragMove);\n\t\t\tEvent.bind(document, 'mouseup', this.boundHandleDragEnd);\n\n\t\t\t// user to computed?\n\t\t\tconst user = this.formattedHeads.find((u) => u.id === userId)\n\t\t\t\t|| this.formattedEmployees.find((u) => u.id === userId);\n\t\t\tEventEmitter.emit(events.HR_USER_DRAG_START, { user });\n\t\t},\n\t\thandleDragMove(event: MouseEvent): void\n\t\t{\n\t\t\tif (!this.dragState.isDragging)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tDom.addClass(this.dragState.draggedElement, '--hidden');\n\n\t\t\tEventEmitter.emit(events.HR_USER_DRAG_MOVE, {\n\t\t\t\tpageX: event.pageX,\n\t\t\t\tpageY: event.pageY,\n\t\t\t});\n\n\t\t\tif (this.dragState.ghostElement)\n\t\t\t{\n\t\t\t\tDom.style(this.dragState.ghostElement, 'left', `${event.clientX - this.dragState.offsetX}px`);\n\t\t\t\tDom.style(this.dragState.ghostElement, 'top', `${event.clientY - this.dragState.offsetY}px`);\n\t\t\t}\n\n\t\t\tlet potentialTarget = null;\n\t\t\tif (this.isHeadListPotentialTarget && this.isPointerOverElement(event, this.$refs.headList?.$el))\n\t\t\t{\n\t\t\t\tpotentialTarget = 'head';\n\t\t\t}\n\t\t\telse if (this.isEmployeeListPotentialTarget && this.isPointerOverElement(event, this.$refs.employeeList?.$el))\n\t\t\t{\n\t\t\t\tpotentialTarget = 'employee';\n\t\t\t}\n\t\t\tthis.dragState.targetList = potentialTarget;\n\n\t\t\tthis.handleAutoscrollOnDrag(event);\n\t\t},\n\t\thandleAutoscrollOnDrag(event: MouseEvent): void\n\t\t{\n\t\t\tif (!this.isHeadListPotentialTarget)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst scrollableContainer = this.$refs.scrollableContainer;\n\t\t\tif (!scrollableContainer)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst rect = scrollableContainer.getBoundingClientRect();\n\t\t\tconst mouseY = event.clientY;\n\n\t\t\tconst topTriggerZone = rect.top + AUTOSCROLL_AREA_SIZE;\n\n\t\t\tif (mouseY < topTriggerZone)\n\t\t\t{\n\t\t\t\tif (this.autoscrollIntervalId !== null)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tconst scrollSpeed = 10;\n\t\t\t\tthis.autoscrollIntervalId = setInterval(() => {\n\t\t\t\t\tscrollableContainer.scrollTop -= scrollSpeed;\n\t\t\t\t}, 16);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.stopAutoscroll();\n\t\t\t}\n\t\t},\n\t\tstopAutoscroll(): void\n\t\t{\n\t\t\tif (this.autoscrollIntervalId !== null)\n\t\t\t{\n\t\t\t\tclearInterval(this.autoscrollIntervalId);\n\t\t\t\tthis.autoscrollIntervalId = null;\n\t\t\t}\n\t\t},\n\t\tisPointerOverElement(event: MouseEvent, element: HTMLElement): boolean\n\t\t{\n\t\t\tif (!element)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tconst rect = element.getBoundingClientRect();\n\n\t\t\treturn (\n\t\t\t\tevent.clientX >= rect.left && event.clientX <= rect.right\n\t\t\t\t&& event.clientY >= rect.top && event.clientY <= rect.bottom\n\t\t\t);\n\t\t},\n\t\tasync handleDragEnd(): void\n\t\t{\n\t\t\tif (!this.dragState.isDragging)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tEventEmitter.emit(events.HR_USER_DRAG_DROP);\n\t\t\tthis.stopAutoscroll();\n\n\t\t\tconst { userId, initialList, targetList, ghostElement, draggedElement } = this.dragState;\n\n\t\t\tconst isValidDrop = userId && targetList && targetList !== initialList;\n\t\t\tlet targetIndex = null;\n\t\t\tif (isValidDrop)\n\t\t\t{\n\t\t\t\tconst listRef = targetList === 'head' ? this.$refs.headList : this.$refs.employeeList;\n\t\t\t\ttargetIndex = listRef?.placeholderIndex;\n\t\t\t}\n\n\t\t\tEvent.unbind(document, 'mousemove', this.boundHandleDragMove);\n\t\t\tEvent.unbind(document, 'mouseup', this.boundHandleDragEnd);\n\t\t\tif (ghostElement)\n\t\t\t{\n\t\t\t\tDom.remove(ghostElement);\n\t\t\t}\n\n\t\t\tif (draggedElement)\n\t\t\t{\n\t\t\t\tDom.removeClass(draggedElement, '--dragging');\n\t\t\t\tDom.removeClass(draggedElement, '--hidden');\n\t\t\t}\n\t\t\tDom.removeClass(document.body, '--user-dragging');\n\n\t\t\tEventEmitter.emit(events.HR_USER_DRAG_END);\n\t\t\tif (!isValidDrop || targetIndex === null)\n\t\t\t{\n\t\t\t\tthis.dragState = this.getInitialDragState();\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.dragState.isDragging = false;\n\t\t\tthis.dragState.ghostElement = null;\n\t\t\tthis.dragState.draggedElement = null;\n\t\t\tthis.dragState.context = { targetIndex };\n\n\t\t\tthis.dndPreviousState = this.moveDndUser();\n\t\t\tif (!this.dndPreviousState)\n\t\t\t{\n\t\t\t\tthis.dragState = this.getInitialDragState();\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst { context } = this.dragState;\n\t\t\tcontext.selectedRole = null;\n\t\t\tcontext.selectedRoleLabel = '';\n\n\t\t\tif (targetList === 'head')\n\t\t\t{\n\t\t\t\tcontext.selectedRole = this.memberRoles.head;\n\t\t\t\tcontext.selectedRoleLabel = this.loc(\n\t\t\t\t\t'HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_EMPLOYEES_HEAD_BADGE',\n\t\t\t\t);\n\t\t\t}\n\n\t\t\tawait this.prepareDndPopupDescription();\n\t\t\tthis.showDndConfirmationPopup = true;\n\t\t},\n\t\tcancelDndUserMove(): void\n\t\t{\n\t\t\tconst { heads, employees } = this.dndPreviousState;\n\t\t\tDepartmentContentActions.updateHeads(this.focusedNode, heads);\n\t\t\tDepartmentContentActions.updateEmployees(this.focusedNode, employees);\n\n\t\t\tthis.dndPreviousState = null;\n\t\t\tthis.dragState = this.getInitialDragState();\n\t\t\tthis.showDndConfirmationPopup = false;\n\t\t},\n\t\tasync confirmDndUserMove(payload): Promise<void>\n\t\t{\n\t\t\tconst { userId } = this.dragState;\n\t\t\tconst targetRole = payload.role || this.memberRoles.employee;\n\n\t\t\tconst department = this.departments.get(this.focusedNode);\n\t\t\tconst user = department.heads.find((u) => u.id === userId) || department.employees.find((u) => u.id === userId);\n\n\t\t\tif (!user)\n\t\t\t{\n\t\t\t\tthis.dragState = this.getInitialDragState();\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst previousRole = user.role;\n\t\t\tuser.role = targetRole;\n\n\t\t\ttry\n\t\t\t{\n\t\t\t\tawait UserManagementDialogAPI.addUsersToDepartment(this.focusedNode, [userId], targetRole);\n\n\t\t\t\tUI.Notification.Center.notify({\n\t\t\t\t\tcontent: this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_DND_SUCCEED'),\n\t\t\t\t\tautoHideDelay: 3000,\n\t\t\t\t});\n\t\t\t}\n\t\t\tcatch (error)\n\t\t\t{\n\t\t\t\tconsole.error(error);\n\t\t\t\tuser.role = previousRole;\n\t\t\t\tthis.cancelDndUserMove();\n\t\t\t}\n\n\t\t\tthis.showDndConfirmationPopup = false;\n\t\t\tthis.dragState = this.getInitialDragState();\n\t\t},\n\t\tasync prepareDndPopupDescription(): Promise<string>\n\t\t{\n\t\t\tconst { userId, targetList } = this.dragState;\n\n\t\t\tconst toHead = targetList === 'head';\n\t\t\tconst isTeam = this.isTeamEntity;\n\t\t\tconst department = this.departments.get(this.departmentId);\n\t\t\tconst departmentName = Text.encode(department?.name ?? '');\n\n\t\t\tlet user = null;\n\t\t\ttry\n\t\t\t{\n\t\t\t\tuser = await DepartmentAPI.getUserInfo(this.departmentId, userId);\n\t\t\t}\n\t\t\tcatch\n\t\t\t{ /* empty */ }\n\n\t\t\tconst userName = Text.encode(user?.name ?? '');\n\t\t\tconst userUrl = user?.url ?? '#';\n\t\t\tlet phraseCode = '';\n\n\t\t\tif (toHead)\n\t\t\t{\n\t\t\t\tphraseCode = isTeam\n\t\t\t\t\t? 'HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_DND_POPUP_CONFIRM_DESC_TEAM_HEAD'\n\t\t\t\t\t: 'HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_DND_POPUP_CONFIRM_DESC_HEAD';\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tconst basePhrase = isTeam\n\t\t\t\t\t? 'HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_DND_POPUP_CONFIRM_DESC_TEAM'\n\t\t\t\t\t: 'HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_DND_POPUP_CONFIRM_DESC';\n\n\t\t\t\tconst genderSuffix = user?.gender === 'F' ? '_F' : '_M';\n\t\t\t\tphraseCode = basePhrase + genderSuffix;\n\t\t\t}\n\n\t\t\tthis.dndPopupDescription = this.loc(phraseCode, {\n\t\t\t\t'#USER_NAME#': userName,\n\t\t\t\t'#DEPARTMENT_NAME#': departmentName,\n\t\t\t})\n\t\t\t\t.replace(\n\t\t\t\t\t'[link]',\n\t\t\t\t\t`<a class=\"hr-department-detail-content__move-user-department-user-link\" href=\"${userUrl}\">`,\n\t\t\t\t)\n\t\t\t\t.replace('[/link]', '</a>');\n\t\t},\n\t\tmoveDndUser(): Object | null\n\t\t{\n\t\t\tconst { userId, targetList, context } = this.dragState;\n\t\t\tconst { targetIndex } = context;\n\t\t\tconst department = this.departments.get(this.focusedNode);\n\t\t\tif (!department)\n\t\t\t{\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\tconst previousState = { heads: [...department.heads], employees: [...department.employees] };\n\t\t\tconst isMovingToHeads = targetList === 'head';\n\t\t\tconst sourceList = isMovingToHeads ? [...previousState.employees] : [...previousState.heads];\n\t\t\tconst targetListForMove = isMovingToHeads ? [...previousState.heads] : [...previousState.employees];\n\n\t\t\tconst userIndex = sourceList.findIndex((user) => user.id === userId);\n\t\t\tif (userIndex === -1)\n\t\t\t{\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\tconst [userToMove] = sourceList.splice(userIndex, 1);\n\t\t\ttargetListForMove.splice(targetIndex, 0, userToMove);\n\n\t\t\tif (isMovingToHeads)\n\t\t\t{\n\t\t\t\tDepartmentContentActions.updateHeads(this.focusedNode, targetListForMove);\n\t\t\t\tDepartmentContentActions.updateEmployees(this.focusedNode, sourceList);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tDepartmentContentActions.updateHeads(this.focusedNode, sourceList);\n\t\t\t\tDepartmentContentActions.updateEmployees(this.focusedNode, targetListForMove);\n\t\t\t}\n\n\t\t\treturn previousState;\n\t\t},\n\t\tgetInitialDragState(): Object\n\t\t{\n\t\t\treturn {\n\t\t\t\tisDragging: false,\n\t\t\t\tuserId: null,\n\t\t\t\tinitialList: null,\n\t\t\t\ttargetList: null,\n\t\t\t\tghostElement: null,\n\t\t\t\tdraggedElement: null,\n\t\t\t\toffsetX: 0,\n\t\t\t\toffsetY: 0,\n\t\t\t\tcontext: null,\n\t\t\t};\n\t\t},\n\t},\n\n\ttemplate: `\n\t\t<div class=\"hr-department-detail-content__tab-container --users\" ref=\"tab-container\">\n\t\t\t<template v-if=\"memberCount > 0\">\n\t\t\t\t<SearchInput\n\t\t\t\t\tv-if=\"showSearchBar\"\n\t\t\t\t\t:placeholder=\"loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_USERS_SEARCH_PLACEHOLDER')\"\n\t\t\t\t\t:value=\"searchQuery\"\n\t\t\t\t\t@inputChange=\"searchUser\"\n\t\t\t\t\tdataTestId=\"hr-department-detail-content_users-tab__users-search-input\"\n\t\t\t\t/>\n\t\t\t\t<div\n\t\t\t\t\tv-if=\"!showSearchEmptyState\"\n\t\t\t\t\tv-on=\"shouldUpdateList ? { scroll: updateList } : {}\"\n\t\t\t\t\tclass=\"hr-department-detail-content__lists-container\"\n\t\t\t\t\tref=\"scrollableContainer\"\n\t\t\t\t>\n\t\t\t\t\t<TabList\n\t\t\t\t\t\tref=\"headList\"\n\t\t\t\t\t\tid='hr-department-detail-content_chats-tab__chat-list'\n\t\t\t\t\t\t:title=\"headListTitle\"\n\t\t\t\t\t\t:count=\"headCount\"\n\t\t\t\t\t\t:menuItems=\"headMenu.items\"\n\t\t\t\t\t\t:listItems=\"filteredHeads\"\n\t\t\t\t\t\tlistType=\"head\"\n\t\t\t\t\t\t:emptyItemTitle=\"headListEmptyStateTitle\"\n\t\t\t\t\t\temptyItemImageClass=\"hr-department-detail-content__empty-user-list-item-image\"\n\t\t\t\t\t\t:hideEmptyItem=\"searchQuery.length > 0\"\n\t\t\t\t\t\t:withAddPermission=\"canAddUsers\"\n\t\t\t\t\t\t@tabListAction=\"onHeadListActionMenuItemClick\"\n\t\t\t\t\t\t:dataTestIds=\"getHeadListDataTestIds()\"\n\t\t\t\t\t\t:isDropTarget=\"isHeadListPotentialTarget && dragState.targetList === 'head'\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<template v-slot=\"{ item }\">\n\t\t\t\t\t\t\t<UserListItem\n\t\t\t\t\t\t\t\t:user=\"item\"\n\t\t\t\t\t\t\t\tlistType=\"head\"\n\t\t\t\t\t\t\t\t:selectedUserId=\"selectedUserId\"\n\t\t\t\t\t\t\t\t:entityType=\"entityType\"\n\t\t\t\t\t\t\t\t:canDrag=\"canAddUsers\"\n\t\t\t\t\t\t\t\t@itemDragStart=\"handleItemDragStart\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</template>\n\t\t\t\t\t</TabList>\n\t\t\t\t\t<TabList\n\t\t\t\t\t\tref=\"employeeList\"\n\t\t\t\t\t\tid='hr-department-detail-content_chats-tab__channel-list'\n\t\t\t\t\t\t:title=\"employeeTitle\"\n\t\t\t\t\t\t:count=\"employeeCount\"\n\t\t\t\t\t\tlistType=\"employees\"\n\t\t\t\t\t\t:menuItems=\"employeeMenu.items\"\n\t\t\t\t\t\t:listItems=\"filteredEmployees\"\n\t\t\t\t\t\t:emptyItemTitle=\"employeesListEmptyStateTitle\"\n\t\t\t\t\t\temptyItemImageClass=\"hr-department-detail-content__empty-user-list-item-image\"\n\t\t\t\t\t\t:hideEmptyItem=\"searchQuery.length > 0\"\n\t\t\t\t\t\t:withAddPermission=\"canAddUsers\"\n\t\t\t\t\t\t@tabListAction=\"onEmployeeListActionMenuItemClick\"\n\t\t\t\t\t\t:dataTestIds=\"getEmployeeListDataTestIds()\"\n\t\t\t\t\t\t:isDropTarget=\"isEmployeeListPotentialTarget && dragState.targetList === 'employee'\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<template v-slot=\"{ item }\">\n\t\t\t\t\t\t\t<UserListItem\n\t\t\t\t\t\t\t\t:user=\"item\"\n\t\t\t\t\t\t\t\tlistType=\"employees\"\n\t\t\t\t\t\t\t\t:canDrag=\"canAddUsers\"\n\t\t\t\t\t\t\t\t@itemDragStart=\"handleItemDragStart\"\n\t\t\t\t\t\t\t\t:selectedUserId=\"selectedUserId\"\n\t\t\t\t\t\t\t\t:entityType=\"entityType\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</template>\n\t\t\t\t\t</TabList>\n\t\t\t\t</div>\n\t\t\t\t<EmptyState v-else\n\t\t\t\t\timageClass=\"hr-department-detail-content__empty-tab-user-not-found-icon\"\n\t\t\t\t\t:title=\"loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_EMPTY_SEARCHED_EMPLOYEES_TITLE')\"\n\t\t\t\t\t:description =\"loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_EMPTY_SEARCHED_EMPLOYEES_SUBTITLE')\"\n\t\t\t\t/>\n\t\t\t</template>\n\t\t\t<EmptyState v-else\n\t\t\t\t:imageClass=\"canAddUsers \n\t\t\t\t\t? 'hr-department-detail-content__empty-tab-add-user-icon' \n\t\t\t\t\t: 'hr-department-detail-content__empty-tab-cant-add-user-icon'\"\n\t\t\t\t:title=\"emptyStateTitle\"\n\t\t\t\t:description =\"emptyStateDescription\"\n\t\t\t>\n\t\t\t\t<template v-slot:content>\n\t\t\t\t\t<EmptyTabAddButton v-if=\"canAddUsers\" :departmentId=\"departmentId\" :entityType=\"entityType\"/>\n\t\t\t\t</template>\n\t\t\t</EmptyState>\n\t\t\t<MoveEmployeeConfirmationPopup \n\t\t\t\tv-if=\"showDndConfirmationPopup\" \n\t\t\t\t:title=\"dndConfirmationPopupTitle\"\n\t\t\t\t:description=\"dndPopupDescription\"\n\t\t\t\t:confirmButtonText=\"dndConfirmationPopupBtn\"\n\t\t\t\t:showRoleSelect=\"showDndRoleSelect\"\n\t\t\t\t:excludeEmployeeRole=\"true\"\n\t\t\t\t:targetType=\"entityType\"\n\t\t\t\t@confirm=\"confirmDndUserMove\"\n\t\t\t\t@close=\"cancelDndUserMove\"\n\t\t\t/>\n\t\t</div>\n\t`,\n};\n","import type { ManagementDialogDataTestIds } from 'humanresources.company-structure.structure-components';\nimport { Main } from 'ui.icon-set.api.core';\nimport { Loc } from 'main.core';\n\nexport const ChatsMenuOption = Object.freeze({\n\tlinkChat: 'linkChat',\n\tlinkChannel: 'linkChannel',\n\tlinkCollab: 'linkCollab',\n});\n\nexport const ChatsMenuLinkChat = Object.freeze({\n\tid: ChatsMenuOption.linkChat,\n\ttitle: Loc.getMessage('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_CHATS_CHAT_LIST_LINK_BUTTON_TITLE'),\n\tdescription: Loc.getMessage('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_CHATS_CHAT_LIST_LINK_BUTTON_DESC'),\n\tbIcon: {\n\t\tname: Main.CHAT_MESSAGE,\n\t\tsize: 20,\n\t\tcolorTokenName: 'paletteBlue50',\n\t},\n\tdataTestId: 'hr-department-content_chats-tab__chat-list-action-link',\n});\n\nexport const ChatsMenuLinkChannel = Object.freeze({\n\tid: ChatsMenuOption.linkChannel,\n\ttitle: Loc.getMessage('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_CHATS_CHANNEL_LIST_LINK_BUTTON_TITLE'),\n\tdescription: Loc.getMessage('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_CHATS_CHANNEL_LIST_LINK_BUTTON_DESC'),\n\tbIcon: {\n\t\tname: Main.SPEAKER_MOUTHPIECE,\n\t\tsize: 20,\n\t\tcolorTokenName: 'paletteBlue50',\n\t},\n\tdataTestId: 'hr-department-content_chats-tab__channel-list-action-link',\n});\n\nexport const ChatsMenuLinkCollab = Object.freeze({\n\tid: ChatsMenuOption.linkCollab,\n\ttitle: Loc.getMessage('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_CHATS_COLLAB_LIST_LINK_BUTTON_TITLE'),\n\tdescription: Loc.getMessage('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_CHATS_COLLAB_LIST_LINK_BUTTON_DESC'),\n\tbIcon: {\n\t\tname: Main.COLLAB,\n\t\tsize: 20,\n\t\tcolorTokenName: 'paletteBlue50',\n\t},\n\tdataTestId: 'hr-department-content_chats-tab__collab-list-action-link',\n});\n\nexport const ChatListDataTestIds = Object.freeze({\n\tcontainerDataTestId: 'hr-department-content_chats-tab__chat-list-container',\n\tlistActionButtonDataTestId: 'hr-department-content_chats-tab__chat-list-action-button',\n\tlistActonMenuDataTestId: 'hr-department-content_chats-tab__chat-list-action-menu-container',\n\tlistCounterDataTestId: 'hr-department-content_chats-tab__chat-list-counter',\n});\n\nexport const ChannelListDataTestIds = Object.freeze({\n\tcontainerDataTestId: 'hr-department-content_chats-tab__channel-list-container',\n\tlistActionButtonDataTestId: 'hr-department-content_chats-tab__channel-list-action-button',\n\tlistActonMenuDataTestId: 'hr-department-content_chats-tab__channel-list-action-menu-container',\n\tlistCounterDataTestId: 'hr-department-content_chats-tab__channel-list-counter',\n});\n\nexport const CollabListDataTestIds = Object.freeze({\n\tcontainerDataTestId: 'hr-department-content_chats-tab__collab-list-container',\n\tlistActionButtonDataTestId: 'hr-department-content_chats-tab__collab-list-action-button',\n\tlistActonMenuDataTestId: 'hr-department-content_chats-tab__collab-list-action-menu-container',\n\tlistCounterDataTestId: 'hr-department-content_chats-tab__collab-list-counter',\n});\n\nexport const ChatLinkDialogDataTestIds: {\n\t...ManagementDialogDataTestIds,\n\taddWithChildrenDataTestId: string,\n} = Object.freeze({\n\tcontainerDataTestId: 'hr-department-content_chats-tab__link-chat-container',\n\tconfirmButtonDataTestId: 'hr-department-content_chats-tab__link-chat-confirm-button',\n\tcancelButtonDataTestId: 'hr-department-content_chats-tab__link-chat-cancel-button',\n\tcloseButtonDataTestId: 'hr-department-content_chats-tab__link-chat-close-button',\n\taddWithChildrenDataTestId: 'hr-department-content_chats-tab__link-chat-add-with-children',\n});\n\nexport const ChannelLinkDialogDataTestIds: {\n\t...ManagementDialogDataTestIds,\n\taddWithChildrenDataTestId: string,\n} = Object.freeze({\n\tcontainerDataTestId: 'hr-department-content_chats-tab__link-channel-container',\n\tconfirmButtonDataTestId: 'hr-department-content_chats-tab__link-channel-confirm-button',\n\tcancelButtonDataTestId: 'hr-department-content_chats-tab__link-channel-cancel-button',\n\tcloseButtonDataTestId: 'hr-department-content_chats-tab__link-channel-close-button',\n\taddWithChildrenDataTestId: 'hr-department-content_chats-tab__link-channel-add-with-children',\n});\n\nexport const CollabLinkDialogDataTestIds: {\n\t...ManagementDialogDataTestIds,\n\taddWithChildrenDataTestId: string,\n} = Object.freeze({\n\tcontainerDataTestId: 'hr-department-content_chats-tab__link-collab-container',\n\tconfirmButtonDataTestId: 'hr-department-content_chats-tab__link-collab-confirm-button',\n\tcancelButtonDataTestId: 'hr-department-content_chats-tab__link-collab-cancel-button',\n\tcloseButtonDataTestId: 'hr-department-content_chats-tab__link-collab-close-button',\n\taddWithChildrenDataTestId: 'hr-department-content_chats-tab__link-collab-add-with-children',\n});\n","import { useChartStore } from 'humanresources.company-structure.chart-store';\nimport { RouteActionMenu } from 'humanresources.company-structure.structure-components';\nimport { mapState } from 'ui.vue3.pinia';\nimport { ChatsMenuLinkChannel, ChatsMenuLinkChat, ChatsMenuLinkCollab } from './consts';\nimport 'ui.icon-set.main';\nimport './styles/empty-tab-add-buttons.css';\n\n// @vue/component\nexport const EmptyTabAddButtons = {\n\tname: 'emptyStateButtons',\n\n\tcomponents: { RouteActionMenu },\n\n\tprops: {\n\t\tcanEditChat: {\n\t\t\ttype: Boolean,\n\t\t\trequired: true,\n\t\t},\n\t\tcanEditChannel: {\n\t\t\ttype: Boolean,\n\t\t\trequired: true,\n\t\t},\n\t\tcanEditCollab: {\n\t\t\ttype: Boolean,\n\t\t\trequired: true,\n\t\t},\n\t\tisTeamEntity: {\n\t\t\ttype: Boolean,\n\t\t\trequired: true,\n\t\t},\n\t},\n\n\temits: ['emptyStateAddAction'],\n\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tmenuVisible: false,\n\t\t};\n\t},\n\n\tcomputed:\n\t{\n\t\tmenu(): Object[]\n\t\t{\n\t\t\tconst menu = [];\n\n\t\t\tif (this.canEditCollab)\n\t\t\t{\n\t\t\t\tmenu.push(ChatsMenuLinkCollab);\n\t\t\t}\n\n\t\t\tif (this.canEditChannel)\n\t\t\t{\n\t\t\t\tmenu.push(ChatsMenuLinkChannel);\n\t\t\t}\n\n\t\t\tif (this.canEditChat)\n\t\t\t{\n\t\t\t\tmenu.push(ChatsMenuLinkChat);\n\t\t\t}\n\n\t\t\treturn menu;\n\t\t},\n\t\t...mapState(useChartStore, ['focusedNode']),\n\t},\n\n\tmethods:\n\t{\n\t\tloc(phraseCode: string, replacements: { [p: string]: string } = {}): string\n\t\t{\n\t\t\treturn this.$Bitrix.Loc.getMessage(phraseCode, replacements);\n\t\t},\n\t\tonClick(): void\n\t\t{\n\t\t\tthis.menuVisible = true;\n\t\t},\n\t\tonActionMenuItemClick(actionId: string): void\n\t\t{\n\t\t\tthis.$emit('emptyStateAddAction', actionId);\n\t\t},\n\t},\n\n\ttemplate: `\n\t\t<div class=\"hr-department-detail-content__users-empty-tab-add_buttons-container\">\n\t\t\t<button\n\t\t\t\tclass=\"hr-add-communications-empty-tab-entity-btn ui-btn ui-btn ui-btn-sm ui-btn-primary ui-btn-round\"\n\t\t\t\tref=\"actionMenuButton\"\n\t\t\t\t@click.stop=\"onClick\"\n\t\t\t\tdata-id=\"hr-department-detail-content__user-empty-tab_add-user-button\"\n\t\t\t>\n\t\t\t\t<span class=\"hr-add-communications-empty-tab-entity-btn-text\">\n\t\t\t\t\t{{loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_CHATS_EMPTY_TAB_ADD_EMPTY_STATE_ADD_BUTTON')}}\n\t\t\t\t</span>\n\t\t\t</button>\n\t\t\t<RouteActionMenu\n\t\t\t\tv-if=\"menuVisible\"\n\t\t\t\t:id=\"'empty-state-department-detail-add-communications-menu-' + focusedNode\"\n\t\t\t\t:items=\"menu\"\n\t\t\t\t:delimiter=\"false\"\n\t\t\t\t:width=\"302\"\n\t\t\t\t:bindElement=\"$refs.actionMenuButton\"\n\t\t\t\t:containerDataTestId=\"'empty-state-department-detail-add-communications-menu'\"\n\t\t\t\t@action=\"onActionMenuItemClick\"\n\t\t\t\t@close=\"menuVisible = false\"\n\t\t\t/>\n\t\t</div>\n\t`,\n};\n","export type ActionButtonDictionaryItem = {\n\ttitle: string;\n\tdescription: string;\n\terror: string;\n\tsuccess: string;\n};\n\nexport const ActionButtonDictionary: Record<string, Record<string, ActionButtonDictionaryItem>> = Object.freeze({\n\tchat: {\n\t\tteam: {\n\t\t\ttitle: 'HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_CHATS_UNBIND_POPUP_CHAT_FROM_TEAM_TITLE',\n\t\t\tdescription: 'HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_CHATS_UNBIND_POPUP_CHAT_FROM_TEAM_DESCRIPTION',\n\t\t\terror: 'HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_CHATS_UNBIND_POPUP_CHAT_FROM_TEAM_ERROR',\n\t\t\tsuccess: 'HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_CHATS_UNBIND_POPUP_CHAT_FROM_TEAM_SUCCESS',\n\t\t},\n\t\tdepartment: {\n\t\t\ttitle: 'HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_CHATS_UNBIND_POPUP_CHAT_FROM_DEPARTMENT_TITLE',\n\t\t\tdescription: 'HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_CHATS_UNBIND_POPUP_CHAT_FROM_DEPARTMENT_DESCRIPTION',\n\t\t\terror: 'HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_CHATS_UNBIND_POPUP_CHAT_FROM_DEPARTMENT_ERROR',\n\t\t\tsuccess: 'HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_CHATS_UNBIND_POPUP_CHAT_FROM_DEPARTMENT_SUCCESS',\n\t\t},\n\t},\n\tchannel: {\n\t\tteam: {\n\t\t\ttitle: 'HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_CHATS_UNBIND_POPUP_CHANNEL_FROM_TEAM_TITLE',\n\t\t\tdescription: 'HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_CHATS_UNBIND_POPUP_CHANNEL_FROM_TEAM_DESCRIPTION',\n\t\t\terror: 'HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_CHATS_UNBIND_POPUP_CHANNEL_FROM_TEAM_ERROR',\n\t\t\tsuccess: 'HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_CHATS_UNBIND_POPUP_CHANNEL_FROM_TEAM_SUCCESS',\n\t\t},\n\t\tdepartment: {\n\t\t\ttitle: 'HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_CHATS_UNBIND_POPUP_CHANNEL_FROM_DEPARTMENT_TITLE',\n\t\t\tdescription: 'HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_CHATS_UNBIND_POPUP_CHANNEL_FROM_DEPARTMENT_DESCRIPTION',\n\t\t\terror: 'HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_CHATS_UNBIND_POPUP_CHANNEL_FROM_DEPARTMENT_ERROR',\n\t\t\tsuccess: 'HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_CHATS_UNBIND_POPUP_CHANNEL_FROM_DEPARTMENT_SUCCESS',\n\t\t},\n\t},\n\tcollab: {\n\t\tteam: {\n\t\t\ttitle: 'HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_CHATS_UNBIND_POPUP_COLLAB_FROM_TEAM_TITLE',\n\t\t\tdescription: 'HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_CHATS_UNBIND_POPUP_COLLAB_FROM_TEAM_DESCRIPTION',\n\t\t\terror: 'HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_CHATS_UNBIND_POPUP_COLLAB_FROM_TEAM_ERROR',\n\t\t\tsuccess: 'HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_CHATS_UNBIND_POPUP_COLLAB_FROM_TEAM_SUCCESS',\n\t\t},\n\t\tdepartment: {\n\t\t\ttitle: 'HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_CHATS_UNBIND_POPUP_COLLAB_FROM_DEPARTMENT_TITLE',\n\t\t\tdescription: 'HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_CHATS_UNBIND_POPUP_COLLAB_FROM_DEPARTMENT_DESCRIPTION',\n\t\t\terror: 'HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_CHATS_UNBIND_POPUP_COLLAB_FROM_DEPARTMENT_ERROR',\n\t\t\tsuccess: 'HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_CHATS_UNBIND_POPUP_COLLAB_FROM_DEPARTMENT_SUCCESS',\n\t\t},\n\t},\n});\n","import { useChartStore } from 'humanresources.company-structure.chart-store';\nimport { ChatListActionMenu, MenuActions } from 'humanresources.company-structure.org-chart';\nimport { ConfirmationPopup, RouteActionMenu } from 'humanresources.company-structure.structure-components';\nimport { ChatTypes, EntityTypes } from 'humanresources.company-structure.utils';\nimport { UI } from 'ui.notification';\nimport { mapState } from 'ui.vue3.pinia';\nimport { DepartmentContentActions } from '../../actions';\nimport { DepartmentAPI } from '../../api';\nimport { Messenger } from 'im.public.iframe';\nimport { ActionButtonDictionary, ActionButtonDictionaryItem } from './dictionaries/action-button-dictionary';\n\ntype DataType = {\n\tisMenuVisible: boolean,\n\tshowUnbindConfirmationPopup: boolean,\n\tunbindLoader: boolean,\n\tdictionary: ActionButtonDictionaryItem | {},\n};\n\n// @vue/component\nexport const CommunicationListItemActionButton = {\n\tname: 'communicationListItemActionButton',\n\n\tcomponents: {\n\t\tRouteActionMenu,\n\t\tConfirmationPopup,\n\t},\n\n\tprops: {\n\t\t/** @type CommunicationDetailed */\n\t\tcommunication: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t\tnodeId: {\n\t\t\ttype: Number,\n\t\t\trequired: true,\n\t\t},\n\t},\n\n\tdata(): DataType\n\t{\n\t\treturn {\n\t\t\tisMenuVisible: false,\n\t\t\tshowUnbindConfirmationPopup: false,\n\t\t\tunbindLoader: false,\n\t\t\tdictionary: {},\n\t\t};\n\t},\n\n\tcomputed:\n\t{\n\t\tentityType(): boolean\n\t\t{\n\t\t\treturn this.departments.get(this.nodeId)?.entityType;\n\t\t},\n\t\tisTeamEntity(): boolean\n\t\t{\n\t\t\treturn this.departments.get(this.nodeId)?.entityType === EntityTypes.team;\n\t\t},\n\t\tmenu(): ChatListActionMenu\n\t\t{\n\t\t\tconst entityType = this.departments.get(this.nodeId)?.entityType;\n\n\t\t\treturn new ChatListActionMenu(entityType, this.communication, this.nodeId);\n\t\t},\n\t\tbuttonDataId(): string\n\t\t{\n\t\t\tconst type = this.communication.type.toLowerCase();\n\n\t\t\treturn `hr-department-detail-content__${type}-list_chat-${this.communication.id}-action-btn`;\n\t\t},\n\t\t...mapState(useChartStore, ['departments']),\n\t},\n\n\tcreated(): void\n\t{\n\t\tthis.dictionary = (ActionButtonDictionary[this.communication.type.toLowerCase()]\n\t\t\t\t&& ActionButtonDictionary[this.communication.type.toLowerCase()][this.entityType.toLowerCase()])\n\t\t\t|| {}\n\t\t;\n\t},\n\n\tmethods:\n\t{\n\t\tloc(phraseCode: string, replacements: { [p: string]: string } = {}): string\n\t\t{\n\t\t\treturn this.$Bitrix.Loc.getMessage(phraseCode, replacements);\n\t\t},\n\t\ttoggleMenu(): void\n\t\t{\n\t\t\tthis.isMenuVisible = !this.isMenuVisible;\n\t\t},\n\t\tonActionMenuItemClick(actionId: string): void\n\t\t{\n\t\t\tif (actionId === MenuActions.openChat)\n\t\t\t{\n\t\t\t\tMessenger.openChat(this.communication.dialogId);\n\t\t\t}\n\t\t\telse if (actionId === MenuActions.unbindChat)\n\t\t\t{\n\t\t\t\tthis.showUnbindConfirmationPopup = true;\n\t\t\t}\n\t\t},\n\t\tcancelUnbind(): void\n\t\t{\n\t\t\tthis.showUnbindConfirmationPopup = false;\n\t\t},\n\t\tasync unbind(): Promise<void>\n\t\t{\n\t\t\tthis.unbindLoader = true;\n\n\t\t\ttry\n\t\t\t{\n\t\t\t\tswitch (this.communication.type)\n\t\t\t\t{\n\t\t\t\t\tcase ChatTypes.chat:\n\t\t\t\t\t\tawait DepartmentAPI.saveChats(this.nodeId, [], [this.communication.id]);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase ChatTypes.channel:\n\t\t\t\t\t\tawait DepartmentAPI.saveChannel(this.nodeId, [], [this.communication.id]);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase ChatTypes.collab:\n\t\t\t\t\t\tawait DepartmentAPI.saveCollab(this.nodeId, [], [this.communication.id]);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tcatch (error)\n\t\t\t{\n\t\t\t\tif (error.code !== 'STRUCTURE_ACCESS_DENIED')\n\t\t\t\t{\n\t\t\t\t\tUI.Notification.Center.notify({\n\t\t\t\t\t\tcontent: this.loc(this.dictionary.error),\n\t\t\t\t\t\tautoHideDelay: 2000,\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tfinally\n\t\t\t{\n\t\t\t\tthis.unbindLoader = false;\n\t\t\t\tthis.showUnbindConfirmationPopup = false;\n\t\t\t}\n\n\t\t\tDepartmentContentActions.unbindChatFromNode(this.nodeId, this.communication.id, this.communication.type);\n\n\t\t\tconst isOwn = !this.communication.originalNodeId || this.communication.originalNodeId === this.nodeId;\n\n\t\t\tif (isOwn)\n\t\t\t{\n\t\t\t\tconst store = useChartStore();\n\t\t\t\tstore.updateChatsInChildrenNodes(this.nodeId);\n\t\t\t}\n\n\t\t\tUI.Notification.Center.notify({\n\t\t\t\tcontent: this.loc(this.dictionary.success),\n\t\t\t\tautoHideDelay: 2000,\n\t\t\t});\n\t\t},\n\t},\n\n\ttemplate: `\n\t\t<button\n\t\t\tv-if=\"menu.items.length\"\n\t\t\tclass=\"ui-icon-set --more hr-department-detail-content__tab-list_item-action-btn --chat-item-action-btn ui-icon-set\"\n\t\t\t:class=\"{ '--focused': isMenuVisible }\"\n\t\t\t@click.stop=\"toggleMenu()\"\n\t\t\tref=\"actionCommunicationButton\"\n\t\t\t:data-id=\"buttonDataId\"\n\t\t/>\n\t\t<RouteActionMenu\n\t\t\tv-if=\"isMenuVisible\"\n\t\t\t:id=\"'tree-node-department-menu-chat_' + this.nodeId + '_' + communication.id\"\n\t\t\t:items=\"menu.items\"\n\t\t\t:width=\"302\"\n\t\t\t:bindElement=\"$refs.actionCommunicationButton\"\n\t\t\t@action=\"onActionMenuItemClick\"\n\t\t\t@close=\"isMenuVisible = false\"\n\t\t/>\n\t\t<ConfirmationPopup\n\t\t\tref=\"unbindConfirmationPopup\"\n\t\t\tv-if=\"showUnbindConfirmationPopup\"\n\t\t\t:showActionButtonLoader=\"unbindLoader\"\n\t\t\t:title=\"loc(dictionary.title)\"\n\t\t\t:confirmBtnText=\"loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_CHATS_UNBIND_POPUP_CONFIRM_BUTTON')\"\n\t\t\tconfirmButtonClass=\"ui-btn-danger\"\n\t\t\t@action=\"unbind\"\n\t\t\t@close=\"cancelUnbind\"\n\t\t\t:width=\"364\"\n\t\t>\n\t\t\t<template v-slot:content>\n\t\t\t\t<div class=\"hr-department-detail-content__user-action-text-container\">\n\t\t\t\t\t<div\n\t\t\t\t\t\tv-html=\"loc(dictionary.description)\"\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t</template>\n\t\t</ConfirmationPopup>\n\t`,\n};\n","import { ChatTypes } from 'humanresources.company-structure.utils';\nimport { AvatarRound, AvatarSquare, AvatarHexagonGuest, AvatarBase } from 'ui.avatar';\n\nexport const ItemDictionary: Record<string, ItemDictionaryType> = Object.freeze({\n\t[ChatTypes.chat]: {\n\t\tparentTeamHint: 'HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_CHATS_PARENT_TEAM_CHAT_HINT',\n\t\tsubtitleForTeam: 'HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_CHATS_CHAT_OF_TEAM_MSGVER_2',\n\t\tparentDepartmentOfDepartmentHint: 'HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_CHATS_PARENT_DEPARTMENT_CHAT_OF_DEPARTMENT_HINT',\n\t\tparentDepartmentOfTeamHint: 'HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_CHATS_PARENT_DEPARTMENT_CHAT_OF_TEAM_HINT',\n\t\tsubtitleForDepartment: 'HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_CHATS_CHAT_OF_DEPARTMENT_MSGVER_2',\n\t\tgetAvatar: (avatarOptions: Object): AvatarBase => new AvatarRound(avatarOptions),\n\t\tdataTestIdPrefix: 'hr-department-content_chats-tab__list_chat-item-',\n\t},\n\t[ChatTypes.channel]: {\n\t\tparentTeamHint: 'HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_CHATS_PARENT_TEAM_CHANNEL_HINT',\n\t\tsubtitleForTeam: 'HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_CHATS_CHANNEL_OF_TEAM_MSGVER_2',\n\t\tparentDepartmentOfDepartmentHint: 'HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_CHATS_PARENT_DEPARTMENT_CHANNEL_OF_DEPARTMENT_HINT',\n\t\tparentDepartmentOfTeamHint: 'HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_CHATS_PARENT_DEPARTMENT_CHANNEL_OF_TEAM_HINT',\n\t\tsubtitleForDepartment: 'HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_CHATS_CHANNEL_OF_DEPARTMENT_MSGVER_2',\n\t\tgetAvatar: (avatarOptions: Object): AvatarBase => new AvatarSquare(avatarOptions),\n\t\tdataTestIdPrefix: 'hr-department-content_chats-tab__list_chat-item-',\n\t},\n\t[ChatTypes.collab]: {\n\t\tparentTeamHint: 'HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_CHATS_PARENT_TEAM_COLLAB_HINT',\n\t\tsubtitleForTeam: 'HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_CHATS_COLLAB_OF_TEAM_MSGVER_2',\n\t\tparentDepartmentOfDepartmentHint: 'HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_CHATS_PARENT_DEPARTMENT_COLLAB_OF_DEPARTMENT_HINT',\n\t\tparentDepartmentOfTeamHint: 'HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_CHATS_PARENT_DEPARTMENT_COLLAB_OF_TEAM_HINT',\n\t\tsubtitleForDepartment: 'HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_CHATS_COLLAB_OF_DEPARTMENT_MSGVER_2',\n\t\tgetAvatar: (avatarOptions: Object): AvatarBase => new AvatarHexagonGuest(avatarOptions),\n\t\tdataTestIdPrefix: 'hr-department-content_chats-tab__list_collab-item-',\n\t},\n});\n\nexport type ItemDictionaryType = {\n\tnoAccessHint: string,\n\tparentTeamHint: string,\n\tsubtitleForTeam: string,\n\tparentDepartmentOfDepartmentHint: string,\n\tparentDepartmentOfTeamHint: string,\n\tsubtitleForDepartment: string,\n\tgetAvatar: string,\n\tdataTestIdPrefix: string,\n};\n","import { useChartStore } from 'humanresources.company-structure.chart-store';\nimport { events } from 'humanresources.company-structure.org-chart';\nimport { EventEmitter } from 'main.core.events';\nimport { Messenger } from 'im.public.iframe';\nimport { EntityTypes, getColorCode, ChatTypes } from 'humanresources.company-structure.utils';\nimport { mapState } from 'ui.vue3.pinia';\nimport { CommunicationListItemActionButton } from './action-button';\nimport { Hint, ResponsiveHint } from 'humanresources.company-structure.structure-components';\nimport { ItemDictionary, ItemDictionaryType } from './dictionaries/item-dictionary';\n\n// @vue/component\nexport const CommunicationListItem = {\n\tname: 'communicationListItem',\n\n\tcomponents: { ChatListItemActionButton: CommunicationListItemActionButton, ResponsiveHint },\n\n\tdirectives: { hint: Hint },\n\n\tprops: {\n\t\t/** @type CommunicationDetailed */\n\t\tcommunication: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t\tnodeId: {\n\t\t\ttype: Number,\n\t\t\trequired: true,\n\t\t},\n\t},\n\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tavatar: null,\n\t\t};\n\t},\n\n\tcomputed:\n\t{\n\t\tdictionary(): ItemDictionaryType\n\t\t{\n\t\t\treturn ItemDictionary[this.communication.type] || ItemDictionary[ChatTypes.channel];\n\t\t},\n\t\toriginalNodeName(): string\n\t\t{\n\t\t\treturn this.departments.get(this.communication.originalNodeId)?.name;\n\t\t},\n\t\thiddenNodeName(): string\n\t\t{\n\t\t\treturn this.structureMap.get(this.communication.originalNodeId)?.entityType === EntityTypes.team\n\t\t\t\t? this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_CHATS_HIDDEN_TEAM')\n\t\t\t\t: this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_CHATS_HIDDEN_DEPARTMENT')\n\t\t\t;\n\t\t},\n\t\t/**\n\t\t * Prepare subtitle with #NAME# placeholder where #NAME# can be a vue component\n\t\t */\n\t\tpreparedIndirectSubtitle(): { beforeText: ?string, afterText: ?string }\n\t\t{\n\t\t\tlet phrase = '';\n\t\t\tif (this.structureMap.get(this.communication.originalNodeId)?.entityType === EntityTypes.team)\n\t\t\t{\n\t\t\t\tphrase = this.loc(this.dictionary.subtitleForTeam);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tphrase = this.loc(this.dictionary.subtitleForDepartment);\n\t\t\t}\n\n\t\t\tconst parts = phrase.split('#NAME#');\n\n\t\t\treturn {\n\t\t\t\tbeforeText: parts[0] || null,\n\t\t\t\tafterText: parts[1] || null,\n\t\t\t};\n\t\t},\n\t\tlockHint(): string\n\t\t{\n\t\t\t// parent node is a team so child node must be a team too\n\t\t\tif (this.structureMap.get(this.communication.originalNodeId)?.entityType === EntityTypes.team)\n\t\t\t{\n\t\t\t\treturn this.loc(this.dictionary.parentTeamHint);\n\t\t\t}\n\n\t\t\t// parent node is a department so we check if child node is a department too\n\t\t\tif (this.structureMap.get(this.nodeId)?.entityType === EntityTypes.department)\n\t\t\t{\n\t\t\t\treturn this.loc(this.dictionary.parentDepartmentOfDepartmentHint);\n\t\t\t}\n\n\t\t\t// parent node is a department but child node is a team\n\t\t\treturn this.loc(this.dictionary.parentDepartmentOfTeamHint);\n\t\t},\n\t\t...mapState(useChartStore, ['structureMap', 'departments']),\n\t},\n\n\twatch:\n\t{\n\t\tcommunication(): void\n\t\t{\n\t\t\tthis.prepareAvatar();\n\t\t},\n\t},\n\n\tcreated(): void\n\t{\n\t\tthis.prepareAvatar();\n\t},\n\n\tmethods:\n\t{\n\t\tprepareAvatar(): void\n\t\t{\n\t\t\tif (this.communication.avatar)\n\t\t\t{\n\t\t\t\tthis.communication.color = getColorCode('whiteBase');\n\t\t\t}\n\n\t\t\tconst avatarOptions = {\n\t\t\t\tsize: 32,\n\t\t\t\tuserName: this.communication.title,\n\t\t\t\tbaseColor: this.isExtranet() && !this.communication.avatar ? getColorCode('extranetColor') : this.communication.color,\n\t\t\t\tevents: {\n\t\t\t\t\tclick: () => {\n\t\t\t\t\t\tthis.onChatItemClick();\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t};\n\n\t\t\tif (this.communication.avatar)\n\t\t\t{\n\t\t\t\tavatarOptions.userpicPath = this.communication.avatar;\n\t\t\t}\n\n\t\t\tthis.avatar = this.dictionary.getAvatar(avatarOptions);\n\t\t},\n\t\tloc(phraseCode: string, replacements: { [p: string]: string } = {}): string\n\t\t{\n\t\t\treturn this.$Bitrix.Loc.getMessage(phraseCode, replacements);\n\t\t},\n\t\tonChatItemClick(): void\n\t\t{\n\t\t\tif (this.communication.hasAccess)\n\t\t\t{\n\t\t\t\tMessenger.openChat(this.communication.dialogId);\n\t\t\t}\n\t\t},\n\t\tisExtranet(): boolean\n\t\t{\n\t\t\treturn this.communication.isExtranet;\n\t\t},\n\t\tlocateToOriginalDepartment(): void\n\t\t{\n\t\t\tEventEmitter.emit(events.HR_ORG_CHART_LOCATE_TO_DEPARTMENT, { nodeId: this.communication.originalNodeId });\n\t\t},\n\t},\n\n\ttemplate: `\n\t\t<div\n\t\t\t:key=\"communication.id\"\n\t\t\tclass=\"hr-department-detail-content__tab-list_item-wrapper --chat\"\n\t\t\t:class=\"{ '--isExtranet': isExtranet() }\"\n\t\t\t:data-test-id=\"dictionary.dataTestIdPrefix + communication.id\"\n\t\t>\n\t\t\t<div\n\t\t\t\tclass=\"hr-department-detail-content__tab-list_item-avatar-container\"\n\t\t\t\t:class=\"{ '--not-clickable': !communication.hasAccess }\"\n\t\t\t\tv-html=\"this.avatar.getContainer().outerHTML\"\n\t\t\t\t@click=\"onChatItemClick\"\n\t\t\t/>\n\t\t\t<div class=\"hr-department-detail-content__tab-list_item-text-container\">\n\t\t\t\t<div class=\"hr-department-detail-content__tab-list_item-title-container --chat-item\">\n\t\t\t\t\t<span\n\t\t\t\t\t\tclass=\"hr-department-detail-content__tab-list_item-title\"\n\t\t\t\t\t\t:class=\"{ '--not-clickable': !communication.hasAccess }\"\n\t\t\t\t\t\t:data-test-id=\"'hr-department-content_chats-tab__list_chat-item-' + communication.id + '-title'\"\n\t\t\t\t\t\t@click=\"onChatItemClick\"\n\t\t\t\t\t>{{ communication.title }}</span>\n\t\t\t\t\t<ResponsiveHint\n\t\t\t\t\t\tv-if=\"communication.originalNodeId\"\n\t\t\t\t\t\t:content=\"lockHint\"\n\t\t\t\t\t\t:extraClasses=\"{ 'hr-department-detail-content__tab-list_hint-container': true }\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<span class=\"ui-icon-set --lock hr-department-detail-content__tab-list_lock-icon\"></span>\n\t\t\t\t\t</ResponsiveHint>\n\t\t\t\t</div>\n\t\t\t\t<div v-if=\"communication.originalNodeId && originalNodeName\"\n\t\t\t\t\t class=\"hr-department-detail-content__tab-list_item-subtitle --chat-item\">\n\t\t\t\t\t<span class=\"hr-department-detail-content__tab-list_item-subtitle_before\">\n\t\t\t\t\t\t{{ preparedIndirectSubtitle.beforeText }}\n\t\t\t\t\t</span>\n\t\t\t\t\t<ResponsiveHint\n\t\t\t\t\t\t:content=\"originalNodeName\"\n\t\t\t\t\t\tdefaultClass=\"hr-department-detail-content__tab-list_orig-node-name\"\n\t\t\t\t\t\t:checkScrollWidth=\"true\"\n\t\t\t\t\t\t:width=\"null\"\n\t\t\t\t\t\t@click=\"locateToOriginalDepartment\"\n\t\t\t\t\t>\n\t\t\t\t\t\t{{ originalNodeName }}\n\t\t\t\t\t</ResponsiveHint>\n\t\t\t\t\t<span class=\"hr-department-detail-content__tab-list_item-subtitle_after\">\n\t\t\t\t\t\t{{ preparedIndirectSubtitle.afterText }}\n\t\t\t\t\t</span>\n\t\t\t\t</div>\n\t\t\t\t<div v-else-if=\"communication.originalNodeId\"\n\t\t\t\t\t class=\"hr-department-detail-content__tab-list_item-subtitle --chat-item\">\n\t\t\t\t\t<span class=\"hr-department-detail-content__tab-list_item-subtitle_before\">\n\t\t\t\t\t\t{{ preparedIndirectSubtitle.beforeText }}\n\t\t\t\t\t</span>\n\t\t\t\t\t<span class=\"hr-department-detail-content__tab-list_orig-node-hidden-name\">\n\t\t\t\t\t\t{{ hiddenNodeName }}\n\t\t\t\t\t</span>\n\t\t\t\t\t<span class=\"hr-department-detail-content__tab-list_item-subtitle_after\">\n\t\t\t\t\t\t{{ preparedIndirectSubtitle.afterText }}\n\t\t\t\t\t</span>\n\t\t\t\t</div>\n\t\t\t\t<div v-else class=\"hr-department-detail-content__tab-list_item-subtitle\">\n\t\t\t\t\t{{ communication.subtitle }}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<ChatListItemActionButton\n\t\t\t\t:communication=\"communication\"\n\t\t\t\t:nodeId=\"nodeId\"\n\t\t\t/>\n\t\t</div>\n\t`,\n};\n","import {\n\tChatsMenuLinkChat,\n\tChatsMenuLinkChannel,\n\tChatsMenuLinkCollab,\n} from '../consts';\n\nexport const ListDictionary: Record<string, ListDictionaryItem> = Object.freeze({\n\tchat: {\n\t\ttabListId: 'hr-department-detail-content_chats-tab__chat-list',\n\t\tfooterDataTestId: 'hr-department-content_chats-tab__list_chat-hidden-text',\n\t\tlistTitle: 'HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_CHATS_CHAT_LIST_TITLE',\n\t\temptyItemTitle: 'HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_CHATS_EMPTY_CHAT_LIST_ITEM_TEXT_MSGVER_1',\n\t\tnoTeamText: 'HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_CHATS_EMPTY_CHAT_LIST_ITEM_NO_TEAM_TEXT_MSGVER_1',\n\t\tnoDepartmentText: 'HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_CHATS_EMPTY_CHAT_LIST_ITEM_NO_DEPARTMENT_TEXT_MSGVER_1',\n\t\tmoreHiddenText: 'HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_CHATS_EMPTY_CHAT_LIST_ITEM_MORE_HIDDEN_TEXT',\n\t\temptyHiddenText: 'HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_CHATS_EMPTY_CHAT_LIST_ITEM_EMPTY_HIDDEN_TEXT',\n\t\tmenuItems: [ChatsMenuLinkChat],\n\t},\n\tchannel: {\n\t\ttabListId: 'hr-department-detail-content_chats-tab__channel-list',\n\t\tfooterDataTestId: 'hr-department-content_chats-tab__list_channel-hidden-text',\n\t\tlistTitle: 'HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_CHATS_CHANNEL_LIST_TITLE',\n\t\temptyItemTitle: 'HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_CHATS_EMPTY_CHANNEL_LIST_ITEM_TEXT_MSGVER_1',\n\t\tnoTeamText: 'HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_CHATS_EMPTY_CHANNEL_LIST_ITEM_NO_TEAM_TEXT_MSGVER_1',\n\t\tnoDepartmentText: 'HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_CHATS_EMPTY_CHANNEL_LIST_ITEM_NO_DEPARTMENT_TEXT_MSGVER_1',\n\t\tmoreHiddenText: 'HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_CHATS_EMPTY_CHANNEL_LIST_ITEM_MORE_HIDDEN_TEXT',\n\t\temptyHiddenText: 'HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_CHATS_EMPTY_CHANNEL_LIST_ITEM_EMPTY_HIDDEN_TEXT',\n\t\tmenuItems: [ChatsMenuLinkChannel],\n\t},\n\tcollab: {\n\t\ttabListId: 'hr-department-detail-content_chats-tab__collab-list',\n\t\tfooterDataTestId: 'hr-department-content_chats-tab__list_collab-hidden-text',\n\t\tlistTitle: 'HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_CHATS_COLLAB_LIST_TITLE',\n\t\temptyItemTitle: 'HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_CHATS_EMPTY_COLLAB_LIST_ITEM_TEXT',\n\t\tnoTeamText: 'HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_CHATS_EMPTY_COLLAB_LIST_ITEM_NO_TEAM_TEXT',\n\t\tnoDepartmentText: 'HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_CHATS_EMPTY_COLLAB_LIST_ITEM_NO_DEPARTMENT_TEXT',\n\t\tmoreHiddenText: 'HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_CHATS_EMPTY_COLLAB_LIST_ITEM_MORE_HIDDEN_TEXT',\n\t\temptyHiddenText: 'HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_CHATS_EMPTY_COLLAB_LIST_ITEM_EMPTY_HIDDEN_TEXT',\n\t\tmenuItems: [ChatsMenuLinkCollab],\n\t},\n});\n\nexport type ListDictionaryItem = {\n\ttabListId: string,\n\tfooterDataTestId: string,\n\tlistTitle: string,\n\temptyItemTitle: string,\n\tnoTeamText: string,\n\tnoDepartmentText: string,\n\tmoreHiddenText: string,\n\temptyHiddenText: string,\n\tmenuItems: Object[],\n};\n","import { TabList } from '../base-components/list/list';\nimport { CommunicationListItem } from './list-item';\nimport { Loc } from 'main.core';\nimport { ListDictionary, ListDictionaryItem } from './dictionaries/list-dictionary';\nimport { CommunicationsTypeDict } from 'humanresources.company-structure.structure-components';\n\n// @vue/component\nexport const CommunicationList = {\n\tname: 'communicationList',\n\n\tcomponents: {\n\t\tTabList,\n\t\tCommunicationListItem,\n\t},\n\n\tprops: {\n\t\t/** @type CommunicationDetailed[] */\n\t\tcommunications: {\n\t\t\ttype: Array,\n\t\t\trequired: true,\n\t\t},\n\t\tcommunicationsNoAccess: {\n\t\t\ttype: Number,\n\t\t\trequired: true,\n\t\t},\n\t\t/** @type CommunicationDetailed[] */\n\t\tfilteredCommunications: {\n\t\t\ttype: Array,\n\t\t\trequired: true,\n\t\t},\n\t\tisTeamEntity: {\n\t\t\ttype: Boolean,\n\t\t\trequired: true,\n\t\t},\n\t\tcanEdit: {\n\t\t\ttype: Boolean,\n\t\t\trequired: true,\n\t\t},\n\t\tsearchQuery: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t\tfocusedNode: {\n\t\t\ttype: [String, Number],\n\t\t\trequired: true,\n\t\t},\n\t\tcommunicationType: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t\tvalidator: (value) => Object.values(CommunicationsTypeDict).includes(value),\n\t\t},\n\t\tdataTestId: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t},\n\n\tdata(): { dictionary: ListDictionaryItem | {} }\n\t{\n\t\treturn {\n\t\t\tdictionary: {},\n\t\t};\n\t},\n\n\tcomputed:\n\t{\n\t\tcommunicationMenuItems(): Object[]\n\t\t{\n\t\t\treturn this.canEdit ? this.dictionary.menuItems : [];\n\t\t},\n\t\tcommunicationsNoAccessText(): string\n\t\t{\n\t\t\tconst phrase = (this.communications.length > 0)\n\t\t\t\t? this.dictionary.moreHiddenText\n\t\t\t\t: this.dictionary.emptyHiddenText\n\t\t\t;\n\n\t\t\treturn this.locPlural(phrase, this.communicationsNoAccess);\n\t\t},\n\t\temptyCommunicationTitle(): string\n\t\t{\n\t\t\tif (this.canEdit)\n\t\t\t{\n\t\t\t\treturn this.loc(this.dictionary.emptyItemTitle);\n\t\t\t}\n\n\t\t\treturn this.isTeamEntity\n\t\t\t\t? this.loc(this.dictionary.noTeamText)\n\t\t\t\t: this.loc(this.dictionary.noDepartmentText)\n\t\t\t;\n\t\t},\n\t\thideEmptyCommunicationItem(): boolean\n\t\t{\n\t\t\treturn this.searchQuery.length > 0 || this.communicationsNoAccess > 0;\n\t\t},\n\t},\n\n\tcreated(): void\n\t{\n\t\tthis.dictionary = ListDictionary[this.communicationType] || {};\n\t},\n\n\tmethods:\n\t{\n\t\tloc(phraseCode: string, replacements: {[p: string]: string} = {}): string\n\t\t{\n\t\t\treturn this.$Bitrix.Loc.getMessage(phraseCode, replacements);\n\t\t},\n\t\tlocPlural(phraseCode: string, count: number): string\n\t\t{\n\t\t\treturn Loc.getMessagePlural(phraseCode, count, { '#COUNT#': count });\n\t\t},\n\t\tonActionMenuItemClick(...args): void\n\t\t{\n\t\t\tthis.$emit('tabListAction', ...args);\n\t\t},\n\t},\n\n\ttemplate: `\n\t\t<TabList\n\t\t\t:id='dictionary.tabListId'\n\t\t\t:title=\"loc(dictionary.listTitle)\"\n\t\t\t:count=\"communications.length + communicationsNoAccess\"\n\t\t\t:menuItems=\"communicationMenuItems\"\n\t\t\t:listItems=\"filteredCommunications\"\n\t\t\t:emptyItemTitle=\"emptyCommunicationTitle\"\n\t\t\temptyItemImageClass=\"hr-department-detail-content__chat-empty-tab-list-item_tab-icon\"\n\t\t\t:hideEmptyItem=\"hideEmptyCommunicationItem\"\n\t\t\t:withAddPermission=\"canEdit\"\n\t\t\t@tabListAction=\"onActionMenuItemClick\"\n\t\t\t:dataTestIds=\"dataTestId\"\n\t\t>\n\t\t\t<template v-slot=\"{ item }\">\n\t\t\t\t<CommunicationListItem :communication=\"item\" :nodeId=\"focusedNode\"/>\n\t\t\t</template>\n\t\t\t<template v-if=\"communicationsNoAccess > 0\" v-slot:footer>\n\t\t\t\t<div\n\t\t\t\t\tclass=\"hr-department-detail-content__tab-list_communications-hidden\"\n\t\t\t\t\t:data-test-id=\"dictionary.footerDataTestId\"\n\t\t\t\t>\n\t\t\t\t\t{{ communicationsNoAccessText }}\n\t\t\t\t</div>\n\t\t\t</template>\n\t\t</TabList>\n\t`,\n};\n","import { RouteActionMenu } from 'humanresources.company-structure.structure-components';\n\nconst MenuOption = Object.freeze({\n\twithChildren: 'withChildren',\n\twithoutChildren: 'withoutChildren',\n});\n\n// @vue/component\nexport const ChildrenModeSelector = {\n\tname: 'childrenModeSelector',\n\n\tcomponents: { RouteActionMenu },\n\n\tprops:\n\t{\n\t\tisTeamEntity: {\n\t\t\ttype: Boolean,\n\t\t\trequired: true,\n\t\t},\n\t\tdataTestId: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t\thasPermission: {\n\t\t\ttype: Boolean,\n\t\t\trequired: true,\n\t\t},\n\t\ttext: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t},\n\n\temits: ['saveChildrenMode'],\n\n\tdata(): { menuVisible: boolean; withChildren: boolean }\n\t{\n\t\treturn {\n\t\t\tmenuVisible: false,\n\t\t\twithChildren: false,\n\t\t};\n\t},\n\n\tcomputed:\n\t{\n\t\tgetControlButtonText(): string\n\t\t{\n\t\t\treturn this.getValueText(this.withChildren);\n\t\t},\n\t},\n\n\tcreated(): void\n\t{\n\t\tthis.menuItems = this.getMenuItems();\n\t},\n\n\tmethods:\n\t{\n\t\tloc(phraseCode: string, replacements: { [p: string]: string } = {}): string\n\t\t{\n\t\t\treturn this.$Bitrix.Loc.getMessage(phraseCode, replacements);\n\t\t},\n\t\tshowMenu(): void\n\t\t{\n\t\t\tif (this.hasPermission)\n\t\t\t{\n\t\t\t\tthis.menuVisible = true;\n\t\t\t}\n\t\t},\n\t\tonActionMenuItemClick(actionId: number): void\n\t\t{\n\t\t\tif (this.hasPermission)\n\t\t\t{\n\t\t\t\tthis.withChildren = actionId === MenuOption.withChildren;\n\t\t\t\tthis.$emit('saveChildrenMode', this.withChildren);\n\t\t\t}\n\t\t},\n\t\tgetMenuItems(): Array\n\t\t{\n\t\t\treturn [\n\t\t\t\t{\n\t\t\t\t\tid: MenuOption.withoutChildren,\n\t\t\t\t\ttitle: this.getValueText(false),\n\t\t\t\t\titemClass: 'hr-department-detail-content__children-mode-selector_menu-item',\n\t\t\t\t\tdataTestId: 'hr-chat-children-mode-selector_menu-item-without',\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tid: MenuOption.withChildren,\n\t\t\t\t\ttitle: this.getValueText(true),\n\t\t\t\t\titemClass: 'hr-department-detail-content__children-mode-selector_menu-item',\n\t\t\t\t\tdataTestId: 'hr-chat-children-mode-selector_menu-item-with',\n\t\t\t\t},\n\t\t\t];\n\t\t},\n\t\tgetValueText(value: boolean): string\n\t\t{\n\t\t\tif (this.isTeamEntity)\n\t\t\t{\n\t\t\t\treturn value\n\t\t\t\t\t? this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_CHATS_WITH_SUBTEAMS_LABEL')\n\t\t\t\t\t: this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_CHATS_ONLY_TEAM_LABEL')\n\t\t\t\t;\n\t\t\t}\n\n\t\t\treturn value\n\t\t\t\t? this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_CHATS_WITH_SUBDEPARTMENTS_LABEL')\n\t\t\t\t: this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_CHATS_ONLY_DEPARTMENT_LABEL')\n\t\t\t;\n\t\t},\n\t},\n\n\ttemplate: `\n\t\t<div class=\"hr-department-detail-content__change-save-mode-control-container\">\n\t\t\t<span>{{ text }}</span>\n\t\t\t<a\n\t\t\t\tclass=\"hr-department-detail-content__change-save-mode-control-button\"\n\t\t\t\t:class=\"{ '--focused': menuVisible, '--disabled': !hasPermission }\"\n\t\t\t\t:dataTestId=\"dataTestId\"\n\t\t\t\tref='saveChildrenModeButton'\n\t\t\t\t@click=\"showMenu\"\n\t\t\t>\n\t\t\t\t{{ getControlButtonText }}\n\t\t\t</a>\n\t\t</div>\n\t\t<RouteActionMenu\n\t\t\tv-if=\"menuVisible\"\n\t\t\t:id=\"'hr-department-detail-children-mode-selector-menu'\"\n\t\t\t:items=\"menuItems\"\n\t\t\t:delimiter=\"false\"\n\t\t\t:width=\"302\"\n\t\t\t:bindElement=\"$refs.saveChildrenModeButton\"\n\t\t\t@action=\"onActionMenuItemClick\"\n\t\t\t@close=\"menuVisible = false\"\n\t\t/>\n\t`,\n};\n","import {\n\tgetChatDialogEntity,\n\tgetChannelDialogEntity,\n\tgetCollabDialogEntity,\n} from 'humanresources.company-structure.structure-components';\nimport type { CommunicationDetailed } from 'humanresources.company-structure.utils';\nimport { ChatLinkDialogDataTestIds, ChannelLinkDialogDataTestIds, CollabLinkDialogDataTestIds } from '../consts';\n\nexport const DialogDictionary: Record<string, DialogDictionaryItem> = Object.freeze({\n\tchat: {\n\t\tdialogId: 'hr-department-detail-content-chats-tab-chat-link-dialog',\n\t\ttitle: 'HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_CHATS_CHAT_LINK_DIALOG_TITLE',\n\t\tdescription: {\n\t\t\tteam: 'HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_CHATS_CHAT_LINK_DIALOG_TEAM_DESC',\n\t\t\tdefault: 'HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_CHATS_CHAT_LINK_DIALOG_DESC',\n\t\t},\n\t\tchildrenModeText: 'HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_CHATS_MODE_CHATS_TEXT',\n\t\tdataTestIds: ChatLinkDialogDataTestIds,\n\t\tgetDialogEntity: (): Object => getChatDialogEntity(),\n\t\tgetDialogIdFromId: (item: CommunicationDetailed): string => `chat${item.id}`,\n\t\tgetIdFromDialogId: (item: CommunicationDetailed): number => Number(item.id?.replace('chat', '')),\n\t},\n\tchannel: {\n\t\tdialogId: 'hr-department-detail-content-chats-tab-channel-link-dialog',\n\t\ttitle: 'HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_CHATS_CHANNEL_LINK_DIALOG_TITLE',\n\t\tdescription: {\n\t\t\tteam: 'HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_CHATS_CHANNEL_LINK_DIALOG_TEAM_DESC',\n\t\t\tdefault: 'HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_CHATS_CHANNEL_LINK_DIALOG_DESC',\n\t\t},\n\t\tchildrenModeText: 'HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_CHATS_MODE_CHANNELS_TEXT',\n\t\tdataTestIds: ChannelLinkDialogDataTestIds,\n\t\tgetDialogEntity: (): Object => getChannelDialogEntity(),\n\t\tgetDialogIdFromId: (item: CommunicationDetailed): string => `chat${item.id}`,\n\t\tgetIdFromDialogId: (item: CommunicationDetailed): number => Number(item.id?.replace('chat', '')),\n\t},\n\tcollab: {\n\t\tdialogId: 'hr-department-detail-content-chats-tab-channel-link-dialog',\n\t\ttitle: 'HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_CHATS_COLLAB_LINK_DIALOG_TITLE',\n\t\tdescription: {\n\t\t\tteam: 'HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_CHATS_COLLAB_LINK_DIALOG_TEAM_DESC',\n\t\t\tdefault: 'HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_CHATS_COLLAB_LINK_DIALOG_DESC',\n\t\t},\n\t\tchildrenModeText: 'HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_CHATS_MODE_COLLABS_TEXT',\n\t\tdataTestIds: CollabLinkDialogDataTestIds,\n\t\tgetDialogEntity: (): Object => getCollabDialogEntity(),\n\t\tgetDialogIdFromId: (item: CommunicationDetailed): string | number => Number(item.id),\n\t\tgetIdFromDialogId: (item: CommunicationDetailed): number => Number(item.id),\n\t},\n});\n\nexport type DialogDictionaryItem = {\n\tdialogId: string,\n\ttitle: string,\n\tdescription: {\n\t\tteam: string,\n\t\tdefault: string,\n\t},\n\tchildrenModeText: string,\n\tdataTestIds: Object,\n\tgetDialogEntity: () => Object,\n\tgetDialogIdFromId: (item: CommunicationDetailed) => string | number,\n\tgetIdFromDialogId: (item: CommunicationDetailed) => number,\n};\n","import { useChartStore } from 'humanresources.company-structure.chart-store';\nimport {\n\tManagementDialog,\n\tCommunicationsTypeDict,\n\tgetCommunicationsRecentTabOptions,\n} from 'humanresources.company-structure.structure-components';\nimport type { TabOptions } from 'ui.entity-selector';\nimport { ChildrenModeSelector } from './children-mode-selector';\nimport { DepartmentAPI } from '../../api';\nimport { DepartmentContentActions } from '../../actions';\nimport { DialogDictionary, DialogDictionaryItem } from './dictionaries/dialog-dictionary';\n\n// @vue/component\nexport const LinkDialog = {\n\tname: 'LinkDialog',\n\n\tcomponents: { ManagementDialog, ChildrenModeSelector },\n\n\tprops: {\n\t\t/** @type CommunicationDetailed[] */\n\t\tcommunications: {\n\t\t\ttype: Array,\n\t\t\trequired: true,\n\t\t},\n\t\tcommunicationType: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t\tvalidator: (value) => Object.values(CommunicationsTypeDict).includes(value),\n\t\t},\n\t\tfocusedNode: {\n\t\t\ttype: [String, Number],\n\t\t\trequired: true,\n\t\t},\n\t\tisTeamEntity: {\n\t\t\ttype: Boolean,\n\t\t\trequired: true,\n\t\t},\n\t\tentityType: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t\tisVisible: {\n\t\t\ttype: Boolean,\n\t\t\trequired: true,\n\t\t},\n\t\tcanAddWithChildren: {\n\t\t\ttype: Boolean,\n\t\t\trequired: true,\n\t\t},\n\t},\n\n\temits: ['close', 'reloadList'],\n\n\tdata(): { isLinkActive: boolean, addWithChildren: boolean, dictionary: DialogDictionaryItem | {} }\n\t{\n\t\treturn {\n\t\t\tisLinkActive: false,\n\t\t\taddWithChildren: false,\n\t\t\tdictionary: {},\n\t\t};\n\t},\n\n\tcomputed:\n\t{\n\t\tdialogEntities(): Object[]\n\t\t{\n\t\t\tconst entity = this.dictionary.getDialogEntity();\n\t\t\tentity.options.excludeIds = this.communications.map((item) => item.id);\n\n\t\t\treturn [entity];\n\t\t},\n\t\tdialogRecentTabOptions(): TabOptions\n\t\t{\n\t\t\treturn getCommunicationsRecentTabOptions(this.entityType, this.communicationType);\n\t\t},\n\t\tlinkedIds(): string[] | number[]\n\t\t{\n\t\t\treturn this.communications.map((item) => this.dictionary.getDialogIdFromId(item));\n\t\t},\n\t\taddDescription(): string\n\t\t{\n\t\t\treturn this.isTeamEntity\n\t\t\t\t? this.loc(this.dictionary.description.team)\n\t\t\t\t: this.loc(this.dictionary.description.default)\n\t\t\t;\n\t\t},\n\t},\n\n\tcreated(): void\n\t{\n\t\tthis.dictionary = DialogDictionary[this.communicationType] || {};\n\t},\n\n\tmethods:\n\t{\n\t\tloc(phraseCode: string, replacements = {}): string\n\t\t{\n\t\t\treturn this.$Bitrix.Loc.getMessage(phraseCode, replacements);\n\t\t},\n\t\tasync linkEntities(items: Array): Promise<void>\n\t\t{\n\t\t\tthis.isLinkActive = true;\n\t\t\tconst mappedIds = items.map((item) => this.dictionary.getIdFromDialogId(item));\n\n\t\t\ttry\n\t\t\t{\n\t\t\t\tconst nodeId = this.focusedNode;\n\t\t\t\tconst addWithChildren = Number(this.addWithChildren);\n\n\t\t\t\tswitch (this.communicationType)\n\t\t\t\t{\n\t\t\t\t\tcase CommunicationsTypeDict.chat:\n\t\t\t\t\t\tawait DepartmentAPI.saveChats(nodeId, mappedIds, [], addWithChildren);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase CommunicationsTypeDict.channel:\n\t\t\t\t\t\tawait DepartmentAPI.saveChannel(nodeId, mappedIds, [], addWithChildren);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase CommunicationsTypeDict.collab:\n\t\t\t\t\t\tawait DepartmentAPI.saveCollab(nodeId, mappedIds, [], addWithChildren);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\t\tthis.$emit('reloadList');\n\t\t\t\tif (this.addWithChildren)\n\t\t\t\t{\n\t\t\t\t\tconst store = useChartStore();\n\t\t\t\t\tstore.updateChatsInChildrenNodes(nodeId);\n\t\t\t\t}\n\t\t\t}\n\t\t\tcatch\n\t\t\t{ /* empty */ }\n\t\t\tthis.addWithChildren = false;\n\t\t\tthis.isLinkActive = false;\n\t\t\tthis.$emit('close');\n\t\t},\n\t},\n\n\ttemplate: `\n\t\t<ManagementDialog\n\t\t\tv-if=\"isVisible\"\n\t\t\t:id=\"dictionary.dialogId\"\n\t\t\t:entities=\"dialogEntities\"\n\t\t\t:recentTabOptions=\"dialogRecentTabOptions\"\n\t\t\t:hiddenItemsIds=\"linkedIds\"\n\t\t\t:title=\"loc(dictionary.title)\"\n\t\t\t:description=\"addDescription\"\n\t\t\t:isActive=\"isLinkActive\"\n\t\t\t@managementDialogAction=\"linkEntities\"\n\t\t\t@close=\"$emit('close')\"\n\t\t\t:dataTestIds=\"dictionary.dataTestIds\"\n\t\t>\n\t\t\t<template v-slot:extra-subtitle>\n\t\t\t\t<ChildrenModeSelector\n\t\t\t\t\t:isTeamEntity=\"isTeamEntity\"\n\t\t\t\t\t:dataTestId=\"dictionary.dataTestIds.addWithChildrenDataTestId\"\n\t\t\t\t\t:hasPermission=\"canAddWithChildren\"\n\t\t\t\t\t:text=\"loc(dictionary.childrenModeText)\"\n\t\t\t\t\t@saveChildrenMode=\"addWithChildren = $event\"\n\t\t\t\t/>\n\t\t\t</template>\n\t\t</ManagementDialog>\n\t`,\n};\n","import {\n\tPermissionActions,\n\tPermissionChecker,\n\tPermissionLevels,\n} from 'humanresources.company-structure.permission-checker';\nimport { EntityTypes, type ChatListResponse, type CommunicationDetailed } from 'humanresources.company-structure.utils';\nimport { DepartmentContentActions } from '../../actions';\nimport { DepartmentAPI } from '../../api';\nimport { SearchInput } from '../base-components/search/search-input';\nimport { EmptyState } from '../base-components/empty-state/empty-state';\nimport { EmptyTabAddButtons } from './empty-tab-add-buttons';\nimport { ChannelListDataTestIds, ChatListDataTestIds, CollabListDataTestIds, ChatsMenuOption } from './consts';\nimport { CommunicationsTypeDict } from 'humanresources.company-structure.structure-components';\nimport { useChartStore } from 'humanresources.company-structure.chart-store';\nimport { mapState } from 'ui.vue3.pinia';\nimport { Loc, Type } from 'main.core';\nimport { CommunicationList } from './communication-list.js';\nimport { LinkDialog } from './link-dialog.js';\n\nimport './styles/tab.css';\n\nexport const ChatsTab = {\n\tname: 'chatsTab',\n\n\tcomponents: {\n\t\tSearchInput,\n\t\tEmptyState,\n\t\tEmptyTabAddButtons,\n\t\tCommunicationList,\n\t\tLinkDialog,\n\t},\n\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tchatLinkDialogVisible: false,\n\t\t\tchannelLinkDialogVisible: false,\n\t\t\tcollabLinkDialogVisible: false,\n\t\t\tisLoading: false,\n\t\t\tsearchQuery: '',\n\t\t\tpermissionChecker: null,\n\t\t};\n\t},\n\n\tmethods:\n\t{\n\t\tloc(phraseCode: string, replacements: {[p: string]: string} = {}): string\n\t\t{\n\t\t\treturn this.$Bitrix.Loc.getMessage(phraseCode, replacements);\n\t\t},\n\t\tlocPlural(phraseCode: string, count: number): string\n\t\t{\n\t\t\treturn Loc.getMessagePlural(phraseCode, count, { '#COUNT#': count });\n\t\t},\n\t\tsearchChatOrChannel(searchQuery: string): void\n\t\t{\n\t\t\tthis.searchQuery = searchQuery;\n\t\t},\n\t\tasync loadChatAction(force: boolean): ?Promise<ChatListResponse>\n\t\t{\n\t\t\tif (this.isLoading)\n\t\t\t{\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\tconst nodeId = this.focusedNode;\n\t\t\tconst department = this.departments.get(nodeId);\n\n\t\t\tif (!department)\n\t\t\t{\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\tif (!force\n\t\t\t\t&& Type.isArray(department.chatsDetailed)\n\t\t\t\t&& Type.isArray(department.channelsDetailed)\n\t\t\t\t&& Type.isArray(department.collabsDetailed)\n\t\t\t)\n\t\t\t{\n\t\t\t\treturn {\n\t\t\t\t\tchats: department.chatsDetailed,\n\t\t\t\t\tchannels: department.channelsDetailed,\n\t\t\t\t\tcollabs: department.collabsDetailed,\n\t\t\t\t\tchatsNoAccess: department.chatsNoAccess,\n\t\t\t\t\tchannelsNoAccess: department.channelsNoAccess,\n\t\t\t\t\tcollabsNoAccess: department.collabsNoAccess,\n\t\t\t\t};\n\t\t\t}\n\n\t\t\tthis.isLoading = true;\n\n\t\t\tthis.$emit('showDetailLoader');\n\t\t\tconst loadedChatsAndChannels = await DepartmentAPI.getChatsAndChannels(nodeId);\n\t\t\tDepartmentContentActions.setChatsAndChannels(\n\t\t\t\tnodeId,\n\t\t\t\tloadedChatsAndChannels.chats ?? [],\n\t\t\t\tloadedChatsAndChannels.channels ?? [],\n\t\t\t\tloadedChatsAndChannels.collabs ?? [],\n\t\t\t\tloadedChatsAndChannels.chatsNoAccess ?? 0,\n\t\t\t\tloadedChatsAndChannels.channelsNoAccess ?? 0,\n\t\t\t\tloadedChatsAndChannels.collabsNoAccess ?? 0,\n\t\t\t);\n\t\t\tthis.$emit('hideDetailLoader');\n\t\t\tthis.isLoading = false;\n\n\t\t\treturn loadedChatsAndChannels;\n\t\t},\n\t\tonActionMenuItemClick(actionId: string): void\n\t\t{\n\t\t\tswitch (actionId)\n\t\t\t{\n\t\t\t\tcase ChatsMenuOption.linkChat:\n\t\t\t\t\tthis.chatLinkDialogVisible = true;\n\t\t\t\t\tbreak;\n\t\t\t\tcase ChatsMenuOption.linkChannel:\n\t\t\t\t\tthis.channelLinkDialogVisible = true;\n\t\t\t\t\tbreak;\n\t\t\t\tcase ChatsMenuOption.linkCollab:\n\t\t\t\t\tthis.collabLinkDialogVisible = true;\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t},\n\t\tgetAddEmptyStateList(): { text: string }[]\n\t\t{\n\t\t\tlet stateArray = [];\n\n\t\t\tif (this.isCollabsAvailable && this.isTeamEntity)\n\t\t\t{\n\t\t\t\tstateArray = [\n\t\t\t\t\tthis.loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_CHATS_EMPTY_TAB_ADD_EMPTY_STATE_TEAM_LIST_W_COLLABS_ITEM_1'),\n\t\t\t\t\tthis.loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_CHATS_EMPTY_TAB_ADD_EMPTY_STATE_LIST_W_COLLABS_ITEM_2'),\n\t\t\t\t\tthis.loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_CHATS_EMPTY_TAB_ADD_EMPTY_STATE_TEAM_LIST_W_COLLABS_ITEM_3'),\n\t\t\t\t];\n\t\t\t}\n\t\t\telse if (this.isCollabsAvailable)\n\t\t\t{\n\t\t\t\tstateArray = [\n\t\t\t\t\tthis.loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_CHATS_EMPTY_TAB_ADD_EMPTY_STATE_LIST_W_COLLABS_ITEM_1'),\n\t\t\t\t\tthis.loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_CHATS_EMPTY_TAB_ADD_EMPTY_STATE_LIST_W_COLLABS_ITEM_2'),\n\t\t\t\t\tthis.loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_CHATS_EMPTY_TAB_ADD_EMPTY_STATE_LIST_W_COLLABS_ITEM_3'),\n\t\t\t\t];\n\t\t\t}\n\t\t\telse if (this.isTeamEntity)\n\t\t\t{\n\t\t\t\tstateArray = [\n\t\t\t\t\tthis.loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_CHATS_EMPTY_TAB_ADD_EMPTY_STATE_TEAM_LIST_ITEM_1_MSGVER_1'),\n\t\t\t\t\tthis.loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_CHATS_EMPTY_TAB_ADD_EMPTY_STATE_LIST_ITEM_2'),\n\t\t\t\t\tthis.loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_CHATS_EMPTY_TAB_ADD_EMPTY_STATE_TEAM_LIST_ITEM_3'),\n\t\t\t\t];\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tstateArray = [\n\t\t\t\t\tthis.loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_CHATS_EMPTY_TAB_ADD_EMPTY_STATE_LIST_ITEM_1_MSGVER_1'),\n\t\t\t\t\tthis.loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_CHATS_EMPTY_TAB_ADD_EMPTY_STATE_LIST_ITEM_2'),\n\t\t\t\t\tthis.loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_CHATS_EMPTY_TAB_ADD_EMPTY_STATE_LIST_ITEM_3'),\n\t\t\t\t];\n\t\t\t}\n\n\t\t\treturn stateArray.map((item) => ({ text: item }));\n\t\t},\n\t},\n\n\tcomputed:\n\t{\n\t\tisCollabsAvailable(): boolean\n\t\t{\n\t\t\treturn PermissionChecker.getInstance().isCollabsAvailable;\n\t\t},\n\t\tcommunicationTypes(): Record<string, string>\n\t\t{\n\t\t\treturn CommunicationsTypeDict;\n\t\t},\n\t\tchats(): CommunicationDetailed[]\n\t\t{\n\t\t\treturn this.departments.get(this.focusedNode)?.chatsDetailed ?? [];\n\t\t},\n\t\tchannels(): CommunicationDetailed[]\n\t\t{\n\t\t\treturn this.departments.get(this.focusedNode)?.channelsDetailed ?? [];\n\t\t},\n\t\tcollabs(): CommunicationDetailed[]\n\t\t{\n\t\t\treturn this.departments.get(this.focusedNode)?.collabsDetailed ?? [];\n\t\t},\n\t\tchatsNoAccess(): number\n\t\t{\n\t\t\treturn this.departments.get(this.focusedNode)?.chatsNoAccess ?? 0;\n\t\t},\n\t\tchannelsNoAccess(): number\n\t\t{\n\t\t\treturn this.departments.get(this.focusedNode)?.channelsNoAccess ?? 0;\n\t\t},\n\t\tcollabsNoAccess(): number\n\t\t{\n\t\t\treturn this.departments.get(this.focusedNode)?.collabsNoAccess ?? 0;\n\t\t},\n\t\tfilteredChats(): Array<CommunicationDetailed>\n\t\t{\n\t\t\treturn this.chats.filter(\n\t\t\t\t(chat) => chat.title.toLowerCase().includes(this.searchQuery.toLowerCase()),\n\t\t\t);\n\t\t},\n\t\tfilteredChannels(): Array<CommunicationDetailed>\n\t\t{\n\t\t\treturn this.channels.filter(\n\t\t\t\t(channel) => channel.title.toLowerCase().includes(this.searchQuery.toLowerCase()),\n\t\t\t);\n\t\t},\n\t\tfilteredCollabs(): Array<CommunicationDetailed>\n\t\t{\n\t\t\treturn this.collabs.filter(\n\t\t\t\t(collab) => collab.title.toLowerCase().includes(this.searchQuery.toLowerCase()),\n\t\t\t);\n\t\t},\n\t\tshowAddEmptyState(): boolean\n\t\t{\n\t\t\treturn this.chats.length === 0\n\t\t\t\t&& this.channels.length === 0\n\t\t\t\t&& this.collabs.length === 0\n\t\t\t\t&& this.chatsNoAccess === 0\n\t\t\t\t&& this.channelsNoAccess === 0\n\t\t\t\t&& this.collabsNoAccess === 0\n\t\t\t;\n\t\t},\n\t\tshowSearchEmptyState(): boolean\n\t\t{\n\t\t\treturn (this.chats.length > 0 || this.channels.length > 0 || this.collabs.length > 0)\n\t\t\t\t&& this.filteredChats.length === 0\n\t\t\t\t&& this.filteredChannels.length === 0\n\t\t\t\t&& this.filteredCollabs.length === 0\n\t\t\t;\n\t\t},\n\t\tareChatsLoaded(): Boolean\n\t\t{\n\t\t\tconst department = this.departments.get(this.focusedNode);\n\n\t\t\treturn Boolean(Type.isArray(department.chatsDetailed)\n\t\t\t\t&& Type.isArray(department.channelsDetailed)\n\t\t\t\t&& Type.isArray(department.collabsDetailed))\n\t\t\t;\n\t\t},\n\t\tentityType(): boolean\n\t\t{\n\t\t\treturn this.departments.get(this.focusedNode)?.entityType;\n\t\t},\n\t\tisTeamEntity(): boolean\n\t\t{\n\t\t\treturn this.entityType === EntityTypes.team;\n\t\t},\n\t\tgetAddEmptyStateTitle(): string\n\t\t{\n\t\t\tif (this.isCollabsAvailable)\n\t\t\t{\n\t\t\t\treturn this.isTeamEntity\n\t\t\t\t\t? this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_CHATS_EMPTY_TAB_ADD_EMPTY_STATE_TEAM_TITLE_W_COLLABS')\n\t\t\t\t\t: this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_CHATS_EMPTY_TAB_ADD_EMPTY_STATE_TITLE_W_COLLABS')\n\t\t\t\t;\n\t\t\t}\n\n\t\t\treturn this.isTeamEntity\n\t\t\t\t? this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_CHATS_EMPTY_TAB_ADD_EMPTY_STATE_TEAM_TITLE')\n\t\t\t\t: this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_CHATS_EMPTY_TAB_ADD_EMPTY_STATE_TITLE')\n\t\t\t;\n\t\t},\n\t\tcanEditChat(): boolean\n\t\t{\n\t\t\treturn this.isTeamEntity\n\t\t\t\t? this.permissionChecker.hasPermission(PermissionActions.teamChatEdit, this.focusedNode)\n\t\t\t\t: this.permissionChecker.hasPermission(PermissionActions.departmentChatEdit, this.focusedNode)\n\t\t\t;\n\t\t},\n\t\tcanEditChannel(): boolean\n\t\t{\n\t\t\treturn this.isTeamEntity\n\t\t\t\t? this.permissionChecker.hasPermission(PermissionActions.teamChannelEdit, this.focusedNode)\n\t\t\t\t: this.permissionChecker.hasPermission(PermissionActions.departmentChannelEdit, this.focusedNode)\n\t\t\t;\n\t\t},\n\t\tcanEditCollab(): boolean\n\t\t{\n\t\t\treturn this.isTeamEntity\n\t\t\t\t? this.permissionChecker.hasPermission(PermissionActions.teamCollabEdit, this.focusedNode)\n\t\t\t\t: this.permissionChecker.hasPermission(PermissionActions.departmentCollabEdit, this.focusedNode)\n\t\t\t;\n\t\t},\n\t\tcanAddChatWithChildren(): boolean\n\t\t{\n\t\t\tif (this.isTeamEntity)\n\t\t\t{\n\t\t\t\treturn this.permissionChecker.hasPermission(\n\t\t\t\t\tPermissionActions.teamChatEdit,\n\t\t\t\t\tthis.focusedNode,\n\t\t\t\t\t{ TEAM: PermissionLevels.selfAndSub },\n\t\t\t\t)\n\t\t\t\t\t|| this.permissionChecker.hasPermission(\n\t\t\t\t\t\tPermissionActions.teamChatEdit,\n\t\t\t\t\t\tthis.focusedNode,\n\t\t\t\t\t\t{ DEPARTMENT: PermissionLevels.selfAndSub },\n\t\t\t\t\t)\n\t\t\t\t;\n\t\t\t}\n\n\t\t\treturn this.permissionChecker.hasPermission(\n\t\t\t\tPermissionActions.departmentChatEdit,\n\t\t\t\tthis.focusedNode,\n\t\t\t\tPermissionLevels.selfAndSub,\n\t\t\t);\n\t\t},\n\t\tcanAddChannelWithChildren(): boolean\n\t\t{\n\t\t\tif (this.isTeamEntity)\n\t\t\t{\n\t\t\t\treturn this.permissionChecker.hasPermission(\n\t\t\t\t\tPermissionActions.teamChannelEdit,\n\t\t\t\t\tthis.focusedNode,\n\t\t\t\t\t{ TEAM: PermissionLevels.selfAndSub },\n\t\t\t\t)\n\t\t\t\t\t|| this.permissionChecker.hasPermission(\n\t\t\t\t\t\tPermissionActions.teamChannelEdit,\n\t\t\t\t\t\tthis.focusedNode,\n\t\t\t\t\t\t{ DEPARTMENT: PermissionLevels.selfAndSub },\n\t\t\t\t\t)\n\t\t\t\t;\n\t\t\t}\n\n\t\t\treturn this.permissionChecker.hasPermission(\n\t\t\t\tPermissionActions.departmentChannelEdit,\n\t\t\t\tthis.focusedNode,\n\t\t\t\tPermissionLevels.selfAndSub,\n\t\t\t);\n\t\t},\n\t\tcanAddCollabWithChildren(): boolean\n\t\t{\n\t\t\tif (this.isTeamEntity)\n\t\t\t{\n\t\t\t\treturn this.permissionChecker.hasPermission(\n\t\t\t\t\tPermissionActions.teamCollabEdit,\n\t\t\t\t\tthis.focusedNode,\n\t\t\t\t\t{ TEAM: PermissionLevels.selfAndSub },\n\t\t\t\t)\n\t\t\t\t\t|| this.permissionChecker.hasPermission(\n\t\t\t\t\t\tPermissionActions.teamCollabEdit,\n\t\t\t\t\t\tthis.focusedNode,\n\t\t\t\t\t\t{ DEPARTMENT: PermissionLevels.selfAndSub },\n\t\t\t\t\t)\n\t\t\t\t;\n\t\t\t}\n\n\t\t\treturn this.permissionChecker.hasPermission(\n\t\t\t\tPermissionActions.departmentCollabEdit,\n\t\t\t\tthis.focusedNode,\n\t\t\t\tPermissionLevels.selfAndSub,\n\t\t\t);\n\t\t},\n\t\thideEmptyChatItem(): boolean\n\t\t{\n\t\t\treturn this.searchQuery.length > 0 || this.chatsNoAccess > 0;\n\t\t},\n\t\thideEmptyChannelItem(): boolean\n\t\t{\n\t\t\treturn this.searchQuery.length > 0 || this.channelsNoAccess > 0;\n\t\t},\n\t\tgetChatListDataTestIds(): Object\n\t\t{\n\t\t\treturn ChatListDataTestIds;\n\t\t},\n\t\tgetChannelListDataTestIds(): Object\n\t\t{\n\t\t\treturn ChannelListDataTestIds;\n\t\t},\n\t\tgetCollabListDataTestIds(): Object\n\t\t{\n\t\t\treturn CollabListDataTestIds;\n\t\t},\n\t\t...mapState(useChartStore, ['focusedNode', 'departments']),\n\t},\n\n\twatch:\n\t{\n\t\tareChatsLoaded(isChatsLoaded): void\n\t\t{\n\t\t\tif (isChatsLoaded === false)\n\t\t\t{\n\t\t\t\tthis.loadChatAction();\n\t\t\t}\n\t\t},\n\t},\n\n\tcreated(): void\n\t{\n\t\tthis.permissionChecker = PermissionChecker.getInstance();\n\t\tthis.loadChatAction();\n\t},\n\n\ttemplate: `\n\t\t<div class=\"hr-department-detail-content__tab-container --chat\">\n\t\t\t<template v-if=\"!showAddEmptyState\">\n\t\t\t\t<SearchInput\n\t\t\t\t\t:placeholder=\"loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_CHATS_CHAT_SEARCH_INPUT_PLACEHOLDER')\"\n\t\t\t\t\t:value=\"searchQuery\"\n\t\t\t\t\t@inputChange=\"searchChatOrChannel\"\n\t\t\t\t\tdataTestId=\"hr-department-detail-content_chats-tab__chats-and-channels-search-input\"\n\t\t\t\t/>\n\t\t\t\t<div\n\t\t\t\t\tv-if=\"!showSearchEmptyState\"\n\t\t\t\t\tclass=\"hr-department-detail-content__lists-container\"\n\t\t\t\t>\n\t\t\t\t\t<CommunicationList\n\t\t\t\t\t\tv-if=\"isCollabsAvailable\"\n\t\t\t\t\t\t:communications=\"collabs\"\n\t\t\t\t\t\t:filteredCommunications=\"filteredCollabs\"\n\t\t\t\t\t\t:communicationsNoAccess=\"collabsNoAccess\"\n\t\t\t\t\t\t:canEdit=\"canEditCollab\"\n\t\t\t\t\t\t:searchQuery=\"searchQuery\"\n\t\t\t\t\t\t:focusedNode=\"focusedNode\"\n\t\t\t\t\t\t:communicationType=\"communicationTypes.collab\"\n\t\t\t\t\t\t:isTeamEntity=\"isTeamEntity\"\n\t\t\t\t\t\t:dataTestId=\"getCollabListDataTestIds\"\n\t\t\t\t\t\t@tabListAction=\"onActionMenuItemClick\"\n\t\t\t\t\t/>\n\t\t\t\t\t<CommunicationList\n\t\t\t\t\t\t:communications=\"channels\"\n\t\t\t\t\t\t:filteredCommunications=\"filteredChannels\"\n\t\t\t\t\t\t:communicationsNoAccess=\"channelsNoAccess\"\n\t\t\t\t\t\t:canEdit=\"canEditChannel\"\n\t\t\t\t\t\t:searchQuery=\"searchQuery\"\n\t\t\t\t\t\t:focusedNode=\"focusedNode\"\n\t\t\t\t\t\t:communicationType=\"communicationTypes.channel\"\n\t\t\t\t\t\t:isTeamEntity=\"isTeamEntity\"\n\t\t\t\t\t\t:dataTestId=\"getChannelListDataTestIds\"\n\t\t\t\t\t\t@tabListAction=\"onActionMenuItemClick\"\n\t\t\t\t\t/>\n\t\t\t\t\t<CommunicationList\n\t\t\t\t\t\t:communications=\"chats\"\n\t\t\t\t\t\t:filteredCommunications=\"filteredChats\"\n\t\t\t\t\t\t:communicationsNoAccess=\"chatsNoAccess\"\n\t\t\t\t\t\t:canEdit=\"canEditChat\"\n\t\t\t\t\t\t:searchQuery=\"searchQuery\"\n\t\t\t\t\t\t:focusedNode=\"focusedNode\"\n\t\t\t\t\t\t:communicationType=\"communicationTypes.chat\"\n\t\t\t\t\t\t:isTeamEntity=\"isTeamEntity\"\n\t\t\t\t\t\t:dataTestId=\"getChatListDataTestIds\"\n\t\t\t\t\t\t@tabListAction=\"onActionMenuItemClick\"\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t\t<EmptyState \n\t\t\t\t\tv-else\n\t\t\t\t\timageClass=\"hr-department-detail-content__chat-empty-tab-search_tab-icon\"\n\t\t\t\t\t:title=\"loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_EMPTY_SEARCHED_EMPLOYEES_TITLE')\"\n\t\t\t\t\t:description =\"loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_EMPTY_SEARCHED_EMPLOYEES_SUBTITLE')\"\n\t\t\t\t/>\n\t\t\t</template>\n\t\t\t<EmptyState \n\t\t\t\tv-else\n\t\t\t\timageClass=\"hr-department-detail-content__chat-empty-tab-add_tab-icon\"\n\t\t\t\t:title=\"getAddEmptyStateTitle\"\n\t\t\t\t:list=\"getAddEmptyStateList()\"\n\t\t\t>\n\t\t\t\t<template v-slot:content>\n\t\t\t\t\t<EmptyTabAddButtons\n\t\t\t\t\t\t:isTeamEntity=\"isTeamEntity\"\n\t\t\t\t\t\t:canEditChat=\"canEditChat\"\n\t\t\t\t\t\t:canEditChannel=\"canEditChannel\"\n\t\t\t\t\t\t:canEditCollab=\"canEditCollab\"\n\t\t\t\t\t\t@emptyStateAddAction=\"onActionMenuItemClick\"\n\t\t\t\t\t/>\n\t\t\t\t</template>\n\t\t\t</EmptyState>\n\t\t\t<LinkDialog\n\t\t\t\tv-if=\"isCollabsAvailable\"\n\t\t\t\t:communications=\"collabs\"\n\t\t\t\t:communicationType=\"communicationTypes.collab\"\n\t\t\t\t:focusedNode=\"focusedNode\"\n\t\t\t\t:isTeamEntity=\"isTeamEntity\"\n\t\t\t\t:entityType=\"entityType\"\n\t\t\t\t:isVisible=\"collabLinkDialogVisible\"\n\t\t\t\t:canAddWithChildren=\"canAddCollabWithChildren\"\n\t\t\t\t@close=\"collabLinkDialogVisible = false\"\n\t\t\t\t@reloadList=\"loadChatAction(true)\"\n\t\t\t/>\n\t\t\t<LinkDialog\n\t\t\t\t:communications=\"channels\"\n\t\t\t\t:communicationType=\"communicationTypes.channel\"\n\t\t\t\t:focusedNode=\"focusedNode\"\n\t\t\t\t:isTeamEntity=\"isTeamEntity\"\n\t\t\t\t:entityType=\"entityType\"\n\t\t\t\t:isVisible=\"channelLinkDialogVisible\"\n\t\t\t\t:canAddWithChildren=\"canAddChannelWithChildren\"\n\t\t\t\t@close=\"channelLinkDialogVisible = false\"\n\t\t\t\t@reloadList=\"loadChatAction(true)\"\n\t\t\t/>\n\t\t\t<LinkDialog\n\t\t\t\t:communications=\"chats\"\n\t\t\t\t:communicationType=\"communicationTypes.chat\"\n\t\t\t\t:focusedNode=\"focusedNode\"\n\t\t\t\t:isTeamEntity=\"isTeamEntity\"\n\t\t\t\t:entityType=\"entityType\"\n\t\t\t\t:isVisible=\"chatLinkDialogVisible\"\n\t\t\t\t:canAddWithChildren=\"canAddChatWithChildren\"\n\t\t\t\t@close=\"chatLinkDialogVisible = false\"\n\t\t\t\t@reloadList=\"loadChatAction(true)\"\n\t\t\t/>\n\t\t</div>\n\t`,\n};\n","import { PermissionActions, PermissionChecker } from 'humanresources.company-structure.permission-checker';\nimport { EntityTypes } from 'humanresources.company-structure.utils';\nimport { UsersTab } from './users/tab';\nimport { ChatsTab } from './chats/tab';\nimport { useChartStore } from 'humanresources.company-structure.chart-store';\nimport { mapState } from 'ui.vue3.pinia';\n\nimport '../style.css';\n\n// @vue/component\nexport const DepartmentContent = {\n\tname: 'departmentContent',\n\n\tcomponents: { UsersTab, ChatsTab },\n\n\tprops: {\n\t\tisCollapsed: Boolean,\n\t},\n\n\temits: ['showDetailLoader', 'hideDetailLoader', 'editEmployee'],\n\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tactiveTab: 'usersTab',\n\t\t\ttabs: [\n\t\t\t\t{ name: 'usersTab', component: 'UsersTab', id: 'users-tab' },\n\t\t\t\t{ name: 'chatsTab', component: 'ChatsTab', id: 'chats-tab' },\n\t\t\t],\n\t\t\tisDescriptionOverflowed: false,\n\t\t\tisDescriptionExpanded: false,\n\t\t};\n\t},\n\n\tcomputed:\n\t{\n\t\tisCollabsAvailable(): boolean\n\t\t{\n\t\t\treturn PermissionChecker.getInstance().isCollabsAvailable;\n\t\t},\n\t\tactiveTabComponent(): UsersTab | ChatsTab | null\n\t\t{\n\t\t\tconst activeTab = this.tabs.find((tab) => tab.name === this.activeTab);\n\n\t\t\treturn activeTab ? activeTab.component : null;\n\t\t},\n\t\tusersCount(): Number\n\t\t{\n\t\t\treturn this.departments.get(this.focusedNode)?.userCount ?? 0;\n\t\t},\n\t\tcommunicationsCount(): Number\n\t\t{\n\t\t\treturn this.departments.get(this.focusedNode)?.communicationsCount ?? null;\n\t\t},\n\t\ttabArray(): Array\n\t\t{\n\t\t\treturn this.tabs.map((tab) => {\n\t\t\t\tif (tab.name === 'usersTab')\n\t\t\t\t{\n\t\t\t\t\treturn {\n\t\t\t\t\t\t...tab,\n\t\t\t\t\t\tcount: this.usersCount,\n\t\t\t\t\t};\n\t\t\t\t}\n\n\t\t\t\tif (tab.name === 'chatsTab')\n\t\t\t\t{\n\t\t\t\t\treturn {\n\t\t\t\t\t\t...tab,\n\t\t\t\t\t\tcount: this.communicationsCount,\n\t\t\t\t\t};\n\t\t\t\t}\n\n\t\t\t\treturn tab;\n\t\t\t});\n\t\t},\n\t\tdescription(): ?string\n\t\t{\n\t\t\tconst department = this.departments.get(this.focusedNode);\n\t\t\tif (!department.description)\n\t\t\t{\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\treturn department.description;\n\t\t},\n\t\tisTeamEntity(): boolean\n\t\t{\n\t\t\treturn this.departments.get(this.focusedNode)?.entityType === EntityTypes.team;\n\t\t},\n\t\t...mapState(useChartStore, ['focusedNode', 'departments']),\n\t},\n\n\twatch:\n\t{\n\t\tdescription(): void\n\t\t{\n\t\t\tthis.$nextTick(() => {\n\t\t\t\tthis.isDescriptionOverflowed = this.checkDescriptionOverflowed();\n\t\t\t});\n\t\t},\n\t\tfocusedNode(): void\n\t\t{\n\t\t\tthis.isDescriptionExpanded = false;\n\t\t\tthis.selectTab('usersTab');\n\t\t},\n\t\tisCollapsed(): void\n\t\t{\n\t\t\tthis.$nextTick(() => {\n\t\t\t\tthis.isDescriptionOverflowed = this.checkDescriptionOverflowed();\n\t\t\t});\n\t\t},\n\t},\n\n\tmethods:\n\t{\n\t\tloc(phraseCode: string, replacements: {[p: string]: string} = {}): string\n\t\t{\n\t\t\treturn this.$Bitrix.Loc.getMessage(phraseCode, replacements);\n\t\t},\n\t\tselectTab(tabName): void\n\t\t{\n\t\t\tif (this.isTabDisabled(tabName))\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tthis.activeTab = tabName;\n\t\t},\n\t\tgetTabLabel(name: string): string\n\t\t{\n\t\t\tif (name === 'usersTab')\n\t\t\t{\n\t\t\t\treturn this.isTeamEntity\n\t\t\t\t\t? this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_TEAM_USERS_TITLE')\n\t\t\t\t\t: this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_USERS_TITLE');\n\t\t\t}\n\n\t\t\tif (name === 'chatsTab')\n\t\t\t{\n\t\t\t\treturn this.isCollabsAvailable\n\t\t\t\t\t? this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_CHATS_TITLE_W_COLLABS')\n\t\t\t\t\t: this.loc('HUMANRESOURCES_COMPANY_STRUCTURE_DEPARTMENT_CONTENT_TAB_CHATS_TITLE')\n\t\t\t\t;\n\t\t\t}\n\n\t\t\treturn '';\n\t\t},\n\t\ttoggleDescriptionExpand(): void\n\t\t{\n\t\t\tthis.isDescriptionExpanded = !this.isDescriptionExpanded;\n\t\t},\n\t\tcheckDescriptionOverflowed(): boolean\n\t\t{\n\t\t\tconst descriptionContainer = this.$refs.descriptionContainer ?? null;\n\t\t\tif (descriptionContainer)\n\t\t\t{\n\t\t\t\treturn descriptionContainer.scrollHeight > descriptionContainer.clientHeight;\n\t\t\t}\n\n\t\t\treturn false;\n\t\t},\n\t\thideDetailLoader(): void\n\t\t{\n\t\t\tthis.$emit('hideDetailLoader');\n\t\t\tthis.$nextTick(() => {\n\t\t\t\tthis.isDescriptionOverflowed = this.checkDescriptionOverflowed();\n\t\t\t});\n\t\t},\n\t\tisTabDisabled(tabName: string): boolean\n\t\t{\n\t\t\tif (tabName === 'chatsTab' && this.tabArray.find((tab) => tab.name === tabName).count === 0)\n\t\t\t{\n\t\t\t\tconst permissionChecker = PermissionChecker.getInstance();\n\t\t\t\tconst canEditChats = this.isTeamEntity\n\t\t\t\t\t? (\n\t\t\t\t\t\tpermissionChecker.hasPermission(PermissionActions.teamChatEdit, this.focusedNode)\n\t\t\t\t\t\t|| permissionChecker.hasPermission(PermissionActions.teamChannelEdit, this.focusedNode)\n\t\t\t\t\t\t|| permissionChecker.hasPermission(PermissionActions.teamCollabEdit, this.focusedNode)\n\t\t\t\t\t)\n\t\t\t\t\t: (\n\t\t\t\t\t\tpermissionChecker.hasPermission(PermissionActions.departmentChatEdit, this.focusedNode)\n\t\t\t\t\t\t|| permissionChecker.hasPermission(PermissionActions.departmentChannelEdit, this.focusedNode)\n\t\t\t\t\t\t|| permissionChecker.hasPermission(PermissionActions.departmentCollabEdit, this.focusedNode)\n\t\t\t\t\t)\n\t\t\t\t;\n\n\t\t\t\tif (!canEditChats)\n\t\t\t\t{\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn false;\n\t\t},\n\t},\n\n\ttemplate: `\n\t\t<div class=\"hr-department-detail-content hr-department-detail-content__scope\">\n\t\t\t<div\n\t\t\t\tref=\"descriptionContainer\"\n\t\t\t\tv-show=\"description\"\n\t\t\t\t:class=\"[\n\t\t\t\t\t'hr-department-detail-content-description',\n\t\t\t\t\t{ '--expanded': isDescriptionExpanded },\n\t\t\t\t\t{ '--overflowed': isDescriptionOverflowed},\n\t\t\t\t]\"\n\t\t\t\tv-on=\"isDescriptionOverflowed ? { click: toggleDescriptionExpand } : {}\"\n\t\t\t>\n\t\t\t\t{{ description }}\n\t\t\t</div>\n\t\t\t<div class=\"hr-department-detail-content__tab-list\">\n\t\t\t\t<button\n\t\t\t\t\tv-for=\"tab in tabArray\"\n\t\t\t\t\t:key=\"tab.name\"\n\t\t\t\t\tclass=\"hr-department-detail-content__tab-item\"\n\t\t\t\t\t:class=\"[{'--active-tab' : activeTab === tab.name, '--disabled-tab': isTabDisabled(tab.name)}]\"\n\t\t\t\t\t@click=\"selectTab(tab.name)\"\n\t\t\t\t\t:data-id=\"tab.id ? 'hr-department-detail-content__' + tab.id + '_button' : null\"\n\t\t\t\t>\n\t\t\t\t\t{{ this.getTabLabel(tab.name) }}\n\t\t\t\t\t<span\n\t\t\t\t\t\tclass=\"hr-department-detail-content__tab-count\"\n\t\t\t\t\t\t:data-id=\"tab.id ? 'hr-department-detail-content__' + tab.id + '_counter' : null\"\n\t\t\t\t\t>{{ tab.count }}\n\t\t\t\t\t</span>\n\t\t\t\t</button>\n\t\t\t</div>\n\t\t\t<UsersTab\n\t\t\t\tv-show=\"activeTab === 'usersTab'\"\n\t\t\t\t@showDetailLoader=\"$emit('showDetailLoader')\"\n\t\t\t\t@hideDetailLoader=\"hideDetailLoader\"\n\t\t\t/>\n\t\t\t<ChatsTab\n\t\t\t\tv-show=\"activeTab === 'chatsTab'\"\n\t\t\t\t:is=\"activeTabComponent\"\n\t\t\t\t@showDetailLoader=\"$emit('showDetailLoader')\"\n\t\t\t\t@hideDetailLoader=\"hideDetailLoader\"\n\t\t\t/>\n\t\t</div>\n\t`,\n};\n"],"names":["HeadListDataTestIds","Object","freeze","containerDataTestId","listActionButtonDataTestId","listActonMenuDataTestId","listCounterDataTestId","EmployeeListDataTestIds","EmptyTabAddButton","name","components","RouteActionMenu","props","departmentId","type","Number","required","entityType","String","default","EntityTypes","department","data","menuVisible","computed","menu","EmptyUsersTabActionMenu","AnalyticsSourceType","DETAIL","mapState","useChartStore","methods","loc","phraseCode","replacements","$Bitrix","Loc","getMessage","onClick","team","items","length","onActionMenuItemClick","id","actionId","template","DepartmentAPI","getPagedEmployees","page","countPerPage","getData","nodeId","removeUserFromDepartment","userId","postData","moveUserToDepartment","targetNodeId","role","roleXmlId","isUserInMultipleDepartments","getUserInfo","fireUser","findMemberByQuery","query","getChatsAndChannels","saveChats","ids","removeIds","withChildren","saveChannel","saveCollab","UserListItemActionButton","user","ConfirmationPopup","MoveUserPopup","showRemoveUserConfirmationPopup","showRemoveUserConfirmationActionLoader","showMoveUserPopup","showMoveUserPopupOnlyMoveMode","showFireUserPopup","fireUserLoad","toggleMenu","MenuActions","isTeamEntity","moveUserToAnotherDepartment","fireUserFromCompany","removeUser","focusedNode","UI","Notification","Center","notify","content","autoHideDelay","departmentName","Text","encode","departments","get","UserService","removeUserFromEntity","rootDepartment","values","find","parentId","moveUserToEntity","cancelRemoveUser","error","code","isInvited","removeUserFromAllEntities","cancelFireUser","handleMoveUserAction","handleMoveUserClose","getMemberKeyByValue","value","keys","memberRoles","key","created","UserListActionMenu","getFirePopupDescription","userName","userUrl","url","genderSuffix","gender","phrase","description","replace","getFirePopupTitle","getFirePopupButtonText","getRemovePopupTitle","getRemovePopupDescription","UserListItem","emits","selectedUserId","listType","canDrag","Boolean","getMemberRoles","defaultAvatar","handleUserClick","item","BX","SidePanel","Instance","open","cacheable","handleMouseDown","event","preventDefault","$emit","initialListType","element","$el","EmptyState","title","imageClass","list","Array","EmptyListItem","withAddPermission","ListActionButton","menuItems","dataTestIds","itemId","TabList","count","listItems","emptyItemTitle","emptyItemImageClass","hideEmptyItem","isDropTarget","placeholderIndex","boundHandleDragOverList","needToShowCount","Type","isNumber","watch","newValue","oldValue","itemsWrapper","$refs","Runtime","throttle","handleDragOverList","bind","Event","unbind","children","querySelectorAll","mouseY","clientY","newIndex","i","child","entries","rect","getBoundingClientRect","childMidpointY","top","height","SearchInput","placeholder","dataTestId","hasFocus","handleInput","target","handleBlur","clearInput","DepartmentContentActions","updateEmployees","employees","set","updateHeads","heads","updateEmployeeListOptions","options","employeeListOptions","setChatsAndChannels","chats","channels","collabs","chatsNoAccess","channelsNoAccess","collabsNoAccess","store","channelsDetailed","chatsDetailed","collabsDetailed","communicationsCount","unbindChatFromNode","chatId","ChatTypes","collab","filter","chat","AUTOSCROLL_AREA_SIZE","UsersTab","MoveEmployeeConfirmationPopup","searchQuery","needToScroll","dragState","getInitialDragState","showDndConfirmationPopup","dndPreviousState","dndPopupDescription","boundHandleDragMove","boundHandleDragEnd","headCount","formattedHeads","map","head","subtitle","workPosition","badgeText","getBadgeText","sort","a","b","roleOrder","deputyHead","roleA","roleB","filteredHeads","toLowerCase","includes","employeeCount","memberCount","userCount","formattedEmployees","employee","reverse","filteredEmployees","mapWritableState","showSearchBar","showSearchEmptyState","canAddUsers","permissionChecker","PermissionChecker","getInstance","permission","PermissionActions","teamAddMember","employeeAddToDepartment","hasPermission","headListEmptyStateTitle","employeesListEmptyStateTitle","shouldUpdateList","departmentUsersStatus","loaded","headMenu","UsersTabActionMenu","employeeMenu","isEmployeeListOptionsSet","employeeTitle","emptyStateTitle","emptyStateDescription","isHeadListPotentialTarget","isDragging","initialList","isEmployeeListPotentialTarget","dndConfirmationPopupTitle","toHead","targetList","undefined","dndConfirmationPopupBtn","showDndRoleSelect","headListTitle","newId","isListUpdated","loadEmployeesAction","isDescriptionExpanded","searchedUserId","needToFocusUserId","$nextTick","scrollToUser","handler","immediate","newQuery","searchMembers","usersStatus","prevUsersStatus","prevDepartmentId","prevLoaded","clearSearchTimeout","autoscrollIntervalId","handleDragMove","handleDragEnd","mounted","tabContainer","updateList","employeesList","scrollPosition","scrollTop","clientHeight","scrollHeight","loadedEmployees","employeeIds","Set","newEmployees","has","unshift","selectors","querySelector","some","push","scrollIntoView","behavior","block","setTimeout","clearTimeout","findQueryResult","success","failure","nodeResults","failedQuery","startsWith","founded","newMembers","found","searchUser","onHeadListActionMenuItemClick","onEmployeeListActionMenuItemClick","getHeadListDataTestIds","getEmployeeListDataTestIds","handleItemDragStart","payload","draggedElement","offsetX","clientX","left","offsetY","ghost","cloneNode","Dom","addClass","style","append","document","body","ghostElement","u","EventEmitter","emit","events","HR_USER_DRAG_START","HR_USER_DRAG_MOVE","pageX","pageY","potentialTarget","isPointerOverElement","headList","employeeList","handleAutoscrollOnDrag","scrollableContainer","topTriggerZone","scrollSpeed","setInterval","stopAutoscroll","clearInterval","right","bottom","HR_USER_DRAG_DROP","isValidDrop","targetIndex","listRef","remove","removeClass","HR_USER_DRAG_END","context","moveDndUser","selectedRole","selectedRoleLabel","prepareDndPopupDescription","cancelDndUserMove","confirmDndUserMove","targetRole","previousRole","UserManagementDialogAPI","addUsersToDepartment","console","isTeam","basePhrase","previousState","isMovingToHeads","sourceList","targetListForMove","userIndex","findIndex","userToMove","splice","ChatsMenuOption","linkChat","linkChannel","linkCollab","ChatsMenuLinkChat","bIcon","Main","CHAT_MESSAGE","size","colorTokenName","ChatsMenuLinkChannel","SPEAKER_MOUTHPIECE","ChatsMenuLinkCollab","COLLAB","ChatListDataTestIds","ChannelListDataTestIds","CollabListDataTestIds","ChatLinkDialogDataTestIds","confirmButtonDataTestId","cancelButtonDataTestId","closeButtonDataTestId","addWithChildrenDataTestId","ChannelLinkDialogDataTestIds","CollabLinkDialogDataTestIds","EmptyTabAddButtons","canEditChat","canEditChannel","canEditCollab","ActionButtonDictionary","channel","CommunicationListItemActionButton","communication","isMenuVisible","showUnbindConfirmationPopup","unbindLoader","dictionary","ChatListActionMenu","buttonDataId","openChat","Messenger","dialogId","unbindChat","cancelUnbind","isOwn","originalNodeId","updateChatsInChildrenNodes","ItemDictionary","parentTeamHint","subtitleForTeam","parentDepartmentOfDepartmentHint","parentDepartmentOfTeamHint","subtitleForDepartment","getAvatar","avatarOptions","AvatarRound","dataTestIdPrefix","AvatarSquare","AvatarHexagonGuest","CommunicationListItem","ChatListItemActionButton","ResponsiveHint","directives","hint","Hint","avatar","originalNodeName","hiddenNodeName","structureMap","preparedIndirectSubtitle","parts","split","beforeText","afterText","lockHint","prepareAvatar","color","getColorCode","baseColor","isExtranet","click","onChatItemClick","userpicPath","hasAccess","locateToOriginalDepartment","HR_ORG_CHART_LOCATE_TO_DEPARTMENT","ListDictionary","tabListId","footerDataTestId","listTitle","noTeamText","noDepartmentText","moreHiddenText","emptyHiddenText","CommunicationList","communications","communicationsNoAccess","filteredCommunications","canEdit","communicationType","validator","CommunicationsTypeDict","communicationMenuItems","communicationsNoAccessText","locPlural","emptyCommunicationTitle","hideEmptyCommunicationItem","getMessagePlural","args","MenuOption","withoutChildren","ChildrenModeSelector","text","getControlButtonText","getValueText","getMenuItems","showMenu","itemClass","DialogDictionary","childrenModeText","getDialogEntity","getChatDialogEntity","getDialogIdFromId","getIdFromDialogId","getChannelDialogEntity","getCollabDialogEntity","LinkDialog","ManagementDialog","isVisible","canAddWithChildren","isLinkActive","addWithChildren","dialogEntities","entity","excludeIds","dialogRecentTabOptions","getCommunicationsRecentTabOptions","linkedIds","addDescription","linkEntities","mappedIds","ChatsTab","chatLinkDialogVisible","channelLinkDialogVisible","collabLinkDialogVisible","isLoading","searchChatOrChannel","loadChatAction","force","isArray","loadedChatsAndChannels","getAddEmptyStateList","stateArray","isCollabsAvailable","communicationTypes","filteredChats","filteredChannels","filteredCollabs","showAddEmptyState","areChatsLoaded","getAddEmptyStateTitle","teamChatEdit","departmentChatEdit","teamChannelEdit","departmentChannelEdit","teamCollabEdit","departmentCollabEdit","canAddChatWithChildren","TEAM","PermissionLevels","selfAndSub","DEPARTMENT","canAddChannelWithChildren","canAddCollabWithChildren","hideEmptyChatItem","hideEmptyChannelItem","getChatListDataTestIds","getChannelListDataTestIds","getCollabListDataTestIds","isChatsLoaded","DepartmentContent","isCollapsed","activeTab","tabs","component","isDescriptionOverflowed","activeTabComponent","tab","usersCount","tabArray","checkDescriptionOverflowed","selectTab","tabName","isTabDisabled","getTabLabel","toggleDescriptionExpand","descriptionContainer","hideDetailLoader","canEditChats"],"mappings":";;;;;;CAAO,MAAMA,mBAAmB,GAAGC,MAAM,CAACC,MAAM,CAAC;GAChDC,mBAAmB,EAAE,sDAAsD;GAC3EC,0BAA0B,EAAE,0DAA0D;GACtFC,uBAAuB,EAAE,kEAAkE;GAC3FC,qBAAqB,EAAE;CACxB,CAAC,CAAC;AAEF,CAAO,MAAMC,uBAAuB,GAAGN,MAAM,CAACC,MAAM,CAAC;GACpDC,mBAAmB,EAAE,0DAA0D;GAC/EC,0BAA0B,EAAE,8DAA8D;GAC1FC,uBAAuB,EAAE,sEAAsE;GAC/FC,qBAAqB,EAAE;CACxB,CAAC,CAAC;;CCDK,MAAME,iBAAiB,GAAG;GAChCC,IAAI,EAAE,qBAAqB;GAE3BC,UAAU,EAAE;sBAAEC;IAAiB;GAE/BC,KAAK,EAAE;KACNC,YAAY,EAAE;OACbC,IAAI,EAAEC,MAAM;OACZC,QAAQ,EAAE;MACV;KACDC,UAAU,EAAE;OACXH,IAAI,EAAEI,MAAM;OACZC,OAAO,EAAEC,iDAAW,CAACC;;IAEtB;GAEDC,IAAI,GACJ;KACC,OAAO;OACNC,WAAW,EAAE;MACb;IACD;GAEDC,QAAQ,EAAE;KACTC,IAAI,GACJ;OACC,OAAO,IAAIC,gEAAuB,CAAC,IAAI,CAACb,YAAY,EAAEc,uDAAmB,CAACC,MAAM,EAAE,IAAI,EAAE,IAAI,CAACX,UAAU,CAAC;MACxG;KACD,GAAGY,sBAAQ,CAACC,wDAAa,EAAE,CAAC,aAAa,CAAC;IAC1C;GAEDC,OAAO,EACP;KACCC,GAAG,CAACC,UAAkB,EAAEC,YAAmC,GAAG,EAAE,EAChE;OACC,OAAO,IAAI,CAACC,OAAO,CAACC,GAAG,CAACC,UAAU,CAACJ,UAAU,EAAEC,YAAY,CAAC;MAC5D;KACDI,OAAO,GACP;OACC,IAAK,IAAI,CAACrB,UAAU,KAAKG,iDAAW,CAACmB,IAAI,IAAM,IAAI,CAACd,IAAI,CAACe,KAAK,CAACC,MAAM,KAAK,CAAE,EAC5E;;SAEC,IAAI,CAACC,qBAAqB,CAAC,IAAI,CAACjB,IAAI,CAACe,KAAK,CAAC,CAAC,CAAC,CAACG,EAAE,CAAC;QACjD,MAED;SACC,IAAI,CAACpB,WAAW,GAAG,IAAI;;MAExB;KACDmB,qBAAqB,CAACE,QAAgB,EACtC;OACC,IAAI,CAACnB,IAAI,CAACiB,qBAAqB,CAACE,QAAQ,CAAC;;IAE1C;GAEDC,QAAQ,EAAG;;;;;;;;;;;;;;;;;;;;;CAqBZ,CAAC;;CCpFM,MAAMC,aAAa,GAAG;GAC5BC,iBAAiB,EAAE,CAACJ,EAAU,EAAEK,IAAY,EAAEC,YAAoB,KAAK;KACtE,OAAOC,2CAAO,CAAC,wDAAwD,EAAE;OAAEC,MAAM,EAAER,EAAE;OAAEK,IAAI;OAAEC;MAAc,CAAC;IAC5G;GACDG,wBAAwB,EAAE,CAACD,MAAc,EAAEE,MAAc,KAAoB;KAC5E,OAAOC,4CAAQ,CAAC,qDAAqD,EAAE;OACtEH,MAAM;OACNE;MACA,CAAC;IACF;GACDE,oBAAoB,EAAE,CAACJ,MAAc,EAAEE,MAAc,EAAEG,YAAoB,EAAEC,IAAY,KAAoB;KAC5G,OAAOH,4CAAQ,CAAC,mDAAmD,EAAE;OACpEH,MAAM;OACNE,MAAM;OACNG,YAAY;OACZE,SAAS,EAAED;MACX,CAAC;IACF;GACDE,2BAA2B,EAAGN,MAAc,IAAoB;KAC/D,OAAOH,2CAAO,CAAC,qDAAqD,EAAE;OACrEG;MACA,CAAC;IACF;GACDO,WAAW,EAAE,CAACT,MAAc,EAAEE,MAAc,KAAoB;KAC/D,OAAOH,2CAAO,CAAC,6CAA6C,EAAE;OAC7DC,MAAM;OACNE;MACA,CAAC;IACF;GACDQ,QAAQ,EAAGR,MAAc,IAAoB;KAC5C,OAAOC,4CAAQ,CAAC,oBAAoB,EAAE;OACrCD;MACA,CAAC;IACF;GACDS,iBAAiB,EAAE,CAACX,MAAc,EAAEY,KAAa,KAAoB;KACpE,OAAOb,2CAAO,CAAC,+CAA+C,EAAE;OAC/DC,MAAM;OACNY;MACA,CAAC;IACF;GACDC,mBAAmB,EAAGb,MAAc,IAAgC;KACnE,OAAOD,2CAAO,CAAC,uDAAuD,EAAE;OACvEC;MACA,CAAC;IACF;GACDc,SAAS,EAAE,CACVd,MAAc,EACde,GAAa,EACbC,SAAmB,EACnBC,YAAoB,GAAG,CAAC,KACJ;KACpB,OAAOd,4CAAQ,CAAC,4DAA4D,EAAE;OAC7EH,MAAM;OACNe,GAAG;OACHC,SAAS;OACTC;MACA,CAAC;IACF;GACDC,WAAW,EAAE,CACZlB,MAAc,EACde,GAAa,EACbC,SAAmB,EACnBC,YAAoB,GAAG,CAAC,KACJ;KACpB,OAAOd,4CAAQ,CAAC,+DAA+D,EAAE;OAChFH,MAAM;OACNe,GAAG;OACHC,SAAS;OACTC;MACA,CAAC;IACF;GACDE,UAAU,EAAE,CACXnB,MAAc,EACde,GAAa,EACbC,SAAmB,EACnBC,YAAoB,GAAG,CAAC,KACJ;KACpB,OAAOd,4CAAQ,CAAC,8DAA8D,EAAE;OAC/EH,MAAM;OACNe,GAAG;OACHC,SAAS;OACTC;MACA,CAAC;;CAEJ,CAAC;;CC3EM,MAAMG,wBAAwB,GAAG;GACvC9D,IAAI,EAAE,UAAU;GAEhBG,KAAK,EAAE;KACN4D,IAAI,EAAE;OACL1D,IAAI,EAAEb,MAAM;OACZe,QAAQ,EAAE;MACV;KACDH,YAAY,EAAE;OACbC,IAAI,EAAEC,MAAM;OACZC,QAAQ,EAAE;;IAEX;GAEDN,UAAU,EAAE;sBACXC,mEAAe;wBACf8D,qEAAiB;oBACjBC;IACA;GAEDpD,IAAI,GACJ;KACC,OAAO;OACNC,WAAW,EAAE,EAAE;OACfoD,+BAA+B,EAAE,KAAK;OACtCC,sCAAsC,EAAE,KAAK;OAC7CC,iBAAiB,EAAE,KAAK;OACxBC,6BAA6B,EAAE,KAAK;OACpCC,iBAAiB,EAAE,KAAK;OACxBC,YAAY,EAAE;MACd;IACD;GAEDjD,OAAO,EAAE;KACRkD,UAAU,CAAC5B,MAAM,EACjB;OACC,IAAI,CAAC9B,WAAW,CAAC8B,MAAM,CAAC,GAAG,CAAC,IAAI,CAAC9B,WAAW,CAAC8B,MAAM,CAAC;MACpD;KACDrB,GAAG,CAACC,UAAkB,EAAEC,YAAqC,GAAG,EAAE,EAClE;OACC,OAAO,IAAI,CAACC,OAAO,CAACC,GAAG,CAACC,UAAU,CAACJ,UAAU,EAAEC,YAAY,CAAC;MAC5D;KACDQ,qBAAqB,CAACE,QAAgB,EACtC;OACC,IAAIA,QAAQ,KAAKsC,oDAAW,CAAC9B,wBAAwB,EACrD;SACC,IAAI,IAAI,CAAC+B,YAAY,EACrB;WACC,IAAI,CAACR,+BAA+B,GAAG,IAAI;UAC3C,MAED;WACC,IAAI,CAACG,6BAA6B,GAAG,KAAK;WAC1C,IAAI,CAACD,iBAAiB,GAAG,IAAI;;;OAI/B,IAAIjC,QAAQ,KAAKsC,oDAAW,CAACE,2BAA2B,EACxD;SACC,IAAI,CAACN,6BAA6B,GAAG,IAAI;SACzC,IAAI,CAACD,iBAAiB,GAAG,IAAI;;OAG9B,IAAIjC,QAAQ,KAAKsC,oDAAW,CAACG,mBAAmB,EAChD;SACC,IAAI,CAACN,iBAAiB,GAAG,IAAI;;MAE9B;KACD,MAAMO,UAAU,GAChB;OAAA;OACC,IAAI,CAACV,sCAAsC,GAAG,IAAI;OAClD,MAAMvB,MAAM,GAAG,IAAI,CAACmB,IAAI,CAAC7B,EAAE;OAC3B,MAAMgB,2BAA2B,GAAG,MAAMb,aAAa,CAACa,2BAA2B,CAACN,MAAM,CAAC;OAC3F,MAAMxC,YAAY,GAAG,IAAI,CAAC0E,WAAW;OACrC,IAAI,CAACX,sCAAsC,GAAG,KAAK;OACnD,IAAI,CAACD,+BAA+B,GAAG,KAAK;OAC5C,IAAI,CAACE,iBAAiB,GAAG,KAAK;OAE9B,IACA;SACC,MAAM/B,aAAa,CAACM,wBAAwB,CAACvC,YAAY,EAAEwC,MAAM,CAAC;QAClE,CACD,MACA;SACC,MAAMpB,UAAU,GAAG,IAAI,CAACkD,YAAY,GACjC,IAAI,CAACnD,GAAG,CAAC,uGAAuG,CAAC,GACjH,IAAI,CAACA,GAAG,CAAC,6GAA6G,CAAC;SAE1HwD,kBAAE,CAACC,YAAY,CAACC,MAAM,CAACC,MAAM,CAAC;WAC7BC,OAAO,EAAE3D,UAAU;WACnB4D,aAAa,EAAE;UACf,CAAC;SAEF;;OAGD,MAAM5D,UAAU,GAAG,IAAI,CAACkD,YAAY,GACjC,yGAAyG,GACzG,+GAA+G;OAClH,MAAMW,cAAc,GAAGC,cAAI,CAACC,MAAM,0BAAC,IAAI,CAACC,WAAW,CAACC,GAAG,CAAC,IAAI,CAACX,WAAW,CAAC,CAAC9E,IAAI,oCAAI,EAAE,CAAC;OACrF+E,kBAAE,CAACC,YAAY,CAACC,MAAM,CAACC,MAAM,CAAC;SAC7BC,OAAO,EAAE,IAAI,CAAC5D,GAAG,CAACC,UAAU,EAAE;WAAE,mBAAmB,EAAE6D;UAAgB,CAAC;SACtED,aAAa,EAAE;QACf,CAAC;OAEF,MAAMpC,IAAI,GAAG,IAAI,CAACe,IAAI,CAACf,IAAI;OAC3B,IAAIE,2BAA2B,IAAI,IAAI,CAACwB,YAAY,EACpD;SACCgB,sDAAW,CAACC,oBAAoB,CAACvF,YAAY,EAAEwC,MAAM,EAAEI,IAAI,CAAC;SAE5D;;OAGD,MAAM4C,cAAc,GAAG,CAAC,GAAG,IAAI,CAACJ,WAAW,CAACK,MAAM,EAAE,CAAC,CAACC,IAAI,CAAElF,UAAU,IAAKA,UAAU,CAACmF,QAAQ,KAAK,CAAC,CAAC;OACrG,IAAI,CAACH,cAAc,EACnB;SACC;;OAGDF,sDAAW,CAACM,gBAAgB,CAC3B5F,YAAY,EACZwC,MAAM,EACNgD,cAAc,CAAC1D,EAAE,EACjBc,IAAI,CACJ;MACD;KACDiD,gBAAgB,GAChB;OACC,IAAI,CAAC/B,+BAA+B,GAAG,KAAK;MAC5C;KACD,MAAMd,QAAQ,GACd;OACC,IAAI,CAACmB,YAAY,GAAG,IAAI;OAExB,MAAM3B,MAAM,GAAG,IAAI,CAACmB,IAAI,CAAC7B,EAAE;OAE3B,IACA;SACC,MAAMG,aAAa,CAACe,QAAQ,CAACR,MAAM,CAAC;QACpC,CACD,OAAOsD,KAAK,EACZ;SACC,IAAIA,KAAK,CAACC,IAAI,KAAK,yBAAyB,EAC5C;WACCpB,kBAAE,CAACC,YAAY,CAACC,MAAM,CAACC,MAAM,CAAC;aAC7BC,OAAO,EAAE,IAAI,CAACpB,IAAI,CAACqC,SAAS,GACzB,IAAI,CAAC7E,GAAG,CAAC,6FAA6F,CAAC,GACvG,IAAI,CAACA,GAAG,CAAC,2FAA2F,CAAC;aACxG6D,aAAa,EAAE;YACf,CAAC;;SAGH,IAAI,CAACd,iBAAiB,GAAG,KAAK;SAC9B,IAAI,CAACC,YAAY,GAAG,KAAK;SAEzB;;OAGDmB,sDAAW,CAACC,oBAAoB,CAAC,IAAI,CAACb,WAAW,EAAElC,MAAM,EAAE,IAAI,CAACmB,IAAI,CAACf,IAAI,CAAC;OAC1E,MAAM0C,sDAAW,CAACW,yBAAyB,CAACzD,MAAM,CAAC;OACnD,IAAI,CAAC0B,iBAAiB,GAAG,KAAK;OAC9B,IAAI,CAACC,YAAY,GAAG,KAAK;MACzB;KACD+B,cAAc,GACd;OACC,IAAI,CAAChC,iBAAiB,GAAG,KAAK;MAC9B;KACDiC,oBAAoB,GACpB;OACC,IAAI,CAACnC,iBAAiB,GAAG,KAAK;MAC9B;KACDoC,mBAAmB,GACnB;OACC,IAAI,CAACpC,iBAAiB,GAAG,KAAK;MAC9B;KACDqC,mBAAmB,CAACC,KAAa,EACjC;OACC,OAAOlH,MAAM,CAACmH,IAAI,CAACC,+CAAW,CAAC,CAACd,IAAI,CAAEe,GAAG,IAAKD,+CAAW,CAACC,GAAG,CAAC,KAAKH,KAAK,CAAC,IAAI,EAAE;;IAEhF;GAEDI,OAAO,GACP;KACC,IAAI,CAAC9F,IAAI,GAAG,IAAI+F,2DAAkB,CAAC,IAAI,CAACjC,WAAW,EAAE,IAAI,CAACtE,UAAU,EAAE,IAAI,CAACuD,IAAI,CAACqC,SAAS,CAAC;IAC1F;GAEDrF,QAAQ,EAAE;KACT,GAAGK,sBAAQ,CAACC,wDAAa,EAAE,CAAC,aAAa,EAAE,aAAa,CAAC,CAAC;KAC1DuF,WAAW,GACX;OACC,OAAOA,+CAAW;MAClB;KACDI,uBAAuB,GACvB;OAAA;OACC,MAAMC,QAAQ,GAAG3B,cAAI,CAACC,MAAM,oBAAC,IAAI,CAACxB,IAAI,CAAC/D,IAAI,8BAAI,EAAE,CAAC;OAClD,MAAMkH,OAAO,GAAG5B,cAAI,CAACC,MAAM,mBAAC,IAAI,CAACxB,IAAI,CAACoD,GAAG,6BAAI,EAAE,CAAC;OAChD,MAAMC,YAAY,GAAG,IAAI,CAACrD,IAAI,CAACsD,MAAM,KAAK,GAAG,GAAG,IAAI,GAAG,IAAI;OAE3D,MAAMC,MAAM,GAAG,IAAI,CAACvD,IAAI,CAACqC,SAAS,GAC9B,0GAAyGgB,YAAa,EAAC,GACvH,wGAAuGA,YAAa,EAAC;OAGzH,MAAMG,WAAW,GAAG,IAAI,CAAChG,GAAG,CAAC+F,MAAM,EAAE;SACpC,aAAa,EAAEL;QACf,CAAC;OAEF,OAAOM,WAAW,CAACC,OAAO,CAAC,QAAQ,EAAG,iEAAgEN,OAAQ,IAAG,CAAC,CAChHM,OAAO,CAAC,SAAS,EAAE,MAAM,CAAC;MAE5B;KACDC,iBAAiB,GACjB;OACC,OAAO,IAAI,CAAC1D,IAAI,CAACqC,SAAS,GACvB,IAAI,CAAC7E,GAAG,CAAC,mGAAmG,CAAC,GAC7G,IAAI,CAACA,GAAG,CAAC,iGAAiG,CAAC;MAC9G;KACDmG,sBAAsB,GACtB;OACC,OAAO,IAAI,CAAC3D,IAAI,CAACqC,SAAS,GACvB,IAAI,CAAC7E,GAAG,CAAC,4GAA4G,CAAC,GACtH,IAAI,CAACA,GAAG,CAAC,0GAA0G,CAAC;MACvH;KACDoG,mBAAmB,GACnB;OACC,OAAO,IAAI,CAACjD,YAAY,GACrB,IAAI,CAACnD,GAAG,CAAC,6GAA6G,CAAC,GACvH,IAAI,CAACA,GAAG,CAAC,mHAAmH,CAAC;MAChI;KACDqG,yBAAyB,GACzB;OAAA;OACC,MAAMvC,cAAc,GAAGC,cAAI,CAACC,MAAM,2BAAC,IAAI,CAACC,WAAW,CAACC,GAAG,CAAC,IAAI,CAACX,WAAW,CAAC,CAAC9E,IAAI,qCAAI,EAAE,CAAC;OACrF,MAAMiH,QAAQ,GAAG3B,cAAI,CAACC,MAAM,qBAAC,IAAI,CAACxB,IAAI,CAAC/D,IAAI,+BAAI,EAAE,CAAC;OAElD,IAAI,IAAI,CAAC0E,YAAY,EACrB;SACC,MAAMlD,UAAU,GAAG,mHAAmH;SACtI,MAAM4F,YAAY,GAAG,IAAI,CAACrD,IAAI,CAACsD,MAAM,KAAK,GAAG,GAAG,IAAI,GAAG,IAAI;SAE3D,OAAO,IAAI,CAAC9F,GAAG,CACdC,UAAU,GAAG4F,YAAY,EACzB;WACC,aAAa,EAAEH,QAAQ;WACvB,mBAAmB,EAAE5B;UACrB,CACD,CACCmC,OAAO,CACP,QAAQ,EACP,iFAAgF,IAAI,CAACzD,IAAI,CAACoD,GAAI,IAAG,CAClG,CACAK,OAAO,CAAC,SAAS,EAAE,MAAM,CAAC;;OAI7B,OAAO,IAAI,CAACjG,GAAG,CAAC,yHAAyH,CAAC;MAC1I;KACDf,UAAU,GACV;OAAA;OACC,iCAAO,IAAI,CAACgF,WAAW,CAACC,GAAG,CAAC,IAAI,CAACX,WAAW,CAAC,qBAAtC,uBAAwCtE,UAAU;MACzD;KACDkE,YAAY,GACZ;OACC,OAAO,IAAI,CAAClE,UAAU,KAAKG,iDAAW,CAACmB,IAAI;;IAE5C;GAEDM,QAAQ,EAAG;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;CAmEZ,CAAC;;CChVM,MAAMyF,YAAY,GAAG;GAC3B7H,IAAI,EAAE,UAAU;GAChB8H,KAAK,EAAE,CAAC,eAAe,CAAC;GACxB3H,KAAK,EAAE;KACN4D,IAAI,EAAE;OACL1D,IAAI,EAAEb,MAAM;OACZe,QAAQ,EAAE;MACV;KACDwH,cAAc,EAAE;OACf1H,IAAI,EAAEC,MAAM;OACZC,QAAQ,EAAE,KAAK;OACfG,OAAO,EAAE;MACT;KACDF,UAAU,EAAE;OACXH,IAAI,EAAEI,MAAM;OACZF,QAAQ,EAAE;MACV;KACDyH,QAAQ,EAAE;OACT3H,IAAI,EAAEI,MAAM;OACZF,QAAQ,EAAE;MACV;KACD0H,OAAO,EAAE;OACR5H,IAAI,EAAE6H,OAAO;OACbxH,OAAO,EAAE;;IAEV;GAEDT,UAAU,EAAE;KAAE6D;IAA0B;GAExC/C,QAAQ,EAAE;KACT6F,WAAW,GACX;OACC,OAAOuB,kDAAc,CAAC,IAAI,CAAC3H,UAAU,CAAC;MACtC;KACD4H,aAAa,GACb;OACC,OAAO,mFAAmF;MAC1F;KACD,GAAGhH,sBAAQ,CAACC,wDAAa,EAAE,CAAC,aAAa,CAAC;IAC1C;GAEDC,OAAO,EAAE;KACRC,GAAG,CAACC,UAAkB,EAAEC,YAAqC,GAAG,EAAE,EAClE;OACC,OAAO,IAAI,CAACC,OAAO,CAACC,GAAG,CAACC,UAAU,CAACJ,UAAU,EAAEC,YAAY,CAAC;MAC5D;KACD4G,eAAe,CAACC,IAAI,EACpB;OACCC,EAAE,CAACC,SAAS,CAACC,QAAQ,CAACC,IAAI,CAACJ,IAAI,CAACnB,GAAG,EAAE;SACpCwB,SAAS,EAAE;QACX,CAAC;MACF;KACDC,eAAe,CAACC,KAAiB,EACjC;OACCA,KAAK,CAACC,cAAc,EAAE;OAEtB,IAAI,CAACC,KAAK,CAAC,eAAe,EAAE;SAC3BnG,MAAM,EAAE,IAAI,CAACmB,IAAI,CAAC7B,EAAE;SACpB8G,eAAe,EAAE,IAAI,CAAChB,QAAQ;SAC9Ba,KAAK;SACLI,OAAO,EAAE,IAAI,CAACC;QACd,CAAC;;IAEH;GAED9G,QAAQ,EAAG;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;CAgDZ,CAAC;;CCvHM,MAAM+G,UAAU,GAAG;GACzBnJ,IAAI,EAAE,YAAY;GAElBG,KAAK,EAAE;KACNiJ,KAAK,EAAE;OACN/I,IAAI,EAAEI,MAAM;OACZF,QAAQ,EAAE;MACV;KACD8I,UAAU,EAAE;OACXhJ,IAAI,EAAEI,MAAM;OACZF,QAAQ,EAAE;MACV;KACDgH,WAAW,EAAE;OACZlH,IAAI,EAAEI,MAAM;OACZF,QAAQ,EAAE;MACV;KACD+I,IAAI,EAAE;OACLjJ,IAAI,EAAEkJ,KAAK;OACXhJ,QAAQ,EAAE,KAAK;OACfG,OAAO,EAAE;;IAEV;GAEDY,OAAO,EAAE;KACRC,GAAG,CAACC,UAAkB,EAAEC,YAAmC,GAAG,EAAE,EAChE;OACC,OAAO,IAAI,CAACC,OAAO,CAACC,GAAG,CAACC,UAAU,CAACJ,UAAU,EAAEC,YAAY,CAAC;;IAE7D;GAEDW,QAAQ,EAAG;;;;;;;;;;;;;;;;;;;;;;;CAuBZ,CAAC;;CCtDM,MAAMoH,aAAa,GAAG;GAC5BxJ,IAAI,EAAE,kBAAkB;GAExBG,KAAK,EAAE;KACNiJ,KAAK,EAAE;OACN/I,IAAI,EAAEI,MAAM;OACZF,QAAQ,EAAE;MACV;KACD8I,UAAU,EAAE;OACXhJ,IAAI,EAAEI,MAAM;OACZF,QAAQ,EAAE;MACV;KACDkJ,iBAAiB,EAAE;OAClBpJ,IAAI,EAAE6H,OAAO;OACb3H,QAAQ,EAAE,KAAK;OACfG,OAAO,EAAE;;IAEV;GAED0B,QAAQ,EAAG;;;;;;;;;;CAUZ,CAAC;;CC1BM,MAAMsH,gBAAgB,GAAG;GAC/B1J,IAAI,EAAE,sBAAsB;GAC5B8H,KAAK,EAAE,CAAC,eAAe,EAAE,OAAO,CAAC;GAEjC3H,KAAK,EACJ;KACC+B,EAAE,EAAE;OACH7B,IAAI,EAAEI,MAAM;OACZF,QAAQ,EAAE;MACV;KACDoJ,SAAS,EAAE;OACVtJ,IAAI,EAAEkJ,KAAK;OACXhJ,QAAQ,EAAE;MACV;KACDqJ,WAAW,EAAE;OACZvJ,IAAI,EAAEb,MAAM;OACZe,QAAQ,EAAE,KAAK;OACfG,OAAO,EAAE;;IAEV;GAEFT,UAAU,EACV;sBACCC;IACA;GAEDa,QAAQ,EACR;KACC,GAAGK,sBAAQ,CAACC,wDAAa,EAAE,CAAC,aAAa,CAAC;IAC1C;GAEDR,IAAI,GACJ;KACC,OAAO;OACNC,WAAW,EAAE;MACb;IACD;GAEDQ,OAAO,EAAE;KACRC,GAAG,CAACC,UAAkB,EAAEC,YAAqC,GAAG,EAAE,EAClE;OACC,OAAO,IAAI,CAACC,OAAO,CAACC,GAAG,CAACC,UAAU,CAACJ,UAAU,EAAEC,YAAY,CAAC;MAC5D;KACDQ,qBAAqB,CAAC4H,MAAc,EACpC;OACC,IAAI,CAACd,KAAK,CAAC,eAAe,EAAEc,MAAM,CAAC;;IAEpC;GAEDzH,QAAQ,EAAG;;;;;;;;;;;;;;;;;;;;;;CAsBZ,CAAC;;CCpEM,MAAM0H,OAAO,GAAG;GACtB9J,IAAI,EAAE,SAAS;GACfC,UAAU,EAAE;KAAEyJ,gBAAgB;KAAEF;IAAe;GAC/C1B,KAAK,EAAE,CAAC,eAAe,CAAC;GAExB3H,KAAK,EAAE;KACN+B,EAAE,EAAE;OACH7B,IAAI,EAAEI,MAAM;OACZF,QAAQ,EAAE;MACV;KACD6I,KAAK,EAAE;OACN/I,IAAI,EAAEI,MAAM;OACZF,QAAQ,EAAE;MACV;KACDwJ,KAAK,EAAE;OACN1J,IAAI,EAAEC,MAAM;OACZC,QAAQ,EAAE;MACV;KACDoJ,SAAS,EAAE;OACVtJ,IAAI,EAAEkJ,KAAK;OACXhJ,QAAQ,EAAE,KAAK;OACfG,OAAO,EAAE;MACT;KACDsJ,SAAS,EAAE;OACV3J,IAAI,EAAEkJ,KAAK;OACXhJ,QAAQ,EAAE;MACV;KACD0J,cAAc,EAAE;OACf5J,IAAI,EAAEI,MAAM;OACZF,QAAQ,EAAE;MACV;KACD2J,mBAAmB,EAAE;OACpB7J,IAAI,EAAEI,MAAM;OACZF,QAAQ,EAAE;MACV;KACD4J,aAAa,EAAE;OACd9J,IAAI,EAAE6H,OAAO;OACb3H,QAAQ,EAAE,KAAK;OACfG,OAAO,EAAE;MACT;KACD+I,iBAAiB,EAAE;OAClBpJ,IAAI,EAAE6H,OAAO;OACb3H,QAAQ,EAAE,KAAK;OACfG,OAAO,EAAE;MACT;;KAEDkJ,WAAW,EAAE;OACZvJ,IAAI,EAAEb,MAAM;OACZe,QAAQ,EAAE,KAAK;OACfG,OAAO,EAAE;MACT;KACD0J,YAAY,EAAE;OACb/J,IAAI,EAAE6H,OAAO;OACbxH,OAAO,EAAE;MACT;KACDsH,QAAQ,EAAE;OACT3H,IAAI,EAAEI;;IAEP;GAEDI,IAAI,GACJ;KACC,OAAO;OACNwJ,gBAAgB,EAAE,IAAI;OACtBC,uBAAuB,EAAE;MACzB;IACD;GAEDvJ,QAAQ,EAAE;KACTwJ,eAAe,GACf;OACC,OAAOC,cAAI,CAACC,QAAQ,CAAC,IAAI,CAACV,KAAK,CAAC;;IAEjC;GAEDW,KAAK,EAAE;KACNN,YAAY,CAACO,QAAQ,EAAEC,QAAQ,EAC/B;OACC,IAAID,QAAQ,KAAKC,QAAQ,EACzB;SACC;;OAED,MAAMC,YAAY,GAAG,IAAI,CAACC,KAAK,CAACD,YAAY;OAC5C,IAAI,CAACA,YAAY,EACjB;SACC;;OAGD,IAAIF,QAAQ,EACZ;SACC,IAAI,CAACL,uBAAuB,GAAGS,iBAAO,CAACC,QAAQ,CAAC,IAAI,CAACC,kBAAkB,CAACC,IAAI,CAAC,IAAI,CAAC,EAAE,EAAE,CAAC;SACvFC,eAAK,CAACD,IAAI,CAACL,YAAY,EAAE,WAAW,EAAE,IAAI,CAACP,uBAAuB,CAAC;SAEnE,IAAI,IAAI,CAACN,SAAS,CAAChI,MAAM,KAAK,CAAC,EAC/B;WACC,IAAI,CAACqI,gBAAgB,GAAG,CAAC;;QAE1B,MAED;SACCc,eAAK,CAACC,MAAM,CAACP,YAAY,EAAE,WAAW,EAAE,IAAI,CAACP,uBAAuB,CAAC;SACrE,IAAI,CAACA,uBAAuB,GAAG,IAAI;SACnC,IAAI,CAACD,gBAAgB,GAAG,IAAI;;;IAG9B;GAED/I,OAAO,EAAE;KACRW,qBAAqB,CAACE,QAAgB,EACtC;OACC,IAAI,CAAC4G,KAAK,CAAC,eAAe,EAAE5G,QAAQ,CAAC;MACrC;KACD8I,kBAAkB,CAACpC,KAAiB,EACpC;OACC,IAAI,CAAC,IAAI,CAACuB,YAAY,IAAI,CAAC,IAAI,CAACU,KAAK,CAACD,YAAY,EAClD;SACC,IAAI,IAAI,CAACR,gBAAgB,KAAK,IAAI,EAClC;WACC,IAAI,CAACA,gBAAgB,GAAG,IAAI;;SAG7B;;OAGD,MAAMQ,YAAY,GAAG,IAAI,CAACC,KAAK,CAACD,YAAY;OAC5C,MAAMQ,QAAQ,GAAG,CAAC,GAAGR,YAAY,CAACS,gBAAgB,CAAC,gEAAgE,CAAC,CAAC;OACrH,MAAMC,MAAM,GAAG1C,KAAK,CAAC2C,OAAO;OAE5B,IAAIH,QAAQ,CAACrJ,MAAM,KAAK,CAAC,EACzB;SACC,IAAI,IAAI,CAACqI,gBAAgB,KAAK,CAAC,EAC/B;WACC,IAAI,CAACA,gBAAgB,GAAG,CAAC;;SAG1B;;OAGD,IAAIoB,QAAQ,GAAGJ,QAAQ,CAACrJ,MAAM;OAE9B,KAAK,MAAM,CAAC0J,CAAC,EAAEC,KAAK,CAAC,IAAIN,QAAQ,CAACO,OAAO,EAAE,EAC3C;SACC,MAAMC,IAAI,GAAGF,KAAK,CAACG,qBAAqB,EAAE;SAC1C,MAAMC,cAAc,GAAGF,IAAI,CAACG,GAAG,GAAGH,IAAI,CAACI,MAAM,GAAG,CAAC;SAEjD,IAAIV,MAAM,GAAGQ,cAAc,EAC3B;WACCN,QAAQ,GAAGC,CAAC;WACZ;;;OAIF,IAAID,QAAQ,KAAK,IAAI,CAACpB,gBAAgB,EACtC;SACC,IAAI,CAACA,gBAAgB,GAAGoB,QAAQ;;;IAGlC;GAEDrJ,QAAQ,EAAG;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;CA6CZ,CAAC;;CCjNM,MAAM8J,WAAW,GAAG;GAC1BlM,IAAI,EAAE,aAAa;GACnBG,KAAK,EAAE;KACNuG,KAAK,EAAE;OACNrG,IAAI,EAAEI,MAAM;OACZF,QAAQ,EAAE,KAAK;OACfG,OAAO,EAAE;MACT;KACDyL,WAAW,EAAE;OACZ9L,IAAI,EAAEI,MAAM;OACZF,QAAQ,EAAE;MACV;KACD6L,UAAU,EAAE;OACX/L,IAAI,EAAEI,MAAM;OACZF,QAAQ,EAAE;;IAEX;GAEDM,IAAI,GACJ;KACC,OAAO;OACNwL,QAAQ,EAAE;MACV;IACD;GAED/K,OAAO,EAAE;KACRgL,WAAW,CAACzD,KAAiB,EAC7B;OACC,IAAI,CAACE,KAAK,CAAC,aAAa,EAAEF,KAAK,CAAC0D,MAAM,CAAC7F,KAAK,CAAC;MAC7C;KACD8F,UAAU,GACV;OACC,IAAI,IAAI,CAAC9F,KAAK,CAAC1E,MAAM,KAAK,CAAC,EAC3B;SACC,IAAI,CAACqK,QAAQ,GAAG,KAAK;;MAEtB;KACDI,UAAU,GACV;OACC,IAAI,CAACJ,QAAQ,GAAG,KAAK;OACrB,IAAI,CAACtD,KAAK,CAAC,aAAa,EAAE,EAAE,CAAC;;IAE9B;GAED3G,QAAQ,EAAG;;;;;;;;;;;;;;;;;;;;;;;CAuBZ,CAAC;;OClEYsK,wBAAwB,GAAG;GACvCC,eAAe,EAAE,CAACvM,YAAoB,EAAEwM,SAAgB,KAAW;KAClE,MAAM;OAAEpH;MAAa,GAAGnE,wDAAa,EAAE;KACvC,MAAMT,UAAU,GAAG4E,WAAW,CAACC,GAAG,CAACrF,YAAY,CAAC;KAEhD,IAAI,CAACQ,UAAU,EACf;OACC;;KAGD4E,WAAW,CAACqH,GAAG,CAACzM,YAAY,EAAE;OAAE,GAAGQ,UAAU;OAAEgM;MAAW,CAAC;IAC3D;GACDE,WAAW,EAAE,CAAC1M,YAAoB,EAAE2M,KAAY,KAAW;KAC1D,MAAM;OAAEvH;MAAa,GAAGnE,wDAAa,EAAE;KACvC,MAAMT,UAAU,GAAG4E,WAAW,CAACC,GAAG,CAACrF,YAAY,CAAC;KAEhD,IAAI,CAACQ,UAAU,EACf;OACC;;KAGD4E,WAAW,CAACqH,GAAG,CAACzM,YAAY,EAAE;OAAE,GAAGQ,UAAU;OAAEmM;MAAO,CAAC;IACvD;GACDC,yBAAyB,EAAE,CAC1B5M,YAAoB,EACpB6M,OAA+E,KACrE;KACV,MAAM;OAAEzH;MAAa,GAAGnE,wDAAa,EAAE;KACvC,MAAMT,UAAU,GAAG4E,WAAW,CAACC,GAAG,CAACrF,YAAY,CAAC;KAEhD,IAAI,CAACQ,UAAU,EACf;OACC;;KAGDA,UAAU,CAACsM,mBAAmB,GAAG;OAChC,GAAGtM,UAAU,CAACsM,mBAAmB;OACjC,GAAGD;MACH;KAEDzH,WAAW,CAACqH,GAAG,CAACzM,YAAY,EAAEQ,UAAU,CAAC;IACzC;GACDuM,mBAAmB,EAAE,CACpBzK,MAAc,EACd0K,KAAmC,EACnCC,QAAsC,EACtCC,OAAqC,EACrCC,aAAqB,GAAG,CAAC,EACzBC,gBAAwB,GAAG,CAAC,EAC5BC,eAAuB,GAAG,CAAC,KACjB;KACV,MAAMC,KAAK,GAAGrM,wDAAa,EAAE;KAC7B,MAAMT,UAAU,GAAG8M,KAAK,CAAClI,WAAW,CAACC,GAAG,CAAC/C,MAAM,CAAC;KAChD,IAAI,CAAC9B,UAAU,EACf;OACC;;KAGDA,UAAU,CAAC+M,gBAAgB,GAAGN,QAAQ;KACtCzM,UAAU,CAACgN,aAAa,GAAGR,KAAK;KAChCxM,UAAU,CAACiN,eAAe,GAAGP,OAAO;KACpC1M,UAAU,CAAC4M,gBAAgB,GAAGA,gBAAgB;KAC9C5M,UAAU,CAAC2M,aAAa,GAAGA,aAAa;KACxC3M,UAAU,CAAC6M,eAAe,GAAGA,eAAe;KAC5C7M,UAAU,CAACkN,mBAAmB,GAAGV,KAAK,CAACpL,MAAM,GAAGqL,QAAQ,CAACrL,MAAM,GAAGsL,OAAO,CAACtL,MAAM,GAC7EuL,aAAa,GAAGC,gBAAgB,GAAGC,eAAe;IAErD;GACDM,kBAAkB,EAAE,CAACrL,MAAc,EAAEsL,MAAc,EAAE3N,IAAY,KAAW;KAC3E,MAAMqN,KAAK,GAAGrM,wDAAa,EAAE;KAC7B,MAAMT,UAAU,GAAG8M,KAAK,CAAClI,WAAW,CAACC,GAAG,CAAC/C,MAAM,CAAC;KAChD,IAAI,CAAC9B,UAAU,EACf;OACC;;KAGD,IAAIP,IAAI,KAAK4N,+CAAS,CAACC,MAAM,EAC7B;OACCtN,UAAU,CAACiN,eAAe,GAAGjN,UAAU,CAACiN,eAAe,CAACM,MAAM,CAAEC,IAAI,IAAKA,IAAI,CAAClM,EAAE,KAAK8L,MAAM,CAAC;MAC5F,MAED;OACCpN,UAAU,CAAC+M,gBAAgB,GAAG/M,UAAU,CAAC+M,gBAAgB,CAACQ,MAAM,CAAEC,IAAI,IAAKA,IAAI,CAAClM,EAAE,KAAK8L,MAAM,CAAC;OAC9FpN,UAAU,CAACgN,aAAa,GAAGhN,UAAU,CAACgN,aAAa,CAACO,MAAM,CAAEC,IAAI,IAAKA,IAAI,CAAClM,EAAE,KAAK8L,MAAM,CAAC;;KAEzFpN,UAAU,CAACkN,mBAAmB,EAAE;;CAElC,CAAC;;CC7DD,MAAMO,oBAAoB,GAAG,EAAE;;CAE/B;AACA,CAAO,MAAMC,QAAQ,GAAG;GACvBtO,IAAI,EAAE,UAAU;GAEhBC,UAAU,EAAE;KACXiM,WAAW;KACX/C,UAAU;KACVW,OAAO;KACP/J,iBAAiB;KACjB8H,YAAY;oCACZ0G;IACA;GAEDzG,KAAK,EAAE,CAAC,kBAAkB,EAAE,kBAAkB,CAAC;GAE/CjH,IAAI,GACJ;KACC,OAAO;OACN2N,WAAW,EAAE,EAAE;OACfzG,cAAc,EAAE,IAAI;OACpB0G,YAAY,EAAE,KAAK;OACnBC,SAAS,EAAE,IAAI,CAACC,mBAAmB,EAAE;OACrCC,wBAAwB,EAAE,KAAK;OAC/BC,gBAAgB,EAAE,IAAI;OACtBC,mBAAmB,EAAE,EAAE;OACvBC,mBAAmB,EAAE,IAAI;OACzBC,kBAAkB,EAAE;MACpB;IACD;GAEDjO,QAAQ,EAAE;KACT6F,WAAW,GACX;OACC,OAAOuB,kDAAc,CAAC,IAAI,CAAC3H,UAAU,CAAC;MACtC;KACDuM,KAAK,GACL;OAAA;OACC,gCAAO,IAAI,CAACvH,WAAW,CAACC,GAAG,CAAC,IAAI,CAACX,WAAW,CAAC,CAACiI,KAAK,oCAAI,EAAE;MACzD;KACDkC,SAAS,GACT;OAAA;OACC,6BAAO,IAAI,CAAClC,KAAK,CAAC/K,MAAM,iCAAI,CAAC;MAC7B;KACD5B,YAAY,GACZ;OACC,OAAO,IAAI,CAAC0E,WAAW;MACvB;KACDoK,cAAc,GACd;OACC,OAAO,IAAI,CAACnC,KAAK,CAACoC,GAAG,CAAEC,IAAI,KAAM;SAChC,GAAGA,IAAI;SACPC,QAAQ,EAAED,IAAI,CAACE,YAAY;SAC3BC,SAAS,EAAE,IAAI,CAACC,YAAY,CAACJ,IAAI,CAACpM,IAAI;QACtC,CAAC,CAAC,CAACyM,IAAI,CAAC,CAACC,CAAC,EAAEC,CAAC,KAAK;SAClB,MAAMC,SAAS,GAAG;WACjB,CAAC,IAAI,CAAChJ,WAAW,CAACwI,IAAI,GAAG,CAAC;WAC1B,CAAC,IAAI,CAACxI,WAAW,CAACiJ,UAAU,GAAG;UAC/B;SAED,MAAMC,KAAK,GAAGF,SAAS,CAACF,CAAC,CAAC1M,IAAI,CAAC,IAAI,CAAC;SACpC,MAAM+M,KAAK,GAAGH,SAAS,CAACD,CAAC,CAAC3M,IAAI,CAAC,IAAI,CAAC;SAEpC,OAAO8M,KAAK,GAAGC,KAAK;QACpB,CAAC;MACF;KACDC,aAAa,GACb;OACC,OAAO,IAAI,CAACd,cAAc,CAACf,MAAM,CAC/BiB,IAAI;SAAA;SAAA,OAAKA,IAAI,CAACpP,IAAI,CAACiQ,WAAW,EAAE,CAACC,QAAQ,CAAC,IAAI,CAAC1B,WAAW,CAACyB,WAAW,EAAE,CAAC,2BACtEb,IAAI,CAACE,YAAY,qBAAjB,mBAAmBW,WAAW,EAAE,CAACC,QAAQ,CAAC,IAAI,CAAC1B,WAAW,CAACyB,WAAW,EAAE,CAAC;SAC7E;MACD;KACDE,aAAa,GACb;OAAA;OACC,MAAMC,WAAW,6BAAG,IAAI,CAAC5K,WAAW,CAACC,GAAG,CAAC,IAAI,CAACX,WAAW,CAAC,CAACuL,SAAS,qCAAI,CAAC;OAEzE,OAAOD,WAAW,uBAAI,IAAI,CAACnB,SAAS,8BAAI,CAAC,CAAC;MAC1C;KACDqB,kBAAkB,GAClB;OACC,OAAO,IAAI,CAAC1D,SAAS,CAACuC,GAAG,CAAEoB,QAAQ,KAAM;SACxC,GAAGA,QAAQ;SACXlB,QAAQ,EAAEkB,QAAQ,CAACjB;QACnB,CAAC,CAAC,CAACkB,OAAO,EAAE;MACb;KACDC,iBAAiB,GACjB;OACC,OAAO,IAAI,CAACH,kBAAkB,CAACnC,MAAM,CACnCoC,QAAQ;SAAA;SAAA,OAAKA,QAAQ,CAACvQ,IAAI,CAACiQ,WAAW,EAAE,CAACC,QAAQ,CAAC,IAAI,CAAC1B,WAAW,CAACyB,WAAW,EAAE,CAAC,8BAC9EM,QAAQ,CAACjB,YAAY,qBAArB,sBAAuBW,WAAW,EAAE,CAACC,QAAQ,CAAC,IAAI,CAAC1B,WAAW,CAACyB,WAAW,EAAE,CAAC;SACjF;MACD;KACDG,WAAW,GACX;OAAA;OACC,iCAAO,IAAI,CAAC5K,WAAW,CAACC,GAAG,CAAC,IAAI,CAACX,WAAW,CAAC,CAACuL,SAAS,qCAAI,CAAC;MAC5D;KACD,GAAGjP,sBAAQ,CAACC,wDAAa,EAAE,CAAC,aAAa,EAAE,aAAa,EAAE,gBAAgB,CAAC,CAAC;KAC5E,GAAGqP,8BAAgB,CAACrP,wDAAa,EAAE,CAAC,gBAAgB,CAAC,CAAC;KACtDuL,SAAS,GACT;OAAA;OACC,2DAAO,IAAI,CAACpH,WAAW,CAACC,GAAG,CAAC,IAAI,CAACX,WAAW,CAAC,qBAAtC,uBAAwC8H,SAAS,qCAAI,EAAE;MAC9D;KACD+D,aAAa,GACb;OACC,OAAO,IAAI,CAACP,WAAW,GAAG,CAAC;MAC3B;KACDQ,oBAAoB,GACpB;OACC,OAAO,IAAI,CAACZ,aAAa,CAAChO,MAAM,KAAK,CAAC,IAAI,IAAI,CAACyO,iBAAiB,CAACzO,MAAM,KAAK,CAAC;MAC7E;KACD6O,WAAW,GACX;OACC,MAAMC,iBAAiB,GAAGC,mEAAiB,CAACC,WAAW,EAAE;OACzD,IAAI,CAACF,iBAAiB,EACtB;SACC,OAAO,KAAK;;OAGb,MAAMpO,MAAM,GAAG,IAAI,CAACoC,WAAW;OAC/B,MAAMmM,UAAU,GAAG,IAAI,CAACvM,YAAY,GACjCwM,mEAAiB,CAACC,aAAa,GAC/BD,mEAAiB,CAACE,uBAAuB;OAG5C,OAAON,iBAAiB,CAACO,aAAa,CAACJ,UAAU,EAAEvO,MAAM,CAAC;MAC1D;KACD4O,uBAAuB,GACvB;OACC,IAAI,IAAI,CAACT,WAAW,EACpB;SACC,OAAO,IAAI,CAACnM,YAAY,GACrB,IAAI,CAACnD,GAAG,CAAC,+FAA+F,CAAC,GACzG,IAAI,CAACA,GAAG,CAAC,0FAA0F,CAAC;;OAGxG,OAAO,IAAI,CAACmD,YAAY,GACrB,IAAI,CAACnD,GAAG,CAAC,sHAAsH,CAAC,GAChI,IAAI,CAACA,GAAG,CAAC,iHAAiH,CAAC;MAC9H;KACDgQ,4BAA4B,GAC5B;OACC,IAAI,IAAI,CAACV,WAAW,EACpB;SACC,OAAO,IAAI,CAACnM,YAAY,GACrB,IAAI,CAACnD,GAAG,CAAC,mGAAmG,CAAC,GAC7G,IAAI,CAACA,GAAG,CAAC,8FAA8F,CAAC;;OAG5G,OAAO,IAAI,CAACmD,YAAY,GACrB,IAAI,CAACnD,GAAG,CAAC,0HAA0H,CAAC,GACpI,IAAI,CAACA,GAAG,CAAC,qHAAqH,CAAC;MAClI;KACDiQ,gBAAgB,GAChB;OAAA;OACC,2DAAO,IAAI,CAAChM,WAAW,CAACC,GAAG,CAAC,IAAI,CAACX,WAAW,CAAC,CAACoI,mBAAmB,qBAA1D,uBAA4DsE,gBAAgB,qCAAI,IAAI;MAC3F;KACDC,qBAAqB,GACrB;OACC,MAAM7Q,UAAU,GAAG,IAAI,CAAC4E,WAAW,CAACC,GAAG,CAAC,IAAI,CAACX,WAAW,CAAC;OACzD,IAAIlE,UAAU,YAAVA,UAAU,CAAEmM,KAAK,IAAInM,UAAU,CAACgM,SAAS,EAC7C;SACC,OAAO;WAAExM,YAAY,EAAE,IAAI,CAAC0E,WAAW;WAAE4M,MAAM,EAAE;UAAM;;OAGxD,OAAO;SAAEtR,YAAY,EAAE,IAAI,CAAC0E,WAAW;SAAE4M,MAAM,EAAE;QAAO;MACxD;KACDC,QAAQ,GACR;OACC,OAAO,IAAIC,2DAAkB,CAC5B,IAAI,CAAC9M,WAAW,EAChB5D,uDAAmB,CAACC,MAAM,EAC1B,MAAM,EACN,IAAI,CAACX,UAAU,CACf;MACD;KACDqR,YAAY,GACZ;OACC,OAAO,IAAID,2DAAkB,CAC5B,IAAI,CAAC9M,WAAW,EAChB5D,uDAAmB,CAACC,MAAM,EAC1B,UAAU,EACV,IAAI,CAACX,UAAU,CACf;MACD;KACDsR,wBAAwB,GACxB;OACC,MAAMlR,UAAU,GAAG,IAAI,CAAC4E,WAAW,CAACC,GAAG,CAAC,IAAI,CAACX,WAAW,CAAC,IAAI,EAAE;OAE/D,OAAOlE,UAAU,CAACsM,mBAAmB,IAAI1N,MAAM,CAACmH,IAAI,CAAC/F,UAAU,CAACsM,mBAAmB,CAAC,CAAClL,MAAM,GAAG,CAAC;MAC/F;KACD+P,aAAa,GACb;OACC,OAAO,IAAI,CAACrN,YAAY,GACrB,IAAI,CAACnD,GAAG,CAAC,wFAAwF,CAAC,GAClG,IAAI,CAACA,GAAG,CAAC,mFAAmF,CAAC;MAChG;KACDf,UAAU,GACV;OAAA;OACC,iCAAO,IAAI,CAACgF,WAAW,CAACC,GAAG,CAAC,IAAI,CAACX,WAAW,CAAC,qBAAtC,uBAAwCtE,UAAU;MACzD;KACDkE,YAAY,GACZ;OACC,OAAO,IAAI,CAAClE,UAAU,KAAKG,iDAAW,CAACmB,IAAI;MAC3C;KACDkQ,eAAe,GACf;OACC,OAAO,IAAI,CAACtN,YAAY,GACrB,IAAI,CAACnD,GAAG,CAAC,yFAAyF,CAAC,GACnG,IAAI,CAACA,GAAG,CAAC,oFAAoF,CAAC;MACjG;KACD0Q,qBAAqB,GACrB;OACC,IAAI,IAAI,CAACpB,WAAW,EACpB;SACC,OAAO,IAAI,CAACnM,YAAY,GACrB,IAAI,CAACnD,GAAG,CAAC,4FAA4F,CAAC,GACtG,IAAI,CAACA,GAAG,CAAC,uFAAuF,CAAC;;;;OAIrG,OAAO,IAAI,CAACmD,YAAY,GACrB,EAAE,GACF,IAAI,CAACnD,GAAG,CAAC,uFAAuF,CAAC;MACpG;KACD2Q,yBAAyB,GACzB;OACC,OAAO,IAAI,CAACxD,SAAS,CAACyD,UAAU,IAC5B,IAAI,CAACzD,SAAS,CAAC0D,WAAW,KAAK,WAAW;MAE9C;KACDC,6BAA6B,GAC7B;OACC,OAAO,IAAI,CAAC3D,SAAS,CAACyD,UAAU,KAC3B,IAAI,CAACzD,SAAS,CAAC0D,WAAW,KAAK,MAAM,IAAI,IAAI,CAAC1D,SAAS,CAAC0D,WAAW,KAAK,YAAY,CAAC;MAE1F;KACDE,yBAAyB,GACzB;OACC,MAAMC,MAAM,GAAG,IAAI,CAAC7D,SAAS,CAAC8D,UAAU,KAAK,MAAM;OAEnD,OAAOD,MAAM,GACVE,SAAS,GACT,IAAI,CAAClR,GAAG,CAAC,iFAAiF,CAAC;MAC9F;KACDmR,uBAAuB,GACvB;OACC,MAAMH,MAAM,GAAG,IAAI,CAAC7D,SAAS,CAAC8D,UAAU,KAAK,MAAM;OAEnD,OAAOD,MAAM,GACV,IAAI,CAAChR,GAAG,CAAC,uFAAuF,CAAC,GACjG,IAAI,CAACA,GAAG,CAAC,+EAA+E,CAAC;MAC5F;KACDoR,iBAAiB,GACjB;OACC,OAAO,IAAI,CAACjE,SAAS,CAAC8D,UAAU,KAAK,MAAM;MAC3C;KACDI,aAAa,GACb;OACC,OAAO,IAAI,CAAClO,YAAY,GACrB,IAAI,CAACnD,GAAG,CAAC,oFAAoF,CAAC,GAC9F,IAAI,CAACA,GAAG,CAAC,+EAA+E,CAAC;;IAG7F;GAEDmJ,KAAK,EAAE;KACN5F,WAAW,CAAC+N,KAAa,EACzB;OACC,MAAMjS,UAAU,GAAG,IAAI,CAAC4E,WAAW,CAACC,GAAG,CAACoN,KAAK,CAAC,IAAI,EAAE;OACpD,IAAI,CAAC,IAAI,CAACf,wBAAwB,EAClC;SACC,MAAM5E,mBAAmB,GAAG;WAC3B3K,IAAI,EAAE,CAAC;WACPiP,gBAAgB,EAAE,IAAI;WACtBsB,aAAa,EAAE;UACf;SACDpG,wBAAwB,CAACM,yBAAyB,CAAC6F,KAAK,EAAE3F,mBAAmB,CAAC;SAC9E,IAAI,CAAC1H,WAAW,CAACqH,GAAG,CAACgG,KAAK,EAAEjS,UAAU,CAAC;;OAGxC,IACCA,UAAU,CAACsM,mBAAmB,CAAC3K,IAAI,KAAK,CAAC,IACtC3B,UAAU,CAACsM,mBAAmB,CAAC4F,aAAa,KAAK,KAAK,IACtDlS,UAAU,CAACsM,mBAAmB,CAACsE,gBAAgB,KAAK,IAAI,EAE5D;SACC,IAAI,CAACuB,mBAAmB,EAAE;;OAG3B,IAAI,CAACC,qBAAqB,GAAG,KAAK;OAClC,IAAI,CAACxE,WAAW,GAAG,EAAE;OAErB,IAAI,IAAI,CAACyE,cAAc,EACvB;SACC,IAAI,CAACC,iBAAiB,GAAG,IAAI,CAACD,cAAc;SAC5C,IAAI,CAACE,SAAS,CAAC,MAAM;WACpB,IAAI,CAACC,YAAY,EAAE;UACnB,CAAC;;MAEH;KACDH,cAAc,EAAE;OACfI,OAAO,CAACzQ,MAAc,EACtB;SACC,IAAI,CAACA,MAAM,EACX;WACC;;SAGD,IAAI,CAACsQ,iBAAiB,GAAGtQ,MAAM;SAC/B,IAAI,IAAI,CAACkQ,aAAa,EACtB;WACC,IAAI,CAACrE,YAAY,GAAG,IAAI;UACxB,MAED;WACC,IAAI,CAAC0E,SAAS,CAAC,MAAM;aACpB,IAAI,CAACC,YAAY,EAAE;YACnB,CAAC;;QAEH;OACDE,SAAS,EAAE;MACX;KACD,MAAM9E,WAAW,CAAC+E,QAAgB,EAClC;OACC,MAAM,IAAI,CAACC,aAAa,CAACD,QAAQ,CAAC;MAClC;KACD9B,qBAAqB,CAACgC,WAAkC,EAAEC,eAAsC,EAChG;OACC,MAAM;SAAEtT,YAAY;SAAEsR;QAAQ,GAAG+B,WAAW;OAC5C,MAAM;SAAErT,YAAY,EAAEuT,gBAAgB;SAAEjC,MAAM,EAAEkC;QAAY,GAAGF,eAAe;OAC9E,IAAItT,YAAY,KAAKuT,gBAAgB,IAAIjC,MAAM,KAAKkC,UAAU,EAC9D;SACC;;OAGD,IAAIlC,MAAM,EACV;SACC,IAAI,CAAC3I,KAAK,CAAC,kBAAkB,CAAC;QAC9B,MAED;SACC,IAAI,CAACA,KAAK,CAAC,kBAAkB,CAAC;SAC9B,IAAI,CAACgK,mBAAmB,EAAE;;;IAG5B;GAEDjM,OAAO,GACP;KACC,IAAI,CAACiM,mBAAmB,EAAE;KAC1B,IAAI,CAACc,kBAAkB,GAAG,IAAI;KAC9B,IAAI,CAACC,oBAAoB,GAAG,IAAI;KAEhC,IAAI,CAAC/E,mBAAmB,GAAG,IAAI,CAACgF,cAAc,CAAC7I,IAAI,CAAC,IAAI,CAAC;KACzD,IAAI,CAAC8D,kBAAkB,GAAG,IAAI,CAACgF,aAAa,CAAC9I,IAAI,CAAC,IAAI,CAAC;IACvD;GAED+I,OAAO,GACP;KACC,IAAI,CAACC,YAAY,GAAG,IAAI,CAACpJ,KAAK,CAAC,eAAe,CAAC;IAC/C;GAEDxJ,OAAO,EAAE;KACRC,GAAG,CAACC,UAAU,EAAEC,YAAY,GAAG,EAAE,EACjC;OACC,OAAO,IAAI,CAACC,OAAO,CAACC,GAAG,CAACC,UAAU,CAACJ,UAAU,EAAEC,YAAY,CAAC;MAC5D;KACD+N,YAAY,CAACxM,IAAI,EACjB;OACC,IAAIA,IAAI,KAAK,IAAI,CAAC4D,WAAW,CAACwI,IAAI,EAClC;SACC,OAAO,IAAI,CAAC1K,YAAY,GACrB,IAAI,CAACnD,GAAG,CAAC,+EAA+E,CAAC,GACzF,IAAI,CAACA,GAAG,CAAC,0EAA0E,CAAC;;OAIxF,IAAIyB,IAAI,KAAK,IAAI,CAAC4D,WAAW,CAACiJ,UAAU,EACxC;SACC,OAAO,IAAI,CAACnL,YAAY,GACrB,IAAI,CAACnD,GAAG,CAAC,sFAAsF,CAAC,GAChG,IAAI,CAACA,GAAG,CAAC,iFAAiF,CAAC;;OAI/F,OAAO,IAAI;MACX;KACD4S,UAAU,CAACtL,KAAK,EAChB;OACC,MAAMuL,aAAa,GAAGvL,KAAK,CAAC0D,MAAM;OAClC,MAAM8H,cAAc,GAAGD,aAAa,CAACE,SAAS,GAAGF,aAAa,CAACG,YAAY;OAE3E,IAAIH,aAAa,CAACI,YAAY,GAAGH,cAAc,GAAG,EAAE,EACpD;SACC,IAAI,CAACtB,mBAAmB,EAAE;;MAE3B;KACD,MAAMA,mBAAmB,GACzB;OAAA;OACC,MAAMrQ,MAAM,GAAG,IAAI,CAACoC,WAAW;OAE/B,IAAI,CAAC,IAAI,CAACU,WAAW,CAACC,GAAG,CAAC/C,MAAM,CAAC,EACjC;SACC;;OAGD,MAAMwK,mBAAmB,6BAAG,IAAI,CAAC1H,WAAW,CAACC,GAAG,CAAC/C,MAAM,CAAC,CAACwK,mBAAmB,qCAAI,EAAE;OAElFA,mBAAmB,CAAC3K,IAAI,4BAAG2K,mBAAmB,CAAC3K,IAAI,oCAAI,CAAC;OACxD2K,mBAAmB,CAACsE,gBAAgB,6BAAGtE,mBAAmB,CAACsE,gBAAgB,qCAAI,IAAI;OACnFtE,mBAAmB,CAAC4F,aAAa,6BAAG5F,mBAAmB,CAAC4F,aAAa,qCAAI,KAAK;OAC9EpG,wBAAwB,CAACM,yBAAyB,CAACtK,MAAM,EAAEwK,mBAAmB,CAAC;OAC/E,IAAIA,mBAAmB,CAAC4F,aAAa,IAAI,CAAC5F,mBAAmB,CAACsE,gBAAgB,EAC9E;SACC;;OAGD,IACC,CAACtE,mBAAmB,CAAC4F,aAAa,IAC/B5F,mBAAmB,CAAC3K,IAAI,KAAK,CAAC,IAC9B2K,mBAAmB,CAACsE,gBAAgB,KAAK,IAAI,EAEjD;SACC,IAAI,CAACzI,KAAK,CAAC,kBAAkB,CAAC;;OAG/BmE,mBAAmB,CAAC4F,aAAa,GAAG,IAAI;OACxC5F,mBAAmB,CAAC3K,IAAI,IAAI,CAAC;OAC7BmK,wBAAwB,CAACM,yBAAyB,CAACtK,MAAM,EAAEwK,mBAAmB,CAAC;OAE/E,IAAIuH,eAAe,GAAG,MAAMpS,aAAa,CAACC,iBAAiB,CAACI,MAAM,EAAEwK,mBAAmB,CAAC3K,IAAI,EAAE,EAAE,CAAC;OAEjG,IAAI,CAACkS,eAAe,EACpB;SACCvH,mBAAmB,CAACsE,gBAAgB,GAAG,KAAK;SAC5CtE,mBAAmB,CAAC4F,aAAa,GAAG,KAAK;SACzCpG,wBAAwB,CAACM,yBAAyB,CAACtK,MAAM,EAAEwK,mBAAmB,CAAC;SAE/E;;OAGDuH,eAAe,GAAGA,eAAe,CAACtF,GAAG,CAAEpL,IAAI,IAAK;SAC/C,OAAO;WAAE,GAAGA,IAAI;WAAEf,IAAI,EAAE,IAAI,CAAC4D,WAAW,CAAC2J;UAAU;QACnD,CAAC;OAEF,MAAM3D,SAAS,yDAAG,IAAI,CAACpH,WAAW,CAACC,GAAG,CAAC/C,MAAM,CAAC,qBAA5B,wBAA8BkK,SAAS,sCAAI,EAAE;OAC/D,MAAM8H,WAAW,GAAG,IAAIC,GAAG,CAAC/H,SAAS,CAACuC,GAAG,CAAEoB,QAAQ,IAAKA,QAAQ,CAACrO,EAAE,CAAC,CAAC;OAErE,MAAM0S,YAAY,GAAGH,eAAe,CAACjE,OAAO,EAAE,CAACrC,MAAM,CAAEoC,QAAQ,IAAK,CAACmE,WAAW,CAACG,GAAG,CAACtE,QAAQ,CAACrO,EAAE,CAAC,CAAC;OAClG0K,SAAS,CAACkI,OAAO,CAAC,GAAGF,YAAY,CAAC;OAClC1H,mBAAmB,CAACsE,gBAAgB,GAAGoD,YAAY,CAAC5S,MAAM,KAAK,EAAE;OACjEkL,mBAAmB,CAAC4F,aAAa,GAAG,KAAK;OAEzCpG,wBAAwB,CAACM,yBAAyB,CAACtK,MAAM,EAAEwK,mBAAmB,CAAC;OAC/ER,wBAAwB,CAACC,eAAe,CAACjK,MAAM,EAAEkK,SAAS,CAAC;OAC3D,IAAI,IAAI,CAAC6E,qBAAqB,CAACC,MAAM,EACrC;SACC,IAAI,CAAC3I,KAAK,CAAC,kBAAkB,CAAC;;OAG/B,IAAI,IAAI,CAAC0F,YAAY,EACrB;SACC,IAAI,CAAC2E,YAAY,EAAE;;MAEpB;KACD,MAAMA,YAAY,GAClB;OACC,MAAMxQ,MAAM,GAAG,IAAI,CAACsQ,iBAAiB;OACrC,IAAI,CAACA,iBAAiB,GAAG,IAAI;OAC7B,IAAI,CAACzE,YAAY,GAAG,KAAK;OACzB,MAAMsG,SAAS,GAAI,6FAA4FnS,MAAO,SAAQ;OAC9H,IAAIqG,OAAO,GAAG,IAAI,CAACiL,YAAY,CAACc,aAAa,CAACD,SAAS,CAAC;OAExD,IAAI,CAAC9L,OAAO,EACZ;SACC,IAAIlF,IAAI,GAAG,IAAI;SACf,IACA;WACCA,IAAI,GAAG,MAAM1B,aAAa,CAACc,WAAW,CAAC,IAAI,CAAC2B,WAAW,EAAElC,MAAM,CAAC;UAChE,CACD,MACA;SAEA,MAAMhC,UAAU,GAAG,IAAI,CAAC4E,WAAW,CAACC,GAAG,CAAC,IAAI,CAACX,WAAW,CAAC;SACzD,IAAI,CAACf,IAAI,IAAI,CAACnD,UAAU,EACxB;WACC;;SAGD,IAAImD,IAAI,CAACf,IAAI,KAAK,IAAI,CAAC4D,WAAW,CAACwI,IAAI,IAAIrL,IAAI,CAACf,IAAI,KAAK,IAAI,CAAC4D,WAAW,CAACiJ,UAAU,EACpF;WAAA;WACCjP,UAAU,CAACmM,KAAK,wBAAGnM,UAAU,CAACmM,KAAK,gCAAI,EAAE;WACzC,IAAI,CAACnM,UAAU,CAACmM,KAAK,CAACkI,IAAI,CAAE7F,IAAI,IAAKA,IAAI,CAAClN,EAAE,KAAK6B,IAAI,CAAC7B,EAAE,CAAC,EACzD;aACC;;UAED,MAED;WAAA;WACCtB,UAAU,CAACgM,SAAS,4BAAGhM,UAAU,CAACgM,SAAS,oCAAI,EAAE;WACjD,IAAI,CAAChM,UAAU,CAACgM,SAAS,CAACqI,IAAI,CAAE1E,QAAQ,IAAKA,QAAQ,CAACrO,EAAE,KAAK6B,IAAI,CAAC7B,EAAE,CAAC,EACrE;aACCtB,UAAU,CAACgM,SAAS,CAACsI,IAAI,CAACnR,IAAI,CAAC;;;;;SAKjC,MAAM,IAAI,CAACoP,SAAS,CAAC,MAAM;WAC1BlK,OAAO,GAAG,IAAI,CAACiL,YAAY,CAACc,aAAa,CAACD,SAAS,CAAC;UACpD,CAAC;;OAGH,IAAI,CAAC9L,OAAO,EACZ;SACC;;OAGDA,OAAO,CAACkM,cAAc,CAAC;SAAEC,QAAQ,EAAE,QAAQ;SAAEC,KAAK,EAAE;QAAU,CAAC;OAC/DC,UAAU,CAAC,MAAM;SAChB,IAAI,CAACvN,cAAc,GAAGnF,MAAM;QAC5B,EAAE,GAAG,CAAC;OAEP,IAAI,IAAI,CAACiR,kBAAkB,EAC3B;SACC0B,YAAY,CAAC,IAAI,CAAC1B,kBAAkB,CAAC;;OAGtC,IAAI,CAACA,kBAAkB,GAAGyB,UAAU,CAAC,MAAM;SAC1C,IAAI,IAAI,CAACrC,cAAc,KAAKrQ,MAAM,EAClC;WACC,IAAI,CAACmF,cAAc,GAAG,IAAI;WAC1B,IAAI,CAACkL,cAAc,GAAG,IAAI;;QAE3B,EAAE,IAAI,CAAC;MACR;KACD,MAAMO,aAAa,CAAClQ,KAAK,EACzB;OACC,IAAIA,KAAK,CAACtB,MAAM,KAAK,CAAC,EACtB;SACC;;OAGD,IAAI,CAACwT,eAAe,GAAG,IAAI,CAACA,eAAe,IAAI,EAAE;OACjD,IAAI,CAACA,eAAe,CAAC,IAAI,CAAC1Q,WAAW,CAAC,GAAG,IAAI,CAAC0Q,eAAe,CAAC,IAAI,CAAC1Q,WAAW,CAAC,IAAI;SAClF2Q,OAAO,EAAE,EAAE;SACXC,OAAO,EAAE;QACT;OAED,MAAMC,WAAW,GAAG,IAAI,CAACH,eAAe,CAAC,IAAI,CAAC1Q,WAAW,CAAC;OAE1D,IAAI6Q,WAAW,CAACD,OAAO,CAACT,IAAI,CAAEW,WAAW,IAAKtS,KAAK,CAACuS,UAAU,CAACD,WAAW,CAAC,CAAC,EAC5E;SACC;;OAGD,IAAID,WAAW,CAACF,OAAO,CAACvF,QAAQ,CAAC5M,KAAK,CAAC,IAAIqS,WAAW,CAACD,OAAO,CAACxF,QAAQ,CAAC5M,KAAK,CAAC,EAC9E;SACC;;OAGD,MAAMwS,OAAO,GAAG,MAAMzT,aAAa,CAACgB,iBAAiB,CAAC,IAAI,CAACyB,WAAW,EAAExB,KAAK,CAAC;OAE9E,IAAIwS,OAAO,CAAC9T,MAAM,KAAK,CAAC,EACxB;SACC2T,WAAW,CAACD,OAAO,CAACR,IAAI,CAAC5R,KAAK,CAAC;SAE/B;;OAGD,MAAM1C,UAAU,GAAG,IAAI,CAAC4E,WAAW,CAACC,GAAG,CAAC,IAAI,CAACX,WAAW,CAAC;OACzD,MAAMiR,UAAU,GAAGD,OAAO,CAAC3H,MAAM,CAAE6H,KAAK,IAAK,CAACpV,UAAU,CAACmM,KAAK,CAACkI,IAAI,CAAE7F,IAAI,IAAKA,IAAI,CAAClN,EAAE,KAAK8T,KAAK,CAAC9T,EAAE,CAAC,IAC/F,CAACtB,UAAU,CAACgM,SAAS,CAACqI,IAAI,CAAE1E,QAAQ,IAAKA,QAAQ,CAACrO,EAAE,KAAK8T,KAAK,CAAC9T,EAAE,CAAC,CAAC;OAEvEtB,UAAU,CAACgM,SAAS,CAACsI,IAAI,CAAC,GAAGa,UAAU,CAAC;OACxCJ,WAAW,CAACF,OAAO,CAACP,IAAI,CAAC5R,KAAK,CAAC;MAC/B;KACD2S,UAAU,CAACzH,WAAmB,EAC9B;OACC,IAAI,CAACA,WAAW,GAAGA,WAAW;MAC9B;KACD0H,6BAA6B,CAAC/T,QAAgB,EAC9C;OACC,IAAI,CAACwP,QAAQ,CAAC1P,qBAAqB,CAACE,QAAQ,CAAC;MAC7C;KACDgU,iCAAiC,CAAChU,QAAgB,EAClD;OACC,IAAI,CAAC0P,YAAY,CAAC5P,qBAAqB,CAACE,QAAQ,CAAC;MACjD;KACDiU,sBAAsB,GACtB;OACC,OAAO7W,mBAAmB;MAC1B;KACD8W,0BAA0B,GAC1B;OACC,OAAOvW,uBAAuB;MAC9B;KACDwW,mBAAmB,CAACC,OAAO,EAC3B;OACC,IAAI,IAAI,CAAC7H,SAAS,CAACyD,UAAU,EAC7B;SACC;;OAGD,MAAM;SAAEtJ,KAAK;SAAEI,OAAO;SAAErG,MAAM;SAAEoG;QAAiB,GAAGuN,OAAO;OAE3D1N,KAAK,CAACC,cAAc,EAAE;OACtB,IAAI,CAAC4F,SAAS,CAACyD,UAAU,GAAG,IAAI;OAChC,IAAI,CAACzD,SAAS,CAAC9L,MAAM,GAAGA,MAAM;OAC9B,IAAI,CAAC8L,SAAS,CAAC0D,WAAW,GAAGpJ,eAAe;OAC5C,IAAI,CAAC0F,SAAS,CAAC8H,cAAc,GAAGvN,OAAO;OAEvC,MAAM4C,IAAI,GAAG,IAAI,CAAC6C,SAAS,CAAC8H,cAAc,CAAC1K,qBAAqB,EAAE;OAClE,IAAI,CAAC4C,SAAS,CAAC+H,OAAO,GAAG5N,KAAK,CAAC6N,OAAO,GAAG7K,IAAI,CAAC8K,IAAI;OAClD,IAAI,CAACjI,SAAS,CAACkI,OAAO,GAAG/N,KAAK,CAAC2C,OAAO,GAAGK,IAAI,CAACG,GAAG;OAEjD,MAAM6K,KAAK,GAAG,IAAI,CAACnI,SAAS,CAAC8H,cAAc,CAACM,SAAS,CAAC,IAAI,CAAC;OAC3DC,aAAG,CAACC,QAAQ,CAACH,KAAK,EAAE,SAAS,CAAC;OAC9BE,aAAG,CAACE,KAAK,CAACJ,KAAK,EAAE,MAAM,EAAG,GAAEhO,KAAK,CAAC6N,OAAO,GAAG,IAAI,CAAChI,SAAS,CAAC+H,OAAQ,IAAG,CAAC;OACvEM,aAAG,CAACE,KAAK,CAACJ,KAAK,EAAE,KAAK,EAAG,GAAEhO,KAAK,CAAC2C,OAAO,GAAG,IAAI,CAACkD,SAAS,CAACkI,OAAQ,IAAG,CAAC;OAEtEG,aAAG,CAACG,MAAM,CAACL,KAAK,EAAEM,QAAQ,CAACC,IAAI,CAAC;OAChC,IAAI,CAAC1I,SAAS,CAAC2I,YAAY,GAAGR,KAAK;OAEnCE,aAAG,CAACC,QAAQ,CAAC,IAAI,CAACtI,SAAS,CAAC8H,cAAc,EAAE,YAAY,CAAC;OACzDO,aAAG,CAACC,QAAQ,CAACG,QAAQ,CAACC,IAAI,EAAE,iBAAiB,CAAC;OAE9CjM,eAAK,CAACD,IAAI,CAACiM,QAAQ,EAAE,WAAW,EAAE,IAAI,CAACpI,mBAAmB,CAAC;OAC3D5D,eAAK,CAACD,IAAI,CAACiM,QAAQ,EAAE,SAAS,EAAE,IAAI,CAACnI,kBAAkB,CAAC;;;OAGxD,MAAMjL,IAAI,GAAG,IAAI,CAACmL,cAAc,CAACpJ,IAAI,CAAEwR,CAAC,IAAKA,CAAC,CAACpV,EAAE,KAAKU,MAAM,CAAC,IACzD,IAAI,CAAC0N,kBAAkB,CAACxK,IAAI,CAAEwR,CAAC,IAAKA,CAAC,CAACpV,EAAE,KAAKU,MAAM,CAAC;OACxD2U,6BAAY,CAACC,IAAI,CAACC,+CAAM,CAACC,kBAAkB,EAAE;SAAE3T;QAAM,CAAC;MACtD;KACDgQ,cAAc,CAAClL,KAAiB,EAChC;OAAA;OACC,IAAI,CAAC,IAAI,CAAC6F,SAAS,CAACyD,UAAU,EAC9B;SACC;;OAGD4E,aAAG,CAACC,QAAQ,CAAC,IAAI,CAACtI,SAAS,CAAC8H,cAAc,EAAE,UAAU,CAAC;OAEvDe,6BAAY,CAACC,IAAI,CAACC,+CAAM,CAACE,iBAAiB,EAAE;SAC3CC,KAAK,EAAE/O,KAAK,CAAC+O,KAAK;SAClBC,KAAK,EAAEhP,KAAK,CAACgP;QACb,CAAC;OAEF,IAAI,IAAI,CAACnJ,SAAS,CAAC2I,YAAY,EAC/B;SACCN,aAAG,CAACE,KAAK,CAAC,IAAI,CAACvI,SAAS,CAAC2I,YAAY,EAAE,MAAM,EAAG,GAAExO,KAAK,CAAC6N,OAAO,GAAG,IAAI,CAAChI,SAAS,CAAC+H,OAAQ,IAAG,CAAC;SAC7FM,aAAG,CAACE,KAAK,CAAC,IAAI,CAACvI,SAAS,CAAC2I,YAAY,EAAE,KAAK,EAAG,GAAExO,KAAK,CAAC2C,OAAO,GAAG,IAAI,CAACkD,SAAS,CAACkI,OAAQ,IAAG,CAAC;;OAG7F,IAAIkB,eAAe,GAAG,IAAI;OAC1B,IAAI,IAAI,CAAC5F,yBAAyB,IAAI,IAAI,CAAC6F,oBAAoB,CAAClP,KAAK,0BAAE,IAAI,CAACiC,KAAK,CAACkN,QAAQ,qBAAnB,qBAAqB9O,GAAG,CAAC,EAChG;SACC4O,eAAe,GAAG,MAAM;QACxB,MACI,IAAI,IAAI,CAACzF,6BAA6B,IAAI,IAAI,CAAC0F,oBAAoB,CAAClP,KAAK,2BAAE,IAAI,CAACiC,KAAK,CAACmN,YAAY,qBAAvB,sBAAyB/O,GAAG,CAAC,EAC7G;SACC4O,eAAe,GAAG,UAAU;;OAE7B,IAAI,CAACpJ,SAAS,CAAC8D,UAAU,GAAGsF,eAAe;OAE3C,IAAI,CAACI,sBAAsB,CAACrP,KAAK,CAAC;MAClC;KACDqP,sBAAsB,CAACrP,KAAiB,EACxC;OACC,IAAI,CAAC,IAAI,CAACqJ,yBAAyB,EACnC;SACC;;OAGD,MAAMiG,mBAAmB,GAAG,IAAI,CAACrN,KAAK,CAACqN,mBAAmB;OAC1D,IAAI,CAACA,mBAAmB,EACxB;SACC;;OAGD,MAAMtM,IAAI,GAAGsM,mBAAmB,CAACrM,qBAAqB,EAAE;OACxD,MAAMP,MAAM,GAAG1C,KAAK,CAAC2C,OAAO;OAE5B,MAAM4M,cAAc,GAAGvM,IAAI,CAACG,GAAG,GAAGqC,oBAAoB;OAEtD,IAAI9C,MAAM,GAAG6M,cAAc,EAC3B;SACC,IAAI,IAAI,CAACtE,oBAAoB,KAAK,IAAI,EACtC;WACC;;SAGD,MAAMuE,WAAW,GAAG,EAAE;SACtB,IAAI,CAACvE,oBAAoB,GAAGwE,WAAW,CAAC,MAAM;WAC7CH,mBAAmB,CAAC7D,SAAS,IAAI+D,WAAW;UAC5C,EAAE,EAAE,CAAC;QACN,MAED;SACC,IAAI,CAACE,cAAc,EAAE;;MAEtB;KACDA,cAAc,GACd;OACC,IAAI,IAAI,CAACzE,oBAAoB,KAAK,IAAI,EACtC;SACC0E,aAAa,CAAC,IAAI,CAAC1E,oBAAoB,CAAC;SACxC,IAAI,CAACA,oBAAoB,GAAG,IAAI;;MAEjC;KACDiE,oBAAoB,CAAClP,KAAiB,EAAEI,OAAoB,EAC5D;OACC,IAAI,CAACA,OAAO,EACZ;SACC,OAAO,KAAK;;OAEb,MAAM4C,IAAI,GAAG5C,OAAO,CAAC6C,qBAAqB,EAAE;OAE5C,OACCjD,KAAK,CAAC6N,OAAO,IAAI7K,IAAI,CAAC8K,IAAI,IAAI9N,KAAK,CAAC6N,OAAO,IAAI7K,IAAI,CAAC4M,KAAK,IACtD5P,KAAK,CAAC2C,OAAO,IAAIK,IAAI,CAACG,GAAG,IAAInD,KAAK,CAAC2C,OAAO,IAAIK,IAAI,CAAC6M,MAAM;MAE7D;KACD,MAAM1E,aAAa,GACnB;OACC,IAAI,CAAC,IAAI,CAACtF,SAAS,CAACyD,UAAU,EAC9B;SACC;;OAGDoF,6BAAY,CAACC,IAAI,CAACC,+CAAM,CAACkB,iBAAiB,CAAC;OAC3C,IAAI,CAACJ,cAAc,EAAE;OAErB,MAAM;SAAE3V,MAAM;SAAEwP,WAAW;SAAEI,UAAU;SAAE6E,YAAY;SAAEb;QAAgB,GAAG,IAAI,CAAC9H,SAAS;OAExF,MAAMkK,WAAW,GAAGhW,MAAM,IAAI4P,UAAU,IAAIA,UAAU,KAAKJ,WAAW;OACtE,IAAIyG,WAAW,GAAG,IAAI;OACtB,IAAID,WAAW,EACf;SACC,MAAME,OAAO,GAAGtG,UAAU,KAAK,MAAM,GAAG,IAAI,CAAC1H,KAAK,CAACkN,QAAQ,GAAG,IAAI,CAAClN,KAAK,CAACmN,YAAY;SACrFY,WAAW,GAAGC,OAAO,oBAAPA,OAAO,CAAEzO,gBAAgB;;OAGxCc,eAAK,CAACC,MAAM,CAAC+L,QAAQ,EAAE,WAAW,EAAE,IAAI,CAACpI,mBAAmB,CAAC;OAC7D5D,eAAK,CAACC,MAAM,CAAC+L,QAAQ,EAAE,SAAS,EAAE,IAAI,CAACnI,kBAAkB,CAAC;OAC1D,IAAIqI,YAAY,EAChB;SACCN,aAAG,CAACgC,MAAM,CAAC1B,YAAY,CAAC;;OAGzB,IAAIb,cAAc,EAClB;SACCO,aAAG,CAACiC,WAAW,CAACxC,cAAc,EAAE,YAAY,CAAC;SAC7CO,aAAG,CAACiC,WAAW,CAACxC,cAAc,EAAE,UAAU,CAAC;;OAE5CO,aAAG,CAACiC,WAAW,CAAC7B,QAAQ,CAACC,IAAI,EAAE,iBAAiB,CAAC;OAEjDG,6BAAY,CAACC,IAAI,CAACC,+CAAM,CAACwB,gBAAgB,CAAC;OAC1C,IAAI,CAACL,WAAW,IAAIC,WAAW,KAAK,IAAI,EACxC;SACC,IAAI,CAACnK,SAAS,GAAG,IAAI,CAACC,mBAAmB,EAAE;SAE3C;;OAGD,IAAI,CAACD,SAAS,CAACyD,UAAU,GAAG,KAAK;OACjC,IAAI,CAACzD,SAAS,CAAC2I,YAAY,GAAG,IAAI;OAClC,IAAI,CAAC3I,SAAS,CAAC8H,cAAc,GAAG,IAAI;OACpC,IAAI,CAAC9H,SAAS,CAACwK,OAAO,GAAG;SAAEL;QAAa;OAExC,IAAI,CAAChK,gBAAgB,GAAG,IAAI,CAACsK,WAAW,EAAE;OAC1C,IAAI,CAAC,IAAI,CAACtK,gBAAgB,EAC1B;SACC,IAAI,CAACH,SAAS,GAAG,IAAI,CAACC,mBAAmB,EAAE;SAE3C;;OAGD,MAAM;SAAEuK;QAAS,GAAG,IAAI,CAACxK,SAAS;OAClCwK,OAAO,CAACE,YAAY,GAAG,IAAI;OAC3BF,OAAO,CAACG,iBAAiB,GAAG,EAAE;OAE9B,IAAI7G,UAAU,KAAK,MAAM,EACzB;SACC0G,OAAO,CAACE,YAAY,GAAG,IAAI,CAACxS,WAAW,CAACwI,IAAI;SAC5C8J,OAAO,CAACG,iBAAiB,GAAG,IAAI,CAAC9X,GAAG,CACnC,0EAA0E,CAC1E;;OAGF,MAAM,IAAI,CAAC+X,0BAA0B,EAAE;OACvC,IAAI,CAAC1K,wBAAwB,GAAG,IAAI;MACpC;KACD2K,iBAAiB,GACjB;OACC,MAAM;SAAExM,KAAK;SAAEH;QAAW,GAAG,IAAI,CAACiC,gBAAgB;OAClDnC,wBAAwB,CAACI,WAAW,CAAC,IAAI,CAAChI,WAAW,EAAEiI,KAAK,CAAC;OAC7DL,wBAAwB,CAACC,eAAe,CAAC,IAAI,CAAC7H,WAAW,EAAE8H,SAAS,CAAC;OAErE,IAAI,CAACiC,gBAAgB,GAAG,IAAI;OAC5B,IAAI,CAACH,SAAS,GAAG,IAAI,CAACC,mBAAmB,EAAE;OAC3C,IAAI,CAACC,wBAAwB,GAAG,KAAK;MACrC;KACD,MAAM4K,kBAAkB,CAACjD,OAAO,EAChC;OACC,MAAM;SAAE3T;QAAQ,GAAG,IAAI,CAAC8L,SAAS;OACjC,MAAM+K,UAAU,GAAGlD,OAAO,CAACvT,IAAI,IAAI,IAAI,CAAC4D,WAAW,CAAC2J,QAAQ;OAE5D,MAAM3P,UAAU,GAAG,IAAI,CAAC4E,WAAW,CAACC,GAAG,CAAC,IAAI,CAACX,WAAW,CAAC;OACzD,MAAMf,IAAI,GAAGnD,UAAU,CAACmM,KAAK,CAACjH,IAAI,CAAEwR,CAAC,IAAKA,CAAC,CAACpV,EAAE,KAAKU,MAAM,CAAC,IAAIhC,UAAU,CAACgM,SAAS,CAAC9G,IAAI,CAAEwR,CAAC,IAAKA,CAAC,CAACpV,EAAE,KAAKU,MAAM,CAAC;OAE/G,IAAI,CAACmB,IAAI,EACT;SACC,IAAI,CAAC2K,SAAS,GAAG,IAAI,CAACC,mBAAmB,EAAE;SAE3C;;OAGD,MAAM+K,YAAY,GAAG3V,IAAI,CAACf,IAAI;OAC9Be,IAAI,CAACf,IAAI,GAAGyW,UAAU;OAEtB,IACA;SACC,MAAME,4EAAuB,CAACC,oBAAoB,CAAC,IAAI,CAAC9U,WAAW,EAAE,CAAClC,MAAM,CAAC,EAAE6W,UAAU,CAAC;SAE1F1U,kBAAE,CAACC,YAAY,CAACC,MAAM,CAACC,MAAM,CAAC;WAC7BC,OAAO,EAAE,IAAI,CAAC5D,GAAG,CAAC,qEAAqE,CAAC;WACxF6D,aAAa,EAAE;UACf,CAAC;QACF,CACD,OAAOc,KAAK,EACZ;SACC2T,OAAO,CAAC3T,KAAK,CAACA,KAAK,CAAC;SACpBnC,IAAI,CAACf,IAAI,GAAG0W,YAAY;SACxB,IAAI,CAACH,iBAAiB,EAAE;;OAGzB,IAAI,CAAC3K,wBAAwB,GAAG,KAAK;OACrC,IAAI,CAACF,SAAS,GAAG,IAAI,CAACC,mBAAmB,EAAE;MAC3C;KACD,MAAM2K,0BAA0B,GAChC;OAAA;OACC,MAAM;SAAE1W,MAAM;SAAE4P;QAAY,GAAG,IAAI,CAAC9D,SAAS;OAE7C,MAAM6D,MAAM,GAAGC,UAAU,KAAK,MAAM;OACpC,MAAMsH,MAAM,GAAG,IAAI,CAACpV,YAAY;OAChC,MAAM9D,UAAU,GAAG,IAAI,CAAC4E,WAAW,CAACC,GAAG,CAAC,IAAI,CAACrF,YAAY,CAAC;OAC1D,MAAMiF,cAAc,GAAGC,cAAI,CAACC,MAAM,qBAAC3E,UAAU,oBAAVA,UAAU,CAAEZ,IAAI,+BAAI,EAAE,CAAC;OAE1D,IAAI+D,IAAI,GAAG,IAAI;OACf,IACA;SACCA,IAAI,GAAG,MAAM1B,aAAa,CAACc,WAAW,CAAC,IAAI,CAAC/C,YAAY,EAAEwC,MAAM,CAAC;QACjE,CACD,MACA;OAEA,MAAMqE,QAAQ,GAAG3B,cAAI,CAACC,MAAM,wBAACxB,IAAI,qBAAJ,MAAM/D,IAAI,yBAAI,EAAE,CAAC;OAC9C,MAAMkH,OAAO,0BAAGnD,IAAI,qBAAJ,OAAMoD,GAAG,wBAAI,GAAG;OAChC,IAAI3F,UAAU,GAAG,EAAE;OAEnB,IAAI+Q,MAAM,EACV;SACC/Q,UAAU,GAAGsY,MAAM,GAChB,0FAA0F,GAC1F,qFAAqF;QACxF,MAED;SAAA;SACC,MAAMC,UAAU,GAAGD,MAAM,GACtB,qFAAqF,GACrF,gFAAgF;SAEnF,MAAM1S,YAAY,GAAG,WAAArD,IAAI,qBAAJ,OAAMsD,MAAM,MAAK,GAAG,GAAG,IAAI,GAAG,IAAI;SACvD7F,UAAU,GAAGuY,UAAU,GAAG3S,YAAY;;OAGvC,IAAI,CAAC0H,mBAAmB,GAAG,IAAI,CAACvN,GAAG,CAACC,UAAU,EAAE;SAC/C,aAAa,EAAEyF,QAAQ;SACvB,mBAAmB,EAAE5B;QACrB,CAAC,CACAmC,OAAO,CACP,QAAQ,EACP,iFAAgFN,OAAQ,IAAG,CAC5F,CACAM,OAAO,CAAC,SAAS,EAAE,MAAM,CAAC;MAC5B;KACD2R,WAAW,GACX;OACC,MAAM;SAAEvW,MAAM;SAAE4P,UAAU;SAAE0G;QAAS,GAAG,IAAI,CAACxK,SAAS;OACtD,MAAM;SAAEmK;QAAa,GAAGK,OAAO;OAC/B,MAAMtY,UAAU,GAAG,IAAI,CAAC4E,WAAW,CAACC,GAAG,CAAC,IAAI,CAACX,WAAW,CAAC;OACzD,IAAI,CAAClE,UAAU,EACf;SACC,OAAO,IAAI;;OAGZ,MAAMoZ,aAAa,GAAG;SAAEjN,KAAK,EAAE,CAAC,GAAGnM,UAAU,CAACmM,KAAK,CAAC;SAAEH,SAAS,EAAE,CAAC,GAAGhM,UAAU,CAACgM,SAAS;QAAG;OAC5F,MAAMqN,eAAe,GAAGzH,UAAU,KAAK,MAAM;OAC7C,MAAM0H,UAAU,GAAGD,eAAe,GAAG,CAAC,GAAGD,aAAa,CAACpN,SAAS,CAAC,GAAG,CAAC,GAAGoN,aAAa,CAACjN,KAAK,CAAC;OAC5F,MAAMoN,iBAAiB,GAAGF,eAAe,GAAG,CAAC,GAAGD,aAAa,CAACjN,KAAK,CAAC,GAAG,CAAC,GAAGiN,aAAa,CAACpN,SAAS,CAAC;OAEnG,MAAMwN,SAAS,GAAGF,UAAU,CAACG,SAAS,CAAEtW,IAAI,IAAKA,IAAI,CAAC7B,EAAE,KAAKU,MAAM,CAAC;OACpE,IAAIwX,SAAS,KAAK,CAAC,CAAC,EACpB;SACC,OAAO,IAAI;;OAGZ,MAAM,CAACE,UAAU,CAAC,GAAGJ,UAAU,CAACK,MAAM,CAACH,SAAS,EAAE,CAAC,CAAC;OACpDD,iBAAiB,CAACI,MAAM,CAAC1B,WAAW,EAAE,CAAC,EAAEyB,UAAU,CAAC;OAEpD,IAAIL,eAAe,EACnB;SACCvN,wBAAwB,CAACI,WAAW,CAAC,IAAI,CAAChI,WAAW,EAAEqV,iBAAiB,CAAC;SACzEzN,wBAAwB,CAACC,eAAe,CAAC,IAAI,CAAC7H,WAAW,EAAEoV,UAAU,CAAC;QACtE,MAED;SACCxN,wBAAwB,CAACI,WAAW,CAAC,IAAI,CAAChI,WAAW,EAAEoV,UAAU,CAAC;SAClExN,wBAAwB,CAACC,eAAe,CAAC,IAAI,CAAC7H,WAAW,EAAEqV,iBAAiB,CAAC;;OAG9E,OAAOH,aAAa;MACpB;KACDrL,mBAAmB,GACnB;OACC,OAAO;SACNwD,UAAU,EAAE,KAAK;SACjBvP,MAAM,EAAE,IAAI;SACZwP,WAAW,EAAE,IAAI;SACjBI,UAAU,EAAE,IAAI;SAChB6E,YAAY,EAAE,IAAI;SAClBb,cAAc,EAAE,IAAI;SACpBC,OAAO,EAAE,CAAC;SACVG,OAAO,EAAE,CAAC;SACVsC,OAAO,EAAE;QACT;;IAEF;GAED9W,QAAQ,EAAG;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;CAqGZ,CAAC;;CC7iCM,MAAMoY,eAAe,GAAGhb,MAAM,CAACC,MAAM,CAAC;GAC5Cgb,QAAQ,EAAE,UAAU;GACpBC,WAAW,EAAE,aAAa;GAC1BC,UAAU,EAAE;CACb,CAAC,CAAC;AAEF,CAAO,MAAMC,iBAAiB,GAAGpb,MAAM,CAACC,MAAM,CAAC;GAC9CyC,EAAE,EAAEsY,eAAe,CAACC,QAAQ;GAC5BrR,KAAK,EAAEzH,aAAG,CAACC,UAAU,CAAC,2FAA2F,CAAC;GAClH2F,WAAW,EAAE5F,aAAG,CAACC,UAAU,CAAC,0FAA0F,CAAC;GACvHiZ,KAAK,EAAE;KACN7a,IAAI,EAAE8a,wBAAI,CAACC,YAAY;KACvBC,IAAI,EAAE,EAAE;KACRC,cAAc,EAAE;IAChB;GACD7O,UAAU,EAAE;CACb,CAAC,CAAC;AAEF,CAAO,MAAM8O,oBAAoB,GAAG1b,MAAM,CAACC,MAAM,CAAC;GACjDyC,EAAE,EAAEsY,eAAe,CAACE,WAAW;GAC/BtR,KAAK,EAAEzH,aAAG,CAACC,UAAU,CAAC,8FAA8F,CAAC;GACrH2F,WAAW,EAAE5F,aAAG,CAACC,UAAU,CAAC,6FAA6F,CAAC;GAC1HiZ,KAAK,EAAE;KACN7a,IAAI,EAAE8a,wBAAI,CAACK,kBAAkB;KAC7BH,IAAI,EAAE,EAAE;KACRC,cAAc,EAAE;IAChB;GACD7O,UAAU,EAAE;CACb,CAAC,CAAC;AAEF,CAAO,MAAMgP,mBAAmB,GAAG5b,MAAM,CAACC,MAAM,CAAC;GAChDyC,EAAE,EAAEsY,eAAe,CAACG,UAAU;GAC9BvR,KAAK,EAAEzH,aAAG,CAACC,UAAU,CAAC,6FAA6F,CAAC;GACpH2F,WAAW,EAAE5F,aAAG,CAACC,UAAU,CAAC,4FAA4F,CAAC;GACzHiZ,KAAK,EAAE;KACN7a,IAAI,EAAE8a,wBAAI,CAACO,MAAM;KACjBL,IAAI,EAAE,EAAE;KACRC,cAAc,EAAE;IAChB;GACD7O,UAAU,EAAE;CACb,CAAC,CAAC;AAEF,CAAO,MAAMkP,mBAAmB,GAAG9b,MAAM,CAACC,MAAM,CAAC;GAChDC,mBAAmB,EAAE,sDAAsD;GAC3EC,0BAA0B,EAAE,0DAA0D;GACtFC,uBAAuB,EAAE,kEAAkE;GAC3FC,qBAAqB,EAAE;CACxB,CAAC,CAAC;AAEF,CAAO,MAAM0b,sBAAsB,GAAG/b,MAAM,CAACC,MAAM,CAAC;GACnDC,mBAAmB,EAAE,yDAAyD;GAC9EC,0BAA0B,EAAE,6DAA6D;GACzFC,uBAAuB,EAAE,qEAAqE;GAC9FC,qBAAqB,EAAE;CACxB,CAAC,CAAC;AAEF,CAAO,MAAM2b,qBAAqB,GAAGhc,MAAM,CAACC,MAAM,CAAC;GAClDC,mBAAmB,EAAE,wDAAwD;GAC7EC,0BAA0B,EAAE,4DAA4D;GACxFC,uBAAuB,EAAE,oEAAoE;GAC7FC,qBAAqB,EAAE;CACxB,CAAC,CAAC;AAEF,CAAO,MAAM4b,yBAGZ,GAAGjc,MAAM,CAACC,MAAM,CAAC;GACjBC,mBAAmB,EAAE,sDAAsD;GAC3Egc,uBAAuB,EAAE,2DAA2D;GACpFC,sBAAsB,EAAE,0DAA0D;GAClFC,qBAAqB,EAAE,yDAAyD;GAChFC,yBAAyB,EAAE;CAC5B,CAAC,CAAC;AAEF,CAAO,MAAMC,4BAGZ,GAAGtc,MAAM,CAACC,MAAM,CAAC;GACjBC,mBAAmB,EAAE,yDAAyD;GAC9Egc,uBAAuB,EAAE,8DAA8D;GACvFC,sBAAsB,EAAE,6DAA6D;GACrFC,qBAAqB,EAAE,4DAA4D;GACnFC,yBAAyB,EAAE;CAC5B,CAAC,CAAC;AAEF,CAAO,MAAME,2BAGZ,GAAGvc,MAAM,CAACC,MAAM,CAAC;GACjBC,mBAAmB,EAAE,wDAAwD;GAC7Egc,uBAAuB,EAAE,6DAA6D;GACtFC,sBAAsB,EAAE,4DAA4D;GACpFC,qBAAqB,EAAE,2DAA2D;GAClFC,yBAAyB,EAAE;CAC5B,CAAC,CAAC;;CC3FF;AACA,CAAO,MAAMG,kBAAkB,GAAG;GACjChc,IAAI,EAAE,mBAAmB;GAEzBC,UAAU,EAAE;sBAAEC;IAAiB;GAE/BC,KAAK,EAAE;KACN8b,WAAW,EAAE;OACZ5b,IAAI,EAAE6H,OAAO;OACb3H,QAAQ,EAAE;MACV;KACD2b,cAAc,EAAE;OACf7b,IAAI,EAAE6H,OAAO;OACb3H,QAAQ,EAAE;MACV;KACD4b,aAAa,EAAE;OACd9b,IAAI,EAAE6H,OAAO;OACb3H,QAAQ,EAAE;MACV;KACDmE,YAAY,EAAE;OACbrE,IAAI,EAAE6H,OAAO;OACb3H,QAAQ,EAAE;;IAEX;GAEDuH,KAAK,EAAE,CAAC,qBAAqB,CAAC;GAE9BjH,IAAI,GACJ;KACC,OAAO;OACNC,WAAW,EAAE;MACb;IACD;GAEDC,QAAQ,EACR;KACCC,IAAI,GACJ;OACC,MAAMA,IAAI,GAAG,EAAE;OAEf,IAAI,IAAI,CAACmb,aAAa,EACtB;SACCnb,IAAI,CAACkU,IAAI,CAACkG,mBAAmB,CAAC;;OAG/B,IAAI,IAAI,CAACc,cAAc,EACvB;SACClb,IAAI,CAACkU,IAAI,CAACgG,oBAAoB,CAAC;;OAGhC,IAAI,IAAI,CAACe,WAAW,EACpB;SACCjb,IAAI,CAACkU,IAAI,CAAC0F,iBAAiB,CAAC;;OAG7B,OAAO5Z,IAAI;MACX;KACD,GAAGI,sBAAQ,CAACC,wDAAa,EAAE,CAAC,aAAa,CAAC;IAC1C;GAEDC,OAAO,EACP;KACCC,GAAG,CAACC,UAAkB,EAAEC,YAAqC,GAAG,EAAE,EAClE;OACC,OAAO,IAAI,CAACC,OAAO,CAACC,GAAG,CAACC,UAAU,CAACJ,UAAU,EAAEC,YAAY,CAAC;MAC5D;KACDI,OAAO,GACP;OACC,IAAI,CAACf,WAAW,GAAG,IAAI;MACvB;KACDmB,qBAAqB,CAACE,QAAgB,EACtC;OACC,IAAI,CAAC4G,KAAK,CAAC,qBAAqB,EAAE5G,QAAQ,CAAC;;IAE5C;GAEDC,QAAQ,EAAG;;;;;;;;;;;;;;;;;;;;;;;;;CAyBZ,CAAC;;CCrGM,MAAMga,sBAAkF,GAAG5c,MAAM,CAACC,MAAM,CAAC;GAC/G2O,IAAI,EAAE;KACLtM,IAAI,EAAE;OACLsH,KAAK,EAAE,iGAAiG;OACxG7B,WAAW,EAAE,uGAAuG;OACpHrB,KAAK,EAAE,iGAAiG;OACxGuP,OAAO,EAAE;MACT;KACD7U,UAAU,EAAE;OACXwI,KAAK,EAAE,uGAAuG;OAC9G7B,WAAW,EAAE,6GAA6G;OAC1HrB,KAAK,EAAE,uGAAuG;OAC9GuP,OAAO,EAAE;;IAEV;GACD4G,OAAO,EAAE;KACRva,IAAI,EAAE;OACLsH,KAAK,EAAE,oGAAoG;OAC3G7B,WAAW,EAAE,0GAA0G;OACvHrB,KAAK,EAAE,oGAAoG;OAC3GuP,OAAO,EAAE;MACT;KACD7U,UAAU,EAAE;OACXwI,KAAK,EAAE,0GAA0G;OACjH7B,WAAW,EAAE,gHAAgH;OAC7HrB,KAAK,EAAE,0GAA0G;OACjHuP,OAAO,EAAE;;IAEV;GACDvH,MAAM,EAAE;KACPpM,IAAI,EAAE;OACLsH,KAAK,EAAE,mGAAmG;OAC1G7B,WAAW,EAAE,yGAAyG;OACtHrB,KAAK,EAAE,mGAAmG;OAC1GuP,OAAO,EAAE;MACT;KACD7U,UAAU,EAAE;OACXwI,KAAK,EAAE,yGAAyG;OAChH7B,WAAW,EAAE,+GAA+G;OAC5HrB,KAAK,EAAE,yGAAyG;OAChHuP,OAAO,EAAE;;;CAGZ,CAAC,CAAC;;CChCF;AACA,CAAO,MAAM6G,iCAAiC,GAAG;GAChDtc,IAAI,EAAE,mCAAmC;GAEzCC,UAAU,EAAE;sBACXC,mEAAe;wBACf8D;IACA;GAED7D,KAAK,EAAE;;KAENoc,aAAa,EAAE;OACdlc,IAAI,EAAEb,MAAM;OACZe,QAAQ,EAAE;MACV;KACDmC,MAAM,EAAE;OACPrC,IAAI,EAAEC,MAAM;OACZC,QAAQ,EAAE;;IAEX;GAEDM,IAAI,GACJ;KACC,OAAO;OACN2b,aAAa,EAAE,KAAK;OACpBC,2BAA2B,EAAE,KAAK;OAClCC,YAAY,EAAE,KAAK;OACnBC,UAAU,EAAE;MACZ;IACD;GAED5b,QAAQ,EACR;KACCP,UAAU,GACV;OAAA;OACC,gCAAO,IAAI,CAACgF,WAAW,CAACC,GAAG,CAAC,IAAI,CAAC/C,MAAM,CAAC,qBAAjC,sBAAmClC,UAAU;MACpD;KACDkE,YAAY,GACZ;OAAA;OACC,OAAO,+BAAI,CAACc,WAAW,CAACC,GAAG,CAAC,IAAI,CAAC/C,MAAM,CAAC,qBAAjC,uBAAmClC,UAAU,MAAKG,iDAAW,CAACmB,IAAI;MACzE;KACDd,IAAI,GACJ;OAAA;OACC,MAAMR,UAAU,6BAAG,IAAI,CAACgF,WAAW,CAACC,GAAG,CAAC,IAAI,CAAC/C,MAAM,CAAC,qBAAjC,uBAAmClC,UAAU;OAEhE,OAAO,IAAIoc,2DAAkB,CAACpc,UAAU,EAAE,IAAI,CAAC+b,aAAa,EAAE,IAAI,CAAC7Z,MAAM,CAAC;MAC1E;KACDma,YAAY,GACZ;OACC,MAAMxc,IAAI,GAAG,IAAI,CAACkc,aAAa,CAAClc,IAAI,CAAC4P,WAAW,EAAE;OAElD,OAAQ,iCAAgC5P,IAAK,cAAa,IAAI,CAACkc,aAAa,CAACra,EAAG,aAAY;MAC5F;KACD,GAAGd,sBAAQ,CAACC,wDAAa,EAAE,CAAC,aAAa,CAAC;IAC1C;GAEDyF,OAAO,GACP;KACC,IAAI,CAAC6V,UAAU,GAAIP,sBAAsB,CAAC,IAAI,CAACG,aAAa,CAAClc,IAAI,CAAC4P,WAAW,EAAE,CAAC,IAC3EmM,sBAAsB,CAAC,IAAI,CAACG,aAAa,CAAClc,IAAI,CAAC4P,WAAW,EAAE,CAAC,CAAC,IAAI,CAACzP,UAAU,CAACyP,WAAW,EAAE,CAAC,IAC7F,EAAE;IAEN;GAED3O,OAAO,EACP;KACCC,GAAG,CAACC,UAAkB,EAAEC,YAAqC,GAAG,EAAE,EAClE;OACC,OAAO,IAAI,CAACC,OAAO,CAACC,GAAG,CAACC,UAAU,CAACJ,UAAU,EAAEC,YAAY,CAAC;MAC5D;KACD+C,UAAU,GACV;OACC,IAAI,CAACgY,aAAa,GAAG,CAAC,IAAI,CAACA,aAAa;MACxC;KACDva,qBAAqB,CAACE,QAAgB,EACtC;OACC,IAAIA,QAAQ,KAAKsC,oDAAW,CAACqY,QAAQ,EACrC;SACCC,0BAAS,CAACD,QAAQ,CAAC,IAAI,CAACP,aAAa,CAACS,QAAQ,CAAC;QAC/C,MACI,IAAI7a,QAAQ,KAAKsC,oDAAW,CAACwY,UAAU,EAC5C;SACC,IAAI,CAACR,2BAA2B,GAAG,IAAI;;MAExC;KACDS,YAAY,GACZ;OACC,IAAI,CAACT,2BAA2B,GAAG,KAAK;MACxC;KACD,MAAMrR,MAAM,GACZ;OACC,IAAI,CAACsR,YAAY,GAAG,IAAI;OAExB,IACA;SACC,QAAQ,IAAI,CAACH,aAAa,CAAClc,IAAI;WAE9B,KAAK4N,+CAAS,CAACG,IAAI;aAClB,MAAM/L,aAAa,CAACmB,SAAS,CAAC,IAAI,CAACd,MAAM,EAAE,EAAE,EAAE,CAAC,IAAI,CAAC6Z,aAAa,CAACra,EAAE,CAAC,CAAC;aACvE;WACD,KAAK+L,+CAAS,CAACoO,OAAO;aACrB,MAAMha,aAAa,CAACuB,WAAW,CAAC,IAAI,CAAClB,MAAM,EAAE,EAAE,EAAE,CAAC,IAAI,CAAC6Z,aAAa,CAACra,EAAE,CAAC,CAAC;aACzE;WACD,KAAK+L,+CAAS,CAACC,MAAM;aACpB,MAAM7L,aAAa,CAACwB,UAAU,CAAC,IAAI,CAACnB,MAAM,EAAE,EAAE,EAAE,CAAC,IAAI,CAAC6Z,aAAa,CAACra,EAAE,CAAC,CAAC;aACxE;WACD;aACC;;QAEF,CACD,OAAOgE,KAAK,EACZ;SACC,IAAIA,KAAK,CAACC,IAAI,KAAK,yBAAyB,EAC5C;WACCpB,kBAAE,CAACC,YAAY,CAACC,MAAM,CAACC,MAAM,CAAC;aAC7BC,OAAO,EAAE,IAAI,CAAC5D,GAAG,CAAC,IAAI,CAACob,UAAU,CAACzW,KAAK,CAAC;aACxCd,aAAa,EAAE;YACf,CAAC;;SAGH;QACA,SAED;SACC,IAAI,CAACsX,YAAY,GAAG,KAAK;SACzB,IAAI,CAACD,2BAA2B,GAAG,KAAK;;OAGzC/P,wBAAwB,CAACqB,kBAAkB,CAAC,IAAI,CAACrL,MAAM,EAAE,IAAI,CAAC6Z,aAAa,CAACra,EAAE,EAAE,IAAI,CAACqa,aAAa,CAAClc,IAAI,CAAC;OAExG,MAAM8c,KAAK,GAAG,CAAC,IAAI,CAACZ,aAAa,CAACa,cAAc,IAAI,IAAI,CAACb,aAAa,CAACa,cAAc,KAAK,IAAI,CAAC1a,MAAM;OAErG,IAAIya,KAAK,EACT;SACC,MAAMzP,KAAK,GAAGrM,wDAAa,EAAE;SAC7BqM,KAAK,CAAC2P,0BAA0B,CAAC,IAAI,CAAC3a,MAAM,CAAC;;OAG9CqC,kBAAE,CAACC,YAAY,CAACC,MAAM,CAACC,MAAM,CAAC;SAC7BC,OAAO,EAAE,IAAI,CAAC5D,GAAG,CAAC,IAAI,CAACob,UAAU,CAAClH,OAAO,CAAC;SAC1CrQ,aAAa,EAAE;QACf,CAAC;;IAEH;GAEDhD,QAAQ,EAAG;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;CAsCZ,CAAC;;CCtMM,MAAMkb,cAAkD,GAAG9d,MAAM,CAACC,MAAM,CAAC;GAC/E,CAACwO,+CAAS,CAACG,IAAI,GAAG;KACjBmP,cAAc,EAAE,qFAAqF;KACrGC,eAAe,EAAE,qFAAqF;KACtGC,gCAAgC,EAAE,yGAAyG;KAC3IC,0BAA0B,EAAE,mGAAmG;KAC/HC,qBAAqB,EAAE,2FAA2F;KAClHC,SAAS,EAAGC,aAAqB,IAAiB,IAAIC,qBAAW,CAACD,aAAa,CAAC;KAChFE,gBAAgB,EAAE;IAClB;GACD,CAAC9P,+CAAS,CAACoO,OAAO,GAAG;KACpBkB,cAAc,EAAE,wFAAwF;KACxGC,eAAe,EAAE,wFAAwF;KACzGC,gCAAgC,EAAE,4GAA4G;KAC9IC,0BAA0B,EAAE,sGAAsG;KAClIC,qBAAqB,EAAE,8FAA8F;KACrHC,SAAS,EAAGC,aAAqB,IAAiB,IAAIG,sBAAY,CAACH,aAAa,CAAC;KACjFE,gBAAgB,EAAE;IAClB;GACD,CAAC9P,+CAAS,CAACC,MAAM,GAAG;KACnBqP,cAAc,EAAE,uFAAuF;KACvGC,eAAe,EAAE,uFAAuF;KACxGC,gCAAgC,EAAE,2GAA2G;KAC7IC,0BAA0B,EAAE,qGAAqG;KACjIC,qBAAqB,EAAE,6FAA6F;KACpHC,SAAS,EAAGC,aAAqB,IAAiB,IAAII,4BAAkB,CAACJ,aAAa,CAAC;KACvFE,gBAAgB,EAAE;;CAEpB,CAAC,CAAC;;CCrBF;AACA,CAAO,MAAMG,qBAAqB,GAAG;GACpCle,IAAI,EAAE,uBAAuB;GAE7BC,UAAU,EAAE;KAAEke,wBAAwB,EAAE7B,iCAAiC;qBAAE8B;IAAgB;GAE3FC,UAAU,EAAE;KAAEC,IAAI,EAAEC;IAAM;GAE1Bpe,KAAK,EAAE;;KAENoc,aAAa,EAAE;OACdlc,IAAI,EAAEb,MAAM;OACZe,QAAQ,EAAE;MACV;KACDmC,MAAM,EAAE;OACPrC,IAAI,EAAEC,MAAM;OACZC,QAAQ,EAAE;;IAEX;GAEDM,IAAI,GACJ;KACC,OAAO;OACN2d,MAAM,EAAE;MACR;IACD;GAEDzd,QAAQ,EACR;KACC4b,UAAU,GACV;OACC,OAAOW,cAAc,CAAC,IAAI,CAACf,aAAa,CAAClc,IAAI,CAAC,IAAIid,cAAc,CAACrP,+CAAS,CAACoO,OAAO,CAAC;MACnF;KACDoC,gBAAgB,GAChB;OAAA;OACC,gCAAO,IAAI,CAACjZ,WAAW,CAACC,GAAG,CAAC,IAAI,CAAC8W,aAAa,CAACa,cAAc,CAAC,qBAAvD,sBAAyDpd,IAAI;MACpE;KACD0e,cAAc,GACd;OAAA;OACC,OAAO,8BAAI,CAACC,YAAY,CAAClZ,GAAG,CAAC,IAAI,CAAC8W,aAAa,CAACa,cAAc,CAAC,qBAAxD,sBAA0D5c,UAAU,MAAKG,iDAAW,CAACmB,IAAI,GAC7F,IAAI,CAACP,GAAG,CAAC,2EAA2E,CAAC,GACrF,IAAI,CAACA,GAAG,CAAC,iFAAiF,CAAC;MAE9F;;CAEH;CACA;KACEqd,wBAAwB,GACxB;OAAA;OACC,IAAItX,MAAM,GAAG,EAAE;OACf,IAAI,+BAAI,CAACqX,YAAY,CAAClZ,GAAG,CAAC,IAAI,CAAC8W,aAAa,CAACa,cAAc,CAAC,qBAAxD,uBAA0D5c,UAAU,MAAKG,iDAAW,CAACmB,IAAI,EAC7F;SACCwF,MAAM,GAAG,IAAI,CAAC/F,GAAG,CAAC,IAAI,CAACob,UAAU,CAACa,eAAe,CAAC;QAClD,MAED;SACClW,MAAM,GAAG,IAAI,CAAC/F,GAAG,CAAC,IAAI,CAACob,UAAU,CAACgB,qBAAqB,CAAC;;OAGzD,MAAMkB,KAAK,GAAGvX,MAAM,CAACwX,KAAK,CAAC,QAAQ,CAAC;OAEpC,OAAO;SACNC,UAAU,EAAEF,KAAK,CAAC,CAAC,CAAC,IAAI,IAAI;SAC5BG,SAAS,EAAEH,KAAK,CAAC,CAAC,CAAC,IAAI;QACvB;MACD;KACDI,QAAQ,GACR;OAAA;;OAEC,IAAI,+BAAI,CAACN,YAAY,CAAClZ,GAAG,CAAC,IAAI,CAAC8W,aAAa,CAACa,cAAc,CAAC,qBAAxD,uBAA0D5c,UAAU,MAAKG,iDAAW,CAACmB,IAAI,EAC7F;SACC,OAAO,IAAI,CAACP,GAAG,CAAC,IAAI,CAACob,UAAU,CAACY,cAAc,CAAC;;;;OAIhD,IAAI,+BAAI,CAACoB,YAAY,CAAClZ,GAAG,CAAC,IAAI,CAAC/C,MAAM,CAAC,qBAAlC,uBAAoClC,UAAU,MAAKG,iDAAW,CAACC,UAAU,EAC7E;SACC,OAAO,IAAI,CAACW,GAAG,CAAC,IAAI,CAACob,UAAU,CAACc,gCAAgC,CAAC;;;;OAIlE,OAAO,IAAI,CAAClc,GAAG,CAAC,IAAI,CAACob,UAAU,CAACe,0BAA0B,CAAC;MAC3D;KACD,GAAGtc,sBAAQ,CAACC,wDAAa,EAAE,CAAC,cAAc,EAAE,aAAa,CAAC;IAC1D;GAEDqJ,KAAK,EACL;KACC6R,aAAa,GACb;OACC,IAAI,CAAC2C,aAAa,EAAE;;IAErB;GAEDpY,OAAO,GACP;KACC,IAAI,CAACoY,aAAa,EAAE;IACpB;GAED5d,OAAO,EACP;KACC4d,aAAa,GACb;OACC,IAAI,IAAI,CAAC3C,aAAa,CAACiC,MAAM,EAC7B;SACC,IAAI,CAACjC,aAAa,CAAC4C,KAAK,GAAGC,kDAAY,CAAC,WAAW,CAAC;;OAGrD,MAAMvB,aAAa,GAAG;SACrB7C,IAAI,EAAE,EAAE;SACR/T,QAAQ,EAAE,IAAI,CAACsV,aAAa,CAACnT,KAAK;SAClCiW,SAAS,EAAE,IAAI,CAACC,UAAU,EAAE,IAAI,CAAC,IAAI,CAAC/C,aAAa,CAACiC,MAAM,GAAGY,kDAAY,CAAC,eAAe,CAAC,GAAG,IAAI,CAAC7C,aAAa,CAAC4C,KAAK;SACrH1H,MAAM,EAAE;WACP8H,KAAK,EAAE,MAAM;aACZ,IAAI,CAACC,eAAe,EAAE;;;QAGxB;OAED,IAAI,IAAI,CAACjD,aAAa,CAACiC,MAAM,EAC7B;SACCX,aAAa,CAAC4B,WAAW,GAAG,IAAI,CAAClD,aAAa,CAACiC,MAAM;;OAGtD,IAAI,CAACA,MAAM,GAAG,IAAI,CAAC7B,UAAU,CAACiB,SAAS,CAACC,aAAa,CAAC;MACtD;KACDtc,GAAG,CAACC,UAAkB,EAAEC,YAAqC,GAAG,EAAE,EAClE;OACC,OAAO,IAAI,CAACC,OAAO,CAACC,GAAG,CAACC,UAAU,CAACJ,UAAU,EAAEC,YAAY,CAAC;MAC5D;KACD+d,eAAe,GACf;OACC,IAAI,IAAI,CAACjD,aAAa,CAACmD,SAAS,EAChC;SACC3C,0BAAS,CAACD,QAAQ,CAAC,IAAI,CAACP,aAAa,CAACS,QAAQ,CAAC;;MAEhD;KACDsC,UAAU,GACV;OACC,OAAO,IAAI,CAAC/C,aAAa,CAAC+C,UAAU;MACpC;KACDK,0BAA0B,GAC1B;OACCpI,6BAAY,CAACC,IAAI,CAACC,+CAAM,CAACmI,iCAAiC,EAAE;SAAEld,MAAM,EAAE,IAAI,CAAC6Z,aAAa,CAACa;QAAgB,CAAC;;IAE3G;GAEDhb,QAAQ,EAAG;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;CAqEZ,CAAC;;CC5NM,MAAMyd,cAAkD,GAAGrgB,MAAM,CAACC,MAAM,CAAC;GAC/E2O,IAAI,EAAE;KACL0R,SAAS,EAAE,mDAAmD;KAC9DC,gBAAgB,EAAE,wDAAwD;KAC1EC,SAAS,EAAE,+EAA+E;KAC1F/V,cAAc,EAAE,kGAAkG;KAClHgW,UAAU,EAAE,0GAA0G;KACtHC,gBAAgB,EAAE,gHAAgH;KAClIC,cAAc,EAAE,qGAAqG;KACrHC,eAAe,EAAE,sGAAsG;KACvHzW,SAAS,EAAE,CAACiR,iBAAiB;IAC7B;GACDyB,OAAO,EAAE;KACRyD,SAAS,EAAE,sDAAsD;KACjEC,gBAAgB,EAAE,2DAA2D;KAC7EC,SAAS,EAAE,kFAAkF;KAC7F/V,cAAc,EAAE,qGAAqG;KACrHgW,UAAU,EAAE,6GAA6G;KACzHC,gBAAgB,EAAE,mHAAmH;KACrIC,cAAc,EAAE,wGAAwG;KACxHC,eAAe,EAAE,yGAAyG;KAC1HzW,SAAS,EAAE,CAACuR,oBAAoB;IAChC;GACDhN,MAAM,EAAE;KACP4R,SAAS,EAAE,qDAAqD;KAChEC,gBAAgB,EAAE,0DAA0D;KAC5EC,SAAS,EAAE,iFAAiF;KAC5F/V,cAAc,EAAE,2FAA2F;KAC3GgW,UAAU,EAAE,mGAAmG;KAC/GC,gBAAgB,EAAE,yGAAyG;KAC3HC,cAAc,EAAE,uGAAuG;KACvHC,eAAe,EAAE,wGAAwG;KACzHzW,SAAS,EAAE,CAACyR,mBAAmB;;CAEjC,CAAC,CAAC;;CClCF;AACA,CAAO,MAAMiF,iBAAiB,GAAG;GAChCrgB,IAAI,EAAE,mBAAmB;GAEzBC,UAAU,EAAE;KACX6J,OAAO;KACPoU;IACA;GAED/d,KAAK,EAAE;;KAENmgB,cAAc,EAAE;OACfjgB,IAAI,EAAEkJ,KAAK;OACXhJ,QAAQ,EAAE;MACV;KACDggB,sBAAsB,EAAE;OACvBlgB,IAAI,EAAEC,MAAM;OACZC,QAAQ,EAAE;MACV;;KAEDigB,sBAAsB,EAAE;OACvBngB,IAAI,EAAEkJ,KAAK;OACXhJ,QAAQ,EAAE;MACV;KACDmE,YAAY,EAAE;OACbrE,IAAI,EAAE6H,OAAO;OACb3H,QAAQ,EAAE;MACV;KACDkgB,OAAO,EAAE;OACRpgB,IAAI,EAAE6H,OAAO;OACb3H,QAAQ,EAAE;MACV;KACDiO,WAAW,EAAE;OACZnO,IAAI,EAAEI,MAAM;OACZF,QAAQ,EAAE;MACV;KACDuE,WAAW,EAAE;OACZzE,IAAI,EAAE,CAACI,MAAM,EAAEH,MAAM,CAAC;OACtBC,QAAQ,EAAE;MACV;KACDmgB,iBAAiB,EAAE;OAClBrgB,IAAI,EAAEI,MAAM;OACZF,QAAQ,EAAE,IAAI;OACdogB,SAAS,EAAGja,KAAK,IAAKlH,MAAM,CAACqG,MAAM,CAAC+a,0EAAsB,CAAC,CAAC1Q,QAAQ,CAACxJ,KAAK;MAC1E;KACD0F,UAAU,EAAE;OACX/L,IAAI,EAAEb,MAAM;OACZe,QAAQ,EAAE;;IAEX;GAEDM,IAAI,GACJ;KACC,OAAO;OACN8b,UAAU,EAAE;MACZ;IACD;GAED5b,QAAQ,EACR;KACC8f,sBAAsB,GACtB;OACC,OAAO,IAAI,CAACJ,OAAO,GAAG,IAAI,CAAC9D,UAAU,CAAChT,SAAS,GAAG,EAAE;MACpD;KACDmX,0BAA0B,GAC1B;OACC,MAAMxZ,MAAM,GAAI,IAAI,CAACgZ,cAAc,CAACte,MAAM,GAAG,CAAC,GAC3C,IAAI,CAAC2a,UAAU,CAACwD,cAAc,GAC9B,IAAI,CAACxD,UAAU,CAACyD,eAAe;OAGlC,OAAO,IAAI,CAACW,SAAS,CAACzZ,MAAM,EAAE,IAAI,CAACiZ,sBAAsB,CAAC;MAC1D;KACDS,uBAAuB,GACvB;OACC,IAAI,IAAI,CAACP,OAAO,EAChB;SACC,OAAO,IAAI,CAAClf,GAAG,CAAC,IAAI,CAACob,UAAU,CAAC1S,cAAc,CAAC;;OAGhD,OAAO,IAAI,CAACvF,YAAY,GACrB,IAAI,CAACnD,GAAG,CAAC,IAAI,CAACob,UAAU,CAACsD,UAAU,CAAC,GACpC,IAAI,CAAC1e,GAAG,CAAC,IAAI,CAACob,UAAU,CAACuD,gBAAgB,CAAC;MAE7C;KACDe,0BAA0B,GAC1B;OACC,OAAO,IAAI,CAACzS,WAAW,CAACxM,MAAM,GAAG,CAAC,IAAI,IAAI,CAACue,sBAAsB,GAAG,CAAC;;IAEtE;GAEDzZ,OAAO,GACP;KACC,IAAI,CAAC6V,UAAU,GAAGkD,cAAc,CAAC,IAAI,CAACa,iBAAiB,CAAC,IAAI,EAAE;IAC9D;GAEDpf,OAAO,EACP;KACCC,GAAG,CAACC,UAAkB,EAAEC,YAAmC,GAAG,EAAE,EAChE;OACC,OAAO,IAAI,CAACC,OAAO,CAACC,GAAG,CAACC,UAAU,CAACJ,UAAU,EAAEC,YAAY,CAAC;MAC5D;KACDsf,SAAS,CAACvf,UAAkB,EAAEuI,KAAa,EAC3C;OACC,OAAOpI,aAAG,CAACuf,gBAAgB,CAAC1f,UAAU,EAAEuI,KAAK,EAAE;SAAE,SAAS,EAAEA;QAAO,CAAC;MACpE;KACD9H,qBAAqB,CAAC,GAAGkf,IAAI,EAC7B;OACC,IAAI,CAACpY,KAAK,CAAC,eAAe,EAAE,GAAGoY,IAAI,CAAC;;IAErC;GAED/e,QAAQ,EAAG;;;;;;;;;;;;;;;;;;;;;;;;;;;CA2BZ,CAAC;;CC/ID,MAAMgf,UAAU,GAAG5hB,MAAM,CAACC,MAAM,CAAC;GAChCkE,YAAY,EAAE,cAAc;GAC5B0d,eAAe,EAAE;CAClB,CAAC,CAAC;;CAEF;AACA,CAAO,MAAMC,oBAAoB,GAAG;GACnCthB,IAAI,EAAE,sBAAsB;GAE5BC,UAAU,EAAE;sBAAEC;IAAiB;GAE/BC,KAAK,EACL;KACCuE,YAAY,EAAE;OACbrE,IAAI,EAAE6H,OAAO;OACb3H,QAAQ,EAAE;MACV;KACD6L,UAAU,EAAE;OACX/L,IAAI,EAAEI,MAAM;OACZF,QAAQ,EAAE;MACV;KACD8Q,aAAa,EAAE;OACdhR,IAAI,EAAE6H,OAAO;OACb3H,QAAQ,EAAE;MACV;KACDghB,IAAI,EAAE;OACLlhB,IAAI,EAAEI,MAAM;OACZF,QAAQ,EAAE;;IAEX;GAEDuH,KAAK,EAAE,CAAC,kBAAkB,CAAC;GAE3BjH,IAAI,GACJ;KACC,OAAO;OACNC,WAAW,EAAE,KAAK;OAClB6C,YAAY,EAAE;MACd;IACD;GAED5C,QAAQ,EACR;KACCygB,oBAAoB,GACpB;OACC,OAAO,IAAI,CAACC,YAAY,CAAC,IAAI,CAAC9d,YAAY,CAAC;;IAE5C;GAEDmD,OAAO,GACP;KACC,IAAI,CAAC6C,SAAS,GAAG,IAAI,CAAC+X,YAAY,EAAE;IACpC;GAEDpgB,OAAO,EACP;KACCC,GAAG,CAACC,UAAkB,EAAEC,YAAqC,GAAG,EAAE,EAClE;OACC,OAAO,IAAI,CAACC,OAAO,CAACC,GAAG,CAACC,UAAU,CAACJ,UAAU,EAAEC,YAAY,CAAC;MAC5D;KACDkgB,QAAQ,GACR;OACC,IAAI,IAAI,CAACtQ,aAAa,EACtB;SACC,IAAI,CAACvQ,WAAW,GAAG,IAAI;;MAExB;KACDmB,qBAAqB,CAACE,QAAgB,EACtC;OACC,IAAI,IAAI,CAACkP,aAAa,EACtB;SACC,IAAI,CAAC1N,YAAY,GAAGxB,QAAQ,KAAKif,UAAU,CAACzd,YAAY;SACxD,IAAI,CAACoF,KAAK,CAAC,kBAAkB,EAAE,IAAI,CAACpF,YAAY,CAAC;;MAElD;KACD+d,YAAY,GACZ;OACC,OAAO,CACN;SACCxf,EAAE,EAAEkf,UAAU,CAACC,eAAe;SAC9BjY,KAAK,EAAE,IAAI,CAACqY,YAAY,CAAC,KAAK,CAAC;SAC/BG,SAAS,EAAE,gEAAgE;SAC3ExV,UAAU,EAAE;QACZ,EACD;SACClK,EAAE,EAAEkf,UAAU,CAACzd,YAAY;SAC3ByF,KAAK,EAAE,IAAI,CAACqY,YAAY,CAAC,IAAI,CAAC;SAC9BG,SAAS,EAAE,gEAAgE;SAC3ExV,UAAU,EAAE;QACZ,CACD;MACD;KACDqV,YAAY,CAAC/a,KAAc,EAC3B;OACC,IAAI,IAAI,CAAChC,YAAY,EACrB;SACC,OAAOgC,KAAK,GACT,IAAI,CAACnF,GAAG,CAAC,mFAAmF,CAAC,GAC7F,IAAI,CAACA,GAAG,CAAC,+EAA+E,CAAC;;OAI7F,OAAOmF,KAAK,GACT,IAAI,CAACnF,GAAG,CAAC,yFAAyF,CAAC,GACnG,IAAI,CAACA,GAAG,CAAC,qFAAqF,CAAC;;IAGnG;GAEDa,QAAQ,EAAG;;;;;;;;;;;;;;;;;;;;;;;;CAwBZ,CAAC;;CC/HM,MAAMyf,gBAAsD,GAAGriB,MAAM,CAACC,MAAM,CAAC;GACnF2O,IAAI,EAAE;KACL4O,QAAQ,EAAE,yDAAyD;KACnE5T,KAAK,EAAE,sFAAsF;KAC7F7B,WAAW,EAAE;OACZzF,IAAI,EAAE,0FAA0F;OAChGpB,OAAO,EAAE;MACT;KACDohB,gBAAgB,EAAE,+EAA+E;KACjGlY,WAAW,EAAE6R,yBAAyB;KACtCsG,eAAe,EAAE,MAAcC,uEAAmB,EAAE;KACpDC,iBAAiB,EAAG3Z,IAA2B,IAAc,OAAMA,IAAI,CAACpG,EAAG,EAAC;KAC5EggB,iBAAiB,EAAG5Z,IAA2B;OAAA;OAAA,OAAahI,MAAM,aAACgI,IAAI,CAACpG,EAAE,qBAAP,SAASsF,OAAO,CAAC,MAAM,EAAE,EAAE,CAAC,CAAC;;IAChG;GACD6U,OAAO,EAAE;KACRW,QAAQ,EAAE,4DAA4D;KACtE5T,KAAK,EAAE,yFAAyF;KAChG7B,WAAW,EAAE;OACZzF,IAAI,EAAE,6FAA6F;OACnGpB,OAAO,EAAE;MACT;KACDohB,gBAAgB,EAAE,kFAAkF;KACpGlY,WAAW,EAAEkS,4BAA4B;KACzCiG,eAAe,EAAE,MAAcI,0EAAsB,EAAE;KACvDF,iBAAiB,EAAG3Z,IAA2B,IAAc,OAAMA,IAAI,CAACpG,EAAG,EAAC;KAC5EggB,iBAAiB,EAAG5Z,IAA2B;OAAA;OAAA,OAAahI,MAAM,cAACgI,IAAI,CAACpG,EAAE,qBAAP,UAASsF,OAAO,CAAC,MAAM,EAAE,EAAE,CAAC,CAAC;;IAChG;GACD0G,MAAM,EAAE;KACP8O,QAAQ,EAAE,4DAA4D;KACtE5T,KAAK,EAAE,wFAAwF;KAC/F7B,WAAW,EAAE;OACZzF,IAAI,EAAE,4FAA4F;OAClGpB,OAAO,EAAE;MACT;KACDohB,gBAAgB,EAAE,iFAAiF;KACnGlY,WAAW,EAAEmS,2BAA2B;KACxCgG,eAAe,EAAE,MAAcK,yEAAqB,EAAE;KACtDH,iBAAiB,EAAG3Z,IAA2B,IAAsBhI,MAAM,CAACgI,IAAI,CAACpG,EAAE,CAAC;KACpFggB,iBAAiB,EAAG5Z,IAA2B,IAAahI,MAAM,CAACgI,IAAI,CAACpG,EAAE;;CAE5E,CAAC,CAAC;;CCpCF;AACA,CAAO,MAAMmgB,UAAU,GAAG;GACzBriB,IAAI,EAAE,YAAY;GAElBC,UAAU,EAAE;uBAAEqiB,oEAAgB;KAAEhB;IAAsB;GAEtDnhB,KAAK,EAAE;;KAENmgB,cAAc,EAAE;OACfjgB,IAAI,EAAEkJ,KAAK;OACXhJ,QAAQ,EAAE;MACV;KACDmgB,iBAAiB,EAAE;OAClBrgB,IAAI,EAAEI,MAAM;OACZF,QAAQ,EAAE,IAAI;OACdogB,SAAS,EAAGja,KAAK,IAAKlH,MAAM,CAACqG,MAAM,CAAC+a,0EAAsB,CAAC,CAAC1Q,QAAQ,CAACxJ,KAAK;MAC1E;KACD5B,WAAW,EAAE;OACZzE,IAAI,EAAE,CAACI,MAAM,EAAEH,MAAM,CAAC;OACtBC,QAAQ,EAAE;MACV;KACDmE,YAAY,EAAE;OACbrE,IAAI,EAAE6H,OAAO;OACb3H,QAAQ,EAAE;MACV;KACDC,UAAU,EAAE;OACXH,IAAI,EAAEI,MAAM;OACZF,QAAQ,EAAE;MACV;KACDgiB,SAAS,EAAE;OACVliB,IAAI,EAAE6H,OAAO;OACb3H,QAAQ,EAAE;MACV;KACDiiB,kBAAkB,EAAE;OACnBniB,IAAI,EAAE6H,OAAO;OACb3H,QAAQ,EAAE;;IAEX;GAEDuH,KAAK,EAAE,CAAC,OAAO,EAAE,YAAY,CAAC;GAE9BjH,IAAI,GACJ;KACC,OAAO;OACN4hB,YAAY,EAAE,KAAK;OACnBC,eAAe,EAAE,KAAK;OACtB/F,UAAU,EAAE;MACZ;IACD;GAED5b,QAAQ,EACR;KACC4hB,cAAc,GACd;OACC,MAAMC,MAAM,GAAG,IAAI,CAACjG,UAAU,CAACoF,eAAe,EAAE;OAChDa,MAAM,CAAC3V,OAAO,CAAC4V,UAAU,GAAG,IAAI,CAACvC,cAAc,CAACnR,GAAG,CAAE7G,IAAI,IAAKA,IAAI,CAACpG,EAAE,CAAC;OAEtE,OAAO,CAAC0gB,MAAM,CAAC;MACf;KACDE,sBAAsB,GACtB;OACC,OAAOC,qFAAiC,CAAC,IAAI,CAACviB,UAAU,EAAE,IAAI,CAACkgB,iBAAiB,CAAC;MACjF;KACDsC,SAAS,GACT;OACC,OAAO,IAAI,CAAC1C,cAAc,CAACnR,GAAG,CAAE7G,IAAI,IAAK,IAAI,CAACqU,UAAU,CAACsF,iBAAiB,CAAC3Z,IAAI,CAAC,CAAC;MACjF;KACD2a,cAAc,GACd;OACC,OAAO,IAAI,CAACve,YAAY,GACrB,IAAI,CAACnD,GAAG,CAAC,IAAI,CAACob,UAAU,CAACpV,WAAW,CAACzF,IAAI,CAAC,GAC1C,IAAI,CAACP,GAAG,CAAC,IAAI,CAACob,UAAU,CAACpV,WAAW,CAAC7G,OAAO,CAAC;;IAGjD;GAEDoG,OAAO,GACP;KACC,IAAI,CAAC6V,UAAU,GAAGkF,gBAAgB,CAAC,IAAI,CAACnB,iBAAiB,CAAC,IAAI,EAAE;IAChE;GAEDpf,OAAO,EACP;KACCC,GAAG,CAACC,UAAkB,EAAEC,YAAY,GAAG,EAAE,EACzC;OACC,OAAO,IAAI,CAACC,OAAO,CAACC,GAAG,CAACC,UAAU,CAACJ,UAAU,EAAEC,YAAY,CAAC;MAC5D;KACD,MAAMyhB,YAAY,CAACnhB,KAAY,EAC/B;OACC,IAAI,CAAC0gB,YAAY,GAAG,IAAI;OACxB,MAAMU,SAAS,GAAGphB,KAAK,CAACoN,GAAG,CAAE7G,IAAI,IAAK,IAAI,CAACqU,UAAU,CAACuF,iBAAiB,CAAC5Z,IAAI,CAAC,CAAC;OAE9E,IACA;SACC,MAAM5F,MAAM,GAAG,IAAI,CAACoC,WAAW;SAC/B,MAAM4d,eAAe,GAAGpiB,MAAM,CAAC,IAAI,CAACoiB,eAAe,CAAC;SAEpD,QAAQ,IAAI,CAAChC,iBAAiB;WAE7B,KAAKE,0EAAsB,CAACxS,IAAI;aAC/B,MAAM/L,aAAa,CAACmB,SAAS,CAACd,MAAM,EAAEygB,SAAS,EAAE,EAAE,EAAET,eAAe,CAAC;aACrE;WACD,KAAK9B,0EAAsB,CAACvE,OAAO;aAClC,MAAMha,aAAa,CAACuB,WAAW,CAAClB,MAAM,EAAEygB,SAAS,EAAE,EAAE,EAAET,eAAe,CAAC;aACvE;WACD,KAAK9B,0EAAsB,CAAC1S,MAAM;aACjC,MAAM7L,aAAa,CAACwB,UAAU,CAACnB,MAAM,EAAEygB,SAAS,EAAE,EAAE,EAAET,eAAe,CAAC;aACtE;WACD;aACC;;SAGF,IAAI,CAAC3Z,KAAK,CAAC,YAAY,CAAC;SACxB,IAAI,IAAI,CAAC2Z,eAAe,EACxB;WACC,MAAMhV,KAAK,GAAGrM,wDAAa,EAAE;WAC7BqM,KAAK,CAAC2P,0BAA0B,CAAC3a,MAAM,CAAC;;QAEzC,CACD,MACA;OACA,IAAI,CAACggB,eAAe,GAAG,KAAK;OAC5B,IAAI,CAACD,YAAY,GAAG,KAAK;OACzB,IAAI,CAAC1Z,KAAK,CAAC,OAAO,CAAC;;IAEpB;GAED3G,QAAQ,EAAG;;;;;;;;;;;;;;;;;;;;;;;;;CAyBZ,CAAC;;CC/IM,MAAMghB,QAAQ,GAAG;GACvBpjB,IAAI,EAAE,UAAU;GAEhBC,UAAU,EAAE;KACXiM,WAAW;KACX/C,UAAU;KACV6S,kBAAkB;KAClBqE,iBAAiB;KACjBgC;IACA;GAEDxhB,IAAI,GACJ;KACC,OAAO;OACNwiB,qBAAqB,EAAE,KAAK;OAC5BC,wBAAwB,EAAE,KAAK;OAC/BC,uBAAuB,EAAE,KAAK;OAC9BC,SAAS,EAAE,KAAK;OAChBhV,WAAW,EAAE,EAAE;OACfsC,iBAAiB,EAAE;MACnB;IACD;GAEDxP,OAAO,EACP;KACCC,GAAG,CAACC,UAAkB,EAAEC,YAAmC,GAAG,EAAE,EAChE;OACC,OAAO,IAAI,CAACC,OAAO,CAACC,GAAG,CAACC,UAAU,CAACJ,UAAU,EAAEC,YAAY,CAAC;MAC5D;KACDsf,SAAS,CAACvf,UAAkB,EAAEuI,KAAa,EAC3C;OACC,OAAOpI,aAAG,CAACuf,gBAAgB,CAAC1f,UAAU,EAAEuI,KAAK,EAAE;SAAE,SAAS,EAAEA;QAAO,CAAC;MACpE;KACD0Z,mBAAmB,CAACjV,WAAmB,EACvC;OACC,IAAI,CAACA,WAAW,GAAGA,WAAW;MAC9B;KACD,MAAMkV,cAAc,CAACC,KAAc,EACnC;OAAA;OACC,IAAI,IAAI,CAACH,SAAS,EAClB;SACC,OAAO,IAAI;;OAGZ,MAAM9gB,MAAM,GAAG,IAAI,CAACoC,WAAW;OAC/B,MAAMlE,UAAU,GAAG,IAAI,CAAC4E,WAAW,CAACC,GAAG,CAAC/C,MAAM,CAAC;OAE/C,IAAI,CAAC9B,UAAU,EACf;SACC,OAAO,IAAI;;OAGZ,IAAI,CAAC+iB,KAAK,IACNnZ,cAAI,CAACoZ,OAAO,CAAChjB,UAAU,CAACgN,aAAa,CAAC,IACtCpD,cAAI,CAACoZ,OAAO,CAAChjB,UAAU,CAAC+M,gBAAgB,CAAC,IACzCnD,cAAI,CAACoZ,OAAO,CAAChjB,UAAU,CAACiN,eAAe,CAAC,EAE5C;SACC,OAAO;WACNT,KAAK,EAAExM,UAAU,CAACgN,aAAa;WAC/BP,QAAQ,EAAEzM,UAAU,CAAC+M,gBAAgB;WACrCL,OAAO,EAAE1M,UAAU,CAACiN,eAAe;WACnCN,aAAa,EAAE3M,UAAU,CAAC2M,aAAa;WACvCC,gBAAgB,EAAE5M,UAAU,CAAC4M,gBAAgB;WAC7CC,eAAe,EAAE7M,UAAU,CAAC6M;UAC5B;;OAGF,IAAI,CAAC+V,SAAS,GAAG,IAAI;OAErB,IAAI,CAACza,KAAK,CAAC,kBAAkB,CAAC;OAC9B,MAAM8a,sBAAsB,GAAG,MAAMxhB,aAAa,CAACkB,mBAAmB,CAACb,MAAM,CAAC;OAC9EgK,wBAAwB,CAACS,mBAAmB,CAC3CzK,MAAM,2BACNmhB,sBAAsB,CAACzW,KAAK,oCAAI,EAAE,4BAClCyW,sBAAsB,CAACxW,QAAQ,qCAAI,EAAE,4BACrCwW,sBAAsB,CAACvW,OAAO,qCAAI,EAAE,4BACpCuW,sBAAsB,CAACtW,aAAa,qCAAI,CAAC,4BACzCsW,sBAAsB,CAACrW,gBAAgB,qCAAI,CAAC,4BAC5CqW,sBAAsB,CAACpW,eAAe,qCAAI,CAAC,CAC3C;OACD,IAAI,CAAC1E,KAAK,CAAC,kBAAkB,CAAC;OAC9B,IAAI,CAACya,SAAS,GAAG,KAAK;OAEtB,OAAOK,sBAAsB;MAC7B;KACD5hB,qBAAqB,CAACE,QAAgB,EACtC;OACC,QAAQA,QAAQ;SAEf,KAAKqY,eAAe,CAACC,QAAQ;WAC5B,IAAI,CAAC4I,qBAAqB,GAAG,IAAI;WACjC;SACD,KAAK7I,eAAe,CAACE,WAAW;WAC/B,IAAI,CAAC4I,wBAAwB,GAAG,IAAI;WACpC;SACD,KAAK9I,eAAe,CAACG,UAAU;WAC9B,IAAI,CAAC4I,uBAAuB,GAAG,IAAI;WACnC;SACD;WACC;;MAEF;KACDO,oBAAoB,GACpB;OACC,IAAIC,UAAU,GAAG,EAAE;OAEnB,IAAI,IAAI,CAACC,kBAAkB,IAAI,IAAI,CAACtf,YAAY,EAChD;SACCqf,UAAU,GAAG,CACZ,IAAI,CAACxiB,GAAG,CAAC,oHAAoH,CAAC,EAC9H,IAAI,CAACA,GAAG,CAAC,+GAA+G,CAAC,EACzH,IAAI,CAACA,GAAG,CAAC,oHAAoH,CAAC,CAC9H;QACD,MACI,IAAI,IAAI,CAACyiB,kBAAkB,EAChC;SACCD,UAAU,GAAG,CACZ,IAAI,CAACxiB,GAAG,CAAC,+GAA+G,CAAC,EACzH,IAAI,CAACA,GAAG,CAAC,+GAA+G,CAAC,EACzH,IAAI,CAACA,GAAG,CAAC,+GAA+G,CAAC,CACzH;QACD,MACI,IAAI,IAAI,CAACmD,YAAY,EAC1B;SACCqf,UAAU,GAAG,CACZ,IAAI,CAACxiB,GAAG,CAAC,mHAAmH,CAAC,EAC7H,IAAI,CAACA,GAAG,CAAC,qGAAqG,CAAC,EAC/G,IAAI,CAACA,GAAG,CAAC,0GAA0G,CAAC,CACpH;QACD,MAED;SACCwiB,UAAU,GAAG,CACZ,IAAI,CAACxiB,GAAG,CAAC,8GAA8G,CAAC,EACxH,IAAI,CAACA,GAAG,CAAC,qGAAqG,CAAC,EAC/G,IAAI,CAACA,GAAG,CAAC,qGAAqG,CAAC,CAC/G;;OAGF,OAAOwiB,UAAU,CAAC5U,GAAG,CAAE7G,IAAI,KAAM;SAAEiZ,IAAI,EAAEjZ;QAAM,CAAC,CAAC;;IAElD;GAEDvH,QAAQ,EACR;KACCijB,kBAAkB,GAClB;OACC,OAAOjT,mEAAiB,CAACC,WAAW,EAAE,CAACgT,kBAAkB;MACzD;KACDC,kBAAkB,GAClB;OACC,OAAOrD,0EAAsB;MAC7B;KACDxT,KAAK,GACL;OAAA;OACC,0DAAO,IAAI,CAAC5H,WAAW,CAACC,GAAG,CAAC,IAAI,CAACX,WAAW,CAAC,qBAAtC,uBAAwC8I,aAAa,oCAAI,EAAE;MAClE;KACDP,QAAQ,GACR;OAAA;OACC,2DAAO,IAAI,CAAC7H,WAAW,CAACC,GAAG,CAAC,IAAI,CAACX,WAAW,CAAC,qBAAtC,uBAAwC6I,gBAAgB,qCAAI,EAAE;MACrE;KACDL,OAAO,GACP;OAAA;OACC,2DAAO,IAAI,CAAC9H,WAAW,CAACC,GAAG,CAAC,IAAI,CAACX,WAAW,CAAC,qBAAtC,uBAAwC+I,eAAe,qCAAI,EAAE;MACpE;KACDN,aAAa,GACb;OAAA;OACC,2DAAO,IAAI,CAAC/H,WAAW,CAACC,GAAG,CAAC,IAAI,CAACX,WAAW,CAAC,qBAAtC,uBAAwCyI,aAAa,qCAAI,CAAC;MACjE;KACDC,gBAAgB,GAChB;OAAA;OACC,4DAAO,IAAI,CAAChI,WAAW,CAACC,GAAG,CAAC,IAAI,CAACX,WAAW,CAAC,qBAAtC,wBAAwC0I,gBAAgB,qCAAI,CAAC;MACpE;KACDC,eAAe,GACf;OAAA;OACC,6DAAO,IAAI,CAACjI,WAAW,CAACC,GAAG,CAAC,IAAI,CAACX,WAAW,CAAC,qBAAtC,wBAAwC2I,eAAe,sCAAI,CAAC;MACnE;KACDyW,aAAa,GACb;OACC,OAAO,IAAI,CAAC9W,KAAK,CAACe,MAAM,CACtBC,IAAI,IAAKA,IAAI,CAAChF,KAAK,CAAC6G,WAAW,EAAE,CAACC,QAAQ,CAAC,IAAI,CAAC1B,WAAW,CAACyB,WAAW,EAAE,CAAC,CAC3E;MACD;KACDkU,gBAAgB,GAChB;OACC,OAAO,IAAI,CAAC9W,QAAQ,CAACc,MAAM,CACzBkO,OAAO,IAAKA,OAAO,CAACjT,KAAK,CAAC6G,WAAW,EAAE,CAACC,QAAQ,CAAC,IAAI,CAAC1B,WAAW,CAACyB,WAAW,EAAE,CAAC,CACjF;MACD;KACDmU,eAAe,GACf;OACC,OAAO,IAAI,CAAC9W,OAAO,CAACa,MAAM,CACxBD,MAAM,IAAKA,MAAM,CAAC9E,KAAK,CAAC6G,WAAW,EAAE,CAACC,QAAQ,CAAC,IAAI,CAAC1B,WAAW,CAACyB,WAAW,EAAE,CAAC,CAC/E;MACD;KACDoU,iBAAiB,GACjB;OACC,OAAO,IAAI,CAACjX,KAAK,CAACpL,MAAM,KAAK,CAAC,IAC1B,IAAI,CAACqL,QAAQ,CAACrL,MAAM,KAAK,CAAC,IAC1B,IAAI,CAACsL,OAAO,CAACtL,MAAM,KAAK,CAAC,IACzB,IAAI,CAACuL,aAAa,KAAK,CAAC,IACxB,IAAI,CAACC,gBAAgB,KAAK,CAAC,IAC3B,IAAI,CAACC,eAAe,KAAK,CAAC;MAE9B;KACDmD,oBAAoB,GACpB;OACC,OAAO,CAAC,IAAI,CAACxD,KAAK,CAACpL,MAAM,GAAG,CAAC,IAAI,IAAI,CAACqL,QAAQ,CAACrL,MAAM,GAAG,CAAC,IAAI,IAAI,CAACsL,OAAO,CAACtL,MAAM,GAAG,CAAC,KAChF,IAAI,CAACkiB,aAAa,CAACliB,MAAM,KAAK,CAAC,IAC/B,IAAI,CAACmiB,gBAAgB,CAACniB,MAAM,KAAK,CAAC,IAClC,IAAI,CAACoiB,eAAe,CAACpiB,MAAM,KAAK,CAAC;MAErC;KACDsiB,cAAc,GACd;OACC,MAAM1jB,UAAU,GAAG,IAAI,CAAC4E,WAAW,CAACC,GAAG,CAAC,IAAI,CAACX,WAAW,CAAC;OAEzD,OAAOoD,OAAO,CAACsC,cAAI,CAACoZ,OAAO,CAAChjB,UAAU,CAACgN,aAAa,CAAC,IACjDpD,cAAI,CAACoZ,OAAO,CAAChjB,UAAU,CAAC+M,gBAAgB,CAAC,IACzCnD,cAAI,CAACoZ,OAAO,CAAChjB,UAAU,CAACiN,eAAe,CAAC,CAAC;MAE7C;KACDrN,UAAU,GACV;OAAA;OACC,kCAAO,IAAI,CAACgF,WAAW,CAACC,GAAG,CAAC,IAAI,CAACX,WAAW,CAAC,qBAAtC,wBAAwCtE,UAAU;MACzD;KACDkE,YAAY,GACZ;OACC,OAAO,IAAI,CAAClE,UAAU,KAAKG,iDAAW,CAACmB,IAAI;MAC3C;KACDyiB,qBAAqB,GACrB;OACC,IAAI,IAAI,CAACP,kBAAkB,EAC3B;SACC,OAAO,IAAI,CAACtf,YAAY,GACrB,IAAI,CAACnD,GAAG,CAAC,8GAA8G,CAAC,GACxH,IAAI,CAACA,GAAG,CAAC,yGAAyG,CAAC;;OAIvH,OAAO,IAAI,CAACmD,YAAY,GACrB,IAAI,CAACnD,GAAG,CAAC,oGAAoG,CAAC,GAC9G,IAAI,CAACA,GAAG,CAAC,+FAA+F,CAAC;MAE5G;KACD0a,WAAW,GACX;OACC,OAAO,IAAI,CAACvX,YAAY,GACrB,IAAI,CAACoM,iBAAiB,CAACO,aAAa,CAACH,mEAAiB,CAACsT,YAAY,EAAE,IAAI,CAAC1f,WAAW,CAAC,GACtF,IAAI,CAACgM,iBAAiB,CAACO,aAAa,CAACH,mEAAiB,CAACuT,kBAAkB,EAAE,IAAI,CAAC3f,WAAW,CAAC;MAE/F;KACDoX,cAAc,GACd;OACC,OAAO,IAAI,CAACxX,YAAY,GACrB,IAAI,CAACoM,iBAAiB,CAACO,aAAa,CAACH,mEAAiB,CAACwT,eAAe,EAAE,IAAI,CAAC5f,WAAW,CAAC,GACzF,IAAI,CAACgM,iBAAiB,CAACO,aAAa,CAACH,mEAAiB,CAACyT,qBAAqB,EAAE,IAAI,CAAC7f,WAAW,CAAC;MAElG;KACDqX,aAAa,GACb;OACC,OAAO,IAAI,CAACzX,YAAY,GACrB,IAAI,CAACoM,iBAAiB,CAACO,aAAa,CAACH,mEAAiB,CAAC0T,cAAc,EAAE,IAAI,CAAC9f,WAAW,CAAC,GACxF,IAAI,CAACgM,iBAAiB,CAACO,aAAa,CAACH,mEAAiB,CAAC2T,oBAAoB,EAAE,IAAI,CAAC/f,WAAW,CAAC;MAEjG;KACDggB,sBAAsB,GACtB;OACC,IAAI,IAAI,CAACpgB,YAAY,EACrB;SACC,OAAO,IAAI,CAACoM,iBAAiB,CAACO,aAAa,CAC1CH,mEAAiB,CAACsT,YAAY,EAC9B,IAAI,CAAC1f,WAAW,EAChB;WAAEigB,IAAI,EAAEC,kEAAgB,CAACC;UAAY,CACrC,IACG,IAAI,CAACnU,iBAAiB,CAACO,aAAa,CACtCH,mEAAiB,CAACsT,YAAY,EAC9B,IAAI,CAAC1f,WAAW,EAChB;WAAEogB,UAAU,EAAEF,kEAAgB,CAACC;UAAY,CAC3C;;OAIH,OAAO,IAAI,CAACnU,iBAAiB,CAACO,aAAa,CAC1CH,mEAAiB,CAACuT,kBAAkB,EACpC,IAAI,CAAC3f,WAAW,EAChBkgB,kEAAgB,CAACC,UAAU,CAC3B;MACD;KACDE,yBAAyB,GACzB;OACC,IAAI,IAAI,CAACzgB,YAAY,EACrB;SACC,OAAO,IAAI,CAACoM,iBAAiB,CAACO,aAAa,CAC1CH,mEAAiB,CAACwT,eAAe,EACjC,IAAI,CAAC5f,WAAW,EAChB;WAAEigB,IAAI,EAAEC,kEAAgB,CAACC;UAAY,CACrC,IACG,IAAI,CAACnU,iBAAiB,CAACO,aAAa,CACtCH,mEAAiB,CAACwT,eAAe,EACjC,IAAI,CAAC5f,WAAW,EAChB;WAAEogB,UAAU,EAAEF,kEAAgB,CAACC;UAAY,CAC3C;;OAIH,OAAO,IAAI,CAACnU,iBAAiB,CAACO,aAAa,CAC1CH,mEAAiB,CAACyT,qBAAqB,EACvC,IAAI,CAAC7f,WAAW,EAChBkgB,kEAAgB,CAACC,UAAU,CAC3B;MACD;KACDG,wBAAwB,GACxB;OACC,IAAI,IAAI,CAAC1gB,YAAY,EACrB;SACC,OAAO,IAAI,CAACoM,iBAAiB,CAACO,aAAa,CAC1CH,mEAAiB,CAAC0T,cAAc,EAChC,IAAI,CAAC9f,WAAW,EAChB;WAAEigB,IAAI,EAAEC,kEAAgB,CAACC;UAAY,CACrC,IACG,IAAI,CAACnU,iBAAiB,CAACO,aAAa,CACtCH,mEAAiB,CAAC0T,cAAc,EAChC,IAAI,CAAC9f,WAAW,EAChB;WAAEogB,UAAU,EAAEF,kEAAgB,CAACC;UAAY,CAC3C;;OAIH,OAAO,IAAI,CAACnU,iBAAiB,CAACO,aAAa,CAC1CH,mEAAiB,CAAC2T,oBAAoB,EACtC,IAAI,CAAC/f,WAAW,EAChBkgB,kEAAgB,CAACC,UAAU,CAC3B;MACD;KACDI,iBAAiB,GACjB;OACC,OAAO,IAAI,CAAC7W,WAAW,CAACxM,MAAM,GAAG,CAAC,IAAI,IAAI,CAACuL,aAAa,GAAG,CAAC;MAC5D;KACD+X,oBAAoB,GACpB;OACC,OAAO,IAAI,CAAC9W,WAAW,CAACxM,MAAM,GAAG,CAAC,IAAI,IAAI,CAACwL,gBAAgB,GAAG,CAAC;MAC/D;KACD+X,sBAAsB,GACtB;OACC,OAAOjK,mBAAmB;MAC1B;KACDkK,yBAAyB,GACzB;OACC,OAAOjK,sBAAsB;MAC7B;KACDkK,wBAAwB,GACxB;OACC,OAAOjK,qBAAqB;MAC5B;KACD,GAAGpa,sBAAQ,CAACC,wDAAa,EAAE,CAAC,aAAa,EAAE,aAAa,CAAC;IACzD;GAEDqJ,KAAK,EACL;KACC4Z,cAAc,CAACoB,aAAa,EAC5B;OACC,IAAIA,aAAa,KAAK,KAAK,EAC3B;SACC,IAAI,CAAChC,cAAc,EAAE;;;IAGvB;GAED5c,OAAO,GACP;KACC,IAAI,CAACgK,iBAAiB,GAAGC,mEAAiB,CAACC,WAAW,EAAE;KACxD,IAAI,CAAC0S,cAAc,EAAE;IACrB;GAEDthB,QAAQ,EAAG;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;CA8GZ,CAAC;;CClfD;AACA,OAAaujB,iBAAiB,GAAG;GAChC3lB,IAAI,EAAE,mBAAmB;GAEzBC,UAAU,EAAE;KAAEqO,QAAQ;KAAE8U;IAAU;GAElCjjB,KAAK,EAAE;KACNylB,WAAW,EAAE1d;IACb;GAEDJ,KAAK,EAAE,CAAC,kBAAkB,EAAE,kBAAkB,EAAE,cAAc,CAAC;GAE/DjH,IAAI,GACJ;KACC,OAAO;OACNglB,SAAS,EAAE,UAAU;OACrBC,IAAI,EAAE,CACL;SAAE9lB,IAAI,EAAE,UAAU;SAAE+lB,SAAS,EAAE,UAAU;SAAE7jB,EAAE,EAAE;QAAa,EAC5D;SAAElC,IAAI,EAAE,UAAU;SAAE+lB,SAAS,EAAE,UAAU;SAAE7jB,EAAE,EAAE;QAAa,CAC5D;OACD8jB,uBAAuB,EAAE,KAAK;OAC9BhT,qBAAqB,EAAE;MACvB;IACD;GAEDjS,QAAQ,EACR;KACCijB,kBAAkB,GAClB;OACC,OAAOjT,mEAAiB,CAACC,WAAW,EAAE,CAACgT,kBAAkB;MACzD;KACDiC,kBAAkB,GAClB;OACC,MAAMJ,SAAS,GAAG,IAAI,CAACC,IAAI,CAAChgB,IAAI,CAAEogB,GAAG,IAAKA,GAAG,CAAClmB,IAAI,KAAK,IAAI,CAAC6lB,SAAS,CAAC;OAEtE,OAAOA,SAAS,GAAGA,SAAS,CAACE,SAAS,GAAG,IAAI;MAC7C;KACDI,UAAU,GACV;OAAA;OACC,0DAAO,IAAI,CAAC3gB,WAAW,CAACC,GAAG,CAAC,IAAI,CAACX,WAAW,CAAC,qBAAtC,uBAAwCuL,SAAS,oCAAI,CAAC;MAC7D;KACDvC,mBAAmB,GACnB;OAAA;OACC,2DAAO,IAAI,CAACtI,WAAW,CAACC,GAAG,CAAC,IAAI,CAACX,WAAW,CAAC,qBAAtC,uBAAwCgJ,mBAAmB,qCAAI,IAAI;MAC1E;KACDsY,QAAQ,GACR;OACC,OAAO,IAAI,CAACN,IAAI,CAAC3W,GAAG,CAAE+W,GAAG,IAAK;SAC7B,IAAIA,GAAG,CAAClmB,IAAI,KAAK,UAAU,EAC3B;WACC,OAAO;aACN,GAAGkmB,GAAG;aACNnc,KAAK,EAAE,IAAI,CAACoc;YACZ;;SAGF,IAAID,GAAG,CAAClmB,IAAI,KAAK,UAAU,EAC3B;WACC,OAAO;aACN,GAAGkmB,GAAG;aACNnc,KAAK,EAAE,IAAI,CAAC+D;YACZ;;SAGF,OAAOoY,GAAG;QACV,CAAC;MACF;KACD3e,WAAW,GACX;OACC,MAAM3G,UAAU,GAAG,IAAI,CAAC4E,WAAW,CAACC,GAAG,CAAC,IAAI,CAACX,WAAW,CAAC;OACzD,IAAI,CAAClE,UAAU,CAAC2G,WAAW,EAC3B;SACC,OAAO,IAAI;;OAGZ,OAAO3G,UAAU,CAAC2G,WAAW;MAC7B;KACD7C,YAAY,GACZ;OAAA;OACC,OAAO,+BAAI,CAACc,WAAW,CAACC,GAAG,CAAC,IAAI,CAACX,WAAW,CAAC,qBAAtC,uBAAwCtE,UAAU,MAAKG,iDAAW,CAACmB,IAAI;MAC9E;KACD,GAAGV,sBAAQ,CAACC,wDAAa,EAAE,CAAC,aAAa,EAAE,aAAa,CAAC;IACzD;GAEDqJ,KAAK,EACL;KACCnD,WAAW,GACX;OACC,IAAI,CAAC4L,SAAS,CAAC,MAAM;SACpB,IAAI,CAAC6S,uBAAuB,GAAG,IAAI,CAACK,0BAA0B,EAAE;QAChE,CAAC;MACF;KACDvhB,WAAW,GACX;OACC,IAAI,CAACkO,qBAAqB,GAAG,KAAK;OAClC,IAAI,CAACsT,SAAS,CAAC,UAAU,CAAC;MAC1B;KACDV,WAAW,GACX;OACC,IAAI,CAACzS,SAAS,CAAC,MAAM;SACpB,IAAI,CAAC6S,uBAAuB,GAAG,IAAI,CAACK,0BAA0B,EAAE;QAChE,CAAC;;IAEH;GAED/kB,OAAO,EACP;KACCC,GAAG,CAACC,UAAkB,EAAEC,YAAmC,GAAG,EAAE,EAChE;OACC,OAAO,IAAI,CAACC,OAAO,CAACC,GAAG,CAACC,UAAU,CAACJ,UAAU,EAAEC,YAAY,CAAC;MAC5D;KACD6kB,SAAS,CAACC,OAAO,EACjB;OACC,IAAI,IAAI,CAACC,aAAa,CAACD,OAAO,CAAC,EAC/B;SACC;;OAED,IAAI,CAACV,SAAS,GAAGU,OAAO;MACxB;KACDE,WAAW,CAACzmB,IAAY,EACxB;OACC,IAAIA,IAAI,KAAK,UAAU,EACvB;SACC,OAAO,IAAI,CAAC0E,YAAY,GACrB,IAAI,CAACnD,GAAG,CAAC,0EAA0E,CAAC,GACpF,IAAI,CAACA,GAAG,CAAC,qEAAqE,CAAC;;OAGnF,IAAIvB,IAAI,KAAK,UAAU,EACvB;SACC,OAAO,IAAI,CAACgkB,kBAAkB,GAC3B,IAAI,CAACziB,GAAG,CAAC,+EAA+E,CAAC,GACzF,IAAI,CAACA,GAAG,CAAC,qEAAqE,CAAC;;OAInF,OAAO,EAAE;MACT;KACDmlB,uBAAuB,GACvB;OACC,IAAI,CAAC1T,qBAAqB,GAAG,CAAC,IAAI,CAACA,qBAAqB;MACxD;KACDqT,0BAA0B,GAC1B;OAAA;OACC,MAAMM,oBAAoB,4BAAG,IAAI,CAAC7b,KAAK,CAAC6b,oBAAoB,oCAAI,IAAI;OACpE,IAAIA,oBAAoB,EACxB;SACC,OAAOA,oBAAoB,CAACnS,YAAY,GAAGmS,oBAAoB,CAACpS,YAAY;;OAG7E,OAAO,KAAK;MACZ;KACDqS,gBAAgB,GAChB;OACC,IAAI,CAAC7d,KAAK,CAAC,kBAAkB,CAAC;OAC9B,IAAI,CAACoK,SAAS,CAAC,MAAM;SACpB,IAAI,CAAC6S,uBAAuB,GAAG,IAAI,CAACK,0BAA0B,EAAE;QAChE,CAAC;MACF;KACDG,aAAa,CAACD,OAAe,EAC7B;OACC,IAAIA,OAAO,KAAK,UAAU,IAAI,IAAI,CAACH,QAAQ,CAACtgB,IAAI,CAAEogB,GAAG,IAAKA,GAAG,CAAClmB,IAAI,KAAKumB,OAAO,CAAC,CAACxc,KAAK,KAAK,CAAC,EAC3F;SACC,MAAM+G,iBAAiB,GAAGC,mEAAiB,CAACC,WAAW,EAAE;SACzD,MAAM6V,YAAY,GAAG,IAAI,CAACniB,YAAY,GAEpCoM,iBAAiB,CAACO,aAAa,CAACH,mEAAiB,CAACsT,YAAY,EAAE,IAAI,CAAC1f,WAAW,CAAC,IAC9EgM,iBAAiB,CAACO,aAAa,CAACH,mEAAiB,CAACwT,eAAe,EAAE,IAAI,CAAC5f,WAAW,CAAC,IACpFgM,iBAAiB,CAACO,aAAa,CAACH,mEAAiB,CAAC0T,cAAc,EAAE,IAAI,CAAC9f,WAAW,CAAC,GAGtFgM,iBAAiB,CAACO,aAAa,CAACH,mEAAiB,CAACuT,kBAAkB,EAAE,IAAI,CAAC3f,WAAW,CAAC,IACpFgM,iBAAiB,CAACO,aAAa,CAACH,mEAAiB,CAACyT,qBAAqB,EAAE,IAAI,CAAC7f,WAAW,CAAC,IAC1FgM,iBAAiB,CAACO,aAAa,CAACH,mEAAiB,CAAC2T,oBAAoB,EAAE,IAAI,CAAC/f,WAAW,CAC3F;SAGF,IAAI,CAAC+hB,YAAY,EACjB;WACC,OAAO,IAAI;;;OAIb,OAAO,KAAK;;IAEb;GAEDzkB,QAAQ,EAAG;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;CA4CZ,CAAC;;;;;;;;;"}