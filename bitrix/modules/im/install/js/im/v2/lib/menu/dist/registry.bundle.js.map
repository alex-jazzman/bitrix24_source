{"version":3,"file":"registry.bundle.js","sources":["../src/base/base.js","../src/recent/recent.js","../src/user/user.js","../src/message/classes/message-base.js","../src/message/classes/channel.js","../src/message/classes/comments.js","../src/message/classes/copilot.js","../src/message/message-menu-manager.js"],"sourcesContent":["import { EventEmitter } from 'main.core.events';\nimport { Menu } from 'ui.system.menu';\nimport { Store } from 'ui.vue3.vuex';\nimport { RestClient } from 'rest.client';\n\nimport { Core } from 'im.v2.application.core';\n\nimport type { MenuItemOptions, MenuOptions, MenuSectionOptions } from 'ui.system.menu';\n\nconst EVENT_NAMESPACE = 'BX.Messenger.v2.Lib.Menu';\n\nexport class BaseMenu extends EventEmitter\n{\n\tmenuInstance: Menu;\n\tcontext: Object;\n\ttarget: HTMLElement;\n\tstore: Store;\n\trestClient: RestClient;\n\tid: String = 'im-base-context-menu';\n\n\tconstructor()\n\t{\n\t\tsuper();\n\t\tthis.setEventNamespace(EVENT_NAMESPACE);\n\n\t\tthis.store = Core.getStore();\n\t\tthis.restClient = Core.getRestClient();\n\t}\n\n\t// public\n\topenMenu(context: Object, target: HTMLElement)\n\t{\n\t\tif (this.menuInstance)\n\t\t{\n\t\t\tthis.close();\n\t\t}\n\t\tthis.context = context;\n\t\tthis.target = target;\n\t\tthis.menuInstance = new Menu(this.getMenuOptions());\n\t\tthis.menuInstance.show(this.target);\n\t}\n\n\tgetMenuOptions(): MenuOptions\n\t{\n\t\treturn {\n\t\t\tid: this.id,\n\t\t\tbindOptions: { forceBindPosition: true, position: 'bottom' },\n\t\t\ttargetContainer: document.body,\n\t\t\tcacheable: false,\n\t\t\tclassName: this.getMenuClassName(),\n\t\t\titems: this.#prepareItems(),\n\t\t\tsections: this.getMenuGroups(),\n\t\t};\n\t}\n\n\tgetMenuItems(): MenuItemOptions | null[]\n\t{\n\t\treturn [];\n\t}\n\n\tgetMenuGroups(): MenuSectionOptions[]\n\t{\n\t\treturn [];\n\t}\n\n\tgroupItems(menuItems: MenuItemOptions | null[], group: string): MenuItemOptions[]\n\t{\n\t\treturn menuItems.filter((item) => item !== null).map((item: MenuItemOptions) => {\n\t\t\treturn {\n\t\t\t\t...item,\n\t\t\t\tsectionCode: group,\n\t\t\t};\n\t\t});\n\t}\n\n\tgetMenuClassName(): string\n\t{\n\t\treturn '';\n\t}\n\n\tonClosePopup()\n\t{\n\t\tthis.close();\n\t}\n\n\tclose()\n\t{\n\t\tif (!this.menuInstance)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.menuInstance.destroy();\n\t\tthis.menuInstance = null;\n\t}\n\n\tdestroy()\n\t{\n\t\tthis.close();\n\t}\n\n\tgetCurrentUserId(): number\n\t{\n\t\treturn Core.getUserId();\n\t}\n\n\t#prepareItems(): MenuItemOptions[]\n\t{\n\t\treturn this.getMenuItems().filter((item) => item !== null);\n\t}\n}\n","import { Analytics } from 'im.v2.lib.analytics';\nimport { Loc, Type } from 'main.core';\nimport { EventEmitter } from 'main.core.events';\nimport { MessageBox, MessageBoxButtons } from 'ui.dialogs.messagebox';\n\nimport { Core } from 'im.v2.application.core';\nimport { ActionByRole, EventType, SidebarDetailBlock, ChatType, UserType, ActionByUserType } from 'im.v2.const';\nimport { CallManager } from 'im.v2.lib.call';\nimport { LegacyRecentService } from 'im.v2.provider.service.recent';\nimport { ChatService } from 'im.v2.provider.service.chat';\nimport { Utils } from 'im.v2.lib.utils';\nimport { PermissionManager } from 'im.v2.lib.permission';\nimport { showLeaveChatConfirm } from 'im.v2.lib.confirm';\nimport { ChannelManager } from 'im.v2.lib.channel';\nimport { Messenger } from 'im.public';\nimport { InviteManager } from 'im.v2.lib.invite';\n\nimport { BaseMenu } from '../base/base';\n\nimport type { ImModelRecentItem, ImModelUser, ImModelChat } from 'im.v2.model';\nimport type { MenuItemOptions, MenuSectionOptions, MenuOptions } from 'ui.system.menu';\n\ntype MenuItemContext = {\n\tdialogId: string,\n\tcompactMode?: boolean,\n\trecentItem?: ImModelRecentItem\n}\n\nconst MenuSectionCode = Object.freeze({\n\tmain: 'main',\n\tinvite: 'invite',\n});\n\nexport class RecentMenu extends BaseMenu\n{\n\tcontext: MenuItemContext;\n\tcallManager: CallManager;\n\tpermissionManager: PermissionManager;\n\tchatService: ChatService;\n\n\tconstructor()\n\t{\n\t\tsuper();\n\n\t\tthis.id = 'im-recent-context-menu';\n\t\tthis.chatService = new ChatService();\n\t\tthis.callManager = CallManager.getInstance();\n\t\tthis.permissionManager = PermissionManager.getInstance();\n\t}\n\n\tgetMenuOptions(): MenuOptions\n\t{\n\t\treturn {\n\t\t\t...super.getMenuOptions(),\n\t\t\tclassName: this.getMenuClassName(),\n\t\t\tangle: true,\n\t\t\toffsetLeft: 32,\n\t\t};\n\t}\n\n\tgetMenuClassName(): string\n\t{\n\t\treturn this.context.compactMode ? '' : super.getMenuClassName();\n\t}\n\n\tgetMenuItems(): MenuItemOptions | null[]\n\t{\n\t\tif (this.#isInvitationActive())\n\t\t{\n\t\t\tconst mainGroupItems = [\n\t\t\t\tthis.getSendMessageItem(),\n\t\t\t\tthis.getOpenProfileItem(),\n\t\t\t];\n\n\t\t\treturn [\n\t\t\t\t...this.groupItems(mainGroupItems, MenuSectionCode.main),\n\t\t\t\t...this.groupItems(this.getInviteItems(), MenuSectionCode.invite),\n\t\t\t];\n\t\t}\n\n\t\treturn [\n\t\t\tthis.getUnreadMessageItem(),\n\t\t\tthis.getPinMessageItem(),\n\t\t\tthis.getMuteItem(),\n\t\t\tthis.getOpenProfileItem(),\n\t\t\tthis.getChatsWithUserItem(),\n\t\t\tthis.getHideItem(),\n\t\t\tthis.getLeaveItem(),\n\t\t];\n\t}\n\n\tgetMenuGroups(): MenuSectionOptions[]\n\t{\n\t\tif (this.#isInvitationActive())\n\t\t{\n\t\t\treturn [\n\t\t\t\t{ code: MenuSectionCode.main },\n\t\t\t\t{ code: MenuSectionCode.invite },\n\t\t\t];\n\t\t}\n\n\t\treturn [];\n\t}\n\n\tgetSendMessageItem(): MenuItemOptions\n\t{\n\t\treturn {\n\t\t\ttitle: Loc.getMessage('IM_LIB_MENU_WRITE_V2'),\n\t\t\tonClick: () => {\n\t\t\t\tvoid Messenger.openChat(this.context.dialogId);\n\t\t\t\tthis.menuInstance.close();\n\t\t\t},\n\t\t};\n\t}\n\n\tgetOpenItem(): MenuItemOptions\n\t{\n\t\treturn {\n\t\t\ttitle: Loc.getMessage('IM_LIB_MENU_OPEN'),\n\t\t\tonClick: () => {\n\t\t\t\tvoid Messenger.openChat(this.context.dialogId);\n\t\t\t\tthis.menuInstance.close();\n\t\t\t},\n\t\t};\n\t}\n\n\tgetUnreadMessageItem(): ?MenuItemOptions\n\t{\n\t\tconst { recentItem, dialogId } = this.context;\n\t\tif (!recentItem)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tconst dialog = this.store.getters['chats/get'](dialogId, true);\n\t\tconst showReadOption = recentItem.unread || dialog.counter > 0;\n\n\t\treturn {\n\t\t\ttitle: showReadOption ? Loc.getMessage('IM_LIB_MENU_READ') : Loc.getMessage('IM_LIB_MENU_UNREAD'),\n\t\t\tonClick: () => {\n\t\t\t\tif (showReadOption)\n\t\t\t\t{\n\t\t\t\t\tthis.chatService.readDialog(dialogId);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.chatService.unreadDialog(dialogId);\n\t\t\t\t}\n\t\t\t\tthis.menuInstance.close();\n\t\t\t},\n\t\t};\n\t}\n\n\tgetPinMessageItem(): ?MenuItemOptions\n\t{\n\t\tconst { recentItem, dialogId } = this.context;\n\t\tif (!recentItem)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tconst isPinned = recentItem.pinned;\n\n\t\treturn {\n\t\t\ttitle: isPinned ? Loc.getMessage('IM_LIB_MENU_UNPIN_MSGVER_1') : Loc.getMessage('IM_LIB_MENU_PIN_MSGVER_1'),\n\t\t\tonClick: () => {\n\t\t\t\tif (isPinned)\n\t\t\t\t{\n\t\t\t\t\tthis.chatService.unpinChat(dialogId);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tconst dialog = this.store.getters['chats/get'](this.context.dialogId, true);\n\t\t\t\t\tthis.chatService.pinChat(this.context.dialogId);\n\t\t\t\t\tAnalytics.getInstance().onPinChat(dialog);\n\t\t\t\t}\n\t\t\t\tthis.menuInstance.close();\n\t\t\t},\n\t\t};\n\t}\n\n\tgetMuteItem(): ?MenuItemOptions\n\t{\n\t\tconst { dialogId } = this.context;\n\t\tconst canMute = this.permissionManager.canPerformActionByRole(ActionByRole.mute, dialogId);\n\t\tif (!canMute)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tconst dialog = this.store.getters['chats/get'](dialogId, true);\n\t\tconst isMuted = dialog.muteList.includes(Core.getUserId());\n\n\t\treturn {\n\t\t\ttitle: isMuted ? Loc.getMessage('IM_LIB_MENU_UNMUTE_2') : Loc.getMessage('IM_LIB_MENU_MUTE_2'),\n\t\t\tonClick: () => {\n\t\t\t\tif (isMuted)\n\t\t\t\t{\n\t\t\t\t\tthis.chatService.unmuteChat(dialogId);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.chatService.muteChat(dialogId);\n\t\t\t\t}\n\t\t\t\tthis.menuInstance.close();\n\t\t\t},\n\t\t};\n\t}\n\n\tgetOpenProfileItem(): ?MenuItemOptions\n\t{\n\t\tif (!this.isUser() || this.isBot())\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tconst profileUri = Utils.user.getProfileLink(this.context.dialogId);\n\n\t\treturn {\n\t\t\ttitle: Loc.getMessage('IM_LIB_MENU_OPEN_PROFILE_V2'),\n\t\t\tonClick: () => {\n\t\t\t\tBX.SidePanel.Instance.open(profileUri);\n\t\t\t\tthis.menuInstance.close();\n\t\t\t},\n\t\t};\n\t}\n\n\tgetHideItem(): ?MenuItemOptions\n\t{\n\t\tif (!this.#canHideChat())\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\treturn {\n\t\t\ttitle: Loc.getMessage('IM_LIB_MENU_HIDE_MSGVER_1'),\n\t\t\tonClick: () => {\n\t\t\t\tLegacyRecentService.getInstance().hideChat(this.context.dialogId);\n\n\t\t\t\tthis.menuInstance.close();\n\t\t\t},\n\t\t};\n\t}\n\n\tgetLeaveItem(): ?MenuItemOptions\n\t{\n\t\tif (this.isCollabChat())\n\t\t{\n\t\t\treturn this.#leaveCollab();\n\t\t}\n\n\t\treturn this.#leaveChat();\n\t}\n\n\tgetChatsWithUserItem(): ?MenuItemOptions\n\t{\n\t\tif (!this.isUser() || this.isBot() || this.isChatWithCurrentUser())\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tconst isAnyChatOpened = this.store.getters['application/getLayout'].entityId.length > 0;\n\n\t\treturn {\n\t\t\ttitle: Loc.getMessage('IM_LIB_MENU_FIND_SHARED_CHATS'),\n\t\t\tonClick: async () => {\n\t\t\t\tif (!isAnyChatOpened)\n\t\t\t\t{\n\t\t\t\t\tawait Messenger.openChat(this.context.dialogId);\n\t\t\t\t}\n\n\t\t\t\tEventEmitter.emit(EventType.sidebar.open, {\n\t\t\t\t\tpanel: SidebarDetailBlock.chatsWithUser,\n\t\t\t\t\tstandalone: true,\n\t\t\t\t\tdialogId: this.context.dialogId,\n\t\t\t\t});\n\t\t\t\tthis.menuInstance.close();\n\t\t\t},\n\t\t};\n\t}\n\n\t// region invitation\n\tgetInviteItems(): MenuItemOptions[]\n\t{\n\t\tconst { recentItem } = this.context;\n\t\tif (!recentItem)\n\t\t{\n\t\t\treturn [];\n\t\t}\n\n\t\tconst items = [];\n\n\t\tlet canInvite; // TODO change to APPLICATION variable\n\t\tif (Type.isUndefined(BX.MessengerProxy))\n\t\t{\n\t\t\tcanInvite = true;\n\t\t\tconsole.error('BX.MessengerProxy.canInvite() method not found in v2 version!');\n\t\t}\n\t\telse\n\t\t{\n\t\t\tcanInvite = BX.MessengerProxy.canInvite();\n\t\t}\n\n\t\tconst canManageInvite = canInvite && Core.getUserId() === recentItem.invitation.originator;\n\t\tif (canManageInvite)\n\t\t{\n\t\t\titems.push(\n\t\t\t\tthis.getResendInviteItem(),\n\t\t\t\tthis.getCancelInviteItem(),\n\t\t\t);\n\t\t}\n\n\t\treturn items;\n\t}\n\n\tgetResendInviteItem(): ?MenuItemOptions\n\t{\n\t\tconst { recentItem, dialogId } = this.context;\n\t\tif (!recentItem || !this.#canResendInvitation())\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\treturn {\n\t\t\ttitle: Loc.getMessage('IM_LIB_INVITE_RESEND'),\n\t\t\tonClick: () => {\n\t\t\t\tInviteManager.resendInvite(dialogId);\n\t\t\t\tthis.menuInstance.close();\n\t\t\t},\n\t\t};\n\t}\n\n\tgetCancelInviteItem(): MenuItemOptions\n\t{\n\t\treturn {\n\t\t\ttitle: Loc.getMessage('IM_LIB_INVITE_CANCEL'),\n\t\t\tonClick: () => {\n\t\t\t\tMessageBox.show({\n\t\t\t\t\tmessage: Loc.getMessage('IM_LIB_INVITE_CANCEL_CONFIRM'),\n\t\t\t\t\tmodal: true,\n\t\t\t\t\tbuttons: MessageBoxButtons.OK_CANCEL,\n\t\t\t\t\tonOk: (messageBox) => {\n\t\t\t\t\t\tInviteManager.cancelInvite(this.context.dialogId);\n\t\t\t\t\t\tmessageBox.close();\n\t\t\t\t\t},\n\t\t\t\t\tonCancel: (messageBox) => {\n\t\t\t\t\t\tmessageBox.close();\n\t\t\t\t\t},\n\t\t\t\t});\n\t\t\t\tthis.menuInstance.close();\n\t\t\t},\n\t\t};\n\t}\n\t// endregion\n\n\tgetChat(): ImModelChat\n\t{\n\t\treturn this.store.getters['chats/get'](this.context.dialogId, true);\n\t}\n\n\tisUser(): boolean\n\t{\n\t\treturn this.store.getters['chats/isUser'](this.context.dialogId);\n\t}\n\n\tisBot(): boolean\n\t{\n\t\tif (!this.isUser())\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tconst user: ImModelUser = this.store.getters['users/get'](this.context.dialogId);\n\n\t\treturn user.type === UserType.bot;\n\t}\n\n\tisChannel(): boolean\n\t{\n\t\treturn ChannelManager.isChannel(this.context.dialogId);\n\t}\n\n\tisCommentsChat(): boolean\n\t{\n\t\tconst { type }: ImModelChat = this.store.getters['chats/get'](this.context.dialogId, true);\n\n\t\treturn type === ChatType.comment;\n\t}\n\n\tisCollabChat(): boolean\n\t{\n\t\tconst { type }: ImModelChat = this.store.getters['chats/get'](this.context.dialogId, true);\n\n\t\treturn type === ChatType.collab;\n\t}\n\n\tisChatWithCurrentUser(): boolean\n\t{\n\t\treturn this.getCurrentUserId() === Number.parseInt(this.context.dialogId, 10);\n\t}\n\n\t#leaveChat(): ?MenuItemOptions\n\t{\n\t\tconst canLeaveChat = this.permissionManager.canPerformActionByRole(ActionByRole.leave, this.context.dialogId);\n\t\tif (!canLeaveChat)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tconst title = this.isChannel()\n\t\t\t? Loc.getMessage('IM_LIB_MENU_LEAVE_CHANNEL')\n\t\t\t: Loc.getMessage('IM_LIB_MENU_LEAVE_MSGVER_1')\n\t\t;\n\n\t\treturn {\n\t\t\ttitle,\n\t\t\tonClick: async () => {\n\t\t\t\tthis.menuInstance.close();\n\t\t\t\tconst userChoice = await showLeaveChatConfirm(this.context.dialogId);\n\t\t\t\tif (userChoice === true)\n\t\t\t\t{\n\t\t\t\t\tthis.chatService.leaveChat(this.context.dialogId);\n\t\t\t\t}\n\t\t\t},\n\t\t};\n\t}\n\n\t#leaveCollab(): ?MenuItemOptions\n\t{\n\t\tconst canLeaveChat = this.permissionManager.canPerformActionByRole(ActionByRole.leave, this.context.dialogId);\n\t\tconst canLeaveCollab = this.permissionManager.canPerformActionByUserType(ActionByUserType.leaveCollab);\n\t\tif (!canLeaveChat || !canLeaveCollab)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\treturn {\n\t\t\ttitle: Loc.getMessage('IM_LIB_MENU_LEAVE_MSGVER_1'),\n\t\t\tonClick: async () => {\n\t\t\t\tthis.menuInstance.close();\n\t\t\t\tconst userChoice = await showLeaveChatConfirm(this.context.dialogId);\n\t\t\t\tif (!userChoice)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tthis.chatService.leaveCollab(this.context.dialogId);\n\t\t\t},\n\t\t};\n\t}\n\n\t#canHideChat(): boolean\n\t{\n\t\tconst { recentItem, dialogId } = this.context;\n\t\tif (!recentItem)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tconst isInvitation = this.#isInvitationActive();\n\t\tconst isFakeUser = recentItem.isFakeElement;\n\t\tconst isAiAssistantBot = this.store.getters['users/bots/isAiAssistant'](dialogId);\n\n\t\treturn !isInvitation && !isFakeUser && !isAiAssistantBot;\n\t}\n\n\t#isInvitationActive(): boolean\n\t{\n\t\tconst { recentItem } = this.context;\n\t\tif (!recentItem || !recentItem.invitation)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\treturn recentItem.invitation.isActive;\n\t}\n\n\t#canResendInvitation(): boolean\n\t{\n\t\tconst { recentItem } = this.context;\n\t\tif (!recentItem || !recentItem.invitation)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\treturn recentItem.invitation.canResend;\n\t}\n}\n","import { Loc } from 'main.core';\nimport { EventEmitter } from 'main.core.events';\n\nimport { Messenger } from 'im.public';\nimport { Utils } from 'im.v2.lib.utils';\nimport { ChatService } from 'im.v2.provider.service.chat';\nimport { showKickUserConfirm } from 'im.v2.lib.confirm';\nimport { PermissionManager } from 'im.v2.lib.permission';\nimport { ActionByRole, ChatType, EventType, UserType } from 'im.v2.const';\n\nimport { BaseMenu } from '../base/base';\n\nimport type { MenuItemOptions } from 'ui.system.menu';\nimport type { ImModelUser, ImModelChat } from 'im.v2.model';\n\ntype UserMenuContext = {\n\tuser: ImModelUser,\n\tdialog: ImModelChat\n};\n\nexport class UserMenu extends BaseMenu\n{\n\tcontext: UserMenuContext;\n\tpermissionManager: PermissionManager;\n\n\tconstructor()\n\t{\n\t\tsuper();\n\n\t\tthis.id = 'bx-im-user-context-menu';\n\t\tthis.permissionManager = PermissionManager.getInstance();\n\t}\n\n\tgetKickItem(): ?MenuItemOptions\n\t{\n\t\tconst canKick = this.permissionManager.canPerformActionByRole(ActionByRole.kick, this.context.dialog.dialogId);\n\t\tif (!canKick)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\treturn {\n\t\t\ttitle: this.#getKickItemText(),\n\t\t\tonClick: async () => {\n\t\t\t\tthis.menuInstance.close();\n\t\t\t\tconst userChoice = await showKickUserConfirm(this.context.dialog.dialogId);\n\t\t\t\tif (userChoice !== true)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tvoid this.#kickUser();\n\t\t\t},\n\t\t};\n\t}\n\n\tgetMentionItem(): MenuItemOptions\n\t{\n\t\treturn {\n\t\t\ttitle: Loc.getMessage('IM_LIB_MENU_USER_MENTION'),\n\t\t\tonClick: () => {\n\t\t\t\tEventEmitter.emit(EventType.textarea.insertMention, {\n\t\t\t\t\tmentionText: this.context.user.name,\n\t\t\t\t\tmentionReplacement: Utils.text.getMentionBbCode(this.context.user.id, this.context.user.name),\n\t\t\t\t\tdialogId: this.context.dialog.dialogId,\n\t\t\t\t\tisMentionSymbol: false,\n\t\t\t\t});\n\t\t\t\tthis.menuInstance.close();\n\t\t\t},\n\t\t};\n\t}\n\n\tgetSendItem(): ?MenuItemOptions\n\t{\n\t\tif (this.context.dialog.type === ChatType.user)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\treturn {\n\t\t\ttitle: Loc.getMessage('IM_LIB_MENU_USER_WRITE'),\n\t\t\tonClick: () => {\n\t\t\t\tvoid Messenger.openChat(this.context.user.id);\n\t\t\t\tthis.menuInstance.close();\n\t\t\t},\n\t\t};\n\t}\n\n\tgetProfileItem(): ?MenuItemOptions\n\t{\n\t\tif (this.isBot())\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tconst profileUri = Utils.user.getProfileLink(this.context.user.id);\n\n\t\treturn {\n\t\t\ttitle: Loc.getMessage('IM_LIB_MENU_OPEN_PROFILE_V2'),\n\t\t\tonClick: () => {\n\t\t\t\tBX.SidePanel.Instance.open(profileUri);\n\t\t\t\tthis.menuInstance.close();\n\t\t\t},\n\t\t};\n\t}\n\n\tisCollabChat(): boolean\n\t{\n\t\tconst { type }: ImModelChat = this.store.getters['chats/get'](this.context.dialog.dialogId, true);\n\n\t\treturn type === ChatType.collab;\n\t}\n\n\tisBot(): boolean\n\t{\n\t\treturn this.context.user.type === UserType.bot;\n\t}\n\n\t#getKickItemText(): string\n\t{\n\t\tif (this.isCollabChat())\n\t\t{\n\t\t\treturn Loc.getMessage('IM_LIB_MENU_USER_KICK_FROM_COLLAB');\n\t\t}\n\n\t\treturn Loc.getMessage('IM_LIB_MENU_USER_KICK_FROM_CHAT');\n\t}\n\n\t#kickUser(): Promise\n\t{\n\t\tif (this.isCollabChat())\n\t\t{\n\t\t\treturn (new ChatService()).kickUserFromCollab(this.context.dialog.dialogId, this.context.user.id);\n\t\t}\n\n\t\treturn (new ChatService()).kickUserFromChat(this.context.dialog.dialogId, this.context.user.id);\n\t}\n}\n","import { Loc, Type } from 'main.core';\nimport { EventEmitter } from 'main.core.events';\nimport { MenuItemDesign } from 'ui.system.menu';\nimport { Outline as OutlineIcons } from 'ui.icon-set.api.core';\n\nimport { PromoManager } from 'im.v2.lib.promo';\nimport { Analytics } from 'im.v2.lib.analytics';\nimport { ChannelManager } from 'im.v2.lib.channel';\nimport { Core } from 'im.v2.application.core';\nimport { Parser } from 'im.v2.lib.parser';\nimport { EntityCreator } from 'im.v2.lib.entity-creator';\nimport { MessageService } from 'im.v2.provider.service.message';\nimport { DiskService } from 'im.v2.provider.service.disk';\nimport { EventType, PlacementType, ActionByRole, PromoId } from 'im.v2.const';\nimport { MarketManager } from 'im.v2.lib.market';\nimport { Utils } from 'im.v2.lib.utils';\nimport { PermissionManager } from 'im.v2.lib.permission';\nimport { showDeleteChannelPostConfirm, showDownloadAllFilesConfirm } from 'im.v2.lib.confirm';\nimport { Notifier } from 'im.v2.lib.notifier';\n\n// noinspection ES6PreferShortImport\nimport { BaseMenu } from '../../base/base';\n\nimport type { ImModelMessage, ImModelChat, ImModelFile } from 'im.v2.model';\nimport type { MenuItemOptions, MenuOptions, MenuSectionOptions } from 'ui.system.menu';\nexport type MessageMenuContext = ImModelMessage & { dialogId: string };\n\nconst MenuSectionCode = Object.freeze({\n\tmain: 'main',\n\tselect: 'select',\n\tcreate: 'create',\n\tmarket: 'market',\n});\n\nexport class MessageMenu extends BaseMenu\n{\n\tcontext: MessageMenuContext;\n\tdiskService: DiskService;\n\n\tmaxPins: number = 20;\n\n\tconstructor()\n\t{\n\t\tsuper();\n\n\t\tthis.id = 'bx-im-message-context-menu';\n\t\tthis.diskService = new DiskService();\n\t\tthis.marketManager = MarketManager.getInstance();\n\t}\n\n\tgetMenuOptions(): MenuOptions\n\t{\n\t\treturn {\n\t\t\t...super.getMenuOptions(),\n\t\t\tclassName: this.getMenuClassName(),\n\t\t\tangle: true,\n\t\t\toffsetLeft: 11,\n\t\t\tminWidth: 238,\n\t\t};\n\t}\n\n\tgetMenuItems(): MenuItemOptions | null[]\n\t{\n\t\tconst mainGroupItems = [\n\t\t\tthis.getReplyItem(),\n\t\t\tthis.getCopyItem(),\n\t\t\tthis.getEditItem(),\n\t\t\tthis.getDownloadFileItem(),\n\t\t\tthis.getPinItem(),\n\t\t\tthis.getForwardItem(),\n\t\t\t...this.getAdditionalItems(),\n\t\t\tthis.getDeleteItem(),\n\t\t];\n\n\t\treturn [\n\t\t\t...this.groupItems(mainGroupItems, MenuSectionCode.main),\n\t\t\t...this.groupItems([this.getSelectItem()], MenuSectionCode.select),\n\t\t];\n\t}\n\n\tgetMenuGroups(): MenuSectionOptions[]\n\t{\n\t\treturn [\n\t\t\t{ code: MenuSectionCode.main },\n\t\t\t{ code: MenuSectionCode.select },\n\t\t];\n\t}\n\n\tgetNestedMenuGroups(): MenuSectionOptions[]\n\t{\n\t\treturn [\n\t\t\t{ code: MenuSectionCode.main },\n\t\t\t{ code: MenuSectionCode.create },\n\t\t\t{ code: MenuSectionCode.market },\n\t\t];\n\t}\n\n\tgetSelectItem(): ?MenuItemOptions\n\t{\n\t\tif (this.#isDeletedMessage() || !this.#isRealMessage())\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\treturn {\n\t\t\ttitle: Loc.getMessage('IM_DIALOG_CHAT_MENU_SELECT'),\n\t\t\ticon: OutlineIcons.CIRCLE_CHECK,\n\t\t\tonClick: () => {\n\t\t\t\tEventEmitter.emit(EventType.dialog.openBulkActionsMode, {\n\t\t\t\t\tmessageId: this.context.id,\n\t\t\t\t\tdialogId: this.context.dialogId,\n\t\t\t\t});\n\t\t\t\tthis.menuInstance.close();\n\t\t\t},\n\t\t};\n\t}\n\n\tgetReplyItem(): MenuItemOptions\n\t{\n\t\treturn {\n\t\t\ttitle: Loc.getMessage('IM_DIALOG_CHAT_MENU_REPLY'),\n\t\t\tonClick: () => {\n\t\t\t\tEventEmitter.emit(EventType.textarea.replyMessage, {\n\t\t\t\t\tmessageId: this.context.id,\n\t\t\t\t\tdialogId: this.context.dialogId,\n\t\t\t\t});\n\t\t\t\tthis.menuInstance.close();\n\t\t\t},\n\t\t\ticon: OutlineIcons.QUOTE,\n\t\t};\n\t}\n\n\tgetForwardItem(): ?MenuItemOptions\n\t{\n\t\tif (this.#isDeletedMessage() || !this.#isRealMessage())\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\treturn {\n\t\t\ttitle: Loc.getMessage('IM_DIALOG_CHAT_MENU_FORWARD'),\n\t\t\ticon: OutlineIcons.FORWARD,\n\t\t\tonClick: () => {\n\t\t\t\tAnalytics.getInstance().messageForward.onClickForward({ dialogId: this.context.dialogId });\n\t\t\t\tEventEmitter.emit(EventType.dialog.showForwardPopup, {\n\t\t\t\t\tmessagesIds: [this.context.id],\n\t\t\t\t});\n\t\t\t\tthis.menuInstance.close();\n\t\t\t},\n\t\t};\n\t}\n\n\tgetCopyItem(): ?MenuItemOptions\n\t{\n\t\tif (this.#isDeletedMessage() || this.context.text.trim().length === 0)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\treturn {\n\t\t\ttitle: Loc.getMessage('IM_DIALOG_CHAT_MENU_COPY'),\n\t\t\tonClick: async () => {\n\t\t\t\tconst textToCopy = Parser.prepareCopy(this.context);\n\n\t\t\t\tawait Utils.text.copyToClipboard(textToCopy);\n\t\t\t\tNotifier.message.onCopyComplete();\n\n\t\t\t\tthis.menuInstance.close();\n\t\t\t},\n\t\t\ticon: OutlineIcons.COPY,\n\t\t};\n\t}\n\n\tgetCopyLinkItem(): MenuItemOptions\n\t{\n\t\treturn {\n\t\t\ttitle: Loc.getMessage('IM_DIALOG_CHAT_MENU_COPY_LINK_MSGVER_1'),\n\t\t\ticon: OutlineIcons.LINK,\n\t\t\tonClick: () => {\n\t\t\t\tconst textToCopy = Utils.text.getMessageLink(this.context.dialogId, this.context.id);\n\t\t\t\tif (BX.clipboard?.copy(textToCopy))\n\t\t\t\t{\n\t\t\t\t\tNotifier.message.onCopyLinkComplete();\n\t\t\t\t}\n\t\t\t\tthis.menuInstance.close();\n\t\t\t},\n\t\t};\n\t}\n\n\tgetCopyFileItem(): ?MenuItemOptions\n\t{\n\t\tif (this.context.files.length !== 1)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\treturn {\n\t\t\ttitle: Loc.getMessage('IM_DIALOG_CHAT_MENU_COPY_FILE'),\n\t\t\ticon: OutlineIcons.COPY,\n\t\t\tonClick: () => {\n\t\t\t\tconst textToCopy = Parser.prepareCopyFile(this.context);\n\t\t\t\tif (BX.clipboard?.copy(textToCopy))\n\t\t\t\t{\n\t\t\t\t\tNotifier.file.onCopyComplete();\n\t\t\t\t}\n\t\t\t\tthis.menuInstance.close();\n\t\t\t},\n\t\t};\n\t}\n\n\tgetPinItem(): ?MenuItemOptions\n\t{\n\t\tconst canPin = PermissionManager.getInstance().canPerformActionByRole(\n\t\t\tActionByRole.pinMessage,\n\t\t\tthis.context.dialogId,\n\t\t);\n\n\t\tif (this.#isDeletedMessage() || !canPin)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tconst isPinned = this.store.getters['messages/pin/isPinned']({\n\t\t\tchatId: this.context.chatId,\n\t\t\tmessageId: this.context.id,\n\t\t});\n\n\t\treturn {\n\t\t\ttitle: isPinned ? Loc.getMessage('IM_DIALOG_CHAT_MENU_UNPIN') : Loc.getMessage('IM_DIALOG_CHAT_MENU_PIN'),\n\t\t\ticon: OutlineIcons.PIN,\n\t\t\tonClick: () => {\n\t\t\t\tconst messageService = new MessageService({ chatId: this.context.chatId });\n\t\t\t\tif (isPinned)\n\t\t\t\t{\n\t\t\t\t\tmessageService.unpinMessage(this.context.chatId, this.context.id);\n\t\t\t\t\tAnalytics.getInstance().messagePins.onUnpin(this.context.chatId);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tif (this.#arePinsExceedLimit())\n\t\t\t\t\t{\n\t\t\t\t\t\tNotifier.chat.onMessagesPinLimitError(this.maxPins);\n\t\t\t\t\t\tAnalytics.getInstance().messagePins.onReachingLimit(this.context.chatId);\n\t\t\t\t\t\tthis.menuInstance.close();\n\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tmessageService.pinMessage(this.context.chatId, this.context.id);\n\t\t\t\t\tAnalytics.getInstance().messagePins.onPin(this.context.chatId);\n\t\t\t\t}\n\t\t\t\tthis.menuInstance.close();\n\t\t\t},\n\t\t};\n\t}\n\n\tgetFavoriteItem(): MenuItemOptions\n\t{\n\t\tif (this.#isDeletedMessage())\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tconst isInFavorite = this.store.getters['sidebar/favorites/isFavoriteMessage'](this.context.chatId, this.context.id);\n\n\t\tconst menuItemText = isInFavorite\n\t\t\t? Loc.getMessage('IM_DIALOG_CHAT_MENU_REMOVE_FROM_SAVED')\n\t\t\t: Loc.getMessage('IM_DIALOG_CHAT_MENU_SAVE')\n\t\t;\n\n\t\treturn {\n\t\t\ttitle: menuItemText,\n\t\t\ticon: OutlineIcons.FAVORITE,\n\t\t\tonClick: () => {\n\t\t\t\tconst messageService = new MessageService({ chatId: this.context.chatId });\n\t\t\t\tif (isInFavorite)\n\t\t\t\t{\n\t\t\t\t\tmessageService.removeMessageFromFavorite(this.context.id);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tmessageService.addMessageToFavorite(this.context.id);\n\t\t\t\t}\n\n\t\t\t\tthis.menuInstance.close();\n\t\t\t},\n\t\t};\n\t}\n\n\tgetMarkItem(): ?MenuItemOptions\n\t{\n\t\tconst canUnread = this.context.viewed && !this.#isOwnMessage();\n\n\t\tconst dialog: ImModelChat = this.store.getters['chats/getByChatId'](this.context.chatId);\n\t\tconst isMarked = this.context.id === dialog.markedId;\n\t\tif (!canUnread || isMarked)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\treturn {\n\t\t\ttitle: Loc.getMessage('IM_DIALOG_CHAT_MENU_MARK'),\n\t\t\ticon: OutlineIcons.NEW_MESSAGE,\n\t\t\tonClick: () => {\n\t\t\t\tconst messageService = new MessageService({ chatId: this.context.chatId });\n\t\t\t\tmessageService.markMessage(this.context.id);\n\t\t\t\tthis.menuInstance.close();\n\t\t\t},\n\t\t};\n\t}\n\n\tgetCreateTaskItem(): ?MenuItemOptions\n\t{\n\t\tif (this.#isDeletedMessage())\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\treturn {\n\t\t\ttitle: Loc.getMessage('IM_DIALOG_CHAT_MENU_CREATE_TASK_MSGVER_1'),\n\t\t\ticon: OutlineIcons.TASK,\n\t\t\tonClick: () => {\n\t\t\t\tconst entityCreator = new EntityCreator(this.context.chatId);\n\t\t\t\tvoid entityCreator.createTaskForMessage(this.context.id);\n\t\t\t\tthis.menuInstance.close();\n\t\t\t},\n\t\t};\n\t}\n\n\tgetCreateMeetingItem(): ?MenuItemOptions\n\t{\n\t\tif (this.#isDeletedMessage())\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\treturn {\n\t\t\ttitle: Loc.getMessage('IM_DIALOG_CHAT_MENU_CREATE_MEETING_MSGVER_1'),\n\t\t\ticon: OutlineIcons.CALENDAR_WITH_SLOTS,\n\t\t\tonClick: () => {\n\t\t\t\tconst entityCreator = new EntityCreator(this.context.chatId);\n\t\t\t\tvoid entityCreator.createMeetingForMessage(this.context.id);\n\t\t\t\tthis.menuInstance.close();\n\t\t\t},\n\t\t};\n\t}\n\n\tgetEditItem(): ?MenuItemOptions\n\t{\n\t\tif (!this.#isOwnMessage() || this.#isDeletedMessage() || this.#isForwardedMessage())\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\treturn {\n\t\t\ttitle: Loc.getMessage('IM_DIALOG_CHAT_MENU_EDIT'),\n\t\t\ticon: OutlineIcons.EDIT_L,\n\t\t\tonClick: () => {\n\t\t\t\tEventEmitter.emit(EventType.textarea.editMessage, {\n\t\t\t\t\tmessageId: this.context.id,\n\t\t\t\t\tdialogId: this.context.dialogId,\n\t\t\t\t});\n\t\t\t\tthis.menuInstance.close();\n\t\t\t},\n\t\t};\n\t}\n\n\tgetDeleteItem(): ?MenuItemOptions\n\t{\n\t\tif (this.#isDeletedMessage())\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tconst permissionManager = PermissionManager.getInstance();\n\t\tconst canDeleteOthersMessage = permissionManager.canPerformActionByRole(\n\t\t\tActionByRole.deleteOthersMessage,\n\t\t\tthis.context.dialogId,\n\t\t);\n\t\tif (!this.#isOwnMessage() && !canDeleteOthersMessage)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\treturn {\n\t\t\ttitle: Loc.getMessage('IM_DIALOG_CHAT_MENU_DELETE'),\n\t\t\tdesign: MenuItemDesign.Alert,\n\t\t\ticon: OutlineIcons.TRASHCAN,\n\t\t\tonClick: this.#onDelete.bind(this),\n\t\t};\n\t}\n\n\tgetMarketItems(): MenuItemOptions[]\n\t{\n\t\tconst { dialogId, id } = this.context;\n\t\tconst placements = this.marketManager.getAvailablePlacementsByType(PlacementType.contextMenu, dialogId);\n\t\tconst marketMenuItem = [];\n\n\t\tconst context = { messageId: id, dialogId };\n\n\t\tplacements.forEach((placement) => {\n\t\t\tmarketMenuItem.push({\n\t\t\t\ttitle: placement.title,\n\t\t\t\ticon: OutlineIcons.MARKET,\n\t\t\t\tonClick: () => {\n\t\t\t\t\tvoid MarketManager.openSlider(placement, context);\n\t\t\t\t\tthis.menuInstance.close();\n\t\t\t\t},\n\t\t\t});\n\t\t});\n\n\t\tconst MARKET_ITEMS_LIMIT = 10;\n\n\t\treturn marketMenuItem.slice(0, MARKET_ITEMS_LIMIT);\n\t}\n\n\tgetDownloadFileItem(): ?MenuItemOptions\n\t{\n\t\tif (!Type.isArrayFilled(this.context.files))\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tif (this.#isSingleFile())\n\t\t{\n\t\t\treturn this.#getDownloadSingleFileItem();\n\t\t}\n\n\t\treturn this.#getDownloadSeveralFilesItem();\n\t}\n\n\tgetSaveToDiskItem(): ?MenuItemOptions\n\t{\n\t\tif (!Type.isArrayFilled(this.context.files))\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tconst menuItemText = this.#isSingleFile()\n\t\t\t? Loc.getMessage('IM_DIALOG_CHAT_MENU_SAVE_ON_DISK_MSGVER_1')\n\t\t\t: Loc.getMessage('IM_DIALOG_CHAT_MENU_SAVE_ALL_ON_DISK');\n\n\t\treturn {\n\t\t\ttitle: menuItemText,\n\t\t\ticon: OutlineIcons.FOLDER_24,\n\t\t\tonClick: async function() {\n\t\t\t\tAnalytics.getInstance().messageFiles.onClickSaveOnDisk({\n\t\t\t\t\tmessageId: this.context.id,\n\t\t\t\t\tdialogId: this.context.dialogId,\n\t\t\t\t});\n\n\t\t\t\tthis.menuInstance.close();\n\t\t\t\tawait this.diskService.save(this.context.files);\n\t\t\t\tNotifier.file.onDiskSaveComplete(this.#isSingleFile());\n\t\t\t}.bind(this),\n\t\t};\n\t}\n\n\tgetAdditionalItems(): MenuItemOptions[]\n\t{\n\t\tconst items = this.getNestedItems();\n\t\tif (this.#needNestedMenu(items))\n\t\t{\n\t\t\treturn [{\n\t\t\t\ttitle: Loc.getMessage('IM_DIALOG_CHAT_MENU_MORE'),\n\t\t\t\tsubMenu: {\n\t\t\t\t\titems,\n\t\t\t\t\tsections: this.getNestedMenuGroups(),\n\t\t\t\t},\n\t\t\t}];\n\t\t}\n\n\t\treturn items;\n\t}\n\n\tgetNestedItems(): MenuItemOptions[]\n\t{\n\t\tconst mainGroupItems = [\n\t\t\tthis.getCopyLinkItem(),\n\t\t\tthis.getCopyFileItem(),\n\t\t\tthis.getMarkItem(),\n\t\t\tthis.getFavoriteItem(),\n\t\t\tthis.getSaveToDiskItem(),\n\t\t];\n\n\t\tconst createGroupItems = [\n\t\t\tthis.getCreateTaskItem(),\n\t\t\tthis.getCreateMeetingItem(),\n\t\t];\n\n\t\treturn [\n\t\t\t...this.groupItems(mainGroupItems, MenuSectionCode.main),\n\t\t\t...this.groupItems(createGroupItems, MenuSectionCode.create),\n\t\t\t...this.groupItems(this.getMarketItems(), MenuSectionCode.market),\n\t\t];\n\t}\n\n\t#needNestedMenu(additionalItems: MenuItemOptions[]): boolean\n\t{\n\t\tconst NESTED_MENU_MIN_ITEMS = 3;\n\t\tconst menuItems = additionalItems.filter((item) => item !== null);\n\n\t\treturn menuItems.length >= NESTED_MENU_MIN_ITEMS;\n\t}\n\n\t#isOwnMessage(): boolean\n\t{\n\t\treturn this.context.authorId === Core.getUserId();\n\t}\n\n\t#isDeletedMessage(): boolean\n\t{\n\t\treturn this.context.isDeleted;\n\t}\n\n\t#getFirstFile(): ?ImModelFile\n\t{\n\t\treturn this.store.getters['files/get'](this.context.files[0]);\n\t}\n\n\t#isSingleFile(): boolean\n\t{\n\t\treturn this.context.files.length === 1;\n\t}\n\n\t#isForwardedMessage(): boolean\n\t{\n\t\treturn Type.isStringFilled(this.context.forward.id);\n\t}\n\n\t#isRealMessage(): boolean\n\t{\n\t\treturn this.store.getters['messages/isRealMessage'](this.context.id);\n\t}\n\n\tasync #onDelete()\n\t{\n\t\tconst { id: messageId, dialogId, chatId } = this.context;\n\t\tAnalytics.getInstance().messageDelete.onClickDelete({ messageId, dialogId });\n\t\tthis.menuInstance.close();\n\n\t\tif (await this.#isDeletionCancelled())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst messageService = new MessageService({ chatId });\n\t\tmessageService.deleteMessages([messageId]);\n\t}\n\n\tasync #isDeletionCancelled(): Promise<boolean>\n\t{\n\t\tconst { id: messageId, dialogId } = this.context;\n\t\tif (!ChannelManager.isChannel(dialogId))\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tconst confirmResult = await showDeleteChannelPostConfirm();\n\t\tif (!confirmResult)\n\t\t{\n\t\t\tAnalytics.getInstance().messageDelete.onCancel({ messageId, dialogId });\n\n\t\t\treturn true;\n\t\t}\n\n\t\treturn false;\n\t}\n\n\t#getDownloadSingleFileItem(): MenuItemOptions\n\t{\n\t\tconst file = this.#getFirstFile();\n\n\t\treturn {\n\t\t\ttitle: Loc.getMessage('IM_DIALOG_CHAT_MENU_DOWNLOAD_FILE'),\n\t\t\ticon: OutlineIcons.DOWNLOAD,\n\t\t\tonClick: function() {\n\t\t\t\tUtils.file.downloadFiles([file]);\n\n\t\t\t\tAnalytics.getInstance().messageFiles.onClickDownload({\n\t\t\t\t\tmessageId: this.context.id,\n\t\t\t\t\tdialogId: this.context.dialogId,\n\t\t\t\t});\n\t\t\t\tthis.menuInstance.close();\n\t\t\t}.bind(this),\n\t\t};\n\t}\n\n\t#getDownloadSeveralFilesItem(): MenuItemOptions\n\t{\n\t\tconst files: ImModelFile[] = this.context.files.map((fileId) => {\n\t\t\treturn this.store.getters['files/get'](fileId);\n\t\t});\n\n\t\treturn {\n\t\t\ttitle: Loc.getMessage('IM_DIALOG_CHAT_MENU_DOWNLOAD_FILES'),\n\t\t\ticon: OutlineIcons.DOWNLOAD,\n\t\t\tonClick: async () => {\n\t\t\t\tAnalytics.getInstance().messageFiles.onClickDownload({\n\t\t\t\t\tmessageId: this.context.id,\n\t\t\t\t\tdialogId: this.context.dialogId,\n\t\t\t\t});\n\t\t\t\tUtils.file.downloadFiles(files);\n\n\t\t\t\tconst needToShowPopup = PromoManager.getInstance().needToShow(PromoId.downloadSeveralFiles);\n\t\t\t\tif (needToShowPopup && Utils.browser.isChrome() && !Utils.platform.isBitrixDesktop())\n\t\t\t\t{\n\t\t\t\t\tthis.menuInstance?.close();\n\t\t\t\t\tawait showDownloadAllFilesConfirm();\n\t\t\t\t\tvoid PromoManager.getInstance().markAsWatched(PromoId.downloadSeveralFiles);\n\t\t\t\t}\n\t\t\t\tthis.menuInstance?.close();\n\t\t\t},\n\t\t};\n\t}\n\n\t#arePinsExceedLimit(): string\n\t{\n\t\tconst pins = this.store.getters['messages/pin/getPinned'](this.context.chatId);\n\n\t\treturn pins.length >= this.maxPins;\n\t}\n}\n","import { MessageMenu } from './message-base';\n\nimport type { MenuItemOptions, MenuSectionOptions } from 'ui.system.menu';\n\nconst MenuSectionCode = Object.freeze({\n\tmain: 'main',\n\tselect: 'select',\n});\n\nexport class ChannelMessageMenu extends MessageMenu\n{\n\tgetMenuItems(): MenuItemOptions[]\n\t{\n\t\tconst mainGroupItems = [\n\t\t\tthis.getCopyItem(),\n\t\t\tthis.getEditItem(),\n\t\t\tthis.getDownloadFileItem(),\n\t\t\tthis.getPinItem(),\n\t\t\tthis.getForwardItem(),\n\t\t\t...this.getAdditionalItems(),\n\t\t\tthis.getDeleteItem(),\n\t\t];\n\n\t\treturn [\n\t\t\t...this.groupItems(mainGroupItems, MenuSectionCode.main),\n\t\t\t...this.groupItems([this.getSelectItem()], MenuSectionCode.select),\n\t\t];\n\t}\n\n\tgetNestedMenuGroups(): MenuSectionOptions[]\n\t{\n\t\treturn [];\n\t}\n\n\tgetNestedItems(): MenuItemOptions[]\n\t{\n\t\treturn [\n\t\t\tthis.getCopyLinkItem(),\n\t\t\tthis.getCopyFileItem(),\n\t\t\tthis.getMarkItem(),\n\t\t\tthis.getFavoriteItem(),\n\t\t\tthis.getSaveToDiskItem(),\n\t\t];\n\t}\n}\n","import { Loc } from 'main.core';\nimport { EventEmitter } from 'main.core.events';\nimport { Outline as OutlineIcons } from 'ui.icon-set.api.core';\n\nimport { EventType } from 'im.v2.const';\nimport { ChannelManager } from 'im.v2.lib.channel';\n\nimport { MessageMenu } from './message-base';\n\nimport type { MenuItemOptions, MenuSectionOptions } from 'ui.system.menu';\n\nconst MenuSectionCode = Object.freeze({\n\tmain: 'main',\n\tselect: 'select',\n\tfile: 'file',\n\topen: 'open',\n\tcreate: 'create',\n});\n\nexport class CommentsMessageMenu extends MessageMenu\n{\n\tgetMenuItems(): MenuItemOptions[]\n\t{\n\t\tconst message = this.context;\n\t\tconst contextDialogId = this.context.dialogId;\n\t\tif (ChannelManager.isCommentsPostMessage(message, contextDialogId))\n\t\t{\n\t\t\tconst mainGroupItems = [\n\t\t\t\tthis.getCopyItem(),\n\t\t\t\tthis.getCopyFileItem(),\n\t\t\t];\n\t\t\tconst fileGroupItems = [\n\t\t\t\tthis.getDownloadFileItem(),\n\t\t\t\tthis.getSaveToDiskItem(),\n\t\t\t];\n\n\t\t\treturn [\n\t\t\t\t...this.groupItems(mainGroupItems, MenuSectionCode.main),\n\t\t\t\t...this.groupItems(fileGroupItems, MenuSectionCode.file),\n\t\t\t\t...this.groupItems([this.getOpenInChannelItem()], MenuSectionCode.open),\n\t\t\t];\n\t\t}\n\n\t\treturn [\n\t\t\tthis.getReplyItem(),\n\t\t\tthis.getCopyItem(),\n\t\t\tthis.getEditItem(),\n\t\t\tthis.getDownloadFileItem(),\n\t\t\t...this.getAdditionalItems(),\n\t\t\tthis.getDeleteItem(),\n\t\t];\n\t}\n\n\tgetMenuGroups(): MenuSectionOptions[]\n\t{\n\t\treturn [\n\t\t\t{ code: MenuSectionCode.main },\n\t\t\t{ code: MenuSectionCode.file },\n\t\t\t{ code: MenuSectionCode.open },\n\t\t];\n\t}\n\n\tgetNestedMenuGroups(): MenuSectionOptions[]\n\t{\n\t\treturn [\n\t\t\t{ code: MenuSectionCode.main },\n\t\t\t{ code: MenuSectionCode.create },\n\t\t];\n\t}\n\n\tgetNestedItems(): MenuItemOptions[]\n\t{\n\t\tconst mainGroupItems = [\n\t\t\tthis.getCopyFileItem(),\n\t\t\tthis.getFavoriteItem(),\n\t\t\tthis.getSaveToDiskItem(),\n\t\t];\n\n\t\tconst createGroupItems = [\n\t\t\tthis.getCreateTaskItem(),\n\t\t\tthis.getCreateMeetingItem(),\n\t\t];\n\n\t\treturn [\n\t\t\t...this.groupItems(mainGroupItems, MenuSectionCode.main),\n\t\t\t...this.groupItems(createGroupItems, MenuSectionCode.create),\n\t\t];\n\t}\n\n\tgetOpenInChannelItem(): MenuItemOptions\n\t{\n\t\treturn {\n\t\t\ttitle: Loc.getMessage('IM_LIB_MENU_COMMENTS_OPEN_IN_CHANNEL'),\n\t\t\ticon: OutlineIcons.GO_TO_MESSAGE,\n\t\t\tonClick: () => {\n\t\t\t\tEventEmitter.emit(EventType.dialog.closeComments);\n\n\t\t\t\tthis.menuInstance.close();\n\t\t\t},\n\t\t};\n\t}\n}\n","import { Loc, Runtime } from 'main.core';\nimport { Outline as OutlineIcons } from 'ui.icon-set.api.core';\n\nimport { CopilotManager } from 'im.v2.lib.copilot';\n\nimport { MessageMenu } from './message-base';\n\nimport type { ImModelChat } from 'im.v2.model';\nimport type { MenuItemOptions, MenuSectionOptions } from 'ui.system.menu';\n\nconst CopilotChatContext = Object.freeze({\n\tpersonal: 'chat_copilot_tab_one_by_one',\n\tgroup: 'chat_copilot_tab_multi',\n});\n\nconst MenuSectionCode = Object.freeze({\n\tmain: 'main',\n\tselect: 'select',\n\tcreate: 'create',\n\tmarket: 'market',\n});\n\nexport class CopilotMessageMenu extends MessageMenu\n{\n\tgetMenuItems(): MenuItemOptions[]\n\t{\n\t\tconst mainGroupItems = [\n\t\t\tthis.getCopyItem(),\n\t\t\tthis.getMarkItem(),\n\t\t\tthis.getFavoriteItem(),\n\t\t\tthis.getForwardItem(),\n\t\t\tthis.getSendFeedbackItem(),\n\t\t\tthis.getDeleteItem(),\n\t\t];\n\n\t\treturn [\n\t\t\t...this.groupItems(mainGroupItems, MenuSectionCode.main),\n\t\t\t...this.groupItems([this.getSelectItem()], MenuSectionCode.select),\n\t\t];\n\t}\n\n\tgetMenuGroups(): MenuSectionOptions[]\n\t{\n\t\treturn [\n\t\t\t{ code: MenuSectionCode.main },\n\t\t\t{ code: MenuSectionCode.select },\n\t\t];\n\t}\n\n\tgetSendFeedbackItem(): MenuItemOptions\n\t{\n\t\tconst copilotManager = new CopilotManager();\n\t\tif (!copilotManager.isCopilotBot(this.context.authorId))\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\treturn {\n\t\t\ttitle: Loc.getMessage('IM_LIB_MENU_COPILOT_FEEDBACK'),\n\t\t\ticon: OutlineIcons.FEEDBACK,\n\t\t\tonClick: () => {\n\t\t\t\tvoid this.openForm();\n\t\t\t\tthis.menuInstance.close();\n\t\t\t},\n\t\t};\n\t}\n\n\tasync openForm()\n\t{\n\t\tconst formId = Math.round(Math.random() * 1000);\n\n\t\tawait Runtime.loadExtension(['ui.feedback.form']);\n\t\tBX.UI.Feedback.Form.open({\n\t\t\tid: `im.copilot.feedback-${formId}`,\n\t\t\tforms: [\n\t\t\t\t{ zones: ['es'], id: 684, lang: 'es', sec: 'svvq1x' },\n\t\t\t\t{ zones: ['en'], id: 686, lang: 'en', sec: 'tjwodz' },\n\t\t\t\t{ zones: ['de'], id: 688, lang: 'de', sec: 'nrwksg' },\n\t\t\t\t{ zones: ['com.br'], id: 690, lang: 'com.br', sec: 'kpte6m' },\n\t\t\t\t{ zones: ['ru', 'by', 'kz'], id: 692, lang: 'ru', sec: 'jbujn0' },\n\t\t\t],\n\t\t\tpresets: {\n\t\t\t\tsender_page: this.getCopilotChatContext(),\n\t\t\t\tlanguage: Loc.getMessage('LANGUAGE_ID'),\n\t\t\t\tcp_answer: this.context.text,\n\t\t\t},\n\t\t});\n\t}\n\n\tgetCopilotChatContext(): $Values<typeof CopilotChatContext>\n\t{\n\t\tconst chat: ImModelChat = this.store.getters['chats/get'](this.context.dialogId);\n\t\tif (chat.userCounter <= 2)\n\t\t{\n\t\t\treturn CopilotChatContext.personal;\n\t\t}\n\n\t\treturn CopilotChatContext.group;\n\t}\n}\n","import { Core } from 'im.v2.application.core';\nimport { ChannelManager } from 'im.v2.lib.channel';\nimport { CopilotManager } from 'im.v2.lib.copilot';\nimport { ChatType, MessageComponent } from 'im.v2.const';\n\n// noinspection ES6PreferShortImport\nimport { MessageMenu } from './classes/message-base';\nimport { ChannelMessageMenu } from './classes/channel';\nimport { CommentsMessageMenu } from './classes/comments';\nimport { CopilotMessageMenu } from './classes/copilot';\n\nimport type { ImModelChat } from 'im.v2.model';\nimport type { MessageMenuContext } from 'im.v2.lib.menu';\n\ntype MenuCheckFunction = (context: MessageMenuContext) => boolean;\ntype MessageType = $Values<typeof MessageComponent>;\n\nexport class MessageMenuManager\n{\n\tstatic #instance = null;\n\n\t#defaultMenuByCallback: Map<MenuCheckFunction, MessageMenu> = new Map();\n\t#customMenuByCallback: Map<MenuCheckFunction, MessageMenu> = new Map();\n\t#menuByMessageType: Map<MessageType, MessageMenu> = new Map();\n\t#menuInstance = null;\n\n\tstatic getInstance(): MessageMenuManager\n\t{\n\t\tif (!this.#instance)\n\t\t{\n\t\t\tthis.#instance = new MessageMenuManager();\n\t\t}\n\n\t\treturn this.#instance;\n\t}\n\n\tconstructor()\n\t{\n\t\tthis.#registerDefaultMenus();\n\t}\n\n\topenMenu(context: MessageMenuContext, bindElement: HTMLElement): void\n\t{\n\t\tthis.#destroyMenuInstance();\n\n\t\tconst MenuClass = this.#resolveMenuClass(context);\n\t\tthis.#menuInstance = new MenuClass();\n\t\tthis.#menuInstance.openMenu(context, bindElement);\n\t}\n\n\tregisterMenuByCallback(callback: MenuCheckFunction, menuClass: MessageMenu): void\n\t{\n\t\tthis.#customMenuByCallback.set(callback, menuClass);\n\t}\n\n\tregisterMenuByMessageType(messageType: MessageType, menuClass: MessageMenu): void\n\t{\n\t\tif (this.#hasMenuForMessageType(messageType))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.#menuByMessageType.set(messageType, menuClass);\n\t}\n\n\t#resolveMenuClass(context: MessageMenuContext): MessageMenu\n\t{\n\t\tif (!this.#isCustomMenuAllowed(context))\n\t\t{\n\t\t\treturn this.#getDefaultMenuClass(context);\n\t\t}\n\n\t\tconst customMenu = this.#getCustomMenuClass(context);\n\n\t\treturn customMenu ?? this.#getDefaultMenuClass(context);\n\t}\n\n\t#registerDefaultMenus()\n\t{\n\t\tthis.#defaultMenuByCallback.set(this.#isChannel.bind(this), ChannelMessageMenu);\n\t\tthis.#defaultMenuByCallback.set(this.#isComment.bind(this), CommentsMessageMenu);\n\t\tthis.#defaultMenuByCallback.set(this.#isCopilot.bind(this), CopilotMessageMenu);\n\t}\n\n\t#isCustomMenuAllowed(context: MessageMenuContext): boolean\n\t{\n\t\treturn !ChannelManager.isCommentsPostMessage(context, context.dialogId);\n\t}\n\n\t#getDefaultMenuClass(context: MessageMenuContext): MessageMenu\n\t{\n\t\tconst MenuClass = this.#getClassByMap(this.#defaultMenuByCallback, context);\n\n\t\treturn MenuClass ?? MessageMenu;\n\t}\n\n\t#getCustomMenuClass(context: MessageMenuContext): MessageMenu | null\n\t{\n\t\tif (this.#hasMenuForMessageType(context.componentId))\n\t\t{\n\t\t\treturn this.#getMenuForMessageType(context.componentId);\n\t\t}\n\n\t\treturn this.#getClassByMap(this.#customMenuByCallback, context);\n\t}\n\n\t#getClassByMap(menuMap: Map<MenuCheckFunction, MessageMenu>, context: MessageMenuContext): MessageMenu | null\n\t{\n\t\tconst menuMapEntries = menuMap.entries();\n\t\tfor (const [callback, MenuClass] of menuMapEntries)\n\t\t{\n\t\t\tif (callback(context))\n\t\t\t{\n\t\t\t\treturn MenuClass;\n\t\t\t}\n\t\t}\n\n\t\treturn null;\n\t}\n\n\t#getDialog(dialogId: string): ImModelChat\n\t{\n\t\treturn Core.getStore().getters['chats/get'](dialogId, true);\n\t}\n\n\t#isChannel(context: MessageMenuContext): boolean\n\t{\n\t\treturn ChannelManager.isChannel(context.dialogId);\n\t}\n\n\t#isComment(context: MessageMenuContext): boolean\n\t{\n\t\tconst chat = this.#getDialog(context.dialogId);\n\n\t\treturn chat.type === ChatType.comment;\n\t}\n\n\t#isCopilot(context: MessageMenuContext): boolean\n\t{\n\t\treturn (new CopilotManager()).isCopilotChat(context.dialogId);\n\t}\n\n\t#hasMenuForMessageType(messageType: MessageType): boolean\n\t{\n\t\treturn this.#menuByMessageType.has(messageType);\n\t}\n\n\t#getMenuForMessageType(messageType: MessageType): MessageMenu\n\t{\n\t\treturn this.#menuByMessageType.get(messageType);\n\t}\n\n\t#destroyMenuInstance(): void\n\t{\n\t\tif (!this.#menuInstance)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.#menuInstance.destroy();\n\t\tthis.#menuInstance = null;\n\t}\n}\n"],"names":["EVENT_NAMESPACE","BaseMenu","EventEmitter","constructor","id","setEventNamespace","store","Core","getStore","restClient","getRestClient","openMenu","context","target","menuInstance","close","Menu","getMenuOptions","show","bindOptions","forceBindPosition","position","targetContainer","document","body","cacheable","className","getMenuClassName","items","sections","getMenuGroups","getMenuItems","groupItems","menuItems","group","filter","item","map","sectionCode","onClosePopup","destroy","getCurrentUserId","getUserId","MenuSectionCode","Object","freeze","main","invite","RecentMenu","chatService","ChatService","callManager","CallManager","getInstance","permissionManager","PermissionManager","angle","offsetLeft","compactMode","mainGroupItems","getSendMessageItem","getOpenProfileItem","getInviteItems","getUnreadMessageItem","getPinMessageItem","getMuteItem","getChatsWithUserItem","getHideItem","getLeaveItem","code","title","Loc","getMessage","onClick","Messenger","openChat","dialogId","getOpenItem","recentItem","dialog","getters","showReadOption","unread","counter","readDialog","unreadDialog","isPinned","pinned","unpinChat","pinChat","Analytics","onPinChat","canMute","canPerformActionByRole","ActionByRole","mute","isMuted","muteList","includes","unmuteChat","muteChat","isUser","isBot","profileUri","Utils","user","getProfileLink","BX","SidePanel","Instance","open","LegacyRecentService","hideChat","isCollabChat","isChatWithCurrentUser","isAnyChatOpened","entityId","length","emit","EventType","sidebar","panel","SidebarDetailBlock","chatsWithUser","standalone","canInvite","Type","isUndefined","MessengerProxy","console","error","canManageInvite","invitation","originator","push","getResendInviteItem","getCancelInviteItem","InviteManager","resendInvite","MessageBox","message","modal","buttons","MessageBoxButtons","OK_CANCEL","onOk","messageBox","cancelInvite","onCancel","getChat","type","UserType","bot","isChannel","ChannelManager","isCommentsChat","ChatType","comment","collab","Number","parseInt","canLeaveChat","leave","userChoice","showLeaveChatConfirm","leaveChat","canLeaveCollab","canPerformActionByUserType","ActionByUserType","leaveCollab","isInvitation","isFakeUser","isFakeElement","isAiAssistantBot","isActive","canResend","UserMenu","getKickItem","canKick","kick","showKickUserConfirm","getMentionItem","textarea","insertMention","mentionText","name","mentionReplacement","text","getMentionBbCode","isMentionSymbol","getSendItem","getProfileItem","kickUserFromCollab","kickUserFromChat","select","create","market","MessageMenu","maxPins","diskService","DiskService","marketManager","MarketManager","minWidth","getReplyItem","getCopyItem","getEditItem","getDownloadFileItem","getPinItem","getForwardItem","getAdditionalItems","getDeleteItem","getSelectItem","getNestedMenuGroups","icon","OutlineIcons","CIRCLE_CHECK","openBulkActionsMode","messageId","replyMessage","QUOTE","FORWARD","messageForward","onClickForward","showForwardPopup","messagesIds","trim","textToCopy","Parser","prepareCopy","copyToClipboard","Notifier","onCopyComplete","COPY","getCopyLinkItem","LINK","getMessageLink","clipboard","copy","onCopyLinkComplete","getCopyFileItem","files","prepareCopyFile","file","canPin","pinMessage","chatId","PIN","messageService","MessageService","unpinMessage","messagePins","onUnpin","chat","onMessagesPinLimitError","onReachingLimit","onPin","getFavoriteItem","isInFavorite","menuItemText","FAVORITE","removeMessageFromFavorite","addMessageToFavorite","getMarkItem","canUnread","viewed","isMarked","markedId","NEW_MESSAGE","markMessage","getCreateTaskItem","TASK","entityCreator","EntityCreator","createTaskForMessage","getCreateMeetingItem","CALENDAR_WITH_SLOTS","createMeetingForMessage","EDIT_L","editMessage","canDeleteOthersMessage","deleteOthersMessage","design","MenuItemDesign","Alert","TRASHCAN","bind","getMarketItems","placements","getAvailablePlacementsByType","PlacementType","contextMenu","marketMenuItem","forEach","placement","MARKET","openSlider","MARKET_ITEMS_LIMIT","slice","isArrayFilled","getSaveToDiskItem","FOLDER_24","messageFiles","onClickSaveOnDisk","save","onDiskSaveComplete","getNestedItems","subMenu","createGroupItems","additionalItems","NESTED_MENU_MIN_ITEMS","authorId","isDeleted","isStringFilled","forward","messageDelete","onClickDelete","deleteMessages","confirmResult","showDeleteChannelPostConfirm","DOWNLOAD","downloadFiles","onClickDownload","fileId","needToShowPopup","PromoManager","needToShow","PromoId","downloadSeveralFiles","browser","isChrome","platform","isBitrixDesktop","showDownloadAllFilesConfirm","markAsWatched","pins","ChannelMessageMenu","CommentsMessageMenu","contextDialogId","isCommentsPostMessage","fileGroupItems","getOpenInChannelItem","GO_TO_MESSAGE","closeComments","CopilotChatContext","personal","CopilotMessageMenu","getSendFeedbackItem","copilotManager","CopilotManager","isCopilotBot","FEEDBACK","openForm","formId","Math","round","random","Runtime","loadExtension","UI","Feedback","Form","forms","zones","lang","sec","presets","sender_page","getCopilotChatContext","language","cp_answer","userCounter","MessageMenuManager","Map","bindElement","MenuClass","registerMenuByCallback","callback","menuClass","set","registerMenuByMessageType","messageType","customMenu","componentId","menuMap","menuMapEntries","entries","isCopilotChat","has","get"],"mappings":"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"}