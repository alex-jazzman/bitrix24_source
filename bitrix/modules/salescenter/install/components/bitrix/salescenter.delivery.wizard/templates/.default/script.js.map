{"version":3,"file":"script.js","sources":["script.es6.js"],"sourcesContent":[";(function ()\n{\n\t'use strict';\n\n\tvar namespace = BX.namespace('BX.Salescenter.DeliveryInstallation');\n\tif (namespace.Wizard)\n\t{\n\t\treturn;\n\t}\n\n\t/**\n\t * Wizard.\n\t *\n\t */\n\tfunction Wizard()\n\t{\n\t}\n\n\tWizard.prototype.init = function (params)\n\t{\n\t\tthis.id = params.id;\n\t\tthis.code = params.code;\n\t\tthis.form = BX(params.formId);\n\t\tthis.saveButton = BX(params.saveButtonId);\n\t\tthis.confirmDeleteMessage = params.confirmDeleteMessage;\n\t\tthis.errorMessageNode = BX(params.errorMessageId);\n\n\t\tthis.buttonWaitClass = 'ui-btn-wait';\n\n\t\tBX.bind(this.saveButton, 'click', this.onSave.bind(this));\n\t\tBX.bind(this.form, 'submit', this.onSubmit.bind(this));\n\t};\n\tWizard.prototype.onSave = function ()\n\t{\n\t\tif (BX.hasClass(this.saveButton, this.buttonWaitClass))\n\t\t{\n\t\t\tBX.removeClass(this.saveButton, this.buttonWaitClass);\n\t\t}\n\t};\n\tWizard.prototype.delete = function (event)\n\t{\n\t\tevent.preventDefault();\n\n\t\tlet deleteButton = event.target;\n\n\t\tif(this.id > 0 && confirm(this.confirmDeleteMessage))\n\t\t{\n\t\t\tBX.ajax.runComponentAction(\n\t\t\t\t'bitrix:salescenter.delivery.wizard',\n\t\t\t\t'delete',\n\t\t\t\t{\n\t\t\t\t\tdata: {id: this.id, code: this.code},\n\t\t\t\t}\n\t\t\t).then(\n\t\t\t\tfunction() {\n\t\t\t\t\tdeleteButton.classList.remove('ui-btn-wait');\n\t\t\t\t\tBX.SidePanel.Instance.close();\n\t\t\t\t}.bind(this),\n\t\t\t\tfunction (result) {\n\t\t\t\t\tdeleteButton.classList.remove('ui-btn-wait');\n\n\t\t\t\t\tthis.showError(result.errors);\n\t\t\t\t}.bind(this)\n\t\t\t);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tsetTimeout(() => BX.removeClass(deleteButton, 'ui-btn-wait'), 100);\n\t\t}\n\t};\n\tWizard.prototype.onSubmit = function (event)\n\t{\n\t\tlet settings = {};\n\t\tlet formData = new FormData(this.form);\n\t\tfor(let pair of formData.entries())\n\t\t{\n\t\t\tsettings[pair[0]] = pair[1];\n\t\t}\n\n\t\tthis.saveButton.classList.add('ui-btn-wait');\n\n\t\tlet finallyCallback = () => {this.saveButton.classList.remove('ui-btn-wait');};\n\n\t\tlet action = formData.has('id') ? 'update' : 'install';\n\n\t\tBX.ajax.runComponentAction(\n\t\t\t'bitrix:salescenter.delivery.wizard',\n\t\t\taction,\n\t\t\t{\n\t\t\t\tjson: settings\n\t\t\t}\n\t\t).then((response) =>\n\t\t{\n\t\t\tfinallyCallback();\n\t\t\tBX.SidePanel.Instance.close();\n\t\t}).catch((result) => {\n\t\t\tfinallyCallback();\n\t\t\tthis.showError(result.errors);\n\t\t});\n\n\t\tevent.preventDefault();\n\t};\n\tWizard.prototype.showError = function (errors)\n\t{\n\t\tlet text = '';\n\n\t\terrors.forEach(function (error) {\n\t\t\ttext += error.message + '<br>';\n\t\t});\n\n\t\tif(this.errorMessageNode && text)\n\t\t{\n\t\t\tthis.errorMessageNode.parentNode.style.display = 'block';\n\t\t\tthis.errorMessageNode.innerHTML = text;\n\t\t}\n\t}\n\n\tnamespace.Wizard = new Wizard();\n})();"],"names":["namespace","BX","Wizard","prototype","init","params","id","code","form","formId","saveButton","saveButtonId","confirmDeleteMessage","errorMessageNode","errorMessageId","buttonWaitClass","bind","onSave","onSubmit","hasClass","removeClass","event","preventDefault","deleteButton","target","confirm","ajax","runComponentAction","data","then","classList","remove","SidePanel","Instance","close","result","showError","errors","setTimeout","settings","formData","FormData","entries","pair","add","finallyCallback","action","has","json","response","text","forEach","error","message","parentNode","style","display","innerHTML"],"mappings":"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"}