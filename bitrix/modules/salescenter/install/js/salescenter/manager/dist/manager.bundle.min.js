this.BX=this.BX||{};(function(e,t,n){"use strict";var r=function e(){babelHelpers.classCallCheck(this,e)};babelHelpers.defineProperty(r,"FEEDBACK","feedback");babelHelpers.defineProperty(r,"PAY_ORDER","pay_order");babelHelpers.defineProperty(r,"PAYSYSTEM_OFFER","paysystem_offer");babelHelpers.defineProperty(r,"PAYSYSTEM_SBP_OFFER","paysystem_sbp_offer");babelHelpers.defineProperty(r,"SMSPROVIDER_OFFER","smsprovider_offer");babelHelpers.defineProperty(r,"DELIVERY_OFFER","delivery_offer");babelHelpers.defineProperty(r,"TERMINAL_OFFER","terminal_offer");babelHelpers.defineProperty(r,"INTEGRATION_REQUEST","integration_request");function o(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */o=function t(){return e};var e={},t=Object.prototype,n=t.hasOwnProperty,r=Object.defineProperty||function(e,t,n){e[t]=n.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",s=i.asyncIterator||"@@asyncIterator",l=i.toStringTag||"@@toStringTag";function c(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{c({},"")}catch(e){c=function e(t,n,r){return t[n]=r}}function u(e,t,n,o){var i=t&&t.prototype instanceof f?t:f,a=Object.create(i.prototype),s=new T(o||[]);return r(a,"_invoke",{value:w(e,n,s)}),a}function d(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=u;var p={};function f(){}function y(){}function h(){}var v={};c(v,a,(function(){return this}));var g=Object.getPrototypeOf,m=g&&g(g(C([])));m&&m!==t&&n.call(m,a)&&(v=m);var P=h.prototype=f.prototype=Object.create(v);function b(e){["next","throw","return"].forEach((function(t){c(e,t,(function(e){return this._invoke(t,e)}))}))}function E(e,t){function o(r,i,a,s){var l=d(e[r],e,i);if("throw"!==l.type){var c=l.arg,u=c.value;return u&&"object"==babelHelpers["typeof"](u)&&n.call(u,"__await")?t.resolve(u.__await).then((function(e){o("next",e,a,s)}),(function(e){o("throw",e,a,s)})):t.resolve(u).then((function(e){c.value=e,a(c)}),(function(e){return o("throw",e,a,s)}))}s(l.arg)}var i;r(this,"_invoke",{value:function e(n,r){function a(){return new t((function(e,t){o(n,r,e,t)}))}return i=i?i.then(a,a):a()}})}function w(e,t,n){var r="suspendedStart";return function(o,i){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===o)throw i;return L()}for(n.method=o,n.arg=i;;){var a=n.delegate;if(a){var s=_(a,n);if(s){if(s===p)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var l=d(e,t,n);if("normal"===l.type){if(r=n.done?"completed":"suspendedYield",l.arg===p)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(r="completed",n.method="throw",n.arg=l.arg)}}}function _(e,t){var n=t.method,r=e.iterator[n];if(undefined===r)return t.delegate=null,"throw"===n&&e.iterator["return"]&&(t.method="return",t.arg=undefined,_(e,t),"throw"===t.method)||"return"!==n&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+n+"' method")),p;var o=d(r,e.iterator,t.arg);if("throw"===o.type)return t.method="throw",t.arg=o.arg,t.delegate=null,p;var i=o.arg;return i?i.done?(t[e.resultName]=i.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=undefined),t.delegate=null,p):i:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,p)}function S(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function k(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function T(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(S,this),this.reset(!0)}function C(e){if(e){var t=e[a];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,o=function t(){for(;++r<e.length;)if(n.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=undefined,t.done=!0,t};return o.next=o}}return{next:L}}function L(){return{value:undefined,done:!0}}return y.prototype=h,r(P,"constructor",{value:h,configurable:!0}),r(h,"constructor",{value:y,configurable:!0}),y.displayName=c(h,l,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===y||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,h):(e.__proto__=h,c(e,l,"GeneratorFunction")),e.prototype=Object.create(P),e},e.awrap=function(e){return{__await:e}},b(E.prototype),c(E.prototype,s,(function(){return this})),e.AsyncIterator=E,e.async=function(t,n,r,o,i){void 0===i&&(i=Promise);var a=new E(u(t,n,r,o),i);return e.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},b(P),c(P,l,"Generator"),c(P,a,(function(){return this})),c(P,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},e.values=C,T.prototype={constructor:T,reset:function e(t){if(this.prev=0,this.next=0,this.sent=this._sent=undefined,this.done=!1,this.delegate=null,this.method="next",this.arg=undefined,this.tryEntries.forEach(k),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=undefined)},stop:function e(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function e(t){if(this.done)throw t;var r=this;function o(e,n){return s.type="throw",s.arg=t,r.next=e,n&&(r.method="next",r.arg=undefined),!!n}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],s=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var l=n.call(a,"catchLoc"),c=n.call(a,"finallyLoc");if(l&&c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(l){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function e(t,r){for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var a=i;break}}a&&("break"===t||"continue"===t)&&a.tryLoc<=r&&r<=a.finallyLoc&&(a=null);var s=a?a.completion:{};return s.type=t,s.arg=r,a?(this.method="next",this.next=a.finallyLoc,p):this.complete(s)},complete:function e(t,n){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&n&&(this.next=n),p},finish:function e(t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),k(r),p}},catch:function e(t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc===t){var o=r.completion;if("throw"===o.type){var i=o.arg;k(r)}return i}}throw new Error("illegal catch attempt")},delegateYield:function e(t,n,r){return this.delegate={iterator:C(t),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=undefined),p}},e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){babelHelpers.defineProperty(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t,n){l(e,t);return n}function l(e,t){if(e!==t){throw new TypeError("Private static access of wrong provenance")}}var c=function(){function e(){babelHelpers.classCallCheck(this,e)}babelHelpers.createClass(e,null,[{key:"init",value:function t(r){r.connectedSiteId=parseInt(r.connectedSiteId,10);if(r.connectedSiteId>0){e.connectedSiteId=r.connectedSiteId}r.sessionId=parseInt(r.sessionId,10);if(r.sessionId>0){e.sessionId=r.sessionId}if(n.Type.isString(r.siteTemplateCode)){e.siteTemplateCode=r.siteTemplateCode}if(n.Type.isString(r.connectPath)){e.connectPath=r.connectPath}if(n.Type.isBoolean(r.isSitePublished)){e.isSitePublished=r.isSitePublished}if(n.Type.isBoolean(r.isSiteExists)){e.isSiteExists=r.isSiteExists}if(n.Type.isBoolean(r.isOrderPublicUrlAvailable)){e.isOrderPublicUrlAvailable=r.isOrderPublicUrlAvailable}else{e.isOrderPublicUrlAvailable=false}if(!e.isPullInited){n.Event.ready(e.initPull)}if(!top.BX.Landing){top.BX.Landing={PageObject:{},Main:{}}}}},{key:"loadConfig",value:function n(){return new Promise((function(n,r){t.rest.callMethod("salescenter.manager.getConfig").then((function(t){e.init(t.answer.result);n(t.answer.result)}))["catch"]((function(e){r(e)}))}))}},{key:"startConnection",value:function t(){var r=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};return new Promise((function(t,o){if(!e.connectPath){o("no connect path")}var i=new n.Uri(e.connectPath);if(!n.Type.isPlainObject(r)){r={}}r.analyticsLabel="salescenterStartConnection";i.setQueryParams(r);e.openSlider(i.toString(),{width:760}).then((function(){t()}))["catch"]((function(e){o(e)}))}))}},{key:"connect",value:function t(r){return new Promise((function(t){if(e.connectedSiteId>0&&e.isSiteExists){t()}else{var o=new n.Uri("/shop/stores/site/edit/0/");if(!n.Type.isPlainObject(r)){r={}}r.analyticsLabel="salescenterConnect";if(e.siteTemplateCode){r.tpl=e.siteTemplateCode}o.setQueryParams(r);e.openSlider(o.toString()).then((function(){t()}))}}))}},{key:"publicConnectedSite",value:function n(){return new Promise((function(n,r){if(e.connectedSiteId>0&&!e.isSitePublished){t.rest.callMethod("landing.site.publication",{id:e.connectedSiteId}).then((function(t){e.isSitePublished=true;e.firePublicConnectedSiteEvent();n(t)}))["catch"]((function(e){r(e)}))}else{n()}}))}},{key:"firePublicConnectedSiteEvent",value:function e(){top.BX.onCustomEvent("Salescenter.Manager:onPublicConnectedSite",{isSitePublished:true})}},{key:"getPopup",value:function e(t){var n=t.id,r=n===void 0?"":n,o=t.title,i=o===void 0?"":o,a=t.text,s=a===void 0?"":a,l=t.buttons,c=l===void 0?[]:l;var u=BX.PopupWindowManager.getPopupById(r);var d='<div class="salescenter-popup">\n\t\t\t<div class="salescenter-popup-title">'.concat(i,'</div>\n\t\t\t<div class="salescenter-popup-text">').concat(s,"</div>\n\t\t</div>");if(u){u.setContent(d);u.setButtons(c)}else{u=new BX.PopupWindow(r,null,{zIndex:200,className:"salescenter-connect-popup",autoHide:true,closeByEsc:true,padding:0,closeIcon:true,content:d,width:400,overlay:true,lightShadow:false,buttons:c})}return u}},{key:"showAfterConnectPopup",value:function t(){var n=e.getPopup({id:"salescenter-connect-popup",title:BX.message("SALESCENTER_MANAGER_CONNECT_POPUP_TITLE"),text:BX.message("SALESCENTER_MANAGER_CONNECT_POPUP_DESCRIPTION"),buttons:[new BX.PopupWindowButton({text:BX.message("SALESCENTER_MANAGER_CONNECT_POPUP_GO_BUTTON"),className:"ui-btn ui-btn-md ui-btn-primary",events:{click:function t(){e.openConnectedSite();n.close()}}})]});n.show()}},{key:"copyUrl",value:function t(n,r){BX.clipboard.copy(n);if(r&&r.target){e.showCopyLinkPopup(r.target)}}},{key:"addCustomPage",value:function t(n){return new Promise((function(t){e.getAddUrlPopup().then((function(t){e.templateEngine.$emit("onAddUrlPopupCreate",n);t.show()}));e.addUrlResolve=t;e.addingCustomPage=n}))}},{key:"resolveAddPopup",value:function t(r,o){if(e.addUrlResolve&&n.Type.isFunction(e.addUrlResolve)){e.addUrlResolve(r);e.addUrlResolve=null}if(o&&r>0){if(e.addingCustomPage&&e.addingCustomPage.id&&parseInt(e.addingCustomPage.id,10)===parseInt(r,10)){e.showNotification(BX.message("SALESCENTER_MANAGER_UPDATE_URL_SUCCESS"))}else{e.showNotification(BX.message("SALESCENTER_MANAGER_ADD_URL_SUCCESS"))}}}},{key:"initPopupTemplate",value:function t(){return new Promise((function(t){BX.loadExt("salescenter.url_popup").then((function(){e.templateEngine=BX.Vue.create({el:document.createElement("div"),template:"<bx-salescenter-url-popup/>",mounted:function n(){e.popupNode=this.$el;this.$app=e;t()}})}))}))}},{key:"handleAddUrlPopupAutoHide",value:function t(n){if(!e.addUrlPopup){return true}if(n.target!==e.addUrlPopup.getPopupContainer()&&!e.addUrlPopup.getPopupContainer().contains(n.target)){var r=null;var o=BX.PopupMenu.getMenuById("salescenter-url-fields-popup");if(o){r=o.popupWindow}if(!r){return true}if(n.target.dataset["rootMenu"]==="salescenter-url-fields-popup"||n.target.parentNode.dataset["rootMenu"]==="salescenter-url-fields-popup"){if(!n.target.classList.contains("menu-popup-item-submenu")&&!n.target.parentNode.classList.contains("menu-popup-item-submenu")){r.close()}return false}else{return true}}return false}},{key:"getAddUrlPopup",value:function t(){return new Promise((function(t){if(!e.addUrlPopup){e.initPopupTemplate().then((function(){e.addUrlPopup=new BX.PopupWindow({id:"salescenter-app-add-url",zIndex:200,autoHide:true,closeByEsc:true,closeIcon:true,padding:0,contentPadding:0,content:e.popupNode,titleBar:BX.message("SALESCENTER_ACTION_ADD_CUSTOM_TITLE"),contentColor:"white",width:600,autoHideHandler:e.handleAddUrlPopupAutoHide,events:{onPopupClose:function t(){var n=document.getElementById("salescenter-app-add-custom-url-id");var r=document.getElementById("salescenter-app-add-custom-url-is-saved").value==="y";if(n){n=n.value}else{n=false}e.resolveAddPopup(n,r)},onPopupDestroy:function t(){e.addUrlPopup=null}}});t(e.addUrlPopup)}))}else{t(e.addUrlPopup)}}))}},{key:"addPage",value:function n(r){return new Promise((function(n,o){var i;var a;if(r.analyticsLabel){a=r.analyticsLabel;delete r.analyticsLabel}if(r.id>0){i=t.rest.callMethod("salescenter.page.update",{id:r.id,fields:r});if(!a){a="salescenterUpdatePage"}}else{i=t.rest.callMethod("salescenter.page.add",{fields:r});if(!a){a="salescenterAddPage"}}i.then((function(t){if(t.answer.result.page){var r=t.answer.result.page;var o="other";if(r.landingId>0){if(parseInt(r.siteId,10)===parseInt(e.connectedSiteId,10)){o="landing_store_chat"}else{o="landing_other"}}e.addAnalyticAction({analyticsLabel:a,source:o,type:r.isWebform?"forms":"info",code:r.code}).then((function(){n(t)}))}else{n(t)}}))["catch"]((function(e){o(e)}))}))}},{key:"checkUrl",value:function e(n){return t.rest.callMethod("salescenter.page.geturldata",{url:n})}},{key:"addSitePage",value:function t(){var n=arguments.length>0&&arguments[0]!==undefined?arguments[0]:false;return new Promise((function(t){var r=e.connectedSiteId;if(r>0){BX.loadExt("landing.master").then((function(){BX.Landing.Env.getInstance().setOptions({site_id:r});BX.Landing.UI.Panel.URLList.getInstance().show("landing",{siteId:r}).then((function(r){e.addPage({hidden:false,landingId:r.id,isWebform:n}).then((function(n){t(n);e.showNotification(BX.message("SALESCENTER_MANAGER_ADD_URL_SUCCESS"))}))}))}))}else{e.openSlider("/bitrix/components/bitrix/salescenter.connect/slider.php").then((function(){t()}))}}))}},{key:"showNotification",value:function e(t){if(!t){return}BX.loadExt("ui.notification").then((function(){BX.UI.Notification.Center.notify({content:t})}))}},{key:"hidePage",value:function n(r){var o="salescenter.page.hide";var i="other";if(r.landingId>0){if(parseInt(r.siteId,10)===parseInt(e.connectedSiteId,10)){i="landing_store_chat"}else{i="landing_other"}}var a={id:r.id,fields:{hidden:true},analyticsLabel:"salescenterDeletePage",source:i,type:r.isWebform?"form":"info",code:r.code};return new Promise((function(n,r){t.rest.callMethod(o,a).then((function(t){n(t);e.showNotification(BX.message("SALESCENTER_MANAGER_HIDE_URL_SUCCESS"))}))["catch"]((function(e){r(e)}))}))}},{key:"deleteUrl",value:function n(r){var o="salescenter.page.delete";var i={id:r.id,analyticsLabel:"salescenterDeletePage",source:"other",type:r.isWebform?"form":"info"};return new Promise((function(n,r){t.rest.callMethod(o,i).then((function(t){n(t);e.showNotification(BX.message("SALESCENTER_MANAGER_DELETE_URL_SUCCESS"))}))["catch"]((function(e){r(e)}))}))}},{key:"editLandingPage",value:function t(n){var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:e.connectedSiteId;window.open("/shop/stores/site/".concat(r,"/view/").concat(n,"/"),"_blank")}},{key:"openSlider",value:function t(o,i){if(!n.Type.isStringFilled(o)){return}if(o.startsWith("feedback:")){var l=o.slice(9);switch(l){case r.FEEDBACK:case r.PAYSYSTEM_OFFER:case r.DELIVERY_OFFER:{var c={feedback_type:l,sender_page:null};return new Promise((function(){s(e,e,u).call(e,c)}))}default:break}}if(!n.Type.isPlainObject(i)){i={}}i=a(a({},{cacheable:false,allowChangeHistory:false,events:{}}),i);return new Promise((function(e){if(n.Type.isString(o)&&o.length>1){i.events.onClose=function(t){e(t.getSlider())};BX.SidePanel.Instance.open(o,i)}else{e()}}))}},{key:"getOrdersListUrl",value:function t(r){if(!n.Type.isPlainObject(r)){r={}}if(e.sessionId>0){r["sessionId"]=e.sessionId}return new n.Uri("/saleshub/orders/").setQueryParams(r).toString()}},{key:"getPaymentsListUrl",value:function t(r){if(!n.Type.isPlainObject(r)){r={}}if(e.sessionId>0){r["sessionId"]=e.sessionId}return new n.Uri("/saleshub/payments/").setQueryParams(r).toString()}},{key:"showOrdersList",value:function t(n){return e.openSlider(e.getOrdersListUrl(n))}},{key:"showPaymentsList",value:function t(n){return e.openSlider(e.getPaymentsListUrl(n))}},{key:"getOrderAddUrl",value:function t(r){if(!n.Type.isPlainObject(r)){r={}}if(e.sessionId>0){r["sessionId"]=e.sessionId}return new n.Uri("/saleshub/orders/order/").setQueryParams(r).toString()}},{key:"showOrderAdd",value:function t(n){return e.openSlider(e.getOrderAddUrl(n))}},{key:"showOrdersListAfterCreate",value:function t(n){var r=e.getOrdersListUrl({orderId:n});var o=BX.SidePanel.Instance.getSlider(r);if(!o){r=e.getOrdersListUrl({orderId:n});o=BX.SidePanel.Instance.getSlider(r)}var i=e.getOrderAddUrl();var a=BX.SidePanel.Instance.getSlider(i);if(a){a.destroy()}if(!o){e.showOrdersList({orderId:n})}else{top.BX.onCustomEvent(o.getFrameWindow(),"salescenter-order-create",[{orderId:n}])}}},{key:"initPull",value:function t(){if(BX.PULL){e.isPullInited=true;BX.PULL.subscribe({moduleId:"salescenter",command:"SETCONNECTEDSITE",callback:function t(n){e.init(n)}})}}},{key:"openControlPanel",value:function e(){window.open("/saleshub/","_blank")}},{key:"getFormAddUrl",value:function e(){var t=arguments.length>0&&arguments[0]!==undefined?arguments[0]:0;return new n.Uri("/crm/webform/edit/".concat(parseInt(t,10),"/")).setQueryParams({ACTIVE:"Y",RELOAD_LIST:"N"}).toString()}},{key:"addNewForm",value:function t(){return new Promise((function(t,n){e.openSlider(e.getFormAddUrl()).then((function(r){var o=r.getData().get("formId");if(o>0){e.addNewFormPage(o).then((function(e){t(e)}))["catch"]((function(e){n(e)}))}}))}))}},{key:"addNewFormPage",value:function n(r){return new Promise((function(n,o){var i="salescenter-add-new-page-popup";e.getPopup({id:i,title:BX.message("SALESCENTER_MANAGER_NEW_PAGE_POPUP_TITLE"),text:BX.message("SALESCENTER_MANAGER_NEW_PAGE_WAIT")}).show();t.rest.callMethod("salescenter.page.addformpage",{formId:r}).then((function(t){if(t.answer.result.page){n(t.answer.result.page);var r=t.answer.result.page.landingId;var a=e.getPopup({id:i,title:BX.message("SALESCENTER_MANAGER_NEW_PAGE_POPUP_TITLE"),text:BX.message("SALESCENTER_MANAGER_NEW_PAGE_COMPLETE"),buttons:[new BX.PopupWindowButton({text:BX.message("SALESCENTER_MANAGER_CONNECT_POPUP_GO_BUTTON"),className:"ui-btn ui-btn-md ui-btn-primary",events:{click:function t(){e.editLandingPage(r);a.close()}}})]});a.show()}else{e.getPopup({id:i,title:BX.message("SALESCENTER_MANAGER_ERROR_POPUP")}).show();o()}}))["catch"]((function(t){e.getPopup({id:i,title:BX.message("SALESCENTER_MANAGER_ERROR_POPUP"),text:t}).show();o(t)}))}))}},{key:"openConnectedSite",value:function t(){var r=arguments.length>0&&arguments[0]!==undefined?arguments[0]:false;if(e.connectedSiteId>0){var o=new n.Uri("/shop/stores/site/".concat(e.connectedSiteId,"/"));var i={apply_filter:"y"};if(r){i.DELETED="Y"}else{i.clear_filter="y"}o.setQueryParams(i);window.open(o.toString(),"_blank")}}},{key:"openLimitShopNumberInfoHelper",value:function e(){BX.UI.InfoHelper.show("limit_shop_number")}},{key:"openFreeTarifInfoHelper",value:function e(){BX.UI.InfoHelper.show("limit_sites_free")}},{key:"openFreeDomenInfoHelper",value:function e(){BX.UI.InfoHelper.show("limit_free_domen")}},{key:"openConfirmEmailInfoHelper",value:function e(){BX.UI.InfoHelper.show("limit_sites_confirm_email")}},{key:"openHowItWorks",value:function t(n){e.openHelper(n,"redirect=detail&code=9289135","chat_connect")}},{key:"openHowCrmStoreWorks",value:function t(n){e.openHelper(n,"redirect=detail&code=13651476","crmstore_how_works")}},{key:"openHowCrmFormsWorks",value:function t(n,r){r=r||"redirect=detail&code=13774372";e.openHelper(n,r,"crmforms_how_works")}},{key:"openHowSmsWorks",value:function t(n){e.openHelper(n,"redirect=detail&code=9680407","sms_connect")}},{key:"openHowToConfigOpenLines",value:function t(n){e.openHelper(n,"redirect=detail&code=7872935","openlines_connect")}},{key:"openHowToConfigDefaultPaySystem",value:function t(n){e.openHelper(n,"redirect=detail&code=10460164","pay_system_connect")}},{key:"openHowToConfigPaySystem",value:function t(n,r){e.openHelper(n,"redirect=detail&code="+r,"pay_system_connect")}},{key:"openHowToConfigCashboxPaySystem",value:function t(n,r){e.openHelper(n,"redirect=detail&code="+r,"pay_system_cashbox_connect")}},{key:"openHowToUseOfflineCashBox",value:function t(n){e.openHelper(n,"redirect=detail&code=11271760","cashbox_connect")}},{key:"openHowToConfigCashBox",value:function t(n){e.openHelper(n,"redirect=detail&code=11120562","cashbox_connect")}},{key:"openHowToConfigCheckboxCashBox",value:function t(n){e.openHelper(n,"redirect=detail&code=12306679","cashbox_connect")}},{key:"openHowToConfigBusinessRuCashBox",value:function t(n){e.openHelper(n,"redirect=detail&code=12806492","cashbox_connect")}},{key:"openHowToConfigRobokassaCashBox",value:function t(n){e.openHelper(n,"redirect=detail&code=12849128","cashbox_connect")}},{key:"openHowToConfigYooKassaCashBox",value:function t(n){e.openHelper(n,"redirect=detail&code=17776800","cashbox_connect")}},{key:"openHowToSetupCheckboxCashBoxAndKeys",value:function t(n){e.openHelper(n,"redirect=detail&code=12334663","cashbox_connect")}},{key:"openHowToSell",value:function t(n){e.openHelper(n,"redirect=detail&code=17615318","crmstore_connect")}},{key:"openHowToWork",value:function t(n){e.openHelper(n,"redirect=detail&code=11553526","companycontacts_connect")}},{key:"openWhatClientSee",value:function t(n){e.openHelper(n,"redirect=detail&code=11278264","client_view")}},{key:"openHowPayDealWorks",value:function t(n){e.openHelper(n,"redirect=detail&code=17615318","pay_deal")}},{key:"openHowPaySmartInvoiceWorks",value:function t(n){e.openHelper(n,"redirect=detail&code=17615318","pay_smart_invoice")}},{key:"openHowTerminalWorks",value:function t(n){e.openHelper(n,"redirect=detail&code=18537646","terminal")}},{key:"openFormPagesHelp",value:function t(n){e.openHelper(n,"redirect=detail&code=9606749","forms")}},{key:"openCommonPagesHelp",value:function t(n){e.openHelper(n,"redirect=detail&code=9604717","common_pages")}},{key:"openBitrix24NotificationsHelp",value:function t(n){e.openHelper(n,"redirect=detail&code=17615266","bitrix24_notifications")}},{key:"openBitrix24NotificationsWorks",value:function t(n){e.openHelper(n,"redirect=detail&code=13655934","bitrix24_notifications_work")}},{key:"openHelper",value:function t(){var n=arguments.length>0&&arguments[0]!==undefined?arguments[0]:null;var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:"";var o=arguments.length>2&&arguments[2]!==undefined?arguments[2]:"";if(n){n.preventDefault()}if(o){e.addAnalyticAction({analyticsLabel:"salescenterOpenHelp",article:o}).then((function(){if(top.BX.Helper){top.BX.Helper.show(r)}}))}else if(top.BX.Helper){top.BX.Helper.show(r)}}},{key:"openFeedbackForm",value:function t(n){var o={feedback_type:r.FEEDBACK,sender_page:null};e.openFeedbackFormParams(n,o)}},{key:"openFeedbackFormParams",value:function t(r,o){if(r&&n.Type.isFunction(r.preventDefault)){r.preventDefault()}var i=n.Type.isPlainObject(o)?o:{};s(e,e,u).call(e,i)}},{key:"openFeedbackPayOrderForm",value:function t(o){if(o&&n.Type.isFunction(o.preventDefault)){o.preventDefault()}var i={feedback_type:r.PAY_ORDER,sender_page:null};s(e,e,u).call(e,i)}},{key:"openFeedbackDeliveryOfferForm",value:function t(o){if(o&&n.Type.isFunction(o.preventDefault)){o.preventDefault()}var i={feedback_type:r.DELIVERY_OFFER,sender_page:null};s(e,e,u).call(e,i)}},{key:"openIntegrationRequestForm",value:function t(o){var i=s(e,e,f).call(e,o);if(o&&n.Type.isFunction(o.preventDefault)){o.preventDefault()}if(!n.Type.isPlainObject(i)){i={}}i.feedback_type=r.INTEGRATION_REQUEST;s(e,e,u).call(e,i)}},{key:"openApplication",value:function t(){var r=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var o=new n.Uri("/saleshub/app/");if(n.Type.isPlainObject(r)){o.setQueryParams(r)}var i=r.hasOwnProperty("sliderOptions")?r.sliderOptions:{};if(!i.hasOwnProperty("width")){i.width=1140}return new Promise((function(t,n){e.openSlider(o.toString(),i).then((function(e){t(e.getData())}))["catch"]((function(e){}))}))}},{key:"addAnalyticAction",value:function e(t){return new Promise((function(e,r){if(!n.Type.isPlainObject(t)||!t.analyticsLabel){r("wrong params")}t=a(a({},t),{action:"salescenter.manager.addAnalytic",sessid:BX.bitrix_sessid()});var o=new XMLHttpRequest;var i=new n.Uri("/bitrix/services/main/ajax.php");i.setQueryParams(t);o.open("GET",i.toString());o.onload=function(){e()};o.onerror=function(){r()};o.send()}))}},{key:"getFieldsMap",value:function t(){return new Promise((function(t,r){if(e.fieldsMap!==null){t(e.fieldsMap);return}n.ajax.runAction("salescenter.manager.getFieldsMap",{analyticsLabel:"salescenterFieldsMapLoading"}).then((function(n){e.fieldsMap=n.data.fields;t(n.data.fields)}))["catch"]((function(e){r(e.errors)}))}))}},{key:"getPageUrl",value:function e(t,r){var o=arguments.length>2&&arguments[2]!==undefined?arguments[2]:null;return new Promise((function(e,i){if(!n.Type.isInteger(t)){e(null)}if(!n.Type.isPlainObject(r)||r.length<=0){e(null)}n.ajax.runAction("salescenter.manager.getPageUrl",{data:{pageId:t,entities:r},analyticsLabel:"salescenterGetPageUrlWithParameters",getParameters:{context:o}}).then((function(t){e(t.data.pageUrl)}))["catch"]((function(e){i(e.errors)}))}))}}]);return e}();function u(e){return d.apply(this,arguments)}function d(){d=babelHelpers.asyncToGenerator(o().mark((function e(t){var r,i,a,s,l;return o().wrap((function e(o){while(1)switch(o.prev=o.next){case 0:o.prev=0;o.next=3;return n.ajax.runComponentAction("bitrix:salescenter.feedback","getFormParams",{mode:"class",data:t});case 3:r=o.sent;o.next=6;return n.Runtime.loadExtension(["ui.feedback.form"]);case 6:i=o.sent;a=i.Form;s=Math.round(Math.random()*1e3);l=r.data;l.id+=s.toString();a.open(l);o.next=18;break;case 14:o.prev=14;o.t0=o["catch"](0);o.next=18;return console.error(o.t0);case 18:case"end":return o.stop()}}),e,null,[[0,14]])})));return d.apply(this,arguments)}function p(e){var t={};if(n.Type.isStringFilled(e)){var r=e.split(",");try{for(var o in r){if(!r.hasOwnProperty(o)){continue}var i=r[o].split(":"),a=babelHelpers.slicedToArray(i,2),s=a[0],l=a[1];if(n.Type.isStringFilled(s)){t[s]=l}}}catch(e){}}return t}function f(e){var t=null;if(n.Type.isDomNode(e.button)){t=e.button}else if(n.Type.isDomNode(e.target)){t=e.target}if(n.Type.isObject(t)){var r=t.dataset?t.dataset:{};var o=r.hasOwnProperty("managerOpenintegrationrequestformParams")?r.managerOpenintegrationrequestformParams:"";return s(this,c,p).call(this,o)}return null}babelHelpers.defineProperty(c,"sessionId",null);babelHelpers.defineProperty(c,"connectedSiteId",null);babelHelpers.defineProperty(c,"addUrlPopup",null);babelHelpers.defineProperty(c,"addUrlResolve",null);babelHelpers.defineProperty(c,"popupNode",null);babelHelpers.defineProperty(c,"siteTemplateCode",null);babelHelpers.defineProperty(c,"isSitePublished",null);babelHelpers.defineProperty(c,"isSiteExists",null);babelHelpers.defineProperty(c,"isOrderPublicUrlAvailable",null);babelHelpers.defineProperty(c,"isPullInited",false);babelHelpers.defineProperty(c,"connectPath",null);babelHelpers.defineProperty(c,"fieldsMap",null);babelHelpers.defineProperty(c,"showCopyLinkPopup",(function(e){if(c.popupOuterLink){c.popupOuterLink.destroy();c.popupOuterLink=null;if(c.hideCopyLinkTimeout>0){clearTimeout(c.hideCopyLinkTimeout);c.hideCopyLinkTimeout=0}if(c.destroyCopyLinkTimeout>0){clearTimeout(c.destroyCopyLinkTimeout);c.destroyCopyLinkTimeout=0}}c.popupOuterLink=new BX.PopupWindow("salescenter-popup-copy-link",e,{className:"salescenter-popup-copy-link",darkMode:true,content:BX.message("SALESCENTER_MANAGER_COPY_URL_SUCCESS"),zIndex:5e3});c.popupOuterLink.show();c.hideCopyLinkTimeout=setTimeout((function(){BX.hide(BX(c.popupOuterLink.uniquePopupId));c.hideCopyLinkTimeout=0}),2e3);c.destroyCopyLinkTimeout=setTimeout((function(){c.popupOuterLink.destroy();c.popupOuterLink=null;c.destroyCopyLinkTimeout=0}),2200)}));e.Manager=c})(this.BX.Salescenter=this.BX.Salescenter||{},BX,BX);
//# sourceMappingURL=manager.bundle.map.js