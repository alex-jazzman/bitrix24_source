{"version":3,"file":"registration.bundle.js","sources":["../src/error-notifier/notifier.js","../src/error-notifier/notifier-0.js","../src/error-notifier/notifier-200.js","../src/error-notifier/notifier-403.js","../src/error-notifier-factory.js","../src/success-notifier.js","../src/registration.js"],"sourcesContent":["import { Loc } from 'main.core';\nimport { MessageBox } from 'ui.dialogs.messagebox';\n\nexport default class Notifier\n{\n\tmessage: String;\n\n\tconstructor(\n\t\tmessage: String,\n\t)\n\t{\n\t\tthis.message = message;\n\t}\n\n\tgetTitle(): String\n\t{\n\t\treturn Loc.getMessage('BAAS_ERROR_REGISTRATION_TITLE');\n\t}\n\n\tgetMessage(): String\n\t{\n\t\treturn this.message;\n\t}\n\n\tshow(): void\n\t{\n\t\tMessageBox.show({\n\t\t\ttitle: this.getTitle(),\n\t\t\tmessage: this.getMessage(),\n\t\t\tmodal: true,\n\t\t\tbuttons: BX.UI.Dialogs.MessageBoxButtons.OK,\n\t\t\tmaxWidth: 1000,\n\t\t});\n\t}\n}\n","import { Loc, Tag, Type, Text } from 'main.core';\nimport { MessageBox } from 'ui.dialogs.messagebox';\nimport Notifier from './notifier';\nimport 'ui.icon-set';\n\nexport default class Notifier0 extends Notifier\n{\n\tstatic STATUS = 0;\n\tstatic CODE = 9713;\n\n\teffectiveUrl: ?String;\n\tbody: ?String;\n\n\tconstructor(\n\t\tmessage: ?String,\n\t\teffectiveUrl: ?String,\n\t\tbody: ?String,\n\t)\n\t{\n\t\tsuper(message);\n\t\tthis.effectiveUrl = effectiveUrl;\n\t\tthis.body = body;\n\t}\n\n\tgetTitle(): String\n\t{\n\t\treturn Loc.getMessage('BAAS_ERROR_REGISTRATION_TITLE_0');\n\t}\n\n\tgetMessage(): String\n\t{\n\t\treturn Loc.getMessage(\n\t\t\t'BAAS_ERROR_REGISTRATION_MESSAGE_0',\n\t\t\t{ '#effectiveUrl#': this.effectiveUrl },\n\t\t);\n\t}\n\n\tgetEffectiveUrl(): ?String\n\t{\n\t\treturn this.effectiveUrl;\n\t}\n\n\tgetBody(): ?String\n\t{\n\t\tif (Type.isStringFilled(this.body))\n\t\t{\n\t\t\treturn `<textarea style=\"width: 90%;\">${Text.encode(this.body)}</textarea>`;\n\t\t}\n\n\t\treturn '';\n\t}\n\n\tshow(): void\n\t{\n\t\tconst copyButton = Tag.render`<div class=\"ui-icon-set --copy-plates\"></div>`;\n\t\tBX.clipboard.bindCopyClick(copyButton, {\n\t\t\ttext: () => {\n\t\t\t\treturn JSON.stringify({\n\t\t\t\t\teffectiveUrl: this.getEffectiveUrl(),\n\t\t\t\t\tbody: this.getBody(),\n\t\t\t\t});\n\t\t\t},\n\t\t});\n\n\t\tMessageBox.show({\n\t\t\ttitle: this.getTitle(),\n\t\t\tmessage: Tag.render`\n\t\t\t\t<div>${this.getMessage()}\n\t\t\t\t\t<dd>\n\t\t\t\t\t\t<dt>${this.getEffectiveUrl()} ${copyButton}</dt>\n\t\t\t\t\t\t<dl>${this.getBody()}</dl>\n\t\t\t\t\t</dd>\n\t\t\t\t</div>\n\t\t\t`,\n\t\t\tmodal: true,\n\t\t\tbuttons: BX.UI.Dialogs.MessageBoxButtons.OK,\n\t\t\tmaxWidth: 1000,\n\t\t});\n\t}\n}\n","import { Loc } from 'main.core';\nimport Notifier0 from './notifier-0';\n\nexport default class Notifier200 extends Notifier0\n{\n\tstatic STATUS = 200;\n\n\tgetMessage(): String\n\t{\n\t\treturn Loc.getMessage(\n\t\t\t'BAAS_ERROR_REGISTRATION_MESSAGE_200',\n\t\t\t{ '#effectiveUrl#': this.effectiveUrl },\n\t\t);\n\t}\n}\n","import { Loc } from 'main.core';\nimport Notifier0 from './notifier-0';\n\nexport default class Notifier403 extends Notifier0\n{\n\tstatic STATUS = 403;\n\n\tgetTitle(): String\n\t{\n\t\treturn Loc.getMessage('BAAS_ERROR_REGISTRATION_TITLE_403');\n\t}\n\n\tgetMessage(): String\n\t{\n\t\treturn Loc.getMessage(\n\t\t\t'BAAS_ERROR_REGISTRATION_MESSAGE_403',\n\t\t\t{ '#effectiveUrl#': this.effectiveUrl },\n\t\t);\n\t}\n}\n","import { Type } from 'main.core';\nimport Notifier from './error-notifier/notifier';\nimport Notifier0 from './error-notifier/notifier-0';\nimport Notifier200 from './error-notifier/notifier-200';\nimport Notifier403 from './error-notifier/notifier-403';\n\nexport default class ErrorNotifierFactory\n{\n\tstatic createFromResponse(response = {}): Notifier\n\t{\n\t\tif (response && Type.isArrayLike(response.errors))\n\t\t{\n\t\t\tconst error = [...response.errors].shift();\n\n\t\t\tif (error.customData && error.customData.status)\n\t\t\t{\n\t\t\t\tswitch (error.customData.status)\n\t\t\t\t{\n\t\t\t\t\tcase Notifier0.STATUS:\n\t\t\t\t\t\treturn new Notifier0(\n\t\t\t\t\t\t\terror.message,\n\t\t\t\t\t\t\terror.customData.effective_url,\n\t\t\t\t\t\t\terror.customData.body,\n\t\t\t\t\t\t);\n\t\t\t\t\tcase Notifier403.STATUS:\n\t\t\t\t\t\treturn new Notifier403(\n\t\t\t\t\t\t\terror.message,\n\t\t\t\t\t\t\terror.customData.effective_url,\n\t\t\t\t\t\t\terror.customData.body,\n\t\t\t\t\t\t);\n\t\t\t\t\tdefault:\n\t\t\t\t\t\treturn new Notifier200(\n\t\t\t\t\t\t\terror.message,\n\t\t\t\t\t\t\terror.customData.effective_url,\n\t\t\t\t\t\t\terror.customData.body,\n\t\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tswitch (error.code)\n\t\t\t{\n\t\t\t\tcase Notifier0.CODE:\n\t\t\t\t\treturn new Notifier0(\n\t\t\t\t\t\terror.message,\n\t\t\t\t\t\terror.customData.effective_url,\n\t\t\t\t\t\terror.customData.body,\n\t\t\t\t\t);\n\t\t\t\tcase Notifier403.CODE:\n\t\t\t\t\treturn new Notifier403(\n\t\t\t\t\t\terror.message,\n\t\t\t\t\t\terror.customData.effective_url,\n\t\t\t\t\t\terror.customData.body,\n\t\t\t\t\t);\n\t\t\t\tdefault:\n\t\t\t\t\treturn new Notifier(\n\t\t\t\t\t\terror.message,\n\t\t\t\t\t);\n\t\t\t}\n\t\t}\n\n\t\treturn new Notifier();\n\t}\n}\n","import { Loc } from 'main.core';\nimport { MessageBox } from 'ui.dialogs.messagebox';\n\nexport default class SuccessNotifier\n{\n\tshow(): void\n\t{\n\t\tMessageBox.show({\n\t\t\ttitle: Loc.getMessage('BAAS_SUCCESS_REGISTRATION_TITLE'),\n\t\t\tmessage: Loc.getMessage('BAAS_SUCCESS_REGISTRATION_MESSAGE', { '#LINK#': '/bitrix/admin/baas_marketplace.php' }),\n\t\t\tmodal: true,\n\t\t\tbuttons: BX.UI.Dialogs.MessageBoxButtons.OK,\n\t\t\tmaxWidth: 1000,\n\t\t});\n\t}\n}\n","import { Event, ajax } from 'main.core';\nimport ErrorNotifierFactory from './error-notifier-factory';\nimport SuccessNotifier from './success-notifier';\n\nexport class Registration\n{\n\tready: Boolean = true;\n\n\tbind(node): this\n\t{\n\t\tEvent.bind(node, 'click', this.send.bind(this));\n\n\t\treturn this;\n\t}\n\n\tsend(): Promise\n\t{\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tif (this.ready === false)\n\t\t\t{\n\t\t\t\treject();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.ready = false;\n\n\t\t\t\tajax\n\t\t\t\t\t.runAction('baas.Host.register', { data: {} })\n\t\t\t\t\t.then((response) => {\n\t\t\t\t\t\tthis.ready = true;\n\t\t\t\t\t\t(new SuccessNotifier()).show();\n\t\t\t\t\t\tresolve();\n\t\t\t\t\t})\n\t\t\t\t\t.catch((response) => {\n\t\t\t\t\t\tthis.ready = true;\n\t\t\t\t\t\tErrorNotifierFactory.createFromResponse(response).show();\n\t\t\t\t\t\treject();\n\t\t\t\t\t})\n\t\t\t\t;\n\t\t\t}\n\t\t});\n\t}\n\n\tstatic #instance = null;\n\n\tstatic getInstance(): Registration\n\t{\n\t\tif (this.#instance === null)\n\t\t{\n\t\t\tthis.#instance = new this();\n\t\t}\n\n\t\treturn this.#instance;\n\t}\n}\n"],"names":["Notifier","constructor","message","getTitle","Loc","getMessage","show","MessageBox","title","modal","buttons","BX","UI","Dialogs","MessageBoxButtons","OK","maxWidth","Notifier0","effectiveUrl","body","getEffectiveUrl","getBody","Type","isStringFilled","Text","encode","copyButton","Tag","render","clipboard","bindCopyClick","text","JSON","stringify","STATUS","CODE","Notifier200","Notifier403","ErrorNotifierFactory","createFromResponse","response","isArrayLike","errors","error","shift","customData","status","effective_url","code","SuccessNotifier","Registration","ready","bind","node","Event","send","Promise","resolve","reject","ajax","runAction","data","then","catch","getInstance"],"mappings":"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"}