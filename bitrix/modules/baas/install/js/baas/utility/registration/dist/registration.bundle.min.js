this.BX=this.BX||{};this.BX.Baas=this.BX.Baas||{};(function(e,t,s,a){"use strict";class i{constructor(e){this.message=e}getTitle(){return s.Loc.getMessage("BAAS_ERROR_REGISTRATION_TITLE")}getMessage(){return this.message}show(){a.MessageBox.show({title:this.getTitle(),message:this.getMessage(),modal:true,buttons:BX.UI.Dialogs.MessageBoxButtons.OK,maxWidth:1e3})}}let r=e=>e,o,c;class l extends i{constructor(e,t,s){super(e);this.effectiveUrl=t;this.body=s}getTitle(){return s.Loc.getMessage("BAAS_ERROR_REGISTRATION_TITLE_0")}getMessage(){return s.Loc.getMessage("BAAS_ERROR_REGISTRATION_MESSAGE_0",{"#effectiveUrl#":this.effectiveUrl})}getEffectiveUrl(){return this.effectiveUrl}getBody(){if(s.Type.isStringFilled(this.body)){return`<textarea style="width: 90%;">${s.Text.encode(this.body)}</textarea>`}return""}show(){const e=s.Tag.render(o||(o=r`<div class="ui-icon-set --copy-plates"></div>`));BX.clipboard.bindCopyClick(e,{text:()=>JSON.stringify({effectiveUrl:this.getEffectiveUrl(),body:this.getBody()})});a.MessageBox.show({title:this.getTitle(),message:s.Tag.render(c||(c=r`
				<div>${0}
					<dd>
						<dt>${0} ${0}</dt>
						<dl>${0}</dl>
					</dd>
				</div>
			`),this.getMessage(),this.getEffectiveUrl(),e,this.getBody()),modal:true,buttons:BX.UI.Dialogs.MessageBoxButtons.OK,maxWidth:1e3})}}l.STATUS=0;l.CODE=9713;class n extends l{getMessage(){return s.Loc.getMessage("BAAS_ERROR_REGISTRATION_MESSAGE_200",{"#effectiveUrl#":this.effectiveUrl})}}n.STATUS=200;class g extends l{getTitle(){return s.Loc.getMessage("BAAS_ERROR_REGISTRATION_TITLE_403")}getMessage(){return s.Loc.getMessage("BAAS_ERROR_REGISTRATION_MESSAGE_403",{"#effectiveUrl#":this.effectiveUrl})}}g.STATUS=403;class u{static createFromResponse(e={}){if(e&&s.Type.isArrayLike(e.errors)){const t=[...e.errors].shift();if(t.customData&&t.customData.status){switch(t.customData.status){case l.STATUS:return new l(t.message,t.customData.effective_url,t.customData.body);case g.STATUS:return new g(t.message,t.customData.effective_url,t.customData.body);default:return new n(t.message,t.customData.effective_url,t.customData.body)}}switch(t.code){case l.CODE:return new l(t.message,t.customData.effective_url,t.customData.body);case g.CODE:return new g(t.message,t.customData.effective_url,t.customData.body);default:return new i(t.message)}}return new i}}class d{show(){a.MessageBox.show({title:s.Loc.getMessage("BAAS_SUCCESS_REGISTRATION_TITLE"),message:s.Loc.getMessage("BAAS_SUCCESS_REGISTRATION_MESSAGE",{"#LINK#":"/bitrix/admin/baas_marketplace.php"}),modal:true,buttons:BX.UI.Dialogs.MessageBoxButtons.OK,maxWidth:1e3})}}var h=babelHelpers.classPrivateFieldLooseKey("instance");class f{constructor(){this.ready=true}bind(e){s.Event.bind(e,"click",this.send.bind(this));return this}send(){return new Promise(((e,t)=>{if(this.ready===false){t()}else{this.ready=false;s.ajax.runAction("baas.Host.register",{data:{}}).then((t=>{this.ready=true;(new d).show();e()})).catch((e=>{this.ready=true;u.createFromResponse(e).show();t()}))}}))}static getInstance(){if(babelHelpers.classPrivateFieldLooseBase(this,h)[h]===null){babelHelpers.classPrivateFieldLooseBase(this,h)[h]=new this}return babelHelpers.classPrivateFieldLooseBase(this,h)[h]}}Object.defineProperty(f,h,{writable:true,value:null});e.Registration=f})(this.BX.Baas.Utility=this.BX.Baas.Utility||{},BX,BX,BX.UI.Dialogs);
//# sourceMappingURL=registration.bundle.map.js