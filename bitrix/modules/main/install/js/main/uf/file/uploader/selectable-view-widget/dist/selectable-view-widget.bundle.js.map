{"version":3,"file":"selectable-view-widget.bundle.js","sources":["../src/components/view-selector.js","../src/components/view/base-item.js","../src/components/view/tile/tile-item-adapter.js","../src/components/viewer-decorator.js","../src/components/view/base-list.js","../src/components/view/tile/tile-list.js","../src/components/view/list/item.js","../src/components/view/list/list.js","../src/components/view/adaptive/adaptive-list.js","../src/components/view/adaptive/adaptive-item.js","../src/components/selectable-view-widget.js","../src/selectable-view-widget.js"],"sourcesContent":["import { Button, ButtonSize, AirButtonStyle, ButtonTag } from 'ui.vue3.components.button';\n\nimport type { BitrixVueComponentProps } from 'ui.vue3';\nimport type { ViewOptions } from '../types';\n\n// @vue/component\nexport const ViewSelector: BitrixVueComponentProps = {\n\tname: 'ViewSelector',\n\n\tcomponents: {\n\t\tUiButton: Button,\n\t},\n\n\tprops: {\n\t\tviews: {\n\t\t\ttype: Array,\n\t\t\trequired: true,\n\t\t},\n\t\tviewId: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t\tonChange: {\n\t\t\ttype: Function,\n\t\t\trequired: false,\n\t\t\tdefault: () => {},\n\t\t},\n\t},\n\n\tsetup(): Object\n\t{\n\t\treturn {\n\t\t\tButtonSize,\n\t\t\tAirButtonStyle,\n\t\t\tButtonTag,\n\t\t};\n\t},\n\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tcurrentViewId: this.viewId,\n\t\t};\n\t},\n\n\tmethods: {\n\t\thandleViewClick(view: ViewOptions): void\n\t\t{\n\t\t\tif (this.currentViewId === view.id)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.currentViewId = view.id;\n\t\t\tthis.onChange(view);\n\t\t},\n\t},\n\n\t// language=Vue\n\ttemplate: `\n\t\t<div class=\"main-file-field-selectable-view__view-selector\">\n\t\t\t<div class=\"main-file-field-selectable-view__view-selector-items\">\n\t\t\t\t<UiButton\n\t\t\t\t\tv-for=\"view in views\"\n\t\t\t\t\t@click=\"handleViewClick(view)\"\n\t\t\t\t\t:dataset=\"{ editorControlType: 'button' }\"\n\t\t\t\t\t:text=\"view.title\"\n\t\t\t\t\t:left-icon=\"view.icon\"\n\t\t\t\t\t:size=\"ButtonSize.SMALL\"\n\t\t\t\t\t:style=\"currentViewId === view.id ? AirButtonStyle.SELECTION : AirButtonStyle.PLAIN_NO_ACCENT\"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import type { BitrixVueComponentProps } from 'ui.vue3';\nimport type { FileItemOptions } from '../../types';\n\n// @vue/component\nexport const BaseItem: BitrixVueComponentProps = {\n\tname: 'BaseItem',\n\n\tprops: {\n\t\tfileItem: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t},\n\n\tcomputed: {\n\t\tfile(): FileItemOptions\n\t\t{\n\t\t\treturn this.fileItem;\n\t\t},\n\t},\n};\n","import { TileItem } from 'ui.uploader.tile-widget';\nimport { FileStatus } from 'ui.uploader.core';\n\nimport { BaseItem } from '../base-item';\n\nimport type { BitrixVueComponentProps } from 'ui.vue3';\n\n// @vue/component\nexport const TileItemAdapter: BitrixVueComponentProps = {\n\tname: 'TileItemAdapter',\n\n\tcomponents: {\n\t\tTileItem,\n\t},\n\n\textends: BaseItem,\n\n\tprovide: {\n\t\tuploader: {},\n\t\twidgetOptions: {\n\t\t\tshowItemMenuButton: false,\n\t\t},\n\t\temitter: {},\n\t\tadapter: {},\n\t},\n\n\tcomputed: {\n\t\ttileItem(): Object\n\t\t{\n\t\t\treturn {\n\t\t\t\tname: this.file.name,\n\t\t\t\textension: this.file.extension,\n\t\t\t\tisImage: this.file.isImage,\n\t\t\t\tpreviewUrl: this.file.isImage ? this.file.url : null,\n\t\t\t\tstatus: FileStatus.COMPLETE,\n\t\t\t\tcustomData: {},\n\t\t\t};\n\t\t},\n\t},\n\n\t// language=Vue\n\ttemplate: `\n\t\t<TileItem :item=\"tileItem\" :readonly=\"true\" />\n\t`,\n};\n","import type { BitrixVueComponentProps } from 'ui.vue3';\nimport type { FileItemOptions } from '../types';\n\n// @vue/component\nexport const ViewerDecorator: BitrixVueComponentProps = {\n\tname: 'ViewerDecorator',\n\n\tprops: {\n\t\tfileItem: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t},\n\n\tcomputed: {\n\t\tfile(): FileItemOptions\n\t\t{\n\t\t\treturn this.fileItem;\n\t\t},\n\t},\n\n\t// language=Vue\n\ttemplate: `\n\t\t<a class=\"main-file-field-selectable-view__viewer-decorator\" v-bind=\"file.attributes\" :href=\"file.urlForViewer\">\n\t\t\t<slot />\n\t\t</a>\n\t`,\n};\n","import type { BitrixVueComponentProps } from 'ui.vue3';\nimport type { FileItemOptions } from '../../types';\n\n// @vue/component\nexport const BaseList: BitrixVueComponentProps = {\n\tname: 'BaseList',\n\n\tprops: {\n\t\tfileItems: {\n\t\t\ttype: Array,\n\t\t\trequired: true,\n\t\t},\n\t},\n\n\tcomputed: {\n\t\tfiles(): FileItemOptions[]\n\t\t{\n\t\t\treturn this.fileItems;\n\t\t},\n\t},\n};\n","import { TileItemAdapter } from './tile-item-adapter';\nimport { ViewerDecorator } from '../../viewer-decorator';\nimport { BaseList } from '../base-list';\n\nimport type { BitrixVueComponentProps } from 'ui.vue3';\n\n// @vue/component\nexport const TileList: BitrixVueComponentProps = {\n\tname: 'TileList',\n\n\tcomponents: {\n\t\tTileItemAdapter,\n\t\tViewerDecorator,\n\t},\n\n\textends: BaseList,\n\n\t// language=Vue\n\ttemplate: `\n\t\t<div class=\"ui-tile-uploader\">\n\t\t\t<div class='main-file-field-selectable-view__tile-list ui-tile-uploader-items'>\n\t\t\t\t<ViewerDecorator v-for=\"file in files\" :file-item=\"file\">\n\t\t\t\t\t<TileItemAdapter :file-item=\"file\" />\n\t\t\t\t</ViewerDecorator>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import { FileIcon } from 'ui.uploader.tile-widget';\n\nimport { BaseItem } from '../base-item';\n\nimport type { BitrixVueComponentProps } from 'ui.vue3';\n\nconst MAX_FILENAME_LENGTH = 60;\nconst CROP_FILENAME_END_LENGTH = 5;\n\n// @vue/component\nexport const Item: BitrixVueComponentProps = {\n\t// eslint-disable-next-line vue/multi-word-component-names\n\tname: 'Item',\n\n\tcomponents: {\n\t\tFileIcon,\n\t},\n\n\textends: BaseItem,\n\n\tcomputed: {\n\t\tformatFileName(): string\n\t\t{\n\t\t\tconst fileName = this.fileNameWithoutExtension;\n\t\t\tif (fileName.length <= MAX_FILENAME_LENGTH)\n\t\t\t{\n\t\t\t\treturn fileName;\n\t\t\t}\n\n\t\t\tconst start = fileName.slice(0, MAX_FILENAME_LENGTH - CROP_FILENAME_END_LENGTH - 1);\n\t\t\tconst end = fileName.slice(-1 * CROP_FILENAME_END_LENGTH);\n\n\t\t\treturn `${start}...${end}`;\n\t\t},\n\n\t\tfileNameWithoutExtension(): string\n\t\t{\n\t\t\tif (!this.file.extension)\n\t\t\t{\n\t\t\t\treturn this.file.name;\n\t\t\t}\n\n\t\t\tconst start = 0;\n\t\t\tconst end = this.file.name.length - this.file.extension.length - 1;\n\n\t\t\treturn this.file.name.slice(start, end);\n\t\t},\n\n\t\tformatExtension(): string\n\t\t{\n\t\t\treturn this.file.extension ? `.${this.file.extension}` : '';\n\t\t},\n\t},\n\n\t// language=Vue\n\ttemplate: `\n\t\t<div class=\"main-file-field-selectable-view__list-item\">\n\t\t\t<div class=\"main-file-field-selectable-view__list-item-preview-container\">\n\t\t\t\t<div v-if=\"file.isImage\" class=\"main-file-field-selectable-view__list-item-preview --image\">\n\t\t\t\t\t<img class=\"main-file-field-selectable-view__image\" :src=\"file.url\" alt=\"\">\n\t\t\t\t</div>\n\t\t\t\t<FileIcon\n\t\t\t\t\tv-else\n\t\t\t\t\tclass=\"main-file-field-selectable-view__list-item-preview --icon\"\n\t\t\t\t\t:name=\"file.extension || '...'\"\n\t\t\t\t\t:size=\"16\"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t\t<div class=\"main-file-field-selectable-view__list-item-filename-container\" :title=\"file.name\">\n\t\t\t\t<span class=\"main-file-field-selectable-view__list-item-filename\">{{ formatFileName }}</span>\n\t\t\t\t<span class=\"main-file-field-selectable-view__list-item-extension\">{{ formatExtension }}</span>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import { BaseList } from '../base-list';\nimport { Item } from './item';\nimport { ViewerDecorator } from '../../viewer-decorator';\n\nimport type { BitrixVueComponentProps } from 'ui.vue3';\n\nimport '../../../css/view/list.css';\nimport 'ui.fonts.inter';\n\n// @vue/component\nexport const List: BitrixVueComponentProps = {\n\t// eslint-disable-next-line vue/multi-word-component-names\n\tname: 'List',\n\n\tcomponents: {\n\t\tViewerDecorator,\n\t\tItem,\n\t},\n\n\textends: BaseList,\n\n\t// language=Vue\n\ttemplate: `\n\t\t<div class='main-file-field-selectable-view__list'>\n\t\t\t<ViewerDecorator v-for=\"file in files\" :file-item=\"file\">\n\t\t\t\t<Item :file-item=\"file\"/>\n\t\t\t</ViewerDecorator>\n\t\t</div>\n\t`,\n};\n","import { BaseList } from '../base-list';\nimport { ViewerDecorator } from '../../viewer-decorator';\nimport { AdaptiveItem } from './adaptive-item';\n\nimport type { BitrixVueComponentProps } from 'ui.vue3';\nimport type { FileItemOptions } from '../../../types';\n\nimport '../../../css/view/adaptive.css';\n\n// @vue/component\nexport const AdaptiveList: BitrixVueComponentProps = {\n\tname: 'AdaptiveList',\n\n\tcomponents: {\n\t\tViewerDecorator,\n\t\tAdaptiveItem,\n\t},\n\n\textends: BaseList,\n\n\tcomputed: {\n\t\tsortedFiles(): FileItemOptions[]\n\t\t{\n\t\t\treturn [...this.files]\n\t\t\t\t.sort((fileA: FileItemOptions, fileB: FileItemOptions): number => {\n\t\t\t\t\tswitch (true)\n\t\t\t\t\t{\n\t\t\t\t\t\tcase fileA.isImage && fileB.isImage:\n\t\t\t\t\t\t\treturn 0;\n\t\t\t\t\t\tcase fileA.isImage:\n\t\t\t\t\t\t\treturn -1;\n\t\t\t\t\t\tcase fileB.isImage:\n\t\t\t\t\t\t\treturn 1;\n\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\treturn 0;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t},\n\t},\n\n\t// language=Vue\n\ttemplate: `\n\t\t<div class=\"main-file-field-selectable-view__adaptive-list\">\n\t\t\t<ViewerDecorator :class=\"{ '--image': file.isImage }\" v-for=\"file in sortedFiles\" :file-item=\"file\">\n\t\t\t\t<AdaptiveItem :file-item=\"file\" />\n\t\t\t</ViewerDecorator>\n\t\t</div>\n\t`,\n};\n","import { BaseItem } from '../base-item';\nimport { Item } from '../list/item';\n\nimport type { BitrixVueComponentProps } from 'ui.vue3';\n\n// @vue/component\nexport const AdaptiveItem: BitrixVueComponentProps = {\n\tname: 'AdaptiveItem',\n\n\tcomponents: {\n\t\tItem,\n\t},\n\n\textends: BaseItem,\n\n\t// language=Vue\n\ttemplate: `\n\t\t<div class=\"main-file-field-selectable-view__adaptive-item\">\n\t\t\t<div v-if=\"file.isImage\" class=\"main-file-field-selectable-view__adaptive-item-image-container\">\n\t\t\t\t<img class=\"main-file-field-selectable-view__image\" :src=\"file.urlForViewer\" :alt=\"file.name\" :title=\"file.name\" />\n\t\t\t</div>\n\t\t\t<Item v-else :file-item=\"file\" />\n\t\t</div>\n\t`,\n};\n","import 'ui.entity-editor';\n\nimport { ViewSelector } from './view-selector';\nimport { TileList } from './view/tile/tile-list';\nimport { List } from './view/list/list';\nimport { AdaptiveList } from './view/adaptive/adaptive-list';\n\nimport type { BitrixVueComponentProps } from 'ui.vue3';\nimport type { ViewOptions } from '../types';\n\nimport '../css/selectable-view-widget.css';\nimport 'ui.design-tokens';\n\nconst View = BX.UI.EntityEditorUserFieldFileView;\n\n// @vue/component\nexport const SelectableViewWidget: BitrixVueComponentProps = {\n\tname: 'SelectableViewWidget',\n\tcomponents: {\n\t\tViewSelector,\n\t\tTileList,\n\t\tList,\n\t\tAdaptiveList,\n\t},\n\n\tprops: {\n\t\tfileItems: {\n\t\t\ttype: Array,\n\t\t\trequired: true,\n\t\t},\n\t\tviewId: {\n\t\t\ttype: [String, null],\n\t\t\trequired: false,\n\t\t\tdefault: null,\n\t\t},\n\t},\n\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tcurrentViewId: this.viewId ?? View.default().id,\n\t\t\tviews: View.getAll(),\n\t\t};\n\t},\n\n\tcomputed: {\n\t\tcomponent(): BitrixVueComponentProps\n\t\t{\n\t\t\treturn this.getViewComponentMap().get(this.currentViewId);\n\t\t},\n\t},\n\n\tmethods: {\n\t\tgetViewComponentMap(): Map<string, BitrixVueComponentProps>\n\t\t{\n\t\t\treturn new Map([\n\t\t\t\t[View.TILE.id, TileList],\n\t\t\t\t[View.LIST.id, List],\n\t\t\t\t[View.ADAPTIVE.id, AdaptiveList],\n\t\t\t]);\n\t\t},\n\n\t\thandleViewChange(view: ViewOptions): void\n\t\t{\n\t\t\tthis.currentViewId = view.id;\n\t\t},\n\t},\n\n\t// language=Vue\n\ttemplate: `\n\t\t<div class=\"main-file-field-selectable-view\">\n\t\t\t<div class=\"main-file-field-selectable-view__view-selector-container\">\n\t\t\t\t<ViewSelector :views=\"views\" :view-id=\"currentViewId\" :on-change=\"handleViewChange\" />\n\t\t\t</div>\n\t\t\t<div class=\"main-file-field-selectable-view__file-list-container\">\n\t\t\t\t<component :is=\"component\" :file-items=\"fileItems\" />\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import { BitrixVue, VueCreateAppResult } from 'ui.vue3';\n\nimport { SelectableViewWidget as SelectableViewWidgetComponent } from './components/selectable-view-widget';\nimport type { SelectableViewWidgetOptions } from './types';\n\nexport class SelectableViewWidget\n{\n\t#app: VueCreateAppResult;\n\n\tconstructor(options: SelectableViewWidgetOptions)\n\t{\n\t\tthis.#app = BitrixVue.createApp(SelectableViewWidgetComponent, options);\n\t}\n\n\tmount(node: HTMLElement): Object\n\t{\n\t\treturn this.#app.mount(node);\n\t}\n}\n"],"names":["ViewSelector","name","components","UiButton","Button","props","views","type","Array","required","viewId","String","onChange","Function","default","setup","ButtonSize","AirButtonStyle","ButtonTag","data","currentViewId","this","methods","handleViewClick","view","id","template","BaseItem","fileItem","Object","computed","file","TileItemAdapter","TileItem","extends","provide","uploader","widgetOptions","showItemMenuButton","emitter","adapter","tileItem","extension","isImage","previewUrl","url","status","FileStatus","COMPLETE","customData","ViewerDecorator","BaseList","fileItems","files","TileList","Item","FileIcon","formatFileName","fileName","fileNameWithoutExtension","length","slice","MAX_FILENAME_LENGTH","end","formatExtension","List","AdaptiveList","AdaptiveItem","sortedFiles","sort","fileA","fileB","View","BX","UI","EntityEditorUserFieldFileView","SelectableViewWidget","getAll","component","getViewComponentMap","get","Map","TILE","LIST","ADAPTIVE","handleViewChange","constructor","options","writable","value","babelHelpers","BitrixVue","createApp","SelectableViewWidgetComponent","mount","node"],"mappings":"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"}