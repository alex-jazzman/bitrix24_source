this.BX=this.BX||{};this.BX.Crm=this.BX.Crm||{};(function(e,s,l,a,t,i,r,o){"use strict";let n=e=>e,c,b,p;const d=3;var v=babelHelpers.classPrivateFieldLooseKey("bannerDispatcher");var u=babelHelpers.classPrivateFieldLooseKey("popup");var P=babelHelpers.classPrivateFieldLooseKey("originalOverflowValue");var L=babelHelpers.classPrivateFieldLooseKey("targetContainer");var h=babelHelpers.classPrivateFieldLooseKey("step");var B=babelHelpers.classPrivateFieldLooseKey("closeOptionName");var F=babelHelpers.classPrivateFieldLooseKey("closeOptionCategory");var y=babelHelpers.classPrivateFieldLooseKey("analytics");var H=babelHelpers.classPrivateFieldLooseKey("getPopup");var f=babelHelpers.classPrivateFieldLooseKey("createPopup");var O=babelHelpers.classPrivateFieldLooseKey("getPopupParams");var _=babelHelpers.classPrivateFieldLooseKey("getPopupContent");var g=babelHelpers.classPrivateFieldLooseKey("renderVideo");var E=babelHelpers.classPrivateFieldLooseKey("getVideoPath");var w=babelHelpers.classPrivateFieldLooseKey("getStepContent");var m=babelHelpers.classPrivateFieldLooseKey("getButton");var T=babelHelpers.classPrivateFieldLooseKey("getButtonText");var A=babelHelpers.classPrivateFieldLooseKey("isLastStep");var C=babelHelpers.classPrivateFieldLooseKey("goToNextStep");var K=babelHelpers.classPrivateFieldLooseKey("setTargetOverflow");var j=babelHelpers.classPrivateFieldLooseKey("resetTargetOverflow");var S=babelHelpers.classPrivateFieldLooseKey("getTarget");var N=babelHelpers.classPrivateFieldLooseKey("sendViewAnalytics");var I=babelHelpers.classPrivateFieldLooseKey("sendCloseAnalytics");var R=babelHelpers.classPrivateFieldLooseKey("sendClickAnalytics");var D=babelHelpers.classPrivateFieldLooseKey("sendAnalytics");class X{constructor(e){var s,l,a;Object.defineProperty(this,D,{value:ae});Object.defineProperty(this,R,{value:le});Object.defineProperty(this,I,{value:se});Object.defineProperty(this,N,{value:ee});Object.defineProperty(this,S,{value:Z});Object.defineProperty(this,j,{value:W});Object.defineProperty(this,K,{value:J});Object.defineProperty(this,C,{value:Q});Object.defineProperty(this,A,{value:q});Object.defineProperty(this,T,{value:Y});Object.defineProperty(this,m,{value:V});Object.defineProperty(this,w,{value:G});Object.defineProperty(this,E,{value:z});Object.defineProperty(this,g,{value:x});Object.defineProperty(this,_,{value:$});Object.defineProperty(this,O,{value:U});Object.defineProperty(this,f,{value:M});Object.defineProperty(this,H,{value:k});Object.defineProperty(this,v,{writable:true,value:null});Object.defineProperty(this,u,{writable:true,value:null});Object.defineProperty(this,P,{writable:true,value:null});Object.defineProperty(this,L,{writable:true,value:null});Object.defineProperty(this,h,{writable:true,value:0});Object.defineProperty(this,B,{writable:true,value:null});Object.defineProperty(this,F,{writable:true,value:null});Object.defineProperty(this,y,{writable:true,value:null});babelHelpers.classPrivateFieldLooseBase(this,B)[B]=(s=e==null?void 0:e.closeOptionName)!=null?s:null;babelHelpers.classPrivateFieldLooseBase(this,F)[F]=(l=e==null?void 0:e.closeOptionCategory)!=null?l:null;babelHelpers.classPrivateFieldLooseBase(this,y)[y]=(a=e==null?void 0:e.analytics)!=null?a:{}}show(){if(babelHelpers.classPrivateFieldLooseBase(this,H)[H]().isShown()){return}babelHelpers.classPrivateFieldLooseBase(this,v)[v]=new l.BannerDispatcher;babelHelpers.classPrivateFieldLooseBase(this,v)[v].toQueue((e=>{babelHelpers.classPrivateFieldLooseBase(this,K)[K]("hidden");babelHelpers.classPrivateFieldLooseBase(this,H)[H]().subscribe("onAfterClose",e);babelHelpers.classPrivateFieldLooseBase(this,H)[H]().show()}),l.Priority.CRITICAL)}}function k(){if(babelHelpers.classPrivateFieldLooseBase(this,u)[u]===null){babelHelpers.classPrivateFieldLooseBase(this,u)[u]=babelHelpers.classPrivateFieldLooseBase(this,f)[f]()}return babelHelpers.classPrivateFieldLooseBase(this,u)[u]}function M(){return new t.Popup(babelHelpers.classPrivateFieldLooseBase(this,O)[O]())}function U(){return{id:"crm_repeat_sale_onboarding_popup",targetContainer:babelHelpers.classPrivateFieldLooseBase(this,S)[S](),content:babelHelpers.classPrivateFieldLooseBase(this,_)[_](),cacheable:true,isScrollBlock:false,className:"crm-repeat-sale-onboarding-popup",closeByEsc:true,closeIcon:true,padding:16,width:733,overlay:{opacity:40,backgroundColor:"#000000"},animation:"fading-slide",autoHide:false,events:{onFirstShow:()=>{babelHelpers.classPrivateFieldLooseBase(this,N)[N]()},onclose:()=>{babelHelpers.classPrivateFieldLooseBase(this,j)[j]();BX.userOptions.save(babelHelpers.classPrivateFieldLooseBase(this,F)[F],babelHelpers.classPrivateFieldLooseBase(this,B)[B],"closed","Y");babelHelpers.classPrivateFieldLooseBase(this,I)[I]()}}}}function $(){const e=new o.Icon({size:29,color:"#853AF5",icon:o.Outline.COPILOT});return a.Tag.render(c||(c=n`
			<div class="crm-repeat-sale__onboarding-popup-container">
				<div class="crm-repeat-sale__onboarding-popup-title">
					${0}
					${0}
				</div>
				<div class="crm-repeat-sale__onboarding-popup-video">
					<div>
						${0}
					</div>
				</div>
				<div class="crm-repeat-sale__onboarding-popup-content">
					${0}
				</div>
			</div>
		`),a.Loc.getMessage("CRM_REPEAT_SALE_ONBOARDING_TITLE"),e.render(),babelHelpers.classPrivateFieldLooseBase(this,g)[g](),babelHelpers.classPrivateFieldLooseBase(this,w)[w]())}function x(){const e=a.Tag.render(b||(b=n`
			<video
				src="${0}"
				autoplay
				preload
				loop
			></video>
		`),babelHelpers.classPrivateFieldLooseBase(this,E)[E]());e.addEventListener("canplay",(()=>{e.muted=true;e.play()}));return e}function z(){const e=a.Extension.getSettings("crm.repeat-sale.onboarding-popup").get("region");let s="how-it-work-en";if(["kz","ru","by","uz"].includes(e)){s="how-it-work-ru"}return`/bitrix/js/crm/repeat-sale/onboarding-popup/video/${s}.webm`}function G(){return a.Tag.render(p||(p=n`
			<div class="crm-repeat-sale__onboarding-popup-step-container">
				<div class="crm-repeat-sale__onboarding-popup-step-text">
					${0}
				</div>
				<div class="crm-repeat-sale__onboarding-popup-button">
					${0}
				</div>
			</div>
		`),a.Loc.getMessage(`CRM_REPEAT_SALE_ONBOARDING_TEXT_STEP_${babelHelpers.classPrivateFieldLooseBase(this,h)[h]}`),babelHelpers.classPrivateFieldLooseBase(this,m)[m]().render())}function V(){const e=babelHelpers.classPrivateFieldLooseBase(this,A)[A]()?r.AirButtonStyle.TINTED:r.AirButtonStyle.FILLED_COPILOT;const s=babelHelpers.classPrivateFieldLooseBase(this,A)[A]()?o.Outline.CHECK_M:o.Outline.NEXT;return new r.Button({useAirDesign:true,text:babelHelpers.classPrivateFieldLooseBase(this,T)[T](),round:true,size:BX.UI.Button.Size.LARGE,icon:s,style:e,onclick:()=>{if(babelHelpers.classPrivateFieldLooseBase(this,A)[A]()){babelHelpers.classPrivateFieldLooseBase(this,H)[H]().close();babelHelpers.classPrivateFieldLooseBase(this,H)[H]().destroy()}else{babelHelpers.classPrivateFieldLooseBase(this,C)[C]()}}})}function Y(){const e=babelHelpers.classPrivateFieldLooseBase(this,A)[A]()?"CRM_REPEAT_SALE_ONBOARDING_BUTTON_CLOSE":"CRM_REPEAT_SALE_ONBOARDING_BUTTON_NEXT";return a.Loc.getMessage(e)}function q(){return babelHelpers.classPrivateFieldLooseBase(this,h)[h]===d}function Q(){babelHelpers.classPrivateFieldLooseBase(this,h)[h]++;a.Dom.replace(document.querySelector(".crm-repeat-sale__onboarding-popup-step-container"),babelHelpers.classPrivateFieldLooseBase(this,w)[w]());babelHelpers.classPrivateFieldLooseBase(this,R)[R]()}function J(e){babelHelpers.classPrivateFieldLooseBase(this,P)[P]=a.Dom.style(babelHelpers.classPrivateFieldLooseBase(this,S)[S](),"overflow");a.Dom.style(babelHelpers.classPrivateFieldLooseBase(this,S)[S](),"overflow",e)}function W(){if(babelHelpers.classPrivateFieldLooseBase(this,P)[P]===null){return}a.Dom.style(babelHelpers.classPrivateFieldLooseBase(this,S)[S](),"overflow",babelHelpers.classPrivateFieldLooseBase(this,P)[P]);babelHelpers.classPrivateFieldLooseBase(this,P)[P]=null}function Z(){if(babelHelpers.classPrivateFieldLooseBase(this,L)[L]===null){babelHelpers.classPrivateFieldLooseBase(this,L)[L]=document.body}return babelHelpers.classPrivateFieldLooseBase(this,L)[L]}function ee(){babelHelpers.classPrivateFieldLooseBase(this,D)[D]("view")}function se(){babelHelpers.classPrivateFieldLooseBase(this,D)[D]("close")}function le(){babelHelpers.classPrivateFieldLooseBase(this,D)[D]("click")}function ae(e){var l;const a=s.Dictionary.TYPE_REPEAT_SALE_BANNER_NULL;const t=(l=babelHelpers.classPrivateFieldLooseBase(this,y)[y].c_sub_section)!=null?l:s.Dictionary.SUB_SECTION_KANBAN;let r=null;if(e==="view"){r=s.Builder.RepeatSale.Banner.ViewEvent.createDefault(a,t)}else if(e==="close"){r=s.Builder.RepeatSale.Banner.CloseEvent.createDefault(a,t)}else if(e==="click"){r=s.Builder.RepeatSale.Banner.ClickEvent.createDefault(a,t)}if(r){var o;const e=(o=babelHelpers.classPrivateFieldLooseBase(this,y)[y].c_section)!=null?o:"";i.sendData(r.setSection(e).buildData())}}e.OnboardingPopup=X})(this.BX.Crm.RepeatSale=this.BX.Crm.RepeatSale||{},BX.Crm.Integration.Analytics,BX.Crm.Integration.UI,BX,BX.Main,BX.UI.Analytics,BX.UI,BX.UI.IconSet);
//# sourceMappingURL=onboarding-popup.bundle.map.js