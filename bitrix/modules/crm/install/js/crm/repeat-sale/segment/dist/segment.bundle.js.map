{"version":3,"file":"segment.bundle.js","sources":["../src/components/common/additional-info-component.js","../src/components/common/ai-switcher-component.js","../src/components/common/text-editor-wrapper-component.js","../src/components/navigation/button.js","../src/components/selector/call-assessment-selector.js","../src/components/common/dialog-wrapper-component.js","../src/components/common/tag-selector-wrapper-component.js","../src/components/selector/category-selector.js","../src/components/selector/stage-selector.js","../src/components/selector/user-selector.js","../src/components/segment.js","../src/segment.js"],"sourcesContent":["import { Event, Extension, Loc } from 'main.core';\nimport { PromoVideoPopup } from 'ui.promo-video-popup';\n\nexport const AdditionalInfoComponent = {\n\tprops: {\n\t\ttitle: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t},\n\n\tmounted()\n\t{\n\t\tthis.popup = null;\n\t\tthis.region = Extension.getSettings('crm.repeat-sale.segment').get('region');\n\n\t\tEvent.EventEmitter.subscribe('UI.PromoVideoPopup:accept', (event) => {\n\t\t\tthis.popup?.hide();\n\t\t});\n\t},\n\n\tmethods: {\n\t\tonClick(): void\n\t\t{\n\t\t\tif (this.popup === null)\n\t\t\t{\n\t\t\t\tthis.popup = new PromoVideoPopup({\n\t\t\t\t\tangleOptions: null,\n\t\t\t\t\ttargetOptions: '1',\n\t\t\t\t\tuseOverlay: true,\n\t\t\t\t\tvideoSrc: this.videoSrc,\n\t\t\t\t\tvideoContainerMinHeight: 255,\n\t\t\t\t\ttitle: Loc.getMessage('CRM_REPEAT_SALE_SEGMENT_HOW_IT_WORK_TITLE'),\n\t\t\t\t\tcolors: {\n\t\t\t\t\t\ttitle: 'var(--ui-color-palette-black-base)',\n\t\t\t\t\t},\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tthis.popup.show();\n\t\t},\n\t},\n\n\tcomputed: {\n\t\tvideoSrc(): string\n\t\t{\n\t\t\tlet name = 'how-it-work-en';\n\t\t\tif (['kz', 'ru', 'by'].includes(this.region))\n\t\t\t{\n\t\t\t\tname = 'how-it-work-ru';\n\t\t\t}\n\n\t\t\treturn `/bitrix/js/crm/repeat-sale/segment/video/${name}.webm`;\n\t\t},\n\t},\n\n\t// language=Vue\n\ttemplate: `\n\t\t<div class=\"crm-repeat-sale__segment-field-info\">\n\t\t\t<span @click=\"onClick\">\n\t\t\t\t{{title}}\n\t\t\t</span>\n\t\t</div>\n\t`,\n};\n","import { Switcher, SwitcherSize } from 'ui.switcher';\nimport { AdditionalInfoComponent } from './additional-info-component';\n\nexport const AiSwitcherComponent = {\n\temits: [\n\t\t'change',\n\t],\n\n\tcomponents: {\n\t\tAdditionalInfoComponent,\n\t},\n\n\tprops: {\n\t\tchecked: {\n\t\t\ttype: Boolean,\n\t\t\trequired: true,\n\t\t},\n\t\treadOnly: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t},\n\n\tmounted(): void\n\t{\n\t\tthis.renderSwitcher();\n\t},\n\n\tmethods: {\n\t\trenderSwitcher(): void\n\t\t{\n\t\t\tif (!this.switcher)\n\t\t\t{\n\t\t\t\tthis.switcher = new Switcher({\n\t\t\t\t\tchecked: this.checked,\n\t\t\t\t\tdisabled: this.readOnly,\n\t\t\t\t\tsize: SwitcherSize.small,\n\t\t\t\t\tshowStateTitle: false,\n\t\t\t\t\thandlers: {\n\t\t\t\t\t\tchecked: (event) => {\n\t\t\t\t\t\t\tthis.emitChange(false);\n\t\t\t\t\t\t},\n\t\t\t\t\t\tunchecked: (event) => {\n\t\t\t\t\t\t\tthis.emitChange(true);\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t});\n\n\t\t\t\tthis.switcher.renderTo(this.$refs.switcher);\n\t\t\t}\n\t\t},\n\t\temitChange(value: boolean): void\n\t\t{\n\t\t\tthis.$emit('change', value);\n\t\t},\n\t},\n\n\tcomputed: {\n\t\tbadgeClassList(): Object\n\t\t{\n\t\t\treturn {\n\t\t\t\t'--enabled': this.checked,\n\t\t\t};\n\t\t},\n\t\tbadgeTitle(): string\n\t\t{\n\t\t\tif (this.checked)\n\t\t\t{\n\t\t\t\treturn this.$Bitrix.Loc.getMessage('CRM_REPEAT_SALE_SEGMENT_COPILOT_ENABLED');\n\t\t\t}\n\n\t\t\treturn this.$Bitrix.Loc.getMessage('CRM_REPEAT_SALE_SEGMENT_COPILOT_DISABLED');\n\t\t},\n\t},\n\n\twatch: {\n\t\tchecked(newValue: boolean): void\n\t\t{\n\t\t\tthis.switcher.check(newValue, false);\n\t\t},\n\t},\n\n\t// language=Vue\n\ttemplate: `\n\t\t<div class=\"crm-repeat-sale__segment-ai-switcher-wrapper\">\n\t\t\t<div>\n\t\t\t\t<div class=\"crm-repeat-sale__segment-ai-switcher-title\">\n\t\t\t\t\t{{this.$Bitrix.Loc.getMessage('CRM_REPEAT_SALE_SEGMENT_COPILOT_TITLE')}}\n\t\t\t\t\t<span :class=\"badgeClassList\">{{badgeTitle}}</span>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"crm-repeat-sale__segment-ai-switcher-description\">\n\t\t\t\t\t{{this.$Bitrix.Loc.getMessage('CRM_REPEAT_SALE_SEGMENT_COPILOT_DESCRIPTION')}}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div class=\"crm-repeat-sale__segment-ai-switcher\" ref=\"switcher\"></div>\n\t\t</div>\n\t`,\n};\n","import { Event, Runtime, Type } from 'main.core';\nimport { TextEditor, TextEditorComponent } from 'ui.text-editor';\nimport { AiSwitcherComponent } from './ai-switcher-component';\n\nexport const TextEditorWrapperComponent = {\n\tcomponents: {\n\t\tTextEditorComponent,\n\t\tAiSwitcherComponent,\n\t},\n\n\temits: [\n\t\t'change',\n\t],\n\n\tprops: {\n\t\ttextEditor: TextEditor,\n\t},\n\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\ttextEditorEvents: {\n\t\t\t\tonChange: this.emitChangeData,\n\t\t\t},\n\t\t};\n\t},\n\n\tmounted(): void\n\t{\n\t\tthis.setTextEditorHeight();\n\t\tthis.windowResizeHandler = this.windowResizeHandler.bind(this);\n\n\t\tEvent.bind(window, 'resize', this.windowResizeHandler);\n\t},\n\n\tunmounted(): void\n\t{\n\t\tEvent.unbind(window, 'resize', this.windowResizeHandler);\n\t},\n\n\tmethods: {\n\t\temitChangeData(): void\n\t\t{\n\t\t\tif (!Type.isFunction(this.onChangeDebounce))\n\t\t\t{\n\t\t\t\tthis.onChangeDebounce = Runtime.debounce(this.onChange, 100, this);\n\t\t\t}\n\n\t\t\tthis.onChangeDebounce();\n\t\t},\n\t\tonChange(): void\n\t\t{\n\t\t\tthis.$emit('change', {\n\t\t\t\tprompt: this.textEditor.getText(),\n\t\t\t});\n\t\t},\n\t\twindowResizeHandler(): void\n\t\t{\n\t\t\tthis.setTextEditorHeight();\n\t\t},\n\t\tsetTextEditorHeight(): void\n\t\t{\n\t\t\tconst editorOffsetTop = this.$el.parentNode.offsetTop;\n\n\t\t\tconst navigationClassName = '.crm-repeat-sale__segment_navigation-container';\n\t\t\tconst navigationOffsetTop = document.querySelector(navigationClassName)?.offsetTop ?? 0;\n\n\t\t\tconst textEditorContainerBottomPadding = 20;\n\t\t\tconst availableHeight = navigationOffsetTop - editorOffsetTop - textEditorContainerBottomPadding;\n\t\t\tconst minHeight = Math.round(availableHeight * 0.5);\n\t\t\tconst maxHeight = Math.round(availableHeight * 0.8);\n\n\t\t\tif (minHeight < 200)\n\t\t\t{\n\t\t\t\tthis.textEditor?.setMinHeight(maxHeight);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.textEditor?.setMinHeight(minHeight);\n\t\t\t}\n\n\t\t\tthis.textEditor?.setMaxHeight(maxHeight);\n\t\t},\n\t},\n\n\t// language=Vue\n\ttemplate: `\n\t\t<TextEditorComponent\n\t\t\t:events=\"textEditorEvents\"\n\t\t\t:editor-instance=\"textEditor\"\n\t\t/>\n\t`,\n};\n","import { Loc } from 'main.core';\nimport { AirButtonStyle, Button as UiButton } from 'ui.buttons';\n\nexport const ButtonEvents = {\n\tclick: 'crm:repeat-sale:segment:navigation-button-click',\n};\n\nexport const Button = {\n\tprops: {\n\t\tid: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t},\n\n\tmounted()\n\t{\n\t\tthis.initButton();\n\t},\n\n\tmethods: {\n\t\tinitButton(): void\n\t\t{\n\t\t\tthis.button = new UiButton({\n\t\t\t\tuseAirDesign: true,\n\t\t\t\ttext: Loc.getMessage(`CRM_REPEAT_SALE_SEGMENT_NAVIGATION_BUTTON_${this.id.toUpperCase()}`),\n\t\t\t\tround: true,\n\t\t\t\tstyle: this.buttonStyle,\n\t\t\t\tonclick: () => {\n\t\t\t\t\tthis.emitClickEvent();\n\t\t\t\t},\n\t\t\t});\n\n\t\t\tthis.button.setDataSet({\n\t\t\t\tid: `crm-repeat-sale-segment-buttons-${this.id.toLowerCase()}`,\n\t\t\t});\n\n\t\t\tif (this.$refs.button)\n\t\t\t{\n\t\t\t\tthis.button.renderTo(this.$refs.button);\n\t\t\t}\n\t\t},\n\t\temitClickEvent(): void\n\t\t{\n\t\t\tthis.$Bitrix.eventEmitter.emit(ButtonEvents.click, { id: this.id });\n\t\t},\n\t},\n\n\tcomputed: {\n\t\tbuttonStyle(): string\n\t\t{\n\t\t\tif (this.id === 'update')\n\t\t\t{\n\t\t\t\treturn AirButtonStyle.FILLED;\n\t\t\t}\n\n\t\t\treturn AirButtonStyle.OUTLINE;\n\t\t},\n\t},\n\n\t// language=Vue\n\ttemplate: `\n\t\t<div ref=\"button\" class=\"crm-repeat-sale__segment_button\"></div>\n\t`,\n};\n","import { Event } from 'main.core';\nimport { BaseEvent } from 'main.core.events';\nimport { Dialog } from 'ui.entity-selector';\n\nexport const CallAssessmentSelector = {\n\tprops: {\n\t\tcallAssessments: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t\tcurrentCallAssessmentId: {\n\t\t\ttype: Number,\n\t\t\trequired: true,\n\t\t},\n\t\treadOnly: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t},\n\n\tcreated()\n\t{\n\t\tthis.dialog = null;\n\t\tthis.tabs = [\n\t\t\t{ id: 'call_assessments', title: '' },\n\t\t];\n\n\t\tthis.items = [];\n\t\tthis.callAssessments.forEach((callAssessment, index) => {\n\t\t\tthis.items.push({\n\t\t\t\tid: callAssessment.id,\n\t\t\t\ttitle: callAssessment.name,\n\t\t\t\tentityId: 'call_assessment',\n\t\t\t\ttabs: 'call_assessments',\n\t\t\t\tselected: callAssessment.id === this.currentCallAssessmentId,\n\t\t\t});\n\t\t});\n\t},\n\n\tmethods: {\n\t\ttoggleDialog(): void\n\t\t{\n\t\t\tconst dialog = this.getDialog();\n\n\t\t\tif (dialog.isOpen())\n\t\t\t{\n\t\t\t\tdialog.hide();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tdialog.show();\n\t\t\t}\n\t\t},\n\t\tgetDialog(): Dialog\n\t\t{\n\t\t\tif (this.dialog === null)\n\t\t\t{\n\t\t\t\tconst targetNode = this.$refs.dialog;\n\t\t\t\tconst parentPopupContainer = targetNode.closest('body');\n\n\t\t\t\tthis.dialog = new Dialog({\n\t\t\t\t\ttargetNode,\n\t\t\t\t\tcontext: 'CRM_REPEAT_SALE_CALL_ASSESSMENT',\n\t\t\t\t\tmultiple: false,\n\t\t\t\t\tdropdownMode: true,\n\t\t\t\t\tshowAvatars: false,\n\t\t\t\t\tenableSearch: true,\n\t\t\t\t\twidth: 450,\n\t\t\t\t\tzIndex: 2500,\n\t\t\t\t\ttabs: this.tabs,\n\t\t\t\t\titems: this.items,\n\t\t\t\t\tsearchOptions: {\n\t\t\t\t\t\tallowCreateItem: false,\n\t\t\t\t\t},\n\t\t\t\t\tevents: {\n\t\t\t\t\t\t'Item:onSelect': (event: BaseEvent) => {\n\t\t\t\t\t\t\tconst { item: { id } } = event.getData();\n\t\t\t\t\t\t\tthis.emitSelectItem(id);\n\t\t\t\t\t\t},\n\t\t\t\t\t\tonShow: (event: BaseEvent) => {\n\t\t\t\t\t\t\tEvent.bindOnce(\n\t\t\t\t\t\t\t\tparentPopupContainer,\n\t\t\t\t\t\t\t\t'click',\n\t\t\t\t\t\t\t\tthis.onPopupContainerClick.bind(this),\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t});\n\t\t\t}\n\n\t\t\treturn this.dialog;\n\t\t},\n\t\temitSelectItem(itemId: number): void\n\t\t{\n\t\t\tthis.$emit('onSelectItem', itemId);\n\t\t},\n\t\tonPopupContainerClick(): void\n\t\t{\n\t\t\tthis.getDialog().hide();\n\t\t},\n\t},\n\n\t// language=Vue\n\ttemplate: `\n\t\t<div\n\t\t\tref=\"dialog\"\n\t\t\t@click=\"toggleDialog\"\n\t\t\tclass=\"crm-repeat-sale__segment_call-assessment\"\n\t\t>\n\t\t\t{{ this.$Bitrix.Loc.getMessage('CRM_REPEAT_SALE_SEGMENT_CALL_ASSESSMENT_SELECTOR') }}\n\t\t</div>\n\t`,\n};\n","import { Event } from 'main.core';\nimport { BaseEvent } from 'main.core.events';\nimport { Dialog } from 'ui.entity-selector';\n\ntype ItemId = [\n\tstring,\n\t\tstring | number,\n];\n\nexport const DialogWrapperComponent = {\n\temits: [\n\t\t'change',\n\t\t'onSelectItem',\n\t\t'onDeselectItem',\n\t],\n\n\tprops: {\n\t\titems: {\n\t\t\ttype: Array,\n\t\t\tdefault: [],\n\t\t},\n\t\ttabs: {\n\t\t\ttype: Array,\n\t\t\tdefault: [],\n\t\t},\n\t\tentities: {\n\t\t\ttype: Array,\n\t\t\tdefault: [],\n\t\t},\n\t\tshowAvatars: {\n\t\t\ttype: Boolean,\n\t\t},\n\t\tmultiple: {\n\t\t\ttype: Boolean,\n\t\t},\n\t\tcontext: {\n\t\t\ttype: String,\n\t\t\tdefault: '',\n\t\t},\n\t\tevents: {\n\t\t\ttype: Object,\n\t\t\tdefault: {},\n\t\t},\n\t\treadOnly: {\n\t\t\ttype: Boolean,\n\t\t},\n\t},\n\n\tmethods: {\n\t\tgetDialog(): Dialog\n\t\t{\n\t\t\tif (!this.dialog)\n\t\t\t{\n\t\t\t\tconst targetNode = this.$refs.dialog;\n\t\t\t\tconst parentPopupContainer = targetNode.closest('body');\n\n\t\t\t\tthis.dialog = new Dialog({\n\t\t\t\t\ttargetNode,\n\t\t\t\t\tcontext: this.context,\n\t\t\t\t\tmultiple: this.multiple,\n\t\t\t\t\tdropdownMode: true,\n\t\t\t\t\tshowAvatars: this.showAvatars,\n\t\t\t\t\tenableSearch: true,\n\t\t\t\t\twidth: 450,\n\t\t\t\t\tzIndex: 2500,\n\t\t\t\t\titems: this.items,\n\t\t\t\t\tentities: this.entities,\n\t\t\t\t\ttabs: this.tabs,\n\t\t\t\t\tsearchOptions: {\n\t\t\t\t\t\tallowCreateItem: false,\n\t\t\t\t\t},\n\t\t\t\t\tevents: {\n\t\t\t\t\t\t'Item:onSelect': (event: BaseEvent) => {\n\t\t\t\t\t\t\tconst { item: selectedItem } = event.getData();\n\t\t\t\t\t\t\tthis.emitSelectItem(selectedItem);\n\t\t\t\t\t\t},\n\t\t\t\t\t\t'Item:onDeselect': (event: BaseEvent) => {\n\t\t\t\t\t\t\tconst { item: deselectedItem } = event.getData();\n\n\t\t\t\t\t\t\tthis.emitDeselectItem(deselectedItem);\n\t\t\t\t\t\t},\n\t\t\t\t\t\tonShow: (event: BaseEvent) => {\n\t\t\t\t\t\t\tEvent.bindOnce(\n\t\t\t\t\t\t\t\tparentPopupContainer,\n\t\t\t\t\t\t\t\t'click',\n\t\t\t\t\t\t\t\tthis.onPopupContainerClick.bind(this),\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t});\n\t\t\t}\n\n\t\t\treturn this.dialog;\n\t\t},\n\t\temitSelectItem(selectedItem: Array): void\n\t\t{\n\t\t\tthis.$emit('onSelectItem', selectedItem);\n\t\t},\n\t\temitDeselectItem(deselectedItem: Array): void\n\t\t{\n\t\t\tthis.$emit('onDeselectItem', deselectedItem);\n\t\t},\n\t\tselectItem(itemId: ItemId): void\n\t\t{\n\t\t\tconst item = this.dialog.getItem(itemId);\n\t\t\titem?.select();\n\t\t},\n\t\tonPopupContainerClick(): void\n\t\t{\n\t\t\tthis.getDialog().hide();\n\t\t},\n\t\tshow(): void\n\t\t{\n\t\t\tthis.getDialog().show();\n\t\t},\n\t\ttoggleDialog(): void\n\t\t{\n\t\t\tif (this.readOnly)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst dialog = this.getDialog();\n\n\t\t\tif (dialog.isOpen())\n\t\t\t{\n\t\t\t\tdialog.hide();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tdialog.show();\n\t\t\t}\n\t\t},\n\t\tdestroy(): void\n\t\t{\n\t\t\tthis.dialog?.destroy();\n\t\t\tthis.dialog = null;\n\t\t},\n\t},\n\n\tcomputed: {\n\t\telementTitle(): string\n\t\t{\n\t\t\treturn this.items.find((item) => item.selected)?.title ?? '';\n\t\t},\n\t\tcustomData(): ?Object\n\t\t{\n\t\t\treturn this.items.find((item) => item.selected)?.customData ?? '';\n\t\t},\n\t\tcontrolClassList(): Array\n\t\t{\n\t\t\treturn [\n\t\t\t\t'ui-ctl',\n\t\t\t\t'ui-ctl-after-icon',\n\t\t\t\t{ 'ui-ctl-dropdown': !this.readOnly },\n\t\t\t];\n\t\t},\n\t\ticonClassList(): Array\n\t\t{\n\t\t\treturn [\n\t\t\t\t'crm-repeat-sale__segment-dialog-field-icon',\n\t\t\t\t{ '--color': Boolean(this.customData?.color) },\n\t\t\t];\n\t\t},\n\t\ticonStyleList(): Object\n\t\t{\n\t\t\tif (this.customData?.color === null)\n\t\t\t{\n\t\t\t\treturn {};\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\tbackgroundColor: this.customData.color,\n\t\t\t};\n\t\t},\n\t},\n\n\t// language=Vue\n\ttemplate: `\n\t\t<div\n\t\t\t:class=\"controlClassList\"\n\t\t\tref=\"dialog\"\n\t\t\t@click=\"toggleDialog\"\n\t\t>\n    \t\t<div \n\t\t\t\tv-if=\"!readOnly\"\n\t\t\t\tclass=\"ui-ctl-after ui-ctl-icon-angle\"\n\t\t\t></div>\n\t\t\t<div class=\"ui-ctl-element\">\n\t\t\t\t<span class=\"crm-repeat-sale__segment-dialog-field\">\n\t\t\t\t\t<span \n\t\t\t\t\t\t:class=\"iconClassList\"\n\t\t\t\t\t\t:style=\"iconStyleList\"\n\t\t\t\t\t></span>\n\t\t\t\t\t<span class=\"crm-repeat-sale__segment-dialog-field-value\">\n\t\t\t\t\t\t{{elementTitle}}\n\t\t\t\t\t</span>\n\t\t\t\t</span>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import { Dom } from 'main.core';\nimport { BaseEvent } from 'main.core.events';\nimport { TagSelector } from 'ui.entity-selector';\n\ntype ItemId = [\n\tstring,\n\tstring | number,\n];\n\nexport const TagSelectorWrapperComponent = {\n\temits: [\n\t\t'change',\n\t\t'onSelectItem',\n\t\t'onDeselectItem',\n\t],\n\n\tprops: {\n\t\titems: {\n\t\t\ttype: Array,\n\t\t\tdefault: [],\n\t\t},\n\t\tpreselectedItems: {\n\t\t\ttype: Array,\n\t\t\tdefault: [],\n\t\t},\n\t\ttabs: {\n\t\t\ttype: Array,\n\t\t\tdefault: [],\n\t\t},\n\t\tentities: {\n\t\t\ttype: Array,\n\t\t\tdefault: [],\n\t\t},\n\t\tshowAvatars: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t\tmultiple: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t\tcontext: {\n\t\t\ttype: String,\n\t\t\tdefault: '',\n\t\t},\n\t\tevents: {\n\t\t\ttype: Object,\n\t\t\tdefault: {},\n\t\t},\n\t\treadOnly: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t},\n\n\tmounted() {\n\t\tthis.initDialog();\n\t},\n\n\twatch: {\n\t\titems(items: Array): void\n\t\t{\n\t\t\tthis.tagSelector.getDialog().destroy();\n\t\t\tDom.clean(this.$refs.dialog);\n\n\t\t\tthis.initDialog();\n\t\t},\n\t},\n\n\tmethods: {\n\t\tinitDialog(): void\n\t\t{\n\t\t\tconst targetNode = this.$refs.dialog;\n\t\t\tconst parentPopupContainer = targetNode.closest('body');\n\n\t\t\tthis.tagSelector = new TagSelector({\n\t\t\t\tmultiple: this.multiple,\n\t\t\t\treadonly: this.readOnly,\n\t\t\t\thideOnSelect: false,\n\t\t\t\tdialogOptions: {\n\t\t\t\t\ttargetNode,\n\t\t\t\t\tcontext: this.context,\n\t\t\t\t\tmultiple: this.multiple,\n\t\t\t\t\thideOnSelect: false,\n\t\t\t\t\tdropdownMode: true,\n\t\t\t\t\tshowAvatars: this.showAvatars,\n\t\t\t\t\tenableSearch: true,\n\t\t\t\t\twidth: 450,\n\t\t\t\t\tzIndex: 2500,\n\t\t\t\t\titems: this.items,\n\t\t\t\t\tpreselectedItems: this.preselectedItems,\n\t\t\t\t\tentities: this.entities,\n\t\t\t\t\ttabs: this.tabs,\n\t\t\t\t\tsearchOptions: {\n\t\t\t\t\t\tallowCreateItem: false,\n\t\t\t\t\t},\n\t\t\t\t\tevents: {\n\t\t\t\t\t\t'Item:onSelect': (event: BaseEvent) => {\n\t\t\t\t\t\t\tconst { item: selectedItem } = event.getData();\n\t\t\t\t\t\t\tthis.emitSelectItem(selectedItem);\n\t\t\t\t\t\t},\n\t\t\t\t\t\t'Item:onDeselect': (event: BaseEvent) => {\n\t\t\t\t\t\t\tconst { item: deselectedItem } = event.getData();\n\n\t\t\t\t\t\t\tthis.emitDeselectItem(deselectedItem);\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t});\n\n\t\t\tthis.tagSelector.renderTo(this.$refs.dialog);\n\t\t},\n\t\temitSelectItem(selectedItem: Array): void\n\t\t{\n\t\t\tthis.$emit('onSelectItem', selectedItem);\n\t\t},\n\t\temitDeselectItem(deselectedItem: Array): void\n\t\t{\n\t\t\tthis.$emit('onDeselectItem', deselectedItem);\n\t\t},\n\t\tselectItem(itemId: ItemId): void\n\t\t{\n\t\t\tconst item = this.tagSelector.getDialog().getItem(itemId);\n\t\t\titem?.select();\n\t\t},\n\t},\n\n\t// language=Vue\n\ttemplate: `\n\t\t<div ref=\"dialog\"></div>\n\t`,\n};\n","import { DialogWrapperComponent } from '../common/dialog-wrapper-component';\nimport { TagSelectorWrapperComponent } from '../common/tag-selector-wrapper-component';\n\nexport const CategorySelector = {\n\tcomponents: {\n\t\tTagSelectorWrapperComponent,\n\t\tDialogWrapperComponent,\n\t},\n\n\tprops: {\n\t\tcategories: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t\tcurrentCategoryId: {\n\t\t\ttype: Number,\n\t\t\trequired: true,\n\t\t},\n\t\treadOnly: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t},\n\n\tdata(): Object\n\t{\n\t\tconst items = [];\n\t\tthis.categories.forEach((category, index) => {\n\t\t\titems.push({\n\t\t\t\tid: category.id,\n\t\t\t\ttitle: category.name,\n\t\t\t\tentityId: 'category',\n\t\t\t\ttabs: 'categories',\n\t\t\t\tselected: category.id === this.currentCategoryId,\n\t\t\t});\n\t\t});\n\n\t\treturn {\n\t\t\titems,\n\t\t};\n\t},\n\n\tcreated()\n\t{\n\t\tthis.tabs = [\n\t\t\t{ id: 'categories', title: '' },\n\t\t];\n\t},\n\n\twatch: {\n\t\tcurrentCategoryId(categoryId: string): void\n\t\t{\n\t\t\tthis.items.forEach((item) => {\n\t\t\t\t// eslint-disable-next-line no-param-reassign\n\t\t\t\titem.selected = (item.id === categoryId);\n\t\t\t});\n\t\t},\n\t},\n\n\t// language=Vue\n\ttemplate: `\n\t\t<DialogWrapperComponent\n\t\t\t:items=\"items\"\n\t\t\t:tabs=\"tabs\"\n\t\t\t:read-only=\"readOnly\"\n\t\t/>\n\t`,\n};\n","import { DialogWrapperComponent } from '../common/dialog-wrapper-component';\n\nexport const StageSelector = {\n\tcomponents: {\n\t\tDialogWrapperComponent,\n\t},\n\n\tprops: {\n\t\tcategory: {\n\t\t\ttype: Object,\n\t\t},\n\t\tcurrentStageId: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t\treadOnly: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t},\n\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\titems: this.getPreparedItems(),\n\t\t};\n\t},\n\n\tcreated()\n\t{\n\t\tthis.tabs = [\n\t\t\t{ id: 'stages', title: '' },\n\t\t];\n\t},\n\n\tmethods: {\n\t\tdestroy(): void\n\t\t{\n\t\t\tthis.$refs.dialog.destroy();\n\t\t},\n\t\tgetPreparedItems(setSelectedFirst: boolean = false): Array<Object>\n\t\t{\n\t\t\tconst items = [];\n\n\t\t\tif (this.category === null)\n\t\t\t{\n\t\t\t\treturn items;\n\t\t\t}\n\n\t\t\tlet hasSelected = true;\n\n\t\t\tObject.values(this.category.items).forEach((item) => {\n\t\t\t\titems.push({\n\t\t\t\t\tid: item.id,\n\t\t\t\t\ttitle: item.name,\n\t\t\t\t\tentityId: 'stage',\n\t\t\t\t\ttabs: 'stages',\n\t\t\t\t\tselected: (setSelectedFirst ? hasSelected : item.id === this.currentStageId),\n\t\t\t\t\tavatarOptions: {\n\t\t\t\t\t\tbgColor: item.color,\n\t\t\t\t\t\tborderRadius: 6,\n\t\t\t\t\t\tbgSize: 20,\n\t\t\t\t\t\tbgImage: 'none',\n\t\t\t\t\t},\n\t\t\t\t\tcustomData: {\n\t\t\t\t\t\tcolor: item.color,\n\t\t\t\t\t},\n\t\t\t\t});\n\n\t\t\t\thasSelected = false;\n\t\t\t});\n\n\t\t\tif (!items.some((item) => item.selected === true))\n\t\t\t{\n\t\t\t\titems.find(Boolean).selected = true;\n\t\t\t}\n\n\t\t\treturn items;\n\t\t},\n\t},\n\n\twatch: {\n\t\tcategory(category: Object): void\n\t\t{\n\t\t\tthis.items = this.getPreparedItems(true);\n\t\t},\n\t\tcurrentStageId(categoryId: string): void\n\t\t{\n\t\t\tthis.items.forEach((item) => {\n\t\t\t\t// eslint-disable-next-line no-param-reassign\n\t\t\t\titem.selected = (item.id === categoryId);\n\t\t\t});\n\t\t},\n\t},\n\n\t// language=Vue\n\ttemplate: `\n\t\t<DialogWrapperComponent\n\t\t\tref=\"dialog\"\n\t\t\t:items=\"items\"\n\t\t\t:tabs=\"tabs\"\n\t\t\t:showAvatars=\"true\"\n\t\t\t:read-only=\"readOnly\"\n\t\t/>\n\t`,\n};\n","import { TagSelectorWrapperComponent } from '../common/tag-selector-wrapper-component';\n\nexport const UserSelector = {\n\tcomponents: {\n\t\tTagSelectorWrapperComponent,\n\t},\n\n\tprops: {\n\t\tuserIds: {\n\t\t\ttype: Array,\n\t\t\trequired: true,\n\t\t},\n\t\treadOnly: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t},\n\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tpreselectedItems: this.userIds.map((userId) => {\n\t\t\t\treturn ['user', userId];\n\t\t\t}),\n\t\t};\n\t},\n\n\tcreated()\n\t{\n\t\tthis.entities = [\n\t\t\t{\n\t\t\t\tid: 'user',\n\t\t\t\toptions: {\n\t\t\t\t\tinviteEmployeeLink: false,\n\t\t\t\t\temailUsers: false,\n\t\t\t\t\tinviteGuestLink: false,\n\t\t\t\t\tintranetUsersOnly: true,\n\t\t\t\t},\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: 'structure-node',\n\t\t\t\toptions: {\n\t\t\t\t\tselectMode: 'usersOnly',\n\t\t\t\t},\n\t\t\t},\n\t\t];\n\t},\n\n\t// language=Vue\n\ttemplate: `\n\t\t<TagSelectorWrapperComponent \n\t\t\t:entities=\"entities\"\n\t\t\t:preselected-items=\"preselectedItems\"\n\t\t\t:show-avatars=\"true\"\n\t\t\t:multiple=\"true\"\n\t\t\t:read-only=\"readOnly\"\n\t\t/>\n\t`,\n};\n","import { Builder } from 'crm.integration.analytics';\n\nimport { ajax as Ajax, Text, Type } from 'main.core';\nimport { sendData } from 'ui.analytics';\nimport { BBCodeParser } from 'ui.bbcode.parser';\nimport { InfoHelper } from 'ui.info-helper';\nimport { UI } from 'ui.notification';\nimport { TextEditor } from 'ui.text-editor';\n\nimport { AdditionalInfoComponent } from './common/additional-info-component';\nimport { AiSwitcherComponent } from './common/ai-switcher-component';\nimport { TextEditorWrapperComponent } from './common/text-editor-wrapper-component';\nimport { Button, ButtonEvents } from './navigation/button';\nimport { CallAssessmentSelector } from './selector/call-assessment-selector';\nimport { CategorySelector } from './selector/category-selector';\nimport { StageSelector } from './selector/stage-selector';\nimport { UserSelector } from './selector/user-selector';\n\nexport const Segment = {\n\tcomponents: {\n\t\tButton,\n\t\tAdditionalInfoComponent,\n\t\tAiSwitcherComponent,\n\t\tTextEditorWrapperComponent,\n\t\tCallAssessmentSelector,\n\t\tCategorySelector,\n\t\tStageSelector,\n\t\tUserSelector,\n\t},\n\n\tprops: {\n\t\tsettings: {\n\t\t\ttype: Object,\n\t\t\tdefault: {},\n\t\t},\n\t\tsegment: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t\tcategories: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t\tcallAssessments: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t\tevents: {\n\t\t\ttype: Object,\n\t\t\tdefault: {},\n\t\t},\n\t\tanalytics: {\n\t\t\ttype: Object,\n\t\t\tdefault: {},\n\t\t},\n\t\ttextEditor: TextEditor,\n\t},\n\n\tdata(): Object\n\t{\n\t\tconst { segment, textEditor, categories, settings } = this;\n\t\tconst id = segment?.id ?? null;\n\t\tconst isEnabled = segment?.isEnabled ?? null;\n\n\t\tconst firstCategory = categories[0];\n\n\t\tlet isAiEnabled = false;\n\t\tif (\n\t\t\tsettings.ai?.isAvailable\n\t\t\t&& (settings.ai?.isSponsored || settings.baas?.hasPackage)\n\t\t)\n\t\t{\n\t\t\tisAiEnabled = segment.isAiEnabled ?? true;\n\t\t}\n\n\t\treturn {\n\t\t\tid,\n\t\t\tisEnabled,\n\t\t\ttext: textEditor.getText(),\n\t\t\tparser: new BBCodeParser(),\n\n\t\t\tcurrentCategoryId: segment.entityCategoryId ?? firstCategory.id,\n\t\t\tcurrentStageId: segment.entityStageId ?? this.getFirstAvailableCategoryStageId(firstCategory),\n\t\t\tassignmentUserIds: new Set(segment.assignmentUserIds ?? []),\n\t\t\tcurrentEntityTitlePattern: segment.entityTitlePattern ?? null,\n\t\t\tcurrentCallAssessmentId: segment.callAssessmentId ?? null,\n\t\t\tcurrentIsAiEnabled: isAiEnabled,\n\t\t};\n\t},\n\n\tmounted(): void\n\t{\n\t\tthis.$Bitrix.eventEmitter.subscribe(ButtonEvents.click, this.onNavigationButtonClick);\n\n\t\tthis.sendViewAnalytics();\n\t},\n\n\tbeforeUnmount(): void\n\t{\n\t\tthis.$Bitrix.eventEmitter.unsubscribe(ButtonEvents.click, this.onNavigationButtonClick);\n\t},\n\n\tmethods: {\n\t\tonSaveCallback(): void\n\t\t{\n\t\t\tif (Type.isFunction(this.events?.onSave))\n\t\t\t{\n\t\t\t\tthis.events.onSave();\n\t\t\t}\n\t\t},\n\t\tonNavigationButtonClick({ data }): void\n\t\t{\n\t\t\tconst { id } = data;\n\t\t\tif (id === 'cancel' || id === 'close')\n\t\t\t{\n\t\t\t\tthis.sendCancelAnalytics();\n\t\t\t\tthis.closeSlider();\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.sendData();\n\t\t},\n\t\tsendData(): void\n\t\t{\n\t\t\tconst data = {\n\t\t\t\tentityTypeId: 2, // temporary only deal\n\t\t\t\tentityCategoryId: this.currentCategoryId,\n\t\t\t\tentityStageId: this.currentStageId,\n\t\t\t\tassignmentUserIds: [...this.assignmentUserIds.values()],\n\t\t\t\tentityTitlePattern: this.currentEntityTitlePattern,\n\t\t\t\tcallAssessmentId: this.currentCallAssessmentId,\n\t\t\t\tisAiEnabled: this.currentIsAiEnabled,\n\t\t\t};\n\n\t\t\tif (!this.currentIsAiEnabled)\n\t\t\t{\n\t\t\t\tdata.prompt = this.textEditor.getText();\n\t\t\t}\n\n\t\t\tif (!this.validate(data))\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst dataParams = {\n\t\t\t\tid: this.id,\n\t\t\t\tdata,\n\t\t\t};\n\n\t\t\ttop.BX.Event.EventEmitter.emit('crm:repeatSale:segment:beforeSave', dataParams);\n\n\t\t\tAjax\n\t\t\t\t.runAction('crm.repeatsale.segment.save', { json: dataParams })\n\t\t\t\t.then(\n\t\t\t\t\t(response) => {\n\t\t\t\t\t\ttop.BX.Event.EventEmitter.emit('crm:repeatSale.segment:save', {\n\t\t\t\t\t\t\t...dataParams,\n\t\t\t\t\t\t\tstatus: response?.status,\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\tif (response?.status !== 'success')\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tUI.Notification.Center.notify({\n\t\t\t\t\t\t\t\tcontent: Text.encode(response.errors[0].message),\n\t\t\t\t\t\t\t\tautoHideDelay: 6000,\n\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tthis.onSaveCallback();\n\n\t\t\t\t\t\tthis.sendEditAnalytics();\n\n\t\t\t\t\t\tthis.closeSlider();\n\t\t\t\t\t},\n\t\t\t\t\t(response) => {\n\t\t\t\t\t\tconst messageCode = 'CRM_REPEAT_SALE_SEGMENT_SAVE_ERROR';\n\n\t\t\t\t\t\tUI.Notification.Center.notify({\n\t\t\t\t\t\t\tcontent: this.$Bitrix.Loc.getMessage(messageCode),\n\t\t\t\t\t\t\tautoHideDelay: 6000,\n\t\t\t\t\t\t});\n\t\t\t\t\t},\n\t\t\t\t)\n\t\t\t\t.catch((response) => {\n\t\t\t\t\tUI.Notification.Center.notify({\n\t\t\t\t\t\tcontent: Text.encode(response.errors[0].message),\n\t\t\t\t\t\tautoHideDelay: 6000,\n\t\t\t\t\t});\n\n\t\t\t\t\tthrow response;\n\t\t\t\t})\n\t\t\t;\n\t\t},\n\t\tvalidate(data: Object): boolean\n\t\t{\n\t\t\tif (!Type.isArrayFilled(data.assignmentUserIds))\n\t\t\t{\n\t\t\t\tUI.Notification.Center.notify({\n\t\t\t\t\tcontent: this.$Bitrix.Loc.getMessage('CRM_REPEAT_SALE_SEGMENT_VALIDATE_ASSIGNMENT_USERS_ERROR'),\n\t\t\t\t\tautoHideDelay: 6000,\n\t\t\t\t});\n\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tif (!this.currentIsAiEnabled && !Type.isStringFilled(this.getPlainText()))\n\t\t\t{\n\t\t\t\tUI.Notification.Center.notify({\n\t\t\t\t\tcontent: this.$Bitrix.Loc.getMessage('CRM_REPEAT_SALE_SEGMENT_VALIDATE_TEXT_ERROR'),\n\t\t\t\t\tautoHideDelay: 6000,\n\t\t\t\t});\n\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\treturn true;\n\t\t},\n\t\tcloseSlider(): void\n\t\t{\n\t\t\ttop.BX.SidePanel.Instance.getSliderByWindow(window).close();\n\t\t},\n\t\tgetPlainText(): number\n\t\t{\n\t\t\treturn this.parser.parse(this.textEditor.getText()).toPlainText().trim();\n\t\t},\n\t\tonSelectCategory(category: Object): void\n\t\t{\n\t\t\tif (this.currentCategoryId === category.id)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.$refs.stageSelector.destroy();\n\t\t\tthis.currentCategoryId = category.id;\n\n\t\t\tvoid this.$nextTick(() => {\n\t\t\t\tconst currentCategory = this.getCategoryById(this.currentCategoryId);\n\t\t\t\tthis.currentStageId = this.getFirstAvailableCategoryStageId(currentCategory);\n\t\t\t});\n\t\t},\n\t\tonSelectStage(stage: Object): void\n\t\t{\n\t\t\tthis.currentStageId = stage.id;\n\t\t},\n\t\tgetCategoryById(id: number): Object\n\t\t{\n\t\t\treturn this.categories.find((category) => category.id === id);\n\t\t},\n\t\tgetFirstAvailableCategoryStageId(category: Object): string\n\t\t{\n\t\t\treturn category.items[0].id;\n\t\t},\n\t\tonSelectAssignmentUser(user: Object): void\n\t\t{\n\t\t\tthis.assignmentUserIds.add(user.id);\n\t\t},\n\t\tonDeselectAssignmentUser(user: Object): void\n\t\t{\n\t\t\tthis.assignmentUserIds.delete(user.id);\n\t\t},\n\t\tsetCurrentCallAssessmentId(id: number): void\n\t\t{\n\t\t\tthis.currentCallAssessmentId = id;\n\t\t},\n\t\tgetMessageByCode(code: string): string\n\t\t{\n\t\t\treturn this.$Bitrix.Loc.getMessage(code);\n\t\t},\n\t\tsetCurrentIsAiEnabled(value: boolean): void\n\t\t{\n\t\t\tthis.currentIsAiEnabled = value;\n\t\t},\n\t\tsendViewAnalytics(): void\n\t\t{\n\t\t\tconst section = this.analytics.section ?? '';\n\t\t\tconst viewEvent = Builder.RepeatSale.Segment.ViewEvent.createDefault(section);\n\t\t\tsendData(viewEvent.buildData());\n\t\t},\n\t\tsendCancelAnalytics(): void\n\t\t{\n\t\t\tconst section = this.analytics.section ?? '';\n\t\t\tconst viewEvent = Builder.RepeatSale.Segment.CancelEvent.createDefault(section);\n\t\t\tsendData(viewEvent.buildData());\n\t\t},\n\t\tsendEditAnalytics(): void\n\t\t{\n\t\t\tconst section = this.analytics.section ?? '';\n\t\t\tconst editEvent = Builder.RepeatSale.Segment.EditEvent.createDefault(section);\n\n\t\t\tif (\n\t\t\t\t!this.currentIsAiEnabled\n\t\t\t\t&& this.getPlainPromptText() !== this.getPlainSegmentText()\n\t\t\t)\n\t\t\t{\n\t\t\t\teditEvent.setIsActivityTextChanged(true);\n\t\t\t}\n\n\t\t\tif (this.segment.entityTitlePattern !== this.currentEntityTitlePattern)\n\t\t\t{\n\t\t\t\teditEvent.setIsEntityTitlePatternChanged(true);\n\t\t\t}\n\n\t\t\tif (this.segment.isAiEnabled !== this.currentIsAiEnabled)\n\t\t\t{\n\t\t\t\teditEvent.setIsCopilotEnabled(this.currentIsAiEnabled);\n\t\t\t}\n\n\t\t\teditEvent.setSegmentCode(this.segment.code);\n\n\t\t\tsendData(editEvent.buildData());\n\t\t},\n\t\tgetPlainPromptText(): string\n\t\t{\n\t\t\treturn this.parseText(this.textEditor.getText());\n\t\t},\n\t\tgetPlainSegmentText(): string\n\t\t{\n\t\t\treturn this.parseText(this.segment.prompt);\n\t\t},\n\t\tparseText(text: string): string\n\t\t{\n\t\t\treturn this.parser.parse(text).toPlainText().trim();\n\t\t},\n\t},\n\n\tcomputed: {\n\t\treadOnly(): boolean\n\t\t{\n\t\t\treturn this.settings.isReadOnly;\n\t\t},\n\t\tisSponsored(): boolean\n\t\t{\n\t\t\treturn this.settings.ai?.isSponsored ?? false;\n\t\t},\n\t\tisAiAvailable(): boolean\n\t\t{\n\t\t\treturn this.settings.ai?.isAvailable ?? false;\n\t\t},\n\t\taiDisabledSliderCode(): ?string\n\t\t{\n\t\t\treturn this.settings.ai?.aiDisabledSliderCode ?? null;\n\t\t},\n\t\tisBaasAvailable(): boolean\n\t\t{\n\t\t\treturn this.settings.baas?.isAvailable ?? false;\n\t\t},\n\t\tisBaasHasPackage(): boolean\n\t\t{\n\t\t\treturn this.settings.baas?.hasPackage ?? false;\n\t\t},\n\t\tpackageEmptySliderCode(): ?string\n\t\t{\n\t\t\treturn this.settings.baas?.aiPackagesEmptySliderCode ?? null;\n\t\t},\n\t\taiCallEnabled(): boolean\n\t\t{\n\t\t\treturn this.settings.isAiCallEnabled;\n\t\t},\n\t\trepeatSaleSegmentSection(): Array\n\t\t{\n\t\t\treturn [\n\t\t\t\t'crm-repeat-sale__segment-section',\n\t\t\t];\n\t\t},\n\t\ttitle(): string\n\t\t{\n\t\t\treturn this.$Bitrix.Loc.getMessage('CRM_REPEAT_SALE_SEGMENT_TITLE');\n\t\t},\n\t\tcurrentCategory(): ?Object\n\t\t{\n\t\t\treturn this.categories.find((category) => category.id === this.currentCategoryId) ?? null;\n\t\t},\n\t\tmessages(): Object\n\t\t{\n\t\t\treturn {\n\t\t\t\ttextAreaTitle: this.getMessageByCode('CRM_REPEAT_SALE_SEGMENT_MANUAL_TEXTAREA_TITLE'),\n\t\t\t\tdealHelp: this.getMessageByCode('CRM_REPEAT_SALE_SEGMENT_DEAL_HELP'),\n\t\t\t\tsectionTitle: this.getMessageByCode('CRM_REPEAT_SALE_SEGMENT_MANUAL_SECTION_TITLE'),\n\t\t\t\tstageTitle: this.getMessageByCode('CRM_REPEAT_SALE_SEGMENT_MANUAL_STAGE_TITLE'),\n\t\t\t\tdealAssignedTitle: this.getMessageByCode('CRM_REPEAT_SALE_SEGMENT_DEAL_ASSIGNED_TITLE'),\n\t\t\t\tdealTitlePattern: this.getMessageByCode('CRM_REPEAT_SALE_SEGMENT_DEAL_NAME_PATTERN_TITLE'),\n\t\t\t\tassessmentTitle: this.getMessageByCode('CRM_REPEAT_SALE_SEGMENT_CALL_ASSESSMENT_TITLE'),\n\t\t\t\tassessmentDescription: this.getMessageByCode('CRM_REPEAT_SALE_SEGMENT_CALL_ASSESSMENT_DESCRIPTION'),\n\t\t\t};\n\t\t},\n\t},\n\n\twatch: {\n\t\tcurrentIsAiEnabled(value: boolean): void\n\t\t{\n\t\t\tif (\n\t\t\t\tthis.isAiAvailable\n\t\t\t\t&& (\n\t\t\t\t\tthis.isSponsored\n\t\t\t\t\t|| this.isBaasHasPackage\n\t\t\t\t)\n\t\t\t)\n\t\t\t{\n\t\t\t\tthis.currentIsAiEnabled = value;\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (value === true)\n\t\t\t{\n\t\t\t\tif (!this.isAiAvailable && this.aiDisabledSliderCode)\n\t\t\t\t{\n\t\t\t\t\tInfoHelper.show(this.aiDisabledSliderCode);\n\t\t\t\t}\n\t\t\t\telse if (!this.isBaasHasPackage && this.packageEmptySliderCode)\n\t\t\t\t{\n\t\t\t\t\tInfoHelper.show(this.packageEmptySliderCode);\n\t\t\t\t}\n\n\t\t\t\tvoid this.$nextTick(() => {\n\t\t\t\t\tthis.currentIsAiEnabled = false;\n\t\t\t\t});\n\t\t\t}\n\t\t},\n\t},\n\n\t// language=Vue\n\ttemplate: `\n\t\t<div class=\"crm-repeat-sale__segment_container\">\n\t\t\t<div class=\"crm-repeat-sale__segment-wrapper\">\n\t\t\t\t<header class=\"crm-repeat-sale__segment-section-header\">\n\t\t\t\t\t<div class=\"crm-repeat-sale__segment-section-header-title\">\n\t\t\t\t\t\t<span>{{title}}</span>\n\t\t\t\t\t</div>\n\t\t\t\t</header>\n\t\t\t\t<div class=\"crm-repeat-sale__segment-section-body\">\n\t\t\t\t\t<section class=\"crm-repeat-sale__segment-section --main --active\">\n\t\t\t\t\t\t<h1 class=\"crm-repeat-sale__segment-section-title\">\n\t\t\t\t\t\t\t{{segment.title}}\n\t\t\t\t\t\t</h1>\n\t\t\t\t\t\t<div class=\"crm-repeat-sale__segment-section-description\">\n\t\t\t\t\t\t\t{{segment.description}}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<AdditionalInfoComponent\n\t\t\t\t\t\t\t:title=\"messages.dealHelp\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</section>\n\t\t\t\t\t\n\t\t\t\t\t\n\t\t\t\t\t<section class=\"crm-repeat-sale__segment-section --active\">\n\t\t\t\t\t\t<div\n\t\t\t\t\t\t\tclass=\"crm-repeat-sale__segment-fields-row\"\n\t\t\t\t\t\t\tv-if=\"isBaasAvailable || isSponsored\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<div class=\"crm-repeat-sale__segment-field\">\n\t\t\t\t\t\t\t\t<AiSwitcherComponent\n\t\t\t\t\t\t\t\t\tref=\"aiSwitcher\"\n\t\t\t\t\t\t\t\t\t:checked=\"currentIsAiEnabled\"\n\t\t\t\t\t\t\t\t\t:read-only=\"readOnly\"\n\t\t\t\t\t\t\t\t\t@change=\"setCurrentIsAiEnabled\"\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\n\t\t\t\t\t\t<div\n\t\t\t\t\t\t\tv-if=\"!currentIsAiEnabled\"\n\t\t\t\t\t\t\tclass=\"crm-repeat-sale__segment-fields-row\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<div class=\"crm-repeat-sale__segment-field\">\n\t\t\t\t\t\t\t\t<div class=\"crm-repeat-sale__segment-field-title\">\n\t\t\t\t\t\t\t\t\t{{messages.textAreaTitle}}\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<TextEditorWrapperComponent\n\t\t\t\t\t\t\t\t\t:textEditor=\"textEditor\"\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\n\t\t\t\t\t\t<div class=\"crm-repeat-sale__segment-fields-row\">\n\t\t\t\t\t\t\t<div class=\"crm-repeat-sale__segment-field\">\n\t\t\t\t\t\t\t\t<div class=\"crm-repeat-sale__segment-field-title\">\n\t\t\t\t\t\t\t\t\t{{messages.sectionTitle}}\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<CategorySelector \n\t\t\t\t\t\t\t\t\t:current-category-id=\"currentCategoryId\"\n\t\t\t\t\t\t\t\t\t:categories=\"categories\"\n\t\t\t\t\t\t\t\t\t:read-only=\"readOnly\"\n\t\t\t\t\t\t\t\t\t@onSelectItem=\"onSelectCategory\"\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class=\"crm-repeat-sale__segment-field\">\n\t\t\t\t\t\t\t\t<div class=\"crm-repeat-sale__segment-field-title\">\n\t\t\t\t\t\t\t\t\t{{messages.stageTitle}}\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<StageSelector \n\t\t\t\t\t\t\t\t\tref=\"stageSelector\"\n\t\t\t\t\t\t\t\t\t:current-stage-id=\"currentStageId\"\n\t\t\t\t\t\t\t\t\t:category=\"currentCategory\"\n\t\t\t\t\t\t\t\t\t:read-only=\"readOnly\"\n\t\t\t\t\t\t\t\t\t@onSelectItem=\"onSelectStage\"\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t<div class=\"crm-repeat-sale__segment-fields-row\">\n\t\t\t\t\t\t\t<div class=\"crm-repeat-sale__segment-field\">\n\t\t\t\t\t\t\t\t<div class=\"crm-repeat-sale__segment-field-title\">\n\t\t\t\t\t\t\t\t\t{{messages.dealAssignedTitle}}\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<UserSelector\n\t\t\t\t\t\t\t\t\t:user-ids=\"[...assignmentUserIds.values()]\"\n\t\t\t\t\t\t\t\t\t:read-only=\"readOnly\"\n\t\t\t\t\t\t\t\t\t@onSelectItem=\"onSelectAssignmentUser\"\n\t\t\t\t\t\t\t\t\t@onDeselectItem=\"onDeselectAssignmentUser\"\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\n\t\t\t\t\t\t<div class=\"crm-repeat-sale__segment-fields-row\">\n\t\t\t\t\t\t\t<div class=\"crm-repeat-sale__segment-field\">\n\t\t\t\t\t\t\t\t<div class=\"crm-repeat-sale__segment-field-title\">\n\t\t\t\t\t\t\t\t\t{{messages.dealTitlePattern}}\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\t\tclass=\"ui-ctl-element\"\n\t\t\t\t\t\t\t\t\ttype=\"text\"\n\t\t\t\t\t\t\t\t\tv-model=\"currentEntityTitlePattern\"\n\t\t\t\t\t\t\t\t\t:readonly=\"readOnly\"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</section>\n\n\t\t\t\t\t<section \n\t\t\t\t\t\t:class=\"repeatSaleSegmentSection\"\n\t\t\t\t\t\tv-if=\"aiCallEnabled && false\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<h1 class=\"crm-repeat-sale__segment-section-title --level2\">\n\t\t\t\t\t\t\t{{messages.assessmentTitle}}\n\t\t\t\t\t\t</h1>\n\t\t\t\t\t\t<div class=\"crm-repeat-sale__segment-section-description\">\n\t\t\t\t\t\t\t{{messages.assessmentDescription}}\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t<div class=\"crm-repeat-sale__segment-field\">\n\t\t\t\t\t\t\t<CallAssessmentSelector \n\t\t\t\t\t\t\t\t:call-assessments=\"callAssessments\"\n\t\t\t\t\t\t\t\t:current-call-assessment-id=\"currentCallAssessmentId\"\n\t\t\t\t\t\t\t\t:read-only=\"readOnly\"\n\t\t\t\t\t\t\t\t@onSelectItem=\"setCurrentCallAssessmentId\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t{{currentCallAssessmentId}}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</section>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div class=\"crm-repeat-sale__segment_navigation-container\">\n\t\t\t\t<div class=\"crm-repeat-sale__segment_navigation-buttons-wrapper\">\n\t\t\t\t\t<Button v-if=\"!readOnly\" id=\"update\" />\n\t\t\t\t\t<Button v-if=\"!readOnly\" id=\"cancel\" />\n\t\t\t\t\t<Button v-if=\"readOnly\" id=\"close\" />\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import { Loc, Type } from 'main.core';\nimport { BasicEditor } from 'ui.text-editor';\nimport { BitrixVue, VueCreateAppResult } from 'ui.vue3';\nimport { Segment as SegmentComponent } from './components/segment';\nimport 'ui.design-tokens';\nimport 'ui.design-tokens.air';\nimport './segment.css';\n\ntype RepeatSaleSegmentParams = {\n\tdata: Object,\n\tconfig?: Object,\n\tevents?: Object,\n\tanalytics?: Object,\n}\n\nexport class Segment\n{\n\t#container: HTMLElement;\n\t#app: ?VueCreateAppResult = null;\n\n\t#textEditor: BasicEditor = null;\n\t#isReadOnly: boolean = true;\n\n\tconstructor(containerId: string, params: RepeatSaleSegmentParams = {})\n\t{\n\t\tthis.#container = document.getElementById(containerId);\n\n\t\tif (!Type.isDomNode(this.#container))\n\t\t{\n\t\t\tthrow new Error('container not found');\n\t\t}\n\n\t\tthis.#isReadOnly = params.config?.readOnly ?? true;\n\n\t\tthis.#app = BitrixVue.createApp(SegmentComponent, {\n\t\t\ttextEditor: this.#getTextEditor(params.data.segment, params.config ?? {}),\n\t\t\ttitle: params.config?.title ?? '',\n\t\t\tsettings: {\n\t\t\t\tisReadOnly: this.#isReadOnly,\n\t\t\t\tisCopy: params.config?.isCopy ?? false,\n\t\t\t\tai: params.data.aiSettings,\n\t\t\t\tbaas: params.data.baasSettings,\n\t\t\t\tisAiCallEnabled: params.data.isAiCallEnabled,\n\t\t\t},\n\t\t\tsegment: params.data.segment,\n\t\t\tcategories: params.data.categories,\n\t\t\tcallAssessments: params.data.callAssessments,\n\t\t\tevents: params.events,\n\t\t\tanalytics: params.analytics,\n\t\t});\n\n\t\tthis.#app.mount(this.#container);\n\t}\n\n\t#getTextEditor({ prompt: content }, { copilotSettings }): BasicEditor\n\t{\n\t\tif (this.#textEditor !== null)\n\t\t{\n\t\t\treturn this.#textEditor;\n\t\t}\n\n\t\tconst floatingToolbar = (\n\t\t\tthis.#isReadOnly\n\t\t\t\t? []\n\t\t\t\t: [\n\t\t\t\t\t'bold', 'italic', 'underline', 'strikethrough',\n\t\t\t\t\t'|',\n\t\t\t\t\t'numbered-list', 'bulleted-list',\n\t\t\t\t\t'copilot',\n\t\t\t\t]\n\t\t);\n\n\t\tthis.#textEditor = new BasicEditor({\n\t\t\teditable: !this.#isReadOnly,\n\t\t\tremovePlugins: ['BlockToolbar'],\n\t\t\tminHeight: 250,\n\t\t\tmaxHeight: 400,\n\t\t\tcontent,\n\t\t\tplaceholder: Loc.getMessage('CRM_REPEAT_SALE_SEGMENT_PLACEHOLDER'),\n\t\t\tparagraphPlaceholder: Loc.getMessage(\n\t\t\t\tType.isPlainObject(copilotSettings)\n\t\t\t\t\t? 'CRM_REPEAT_SALE_SEGMENT_PLACEHOLDER_WITH_COPILOT'\n\t\t\t\t\t: null,\n\t\t\t),\n\t\t\ttoolbar: [],\n\t\t\tfloatingToolbar,\n\t\t\tcollapsingMode: false,\n\t\t\tcopilot: {\n\t\t\t\tcopilotOptions: Type.isPlainObject(copilotSettings) ? copilotSettings : null,\n\t\t\t\ttriggerBySpace: true,\n\t\t\t},\n\t\t});\n\n\t\treturn this.#textEditor;\n\t}\n}\n"],"names":["AdditionalInfoComponent","props","title","type","String","required","mounted","popup","region","Extension","getSettings","get","Event","EventEmitter","subscribe","event","hide","methods","onClick","PromoVideoPopup","angleOptions","targetOptions","useOverlay","videoSrc","videoContainerMinHeight","Loc","getMessage","colors","show","computed","name","includes","template","AiSwitcherComponent","emits","components","checked","Boolean","readOnly","default","renderSwitcher","switcher","Switcher","disabled","size","SwitcherSize","small","showStateTitle","handlers","emitChange","unchecked","renderTo","$refs","value","$emit","badgeClassList","badgeTitle","$Bitrix","watch","newValue","check","TextEditorWrapperComponent","TextEditorComponent","textEditor","TextEditor","data","textEditorEvents","onChange","emitChangeData","setTextEditorHeight","windowResizeHandler","bind","window","unmounted","unbind","Type","isFunction","onChangeDebounce","Runtime","debounce","prompt","getText","editorOffsetTop","$el","parentNode","offsetTop","navigationClassName","navigationOffsetTop","document","querySelector","textEditorContainerBottomPadding","availableHeight","minHeight","Math","round","maxHeight","setMinHeight","setMaxHeight","ButtonEvents","click","Button","id","initButton","button","UiButton","useAirDesign","text","toUpperCase","style","buttonStyle","onclick","emitClickEvent","setDataSet","toLowerCase","eventEmitter","emit","AirButtonStyle","FILLED","OUTLINE","CallAssessmentSelector","callAssessments","Object","currentCallAssessmentId","Number","created","dialog","tabs","items","forEach","callAssessment","index","push","entityId","selected","toggleDialog","getDialog","isOpen","targetNode","parentPopupContainer","closest","Dialog","context","multiple","dropdownMode","showAvatars","enableSearch","width","zIndex","searchOptions","allowCreateItem","events","item","getData","emitSelectItem","onShow","bindOnce","onPopupContainerClick","itemId","DialogWrapperComponent","Array","entities","selectedItem","deselectedItem","emitDeselectItem","selectItem","getItem","select","destroy","elementTitle","find","customData","controlClassList","iconClassList","color","iconStyleList","backgroundColor","TagSelectorWrapperComponent","preselectedItems","initDialog","tagSelector","Dom","clean","TagSelector","readonly","hideOnSelect","dialogOptions","CategorySelector","categories","currentCategoryId","category","categoryId","StageSelector","currentStageId","getPreparedItems","setSelectedFirst","hasSelected","values","avatarOptions","bgColor","borderRadius","bgSize","bgImage","some","UserSelector","userIds","map","userId","options","inviteEmployeeLink","emailUsers","inviteGuestLink","intranetUsersOnly","selectMode","Segment","settings","segment","analytics","isEnabled","firstCategory","isAiEnabled","ai","isAvailable","isSponsored","baas","hasPackage","parser","BBCodeParser","entityCategoryId","entityStageId","getFirstAvailableCategoryStageId","assignmentUserIds","Set","currentEntityTitlePattern","entityTitlePattern","callAssessmentId","currentIsAiEnabled","onNavigationButtonClick","sendViewAnalytics","beforeUnmount","unsubscribe","onSaveCallback","onSave","sendCancelAnalytics","closeSlider","sendData","entityTypeId","validate","dataParams","top","BX","Ajax","runAction","json","then","response","status","UI","Notification","Center","notify","content","Text","encode","errors","message","autoHideDelay","sendEditAnalytics","messageCode","catch","isArrayFilled","isStringFilled","getPlainText","SidePanel","Instance","getSliderByWindow","close","parse","toPlainText","trim","onSelectCategory","stageSelector","$nextTick","currentCategory","getCategoryById","onSelectStage","stage","onSelectAssignmentUser","user","add","onDeselectAssignmentUser","delete","setCurrentCallAssessmentId","getMessageByCode","code","setCurrentIsAiEnabled","section","viewEvent","Builder","RepeatSale","ViewEvent","createDefault","buildData","CancelEvent","editEvent","EditEvent","getPlainPromptText","getPlainSegmentText","setIsActivityTextChanged","setIsEntityTitlePatternChanged","setIsCopilotEnabled","setSegmentCode","parseText","isReadOnly","isAiAvailable","aiDisabledSliderCode","isBaasAvailable","isBaasHasPackage","packageEmptySliderCode","aiPackagesEmptySliderCode","aiCallEnabled","isAiCallEnabled","repeatSaleSegmentSection","messages","textAreaTitle","dealHelp","sectionTitle","stageTitle","dealAssignedTitle","dealTitlePattern","assessmentTitle","assessmentDescription","InfoHelper","constructor","containerId","params","getElementById","isDomNode","Error","config","BitrixVue","createApp","SegmentComponent","isCopy","aiSettings","baasSettings","mount","copilotSettings","floatingToolbar","BasicEditor","editable","removePlugins","placeholder","paragraphPlaceholder","isPlainObject","toolbar","collapsingMode","copilot","copilotOptions","triggerBySpace"],"mappings":"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"}