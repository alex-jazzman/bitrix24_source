this.BX=this.BX||{};this.BX.Crm=this.BX.Crm||{};(function(t,e,a){"use strict";var n,s,i;function r(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,n)}return a}function l(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?r(Object(a),!0).forEach((function(e){babelHelpers.defineProperty(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):r(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}function c(t,e){u(t,e);e.add(t)}function o(t,e,a){u(t,e);e.set(t,a)}function u(t,e){if(e.has(t)){throw new TypeError("Cannot initialize the same private elements twice on an object")}}function d(t,e,a){if(!e.has(t)){throw new TypeError("attempted to get private field on non-instance")}return a}var v="yandex";var p="google";var b=new WeakMap;var f=new WeakMap;var h=new WeakMap;var g=new WeakSet;var m=function(){babelHelpers.createClass(t,null,[{key:"open",value:function n(){var s=arguments.length>0&&arguments[0]!==undefined?arguments[0]:p;var i=null;var r=new Promise((function(t){i=t}));var c=new t(s);BX.SidePanel.Instance.open("crm.webform:captcha",{width:700,cacheable:false,events:{onCloseComplete:function t(){i(l({},c.getValue()))}},contentCallback:function t(){return a.Layout.createContent({extensions:["crm.form.captcha","ui.forms","ui.sidepanel-content"],title:e.Loc.getMessage("CRM_FORM_CAPTCHA_JS_TITLE"),design:{section:false},content:function t(){return c.load()},buttons:function t(a){var n=a.SaveButton,s=a.closeButton;return[new n({onclick:function t(a){if(!c.canChange()){a.setDisabled(true);BX.UI.Notification.Center.notify({content:e.Loc.getMessage("CRM_FORM_CAPTCHA_JS_ACCESS_DENIED")});return}a.setWaiting(true);c.save().then((function(){a.setWaiting(false);BX.SidePanel.Instance.close()}))["catch"]((function(){a.setWaiting(false)}))}}),s]}})}});return r}}]);function t(){var e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:p;babelHelpers.classCallCheck(this,t);c(this,g);o(this,b,{writable:true,value:{key:null,secret:null,canChange:false,hasDefaults:false}});o(this,f,{writable:true,value:void 0});o(this,h,{writable:true,value:void 0});babelHelpers.classPrivateFieldSet(this,f,e)}babelHelpers.createClass(t,[{key:"hasKeys",value:function t(){var e=babelHelpers.classPrivateFieldGet(this,b);return e.hasDefaults||e.key&&e.secret}},{key:"canChange",value:function t(){return babelHelpers.classPrivateFieldGet(this,b).canChange}},{key:"load",value:function t(){var a=this;return e.ajax.runAction("crm.form.getCaptcha",{json:{type:babelHelpers.classPrivateFieldGet(this,f)}}).then((function(t){babelHelpers.classPrivateFieldSet(a,b,t.data);return d(a,g,C).call(a)}))}},{key:"save",value:function t(){var a=this;var n=babelHelpers.classPrivateFieldGet(this,h).querySelector('input[name="key"]');var s=babelHelpers.classPrivateFieldGet(this,h).querySelector('input[name="secret"]');var i=n.value||"";var r=s.value||"";n.parentElement.classList.remove("ui-ctl-danger");s.parentElement.classList.remove("ui-ctl-danger");if(e.Type.isStringFilled(i)!==e.Type.isStringFilled(r)){if(!i){n.parentElement.classList.add("ui-ctl-danger")}if(!r){s.parentElement.classList.add("ui-ctl-danger")}return Promise.reject()}return e.ajax.runAction("crm.form.setCaptcha",{json:{key:i,secret:r,type:babelHelpers.classPrivateFieldGet(this,f)}}).then((function(t){babelHelpers.classPrivateFieldSet(a,b,t.data);return babelHelpers.classPrivateFieldGet(a,b)}))}},{key:"getValue",value:function t(){return babelHelpers.classPrivateFieldGet(this,b)}}]);return t}();function C(){var t=e.Tag.safe(n||(n=babelHelpers.taggedTemplateLiteral(["",""])),babelHelpers.classPrivateFieldGet(this,b).key);var a=e.Tag.safe(s||(s=babelHelpers.taggedTemplateLiteral(["",""])),babelHelpers.classPrivateFieldGet(this,b).secret);babelHelpers.classPrivateFieldSet(this,h,e.Tag.render(i||(i=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<div>\n\t\t\t\t<div class="ui-slider-section" ','>\n\t\t\t\t\t<div class="ui-slider-content-box">\n\t\t\t\t\t\t<div class="ui-slider-heading-4">','</div>\n\t\t\t\t\t\t<div class="ui-alert ui-alert-success">\n\t\t\t\t\t\t\t<span class="ui-alert-message">','</span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class="ui-slider-section">\n\t\t\t\t\t<div class="ui-slider-content-box">\n\t\t\t\t\t\t<div class="ui-slider-heading-4">\n\t\t\t\t\t\t\t','\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<p class="ui-slider-paragraph-2">\n\t\t\t\t\t\t\t','\n\t\t\t\t\t\t\t<br>\n\t\t\t\t\t\t\t<a href="','" target="_blank">','</a>\n\t\t\t\t\t\t</p>\n\t\t\t\t\t</div>\n\t\t\t\t\t\n\t\t\t\t\t<div>\n\t\t\t\t\t\t<div class="ui-form-row">\n\t\t\t\t\t\t\t<div class="ui-form-label">\n\t\t\t\t\t\t\t\t<div class="ui-ctl-label-text">Key</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class="ui-form-content">\n\t\t\t\t\t\t\t\t<div class="ui-ctl ui-ctl-textbox ui-ctl-w100">\n\t\t\t\t\t\t\t\t\t<input \n\t\t\t\t\t\t\t\t\t\ttype="text" \n\t\t\t\t\t\t\t\t\t\tname="key"\n\t\t\t\t\t\t\t\t\t\tvalue="','"\n\t\t\t\t\t\t\t\t\t\tclass="ui-ctl-element"\n\t\t\t\t\t\t\t\t\t\tonfocus="this.parentElement.classList.remove(\'ui-ctl-danger\')"\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class="ui-form-row" style="margin: 20px 0 0;">\n\t\t\t\t\t\t\t<div class="ui-form-label">\n\t\t\t\t\t\t\t\t<div class="ui-ctl-label-text">Secret</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class="ui-form-content">\n\t\t\t\t\t\t\t\t<div class="ui-ctl ui-ctl-textbox ui-ctl-w100">\n\t\t\t\t\t\t\t\t\t<input \n\t\t\t\t\t\t\t\t\t\ttype="text" \n\t\t\t\t\t\t\t\t\t\tname="secret"\n\t\t\t\t\t\t\t\t\t\tvalue="','"\n\t\t\t\t\t\t\t\t\t\tclass="ui-ctl-element"\n\t\t\t\t\t\t\t\t\t\tonfocus="this.parentElement.classList.remove(\'ui-ctl-danger\')"\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t'])),babelHelpers.classPrivateFieldGet(this,b).hasDefaults?"":"hidden",e.Loc.getMessage("CRM_FORM_CAPTCHA_JS_STD_TITLE"),e.Loc.getMessage("CRM_FORM_CAPTCHA_JS_STD_TEXT"),babelHelpers.classPrivateFieldGet(this,f)===v?e.Loc.getMessage("CRM_FORM_CAPTCHA_JS_YANDEX_CUSTOM_TITLE"):e.Loc.getMessage("CRM_FORM_CAPTCHA_JS_CUSTOM_TITLE_MSGVER_1"),e.Loc.getMessage("CRM_FORM_CAPTCHA_JS_CUSTOM_TEXT"),babelHelpers.classPrivateFieldGet(this,f)===v?"https://yandex.cloud/ru/docs/smartcaptcha/operations/get-keys":"https://www.google.com/recaptcha/about/",e.Loc.getMessage("CRM_FORM_CAPTCHA_JS_CUSTOM_HOWTO"),t,a));return babelHelpers.classPrivateFieldGet(this,h)}t.Captcha=m})(this.BX.Crm.Form=this.BX.Crm.Form||{},BX,BX.UI.SidePanel);
//# sourceMappingURL=captcha.bundle.map.js