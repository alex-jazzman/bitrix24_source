this.BX=this.BX||{};this.BX.Crm=this.BX.Crm||{};(function(e,t,l,a,s){"use strict";var i,r,o,c;function n(e,t){b(e,t);t.add(e)}function d(e,t,l){b(e,t);t.set(e,l)}function b(e,t){if(t.has(e)){throw new TypeError("Cannot initialize the same private elements twice on an object")}}function v(e,t,l){if(!t.has(e)){throw new TypeError("attempted to get private field on non-instance")}return l}var p={EVENT_COLORSELECTOR_VALUE_CHANGE:"crm.field.colorselector:change"};var h=new WeakMap;var u=new WeakMap;var f=new WeakMap;var m=new WeakMap;var H=new WeakMap;var P=new WeakMap;var F=new WeakMap;var g=new WeakMap;var w=new WeakSet;var C=new WeakSet;var G=new WeakSet;var S=new WeakSet;var E=function(){function e(l){babelHelpers.classCallCheck(this,e);n(this,S);n(this,G);n(this,C);n(this,w);d(this,h,{writable:true,value:void 0});d(this,u,{writable:true,value:null});d(this,f,{writable:true,value:[]});d(this,m,{writable:true,value:"default"});d(this,H,{writable:true,value:false});d(this,P,{writable:true,value:null});d(this,F,{writable:true,value:null});d(this,g,{writable:true,value:null});babelHelpers.classPrivateFieldSet(this,h,l.id||"color-selector-".concat(t.Text.getRandom()));babelHelpers.classPrivateFieldSet(this,u,t.Type.isDomNode(l.target)?l.target:null);babelHelpers.classPrivateFieldSet(this,f,t.Type.isArrayFilled(l.colorList)?l.colorList:[]);babelHelpers.classPrivateFieldSet(this,m,t.Type.isStringFilled(l.selectedColorId)?l.selectedColorId:[]);babelHelpers.classPrivateFieldSet(this,H,l.readOnlyMode===true);this.togglePopup=this.togglePopup.bind(this);v(this,w,k).call(this)}babelHelpers.createClass(e,[{key:"togglePopup",value:function e(){if(babelHelpers.classPrivateFieldGet(this,H)){return}var t=v(this,G,y).call(this);if(t.isShown()){t.close()}else{t.show()}}},{key:"onSelectColor",value:function e(t){v(this,G,y).call(this).close();this.setValue(t);a.EventEmitter.emit(this,p.EVENT_COLORSELECTOR_VALUE_CHANGE,{value:t})}},{key:"setValue",value:function e(l){babelHelpers.classPrivateFieldSet(this,m,l);var a=v(this,C,T).call(this,babelHelpers.classPrivateFieldGet(this,m)).color;t.Dom.style(babelHelpers.classPrivateFieldGet(this,F),{backgroundColor:a});if(!babelHelpers.classPrivateFieldGet(this,g)){return}t.Dom.removeClass(babelHelpers.classPrivateFieldGet(this,g).querySelector(".--selected"),"--selected");var s=babelHelpers.classPrivateFieldGet(this,g).querySelector("#crm-field-color-selector-menu-item-".concat(l));if(s){t.Dom.addClass(s,"--selected")}}},{key:"onKeyUpHandler",value:function e(t){if(t.keyCode===13){var l;(l=babelHelpers.classPrivateFieldGet(this,P))===null||l===void 0?void 0:l.close()}}}]);return e}();function k(){var e=this;if(!babelHelpers.classPrivateFieldGet(this,u)){return}babelHelpers.classPrivateFieldSet(this,F,t.Tag.render(i||(i=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<div \n\t\t\t\tclass="crm-field-color-selector ','"\n\t\t\t></div>\n\t\t'])),babelHelpers.classPrivateFieldGet(this,H)?"--readonly":""));t.Dom.append(babelHelpers.classPrivateFieldGet(this,F),babelHelpers.classPrivateFieldGet(this,u));var l=v(this,C,T).call(this,babelHelpers.classPrivateFieldGet(this,m)).color;t.Dom.style(babelHelpers.classPrivateFieldGet(this,F),{"--crm-field-color-selector-color":l});t.Event.bind(babelHelpers.classPrivateFieldGet(this,F),"click",(function(t){t.preventDefault();e.togglePopup()}))}function T(e){return babelHelpers.classPrivateFieldGet(this,f).find((function(t){return t.id===e}))}function y(){if(!babelHelpers.classPrivateFieldGet(this,P)){babelHelpers.classPrivateFieldSet(this,P,new s.Popup({id:"crm-todo-color-selector-popup-".concat(t.Text.getRandom()),autoHide:true,bindElement:babelHelpers.classPrivateFieldGet(this,u),content:v(this,S,L).call(this),closeByEsc:true,closeIcon:false,draggable:false,width:188,padding:0,angle:true,offsetLeft:6,offsetTop:14}))}return babelHelpers.classPrivateFieldGet(this,P)}function L(){var e=this;babelHelpers.classPrivateFieldSet(this,g,t.Tag.render(r||(r=babelHelpers.taggedTemplateLiteral(['<div class="crm-field-color-selector-menu-container"></div>']))));babelHelpers.classPrivateFieldGet(this,f).forEach((function(l){var a=t.Text.encode("crm-field-color-selector-menu-item-".concat(l.id));var s=t.Tag.render(o||(o=babelHelpers.taggedTemplateLiteral(['\n\t\t\t\t<span \n\t\t\t\t\tid="','"\n\t\t\t\t\tclass="crm-field-color-selector-menu-item ','"\n\t\t\t\t\tonclick="','"\n\t\t\t\t>\n\t\t\t\t</span>\n\t\t\t'])),a,l.id===babelHelpers.classPrivateFieldGet(e,m)?"--selected":"",e.onSelectColor.bind(e,l.id));t.Dom.append(s,babelHelpers.classPrivateFieldGet(e,g));t.Dom.style(s,{"--crm-field-color-selector-color":l.color})}));return t.Tag.render(c||(c=babelHelpers.taggedTemplateLiteral(['\n\t\t\t<div class="crm-field-color-selector-popup">\n\t\t\t\t',"\n\t\t\t</div>\n\t\t"])),babelHelpers.classPrivateFieldGet(this,g))}e.ColorSelectorEvents=p;e.ColorSelector=E})(this.BX.Crm.Field=this.BX.Crm.Field||{},BX,BX,BX.Event,BX.Main);
//# sourceMappingURL=color-selector.bundle.map.js