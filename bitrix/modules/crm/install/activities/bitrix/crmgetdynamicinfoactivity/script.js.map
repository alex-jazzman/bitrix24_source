{"version":3,"file":"script.js","sources":["script.es6.js"],"sourcesContent":["import { Reflection, Type, Event, Dom, Loc } from 'main.core';\nimport {\n\tContext,\n\tConditionGroup,\n\tConditionGroupSelector,\n\tDocument,\n\tgetGlobalContext,\n\tsetGlobalContext,\n\tInlineSelector,\n\tDesigner,\n} from 'bizproc.automation';\n\nconst namespace = Reflection.namespace('BX.Crm.Activity');\n\nclass CrmGetDynamicInfoActivity\n{\n\tdocumentType: Array<string>;\n\tdocument: Document;\n\tisRobot: boolean;\n\tentityTypeIdSelect: HTMLSelectElement;\n\n\treturnFieldsProperty: object;\n\treturnFieldsMapContainer: HTMLDivElement;\n\treturnFieldsMap: Map<number, Map<string, object>>;\n\treturnFieldsIds: Array<string>;\n\n\tfilterFieldsContainer: HTMLDivElement | null;\n\tfilteringFieldsPrefix: string;\n\tfilterFieldsMap: Map<number, object>;\n\tconditionGroup: ConditionGroup | undefined;\n\n\tcurrentEntityTypeId: number;\n\n\tonOpenFilterFieldsMenu: ?Function;\n\n\tconstructor(options)\n\t{\n\t\tif (Type.isPlainObject(options))\n\t\t{\n\t\t\tthis.documentType = options.documentType;\n\t\t\tthis.isRobot = options.isRobot;\n\t\t\tconst form = document.forms[options.formName];\n\n\t\t\tif (!Type.isNil(form))\n\t\t\t{\n\t\t\t\tthis.entityTypeIdSelect = form.dynamic_type_id;\n\t\t\t\tthis.currentEntityTypeId = Number(this.entityTypeIdSelect.value);\n\t\t\t\tthis.entityTypeDependentElements = document.querySelectorAll(\n\t\t\t\t\t'[data-role=\"bca-cuda-entity-type-id-dependent\"]',\n\t\t\t\t);\n\t\t\t}\n\n\t\t\tthis.document = new Document({\n\t\t\t\trawDocumentType: this.documentType,\n\t\t\t\tdocumentFields: options.documentFields,\n\t\t\t\ttitle: options.documentName,\n\t\t\t});\n\n\t\t\tthis.initAutomationContext();\n\t\t\tthis.#initOnOpenFilterFieldsMenu();\n\t\t\tthis.initFilterFields(options);\n\t\t\tthis.initReturnFields(options);\n\n\t\t\tthis.render();\n\t\t}\n\t}\n\n\tinitFilterFields(options)\n\t{\n\t\tthis.conditinIdPrefix = 'id_bca_cuda_field_';\n\t\tthis.filterFieldsContainer = document.querySelector('[data-role=\"bca-cuda-filter-fields-container\"]');\n\t\tthis.filteringFieldsPrefix = options.filteringFieldsPrefix;\n\t\tthis.filterFieldsMap = new Map(\n\t\t\tObject.entries(options.filterFieldsMap)\n\t\t\t\t.map(([entityTypeId, fieldsMap]) => [Number(entityTypeId), fieldsMap]),\n\t\t);\n\n\t\t// issue 0158608\n\t\tif (!Type.isNil(options.documentType) && !this.isRobot)\n\t\t{\n\t\t\tBX.Bizproc.Automation.API.documentType = options.documentType;\n\t\t}\n\t\tthis.conditionGroup = new ConditionGroup(options.conditions);\n\t}\n\n\tinitReturnFields(options)\n\t{\n\t\tthis.returnFieldsProperty = options.returnFieldsProperty;\n\t\tthis.returnFieldsIds = Type.isArray(options.returnFieldsIds) ? options.returnFieldsIds : [];\n\n\t\tthis.returnFieldsMapContainer = document.querySelector('[data-role=\"bca-cuda-return-fields-container\"]');\n\t\tthis.returnFieldsMap = new Map();\n\t\tObject.entries(options.returnFieldsMap).forEach(([entityTypeId, fieldsMap]) => {\n\t\t\tthis.returnFieldsMap.set(Number(entityTypeId), new Map(Object.entries(fieldsMap)));\n\t\t});\n\t}\n\n\tinitAutomationContext()\n\t{\n\t\ttry\n\t\t{\n\t\t\tgetGlobalContext();\n\t\t}\n\t\tcatch\n\t\t{\n\t\t\tsetGlobalContext(new Context({ document: this.document }));\n\t\t}\n\t}\n\n\t#initOnOpenFilterFieldsMenu()\n\t{\n\t\tif (this.isRobot)\n\t\t{\n\t\t\tthis.onOpenFilterFieldsMenu = (event) => {\n\t\t\t\tconst dialog = Designer.getInstance().getRobotSettingsDialog();\n\t\t\t\tconst template = dialog.template;\n\t\t\t\tconst robot = dialog.robot;\n\t\t\t\tif (template && robot)\n\t\t\t\t{\n\t\t\t\t\ttemplate.onOpenMenu(event, robot);\n\t\t\t\t}\n\t\t\t};\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.onOpenFilterFieldsMenu = (event) => this.addBPFields(event.getData().selector);\n\t\t}\n\t}\n\taddBPFields(selector: InlineSelector): void\n\t{\n\t\tconst getSelectorProperties = ({properties, objectName, expressionPrefix}) => {\n\t\t\tif (Type.isObject(properties))\n\t\t\t{\n\t\t\t\treturn Object.entries(properties).map(([id, property]) => ({\n\t\t\t\t\tid,\n\t\t\t\t\ttitle: property.Name,\n\t\t\t\t\tcustomData: {\n\t\t\t\t\t\tfield: {\n\t\t\t\t\t\t\tId: id,\n\t\t\t\t\t\t\tType: property.Type,\n\t\t\t\t\t\t\tName: property.Name,\n\t\t\t\t\t\t\tObjectName: objectName,\n\t\t\t\t\t\t\tSystemExpression: `{=${objectName}:${id}}`,\n\t\t\t\t\t\t\tExpression: expressionPrefix ? `{{${expressionPrefix}:${id}}}` : `{=${objectName}:${id}}`,\n\t\t\t\t\t\t},\n\t\t\t\t\t}\n\t\t\t\t}));\n\t\t\t}\n\n\t\t\treturn [];\n\t\t}\n\t\tconst getGlobalSelectorProperties = ({properties, visibilityNames, objectName}) => {\n\t\t\tif (Type.isObject(properties))\n\t\t\t{\n\t\t\t\treturn Object.entries(properties).map(([id, property]) => {\n\t\t\t\t\tconst field = {\n\t\t\t\t\t\tid,\n\t\t\t\t\t\tType: property.Type,\n\t\t\t\t\t\ttitle: property.Name,\n\t\t\t\t\t\tObjectName: objectName,\n\t\t\t\t\t\tSystemExpression: `{=${objectName}:${id}}`,\n\t\t\t\t\t\tExpression: `{=${objectName}:${id}}`,\n\t\t\t\t\t}\n\n\t\t\t\t\tif (property.Visibility && visibilityNames[property.Visibility])\n\t\t\t\t\t{\n\t\t\t\t\t\tfield.Expression = `{{${visibilityNames[property.Visibility]}: ${property.Name}}}`;\n\t\t\t\t\t}\n\n\t\t\t\t\treturn {\n\t\t\t\t\t\tid,\n\t\t\t\t\t\ttitle: property.Name,\n\t\t\t\t\t\tsupertitle: visibilityNames[property.Visibility],\n\t\t\t\t\t\tcustomData: { field },\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t}\n\n\t\t\treturn [];\n\t\t}\n\n\t\tselector.addGroup('workflowParameters', {\n\t\t\tid: 'workflowParameters',\n\t\t\ttitle: Loc.getMessage('BIZPROC_WFEDIT_MENU_PARAMS'),\n\t\t\tchildren: [\n\t\t\t\t{\n\t\t\t\t\tid: 'parameters',\n\t\t\t\t\ttitle: Loc.getMessage('BIZPROC_AUTOMATION_CMP_PARAMETERS_LIST'),\n\t\t\t\t\tchildren: getSelectorProperties({\n\t\t\t\t\t\tproperties: window.arWorkflowParameters || {},\n\t\t\t\t\t\tobjectName: 'Template',\n\t\t\t\t\t\texpressionPrefix: '~*',\n\t\t\t\t\t}),\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tid: 'variables',\n\t\t\t\t\ttitle: Loc.getMessage('BIZPROC_AUTOMATION_CMP_GLOB_VARIABLES_LIST_1'),\n\t\t\t\t\tchildren: getSelectorProperties({\n\t\t\t\t\t\tproperties: window.arWorkflowVariables || {},\n\t\t\t\t\t\tobjectName: 'Variable',\n\t\t\t\t\t}),\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tid: 'constants',\n\t\t\t\t\ttitle: Loc.getMessage('BIZPROC_AUTOMATION_CMP_CONSTANTS_LIST'),\n\t\t\t\t\tchildren: getSelectorProperties({\n\t\t\t\t\t\tproperties: window.arWorkflowConstants || {},\n\t\t\t\t\t\tobjectName: 'Constant',\n\t\t\t\t\t\texpressionPrefix: '~&',\n\t\t\t\t\t}),\n\t\t\t\t},\n\t\t\t],\n\t\t});\n\t\tif (window.arWorkflowGlobalVariables && window.wfGVarVisibilityNames)\n\t\t{\n\t\t\tselector.addGroup('globalVariables', {\n\t\t\t\tid: 'globalVariables',\n\t\t\t\ttitle: Loc.getMessage('BIZPROC_AUTOMATION_CMP_GLOB_VARIABLES_LIST'),\n\t\t\t\tchildren: getGlobalSelectorProperties({\n\t\t\t\t\tproperties: window.arWorkflowGlobalVariables || {},\n\t\t\t\t\tvisibilityNames: window.wfGVarVisibilityNames || {},\n\t\t\t\t\tobjectName: 'GlobalVar',\n\t\t\t\t}),\n\t\t\t});\n\t\t}\n\t\tselector.addGroup('globalConstants', {\n\t\t\tid: 'globalConstants',\n\t\t\ttitle: Loc.getMessage('BIZPROC_AUTOMATION_CMP_GLOB_CONSTANTS_LIST'),\n\t\t\tchildren: getGlobalSelectorProperties({\n\t\t\t\tproperties: window.arWorkflowGlobalConstants || {},\n\t\t\t\tvisibilityNames: window.wfGConstVisibilityNames || {},\n\t\t\t\tobjectName: 'GlobalConst',\n\t\t\t}),\n\t\t});\n\t}\n\n\tinit(): void\n\t{\n\t\tif (this.entityTypeIdSelect)\n\t\t{\n\t\t\tEvent.bind(this.entityTypeIdSelect, 'change', this.onEntityTypeIdChange.bind(this));\n\t\t}\n\t}\n\n\tonEntityTypeIdChange(): void\n\t{\n\t\tthis.currentEntityTypeId = Number(this.entityTypeIdSelect.value);\n\n\t\tthis.conditionGroup = new ConditionGroup();\n\n\t\tthis.returnFieldsIds = [];\n\n\t\tthis.render();\n\t}\n\n\trender(): void\n\t{\n\t\tif (Type.isNil(this.currentEntityTypeId) || this.currentEntityTypeId === 0)\n\t\t{\n\t\t\tthis.entityTypeDependentElements.forEach((element) => Dom.hide(element));\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.entityTypeDependentElements.forEach((element) => Dom.show(element));\n\t\t\tthis.renderFilterFields();\n\t\t\tthis.renderReturnFields();\n\t\t}\n\t}\n\n\trenderFilterFields(): void\n\t{\n\t\tif (\n\t\t\t!Type.isNil(this.conditionGroup)\n\t\t\t&& this.currentEntityTypeId !== 0\n\t\t)\n\t\t{\n\t\t\tconst selector = new ConditionGroupSelector(this.conditionGroup, {\n\t\t\t\tfields: Object.values(this.filterFieldsMap.get(this.currentEntityTypeId)),\n\t\t\t\tfieldPrefix: this.filteringFieldsPrefix,\n\t\t\t\tonOpenMenu: this.onOpenFilterFieldsMenu,\n\t\t\t\tcaption: {\n\t\t\t\t\thead: Loc.getMessage('CRM_GDIA_FILTERING_FIELDS_PROPERTY'),\n\t\t\t\t\tcollapsed: Loc.getMessage('CRM_GDIA_FILTERING_FIELDS_COLLAPSED_TEXT'),\n\t\t\t\t},\n\t\t\t});\n\n\t\t\t// todo: remove 2024 with this.filterFieldsContainer.parentNode.firstElementChild\n\t\t\tif (selector.modern && this.filterFieldsContainer && this.filterFieldsContainer.parentNode)\n\t\t\t{\n\t\t\t\tconst element = (\n\t\t\t\t\tthis.filterFieldsContainer.parentNode.firstElementChild === this.filterFieldsContainer\n\t\t\t\t\t\t? this.filterFieldsContainer.parentNode.parentNode.firstElementChild\n\t\t\t\t\t\t: this.filterFieldsContainer.parentNode.firstElementChild\n\t\t\t\t);\n\n\t\t\t\tDom.clean(element);\n\t\t\t}\n\n\t\t\tDom.clean(this.filterFieldsContainer);\n\t\t\tDom.append(selector.createNode(), this.filterFieldsContainer);\n\t\t}\n\t}\n\n\trenderReturnFields(): void\n\t{\n\t\tconst entityTypeId = this.currentEntityTypeId;\n\t\tconst fieldsMap = this.returnFieldsMap.get(entityTypeId);\n\n\t\tif (!Type.isNil(fieldsMap))\n\t\t{\n\t\t\tconst fieldOptions = {};\n\t\t\tfieldsMap.forEach((field, fieldId) => {\n\t\t\t\tfieldOptions[fieldId] = field.Name;\n\t\t\t});\n\t\t\tthis.returnFieldsProperty.Options = fieldOptions;\n\n\t\t\tDom.clean(this.returnFieldsMapContainer);\n\t\t\tthis.returnFieldsMapContainer.appendChild(\n\t\t\t\tBX.Bizproc.FieldType.renderControl(\n\t\t\t\t\tthis.documentType,\n\t\t\t\t\tthis.returnFieldsProperty,\n\t\t\t\t\tthis.returnFieldsProperty.FieldName,\n\t\t\t\t\tthis.returnFieldsIds,\n\t\t\t\t\tthis.isRobot ? 'public' : 'designer',\n\t\t\t\t),\n\t\t\t);\n\t\t}\n\t}\n}\n\nnamespace.CrmGetDynamicInfoActivity = CrmGetDynamicInfoActivity;\n"],"names":["namespace","Reflection","CrmGetDynamicInfoActivity","options","Type","isPlainObject","documentType","isRobot","form","document","forms","formName","isNil","entityTypeIdSelect","dynamic_type_id","currentEntityTypeId","Number","value","entityTypeDependentElements","querySelectorAll","Document","rawDocumentType","documentFields","title","documentName","initAutomationContext","initFilterFields","initReturnFields","render","conditinIdPrefix","filterFieldsContainer","querySelector","filteringFieldsPrefix","filterFieldsMap","Map","Object","entries","map","entityTypeId","fieldsMap","BX","Bizproc","Automation","API","conditionGroup","ConditionGroup","conditions","returnFieldsProperty","returnFieldsIds","isArray","returnFieldsMapContainer","returnFieldsMap","forEach","set","getGlobalContext","setGlobalContext","Context","selector","getSelectorProperties","properties","objectName","expressionPrefix","isObject","id","property","Name","customData","field","Id","ObjectName","SystemExpression","Expression","getGlobalSelectorProperties","visibilityNames","Visibility","supertitle","addGroup","Loc","getMessage","children","window","arWorkflowParameters","arWorkflowVariables","arWorkflowConstants","arWorkflowGlobalVariables","wfGVarVisibilityNames","arWorkflowGlobalConstants","wfGConstVisibilityNames","Event","bind","onEntityTypeIdChange","element","Dom","hide","show","renderFilterFields","renderReturnFields","ConditionGroupSelector","fields","values","get","fieldPrefix","onOpenMenu","onOpenFilterFieldsMenu","caption","head","collapsed","modern","parentNode","firstElementChild","clean","append","createNode","fieldOptions","fieldId","Options","appendChild","FieldType","renderControl","FieldName","event","dialog","Designer","getInstance","getRobotSettingsDialog","template","robot","addBPFields","getData"],"mappings":"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"}