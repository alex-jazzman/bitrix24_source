{"version":3,"file":"script.js","sources":["src/account/account.js","src/api/theme.js","src/api/counters.js","src/items/item.js","src/items/item-admin-shared.js","src/items/item-admin-custom.js","src/items/item-user-favorites.js","src/items/item-user-self.js","src/items/item-system.js","src/items/index.js","src/controllers/items-controller.js","src/history/browser-history.js","src/desktop-menu.js"],"sourcesContent":["import { Dom, Text, Event, Loc, Tag } from 'main.core';\nimport { DesktopApi, DesktopAccount } from 'im.v2.lib.desktop-api';\nimport { showDesktopDeleteConfirm } from 'im.v2.lib.confirm';\nimport {Menu, Popup} from 'main.popup';\nimport { PopupManager } from 'main.popup';\nimport { PopupType } from 'im.v2.const';\nexport class Account\n{\n\tstatic defaultAvatar = '/bitrix/js/im/images/blank.gif';\n\tstatic defaultAvatarDesctop = '/bitrix/js/ui/icons/b24/images/ui-user.svg?v2';\n\taccounts: DesktopAccount[] = [];\n\tcurrentUser: ?Object = null;\n\tcontextPopup: BX.Main.Popup[] = [];\n\tpopup: BX.Main.Popup = null;\n\tallCounters: Object = {};\n\twrapper: HTMLElement = null;\n\n\tconstructor(allCounters: Object)\n\t{\n\t\tthis.wrapper = document.getElementById(\"history-items\");\n\n\t\tthis.checkCounters(allCounters);\n\t\tthis.reload();\n\n\t\tthis.viewDesktopUser();\n\t\tthis.initPopup();\n\t}\n\n\tcheckCounters(allCounters: Object): void\n\t{\n\t\tfor (let counterId of Object.keys(allCounters))\n\t\t{\n\t\t\tlet key = counterId;\n\t\t\tif (counterId === '**') {\n\t\t\t\tkey = 'live-feed';\n\t\t\t}\n\t\t\tthis.allCounters[key] = allCounters[counterId];\n\t\t}\n\t}\n\n\tgetSumCounters(): number\n\t{\n\t\tlet sum = 0;\n\t\tfor (const counterId of Object.keys(this.allCounters))\n\t\t{\n\t\t\tif (counterId === 'tasks_effective' || counterId === 'invited_users')\n\t\t\t{\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tconst val = this.allCounters[counterId] ? parseInt(this.allCounters[counterId], 10) : 0;\n\t\t\tsum += val;\n\t\t}\n\n\t\treturn sum;\n\t}\n\n\tgetTabUses(): []\n\t{\n\t\treturn ('undefined' !== typeof BXDesktopSystem) ? BXDesktopSystem.TabList() : [];\n\t}\n\n\treload(): void\n\t{\n\t\tconst currentUserId = parseInt(Loc.getMessage('USER_ID'), 10);\n\t\tthis.accounts = ('undefined' !== typeof BXDesktopSystem) ? DesktopApi.getAccountList() : [];\n\t\tthis.currentUser = this.accounts.find((account) => parseInt(account.id, 10) === currentUserId && account.portal === location.hostname);\n\n\t\tthis.viewPopupAccounts();\n\t}\n\n\tinitPopup(): void\n\t{\n\t\tconst userNode = document.querySelector('.intranet__desktop-menu_user-block');\n\t\tthis.popup = new Popup({\n\t\t\tcontent: document.querySelector('.intranet__desktop-menu_popup'),\n\t\t\tbindElement: userNode,\n\t\t\twidth: 320,\n\t\t\tbackground: '#282e39',\n\t\t\tcloseIcon: true,\n\t\t\tcloseByEsc: true,\n\t\t});\n\n\t\tEvent.bind(userNode, 'click', () => {\n\t\t\tif (this.popup.isShown())\n\t\t\t{\n\t\t\t\tthis.popup.close();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.popup.show();\n\t\t\t\tthis.reload();\n\t\t\t}\n\t\t});\n\t}\n\n\tsetCounters(counters: Object): void\n\t{\n\t\tlet newCounters = counters;\n\t\tif (counters['data'])\n\t\t{\n\t\t\tnewCounters = counters.data;\n\t\t\tif (newCounters[0] && typeof newCounters[0] === 'object')\n\t\t\t{\n\t\t\t\tnewCounters = newCounters[0];\n\t\t\t}\n\t\t}\n\n\t\tfor (let counterId of Object.keys(newCounters))\n\t\t{\n\t\t\tlet cId = counterId\n\t\t\tif (counterId === '**') {\n\t\t\t\tcId = 'live-feed';\n\t\t\t}\n\t\t\tthis.allCounters[cId] = newCounters[counterId];\n\t\t}\n\n\t\tconst sumCounters = this.getSumCounters();\n\t\tconst block = document.getElementsByClassName('intranet__desktop-menu_user-block')[0];\n\t\tconst counterNode = block.querySelector('[data-role=\"counter\"]');\n\t\tif (sumCounters > 0)\n\t\t{\n\t\t\tcounterNode.innerHTML = sumCounters > 99 ? '99+' : sumCounters;\n\t\t\tif (!Dom.hasClass(block, 'intranet__desktop-menu_item_counters'))\n\t\t\t{\n\t\t\t\tDom.addClass(block, 'intranet__desktop-menu_item_counters');\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tcounterNode.innerHTML = '';\n\t\t\tDom.addClass(block, 'intranet__desktop-menu_item_counters');\n\t\t}\n\t}\n\n\tremoveElements(className: string): void\n\t{\n\t\tconst elements = document.getElementsByClassName(className);\n\n\t\t[...elements].forEach(element => {\n\t\t\telement.remove();\n\t\t});\n\t}\n\n\tviewDesktopUser(): void\n\t{\n\t\tconst block = document.getElementsByClassName('intranet__desktop-menu_user')[0];\n\t\tconst counters = this.getSumCounters();\n\n\t\tlet counterBlock = null;\n\t\tif (counters > 0)\n\t\t{\n\t\t\tconst countersView = counters > 99 ? '99+' : counters;\n\t\t\tcounterBlock = Tag.render`\n\t\t\t\t<div class=\"intranet__desktop-menu_user-counter ui-counter ui-counter-md ui-counter-danger\">\n\t\t\t\t\t<div class=\"ui-counter-inner\" data-role=\"counter\">${countersView}</div>\n\t\t\t\t</div>`;\n\t\t}\n\n\t\tthis.removeElements('intranet__desktop-menu_user-block');\n\n\t\tlet userData = Tag.render`<div class=\"intranet__desktop-menu_user-block ${ counters > 0 ? 'intranet__desktop-menu_item_counters' : ''}\">\n\t\t\t\t<span class=\"intranet__desktop-menu_user-avatar ui-icon ui-icon-common-user ui-icon-common-user-desktop\">\n\t\t\t\t\t<i></i>\n\t\t\t\t\t${counterBlock}\n\t\t\t\t</span>\n\t\t\t\t<span class=\"intranet__desktop-menu_user-inner\">\n\t\t\t\t\t<span class=\"intranet__desktop-menu_user-name\">${this.currentUser.portal}</span>\n\t\t\t\t\t<span class=\"intranet__desktop-menu_user-post\">${this.currentUser.work_position}</span>\n\t\t\t\t</span>\n\t\t\t</div>`;\n\n\t\tDom.append(userData, block);\n\n\t\tconst avatar = document.getElementsByClassName('ui-icon-common-user-desktop')[0];\n\t\tconst previewImage = this.getAvatarUrl(this.currentUser);\n\t\tDom.style(avatar, '--ui-icon-service-bg-image', previewImage);\n\t}\n\n\tgetAvatarUrl(account): string\n\t{\n\t\tlet avatarUrl = '';\n\t\tif (account.avatar.includes('http://') || account.avatar.includes('https://'))\n\t\t{\n\t\t\tavatarUrl = account.avatar;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tavatarUrl = account.protocol + '://' + account.portal + account.avatar;\n\t\t}\n\n\t\treturn `url('${BX.util.htmlspecialchars(account.avatar === Account.defaultAvatar ? Account.defaultAvatarDesctop : BX.util.htmlspecialchars(avatarUrl))}')`;\n\t}\n\n\tviewPopupAccounts(): void\n\t{\n\t\tconst menuPopup = document.getElementsByClassName('intranet__desktop-menu_popup')[0];\n\t\tlet position = '';\n\t\tif (this.currentUser.work_position !== '')\n\t\t{\n\t\t\tposition = `<span class=\"intranet__desktop-menu_popup-post\">${this.currentUser.work_position}</span>`;\n\t\t}\n\n\t\tthis.removeElements('intranet__desktop-menu_popup-header');\n\n\t\tlet item = Tag.render`<div class=\"intranet__desktop-menu_popup-header\">\n\t\t\t<span class=\"intranet__desktop-menu_user-avatar ui-icon ui-icon-common-user ui-icon-common-user-popup\">\n\t\t\t\t<i></i>\n\t\t\t</span>\n\t\t\t<span class=\"intranet__desktop-menu_popup-label\">${this.currentUser.portal}</span>\n\t\t\t<div class=\"intranet__desktop-menu_popup-header-user\">\n\t\t\t\t<span class=\"intranet__desktop-menu_popup-name\">${this.currentUser.first_name + ' ' + this.currentUser.last_name}</span>\n\t\t\t\t${position}\n\t\t\t</div>\n\t\t</div>`;\n\n\t\tDom.insertBefore(item, menuPopup.firstElementChild);\n\n\t\tconst avatar = document.getElementsByClassName('ui-icon-common-user-popup')[0];\n\t\tconst previewImage = this.getAvatarUrl(this.currentUser);\n\t\tDom.style(avatar, '--ui-icon-service-bg-image', previewImage);\n\n\t\tconst block = document.getElementsByClassName('intranet__desktop-menu_popup-list')[0];\n\n\t\tthis.removeElements('intranet__desktop-menu_popup-item-account');\n\n\t\tlet index = 0;\n\t\tconst users = this.getTabUses();\n\t\tfor (let account of this.accounts)\n\t\t{\n\t\t\tlet currentUserClass = '';\n\t\t\tlet currentUserConnected = '';\n\t\t\tlet counters = 0;\n\t\t\tconst isSelected = users.some(x => parseInt(x.id, 10) === parseInt(account.id, 10) && x.portal === account.portal);\n\t\t\tif (isSelected)\n\t\t\t{\n\t\t\t\tif (parseInt(account.id, 10) === parseInt(this.currentUser.id, 10) && account.portal === this.currentUser.portal)\n\t\t\t\t{\n\t\t\t\t\tcounters = this.getSumCounters();\n\t\t\t\t\tcurrentUserConnected = '--selected';\n\t\t\t\t}\n\t\t\t\tcurrentUserClass = '--connected';\n\t\t\t}\n\t\t\tconst countersView = counters > 99 ? '99+' : counters;\n\n\t\t\tlet item = Tag.render`<li class=\"intranet__desktop-menu_popup-item intranet__desktop-menu_popup-item-account ${ counters > 0 ? 'intranet__desktop-menu_item_counters' : ''} ${currentUserClass} ${currentUserConnected}\">\n\t\t\t\t\t<span class=\"intranet__desktop-menu_user-avatar ui-icon ui-icon-common-user ui-icon-common-user-${index}\">\n\t\t\t\t\t\t<i></i>\n\t\t\t\t\t\t<div class=\"intranet__desktop-menu_user-counter ui-counter ui-counter-md ui-counter-danger\">\n\t\t\t\t\t\t\t<div class=\"ui-counter-inner\">${countersView}</div>\n\t\t\t\t\t\t</div>\t\n\t\t\t\t\t</span>\n\t\t\t\t\t<span class=\"intranet__desktop-menu_popup-user\">\n\t\t\t\t\t\t<span class=\"intranet__desktop-menu_popup-name\">${account.portal}</span>\n\t\t\t\t\t\t<span class=\"intranet__desktop-menu_popup-post\">${account.login}</span>\n\t\t\t\t\t</span>\n\t\t\t\t\t<span class=\"intranet__desktop-menu_popup-btn ui-icon-set --more\" id=\"ui-icon-set-${index}\"></span>\n\t\t\t\t</li>`;\n\n\t\t\tDom.insertBefore(item, block.children[index]);\n\n\t\t\tthis.addContextMenu(account, index, isSelected);\n\n\t\t\tlet userAvatar = document.getElementsByClassName('ui-icon-common-user-' + index)[0];\n\t\t\tlet previewUserImage = this.getAvatarUrl(account);\n\t\t\tDom.style(userAvatar, '--ui-icon-service-bg-image', previewUserImage);\n\n\t\t\tindex++;\n\t\t}\n\t}\n\n\taddContextMenu(account: DesktopAccount, index: number, isSelected: boolean): void\n\t{\n\t\tconst button = document.getElementById(`ui-icon-set-${index}`);\n\t\tconst popup = this.popup;\n\t\tconst contextPopup = this.contextPopup;\n\t\tif (contextPopup[index])\n\t\t{\n\t\t\tcontextPopup[index].destroy();\n\t\t}\n\t\tcontextPopup[index] = new Menu({\n\t\t\tbindElement: button,\n\t\t\tclassName: 'intranet__desktop-menu_context',\n\t\t\titems: [\n\t\t\t\tisSelected ?\n\t\t\t\t\t{\n\t\t\t\t\t\ttext: Loc.getMessage('MENU_ACCOUNT_POPUP_DISCONNECT'),\n\t\t\t\t\t\tonclick: function(event, item) {\n\t\t\t\t\t\t\tconst { host } = account;\n\t\t\t\t\t\t\tBXDesktopSystem?.AccountDisconnect(host);\n\t\t\t\t\t\t\tif (contextPopup[index])\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tcontextPopup[index].close();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tpopup.close();\n\t\t\t\t\t\t},\n\t\t\t\t\t}\n\t\t\t\t\t:\n\t\t\t\t\t{\n\t\t\t\t\t\ttext: Loc.getMessage('MENU_ACCOUNT_POPUP_CONNECT'),\n\t\t\t\t\t\tonclick: function(event, item) {\n\t\t\t\t\t\t\tconst { host, login, protocol } = account;\n\t\t\t\t\t\t\tconst userLang = navigator.language;\n\t\t\t\t\t\t\tDesktopApi.connectAccount(host, login, protocol, userLang);\n\t\t\t\t\t\t\tif (contextPopup[index])\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tcontextPopup[index].close();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tpopup.close();\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\ttext: Loc.getMessage('MENU_ACCOUNT_POPUP_REMOVE'),\n\t\t\t\t\tonclick: async function(event, item) {\n\t\t\t\t\t\tconst userChoice = await showDesktopDeleteConfirm();\n\t\t\t\t\t\tif (userChoice === true)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tconst { host, login } = account;\n\t\t\t\t\t\t\tDesktopApi.deleteAccount(host, login);\n\n\t\t\t\t\t\t\tPopupManager.getPopupById(PopupType.userProfile)?.close();\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (contextPopup[index])\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tcontextPopup[index].close();\n\t\t\t\t\t\t}\n\t\t\t\t\t\tpopup.close();\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t],\n\t\t});\n\n\t\tEvent.bind(button, 'click', (event) => {\n\t\t\tconst index: number = parseInt(event.target.id.replace('ui-icon-set-', ''));\n\t\t\tif (contextPopup[index])\n\t\t\t{\n\t\t\t\tcontextPopup[index].show();\n\t\t\t}\n\t\t});\n\t}\n\n\topenLoginTab(): void\n\t{\n\t\tDesktopApi.openAddAccountTab();\n\t}\n}","import { Dom, Text, Type } from 'main.core';\nimport { EventEmitter } from 'main.core.events';\n\nexport default class Theme\n{\n\tbackgroundNode: Element = null;\n\n\tconstructor() {\n\t\tconst theme: any = this.#getThemePicker()?.getAppliedTheme();\n\t\tthis.backgroundNode = document.querySelector('body');\n\n\t\tif (theme)\n\t\t{\n\t\t\tthis.#applyTheme(theme);\n\t\t}\n\n\t\tEventEmitter.subscribe(\n\t\t\t'BX.Intranet.Bitrix24:ThemePicker:onThemeApply',\n\t\t\t(event) => {\n\t\t\t\tthis.#applyTheme(event.data.theme);\n\t\t\t},\n\t\t);\n\t}\n\n\t#getThemePicker(): ?BX.Intranet.Bitrix24.ThemePicker\n\t{\n\t\treturn BX.Intranet?.Bitrix24?.ThemePicker.Singleton ?? top.BX.Intranet?.Bitrix24?.ThemePicker.Singleton;\n\t}\n\n\t#applyTheme(theme: any): void\n\t{\n\t\ttheme.video ? this.#applyVideoTheme(theme) : this.#applyPictureTheme(theme);\n\n\t\tDom.removeClass(this.backgroundNode, 'bitrix24-theme-default bitrix24-theme-dark bitrix24-theme-light');\n\t\tlet themeClass = 'bitrix24-theme-default';\n\n\t\tif (theme.id !== 'default' && String(theme.id).indexOf('default:') !== 0)\n\t\t{\n\t\t\tthemeClass = String(theme.id).indexOf('dark:') === 0 ? 'bitrix24-theme-dark' : 'bitrix24-theme-light';\n\t\t}\n\n\t\tDom.addClass(this.backgroundNode, themeClass);\n\t}\n\n\t#applyPictureTheme(theme: any): void\n\t{\n\t\tlet bgImage = theme.previewImage;\n\t\tif (Type.isArrayFilled(theme.prefetchImages))\n\t\t{\n\t\t\tbgImage = theme.prefetchImages[theme.prefetchImages.length - 1];\n\t\t}\n\t\tconst imageUrl = `url('${Text.encode(bgImage)}')`;\n\t\tDom.style(this.backgroundNode, 'backgroundImage', imageUrl);\n\t}\n\n\t#applyVideoTheme(theme: any): void\n\t{\n\t\tconst sources = [];\n\t\tfor (let type in theme.video.sources)\n\t\t{\n\t\t\tsources.push(BX.create('source', {\n\t\t\t\tattrs: {\n\t\t\t\t\ttype: `video/${type}`,\n\t\t\t\t\tsrc: theme.video.sources[type],\n\t\t\t\t},\n\t\t\t}));\n\t\t}\n\n\t\tconst video = Dom.create('div', {\n\t\t\tprops: {\n\t\t\t\tclassName: 'theme-video-container',\n\t\t\t},\n\t\t\tdataset: {\n\t\t\t\tthemeId: theme.id,\n\t\t\t},\n\t\t\tchildren: [\n\t\t\t\tDom.create('video', {\n\t\t\t\t\tprops: {\n\t\t\t\t\t\tclassName: 'theme-video',\n\t\t\t\t\t},\n\t\t\t\t\tattrs: {\n\t\t\t\t\t\tposter: theme.video.poster,\n\t\t\t\t\t\tautoplay: true,\n\t\t\t\t\t\tloop: true,\n\t\t\t\t\t\tmuted: true,\n\t\t\t\t\t\tplaysinline: true,\n\t\t\t\t\t},\n\t\t\t\t\tdataset: {\n\t\t\t\t\t\tthemeId: theme.id,\n\t\t\t\t\t},\n\t\t\t\t\tchildren: sources,\n\t\t\t\t}),\n\t\t\t],\n\t\t});\n\n\t\tDom.prepend(video, this.backgroundNode);\n\t}\n}","import { BaseEvent, EventEmitter } from 'main.core.events';\n\nexport default class Counters\n{\n\tinit()\n\t{\n\t\t// All Counters\n\t\tEventEmitter.subscribe('onPullEvent-main', (event: BaseEvent) => {\n\t\t\tconst [command, params] = event.getCompatData();\n\t\t\tif (command === 'user_counter' && params[Loc.getMessage('SITE_ID')])\n\t\t\t{\n\t\t\t\tconst counters = { ...params[Loc.getMessage('SITE_ID')] };\n\t\t\t\tthis.updateCounters(counters, false);\n\t\t\t}\n\t\t});\n\n\t\tBX.addCustomEvent(\"onPullEvent-tasks\", (command, params) => {\n\t\t\tif (\n\t\t\t\tcommand === \"user_counter\"\n\t\t\t\t&& Number(params.userId) === Number(BX.Loc.getMessage('USER_ID'))\n\t\t\t)\n\t\t\t{\n\t\t\t\tlet counters = {};\n\t\t\t\tif (!BX.Type.isUndefined(params.projects_major))\n\t\t\t\t{\n\t\t\t\t\tcounters.projects_major = params.projects_major;\n\t\t\t\t}\n\t\t\t\tif (!BX.Type.isUndefined(params.scrum_total_comments))\n\t\t\t\t{\n\t\t\t\t\tcounters.scrum_total_comments = params.scrum_total_comments;\n\t\t\t\t}\n\n\t\t\t\tthis.updateCounters(counters, false);\n\t\t\t}\n\t\t});\n\n\t\t// All Counters from IM\n\t\tEventEmitter.subscribe('onImUpdateCounter', (event: BaseEvent) => {\n\t\t\tconst [counters] = event.getCompatData();\n\t\t\tthis.updateCounters(counters, false);\n\t\t});\n\n\t\t// Messenger counter\n\t\tEventEmitter.subscribe('onImUpdateCounterMessage', (event: BaseEvent) => {\n\t\t\tconst [counter] = event.getCompatData();\n\t\t\tthis.updateCounters({ 'im-message': counter }, false);\n\t\t});\n\n\t\tif (BX.browser.SupportLocalStorage())\n\t\t{\n\t\t\tBX.addCustomEvent(window, 'onLocalStorageSet', (params) =>\n\t\t\t{\n\t\t\t\tif (params.key.substring(0, 4) === 'lmc-')\n\t\t\t\t{\n\t\t\t\t\tlet counters = {};\n\t\t\t\t\tcounters[params.key.substring(4)] = params.value;\n\t\t\t\t\tthis.updateCounters(counters, false);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\t// Live Feed Counter\n\t\tEventEmitter.subscribe('onCounterDecrement', (event: BaseEvent) => {\n\t\t\tconst [decrement] = event.getCompatData();\n\t\t\tthis.decrementCounter(document.getElementById('menu-counter-live-feed'), decrement);\n\t\t});\n\t}\n\n\tupdateCounters(counters, send)\n\t{\n\t\tBX.ready(function ()\n\t\t{\n\t\t\tif (BX.getClass(\"BX.Intranet.DescktopLeftMenu\"))\n\t\t\t{\n\t\t\t\tBX.Intranet.DescktopLeftMenu.updateCounters(counters, send);\n\t\t\t}\n\t\t});\n\t}\n\n\tdecrementCounter(node, iDecrement)\n\t{\n\t\tBX.ready(function ()\n\t\t{\n\t\t\tif (BX.getClass(\"BX.Intranet.DescktopLeftMenu\"))\n\t\t\t{\n\t\t\t\tBX.Intranet.DescktopLeftMenu.decrementCounter(node, iDecrement);\n\t\t\t}\n\t\t});\n\t}\n}\n","import {Type} from 'main.core';\n\nexport default class Item\n{\n\tparentContainer: Element;\n\tcontainer: Element;\n\n\tconstructor(parentContainer, container)\n\t{\n\t\tthis.parentContainer = parentContainer;\n\t\tthis.container = container;\n\t\tthis.init();\n\t}\n\n\tinit(): void\n\t{\n\t\tthis.makeTextIcons();\n\t}\n\n\tgetId(): string\n\t{\n\t\treturn this.container.dataset.id;\n\t}\n\n\tgetCode(): string\n\t{\n\t\treturn this.constructor.code;\n\t}\n\n\tgetName(): string\n\t{\n\t\treturn this.container.querySelector(\"[data-role='item-text']\").textContent;\n\t}\n\n\tstatic detect(node: Element)\n\t{\n\t\treturn node.getAttribute(\"data-role\") !== 'group' &&\n\t\t\tnode.getAttribute(\"data-type\") === this.code;\n\t}\n\n\tmakeTextIcons(): void\n\t{\n\t\tif (!this.container.classList.contains(\"menu-item-no-icon-state\"))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst icon = this.container.querySelector(\".menu-item-icon\");\n\t\tconst text = this.container.querySelector(\".menu-item-link-text\");\n\n\t\tif (icon && text)\n\t\t{\n\t\t\ticon.textContent = this.getShortName(text.textContent);\n\t\t}\n\t}\n\n\tgetCounterValue(): ?number\n\t{\n\t\tconst node = this.container.querySelector('[data-role=\"counter\"]');\n\t\tif (!node)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\t\treturn parseInt(node.dataset.counterValue);\n\t}\n\n\tupdateCounter(counterValue): undefined|Object\n\t{\n\t\tconst node = this.container.querySelector('[data-role=\"counter\"]');\n\t\tif (!node)\n\t\t{\n\t\t\treturn;\n\t\t}\n\t\tconst oldValue = parseInt(node.dataset.counterValue) || 0;\n\t\tnode.dataset.counterValue = counterValue;\n\n\t\tif (counterValue > 0)\n\t\t{\n\t\t\tnode.innerHTML = (counterValue > 99 ? '99+' : counterValue);\n\t\t\tthis.container.classList.add('intranet__desktop-menu_item_counters');\n\t\t}\n\t\telse\n\t\t{\n\t\t\tnode.innerHTML = '';\n\t\t\tthis.container.classList.remove('menu-item-with-index');\n\t\t}\n\n\t\treturn {oldValue, newValue: counterValue};\n\t}\n\n\tgetShortName(name): string\n\t{\n\t\tif (!Type.isStringFilled(name))\n\t\t{\n\t\t\treturn \"...\";\n\t\t}\n\n\t\tname = name.replace(/['`\".,:;~|{}*^$#@&+\\-=?!()[\\]<>\\n\\r]+/g, \"\").trim();\n\t\tif (name.length <= 0)\n\t\t{\n\t\t\treturn '...';\n\t\t}\n\n\t\tlet shortName;\n\t\tlet words = name.split(/[\\s,]+/);\n\t\tif (words.length <= 1)\n\t\t{\n\t\t\tshortName = name.substring(0, 1);\n\t\t}\n\t\telse if (words.length === 2)\n\t\t{\n\t\t\tshortName = words[0].substring(0, 1) + words[1].substring(0, 1);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tlet firstWord = words[0];\n\t\t\tlet secondWord = words[1];\n\n\t\t\tfor (let i = 1; i < words.length; i++)\n\t\t\t{\n\t\t\t\tif (words[i].length > 3)\n\t\t\t\t{\n\t\t\t\t\tsecondWord = words[i];\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tshortName = firstWord.substring(0, 1) + secondWord.substring(0, 1);\n\t\t}\n\n\t\treturn shortName.toUpperCase();\n\t}\n}","import Item from './item';\n\nexport default class ItemAdminShared extends Item\n{\n\tstatic code = 'admin';\n}","import Item from './item';\n\nexport default class ItemAdminShared extends Item\n{\n\tstatic code = 'custom';\n}","import Item from './item';\n\nexport default class ItemUserFavorites extends Item\n{\n\tstatic code = 'standard';\n}","import Item from './item';\n\nexport default class ItemUserSelf extends Item\n{\n\tstatic code = 'self';\n}","import Item from './item';\n\nexport default class ItemSystem extends Item\n{\n\tstatic code = 'default';\n}","import Item from './item';\nimport ItemAdminShared from './item-admin-shared';\nimport ItemAdminCustom from './item-admin-custom';\nimport ItemUserFavorites from './item-user-favorites';\nimport ItemUserSelf from './item-user-self';\nimport ItemSystem from './item-system';\n\nconst itemMappings = [\n\tItem,\n\tItemAdminShared,\n\tItemUserFavorites,\n\tItemAdminCustom,\n\tItemUserSelf,\n\tItemSystem,\n];\n\nexport default function getItem(itemData: Element): Item\n{\n\tlet itemClassName = Item;\n\titemMappings.forEach((itemClass) => {\n\t\tif (itemClass.detect(itemData))\n\t\t{\n\t\t\titemClassName = itemClass;\n\t\t}\n\t});\n\treturn itemClassName;\n}","import getItem from '../items';\nimport Item from '../items/item';\nimport { DesktopApi } from 'im.v2.lib.desktop-api';\n\nexport default class ItemsController\n{\n\tparentContainer: Element;\n\tcontainer: Element;\n\titems: Map = new Map();\n\t#updateCountersLastValue = null\n\n\tconstructor(container: Element)\n\t{\n\t\tthis.parentContainer = container;\n\t\tthis.container = container.querySelector(\".menu-items\");\n\n\t\tcontainer\n\t\t\t.querySelectorAll('li.menu-item-block')\n\t\t\t.forEach(this.registerItem.bind(this))\n\t\t;\n\t}\n\n\tregisterItem(node: Element): Item\n\t{\n\t\tconst itemClass = getItem(node);\n\t\tconst item = new itemClass(this.container, node);\n\t\tthis.items.set(item.getId(), item);\n\n\t\treturn item;\n\t}\n\n\tupdateCounters(counters: Object, send: boolean): void\n\t{\n\t\tlet countersDynamic = null;\n\t\tsend = send !== false;\n\t\t[...Object.entries(counters)]\n\t\t\t.forEach(([counterId, counterValue]) => {\n\t\t\t\t[...this.#getItemsByCounterId(counterId)]\n\t\t\t\t\t.forEach((item) => {\n\t\t\t\t\t\tconst {oldValue, newValue} = item.updateCounter(counterValue);\n\n\t\t\t\t\t\tif (\n\t\t\t\t\t\t\t(counterId.indexOf('crm_') < 0 || counterId.indexOf('crm_all') >= 0)\n\t\t\t\t\t\t\t&&\n\t\t\t\t\t\t\t(counterId.indexOf('tasks_') < 0 || counterId.indexOf('tasks_total') >= 0)\n\t\t\t\t\t\t)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tcountersDynamic = countersDynamic || 0;\n\t\t\t\t\t\t\tcountersDynamic+= (newValue - oldValue);\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\t\t\t\t;\n\n\t\t\t\tif (send)\n\t\t\t\t{\n\t\t\t\t\tBX.localStorage.set('lmc-' + counterId, counterValue, 5);\n\t\t\t\t}\n\n\t\t\t\tif (typeof BXIM !== 'undefined')\n\t\t\t\t{\n\t\t\t\t\tif (this.#updateCountersLastValue === null)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.#updateCountersLastValue = 0;\n\t\t\t\t\t\t[...this.items.entries()]\n\t\t\t\t\t\t\t.forEach(([id, item]) => {\n\t\t\t\t\t\t\t\tconst res = item.getCounterValue();\n\n\t\t\t\t\t\t\t\tif (res > 0)\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tlet counterId = 'doesNotMatter';\n\t\t\t\t\t\t\t\t\tif (id.indexOf('menu_crm') >= 0 || id.indexOf('menu_tasks') >= 0)\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tconst counterNode = item.container.querySelector('[data-role=\"counter\"]');\n\t\t\t\t\t\t\t\t\t\tif (counterNode)\n\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\tcounterId = counterNode.id;\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tif (\n\t\t\t\t\t\t\t\t\t\tcounterId === 'doesNotMatter'\n\t\t\t\t\t\t\t\t\t\t|| counterId.indexOf('crm_all') >= 0\n\t\t\t\t\t\t\t\t\t\t|| counterId.indexOf('tasks_total') >= 0\n\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tthis.#updateCountersLastValue += res;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t;\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.#updateCountersLastValue += (countersDynamic !== null ? countersDynamic : 0);\n\t\t\t\t\t}\n\n\t\t\t\t\tconst visibleValue = (this.#updateCountersLastValue > 99 ? '99+' : (\n\t\t\t\t\t\tthis.#updateCountersLastValue < 0 ? '0' : this.#updateCountersLastValue\n\t\t\t\t\t));\n\n\t\t\t\t\tif (DesktopApi.isDesktop())\n\t\t\t\t\t{\n\t\t\t\t\t\tDesktopApi.setBrowserIconBadge(visibleValue);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t})\n\t\t;\n\n\t}\n\n\t#getItemsByCounterId(counterId: string): []\n\t{\n\t\tconst result = [];\n\t\t[...this.items.values()]\n\t\t\t.forEach((item: Item) => {\n\t\t\t\tconst node = item.container.querySelector('[data-role=\"counter\"]');\n\t\t\t\tif (node && node.id.indexOf(counterId) >= 0)\n\t\t\t\t{\n\t\t\t\t\tresult.push(item);\n\t\t\t\t}\n\t\t\t});\n\t\treturn result;\n\t}\n\n\tdecrementCounter(counters: Object): void\n\t{\n\t\t[...Object.entries(counters)]\n\t\t\t.forEach(([counterId, counterValue]) => {\n\t\t\t\tconst item = this.#getItemsByCounterId(counterId).shift();\n\t\t\t\tif (item)\n\t\t\t\t{\n\t\t\t\t\tconst value = item.getCounterValue();\n\t\t\t\t\tcounters[counterId] = value > counterValue ? (value - counterValue) : 0;\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tdelete counters[counterId];\n\t\t\t\t}\n\t\t\t})\n\t\t;\n\t\tthis.updateCounters(counters, false);\n\t}\n}","import {Tag, Type, Text } from 'main.core';\n\nexport class BrowserHistory\n{\n\twrapper: HTMLElement;\n\tisAir: boolean = false;\n\titems = [];\n\n\tconstructor(isAir: boolean)\n\t{\n\t\tthis.isAir = isAir;\n\t\tthis.wrapper = document.getElementById(\"history-items\");\n\t}\n\n\tinit(): void\n\t{\n\t\tif ('object' != typeof BXDesktopSystem)\n\t\t{\n\t\t\tconsole.log('BXDesktopSystem is empty');\n\t\t\treturn;\n\t\t}\n\n\t\tthis.items = BXDesktopSystem?.BrowserHistory();\n\n\t\tthis.showHistory();\n\t}\n\n\tshowHistory(): void\n\t{\n\t\tlet i = 0;\n\t\tthis.items.forEach((item) => {\n\t\t\tif (i > 15) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\tlet icoName = '';\n\t\t\tlet title = '';\n\t\t\tif (Type.isStringFilled(item.title))\n\t\t\t{\n\t\t\t\ticoName = this.getShortName(Text.encode(item.title));\n\t\t\t\ttitle = Text.encode(item.title);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tif (item.url.includes('/desktop_app/'))\n\t\t\t\t{\n\t\t\t\t\ticoName = Loc.getMessage('MENU_HISTORY_ITEM_ICON');\n\t\t\t\t\ttitle = Loc.getMessage('MENU_HISTORY_ITEM_NAME');\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (item.url.includes('/desktop/menu'))\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tlet url = Text.encode(item.url);\n\t\t\tif (!this.isAir && item.url.includes('/online/'))\n\t\t\t{\n\t\t\t\turl = 'bx://v2/' + location.hostname + '/chat/';\n\t\t\t}\n\n\t\t\tlet li = Tag.render`\n\t\t\t\t<li class=\"intranet__desktop-menu_item\">\n\t\t\t\t\t<a class=\"intranet__desktop-menu_item-link\" href=\"${url}\">\n\t\t\t\t\t\t<span class=\"intranet__desktop-menu_item-icon --custom\">${icoName}</span>\n\t\t\t\t\t\t<span class=\"intranet__desktop-menu_item-title\">${title}</span>\n\t\t\t\t\t</a>\n\t\t\t\t</li>\n\t\t\t`;\n\n\t\t\tthis.wrapper.appendChild(li);\n\t\t\ti++;\n\t\t});\n\t}\n\n\tgetShortName(name): string\n\t{\n\t\tif (!Type.isStringFilled(name))\n\t\t{\n\t\t\treturn \"...\";\n\t\t}\n\n\t\tname = name.replace(/['`\".,:;~|{}*^$#@&+\\-=?!()[\\]<>\\n\\r]+/g, \"\").trim();\n\t\tif (name.length <= 0)\n\t\t{\n\t\t\treturn '...';\n\t\t}\n\n\t\tlet shortName;\n\t\tlet words = name.split(/[\\s,]+/);\n\t\tif (words.length <= 1)\n\t\t{\n\t\t\tshortName = name.substring(0, 1);\n\t\t}\n\t\telse if (words.length === 2)\n\t\t{\n\t\t\tshortName = words[0].substring(0, 1) + words[1].substring(0, 1);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tlet firstWord = words[0];\n\t\t\tlet secondWord = words[1];\n\n\t\t\tfor (let i = 1; i < words.length; i++)\n\t\t\t{\n\t\t\t\tif (words[i].length > 3)\n\t\t\t\t{\n\t\t\t\t\tsecondWord = words[i];\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tshortName = firstWord.substring(0, 1) + secondWord.substring(0, 1);\n\t\t}\n\n\t\treturn shortName.toUpperCase();\n\t}\n\n}\n","import {Cache, Type, Loc} from 'main.core';\nimport { Account } from './account/account';\nimport Theme from './api/theme';\nimport Counters from './api/counters';\nimport ItemsController from './controllers/items-controller'\nimport { BrowserHistory } from './history/browser-history';\n\nexport default class DesktopMenu\n{\n\tcache = new Cache.MemoryCache();\n\tbrowserHistory = null;\n\taccount = null;\n\ttheme = null;\n\t#specialLiveFeedDecrement = 0;\n\n\tconstructor(allCounters: Object, isAir: boolean)\n\t{\n\t\tthis.menuContainer = document.getElementById(\"menu-items-block\");\n\t\tif (!this.menuContainer)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tthis.initTheme();\n\t\tthis.getItemsController();\n\t\tthis.getHistoryItems(isAir);\n\t\tthis.showAccount(allCounters);\n\t\tthis.runAPICounters();\n\t}\n\n\tinitTheme(): void\n\t{\n\t\tthis.theme = new Theme();\n\t}\n\n\tgetItemsController(): ItemsController\n\t{\n\t\treturn this.cache.remember('itemsMenuController', () => {\n\t\t\treturn new ItemsController(this.menuContainer);\n\t\t});\n\t}\n\n\tgetHistoryItems(isAir: boolean): void\n\t{\n\t\tthis.browserHistory = new BrowserHistory(isAir);\n\t\tthis.browserHistory.init();\n\t}\n\n\tshowAccount(allCounters): void\n\t{\n\t\tthis.account = new Account(allCounters);\n\t\tBX.Intranet.Account = this.account;\n\t}\n\n\trunAPICounters(): void\n\t{\n\t\tBX.Intranet.Counters = new Counters();\n\t\tBX.Intranet.Counters.init();\n\t}\n\n\tdecrementCounter(node, iDecrement): void\n\t{\n\t\tif (!node || node.id !== 'menu-counter-live-feed')\n\t\t{\n\t\t\treturn;\n\t\t}\n\t\tthis.#specialLiveFeedDecrement += parseInt(iDecrement);\n\t\tthis.getItemsController().decrementCounter({\n\t\t\t'live-feed' : parseInt(iDecrement)\n\t\t});\n\t}\n\n\tupdateCounters(counters, send): void\n\t{\n\t\tif (!counters)\n\t\t{\n\t\t\treturn;\n\t\t}\n\t\tif (counters['**'] !== undefined)\n\t\t{\n\t\t\tcounters['live-feed'] = counters['**'];\n\t\t\tdelete counters['**'];\n\t\t}\n\n\t\tif (counters['live-feed'])\n\t\t{\n\t\t\tif (counters['live-feed'] <= 0)\n\t\t\t{\n\t\t\t\tthis.#specialLiveFeedDecrement = 0;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tcounters['live-feed'] -= this.#specialLiveFeedDecrement;\n\t\t\t}\n\t\t}\n\n\t\tthis.getItemsController().updateCounters(counters, send);\n\t\tBX.Intranet.Account.setCounters(counters);\n\t}\n}"],"names":["Account","constructor","allCounters","accounts","currentUser","contextPopup","popup","wrapper","document","getElementById","checkCounters","reload","viewDesktopUser","initPopup","counterId","Object","keys","key","getSumCounters","sum","val","parseInt","getTabUses","BXDesktopSystem","TabList","currentUserId","Loc","getMessage","DesktopApi","getAccountList","find","account","id","portal","location","hostname","viewPopupAccounts","userNode","querySelector","Popup","content","bindElement","width","background","closeIcon","closeByEsc","Event","bind","isShown","close","show","setCounters","counters","newCounters","data","cId","sumCounters","block","getElementsByClassName","counterNode","innerHTML","Dom","hasClass","addClass","removeElements","className","elements","forEach","element","remove","counterBlock","countersView","Tag","render","userData","work_position","append","avatar","previewImage","getAvatarUrl","style","avatarUrl","includes","protocol","BX","util","htmlspecialchars","defaultAvatar","defaultAvatarDesctop","menuPopup","position","item","first_name","last_name","insertBefore","firstElementChild","index","users","currentUserClass","currentUserConnected","isSelected","some","x","login","children","addContextMenu","userAvatar","previewUserImage","button","destroy","Menu","items","text","onclick","event","host","AccountDisconnect","userLang","navigator","language","connectAccount","userChoice","showDesktopDeleteConfirm","deleteAccount","PopupManager","getPopupById","PopupType","userProfile","target","replace","openLoginTab","openAddAccountTab","Theme","backgroundNode","theme","getAppliedTheme","EventEmitter","subscribe","Intranet","Bitrix24","ThemePicker","Singleton","top","video","removeClass","themeClass","String","indexOf","bgImage","Type","isArrayFilled","prefetchImages","length","imageUrl","Text","encode","sources","type","push","create","attrs","src","props","dataset","themeId","poster","autoplay","loop","muted","playsinline","prepend","Counters","init","command","params","getCompatData","updateCounters","addCustomEvent","Number","userId","isUndefined","projects_major","scrum_total_comments","counter","browser","SupportLocalStorage","window","substring","value","decrement","decrementCounter","send","ready","getClass","DescktopLeftMenu","node","iDecrement","Item","parentContainer","container","makeTextIcons","getId","getCode","code","getName","textContent","detect","getAttribute","classList","contains","icon","getShortName","getCounterValue","counterValue","updateCounter","oldValue","add","newValue","name","isStringFilled","trim","shortName","words","split","firstWord","secondWord","i","toUpperCase","ItemAdminShared","ItemUserFavorites","ItemUserSelf","ItemSystem","itemMappings","ItemAdminCustom","getItem","itemData","itemClassName","itemClass","ItemsController","Map","querySelectorAll","registerItem","set","countersDynamic","entries","localStorage","BXIM","res","visibleValue","isDesktop","setBrowserIconBadge","shift","result","values","BrowserHistory","isAir","console","log","showHistory","icoName","title","url","li","appendChild","DesktopMenu","cache","Cache","MemoryCache","browserHistory","menuContainer","initTheme","getItemsController","getHistoryItems","showAccount","runAPICounters","remember","undefined"],"mappings":"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"}