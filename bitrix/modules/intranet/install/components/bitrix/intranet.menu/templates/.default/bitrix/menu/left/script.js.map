{"version":3,"file":"script.js","sources":["src/account/account.js","src/api/theme.js","src/api/counters.js","src/items/item.js","src/items/item-admin-shared.js","src/items/item-admin-custom.js","src/items/item-user-favorites.js","src/items/item-user-self.js","src/items/item-system.js","src/items/index.js","src/controllers/items-controller.js","src/history/browser-history.js","src/desktop-menu.js"],"sourcesContent":["import { Dom, Text, Event, Loc, Tag } from 'main.core';\nimport { DesktopApi, DesktopAccount } from 'im.v2.lib.desktop-api';\nimport { showDesktopDeleteConfirm } from 'im.v2.lib.confirm';\nimport {Menu, Popup} from 'main.popup';\nimport { PopupManager } from 'main.popup';\nimport { PopupType } from 'im.v2.const';\nexport class Account\n{\n\tstatic defaultAvatar = '/bitrix/js/im/images/blank.gif';\n\tstatic defaultAvatarDesctop = '/bitrix/js/ui/icons/b24/images/ui-user.svg?v2';\n\taccounts: DesktopAccount[] = [];\n\tcurrentUser: ?Object = null;\n\tcontextPopup: BX.Main.Popup[] = [];\n\tpopup: BX.Main.Popup = null;\n\tallCounters: Object = {};\n\twrapper: HTMLElement = null;\n\n\tconstructor(allCounters: Object)\n\t{\n\t\tthis.wrapper = document.getElementById(\"history-items\");\n\n\t\tthis.checkCounters(allCounters);\n\t\tthis.reload();\n\n\t\tthis.viewDesktopUser();\n\t\tthis.initPopup();\n\t}\n\n\tcheckCounters(allCounters: Object): void\n\t{\n\t\tfor (let counterId of Object.keys(allCounters))\n\t\t{\n\t\t\tlet key = counterId;\n\t\t\tif (counterId === '**') {\n\t\t\t\tkey = 'live-feed';\n\t\t\t}\n\t\t\tthis.allCounters[key] = allCounters[counterId];\n\t\t}\n\t}\n\n\tgetSumCounters(): number\n\t{\n\t\tlet sum = 0;\n\t\tfor (const counterId of Object.keys(this.allCounters))\n\t\t{\n\t\t\tif (counterId === 'tasks_effective' || counterId === 'invited_users')\n\t\t\t{\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tconst val = this.allCounters[counterId] ? parseInt(this.allCounters[counterId], 10) : 0;\n\t\t\tsum += val;\n\t\t}\n\n\t\treturn sum;\n\t}\n\n\treload(): void\n\t{\n\t\tconst currentUserId = Loc.getMessage('USER_ID');\n\t\tthis.accounts = ('undefined' !== typeof BXDesktopSystem) ? DesktopApi.getAccountList() : [];\n\t\tthis.currentUser = this.accounts.find((account) => account.id === currentUserId && account.portal === location.hostname);\n\n\t\tthis.viewPopupAccounts();\n\t}\n\n\tinitPopup(): void\n\t{\n\t\tconst userNode = document.querySelector('.intranet__desktop-menu_user-block');\n\t\tthis.popup = new Popup({\n\t\t\tcontent: document.querySelector('.intranet__desktop-menu_popup'),\n\t\t\tbindElement: userNode,\n\t\t\twidth: 320,\n\t\t\tbackground: '#282e39',\n\t\t\tcloseIcon: true,\n\t\t\tcloseByEsc: true,\n\t\t});\n\n\t\tEvent.bind(userNode, 'click', () => {\n\t\t\tif (this.popup.isShown())\n\t\t\t{\n\t\t\t\tthis.popup.close();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.popup.show();\n\t\t\t\tthis.reload();\n\t\t\t}\n\t\t});\n\t}\n\n\tsetCounters(counters: Object): void\n\t{\n\t\tlet newCounters = counters;\n\t\tif (counters['data'])\n\t\t{\n\t\t\tnewCounters = counters.data;\n\t\t\tif (newCounters[0] && typeof newCounters[0] === 'object')\n\t\t\t{\n\t\t\t\tnewCounters = newCounters[0];\n\t\t\t}\n\t\t}\n\n\t\tfor (let counterId of Object.keys(newCounters))\n\t\t{\n\t\t\tlet cId = counterId\n\t\t\tif (counterId === '**') {\n\t\t\t\tcId = 'live-feed';\n\t\t\t}\n\t\t\tthis.allCounters[cId] = newCounters[counterId];\n\t\t}\n\n\t\tconst sumCounters = this.getSumCounters();\n\t\tconst block = document.getElementsByClassName('intranet__desktop-menu_user-block')[0];\n\t\tconst counterNode = block.querySelector('[data-role=\"counter\"]');\n\t\tif (sumCounters > 0)\n\t\t{\n\t\t\tcounterNode.innerHTML = sumCounters > 99 ? '99+' : sumCounters;\n\t\t\tif (!Dom.hasClass(block, 'intranet__desktop-menu_item_counters'))\n\t\t\t{\n\t\t\t\tDom.addClass(block, 'intranet__desktop-menu_item_counters');\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tcounterNode.innerHTML = '';\n\t\t\tDom.addClass(block, 'intranet__desktop-menu_item_counters');\n\t\t}\n\t}\n\n\tremoveElements(className: string): void\n\t{\n\t\tconst elements = document.getElementsByClassName(className);\n\n\t\t[...elements].forEach(element => {\n\t\t\telement.remove();\n\t\t});\n\t}\n\n\tviewDesktopUser(): void\n\t{\n\t\tconst block = document.getElementsByClassName('intranet__desktop-menu_user')[0];\n\t\tconst counters = this.getSumCounters();\n\t\tconst countersView = counters > 99 ? '99+' : counters;\n\t\tthis.removeElements('intranet__desktop-menu_user-block');\n\n\t\tlet userData = Tag.render`<div class=\"intranet__desktop-menu_user-block ${ counters > 0 ? 'intranet__desktop-menu_item_counters' : ''}\">\n\t\t\t\t<span class=\"intranet__desktop-menu_user-avatar ui-icon ui-icon-common-user ui-icon-common-user-desktop\">\n\t\t\t\t\t<i></i>\n\t\t\t\t\t<div class=\"intranet__desktop-menu_user-counter ui-counter ui-counter-md ui-counter-danger\">\n\t\t\t\t\t\t<div class=\"ui-counter-inner\" data-role=\"counter\">${countersView}</div>\n\t\t\t\t\t</div>\n\t\t\t\t</span>\n\t\t\t\t<span class=\"intranet__desktop-menu_user-inner\">\n\t\t\t\t\t<span class=\"intranet__desktop-menu_user-name\">${this.currentUser.portal}</span>\n\t\t\t\t\t<span class=\"intranet__desktop-menu_user-post\">${this.currentUser.work_position}</span>\n\t\t\t\t</span>\n\t\t\t</div>`;\n\n\t\tDom.append(userData, block);\n\n\t\tconst avatar = document.getElementsByClassName('ui-icon-common-user-desktop')[0];\n\t\tconst previewImage = this.getAvatarUrl(this.currentUser);\n\t\tDom.style(avatar, '--ui-icon-service-bg-image', previewImage);\n\t}\n\n\tgetAvatarUrl(account): string\n\t{\n\t\tlet avatarUrl = '';\n\t\tif (account.avatar.includes('http://') || account.avatar.includes('https://'))\n\t\t{\n\t\t\tavatarUrl = account.avatar;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tavatarUrl = account.protocol + '://' + account.portal + account.avatar;\n\t\t}\n\n\t\treturn `url('${Text.encode(account.avatar === Account.defaultAvatar ? Account.defaultAvatarDesctop : avatarUrl)}')`;\n\t}\n\n\tviewPopupAccounts(): void\n\t{\n\t\tconst menuPopup = document.getElementsByClassName('intranet__desktop-menu_popup')[0];\n\t\tlet position = '';\n\t\tif (this.currentUser.work_position !== '')\n\t\t{\n\t\t\tposition = `<span class=\"intranet__desktop-menu_popup-post\">${this.currentUser.work_position}</span>`;\n\t\t}\n\n\t\tthis.removeElements('intranet__desktop-menu_popup-header');\n\n\t\tlet item = Tag.render`<div class=\"intranet__desktop-menu_popup-header\">\n\t\t\t<span class=\"intranet__desktop-menu_user-avatar ui-icon ui-icon-common-user ui-icon-common-user-popup\">\n\t\t\t\t<i></i>\n\t\t\t</span>\n\t\t\t<span class=\"intranet__desktop-menu_popup-label\">${this.currentUser.portal}</span>\n\t\t\t<div class=\"intranet__desktop-menu_popup-header-user\">\n\t\t\t\t<span class=\"intranet__desktop-menu_popup-name\">${this.currentUser.first_name + ' ' + this.currentUser.last_name}</span>\n\t\t\t\t${position}\n\t\t\t</div>\n\t\t</div>`;\n\n\t\tDom.insertBefore(item, menuPopup.firstElementChild);\n\n\t\tconst avatar = document.getElementsByClassName('ui-icon-common-user-popup')[0];\n\t\tconst previewImage = this.getAvatarUrl(this.currentUser);\n\t\tDom.style(avatar, '--ui-icon-service-bg-image', previewImage);\n\n\t\tconst block = document.getElementsByClassName('intranet__desktop-menu_popup-list')[0];\n\n\t\tthis.removeElements('intranet__desktop-menu_popup-item-account');\n\n\t\tlet index = 0;\n\t\tfor (let account of this.accounts)\n\t\t{\n\t\t\tlet currentUserClass = '';\n\t\t\tlet counters = 0;\n\t\t\tif (account.id === this.currentUser.id && account.portal === this.currentUser.portal)\n\t\t\t{\n\t\t\t\tcounters = this.getSumCounters();\n\t\t\t\tcurrentUserClass = '--selected';\n\t\t\t}\n\t\t\tconst countersView = counters > 99 ? '99+' : counters;\n\n\t\t\tlet item = Tag.render`<li class=\"intranet__desktop-menu_popup-item intranet__desktop-menu_popup-item-account ${ counters > 0 ? 'intranet__desktop-menu_item_counters' : ''} ${currentUserClass}\">\n\t\t\t\t\t<span class=\"intranet__desktop-menu_user-avatar ui-icon ui-icon-common-user ui-icon-common-user-${index}\">\n\t\t\t\t\t\t<i></i>\n\t\t\t\t\t\t<div class=\"intranet__desktop-menu_user-counter ui-counter ui-counter-md ui-counter-danger\">\n\t\t\t\t\t\t\t<div class=\"ui-counter-inner\">${countersView}</div>\n\t\t\t\t\t\t</div>\t\n\t\t\t\t\t</span>\n\t\t\t\t\t<span class=\"intranet__desktop-menu_popup-user\">\n\t\t\t\t\t\t<span class=\"intranet__desktop-menu_popup-name\">${account.portal}</span>\n\t\t\t\t\t\t<span class=\"intranet__desktop-menu_popup-post\">${account.login}</span>\n\t\t\t\t\t</span>\n\t\t\t\t\t<span class=\"intranet__desktop-menu_popup-btn ui-icon-set --more\" id=\"ui-icon-set-${index}\"></span>\n\t\t\t\t</li>`;\n\n\t\t\tDom.insertBefore(item, block.children[index]);\n\n\t\t\tthis.addContextMenu(account, index);\n\n\t\t\tlet userAvatar = document.getElementsByClassName('ui-icon-common-user-' + index)[0];\n\t\t\tlet previewUserImage = this.getAvatarUrl(account);\n\t\t\tDom.style(userAvatar, '--ui-icon-service-bg-image', previewUserImage);\n\n\t\t\tindex++;\n\t\t}\n\t}\n\n\taddContextMenu(account: DesktopAccount, index: number): void\n\t{\n\t\tconst button = document.getElementById(`ui-icon-set-${index}`);\n\t\tconst popup = this.popup;\n\t\tconst contextPopup = this.contextPopup;\n\t\tif (contextPopup[index])\n\t\t{\n\t\t\tcontextPopup[index].destroy();\n\t\t}\n\t\tcontextPopup[index] = new Menu({\n\t\t\tbindElement: button,\n\t\t\tclassName: 'intranet__desktop-menu_context',\n\t\t\titems: [\n\t\t\t\taccount.id === this.currentUser.id && account.portal === this.currentUser.portal ?\n\t\t\t\t\t{\n\t\t\t\t\t\ttext: Loc.getMessage('MENU_ACCOUNT_POPUP_DISCONNECT'),\n\t\t\t\t\t\tonclick: function(event, item) {\n\t\t\t\t\t\t\tconst { host } = account;\n\t\t\t\t\t\t\tBXDesktopSystem?.AccountDisconnect(host);\n\t\t\t\t\t\t\tif (contextPopup[index])\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tcontextPopup[index].close();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tpopup.close();\n\t\t\t\t\t\t},\n\t\t\t\t\t}\n\t\t\t\t\t:\n\t\t\t\t\t{\n\t\t\t\t\t\ttext: Loc.getMessage('MENU_ACCOUNT_POPUP_CONNECT'),\n\t\t\t\t\t\tonclick: function(event, item) {\n\t\t\t\t\t\t\tconst { host, login, protocol } = account;\n\t\t\t\t\t\t\tconst userLang = navigator.language;\n\t\t\t\t\t\t\tDesktopApi.connectAccount(host, login, protocol, userLang);\n\t\t\t\t\t\t\tif (contextPopup[index])\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tcontextPopup[index].close();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tpopup.close();\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\ttext: Loc.getMessage('MENU_ACCOUNT_POPUP_REMOVE'),\n\t\t\t\t\tonclick: async function(event, item) {\n\t\t\t\t\t\tconst userChoice = await showDesktopDeleteConfirm();\n\t\t\t\t\t\tif (userChoice === true)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tconst { host, login } = account;\n\t\t\t\t\t\t\tDesktopApi.deleteAccount(host, login);\n\n\t\t\t\t\t\t\tPopupManager.getPopupById(PopupType.userProfile)?.close();\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (contextPopup[index])\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tcontextPopup[index].close();\n\t\t\t\t\t\t}\n\t\t\t\t\t\tpopup.close();\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t],\n\t\t});\n\n\t\tEvent.bind(button, 'click', (event) => {\n\t\t\tconst index: number = parseInt(event.target.id.replace('ui-icon-set-', ''));\n\t\t\tif (contextPopup[index])\n\t\t\t{\n\t\t\t\tcontextPopup[index].show();\n\t\t\t}\n\t\t});\n\t}\n\n\topenLoginTab(): void\n\t{\n\t\tDesktopApi.openAddAccountTab();\n\t}\n}","import { Dom, Text, Type } from 'main.core';\nimport { EventEmitter } from 'main.core.events';\n\nexport default class Theme\n{\n\tbackgroundNode: Element = null;\n\n\tconstructor() {\n\t\tconst theme: any = this.#getThemePicker()?.getAppliedTheme();\n\t\tthis.backgroundNode = document.querySelector('body');\n\n\t\tif (theme)\n\t\t{\n\t\t\tthis.#applyTheme(theme);\n\t\t}\n\n\t\tEventEmitter.subscribe(\n\t\t\t'BX.Intranet.Bitrix24:ThemePicker:onThemeApply',\n\t\t\t(event) => {\n\t\t\t\tthis.#applyTheme(event.data.theme);\n\t\t\t},\n\t\t);\n\t}\n\n\t#getThemePicker(): ?BX.Intranet.Bitrix24.ThemePicker\n\t{\n\t\treturn BX.Intranet?.Bitrix24?.ThemePicker.Singleton ?? top.BX.Intranet?.Bitrix24?.ThemePicker.Singleton;\n\t}\n\n\t#applyTheme(theme: any): void\n\t{\n\t\ttheme.video ? this.#applyVideoTheme(theme) : this.#applyPictureTheme(theme);\n\n\t\tDom.removeClass(this.backgroundNode, 'bitrix24-theme-default bitrix24-theme-dark bitrix24-theme-light');\n\t\tlet themeClass = 'bitrix24-theme-default';\n\n\t\tif (theme.id !== 'default' && String(theme.id).indexOf('default:') !== 0)\n\t\t{\n\t\t\tthemeClass = String(theme.id).indexOf('dark:') === 0 ? 'bitrix24-theme-dark' : 'bitrix24-theme-light';\n\t\t}\n\n\t\tDom.addClass(this.backgroundNode, themeClass);\n\t}\n\n\t#applyPictureTheme(theme: any): void\n\t{\n\t\tlet bgImage = theme.previewImage;\n\t\tif (Type.isArrayFilled(theme.prefetchImages))\n\t\t{\n\t\t\tbgImage = theme.prefetchImages[theme.prefetchImages.length - 1];\n\t\t}\n\t\tconst imageUrl = `url('${Text.encode(bgImage)}')`;\n\t\tDom.style(this.backgroundNode, 'backgroundImage', imageUrl);\n\t}\n\n\t#applyVideoTheme(theme: any): void\n\t{\n\t\tconst sources = [];\n\t\tfor (let type in theme.video.sources)\n\t\t{\n\t\t\tsources.push(BX.create('source', {\n\t\t\t\tattrs: {\n\t\t\t\t\ttype: `video/${type}`,\n\t\t\t\t\tsrc: theme.video.sources[type],\n\t\t\t\t},\n\t\t\t}));\n\t\t}\n\n\t\tconst video = Dom.create('div', {\n\t\t\tprops: {\n\t\t\t\tclassName: 'theme-video-container',\n\t\t\t},\n\t\t\tdataset: {\n\t\t\t\tthemeId: theme.id,\n\t\t\t},\n\t\t\tchildren: [\n\t\t\t\tDom.create('video', {\n\t\t\t\t\tprops: {\n\t\t\t\t\t\tclassName: 'theme-video',\n\t\t\t\t\t},\n\t\t\t\t\tattrs: {\n\t\t\t\t\t\tposter: theme.video.poster,\n\t\t\t\t\t\tautoplay: true,\n\t\t\t\t\t\tloop: true,\n\t\t\t\t\t\tmuted: true,\n\t\t\t\t\t\tplaysinline: true,\n\t\t\t\t\t},\n\t\t\t\t\tdataset: {\n\t\t\t\t\t\tthemeId: theme.id,\n\t\t\t\t\t},\n\t\t\t\t\tchildren: sources,\n\t\t\t\t}),\n\t\t\t],\n\t\t});\n\n\t\tDom.prepend(video, this.backgroundNode);\n\t}\n}","export default class Counters\n{\n\tinit()\n\t{\n\t\tBX.addCustomEvent(\"onPullEvent-main\", (command,params) => {\n\t\t\tconst key = 'SITE_ID';\n\t\t\tconst siteId = BX.message(key);\n\t\t\tif (command === \"user_counter\" && params[siteId])\n\t\t\t{\n\t\t\t\tlet counters = BX.clone(params[siteId]);\n\t\t\t\tthis.updateCounters(counters, false);\n\t\t\t}\n\t\t});\n\n\t\tBX.addCustomEvent(\"onPullEvent-tasks\", (command, params) => {\n\t\t\tif (\n\t\t\t\tcommand === \"user_counter\"\n\t\t\t\t&& Number(params.userId) === Number(BX.Loc.getMessage('USER_ID'))\n\t\t\t)\n\t\t\t{\n\t\t\t\tlet counters = {};\n\t\t\t\tif (!BX.Type.isUndefined(params.projects_major))\n\t\t\t\t{\n\t\t\t\t\tcounters.projects_major = params.projects_major;\n\t\t\t\t}\n\t\t\t\tif (!BX.Type.isUndefined(params.scrum_total_comments))\n\t\t\t\t{\n\t\t\t\t\tcounters.scrum_total_comments = params.scrum_total_comments;\n\t\t\t\t}\n\n\t\t\t\tthis.updateCounters(counters, false);\n\t\t\t}\n\t\t});\n\n\t\tBX.addCustomEvent(window, \"onImUpdateCounter\", (counters) => {\n\n\t\t\tif (!counters)\n\t\t\t\treturn;\n\n\t\t\tthis.updateCounters(BX.clone(counters), false);\n\t\t});\n\n\t\tBX.addCustomEvent(\"onImUpdateCounterMessage\",(counter) => {\n\t\t\tthis.updateCounters({'im-message': counter}, false);\n\t\t});\n\n\t\tif (BX.browser.SupportLocalStorage())\n\t\t{\n\t\t\tBX.addCustomEvent(window, 'onLocalStorageSet', (params) =>\n\t\t\t{\n\t\t\t\tif (params.key.substring(0, 4) === 'lmc-')\n\t\t\t\t{\n\t\t\t\t\tlet counters = {};\n\t\t\t\t\tcounters[params.key.substring(4)] = params.value;\n\t\t\t\t\tthis.updateCounters(counters, false);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tBX.addCustomEvent(\"onCounterDecrement\", (iDecrement) => {\n\t\t\tthis.decrementCounter(BX(\"menu-counter-live-feed\"), iDecrement)\n\t\t});\n\t}\n\n\tupdateCounters(counters, send)\n\t{\n\t\tBX.ready(function ()\n\t\t{\n\t\t\tif (BX.getClass(\"BX.Intranet.DescktopLeftMenu\"))\n\t\t\t{\n\t\t\t\tBX.Intranet.DescktopLeftMenu.updateCounters(counters, send);\n\t\t\t}\n\t\t});\n\t}\n\n\tdecrementCounter(node, iDecrement)\n\t{\n\t\tBX.ready(function ()\n\t\t{\n\t\t\tif (BX.getClass(\"BX.Intranet.DescktopLeftMenu\"))\n\t\t\t{\n\t\t\t\tBX.Intranet.DescktopLeftMenu.decrementCounter(node, iDecrement);\n\t\t\t}\n\t\t});\n\t}\n}\n","import {Type} from 'main.core';\n\nexport default class Item\n{\n\tparentContainer: Element;\n\tcontainer: Element;\n\n\tconstructor(parentContainer, container)\n\t{\n\t\tthis.parentContainer = parentContainer;\n\t\tthis.container = container;\n\t\tthis.init();\n\t}\n\n\tinit(): void\n\t{\n\t\tthis.makeTextIcons();\n\t}\n\n\tgetId(): string\n\t{\n\t\treturn this.container.dataset.id;\n\t}\n\n\tgetCode(): string\n\t{\n\t\treturn this.constructor.code;\n\t}\n\n\tgetName(): string\n\t{\n\t\treturn this.container.querySelector(\"[data-role='item-text']\").textContent;\n\t}\n\n\tstatic detect(node: Element)\n\t{\n\t\treturn node.getAttribute(\"data-role\") !== 'group' &&\n\t\t\tnode.getAttribute(\"data-type\") === this.code;\n\t}\n\n\tmakeTextIcons(): void\n\t{\n\t\tif (!this.container.classList.contains(\"menu-item-no-icon-state\"))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst icon = this.container.querySelector(\".menu-item-icon\");\n\t\tconst text = this.container.querySelector(\".menu-item-link-text\");\n\n\t\tif (icon && text)\n\t\t{\n\t\t\ticon.textContent = this.getShortName(text.textContent);\n\t\t}\n\t}\n\n\tgetCounterValue(): ?number\n\t{\n\t\tconst node = this.container.querySelector('[data-role=\"counter\"]');\n\t\tif (!node)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\t\treturn parseInt(node.dataset.counterValue);\n\t}\n\n\tupdateCounter(counterValue): undefined|Object\n\t{\n\t\tconst node = this.container.querySelector('[data-role=\"counter\"]');\n\t\tif (!node)\n\t\t{\n\t\t\treturn;\n\t\t}\n\t\tconst oldValue = parseInt(node.dataset.counterValue) || 0;\n\t\tnode.dataset.counterValue = counterValue;\n\n\t\tif (counterValue > 0)\n\t\t{\n\t\t\tnode.innerHTML = (counterValue > 99 ? '99+' : counterValue);\n\t\t\tthis.container.classList.add('intranet__desktop-menu_item_counters');\n\t\t}\n\t\telse\n\t\t{\n\t\t\tnode.innerHTML = '';\n\t\t\tthis.container.classList.remove('menu-item-with-index');\n\t\t}\n\n\t\treturn {oldValue, newValue: counterValue};\n\t}\n\n\tgetShortName(name): string\n\t{\n\t\tif (!Type.isStringFilled(name))\n\t\t{\n\t\t\treturn \"...\";\n\t\t}\n\n\t\tname = name.replace(/['`\".,:;~|{}*^$#@&+\\-=?!()[\\]<>\\n\\r]+/g, \"\").trim();\n\t\tif (name.length <= 0)\n\t\t{\n\t\t\treturn '...';\n\t\t}\n\n\t\tlet shortName;\n\t\tlet words = name.split(/[\\s,]+/);\n\t\tif (words.length <= 1)\n\t\t{\n\t\t\tshortName = name.substring(0, 1);\n\t\t}\n\t\telse if (words.length === 2)\n\t\t{\n\t\t\tshortName = words[0].substring(0, 1) + words[1].substring(0, 1);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tlet firstWord = words[0];\n\t\t\tlet secondWord = words[1];\n\n\t\t\tfor (let i = 1; i < words.length; i++)\n\t\t\t{\n\t\t\t\tif (words[i].length > 3)\n\t\t\t\t{\n\t\t\t\t\tsecondWord = words[i];\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tshortName = firstWord.substring(0, 1) + secondWord.substring(0, 1);\n\t\t}\n\n\t\treturn shortName.toUpperCase();\n\t}\n}","import Item from './item';\n\nexport default class ItemAdminShared extends Item\n{\n\tstatic code = 'admin';\n}","import Item from './item';\n\nexport default class ItemAdminShared extends Item\n{\n\tstatic code = 'custom';\n}","import Item from './item';\n\nexport default class ItemUserFavorites extends Item\n{\n\tstatic code = 'standard';\n}","import Item from './item';\n\nexport default class ItemUserSelf extends Item\n{\n\tstatic code = 'self';\n}","import Item from './item';\n\nexport default class ItemSystem extends Item\n{\n\tstatic code = 'default';\n}","import Item from './item';\nimport ItemAdminShared from './item-admin-shared';\nimport ItemAdminCustom from './item-admin-custom';\nimport ItemUserFavorites from './item-user-favorites';\nimport ItemUserSelf from './item-user-self';\nimport ItemSystem from './item-system';\n\nconst itemMappings = [\n\tItem,\n\tItemAdminShared,\n\tItemUserFavorites,\n\tItemAdminCustom,\n\tItemUserSelf,\n\tItemSystem,\n];\n\nexport default function getItem(itemData: Element): Item\n{\n\tlet itemClassName = Item;\n\titemMappings.forEach((itemClass) => {\n\t\tif (itemClass.detect(itemData))\n\t\t{\n\t\t\titemClassName = itemClass;\n\t\t}\n\t});\n\treturn itemClassName;\n}","import getItem from '../items';\nimport Item from '../items/item';\nimport { DesktopApi } from 'im.v2.lib.desktop-api';\n\nexport default class ItemsController\n{\n\tparentContainer: Element;\n\tcontainer: Element;\n\titems: Map = new Map();\n\t#updateCountersLastValue = null\n\n\tconstructor(container: Element)\n\t{\n\t\tthis.parentContainer = container;\n\t\tthis.container = container.querySelector(\".menu-items\");\n\n\t\tcontainer\n\t\t\t.querySelectorAll('li.menu-item-block')\n\t\t\t.forEach(this.registerItem.bind(this))\n\t\t;\n\t}\n\n\tregisterItem(node: Element): Item\n\t{\n\t\tconst itemClass = getItem(node);\n\t\tconst item = new itemClass(this.container, node);\n\t\tthis.items.set(item.getId(), item);\n\n\t\treturn item;\n\t}\n\n\tupdateCounters(counters: Object, send: boolean): void\n\t{\n\t\tlet countersDynamic = null;\n\t\tsend = send !== false;\n\t\t[...Object.entries(counters)]\n\t\t\t.forEach(([counterId, counterValue]) => {\n\t\t\t\t[...this.#getItemsByCounterId(counterId)]\n\t\t\t\t\t.forEach((item) => {\n\t\t\t\t\t\tconst {oldValue, newValue} = item.updateCounter(counterValue);\n\n\t\t\t\t\t\tif (\n\t\t\t\t\t\t\t(counterId.indexOf('crm_') < 0 || counterId.indexOf('crm_all') >= 0)\n\t\t\t\t\t\t\t&&\n\t\t\t\t\t\t\t(counterId.indexOf('tasks_') < 0 || counterId.indexOf('tasks_total') >= 0)\n\t\t\t\t\t\t)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tcountersDynamic = countersDynamic || 0;\n\t\t\t\t\t\t\tcountersDynamic+= (newValue - oldValue);\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\t\t\t\t;\n\n\t\t\t\tif (send)\n\t\t\t\t{\n\t\t\t\t\tBX.localStorage.set('lmc-' + counterId, counterValue, 5);\n\t\t\t\t}\n\n\t\t\t\tif (typeof BXIM !== 'undefined')\n\t\t\t\t{\n\t\t\t\t\tif (this.#updateCountersLastValue === null)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.#updateCountersLastValue = 0;\n\t\t\t\t\t\t[...this.items.entries()]\n\t\t\t\t\t\t\t.forEach(([id, item]) => {\n\t\t\t\t\t\t\t\tconst res = item.getCounterValue();\n\n\t\t\t\t\t\t\t\tif (res > 0)\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tlet counterId = 'doesNotMatter';\n\t\t\t\t\t\t\t\t\tif (id.indexOf('menu_crm') >= 0 || id.indexOf('menu_tasks') >= 0)\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tconst counterNode = item.container.querySelector('[data-role=\"counter\"]');\n\t\t\t\t\t\t\t\t\t\tif (counterNode)\n\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\tcounterId = counterNode.id;\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tif (\n\t\t\t\t\t\t\t\t\t\tcounterId === 'doesNotMatter'\n\t\t\t\t\t\t\t\t\t\t|| counterId.indexOf('crm_all') >= 0\n\t\t\t\t\t\t\t\t\t\t|| counterId.indexOf('tasks_total') >= 0\n\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tthis.#updateCountersLastValue += res;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t;\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.#updateCountersLastValue += (countersDynamic !== null ? countersDynamic : 0);\n\t\t\t\t\t}\n\n\t\t\t\t\tconst visibleValue = (this.#updateCountersLastValue > 99 ? '99+' : (\n\t\t\t\t\t\tthis.#updateCountersLastValue < 0 ? '0' : this.#updateCountersLastValue\n\t\t\t\t\t));\n\n\t\t\t\t\tif (DesktopApi.isDesktop())\n\t\t\t\t\t{\n\t\t\t\t\t\tDesktopApi.setBrowserIconBadge(visibleValue);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t})\n\t\t;\n\n\t}\n\n\t#getItemsByCounterId(counterId: string): []\n\t{\n\t\tconst result = [];\n\t\t[...this.items.values()]\n\t\t\t.forEach((item: Item) => {\n\t\t\t\tconst node = item.container.querySelector('[data-role=\"counter\"]');\n\t\t\t\tif (node && node.id.indexOf(counterId) >= 0)\n\t\t\t\t{\n\t\t\t\t\tresult.push(item);\n\t\t\t\t}\n\t\t\t});\n\t\treturn result;\n\t}\n\n\tdecrementCounter(counters: Object): void\n\t{\n\t\t[...Object.entries(counters)]\n\t\t\t.forEach(([counterId, counterValue]) => {\n\t\t\t\tconst item = this.#getItemsByCounterId(counterId).shift();\n\t\t\t\tif (item)\n\t\t\t\t{\n\t\t\t\t\tconst value = item.getCounterValue();\n\t\t\t\t\tcounters[counterId] = value > counterValue ? (value - counterValue) : 0;\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tdelete counters[counterId];\n\t\t\t\t}\n\t\t\t})\n\t\t;\n\t\tthis.updateCounters(counters, false);\n\t}\n}","import {Tag, Type} from 'main.core';\n\nexport class BrowserHistory\n{\n\twrapper: HTMLElement;\n\titems = [];\n\n\tconstructor()\n\t{\n\t\tthis.wrapper = document.getElementById(\"history-items\");\n\t}\n\n\tinit(): void\n\t{\n\t\tif ('object' != typeof BXDesktopSystem)\n\t\t{\n\t\t\tconsole.log('BXDesktopSystem is empty');\n\t\t\treturn;\n\t\t}\n\n\t\tthis.items = BXDesktopSystem?.BrowserHistory();\n\n\t\tthis.showHistory();\n\t}\n\n\tshowHistory(): void\n\t{\n\t\tlet i = 0;\n\t\tthis.items.forEach((item) => {\n\t\t\tif (i > 15) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\tlet icoName = '';\n\t\t\tlet title = '';\n\t\t\tif (Type.isStringFilled(item.title))\n\t\t\t{\n\t\t\t\ticoName = this.getShortName(item.title);\n\t\t\t\ttitle = item.title;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tif (item.url.includes('/desktop_app/'))\n\t\t\t\t{\n\t\t\t\t\ticoName = Loc.getMessage('MENU_HISTORY_ITEM_ICON');\n\t\t\t\t\ttitle = Loc.getMessage('MENU_HISTORY_ITEM_NAME');\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (item.url.includes('/desktop/menu'))\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tlet url = item.url;\n\t\t\tif (item.url.includes('/online/'))\n\t\t\t{\n\t\t\t\turl = 'bx://v2/' + location.hostname + '/chat/';\n\t\t\t}\n\n\t\t\tlet li = Tag.render`\n\t\t\t\t<li class=\"intranet__desktop-menu_item\">\n\t\t\t\t\t<a class=\"intranet__desktop-menu_item-link\" href=\"${url}\">\n\t\t\t\t\t\t<span class=\"intranet__desktop-menu_item-icon --custom\">${icoName}</span>\n\t\t\t\t\t\t<span class=\"intranet__desktop-menu_item-title\">${title}</span>\n\t\t\t\t\t</a>\n\t\t\t\t</li>\n\t\t\t`;\n\n\t\t\tthis.wrapper.appendChild(li);\n\t\t\ti++;\n\t\t});\n\t}\n\n\tgetShortName(name): string\n\t{\n\t\tif (!Type.isStringFilled(name))\n\t\t{\n\t\t\treturn \"...\";\n\t\t}\n\n\t\tname = name.replace(/['`\".,:;~|{}*^$#@&+\\-=?!()[\\]<>\\n\\r]+/g, \"\").trim();\n\t\tif (name.length <= 0)\n\t\t{\n\t\t\treturn '...';\n\t\t}\n\n\t\tlet shortName;\n\t\tlet words = name.split(/[\\s,]+/);\n\t\tif (words.length <= 1)\n\t\t{\n\t\t\tshortName = name.substring(0, 1);\n\t\t}\n\t\telse if (words.length === 2)\n\t\t{\n\t\t\tshortName = words[0].substring(0, 1) + words[1].substring(0, 1);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tlet firstWord = words[0];\n\t\t\tlet secondWord = words[1];\n\n\t\t\tfor (let i = 1; i < words.length; i++)\n\t\t\t{\n\t\t\t\tif (words[i].length > 3)\n\t\t\t\t{\n\t\t\t\t\tsecondWord = words[i];\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tshortName = firstWord.substring(0, 1) + secondWord.substring(0, 1);\n\t\t}\n\n\t\treturn shortName.toUpperCase();\n\t}\n\n}\n","import {Cache, Type, Loc} from 'main.core';\nimport { Account } from './account/account';\nimport Theme from './api/theme';\nimport Counters from './api/counters';\nimport ItemsController from './controllers/items-controller'\nimport { BrowserHistory } from './history/browser-history';\n\nexport default class DesktopMenu\n{\n\tcache = new Cache.MemoryCache();\n\tbrowserHistory = null;\n\taccount = null;\n\ttheme = null;\n\t#specialLiveFeedDecrement = 0;\n\n\tconstructor(allCounters)\n\t{\n\t\tthis.menuContainer = document.getElementById(\"menu-items-block\");\n\t\tif (!this.menuContainer)\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tthis.initTheme();\n\t\tthis.getItemsController();\n\t\tthis.getHistoryItems();\n\t\tthis.showAccount(allCounters);\n\t\tthis.runAPICounters();\n\t}\n\n\tinitTheme(): void\n\t{\n\t\tthis.theme = new Theme();\n\t}\n\n\tgetItemsController(): ItemsController\n\t{\n\t\treturn this.cache.remember('itemsMenuController', () => {\n\t\t\treturn new ItemsController(this.menuContainer);\n\t\t});\n\t}\n\n\tgetHistoryItems(): void\n\t{\n\t\tthis.browserHistory = new BrowserHistory();\n\t\tthis.browserHistory.init();\n\t}\n\n\tshowAccount(allCounters): void\n\t{\n\t\tthis.account = new Account(allCounters);\n\t\tBX.Intranet.Account = this.account;\n\t}\n\n\trunAPICounters(): void\n\t{\n\t\tBX.Intranet.Counters = new Counters();\n\t\tBX.Intranet.Counters.init();\n\t}\n\n\tdecrementCounter(node, iDecrement): void\n\t{\n\t\tif (!node || node.id !== 'menu-counter-live-feed')\n\t\t{\n\t\t\treturn;\n\t\t}\n\t\tthis.#specialLiveFeedDecrement += parseInt(iDecrement);\n\t\tthis.getItemsController().decrementCounter({\n\t\t\t'live-feed' : parseInt(iDecrement)\n\t\t});\n\t}\n\n\tupdateCounters(counters, send): void\n\t{\n\t\tif (!counters)\n\t\t{\n\t\t\treturn;\n\t\t}\n\t\tif (counters['**'] !== undefined)\n\t\t{\n\t\t\tcounters['live-feed'] = counters['**'];\n\t\t\tdelete counters['**'];\n\t\t}\n\t\tlet workgroupsCounterUpdated = false;\n\t\tif (!Type.isUndefined(counters['**SG0']))\n\t\t{\n\t\t\tthis.workgroupsCounterData['livefeed'] = counters['**SG0'];\n\t\t\tdelete counters['**SG0'];\n\t\t\tworkgroupsCounterUpdated = true;\n\t\t}\n\n\t\tif (!Type.isUndefined(counters[Loc.getMessage('COUNTER_PROJECTS_MAJOR')]))\n\t\t{\n\t\t\tthis.workgroupsCounterData[Loc.getMessage('COUNTER_PROJECTS_MAJOR')] = counters[Loc.getMessage('COUNTER_PROJECTS_MAJOR')];\n\t\t\tdelete counters[Loc.getMessage('COUNTER_PROJECTS_MAJOR')];\n\t\t\tworkgroupsCounterUpdated = true;\n\t\t}\n\n\t\tif (!Type.isUndefined(counters[Loc.getMessage('COUNTER_SCRUM_TOTAL_COMMENTS')]))\n\t\t{\n\t\t\tthis.workgroupsCounterData[Loc.getMessage('COUNTER_SCRUM_TOTAL_COMMENTS')] = counters[Loc.getMessage('COUNTER_SCRUM_TOTAL_COMMENTS')];\n\t\t\tdelete counters[Loc.getMessage('COUNTER_SCRUM_TOTAL_COMMENTS')];\n\t\t\tworkgroupsCounterUpdated = true;\n\t\t}\n\n\t\tif (workgroupsCounterUpdated)\n\t\t{\n\t\t\tcounters['workgroups'] = Object.entries(this.workgroupsCounterData).reduce((prevValue, [, curValue]) => {\n\t\t\t\treturn prevValue + Number(curValue);\n\t\t\t}, 0);\n\t\t}\n\n\t\tif (counters['live-feed'])\n\t\t{\n\t\t\tif (counters['live-feed'] <= 0)\n\t\t\t{\n\t\t\t\tthis.#specialLiveFeedDecrement = 0;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tcounters['live-feed'] -= this.#specialLiveFeedDecrement;\n\t\t\t}\n\t\t}\n\n\t\tthis.getItemsController().updateCounters(counters, send);\n\t\tBX.Intranet.Account.setCounters(counters);\n\t}\n}"],"names":["Account","allCounters","wrapper","document","getElementById","checkCounters","reload","viewDesktopUser","initPopup","Object","keys","counterId","key","sum","val","parseInt","currentUserId","Loc","getMessage","accounts","BXDesktopSystem","DesktopApi","getAccountList","currentUser","find","account","id","portal","location","hostname","viewPopupAccounts","userNode","querySelector","popup","Popup","content","bindElement","width","background","closeIcon","closeByEsc","Event","bind","isShown","close","show","counters","newCounters","data","cId","sumCounters","getSumCounters","block","getElementsByClassName","counterNode","innerHTML","Dom","hasClass","addClass","className","elements","forEach","element","remove","countersView","removeElements","userData","Tag","render","work_position","append","avatar","previewImage","getAvatarUrl","style","avatarUrl","includes","protocol","Text","encode","defaultAvatar","defaultAvatarDesctop","menuPopup","position","item","first_name","last_name","insertBefore","firstElementChild","index","currentUserClass","login","children","addContextMenu","userAvatar","previewUserImage","button","contextPopup","destroy","Menu","items","text","onclick","event","host","AccountDisconnect","userLang","navigator","language","connectAccount","showDesktopDeleteConfirm","userChoice","deleteAccount","PopupManager","getPopupById","PopupType","userProfile","target","replace","openAddAccountTab","Theme","theme","getAppliedTheme","backgroundNode","EventEmitter","subscribe","BX","Intranet","Bitrix24","ThemePicker","Singleton","top","video","removeClass","themeClass","String","indexOf","bgImage","Type","isArrayFilled","prefetchImages","length","imageUrl","sources","type","push","create","attrs","src","props","dataset","themeId","poster","autoplay","loop","muted","playsinline","prepend","Counters","addCustomEvent","command","params","siteId","message","clone","updateCounters","Number","userId","isUndefined","projects_major","scrum_total_comments","window","counter","browser","SupportLocalStorage","substring","value","iDecrement","decrementCounter","send","ready","getClass","DescktopLeftMenu","node","Item","parentContainer","container","init","makeTextIcons","constructor","code","textContent","classList","contains","icon","getShortName","counterValue","oldValue","add","newValue","name","isStringFilled","trim","shortName","words","split","firstWord","secondWord","i","toUpperCase","getAttribute","ItemAdminShared","ItemUserFavorites","ItemUserSelf","ItemSystem","itemMappings","ItemAdminCustom","getItem","itemData","itemClassName","itemClass","detect","ItemsController","_classPrivateMethodInitSpec","Map","querySelectorAll","registerItem","set","getId","countersDynamic","entries","updateCounter","localStorage","BXIM","res","getCounterValue","visibleValue","isDesktop","setBrowserIconBadge","_classPrivateMethodGet","shift","result","values","BrowserHistory","console","log","showHistory","icoName","title","url","li","appendChild","DesktopMenu","Cache","MemoryCache","_classPrivateFieldInitSpec","menuContainer","initTheme","getItemsController","getHistoryItems","showAccount","runAPICounters","cache","remember","browserHistory","undefined","workgroupsCounterUpdated","workgroupsCounterData","reduce","prevValue","curValue","setCounters"],"mappings":"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"}