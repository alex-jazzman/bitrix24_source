{"version":3,"file":"script.js","sources":["src/phone.js","src/input-row-factory.js","src/message-bar.js","src/submit-button.js","src/page/page.js","src/navigation.js","src/analytics.js","src/transport.js","src/page/local-email-page/email-invitation-input.js","src/page/local-email-page/invite-email-popup.js","src/page/local-email-page/invite-email-handler.js","src/page/local-email-page.js","src/selector.js","src/page/email-page.js","src/page/extranet-page.js","src/page/group-page.js","src/page/integrator-page.js","src/self-register.js","src/page/link-page.js","src/mass-invitation-field.js","src/page/mass-page.js","src/page/register-page.js","src/page/success-page.js","src/page-factory.js","src/page-provider.js","src/active-directory.js","src/form.js"],"sourcesContent":["import { Dom, Type, Tag, Event } from 'main.core';\n\nexport class Phone\n{\n\tconstructor()\n\t{\n\t\tthis.count = 0;\n\t\tthis.index = 0;\n\t\tthis.maxCount = 5;\n\t\tthis.inputStack = [];\n\t}\n\n\trenderPhoneRow(inputNode)\n\t{\n\t\tif (this.count >= this.maxCount)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (!Type.isDomNode(inputNode))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst num = inputNode.getAttribute('data-num');\n\n\t\tif (inputNode.parentNode.querySelector(`#phone_number_${num}`))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst element = Tag.render`\n\t\t\t<span style=\"z-index: 3;\" class=\"ui-ctl-before\" data-role=\"phone-block\">\n\t\t\t\t<input type=\"hidden\" name=\"PHONE_COUNTRY[]\" id=\"phone_country_${num}\" value=\"\">\n\t\t\t\t<input type=\"hidden\" name=\"PHONE[]\" id=\"phone_number_${num}\" value=\"\">\n\t\t\t\t<div class=\"invite-dialog-phone-flag-block\" data-role=\"flag\">\n\t\t\t\t\t<span data-role=\"phone_flag_${num}\" style=\"pointer-events: none;\"></span>\n\t\t\t\t</div>\n\t\t\t\t<input class=\"invite-dialog-phone-input\" type=\"hidden\" id=\"phone_input_${num}\" value=\"\">&nbsp;\n\t\t\t</span>\n\t\t`;\n\n\t\tinputNode.style.paddingLeft = '57px';\n\t\tDom.append(element, inputNode.parentNode);\n\n\t\tconst flagNode = inputNode.parentNode.querySelector(\"[data-role='flag']\");\n\t\tif (Type.isDomNode(flagNode))\n\t\t{\n\t\t\tEvent.bind(inputNode.parentNode.querySelector(\"[data-role='flag']\"), 'click', () => {\n\t\t\t\tthis.showCountrySelector(num);\n\t\t\t});\n\t\t}\n\n\t\tconst changeCallback = function(i, inputNode)\n\t\t{\n\t\t\treturn function(e)\n\t\t\t{\n\t\t\t\tif (Type.isDomNode(inputNode.parentNode))\n\t\t\t\t{\n\t\t\t\t\tinputNode.parentNode.querySelector(`#phone_number_${i}`).value = e.value;\n\t\t\t\t\tinputNode.parentNode.querySelector(`#phone_country_${i}`).value = e.country;\n\t\t\t\t}\n\t\t\t};\n\t\t};\n\n\t\tthis.inputStack[num] = new BX.PhoneNumber.Input({\n\t\t\tnode: inputNode,\n\t\t\tflagNode: inputNode.parentNode.querySelector(`[data-role='phone_flag_${num}']`),\n\t\t\tflagSize: 16,\n\t\t\tonChange: changeCallback(num, inputNode),\n\t\t});\n\n\t\t// for ctrl+v paste\n\t\tconst id = setInterval(() => {\n\t\t\tif (\n\t\t\t\t!inputNode.parentNode?.querySelector(`#phone_number_${num}`).value\n\t\t\t\t|| !inputNode.parentNode?.querySelector(`#phone_country_${num}`).value\n\t\t\t)\n\t\t\t{\n\t\t\t\tchangeCallback(num, inputNode)({\n\t\t\t\t\tvalue: this.inputStack[num].getValue(),\n\t\t\t\t\tcountry: this.inputStack[num].formatter ? this.inputStack[num].getCountry() : null,\n\t\t\t\t});\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tclearInterval(id);\n\t\t\t}\n\t\t}, 1000);\n\t}\n\n\tshowCountrySelector(i)\n\t{\n\t\tthis.inputStack[i]._onFlagClick();\n\t}\n}\n","import { Event, Validation, Type, Dom, Tag, Loc } from 'main.core';\nimport { Phone } from './phone';\n\nexport const InputRowType = Object.freeze({\n\tPHONE: 'phone',\n\tEMAIL: 'email',\n\tALL: 'all',\n});\n\nexport type InputRowFactoryType = {\n\tinputRowType?: InputRowType,\n}\n\nexport class InputRowFactory\n{\n\t#inputRowType: InputRowType;\n\t#isPhoneEnabled: boolean;\n\t#isEmailEnabled: boolean;\n\n\tconstructor(params)\n\t{\n\t\tthis.inputNum = 0;\n\t\tthis.#inputRowType = params.inputRowType ?? InputRowType.ALL;\n\n\t\tthis.#isPhoneEnabled = [InputRowType.ALL, InputRowType.PHONE].includes(this.#inputRowType);\n\t\tthis.#isEmailEnabled = [InputRowType.ALL, InputRowType.EMAIL].includes(this.#inputRowType);\n\n\t\tif (this.#isPhoneEnabled)\n\t\t{\n\t\t\tthis.phoneObj = new Phone();\n\t\t}\n\t}\n\n\t#checkPhoneInput(element)\n\t{\n\t\tconst phoneExp = /^[\\d+][\\d ()-]{2,14}\\d$/;\n\n\t\tif (element.value && phoneExp.test(String(element.value).toLowerCase()))\n\t\t{\n\t\t\tthis.phoneObj.renderPhoneRow(element);\n\t\t}\n\t\telse if (element.value.length === 0)\n\t\t{\n\t\t\tthis.#renderDefaultRow(element)?.focus();\n\t\t}\n\t}\n\n\t#bindPhoneChecker(element)\n\t{\n\t\tif (this.#isPhoneEnabled && Type.isDomNode(element))\n\t\t{\n\t\t\tconst inputNodes = Array.prototype.slice.call(element.querySelectorAll('.js-email-phone-input'));\n\t\t\tif (inputNodes)\n\t\t\t{\n\t\t\t\tinputNodes.forEach((element) => {\n\t\t\t\t\tEvent.bind(element, 'input', () => {\n\t\t\t\t\t\tthis.#checkPhoneInput(element);\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t}\n\n\t#renderDefaultRow(node)\n\t{\n\t\tconst phoneFlagBlock = node.parentNode.querySelector('[data-role=\"phone-block\"]');\n\n\t\tif (Type.isDomNode(phoneFlagBlock))\n\t\t{\n\t\t\tDom.remove(phoneFlagBlock);\n\t\t}\n\n\t\tconst phoneBlock = node.parentNode.querySelector('input.ui-ctl-element');\n\n\t\tif (Type.isDomNode(phoneBlock))\n\t\t{\n\t\t\tconst newInput = Tag.render`\n\t\t\t\t<input\n\t\t\t\t\tname=\"${phoneBlock.name}\"\n\t\t\t\t\ttype=\"text\"\n\t\t\t\t\tmaxlength=\"50\"\n\t\t\t\t\tdata-num=\"${node.getAttribute('data-num')}\"\n\t\t\t\t\tclass=\"ui-ctl-element js-email-phone-input\"\n\t\t\t\t\tplaceholder=\"${phoneBlock.placeholder}\"\n\t\t\t\t/>\n\t\t\t`;\n\n\t\t\tDom.replace(phoneBlock, newInput);\n\t\t\tthis.bindCloseIcons(newInput.parentNode);\n\t\t\tthis.#bindPhoneChecker(newInput.parentNode);\n\t\t\tDom.remove(phoneBlock);\n\n\t\t\treturn newInput;\n\t\t}\n\n\t\treturn phoneBlock;\n\t}\n\n\tbindCloseIcons(container)\n\t{\n\t\tconst inputNodes = Array.prototype.slice.call(container.querySelectorAll('input'));\n\n\t\t(inputNodes || []).forEach((node) => {\n\t\t\tconst closeIcon = node.nextElementSibling;\n\n\t\t\tEvent.bind(node, 'input', () => {\n\t\t\t\tDom.style(closeIcon, 'display', node.value === '' ? 'none' : 'block');\n\t\t\t});\n\n\t\t\tEvent.bind(closeIcon, 'click', (event) => {\n\t\t\t\tevent.preventDefault();\n\n\t\t\t\tif (Type.isDomNode(node.parentNode))\n\t\t\t\t{\n\t\t\t\t\tthis.#renderDefaultRow(node);\n\t\t\t\t}\n\n\t\t\t\tDom.style(closeIcon, 'display', 'none');\n\t\t\t});\n\t\t});\n\t}\n\n\trenderInputRowTo(target: HTMLElement, showTitles = false)\n\t{\n\t\tconst element = this.renderEmailInputsRow(showTitles);\n\n\t\tDom.append(element, target);\n\t}\n\n\trenderInputRowsTo(target: HTMLElement, count = 3)\n\t{\n\t\tfor (let i = 0; i < count; i++)\n\t\t{\n\t\t\tthis.renderInputRowTo(target, i === 0);\n\t\t}\n\t}\n\n\trenderEmailInputsRow(showTitles: boolean): HTMLElement\n\t{\n\t\tlet fieldTitle = '';\n\t\tlet nameTitle = '';\n\t\tlet lastNameTitle = '';\n\n\t\tif (showTitles)\n\t\t{\n\t\t\tfieldTitle = `\n\t\t\t\t<div class=\"invite-content__field-lable\">\n\t\t\t\t\t${this.#getDialogInputMessage()}\n\t\t\t\t</div>\n\t\t\t`;\n\n\t\t\tnameTitle = `\n\t\t\t\t<div class=\"invite-content__field-lable\">\n\t\t\t\t\t${Loc.getMessage('BX24_INVITE_DIALOG_ADD_NAME_TITLE')}\n\t\t\t\t</div>\n\t\t\t`;\n\n\t\t\tlastNameTitle = `\n\t\t\t\t<div class=\"invite-content__field-lable\">\n\t\t\t\t\t${Loc.getMessage('BX24_INVITE_DIALOG_ADD_LAST_NAME_TITLE')}\n\t\t\t\t</div>\n\t\t\t`;\n\t\t}\n\n\t\tconst element = Tag.render`\n\t\t\t<div class=\"invite-form-row js-form-row\">\n\t\t\t\t<div class=\"invite-form-col\">\n\t\t\t\t\t${showTitles ? fieldTitle : ''}\n\t\t\t\t\t<div class=\"ui-ctl ui-ctl-w100 ui-ctl-textbox ui-ctl-block ui-ctl-after-icon\">\n\t\t\t\t\t\t<input \n\t\t\t\t\t\t\tname=\"EMAIL[]\" \n\t\t\t\t\t\t\ttype=\"text\" \n\t\t\t\t\t\t\tmaxlength=\"50\"\n\t\t\t\t\t\t\tdata-num=\"${this.inputNum++}\" \n\t\t\t\t\t\t\tclass=\"ui-ctl-element js-email-phone-input\" \n\t\t\t\t\t\t\tplaceholder=\"${this.#getDialogInputMessage()}\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<button type=\"button\" class=\"ui-ctl-after ui-ctl-icon-clear\" style=\"display: none\"></button>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"invite-form-col\">\n\t\t\t\t\t${showTitles ? nameTitle : ''}\n\t\t\t\t\t<div class=\"ui-ctl ui-ctl-w100 ui-ctl-textbox ui-ctl-block ui-ctl-after-icon\">\n\t\t\t\t\t\t<input name=\"NAME[]\" type=\"text\" class=\"ui-ctl-element js-email-name-input\" placeholder=\"${Loc.getMessage('BX24_INVITE_DIALOG_ADD_NAME_TITLE')}\">\n\t\t\t\t\t\t<button type=\"button\" class=\"ui-ctl-after ui-ctl-icon-clear\" style=\"display: none\"></button>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"invite-form-col\">\n\t\t\t\t\t${showTitles ? lastNameTitle : ''}\n\t\t\t\t\t<div class=\"ui-ctl ui-ctl-w100 ui-ctl-textbox ui-ctl-block ui-ctl-after-icon\">\n\t\t\t\t\t\t<input name=\"LAST_NAME[]\" type=\"text\" class=\"ui-ctl-element js-email-last-name-input\" placeholder=\"${Loc.getMessage('BX24_INVITE_DIALOG_ADD_LAST_NAME_TITLE')}\">\n\t\t\t\t\t\t<button type=\"button\" class=\"ui-ctl-after ui-ctl-icon-clear\" style=\"display: none\"></button>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t\tthis.bindCloseIcons(element);\n\t\tthis.#bindPhoneChecker(element);\n\n\t\treturn element;\n\t}\n\n\t#getDialogInputMessage(): string\n\t{\n\t\tif (this.#isPhoneEnabled && this.#isEmailEnabled)\n\t\t{\n\t\t\treturn Loc.getMessage('INTRANET_INVITE_DIALOG_EMAIL_OR_PHONE_INPUT');\n\t\t}\n\t\telse if (this.#isPhoneEnabled)\n\t\t{\n\t\t\treturn Loc.getMessage('INTRANET_INVITE_DIALOG_PHONE_INPUT');\n\t\t}\n\t\telse\n\t\t{\n\t\t\treturn Loc.getMessage('INTRANET_INVITE_DIALOG_EMAIL_INPUT');\n\t\t}\n\t}\n\n\tparseEmailAndPhone(form: HTMLElement)\n\t{\n\t\tif (!Type.isDomNode(form))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst errorInputData = [];\n\t\tconst items = [];\n\t\tconst phoneExp = /^[\\d+][\\d ()-]{4,22}\\d$/;\n\t\tconst rows = Array.prototype.slice.call(form.querySelectorAll('.js-form-row'));\n\n\t\t(rows || []).forEach((row) => {\n\t\t\tconst emailInput = row.querySelector(\"input[name='EMAIL[]']\");\n\t\t\tconst phoneInput = row.querySelector(\"input[name='PHONE[]']\");\n\t\t\tconst nameInput = row.querySelector(\"input[name='NAME[]']\");\n\t\t\tconst lastNameInput = row.querySelector(\"input[name='LAST_NAME[]']\");\n\t\t\tconst emailValue = emailInput.value.trim();\n\n\t\t\tif (this.#isPhoneEnabled && Type.isDomNode(phoneInput))\n\t\t\t{\n\t\t\t\tconst phoneValue = phoneInput.value.trim();\n\t\t\t\tif (phoneValue)\n\t\t\t\t{\n\t\t\t\t\tif (phoneExp.test(String(phoneValue).toLowerCase()))\n\t\t\t\t\t{\n\t\t\t\t\t\tconst phoneCountryInput = row.querySelector(\"input[name='PHONE_COUNTRY[]']\");\n\t\t\t\t\t\titems.push({\n\t\t\t\t\t\t\tPHONE: phoneValue,\n\t\t\t\t\t\t\tPHONE_COUNTRY: phoneCountryInput.value.trim(),\n\t\t\t\t\t\t\tNAME: nameInput.value,\n\t\t\t\t\t\t\tLAST_NAME: lastNameInput.value,\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\terrorInputData.push(phoneValue);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\telse if (this.#isEmailEnabled && emailValue)\n\t\t\t{\n\t\t\t\tif (Validation.isEmail(emailValue))\n\t\t\t\t{\n\t\t\t\t\titems.push({\n\t\t\t\t\t\tEMAIL: emailValue,\n\t\t\t\t\t\tNAME: nameInput.value,\n\t\t\t\t\t\tLAST_NAME: lastNameInput.value,\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\terrorInputData.push(emailValue);\n\t\t\t\t}\n\t\t\t} else if (this.#isPhoneEnabled && !this.#isEmailEnabled && emailValue)\n\t\t\t{\n\t\t\t\terrorInputData.push(emailValue);\n\t\t\t}\n\t\t});\n\n\t\treturn [items, errorInputData];\n\t}\n}\n","import { Type, Dom, Tag } from 'main.core';\n\nexport class MessageBar\n{\n\t#errorContainer: HTMLElement;\n\t#successContainer: HTMLElement;\n\n\tconstructor(options)\n\t{\n\t\tthis.#errorContainer = Type.isDomNode(options.errorContainer) ? options.errorContainer : null;\n\t\tthis.#successContainer = Type.isDomNode(options.successContainer) ? options.successContainer : null;\n\n\t\tthis.hideAll();\n\t}\n\n\tshowError(message: string)\n\t{\n\t\tif (!this.#errorContainer || !Type.isStringFilled(message))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tDom.clean(this.#errorContainer);\n\t\tDom.style(this.#errorContainer, 'display', 'block');\n\t\tDom.append(this.#wrapMessage(message), this.#errorContainer);\n\t}\n\n\t#wrapMessage(text: string): HTMLElement\n\t{\n\t\treturn Tag.render`<span class=\"ui-alert-message\">${BX.util.htmlspecialchars(text)}</span>`;\n\t}\n\n\tshowSuccess(message: string)\n\t{\n\t\tif (!this.#successContainer || !Type.isStringFilled(message))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tDom.clean(this.#successContainer);\n\t\tDom.style(this.#successContainer, 'display', 'block');\n\t\tDom.append(this.#wrapMessage(message), this.#successContainer);\n\t}\n\n\thideAll()\n\t{\n\t\tif (this.#errorContainer)\n\t\t{\n\t\t\tDom.style(this.#errorContainer, 'display', 'none');\n\t\t\tDom.clean(this.#errorContainer);\n\t\t}\n\n\t\tif (this.#successContainer)\n\t\t{\n\t\t\tDom.style(this.#successContainer, 'display', 'none');\n\t\t\tDom.clean(this.#successContainer);\n\t\t}\n\t}\n}","import { Type, Dom, Event } from 'main.core';\nimport { EventEmitter } from 'main.core.events';\n\nexport class SubmitButton extends EventEmitter\n{\n\tstatic ENABLED_STATE = 'enabled';\n\tstatic DISABLED_STATE = 'disabled';\n\n\t#container: HTMLElement;\n\n\tconstructor(options)\n\t{\n\t\tsuper();\n\n\t\tthis.#container = options.node;\n\t\tthis.setEventNamespace('BX.Intranet.Invitation.Submit');\n\t\tEvent.unbindAll(this.#container);\n\t\tif (Type.isFunction(options.events?.click))\n\t\t{\n\t\t\tEvent.bind(this.#container, 'click', options.events.click);\n\t\t}\n\t}\n\n\t#disableSubmitButton(isDisable)\n\t{\n\t\tif (!Type.isDomNode(this.#container) || !Type.isBoolean(isDisable))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (isDisable)\n\t\t{\n\t\t\tDom.addClass(this.#container, ['ui-btn-wait', 'invite-cursor-auto']);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tDom.removeClass(this.#container, ['ui-btn-wait', 'invite-cursor-auto']);\n\t\t}\n\t}\n\n\twait(): void\n\t{\n\t\tthis.#disableSubmitButton(true);\n\t}\n\n\tisWaiting(): boolean\n\t{\n\t\treturn Dom.hasClass(this.#container, 'ui-btn-wait');\n\t}\n\n\tready(): void\n\t{\n\t\tthis.#disableSubmitButton(false);\n\t}\n\n\tdisable(): void\n\t{\n\t\tDom.addClass(this.#container, 'ui-btn-disabled');\n\t}\n\n\tenable(): void\n\t{\n\t\tDom.removeClass(this.#container, 'ui-btn-disabled');\n\t}\n\n\tisEnabled(): boolean\n\t{\n\t\treturn !Dom.hasClass(this.#container, 'ui-btn-disabled');\n\t}\n\n\tsetLabel(lable: string): void\n\t{\n\t\tthis.#container.innerText = lable;\n\t}\n\n\tsendSuccessEvent(users)\n\t{\n\t\tBX.SidePanel.Instance.postMessageAll(window, 'BX.Intranet.Invitation:onAdd', { users });\n\t}\n}\n","import { EventEmitter, BaseEvent } from 'main.core.events';\nimport { SubmitButton } from '../submit-button';\n\nexport class Page\n{\n\tconstructor()\n\t{\n\t\tEventEmitter.subscribe(this, 'BX.Intranet.Invitation:submit', this.onSubmit.bind(this));\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\treturn new HTMLElement();\n\t}\n\n\tonSubmit(event: BaseEvent)\n\t{}\n\n\tgetSubmitButtonText(): ?string\n\t{\n\t\treturn null;\n\t}\n\n\tgetButtonState(): ?string\n\t{\n\t\treturn SubmitButton.ENABLED_STATE;\n\t}\n}\n","import { Type, Dom } from 'main.core';\nimport { EventEmitter } from 'main.core.events';\nimport { Page } from './page/page';\n\nexport class Navigation extends EventEmitter\n{\n\t#pages: Map;\n\t#container: ?HTMLElement;\n\t#first: ?string;\n\t#current: ?string;\n\t#history: [string] = [];\n\n\tconstructor(options)\n\t{\n\t\tsuper();\n\t\tthis.setEventNamespace('BX.Intranet.Navigation');\n\t\tthis.#container = Type.isDomNode(options.container) ? options.container : null;\n\t\tif (Type.isMap(options.pages))\n\t\t{\n\t\t\tthis.#pages = new Map(\n\t\t\t\t[...options.pages].filter(([k, page]) => page instanceof Page),\n\t\t\t);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.#pages = new Map();\n\t\t}\n\n\t\tthis.#first = Type.isStringFilled(options.first) && this.has(options.first)\n\t\t\t? options.first\n\t\t\t: this.#pages.next().value\n\t\t;\n\t}\n\n\tshow(code: string): void\n\t{\n\t\tif (!this.#container || !this.has(code))\n\t\t{\n\t\t\treturn;\n\t\t}\n\t\tconst page = this.get(code);\n\t\tthis.emit('onBeforeChangePage', {\n\t\t\tcurrent: this.current(),\n\t\t\tnew: page,\n\t\t});\n\t\tDom.clean(this.#container);\n\t\tDom.append(page.render(), this.#container);\n\t\tif (this.#current)\n\t\t{\n\t\t\tthis.#history.push(this.#current);\n\t\t}\n\t\tthis.#current = code;\n\t\tthis.emit('onAfterChangePage', {\n\t\t\tcurrent: this.current(),\n\t\t\tprevious: this.prev(),\n\t\t});\n\t}\n\n\tshowFirst(): void\n\t{\n\t\tthis.show(this.#first);\n\t}\n\n\tget(code: string): ?Page\n\t{\n\t\treturn this.#pages.get(code);\n\t}\n\n\thas(code: string): boolean\n\t{\n\t\treturn this.#pages.has(code);\n\t}\n\n\tcurrent(): ?Page\n\t{\n\t\treturn this.get(this.#current);\n\t}\n\n\tgetCurrentCode(): ?string\n\t{\n\t\treturn this.#current;\n\t}\n\n\tprev(): ?Page\n\t{\n\t\tif (this.#history.length > 0)\n\t\t{\n\t\t\tconst code = this.#history[this.#history.length - 1];\n\n\t\t\treturn this.get(code);\n\t\t}\n\n\t\treturn null;\n\t}\n\n\tadd(code: string, page: Page): void\n\t{\n\t\tif (page instanceof Page)\n\t\t{\n\t\t\tthis.#pages.set(code, page);\n\t\t}\n\t}\n\n\tdelete(code: string): void\n\t{\n\t\tthis.#pages.delete(code);\n\t}\n}\n","import { Event, Type } from 'main.core';\nimport { sendData } from 'ui.analytics';\n\nexport class Analytics\n{\n\tstatic TOOLS = 'Invitation';\n\tstatic TOOLS_HEADER = 'headerPopup';\n\tstatic EVENT_OPEN_SLIDER_INVITATION = 'drawer_open';\n\tstatic CATEGORY_INVITATION = 'invitation';\n\tstatic EVENT_COPY = 'copy_invitation_link';\n\tstatic ADMIN_ALLOW_MODE_Y = 'askAdminToAllow_Y';\n\tstatic ADMIN_ALLOW_MODE_N = 'askAdminToAllow_N';\n\tstatic IS_ADMIN_Y = 'isAdmin_Y';\n\tstatic IS_ADMIN_N = 'isAdmin_N';\n\n\tstatic EVENT_TAB_VIEW = 'tab_view';\n\tstatic EVENT_LOCAL_MAIL = 'invitation_local_mail';\n\tstatic TAB_EMAIL = 'tab_by_email';\n\tstatic TAB_MASS = 'tab_mass';\n\tstatic TAB_DEPARTMENT = 'tab_department';\n\tstatic TAB_INTEGRATOR = 'tab_integrator';\n\tstatic TAB_LINK = 'by_link';\n\tstatic TAB_REGISTRATION = 'registration';\n\tstatic TAB_EXTRANET = 'extranet';\n\tstatic TAB_AD = 'AD';\n\tstatic TAB_LOCAL_EMAIL = 'tab_by_local_email';\n\tstatic TAB_PHONE = 'tab_by_phone';\n\n\t#cSection: Object;\n\t#isAdmin: boolean;\n\n\tconstructor(cSection: Object, isAdmin: boolean)\n\t{\n\t\tthis.#cSection = cSection;\n\t\tthis.#isAdmin = isAdmin;\n\t}\n\n\t#getAdminAllowMode(): string\n\t{\n\t\treturn document.querySelector('#allow_register_confirm')?.checked\n\t\t\t? Analytics.ADMIN_ALLOW_MODE_Y\n\t\t\t: Analytics.ADMIN_ALLOW_MODE_N;\n\t}\n\n\t#getIsAdmin(): string\n\t{\n\t\treturn this.#isAdmin ? Analytics.IS_ADMIN_Y : Analytics.IS_ADMIN_N;\n\t}\n\n\t#getCSection(): string\n\t{\n\t\treturn this.#cSection.source;\n\t}\n\n\tsend(): void\n\t{\n\t\tsendData({\n\t\t\ttool: Analytics.TOOLS,\n\t\t\tcategory: Analytics.CATEGORY_INVITATION,\n\t\t\tevent: Analytics.EVENT_COPY,\n\t\t\tc_section: this.#getCSection(),\n\t\t\tp1: this.#getIsAdmin(),\n\t\t\tp2: this.#getAdminAllowMode(),\n\t\t});\n\t}\n\n\tsendTabData(section, subSection): void\n\t{\n\t\tif (!section)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tsendData({\n\t\t\ttool: Analytics.TOOLS,\n\t\t\tcategory: Analytics.CATEGORY_INVITATION,\n\t\t\tevent: Analytics.EVENT_TAB_VIEW,\n\t\t\tc_section: section,\n\t\t\tc_sub_section: subSection,\n\t\t});\n\t}\n\n\tsendOpenSliderData(section): void\n\t{\n\t\tsendData({\n\t\t\ttool: Analytics.TOOLS,\n\t\t\tcategory: Analytics.CATEGORY_INVITATION,\n\t\t\tevent: Analytics.EVENT_OPEN_SLIDER_INVITATION,\n\t\t\tc_section: section,\n\t\t});\n\t}\n\n\tsendOpenLocalEmailPopup(): void\n\t{\n\t\tsendData({\n\t\t\ttool: Analytics.TOOLS,\n\t\t\tcategory: Analytics.CATEGORY_INVITATION,\n\t\t\tevent: Analytics.EVENT_TAB_VIEW,\n\t\t\tc_sub_section: Analytics.TAB_EMAIL,\n\t\t});\n\t}\n\n\tsendLocalEmailProgram(): void\n\t{\n\t\tsendData({\n\t\t\ttool: Analytics.TOOLS,\n\t\t\tcategory: Analytics.CATEGORY_INVITATION,\n\t\t\tevent: Analytics.EVENT_LOCAL_MAIL,\n\t\t});\n\t}\n}\n","import { Type } from 'main.core';\n\nexport class Transport\n{\n\t#componentName: string;\n\t#signedParameters: string;\n\n\tconstructor(options)\n\t{\n\t\tthis.#componentName = options.componentName;\n\t\tthis.#signedParameters = options.signedParameters;\n\t}\n\n\tsend(request): Promise\n\t{\n\t\treturn BX.ajax.runComponentAction(this.#componentName, request.action, {\n\t\t\tsignedParameters: this.#signedParameters,\n\t\t\tmode: Type.isStringFilled(request.mode) ? request.mode : 'ajax',\n\t\t\tmethod: Type.isStringFilled(request.method) ? request.method : 'post',\n\t\t\tdata: request.data,\n\t\t\tanalyticsLabel: request.analyticsLabel,\n\t\t});\n\t}\n}","import { Loc, Tag } from 'main.core';\nimport { InvitationInput, InvitationInputType } from 'intranet.invitation-input';\nimport { EventEmitter } from 'main.core.events';\n\nexport class EmailInvitationInput\n{\n\t#input: InvitationInput = null;\n\n\tconstructor()\n\t{\n\t\tthis.#input = new InvitationInput({ inputType: InvitationInputType.EMAIL });\n\t\tthis.#input.getTagSelector().setPlaceholder(Loc.getMessage('INTRANET_INVITE_DIALOG_LOCAL_POPUP_EMAIL_PLACEHOLDER'));\n\n\t\tEvent.bind(this.#input.getTagSelector().getContainer(), 'click', () => {\n\t\t\tthis.#input.getTagSelector().focusTextBox();\n\t\t});\n\n\t\tEventEmitter.subscribe('BX.Intranet.Invitation:InviteSuccess', () => {\n\t\t\tthis.clearTags();\n\t\t});\n\t}\n\n\tonReadySaveInputHandler(callback: function): void\n\t{\n\t\tthis.#input.unsubscribe('onReadySave', callback);\n\t\tthis.#input.subscribe('onReadySave', callback);\n\t}\n\n\tonUnreadySaveInputHandler(callback: function): void\n\t{\n\t\tthis.#input.unsubscribe('onUnreadySave', callback);\n\t\tthis.#input.subscribe('onUnreadySave', callback);\n\t}\n\n\tgetContent(actionBlock: HTMLElement = null): HTMLElement\n\t{\n\t\tthis.clearTags();\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"email-popup-container\">\n\t\t\t\t<div class=\"email-popup-container__title\">\n\t\t\t\t\t${Loc.getMessage('INTRANET_INVITE_DIALOG_LOCAL_POPUP_EMAIL_TITLE')}\n\t\t\t\t</div>\n\t\t\t\t<div class=\"email-popup-container__description\">\n\t\t\t\t\t${Loc.getMessage('INTRANET_INVITE_DIALOG_LOCAL_POPUP_EMAIL_DESCRIPTION')}\n\t\t\t\t</div>\n\t\t\t\t<div class=\"email-popup-container__input\">\n\t\t\t\t\t${this.#input.render()}\n\t\t\t\t</div>\n\t\t\t\t${actionBlock ?? ''}\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tclearTags(): void\n\t{\n\t\tthis.#input.getTagSelector().removeTags();\n\t}\n\n\tgetValues(): Object\n\t{\n\t\tconst selector = this.#input.getTagSelector();\n\t\tconst tags = selector.getTags();\n\t\tconst emails = [];\n\t\tconst errorElements = [];\n\n\t\ttags.forEach((tag) => {\n\t\t\tif (tag.getEntityType() === 'email')\n\t\t\t{\n\t\t\t\temails.push({\n\t\t\t\t\tEMAIL: tag.getTitle(),\n\t\t\t\t});\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\terrorElements.push(tag.getTitle());\n\t\t\t}\n\t\t});\n\n\t\treturn { emails, errorElements };\n\t}\n}\n","import { Dom, Loc, Tag } from 'main.core';\nimport { Popup, PopupManager } from 'main.popup';\nimport { Button, CancelButton, ButtonState } from 'ui.buttons';\nimport { EventEmitter } from 'main.core.events';\nimport { EmailInvitationInput } from 'email-invitation-input';\n\nexport class InviteEmailPopup\n{\n\t#sendButton: Button;\n\t#popup: Popup = null;\n\t#input: EmailInvitationInput = null;\n\t#actionContent: HTMLElement = null;\n\n\tconstructor(input: EmailInvitationInput)\n\t{\n\t\tthis.#input = input;\n\n\t\tthis.#input.onReadySaveInputHandler(this.onReadySaveInputHandler.bind(this));\n\t\tthis.#input.onUnreadySaveInputHandler(this.onUnreadySaveInputHandler.bind(this));\n\n\t\tEventEmitter.subscribe('BX.Intranet.Invitation:InviteSuccess', () => {\n\t\t\tthis.#popup?.close();\n\t\t\tthis.onReadySaveInputHandler();\n\t\t\tEventEmitter.emit('BX.Intranet.Invitation:onSubmitReady');\n\t\t\tEventEmitter.emit('BX.Intranet.Invitation:onChangeForm');\n\t\t});\n\n\t\tEventEmitter.subscribe('BX.Intranet.Invitation:InviteFailed', () => {\n\t\t\tthis.onReadySaveInputHandler();\n\t\t});\n\t}\n\n\tshow(): void\n\t{\n\t\tif (!this.#popup)\n\t\t{\n\t\t\tthis.#popup = PopupManager.create({\n\t\t\t\tid: 'email-invitation-email',\n\t\t\t\tclassName: 'email-invitation-container',\n\t\t\t\tcloseIcon: true,\n\t\t\t\tautoHide: false,\n\t\t\t\tcloseByEsc: true,\n\t\t\t\twidth: 515,\n\t\t\t\theight: 310,\n\t\t\t});\n\t\t}\n\n\t\tthis.#popup.setContent(this.#input.getContent(this.#getActionContent()));\n\t\tthis.#input.clearTags();\n\t\tthis.#popup.show();\n\t}\n\n\t#getActionContent(): HTMLElement\n\t{\n\t\tif (!this.#actionContent)\n\t\t{\n\t\t\tthis.#actionContent = Tag.render`\n\t\t\t\t<div class=\"email-popup-container__action\">\n\t\t\t\t\t${this.#getSendButton()}\n\t\t\t\t\t${this.#getCancelButton()}\n\t\t\t\t</div>\n\t\t\t`;\n\t\t}\n\n\t\treturn this.#actionContent;\n\t}\n\n\t#getSendButton(): HTMLElement\n\t{\n\t\tthis.#sendButton = new Button({\n\t\t\tclassName: 'email-popup-container__action-send',\n\t\t\ttext: Loc.getMessage('INTRANET_INVITE_DIALOG_LOCAL_POPUP_EMAIL_ACTION_SEND'),\n\t\t\tstate: ButtonState.DISABLED,\n\t\t\tsize: Button.Size.SMALL,\n\t\t\tcolor: Button.Color.PRIMARY,\n\t\t\tnoCaps: true,\n\t\t\tonclick: () => {\n\t\t\t\tif (this.#sendButton.isDisabled())\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tthis.submitData();\n\t\t\t},\n\t\t});\n\n\t\treturn this.#sendButton.render();\n\t}\n\n\t#getCancelButton(): HTMLElement\n\t{\n\t\treturn new CancelButton({\n\t\t\ttext: Loc.getMessage('INTRANET_INVITE_DIALOG_LOCAL_POPUP_EMAIL_ACTION_CANCEL'),\n\t\t\tsize: Button.Size.SMALL,\n\t\t\tonclick: () => this.#popup.close(),\n\t\t\tnoCaps: true,\n\t\t}).render();\n\t}\n\n\tonReadySaveInputHandler(): void\n\t{\n\t\tthis.#sendButton?.setState(null);\n\t}\n\n\tonUnreadySaveInputHandler(): void\n\t{\n\t\tthis.#sendButton?.setState(ButtonState.DISABLED);\n\t}\n\n\tsubmitData(): void\n\t{\n\t\tthis.onUnreadySaveInputHandler();\n\t\tEventEmitter.emit('BX.Intranet.Invitation.EmailPopup:onSubmit');\n\t}\n}\n","import { Loc, Tag, Event, Type } from 'main.core';\nimport { Analytics } from '../../analytics';\nimport DepartmentControl from 'intranet.department-control';\nimport { Transport } from '../../transport';\nimport { LocalEmailPageType } from '../local-email-page';\nimport { EmailInvitationInput } from 'email-invitation-input';\nimport { EventEmitter, BaseEvent } from 'main.core.events';\n\nexport class InviteEmailHandler\n{\n\t#departmentControl: DepartmentControl;\n\t#linkRegisterEnabled: boolean;\n\t#transport: Transport = null;\n\t#input: EmailInvitationInput = null;\n\t#analytics: Analytics = null;\n\n\tconstructor(options: LocalEmailPageType, input: EmailInvitationInput)\n\t{\n\t\tthis.#transport = options.transport;\n\t\tthis.#linkRegisterEnabled = options.linkRegisterEnabled;\n\t\tthis.#departmentControl = options.departmentControl instanceof DepartmentControl ? options.departmentControl : null;\n\t\tthis.#input = input;\n\t\tthis.#analytics = options.analytics;\n\n\t\tEventEmitter.subscribe('BX.Intranet.Invitation:selfChange', (event: BaseEvent) => {\n\t\t\tthis.#linkRegisterEnabled = event.getData().selfEnabled;\n\t\t});\n\n\t\tEventEmitter.subscribe('BX.Intranet.Invitation:InviteSuccess', () => {\n\t\t\tthis.#showNotification(true);\n\t\t});\n\n\t\tEventEmitter.subscribe('BX.Intranet.Invitation:InviteFailed', () => {\n\t\t\tthis.#showNotification(false);\n\t\t});\n\n\t\tEventEmitter.subscribe('BX.Intranet.Invitation.EmailPopup:onSubmit', this.#onSubmitWithMailService.bind(this));\n\t}\n\n\tonSubmit(): void\n\t{\n\t\tif (this.#linkRegisterEnabled)\n\t\t{\n\t\t\tthis.#onSubmitWithLocalEmailProgram();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.#onSubmitWithMailService();\n\t\t}\n\t}\n\n\t#onSubmitWithLocalEmailProgram(): void\n\t{\n\t\tconst departmentsId = this.#departmentControl.getValues();\n\n\t\t// eslint-disable-next-line promise/catch-or-return\n\t\tthis.#transport.send({\n\t\t\taction: 'getInviteLink',\n\t\t\tdata: {\n\t\t\t\tdepartmentsId,\n\t\t\t},\n\t\t}).then((response) => {\n\t\t\tEventEmitter.emit('BX.Intranet.Invitation:onSubmitReady');\n\t\t\tEventEmitter.emit('BX.Intranet.Invitation:onChangeForm');\n\n\t\t\tconst invitationUrl = response.data?.invitationLink;\n\t\t\tif (Type.isStringFilled(invitationUrl))\n\t\t\t{\n\t\t\t\tthis.#openLocalMailProgram(invitationUrl);\n\t\t\t}\n\t\t}, (response) => {\n\t\t\tEventEmitter.emit('BX.Intranet.Invitation:onSubmitReady');\n\t\t\tEventEmitter.emit('BX.Intranet.Invitation:onChangeForm');\n\t\t});\n\t}\n\n\t#openLocalMailProgram(invitationUrl: string): void\n\t{\n\t\tthis.#analytics.sendLocalEmailProgram();\n\t\tconst subject = `subject=${encodeURIComponent(Loc.getMessage('INTRANET_INVITE_DIALOG_LOCAL_POPUP_EMAIL_SUBJECT'))}`;\n\t\tconst body = `body=${encodeURIComponent(Loc.getMessage('INTRANET_INVITE_DIALOG_LOCAL_POPUP_EMAIL_BODY'))} ${invitationUrl}`;\n\t\twindow.location = `mailto:?${subject}&${body}`;\n\t}\n\n\t#onSubmitWithMailService(): void\n\t{\n\t\tconst { emails, errorElements } = this.#input.getValues();\n\t\tconst errors = [];\n\n\t\tif (emails.length <= 0)\n\t\t{\n\t\t\terrors.push(Loc.getMessage('INTRANET_INVITE_DIALOG_EMPTY_ERROR_EMAIL'));\n\t\t}\n\n\t\tif (errorElements.length > 0)\n\t\t{\n\t\t\terrors.push(Loc.getMessage('INTRANET_INVITE_DIALOG_VALIDATE_ERROR_EMAIL'));\n\t\t}\n\n\t\tif (errors.length > 0)\n\t\t{\n\t\t\tEventEmitter.emit(window.invitationForm, 'BX.Intranet.Invitation:onSendData', {\n\t\t\t\terrors,\n\t\t\t});\n\n\t\t\treturn;\n\t\t}\n\n\t\tconst data = {\n\t\t\tinvitations: emails,\n\t\t\tdepartmentIds: this.#departmentControl.getValues(),\n\t\t\ttab: 'email',\n\t\t};\n\n\t\tconst analyticsLabel = {\n\t\t\tINVITATION_TYPE: 'invite',\n\t\t\tINVITATION_COUNT: emails.length,\n\t\t};\n\n\t\tEventEmitter.emit(window.invitationForm, 'BX.Intranet.Invitation:onSendData', {\n\t\t\taction: 'invite',\n\t\t\ttype: 'invite-email',\n\t\t\tdata,\n\t\t\tanalyticsLabel,\n\t\t});\n\t}\n\n\t#showNotification(isSuccess: boolean): void\n\t{\n\t\tconst notificationOptions = {\n\t\t\tid: 'invite-notification-result',\n\t\t\tcloseButton: true,\n\t\t\tautoHideDelay: 4000,\n\t\t\tautoHide: true,\n\t\t\tcontent: this.#getNotificationContent(isSuccess),\n\t\t};\n\n\t\tconst notify = BX.UI.Notification.Center.notify(notificationOptions);\n\t\tnotify.show();\n\t\tnotify.activateAutoHide();\n\t}\n\n\t#getNotificationContent(isSuccess: boolean): HTMLElement\n\t{\n\t\tconst title = isSuccess\n\t\t\t? Loc.getMessage('INTRANET_INVITE_DIALOG_LOCAL_POPUP_SUCCESS_TITLE')\n\t\t\t: Loc.getMessage('INTRANET_INVITE_DIALOG_LOCAL_POPUP_FAILED_TITLE');\n\n\t\tconst description =\tisSuccess\n\t\t\t? Loc.getMessage(\n\t\t\t\t'INTRANET_INVITE_DIALOG_LOCAL_POPUP_SUCCESS_DESCRIPTION',\n\t\t\t\t{\n\t\t\t\t\t'[LINK]': '<a class=\"intranet-invitation-dialog-link\">',\n\t\t\t\t\t'[/LINK]': '</a>',\n\t\t\t\t},\n\t\t\t)\n\t\t\t: Loc.getMessage('INTRANET_INVITE_DIALOG_LOCAL_POPUP_FAILED_DESCRIPTION');\n\n\t\tconst content = Tag.render`\n\t\t\t<div class=\"invite-email-notification\">\n\t\t\t\t<div class=\"invite-email-notification__title\">\n\t\t\t\t\t${title}\n\t\t\t\t</div>\n\t\t\t\t<div class=\"invite-email-notification__description\">\n\t\t\t\t\t${description}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\n\t\tconst link = content.querySelector('.intranet-invitation-dialog-link');\n\t\tif (Type.isDomNode(link))\n\t\t{\n\t\t\tEvent.unbindAll(link);\n\t\t\tEvent.bind(link, 'click', this.#openInvitationPageWithFilter.bind(this));\n\t\t}\n\n\t\treturn content;\n\t}\n\n\t#openInvitationPageWithFilter(): void\n\t{\n\t\twindow.top.location = '/company/?apply_filter=Y&INVITED=Y';\n\t}\n}\n","import { Loc, Tag, Type, Event } from 'main.core';\nimport { Analytics } from '../analytics';\nimport DepartmentControl from 'intranet.department-control';\nimport { Transport } from '../transport';\nimport { EmailInvitationInput } from './local-email-page/email-invitation-input';\nimport { InviteEmailPopup } from './local-email-page/invite-email-popup';\nimport { EventEmitter, BaseEvent } from 'main.core.events';\nimport { InviteEmailHandler } from './local-email-page/invite-email-handler';\nimport { Page } from './page';\nimport 'ui.fonts.inter';\n\nexport type LocalEmailPageType = {\n\tdepartmentControl: DepartmentControl,\n\ttransport: Transport,\n\tlinkRegisterEnabled: boolean,\n\tanalytics: Analytics,\n}\n\nexport class LocalEmailPage extends Page\n{\n\t#container: HTMLElement;\n\t#departmentControl: DepartmentControl;\n\t#inviteEmailPopup: InviteEmailPopup = null;\n\t#linkRegisterEnabled: boolean;\n\t#input: EmailInvitationInput = null;\n\t#process: InviteEmailHandler = null;\n\t#analytics: Analytics = null;\n\n\tconstructor(options: LocalEmailPageType)\n\t{\n\t\tsuper();\n\n\t\tthis.#linkRegisterEnabled = options.linkRegisterEnabled;\n\t\tthis.#departmentControl = options.departmentControl instanceof DepartmentControl ? options.departmentControl : null;\n\t\tthis.#analytics = options.analytics;\n\t\tthis.#input = new EmailInvitationInput();\n\t\tthis.#process = new InviteEmailHandler(options, this.#input);\n\n\t\tEventEmitter.subscribe('BX.Intranet.Invitation:selfChange', (event: BaseEvent) => {\n\t\t\tthis.#linkRegisterEnabled = event.getData().selfEnabled;\n\t\t});\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\tif (this.#container)\n\t\t{\n\t\t\treturn this.#container;\n\t\t}\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"invite-wrap js-intranet-invitation-block\" data-role=\"invite-block\">\n\t\t\t\t${this.#titleRender()}\n\t\t\t\t${this.#renderForm()}\n\t\t\t</div>\n\t\t`;\n\t}\n\n\t#titleRender(): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"invite-title-container\">\n\t\t\t\t<div class=\"invite-title-icon invite-title-icon-message\">\n\t\t\t\t\t<div class=\"ui-icon-set --person-letter\"></div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"invite-title-text\">\n\t\t\t\t\t${Loc.getMessage('INTRANET_INVITE_DIALOG_TITLE_EMAIL_MSGVER_1')}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\t#renderForm(): HTMLElement\n\t{\n\t\tlet topBlock = null;\n\t\tif (this.#linkRegisterEnabled)\n\t\t{\n\t\t\ttopBlock = this.#getNotifyBlock();\n\t\t}\n\t\telse\n\t\t{\n\t\t\ttopBlock = this.#input.getContent();\n\t\t\tthis.#input.onReadySaveInputHandler(this.onReadySaveInputHandler);\n\t\t\tthis.#input.onUnreadySaveInputHandler(this.onUnreadySaveInputHandler);\n\t\t}\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"invite-content-container\">\n\t\t\t\t${topBlock}\n\t\t\t\t${this.#getDepartmentBlock()}\n\t\t\t\t${this.#linkRegisterEnabled && this.#getMailServiceBlock()}\n\t\t\t</div>\n\t\t`;\n\t}\n\n\t#getNotifyBlock(): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"invite-content-notify\">\n\t\t\t\t<div class=\"invite-content-notify-wrapper\">\n\t\t\t\t\t<div class=\"invite-content-notify__image\"></div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"invite-content-notify-content\">\n\t\t\t\t\t<div class=\"invite-content-notify-content__description\"> \n\t\t\t\t\t\t${Loc.getMessage('INTRANET_INVITE_DIALOG_LOCAL_MAIL_CONTENT_DESCRIPTION')}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"invite-content-notify-content__step\">\n\t\t\t\t\t\t${Loc.getMessage('INTRANET_INVITE_DIALOG_LOCAL_MAIL_CONTENT_STEPS')}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tonReadySaveInputHandler(): void\n\t{\n\t\tEventEmitter.emit('BX.Intranet.Invitation:onSubmitReady');\n\t\tEventEmitter.emit('BX.Intranet.Invitation:onChangeForm');\n\t}\n\n\tonUnreadySaveInputHandler(): void\n\t{\n\t\tEventEmitter.emit('BX.Intranet.Invitation:onSubmitDisabled');\n\t}\n\n\t#getDepartmentBlock(): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"invite-content-department\">\n\t\t\t\t${this.#departmentControl.render()}\n\t\t\t</div>\n\t\t`;\n\t}\n\n\t#getMailServiceBlock(): HTMLElement\n\t{\n\t\tconst text = Loc.getMessage(\n\t\t\t'INTRANET_INVITE_DIALOG_LOCAL_MAIL_SERVICE',\n\t\t\t{\n\t\t\t\t'[LINK]': '<a class=\"invite-content-mail-service__link\">',\n\t\t\t\t'[/LINK]': '</a>',\n\t\t\t},\n\t\t);\n\n\t\tconst block = Tag.render`\n\t\t\t<div class=\"invite-content-mail-service\">\n\t\t\t\t${text}\n\t\t\t</div>\n\t\t`;\n\n\t\tconst link = block.querySelector('.invite-content-mail-service__link');\n\t\tif (Type.isDomNode(link))\n\t\t{\n\t\t\tEvent.unbindAll(link);\n\t\t\tEvent.bind(link, 'click', this.#openEmailInputPopup.bind(this));\n\t\t}\n\n\t\treturn block;\n\t}\n\n\t#openEmailInputPopup(): void\n\t{\n\t\tif (!this.#inviteEmailPopup)\n\t\t{\n\t\t\tthis.#inviteEmailPopup = new InviteEmailPopup(this.#input);\n\t\t}\n\t\tthis.#analytics.sendOpenLocalEmailPopup();\n\t\tthis.#inviteEmailPopup.show();\n\t}\n\n\tonSubmit(event: BaseEvent): void\n\t{\n\t\tthis.#process.onSubmit();\n\t}\n\n\tgetAnalyticTab(): string\n\t{\n\t\treturn Analytics.TAB_LOCAL_EMAIL;\n\t}\n\n\tgetSubmitButtonText(): ?string\n\t{\n\t\treturn Loc.getMessage('BX24_INVITE_DIALOG_ACTION_INVITE');\n\t}\n}\n","import {Type, Dom} from \"main.core\";\nimport {TagSelector} from 'ui.entity-selector';\n\nexport class Selector\n{\n\tconstructor(params)\n\t{\n\t\tthis.options = params.options;\n\t\tthis.entities = [];\n\n\t\tthis.#prepareOptions();\n\t}\n\n\t#prepareOptions(): void\n\t{\n\t\tfor (const type in this.options)\n\t\t{\n\t\t\tif (!this.options.hasOwnProperty(type))\n\t\t\t{\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tif (type === \"project\" && !!this.options[type])\n\t\t\t{\n\t\t\t\tconst options = {\n\t\t\t\t\tfillRecentTab: true,\n\t\t\t\t\t'!type': ['collab'],\n\t\t\t\t\tcreateProjectLink: this.options.showCreateButton ?? true,\n\t\t\t\t};\n\t\t\t\tif (\n\t\t\t\t\tObject.prototype.hasOwnProperty.call(this.options, 'projectLimitExceeded')\n\t\t\t\t\t&& Object.prototype.hasOwnProperty.call(this.options, 'projectLimitFeatureId')\n\t\t\t\t)\n\t\t\t\t{\n\t\t\t\t\toptions.lockProjectLink = this.options.projectLimitExceeded;\n\t\t\t\t\toptions.lockProjectLinkFeatureId = this.options.projectLimitFeatureId;\n\t\t\t\t}\n\n\t\t\t\tconst optionValue = {\n\t\t\t\t\tid: 'project',\n\t\t\t\t\toptions,\n\t\t\t\t};\n\n\t\t\t\tif (this.options[type] === \"extranet\")\n\t\t\t\t{\n\t\t\t\t\toptionValue[\"options\"][\"extranet\"] = true;\n\t\t\t\t}\n\t\t\t\tthis.entities.push(optionValue);\n\t\t\t}\n\t\t}\n\t}\n\n\trenderTo(target: HTMLElement)\n\t{\n\t\tthis.tagSelector = this.renderTagSelector();\n\n\t\tif (Type.isDomNode(target))\n\t\t{\n\t\t\tthis.tagSelector.renderTo(target);\n\t\t}\n\t}\n\n\trenderTagSelector(): TagSelector\n\t{\n\t\tconst preselectedItems = [];\n\n\t\tif (this.options?.projectId > 0)\n\t\t{\n\t\t\tpreselectedItems.push(['project', this.options.projectId]);\n\t\t}\n\n\t\treturn new TagSelector({\n\t\t\tdialogOptions: {\n\t\t\t\tpreselectedItems,\n\t\t\t\tentities: this.entities,\n\t\t\t\tcontext: 'INTRANET_INVITATION',\n\t\t\t},\n\t\t});\n\t}\n\n\tgetItems()\n\t{\n\t\tlet departments = [];\n\t\tlet projects = [];\n\t\tconst tagSelectorItems = this.tagSelector.getDialog().getSelectedItems();\n\n\t\ttagSelectorItems.forEach(item => {\n\t\t\tconst id = parseInt(item.getId());\n\t\t\tconst type = item.getEntityId();\n\n\t\t\tif (type === \"department\")\n\t\t\t{\n\t\t\t\tdepartments.push(id);\n\t\t\t}\n\t\t\telse if (type === \"project\")\n\t\t\t{\n\t\t\t\tprojects.push(id);\n\t\t\t}\n\t\t});\n\n\t\treturn {\n\t\t\tdepartments: departments,\n\t\t\tprojects: projects\n\t\t};\n\t}\n}","import { Loc, Tag, Type, Event } from 'main.core';\nimport { EventEmitter } from 'main.core.events';\nimport { Analytics } from '../analytics';\nimport DepartmentControl from 'intranet.department-control';\nimport { InputRowFactory } from '../input-row-factory';\nimport { Page } from './page';\n\nexport class EmailPage extends Page\n{\n\t#container: HTMLElement;\n\t#inputsFactory: InputRowFactory;\n\t#smsAvailable: boolean;\n\t#useOnlyPhone: boolean;\n\t#onClickSwitchMode: function;\n\t#onClickAddInputRow: function;\n\t#departmentControl: DepartmentControl;\n\n\tconstructor(options)\n\t{\n\t\tsuper();\n\t\tthis.#inputsFactory = options.inputsFactory instanceof InputRowFactory ? options.inputsFactory : null;\n\t\tthis.#smsAvailable = options.smsAvailable === true;\n\t\tthis.#useOnlyPhone = options.useLocalEmailProgram === true;\n\t\tthis.#onClickSwitchMode = Type.isFunction(options.onClickSwitchMode) ? options.onClickSwitchMode : null;\n\t\tthis.#onClickAddInputRow = Type.isFunction(options.onClickAddInputRow) ? options.onClickAddInputRow : null;\n\t\tthis.#departmentControl = options.departmentControl instanceof DepartmentControl ? options.departmentControl : null;\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\tif (this.#container)\n\t\t{\n\t\t\treturn this.#container;\n\t\t}\n\n\t\tconst title = this.#titleRender();\n\t\tconst form = this.#renderForm();\n\t\tthis.#inputsFactory.renderInputRowsTo(form.querySelector('div[data-role=\"rows-container\"]'), 5);\n\t\tthis.#departmentControl.renderTo(form.querySelector('form'));\n\n\t\tthis.#container = Tag.render`\n\t\t\t<div class=\"invite-wrap js-intranet-invitation-block\" data-role=\"invite-block\">\n\t\t\t\t${title}\n\t\t\t\t${form}\n\t\t\t</div>\n\t\t`;\n\n\t\treturn this.#container;\n\t}\n\n\t#titleRender(): HTMLElement\n\t{\n\t\tconst suffix = this.#useOnlyPhone ? 'PHONE_MSGVER_1' : (this.#smsAvailable ? 'EMAIL_AND_PHONE' : 'EMAIL');\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"invite-title-container\">\n\t\t\t\t<div class=\"invite-title-icon invite-title-icon-message\">\n\t\t\t\t\t<div class=\"ui-icon-set --person-letter\"></div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"invite-title-text\">\n\t\t\t\t\t${Loc.getMessage(`INTRANET_INVITE_DIALOG_TITLE_${suffix}`)}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\t#renderForm(): HTMLElement\n\t{\n\t\tconst form = Tag.render`\n\t\t\t<div class=\"invite-content-container\">\n\t\t\t\t<form method=\"POST\" name=\"INVITE_DIALOG_FORM\" class=\"invite-form-container\">\n\t\t\t\t\t<div data-role=\"rows-container\"></div>\n\t\t\t\t\t<div class=\"invite-form-buttons --border-bottom --pt-3\">\n\t\t\t\t\t\t\t<span class=\"ui-btn ui-btn-sm ui-btn-light-border ui-btn-icon-add ui-btn-round\"\n\t\t\t\t\t\t\t\t  data-role=\"invite-more\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t${Loc.getMessage('INTRANET_INVITE_DIALOG_ADD_MORE')}\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t<span style=\"padding: 0 10px;\">${Loc.getMessage('INTRANET_INVITE_DIALOG_OR')}</span>\n\t\t\t\t\t\t<span\n\t\t\t\t\t\t\tclass=\"invite-content__switch_button swith-email-invitation-persons-mode\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t${Loc.getMessage('INTRANET_INVITE_DIALOG_ADD_MASSIVE')}\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t</div>\n\t\t\t\t</form>\n\t\t\t</div>\n\t\t`;\n\n\t\tconst moreButton = form.querySelector(\"[data-role='invite-more']\");\n\t\tif (Type.isDomNode(moreButton))\n\t\t{\n\t\t\tEvent.unbindAll(moreButton);\n\t\t\tEvent.bind(moreButton, 'click', () => {\n\t\t\t\tthis.#inputsFactory.renderInputRowTo(form.querySelector('div[data-role=\"rows-container\"]'));\n\t\t\t\tif (this.#onClickAddInputRow)\n\t\t\t\t{\n\t\t\t\t\tthis.#onClickAddInputRow();\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tconst switchBtn = form.querySelector('.swith-email-invitation-persons-mode');\n\t\tif (Type.isDomNode(switchBtn))\n\t\t{\n\t\t\tEvent.unbindAll(switchBtn);\n\t\t\tEvent.bind(switchBtn, 'click', this.#onClickSwitchMode);\n\t\t}\n\n\t\treturn form;\n\t}\n\n\tgetAnalyticTab(): string\n\t{\n\t\treturn this.#useOnlyPhone ? Analytics.TAB_PHONE : Analytics.TAB_EMAIL;\n\t}\n\n\tonSubmit(event: BaseEvent)\n\t{\n\t\tconst formNode = this.render().querySelector('form');\n\t\tconst [items, errorInputData] = this.#inputsFactory.parseEmailAndPhone(formNode);\n\n\t\tconst errors = [];\n\t\tif (errorInputData.length > 0)\n\t\t{\n\t\t\terrors.push(`${this.#getValidateError()}: ${errorInputData.join(', ')}`);\n\t\t}\n\n\t\tif (items.length <= 0)\n\t\t{\n\t\t\terrors.push(this.#getEmptyError());\n\t\t}\n\t\tconst context = event.getData()?.context;\n\t\tif (errors.length > 0)\n\t\t{\n\t\t\tEventEmitter.emit(context, 'BX.Intranet.Invitation:onSendData', {\n\t\t\t\terrors,\n\t\t\t});\n\n\t\t\treturn;\n\t\t}\n\n\t\tconst data = {\n\t\t\tinvitations: items,\n\t\t\tdepartmentIds: this.#departmentControl.getValues(),\n\t\t\ttab: 'email',\n\t\t};\n\n\t\tconst analyticsLabel = {\n\t\t\tINVITATION_TYPE: 'invite',\n\t\t\tINVITATION_COUNT: items.length,\n\t\t};\n\n\t\tEventEmitter.emit(context, 'BX.Intranet.Invitation:onSendData', {\n\t\t\taction: 'invite',\n\t\t\tdata,\n\t\t\tanalyticsLabel,\n\t\t});\n\t}\n\n\t#getValidateError()\n\t{\n\t\tif (this.#useOnlyPhone)\n\t\t{\n\t\t\treturn Loc.getMessage('INTRANET_INVITE_DIALOG_PHONE_VALIDATE_ERROR');\n\t\t}\n\t\telse if (this.#smsAvailable)\n\t\t{\n\t\t\treturn Loc.getMessage('INTRANET_INVITE_DIALOG_EMAIL_OR_PHONE_VALIDATE_ERROR');\n\t\t}\n\n\t\treturn Loc.getMessage('INTRANET_INVITE_DIALOG_EMAIL_VALIDATE_ERROR');\n\t}\n\n\t#getEmptyError()\n\t{\n\t\tif (this.#useOnlyPhone)\n\t\t{\n\t\t\treturn Loc.getMessage('INTRANET_INVITE_DIALOG_PHONE_EMPTY_ERROR');\n\t\t}\n\t\telse if (this.#smsAvailable)\n\t\t{\n\t\t\treturn Loc.getMessage('INTRANET_INVITE_DIALOG_EMAIL_OR_PHONE_EMPTY_ERROR');\n\t\t}\n\n\t\treturn Loc.getMessage('INTRANET_INVITE_DIALOG_EMAIL_EMPTY_ERROR');\n\t}\n\n\tgetSubmitButtonText(): ?string\n\t{\n\t\treturn Loc.getMessage('BX24_INVITE_DIALOG_ACTION_INVITE');\n\t}\n}","import { Tag, Loc, Event, Type } from 'main.core';\nimport { EventEmitter } from 'main.core.events';\nimport { Analytics } from '../analytics';\nimport { InputRowFactory } from '../input-row-factory';\nimport { Page } from './page';\nimport { TagSelector } from 'ui.entity-selector';\n\nexport class ExtranetPage extends Page\n{\n\t#container: HTMLElement;\n\t#inputsFactory: InputRowFactory;\n\t#tagSelectorGroup: TagSelector;\n\t#onClickAddInputRow: function;\n\n\tconstructor(options)\n\t{\n\t\tsuper();\n\t\tthis.#inputsFactory = options.inputsFactory instanceof InputRowFactory ? options.inputsFactory : null;\n\t\tthis.#tagSelectorGroup = options.tagSelectorGroup instanceof TagSelector ? options.tagSelectorGroup : null;\n\t\tthis.#onClickAddInputRow = Type.isFunction(options.onClickAddInputRow) ? options.onClickAddInputRow : null;\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\tif (this.#container)\n\t\t{\n\t\t\treturn this.#container;\n\t\t}\n\n\t\tthis.#container = Tag.render`\n\t\t\t<div class=\"invite-wrap js-intranet-invitation-block\" data-role=\"extranet-block\">\n\t\t\t\t<div class=\"invite-title-container\">\n\t\t\t\t\t<div class=\"invite-title-icon invite-title-icon-message\">\n\t\t\t\t\t\t<div class=\"ui-icon-set --earth\"></div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"invite-title-text\">${Loc.getMessage('INTRANET_INVITE_DIALOG_EXTRANET_TITLE')}</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"invite-content-container\">\n\t\t\t\t\t<form method=\"POST\" name=\"EXTRANET_DIALOG_FORM\" class=\"invite-form-container\">\n\t\t\t\t\t\t<div class=\"invite-form-row\" style=\"margin-bottom: 15px;\">\n\t\t\t\t\t\t\t<div class=\"invite-form-col\">\n\t\t\t\t\t\t\t\t<div class=\"ui-ctl-label-text\">${Loc.getMessage('INTRANET_INVITE_DIALOG_EXTRANET_GROUP')}</div>\n\t\t\t\t\t\t\t\t<div data-role=\"entity-selector-container\"></div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div data-role=\"rows-container\"></div>\n\t\t\t\t\t\t<div class=\"invite-form-buttons\">\n\t\t\t\t\t\t\t<span class=\"ui-btn ui-btn-sm ui-btn-light-border ui-btn-icon-add ui-btn-round\" data-role=\"invite-more\">\n\t\t\t\t\t\t\t\t${Loc.getMessage('INTRANET_INVITE_DIALOG_ADD_MORE')}\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</form>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\n\t\tthis.#tagSelectorGroup?.renderTo(this.#container.querySelector('[data-role=\"entity-selector-container\"]'));\n\n\t\tthis.#inputsFactory.renderInputRowsTo(\n\t\t\tthis.#container.querySelector('div[data-role=\"rows-container\"]'),\n\t\t\t3,\n\t\t);\n\n\t\tconst moreButton = this.#container.querySelector(\"[data-role='invite-more']\");\n\t\tif (Type.isDomNode(moreButton))\n\t\t{\n\t\t\tEvent.unbindAll(moreButton);\n\t\t\tEvent.bind(moreButton, 'click', () => {\n\t\t\t\tthis.#inputsFactory.renderInputRowTo(this.#container.querySelector('div[data-role=\"rows-container\"]'));\n\t\t\t\tif (this.#onClickAddInputRow)\n\t\t\t\t{\n\t\t\t\t\tthis.#onClickAddInputRow();\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\treturn this.#container;\n\t}\n\n\tgetAnalyticTab(): string\n\t{\n\t\treturn Analytics.TAB_EXTRANET;\n\t}\n\n\tonSubmit(event: BaseEvent)\n\t{\n\t\tconst formNode = this.render().querySelector('form');\n\t\tconst [items, errorInputData] = this.#inputsFactory.parseEmailAndPhone(formNode);\n\n\t\tconst errors = [];\n\t\tif (errorInputData.length > 0)\n\t\t{\n\t\t\terrors.push(`${Loc.getMessage('INTRANET_INVITE_DIALOG_EMAIL_OR_PHONE_VALIDATE_ERROR')}: ${errorInputData.join(', ')}`);\n\t\t}\n\n\t\tif (items.length <= 0)\n\t\t{\n\t\t\terrors.push(Loc.getMessage('INTRANET_INVITE_DIALOG_EMAIL_OR_PHONE_EMPTY_ERROR'));\n\t\t}\n\t\tconst context = event.getData()?.context;\n\t\tif (errors.length > 0)\n\t\t{\n\t\t\tEventEmitter.emit(context, 'BX.Intranet.Invitation:onSendData', {\n\t\t\t\terrors,\n\t\t\t});\n\n\t\t\treturn;\n\t\t}\n\n\t\tconst tagSelectorItems = this.#tagSelectorGroup.getDialog().getSelectedItems();\n\t\tconst projectIds = [];\n\t\ttagSelectorItems.forEach((item) => {\n\t\t\tconst id = parseInt(item.getId(), 10);\n\t\t\tprojectIds.push(id);\n\t\t});\n\n\t\tconst data = {\n\t\t\tinvitations: items,\n\t\t\tworkgroupIds: projectIds,\n\t\t\ttab: 'email',\n\t\t};\n\n\t\tconst analyticsLabel = {\n\t\t\tINVITATION_TYPE: 'extranet',\n\t\t\tINVITATION_COUNT: items.length,\n\t\t};\n\n\t\tEventEmitter.emit(context, 'BX.Intranet.Invitation:onSendData', {\n\t\t\taction: 'extranet',\n\t\t\tdata,\n\t\t\tanalyticsLabel,\n\t\t});\n\t}\n\n\tgetSubmitButtonText(): ?string\n\t{\n\t\treturn Loc.getMessage('BX24_INVITE_DIALOG_ACTION_INVITE');\n\t}\n}","import { Tag, Loc, Type, Event } from 'main.core';\nimport { BaseEvent, EventEmitter } from 'main.core.events';\nimport { Analytics } from '../analytics';\nimport DepartmentControl from 'intranet.department-control';\nimport { InputRowFactory } from '../input-row-factory';\nimport { Page } from './page';\nimport { TagSelector } from 'ui.entity-selector';\n\nexport class GroupPage extends Page\n{\n\t#container: HTMLElement;\n\t#inputsFactory: InputRowFactory;\n\t#tagSelectorGroup: TagSelector;\n\t#onClickAddInputRow: function;\n\t#departmentControl: DepartmentControl;\n\n\tconstructor(options)\n\t{\n\t\tsuper();\n\t\tthis.#inputsFactory = options.inputsFactory instanceof InputRowFactory ? options.inputsFactory : null;\n\t\tthis.#tagSelectorGroup = options.tagSelectorGroup instanceof TagSelector ? options.tagSelectorGroup : null;\n\t\tthis.#onClickAddInputRow = Type.isFunction(options.onClickAddInputRow) ? options.onClickAddInputRow : null;\n\t\tthis.#departmentControl = options.departmentControl instanceof DepartmentControl ? options.departmentControl : null;\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\tif (this.#container)\n\t\t{\n\t\t\treturn this.#container;\n\t\t}\n\n\t\tthis.#container = Tag.render`\n\t\t\t<div class=\"invite-wrap js-intranet-invitation-block\" data-role=\"invite-with-group-dp-block\">\n\t\t\t\t<div class=\"invite-title-container\">\n\t\t\t\t\t<div class=\"invite-title-icon invite-title-icon-message\">\n\t\t\t\t\t\t<div class=\"ui-icon-set --group\"></div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"invite-title-text\">\n\t\t\t\t\t\t${Loc.getMessage('INTRANET_INVITE_DIALOG_GROUP_TITLE')}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"invite-content-container\">\n\t\t\t\t\t<form method=\"POST\" name=\"INVITE_WITH_GROUP_DP_DIALOG_FORM\" class=\"invite-form-container\">\n\t\t\t\t\t\t<div data-role=\"rows-container\"></div>\n\t\t\t\t\t\t<div class=\"invite-form-buttons --border-bottom --pt-3 --mb-17\">\n\t\t\t\t\t\t\t<span class=\"ui-btn ui-btn-sm ui-btn-light-border ui-btn-icon-add ui-btn-round\" data-role=\"invite-more\">\n\t\t\t\t\t\t\t\t${Loc.getMessage('INTRANET_INVITE_DIALOG_ADD_MORE')}\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"invite-form-row\">\n\t\t\t\t\t\t\t<div class=\"invite-form-col\">\n\t\t\t\t\t\t\t\t<div class=\"invite-content__field-lable\">${Loc.getMessage('INTRANET_INVITE_DIALOG_GROUP_INPUT')}</div>\n\t\t\t\t\t\t\t\t<div data-role=\"entity-selector-container\"></div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"invite-form-row\" id=\"intranet-invitation__department-control-palce\">\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</form>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t\tthis.#inputsFactory.renderInputRowsTo(\n\t\t\tthis.#container.querySelector('div[data-role=\"rows-container\"]'),\n\t\t\t3,\n\t\t);\n\n\t\tthis.#tagSelectorGroup.renderTo(this.#container.querySelector('[data-role=\"entity-selector-container\"]'));\n\t\tthis.#departmentControl.renderTo(this.#container.querySelector('#intranet-invitation__department-control-palce'));\n\n\t\tconst moreButton = this.#container.querySelector(\"[data-role='invite-more']\");\n\t\tif (Type.isDomNode(moreButton))\n\t\t{\n\t\t\tEvent.unbindAll(moreButton);\n\t\t\tEvent.bind(moreButton, 'click', () => {\n\t\t\t\tthis.#inputsFactory.renderInputRowTo(\n\t\t\t\t\tthis.#container.querySelector('div[data-role=\"rows-container\"]'),\n\t\t\t\t);\n\t\t\t\tif (this.#onClickAddInputRow)\n\t\t\t\t{\n\t\t\t\t\tthis.#onClickAddInputRow();\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\treturn this.#container;\n\t}\n\n\tgetAnalyticTab(): string\n\t{\n\t\treturn Analytics.TAB_DEPARTMENT;\n\t}\n\n\tonSubmit(event: BaseEvent)\n\t{\n\t\tconst formNode = this.render().querySelector('form');\n\t\tconst [items, errorInputData] = this.#inputsFactory.parseEmailAndPhone(formNode);\n\n\t\tconst errors = [];\n\t\tif (errorInputData.length > 0)\n\t\t{\n\t\t\terrors.push(`${Loc.getMessage('INTRANET_INVITE_DIALOG_EMAIL_OR_PHONE_VALIDATE_ERROR')}: ${errorInputData.join(', ')}`);\n\t\t}\n\n\t\tif (items.length <= 0)\n\t\t{\n\t\t\terrors.push(Loc.getMessage('INTRANET_INVITE_DIALOG_EMAIL_OR_PHONE_EMPTY_ERROR'));\n\t\t}\n\t\tconst context = event.getData()?.context;\n\t\tif (errors.length > 0)\n\t\t{\n\t\t\tEventEmitter.emit(context, 'BX.Intranet.Invitation:onSendData', {\n\t\t\t\terrors,\n\t\t\t});\n\n\t\t\treturn;\n\t\t}\n\n\t\tconst tagSelectorItems = this.#tagSelectorGroup.getDialog().getSelectedItems();\n\t\tconst projectIds = [];\n\t\ttagSelectorItems.forEach((item) => {\n\t\t\tconst id = parseInt(item.getId(), 10);\n\t\t\tprojectIds.push(id);\n\t\t});\n\n\t\tconst data = {\n\t\t\tinvitations: items,\n\t\t\tdepartmentIds: this.#departmentControl.getValues(),\n\t\t\tworkgroupIds: projectIds,\n\t\t\ttab: 'group',\n\t\t};\n\n\t\tconst analyticsLabel = {\n\t\t\tINVITATION_TYPE: 'withGroupOrDepartment',\n\t\t\tINVITATION_COUNT: items.length,\n\t\t};\n\n\t\tEventEmitter.emit(context, 'BX.Intranet.Invitation:onSendData', {\n\t\t\taction: 'inviteWithGroupDp',\n\t\t\tdata,\n\t\t\tanalyticsLabel,\n\t\t});\n\t}\n\n\tgetSubmitButtonText(): ?string\n\t{\n\t\treturn Loc.getMessage('BX24_INVITE_DIALOG_ACTION_INVITE');\n\t}\n}","import { Tag, Loc, Event, Dom } from 'main.core';\nimport { BaseEvent, EventEmitter } from 'main.core.events';\nimport { Analytics } from '../analytics';\nimport { Page } from './page';\nimport { CreateButton, CancelButton } from 'ui.buttons';\nimport { Popup } from 'main.popup';\n\nexport class IntegratorPage extends Page\n{\n\t#container: HTMLElement;\n\n\tconstructor(options)\n\t{\n\t\tsuper();\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\tif (this.#container)\n\t\t{\n\t\t\treturn this.#container;\n\t\t}\n\n\t\tthis.#container = Tag.render`\n\t\t\t<div class=\"invite-wrap js-intranet-invitation-block\" data-role=\"integrator-block\">\n\t\t\t\t<form method=\"POST\" name=\"INTEGRATOR_DIALOG_FORM\">\n\t\t\t\t\t<div class=\"invite-title-container\">\n\t\t\t\t\t\t<div class=\"invite-title-icon invite-title-icon-mass\">\n\t\t\t\t\t\t\t<div class=\"ui-icon-set --persons-3\"></div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"invite-title-text\">${Loc.getMessage('BX24_INVITE_DIALOG_TAB_INTEGRATOR_TITLE')}</div>\n\t\t\t\t\t<div class=\"invite-title-helper\" onclick=\"top.BX.Helper.show('redirect=detail&code=7725333');\"></div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"invite-content-container\">\n\t\t\t\t\t\t<div class=\"invite-form-container\">\n\t\t\t\t\t\t\t<div data-role=\"rows-container\">\n\t\t\t\t\t\t\t\t<div class=\"invite-form-row\">\n\t\t\t\t\t\t\t\t\t<div class=\"invite-form-col\">\n\t\t\t\t\t\t\t\t\t\t<div class=\"invite-content__field-lable\">${Loc.getMessage('INTRANET_INVITE_DIALOG_INTEGRATOR_EMAIL')}</div>\n\t\t\t\t\t\t\t\t\t\t<div class=\"ui-ctl ui-ctl-w100 ui-ctl-textbox ui-ctl-block ui-ctl-after-icon\">\n\t\t\t\t\t\t\t\t\t\t\t<input \n\t\t\t\t\t\t\t\t\t\t\t\ttype=\"text\" \n\t\t\t\t\t\t\t\t\t\t\t\tclass=\"ui-ctl-element\" \n\t\t\t\t\t\t\t\t\t\t\t\tvalue=\"\" \n\t\t\t\t\t\t\t\t\t\t\t\tmaxlength=\"50\"\n\t\t\t\t\t\t\t\t\t\t\t\tname=\"integrator_email\" \n\t\t\t\t\t\t\t\t\t\t\t\tid=\"integrator_email\" \n\t\t\t\t\t\t\t\t\t\t\t\tplaceholder=\"${Loc.getMessage('INTRANET_INVITE_DIALOG_INTEGRATOR_EMAIL')}\"\n\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t\t<button type=\"button\" class=\"ui-ctl-after ui-ctl-icon-clear\" style=\"display: none\"></button>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</form>\n\t\t\t</div>\n\t\t`;\n\n\t\tconst input = this.#container.querySelector('input');\n\n\t\tconst closeIcon = input.nextElementSibling;\n\t\tEvent.bind(input, 'input', () => {\n\t\t\tDom.style(closeIcon, 'display', input.value === '' ? 'none' : 'block');\n\t\t});\n\t\tEvent.bind(closeIcon, 'click', (event) => {\n\t\t\tevent.preventDefault();\n\t\t\tDom.style(closeIcon, 'display', 'none');\n\t\t});\n\n\t\treturn this.#container;\n\t}\n\n\tgetAnalyticTab(): string\n\t{\n\t\treturn Analytics.TAB_INTEGRATOR;\n\t}\n\n\tonSubmit(event: BaseEvent)\n\t{\n\t\tconst formNode = this.render().querySelector('form');\n\n\t\tconst data = {\n\t\t\tintegrator_email: formNode.integrator_email.value,\n\t\t};\n\t\tconst analyticsLabel = {\n\t\t\tINVITATION_TYPE: 'integrator',\n\t\t};\n\n\t\tconst message = Tag.render`\n\t\t\t<div class=\"invite-integrator-confirm-message\">\n\t\t\t\t${Loc.getMessage('INTRANET_INVITE_DIALOG_CONFIRM_INTEGRATOR_DESCRIPTION')}\n\t\t\t</div>\n\t\t`;\n\t\tconst moreLink = message.querySelector('span');\n\t\tEvent.bind(moreLink, 'click', () => {\n\t\t\ttop.BX.Helper.show('redirect=detail&code=20682986');\n\t\t});\n\n\t\tconst request = {\n\t\t\taction: 'inviteIntegrator',\n\t\t\tdata,\n\t\t\tanalyticsLabel,\n\t\t};\n\n\t\tconst popup = new Popup({\n\t\t\tid: 'integrator-confirm-invitation-popup',\n\t\t\tmaxWidth: 500,\n\t\t\tcloseIcon: false,\n\t\t\toverlay: true,\n\t\t\tcontentPadding: 10,\n\t\t\ttitleBar: Loc.getMessage('INTRANET_INVITE_DIALOG_CONFIRM_INTEGRATOR_TITLE'),\n\t\t\tcontent: message,\n\t\t\toffsetLeft: 100,\n\t\t\tbuttons: [\n\t\t\t\tnew CreateButton({\n\t\t\t\t\ttext: Loc.getMessage('INTRANET_INVITE_DIALOG_CONFIRM_INTEGRATOR_BUTTON_YES'),\n\t\t\t\t\tonclick: () => {\n\t\t\t\t\t\tconst context = event.getData()?.context;\n\t\t\t\t\t\tEventEmitter.emit(context, 'BX.Intranet.Invitation:onSendData', request);\n\n\t\t\t\t\t\tpopup.close();\n\t\t\t\t\t},\n\t\t\t\t}),\n\t\t\t\tnew CancelButton({\n\t\t\t\t\ttext: Loc.getMessage('INTRANET_INVITE_DIALOG_CONFIRM_INTEGRATOR_BUTTON_NO'),\n\t\t\t\t\tonclick: () => {\n\t\t\t\t\t\tpopup.close();\n\t\t\t\t\t},\n\t\t\t\t}),\n\t\t\t],\n\t\t\tevents: {\n\t\t\t\tonClose: () => {\n\t\t\t\t\tpopup.destroy();\n\t\t\t\t},\n\t\t\t},\n\t\t});\n\n\t\tpopup.show();\n\t}\n\n\tgetSubmitButtonText(): ?string\n\t{\n\t\treturn Loc.getMessage('BX24_INVITE_DIALOG_ACTION_INVITE');\n\t}\n}\n","import { Event, Type, Dom, Text, Loc } from 'main.core';\nimport { EventEmitter } from 'main.core.events';\nimport { Switcher, SwitcherSize } from 'ui.switcher';\nimport { Analytics } from './analytics';\nimport DepartmentControl from 'intranet.department-control';\nimport type { LinkPage } from './page/link-page';\nimport { SubmitButton } from './submit-button';\nimport type { Transport } from './transport';\n\nexport class SelfRegister\n{\n\t#container: HTMLElement;\n\t#isEnabled: boolean;\n\t#analytics: Analytics;\n\t#transport: Transport;\n\t#departmentControl: DepartmentControl;\n\t#page: LinkPage;\n\n\tconstructor(options)\n\t{\n\t\tthis.#container = options.container;\n\t\tthis.#isEnabled = options.isSelfRegisterEnabled;\n\t\tthis.#analytics = options.analytics;\n\t\tthis.#transport = options.transport;\n\t\tthis.#departmentControl = options.departmentControl;\n\t\tthis.#page = options.page;\n\n\t\tif (Type.isDomNode(this.#container))\n\t\t{\n\t\t\tthis.bindActions();\n\n\t\t\tconst switcherNode = this.#container.querySelector('.invite-dialog-fast-reg-control-switcher');\n\t\t\tthis.switcher = new Switcher({\n\t\t\t\tinputName: 'allow_register',\n\t\t\t\tid: 'allow_register',\n\t\t\t\tchecked: this.#isEnabled,\n\t\t\t\tnode: switcherNode,\n\t\t\t\tsize: SwitcherSize.small,\n\t\t\t\thandlers: {\n\t\t\t\t\ttoggled: this.toggleSettings.bind(this),\n\t\t\t\t},\n\t\t\t});\n\t\t}\n\n\t\tconst generateLinkBtnNode = this.#container.querySelector(\"[data-role='selfRegenerateSecretButton']\");\n\t\tthis.generateLinkHint = null;\n\t\tEvent.bind(generateLinkBtnNode, 'mouseover', (event) => {\n\t\t\tthis.generateLinkHint = this.showHintPopup(\n\t\t\t\tLoc.getMessage('INTRANET_INVITE_DIALOG_LINK_UPDATE_WARNING'),\n\t\t\t\tgenerateLinkBtnNode,\n\t\t\t);\n\t\t});\n\n\t\tEvent.bind(generateLinkBtnNode, 'mouseout', () => {\n\t\t\tthis.generateLinkHint?.destroy();\n\t\t\tthis.generateLinkHint = null;\n\t\t});\n\n\t\tEventEmitter.subscribe('BX.Intranet.Invitation:confirmShutdown', (event: BaseEvent) => {\n\t\t\tconst data = event.getData();\n\t\t\tthis.showNotificationPopup(data);\n\t\t});\n\t}\n\n\tbindActions()\n\t{\n\t\tconst regenerateButton = this.#container.querySelector(\"[data-role='selfRegenerateSecretButton']\");\n\t\tif (Type.isDomNode(regenerateButton))\n\t\t{\n\t\t\tEvent.bind(regenerateButton, 'click', () => {\n\t\t\t\tthis.regenerateSecret();\n\t\t\t});\n\t\t}\n\n\t\tconst copyRegisterUrlButton = this.#container.querySelector(\"[data-role='copyRegisterUrlButton']\");\n\t\tif (Type.isDomNode(copyRegisterUrlButton))\n\t\t{\n\t\t\tEvent.bind(copyRegisterUrlButton, 'click', () => {\n\t\t\t\tthis.copyRegisterUrl();\n\t\t\t});\n\t\t}\n\n\t\tconst allowRegisterConfirm = this.#container.querySelector(\"[data-role='allowRegisterConfirm']\");\n\t\tif (Type.isDomNode(allowRegisterConfirm))\n\t\t{\n\t\t\tEvent.bind(allowRegisterConfirm, 'change', () => {\n\t\t\t\tEventEmitter.emit('BX.Intranet.Invitation:onChangeForm');\n\t\t\t\tthis.#page.setButtonState(SubmitButton.ENABLED_STATE);\n\t\t\t\tthis.toggleWhiteList(allowRegisterConfirm);\n\t\t\t});\n\t\t}\n\n\t\tconst selfWhiteList = this.#container.querySelector(\"[data-role='selfWhiteList']\");\n\t\tif (Type.isDomNode(selfWhiteList))\n\t\t{\n\t\t\tEvent.bind(selfWhiteList, 'input', () => {\n\t\t\t\tthis.#page.setButtonState(SubmitButton.ENABLED_STATE);\n\t\t\t\tEventEmitter.emit('BX.Intranet.Invitation:onChangeForm');\n\t\t\t});\n\t\t}\n\t}\n\n\tregenerateSecret()\n\t{\n\t\tthis.#transport.send({\n\t\t\taction: 'self',\n\t\t\tdata: { allow_register_secret: Text.getRandom(8) },\n\t\t}).then((response) => {\n\t\t\ttop.BX.UI.Notification.Center.notify({\n\t\t\t\tcontent: Loc.getMessage('INTRANET_INVITE_DIALOG_LINK_UPDATE_SUCCESS'),\n\t\t\t\tautoHideDelay: 2500,\n\t\t\t});\n\t\t}, (response) => {\n\t\t\ttop.BX.UI.Notification.Center.notify({\n\t\t\t\tcontent: Loc.getMessage('INTRANET_INVITE_DIALOG_LINK_UPDATE_ERROR'),\n\t\t\t\tautoHideDelay: 2500,\n\t\t\t});\n\t\t});\n\t}\n\n\tcopyRegisterUrl()\n\t{\n\t\tconst copyBtnNode = this.#container.querySelector(\"[data-role='copyRegisterUrlButton']\");\n\t\tif (Dom.hasClass(copyBtnNode, 'ui-btn-wait'))\n\t\t{\n\t\t\treturn;\n\t\t}\n\t\tDom.addClass(copyBtnNode, 'ui-btn-wait');\n\t\tthis.#transport.send({\n\t\t\taction: 'getInviteLink',\n\t\t\tdata: {\n\t\t\t\tdepartmentsId: this.#departmentControl.getValues(),\n\t\t\t},\n\t\t}).then((response) => {\n\t\t\tDom.removeClass(copyBtnNode, 'ui-btn-wait');\n\t\t\tconst invitationUrl = response.data?.invitationLink;\n\t\t\tif (Type.isStringFilled(invitationUrl))\n\t\t\t{\n\t\t\t\tthis.copyToClipboard(invitationUrl)\n\t\t\t\t\t.then(r => {\n\t\t\t\t\t\ttop.BX.UI.Notification.Center.notify({\n\t\t\t\t\t\t\tcontent: Loc.getMessage('BX24_INVITE_DIALOG_COPY_URL'),\n\t\t\t\t\t\t\tautoHideDelay: 2500,\n\t\t\t\t\t\t});\n\t\t\t\t\t})\n\t\t\t\t\t.catch((e) => {\n\t\t\t\t\t\tconsole.log(e);\n\t\t\t\t\t});\n\n\t\t\t\tthis.#analytics.send();\n\t\t\t}\n\t\t}, (response) => {\n\t\t\tDom.removeClass(copyBtnNode, 'ui-btn-wait');\n\t\t});\n\t}\n\n\tasync copyToClipboard(textToCopy: string): Promise<void>\n\t{\n\t\tif (!Type.isString(textToCopy))\n\t\t{\n\t\t\treturn Promise.reject();\n\t\t}\n\n\t\t// navigator.clipboard defined only if window.isSecureContext === true\n\t\t// so or https should be activated, or localhost address\n\t\tif (window.isSecureContext && navigator.clipboard)\n\t\t{\n\t\t\t// safari not allowed clipboard manipulation as result of ajax request\n\t\t\t// so timeout is hack for this, to prevent \"not have permission\"\n\t\t\treturn new Promise((resolve, reject) => {\n\t\t\t\tsetTimeout(() => (\n\t\t\t\t\tnavigator.clipboard\n\t\t\t\t\t\t.writeText(textToCopy)\n\t\t\t\t\t\t.then(() => resolve())\n\t\t\t\t\t\t.catch((e) => reject(e))\n\t\t\t\t), 0);\n\t\t\t});\n\t\t}\n\n\t\treturn BX.clipboard?.copy(textToCopy) ? Promise.resolve() : Promise.reject();\n\t}\n\n\tshowHintPopup(message, bindNode)\n\t{\n\t\tif (!Type.isDomNode(bindNode) || !message)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst popup = new BX.PopupWindow('inviteHint' + Text.getRandom(8), bindNode, {\n\t\t\tcontent: message,\n\t\t\tzIndex: 15000,\n\t\t\tangle: true,\n\t\t\toffsetTop: 0,\n\t\t\toffsetLeft: 50,\n\t\t\tcloseIcon: false,\n\t\t\tautoHide: true,\n\t\t\tdarkMode: true,\n\t\t\toverlay: false,\n\t\t\tmaxWidth: 400,\n\t\t\tevents: {\n\t\t\t\tonAfterPopupShow() {\n\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\tthis.close();\n\t\t\t\t\t}, 4000);\n\t\t\t\t},\n\t\t\t},\n\t\t});\n\n\t\tpopup.show();\n\n\t\treturn popup;\n\t}\n\n\tshowNotificationPopup(data: Object)\n\t{\n\t\tconst popup = new BX.PopupWindow({\n\t\t\tclassName: 'confirm-self-register',\n\t\t\ttitleBar: Loc.getMessage('INTRANET_INVITE_DIALOG_SELF_CONFIRM_POPUP_TITLE'),\n\t\t\tcontent: Loc.getMessage('INTRANET_INVITE_DIALOG_SELF_CONFIRM_POPUP_TEXT'),\n\t\t\twidth: 364,\n\t\t\theight: 188,\n\t\t\tcloseIcon: true,\n\t\t\tbuttons: [\n\t\t\t\tnew BX.UI.Button({\n\t\t\t\t\ttext: Loc.getMessage('INTRANET_INVITE_DIALOG_SELF_CONFIRM_POPUP_OK'),\n\t\t\t\t\tcolor: BX.UI.Button.Color.PRIMARY,\n\t\t\t\t\tround: true,\n\t\t\t\t\tevents: {\n\t\t\t\t\t\tclick() {\n\t\t\t\t\t\t\tpopup.close();\n\t\t\t\t\t\t\tEventEmitter.emit(data.page, 'BX.Intranet.Invitation:submit', {\n\t\t\t\t\t\t\t\tcontext: data.context,\n\t\t\t\t\t\t\t\tisConfirm: true,\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t}),\n\t\t\t\tnew BX.UI.ApplyButton({\n\t\t\t\t\ttext: Loc.getMessage('INTRANET_INVITE_DIALOG_SELF_CONFIRM_POPUP_CANCEL'),\n\t\t\t\t\tround: true,\n\t\t\t\t\tevents: {\n\t\t\t\t\t\tclick() {\n\t\t\t\t\t\t\tpopup.close();\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t}),\n\t\t\t],\n\t\t\tevents: {\n\t\t\t\tonClose: () => {\n\t\t\t\t\tEventEmitter.emit('BX.Intranet.Invitation:onSubmitReady');\n\t\t\t\t},\n\t\t\t},\n\t\t});\n\n\t\tpopup.show();\n\t}\n\n\ttoggleSettings()\n\t{\n\t\tEventEmitter.emit('BX.Intranet.Invitation:onChangeForm');\n\t\tthis.#page.setButtonState(SubmitButton.ENABLED_STATE);\n\t\tconst controlBlock = this.#container.querySelector(\".js-invite-dialog-fast-reg-control-container\");\n\t\tif (Type.isDomNode(controlBlock))\n\t\t{\n\t\t\tDom.toggleClass(controlBlock, 'disallow-registration');\n\t\t}\n\n\t\tconst settingsBlock = this.#container.querySelector(\"[data-role='selfSettingsBlock']\");\n\t\tif (Type.isDomNode(settingsBlock))\n\t\t{\n\t\t\tDom.style(settingsBlock, 'display', this.switcher.checked ? 'block' : 'none');\n\t\t}\n\t}\n\n\ttoggleWhiteList(inputElement)\n\t{\n\t\tconst selfWhiteList = this.#container.querySelector(\"[data-role='selfWhiteList']\");\n\t\tif (Type.isDomNode(selfWhiteList))\n\t\t{\n\t\t\tDom.style(selfWhiteList, 'display', inputElement.checked ? 'block' : 'none');\n\t\t}\n\t}\n}\n","import { Tag, Loc, Type, Dom } from 'main.core';\nimport { EventEmitter } from 'main.core.events';\nimport { Analytics } from '../analytics';\nimport DepartmentControl from 'intranet.department-control';\nimport { SelfRegister } from '../self-register';\nimport { Transport } from '../transport';\nimport { Page } from './page';\nimport { SubmitButton } from '../submit-button';\n\nexport class LinkPage extends Page\n{\n\t#container: HTMLElement;\n\t#isAdmin: boolean;\n\t#isCloud: boolean;\n\t#fastRegistrationAvailable: boolean;\n\t#needConfirmRegistration: boolean;\n\t#wishlist: string;\n\t#departmentControl: DepartmentControl;\n\n\t#linkRegisterEnabled: boolean;\n\t#analytics: Analytics;\n\t#transport: Transport;\n\t#btnState: string;\n\n\tconstructor(options)\n\t{\n\t\tsuper();\n\t\tthis.#isAdmin = options.isAdmin === true;\n\t\tthis.#isCloud = options.isCloud === true;\n\t\tthis.#fastRegistrationAvailable = options.fastRegistrationAvailable === true;\n\t\tthis.#needConfirmRegistration = options.needConfirmRegistration === true;\n\t\tthis.#wishlist = Type.isStringFilled(options.wishlist) ? options.wishlist : '';\n\t\tthis.#departmentControl = options.departmentControl instanceof DepartmentControl ? options.departmentControl : null;\n\t\tthis.#linkRegisterEnabled = options.linkRegisterEnabled;\n\t\tthis.#analytics = options.analytics;\n\t\tthis.#transport = options.transport;\n\t\tthis.#btnState = SubmitButton.DISABLED_STATE;\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\tif (this.#container)\n\t\t{\n\t\t\treturn this.#container;\n\t\t}\n\n\t\tthis.#container = Tag.render`\n\t\t\t<div class=\"invite-wrap js-intranet-invitation-block\" data-role=\"self-block\">\n\t\t\t\t<div class=\"invite-title-container\">\n\t\t\t\t\t<div class=\"invite-title-icon invite-title-icon-link\">\n\t\t\t\t\t\t<div class=\"ui-icon-set --link-3\"></div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"invite-title-text\">${Loc.getMessage('INTRANET_INVITE_DIALOG_FAST_REG_TITLE')}</div>\n\t\t\t\t\t<div class=\"invite-title-helper\" onclick=\"top.BX.Helper.show('redirect=detail&code=6546149');\"></div>\n\t\t\t\t</div>\n\t\t\t\t<form method=\"POST\" name=\"SELF_DIALOG_FORM\">\n\t\t\t\t\t${this.#isAdmin ? this.#renderFastRegistrationSwitcher() : ''}\n\t\t\t\t\t<div class=\"invite-content-container --department-bg\">\n\t\t\t\t\t\t<div class=\"invite-form-container\">\n\t\t\t\t\t\t\t<div \n\t\t\t\t\t\t\t\tstyle=\"border-top: none; ${this.#fastRegistrationAvailable ? '' : 'display: none;'}\" \n\t\t\t\t\t\t\t\tdata-role=\"selfSettingsBlock\" \n\t\t\t\t\t\t\t\tid=\"intranet-dialog-tab-content-self-block\" \n\t\t\t\t\t\t\t\tclass=\"invite-dialog-inv-link-block\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<div id=\"invitation-department-status\" class=\"invitation-department__status\"></div>\n\t\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t\t${this.#isAdmin ? '' : this.#renderCopyBtnDescription()}\n\t\t\t\t\t\t\t\t\t<div class=\"intranet-invitation__link-department-control\"></div>\n\t\t\t\t\t\t\t\t\t<div class=\"invite-form-container-reg-row\">\n\t\t\t\t\t\t\t\t\t\t<span class=\"ui-btn ui-btn-primary ui-btn-themes ui-btn-icon-copy invite-form-btn-copy\" data-role=\"copyRegisterUrlButton\">\n\t\t\t\t\t\t\t\t\t\t\t${Loc.getMessage('BX24_INVITE_DIALOG_COPY_LINK')}\n\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t${this.#isAdmin ? this.#renderUpdateLinkBtn() : ''}\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t${this.#isAdmin && this.#isCloud ? this.#renderConfirmRegistrationCheckbox() : ''}\n\t\t\t\t\t\t\t\t\t${this.#isCloud ? this.#renderWhiteListField() : ''}\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</form>\n\t\t\t\t${!this.#isAdmin && !this.#fastRegistrationAvailable ? this.#renderWarningContainer() : ''}\n\t\t\t</div>\n\t\t`;\n\n\t\tDom.prepend(\n\t\t\tthis.#departmentControl.render(),\n\t\t\tthis.#container.querySelector('.intranet-invitation__link-department-control'),\n\t\t);\n\n\t\tnew SelfRegister({\n\t\t\tcontainer: this.#container,\n\t\t\tisSelfRegisterEnabled: this.#linkRegisterEnabled,\n\t\t\tanalytics: this.#analytics,\n\t\t\ttransport: this.#transport,\n\t\t\tdepartmentControl: this.#departmentControl,\n\t\t\tpage: this,\n\t\t});\n\n\t\treturn this.#container;\n\t}\n\n\t#renderCopyBtnDescription(): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"invite-form__copy-button-description\">\n\t\t\t\t${Loc.getMessage('INTRANET_INVITE_COPY_BUTTON_DESCRIPTION')}\n\t\t\t</div>\n\t\t`;\n\t}\n\n\t#renderUpdateLinkBtn(): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<span data-role=\"selfRegenerateSecretButton\">\n\t\t\t\t<a\n\t\t\t\thref=\"javascript:void(0)\"\n\t\t\t\tclass=\"invite-dialog-update-link\"\n\t\t\t\t>\n\t\t\t\t\t${Loc.getMessage('BX24_INVITE_DIALOG_REGISTER_NEW_LINK')}\n\t\t\t\t</a>\n\t\t\t</span>\n\t\t`;\n\t}\n\n\t#renderFastRegistrationSwitcher(): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<label class=\"invite-dialog-fast-reg-control-container js-invite-dialog-fast-reg-control-container ${this.#fastRegistrationAvailable ? '' : 'disallow-registration'}\" for=\"allow_register\">\n\t\t\t\t<div class=\"invite-dialog-fast-reg-control-switcher\" data-role=\"self-switcher\"></div>\n\t\t\t\t<span class=\"invite-dialog-fast-reg-control-label\">\n\t\t\t\t\t<div class=\"invite-dialog-fast-reg-control-label-title\">${Loc.getMessage('INTRANET_INVITE_ALLOW_INVITATION_LINK')}</div>\n\t\t\t\t</span>\n\t\t\t</label>\n\t\t`;\n\t}\n\n\t#renderConfirmRegistrationCheckbox(): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div style=\"padding-top: 12px;\">\n\t\t\t\t<label class=\"ui-ctl ui-ctl-w100 ui-ctl-checkbox invite-form-check-box\">\n\t\t\t\t\t<input\n\t\t\t\t\ttype=\"checkbox\"\n\t\t\t\t\tclass=\"ui-ctl-element\"\n\t\t\t\t\tname=\"allow_register_confirm\"\n\t\t\t\t\tid=\"allow_register_confirm\"\n\t\t\t\t\tdata-role=\"allowRegisterConfirm\"\n\t\t\t\t\t${this.#needConfirmRegistration ? 'checked' : ''}\n\t\t\t\t\t${this.#isAdmin ? '' : 'disabled'}\n\t\t\t\t\t/>\n\t\t\t\t\t<div class=\"ui-ctl-label-text\">${Loc.getMessage('INTRANET_INVITE_DIALOG_FAST_REG_TYPE')}</div>\n\t\t\t\t</label>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\t#renderWhiteListField(): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t<div id=\"intranet-dialog-tab-content-self-whitelist\" data-role=\"selfWhiteList\" ${this.#needConfirmRegistration ? '' : 'style=\"display: none\"'}>\n\t\t\t<span class=\"invite-form-ctl-title\">\n\t\t\t\t${Loc.getMessage('INTRANET_INVITE_DIALOG_FAST_REG_DOMAINS')}\n\t\t\t</span>\n\t\t\t<label class=\"ui-ctl ui-ctl-w75 ui-ctl-textbox\">\n\t\t\t\t<input\n\t\t\t\ttype=\"text\"\n\t\t\t\t${this.#isAdmin ? '' : 'disabled'}\n\t\t\t\tclass=\"ui-ctl-element\"\n\t\t\t\tname=\"allow_register_whitelist\"\n\t\t\t\tvalue=\"${this.#wishlist}\"\n\t\t\t\tplaceholder=\"${Loc.getMessage('BX24_INVITE_DIALOG_REGISTER_TYPE_DOMAINS_PLACEHOLDER')}\"\n\t\t\t\t/>\n\t\t\t</label>\n\t\t</div>\n\t\t`;\n\t}\n\n\t#renderWarningContainer(): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"intranet-invitation__error-box\">\n\t\t\t\t<div class=\"intranet-invitation__error-icon\"></div>\n\t\t\t\t<div class=\"intranet-invitation__error-title\">${Loc.getMessage('INTRANET_INVITE_ALERT_INVITATION_LINK_DISABLED')}</div>\n\t\t\t\t<div class=\"intranet-invitation__error-desc\">${Loc.getMessage('INTRANET_INVITE_ALERT_INVITATION_LINK_DISABLED_DESCRIPTION')}</div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tgetAnalyticTab(): string\n\t{\n\t\treturn Analytics.TAB_LINK;\n\t}\n\n\tonSubmit(event: BaseEvent)\n\t{\n\t\tconst formNode = this.render().querySelector('form');\n\t\tconst data = {\n\t\t\tallow_register: formNode.allow_register.value,\n\t\t\tallow_register_confirm: formNode?.allow_register_confirm?.checked ? 'Y' : 'N',\n\t\t\tallow_register_whitelist: formNode?.allow_register_whitelist?.value ?? '',\n\t\t};\n\n\t\tconst context = event.getData()?.context;\n\t\tconst isConfirm = event.getData()?.isConfirm;\n\n\t\tif (formNode.allow_register.value === 'N' && !isConfirm)\n\t\t{\n\t\t\tEventEmitter.emit('BX.Intranet.Invitation:confirmShutdown', {\n\t\t\t\tpage: this,\n\t\t\t\tcontext,\n\t\t\t});\n\n\t\t\treturn;\n\t\t}\n\n\t\tEventEmitter.emit(context, 'BX.Intranet.Invitation:onSendData', {\n\t\t\taction: 'self',\n\t\t\tdata,\n\t\t});\n\t}\n\n\tgetSubmitButtonText(): ?string\n\t{\n\t\treturn Loc.getMessage('BX24_INVITE_DIALOG_ACTION_SAVE');\n\t}\n\n\tgetButtonState(): ?string\n\t{\n\t\treturn this.#btnState;\n\t}\n\n\tsetButtonState(state: string): ?string\n\t{\n\t\tthis.#btnState = state;\n\t}\n}\n","import { Loc, Type, Event } from 'main.core';\nimport { InvitationInput, InvitationInputType } from 'intranet.invitation-input';\n\nexport type MassInvitationFieldType = {\n\tplaceholder: string,\n\tuseOnlyPhone: boolean,\n\tsmsAvailable: boolean,\n}\n\nexport default class MassInvitationField\n{\n\t#input: InvitationInput;\n\t#invitationType: InvitationInputType;\n\t#isPhoneEnabled: boolean;\n\t#isEmailEnabled: boolean;\n\n\tconstructor(options: MassInvitationFieldType)\n\t{\n\t\tthis.#invitationType = options.useOnlyPhone\n\t\t\t? InvitationInputType.PHONE\n\t\t\t: (options.smsAvailable ? InvitationInputType.ALL : InvitationInputType.EMAIL);\n\t\tthis.#isPhoneEnabled = [InvitationInputType.ALL, InvitationInputType.PHONE].includes(this.#invitationType);\n\t\tthis.#isEmailEnabled = [InvitationInputType.ALL, InvitationInputType.EMAIL].includes(this.#invitationType);\n\n\t\tthis.#input = new InvitationInput({ inputType: this.#invitationType });\n\t\tthis.#input.getTagSelector().setPlaceholder(\n\t\t\tType.isStringFilled(options.placeholder)\n\t\t\t\t? options.placeholder\n\t\t\t\t: this.#getDialogInputMessage(),\n\t\t);\n\t\tBX.Dom.style(this.#input.getTagSelector().getContainer(), 'height', '103px');\n\t\tBX.Dom.style(this.#input.getTagSelector().getContainer(), 'cursor', 'text');\n\t\tEvent.bind(this.#input.getTagSelector().getContainer(), 'click', () => {\n\t\t\tthis.#input.getTagSelector().focusTextBox();\n\t\t});\n\t}\n\n\t#getDialogInputMessage(): string\n\t{\n\t\tif (this.#isPhoneEnabled && this.#isEmailEnabled)\n\t\t{\n\t\t\treturn Loc.getMessage('INTRANET_INVITE_DIALOG_EMAIL_OR_PHONE_INPUT');\n\t\t}\n\t\telse if (this.#isPhoneEnabled)\n\t\t{\n\t\t\treturn Loc.getMessage('INTRANET_INVITE_DIALOG_PHONE_INPUT');\n\t\t}\n\t\telse\n\t\t{\n\t\t\treturn Loc.getMessage('INTRANET_INVITE_DIALOG_EMAIL_INPUT');\n\t\t}\n\t}\n\n\trenderTo(node: HTMLElement)\n\t{\n\t\tthis.#input.renderTo(node);\n\t}\n\n\tgetValue(): Object\n\t{\n\t\tconst selector = this.#input.getTagSelector();\n\t\tconst tags = selector.getTags();\n\t\tconst values = [];\n\t\tconst errorElements = [];\n\n\t\ttags.forEach((tag) => {\n\t\t\tif (this.#isPhoneEnabled && tag.getEntityType() === 'phone')\n\t\t\t{\n\t\t\t\tvalues.push(tag.getTitle());\n\t\t\t}\n\t\t\telse if (this.#isEmailEnabled && tag.getEntityType() === 'email')\n\t\t\t{\n\t\t\t\tvalues.push(tag.getTitle());\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\terrorElements.push(tag.getTitle());\n\t\t\t}\n\t\t});\n\n\t\treturn { values, errorElements };\n\t}\n}\n","import { Tag, Loc, Event, Type } from 'main.core';\nimport { EventEmitter } from 'main.core.events';\nimport { Analytics } from '../analytics';\nimport DepartmentControl from 'intranet.department-control';\nimport MassInvitationField from '../mass-invitation-field';\nimport { Page } from './page';\n\nexport class MassPage extends Page\n{\n\t#container: HTMLElement;\n\t#smsAvailable: boolean;\n\t#useOnlyPhone: boolean;\n\t#onClickSwitchMode: function;\n\t#massInvitationField: MassInvitationField;\n\t#departmentControl: DepartmentControl;\n\n\tconstructor(options)\n\t{\n\t\tsuper();\n\t\tthis.#smsAvailable = options.smsAvailable === true;\n\t\tthis.#useOnlyPhone = options.useOnlyPhone === true;\n\t\tthis.#onClickSwitchMode = Type.isFunction(options.onClickSwitchMode) ? options.onClickSwitchMode : null;\n\t\tthis.#massInvitationField = new MassInvitationField({\n\t\t\tplaceholder: '',\n\t\t\tuseOnlyPhone: this.#useOnlyPhone,\n\t\t\tsmsAvailable: this.#smsAvailable,\n\t\t});\n\t\tthis.#departmentControl = options.departmentControl instanceof DepartmentControl ? options.departmentControl : null;\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\tif (this.#container)\n\t\t{\n\t\t\treturn this.#container;\n\t\t}\n\n\t\tconst helper = Tag.render`\n\t\t\t<div class=\"invite-title-helper\"\n\t\t\t\t data-hint=\"${Loc.getMessage('INTRANET_INVITE_DIALOG_MASS_INVITE_HINT')}\"\n\t\t\t\t data-hint-no-icon\n\t\t\t>\n\t\t\t</div>\n\t\t`;\n\n\t\tconst sufix = this.#useOnlyPhone ? 'PHONE' : (this.#smsAvailable ? 'EMAIL_AND_PHONE' : 'EMAIL');\n\t\tthis.#container = Tag.render`\n\t\t\t<div class=\"invite-wrap js-intranet-invitation-block\" data-role=\"mass-invite-block\">\n\t\t\t\t<div class=\"invite-title-container\">\n\t\t\t\t\t<div class=\"invite-title-icon invite-title-icon-mass\">\n\t\t\t\t\t\t<div class=\"ui-icon-set --person-letter\"></div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"invite-title-text\">${Loc.getMessage('INTRANET_INVITE_DIALOG_MASS_TITLE')}</div>\n\t\t\t\t\t${this.#smsAvailable ? helper : ''}\n\t\t\t\t</div>\n\t\t\t\t<div class=\"invite-content-container\">\n\t\t\t\t\t<div class=\"invite-form-container\">\n\t\t\t\t\t\t<form method=\"POST\" name=\"MASS_INVITE_DIALOG_FORM\" class=\"invite-form-container\">\n\t\t\t\t\t\t\t<div class=\"invite-content__field-lable\">\n\t\t\t\t\t\t\t\t${Loc.getMessage(`INTRANET_INVITE_DIALOG_MASS_TITLE_${sufix}`)}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div id=\"invite-content__mass-field\">\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class=\"invite-form-ctl-description --border-bottom\">\n\t\t\t\t\t\t\t\t<span href=\"javascript:void(0)\"\n\t\t\t\t\t\t\t\t   class=\"invite-content__switch_button swith-email-invitation-mass-mode\"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t${Loc.getMessage('INTRANET_INVITE_DIALOG_ADD_PERSONAL')}\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class=\"invite-form-row\" id=\"intranet-invitation__department-control-palce\"></div>\n\t\t\t\t\t\t</form>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\n\t\tthis.#massInvitationField?.renderTo(this.#container.querySelector('#invite-content__mass-field'));\n\t\tthis.#departmentControl.renderTo(this.#container.querySelector('#intranet-invitation__department-control-palce'));\n\n\t\tEvent.bind(\n\t\t\tthis.#container.querySelector('.swith-email-invitation-mass-mode'),\n\t\t\t'click',\n\t\t\tthis.#onClickSwitchMode,\n\t\t);\n\n\t\treturn this.#container;\n\t}\n\n\tgetAnalyticTab(): string\n\t{\n\t\treturn Analytics.TAB_MASS;\n\t}\n\n\tonSubmit(event: BaseEvent): void\n\t{\n\t\tconst { values, errorElements } = this.#massInvitationField.getValue();\n\t\tconst errors = [];\n\n\t\tif (values.length <= 0)\n\t\t{\n\t\t\terrors.push(this.#getEmptyError());\n\t\t}\n\n\t\tif (errorElements.length > 0)\n\t\t{\n\t\t\terrors.push(this.#getValidateError());\n\t\t}\n\n\t\tif (errors.length > 0)\n\t\t{\n\t\t\tEventEmitter.emit(window.invitationForm, 'BX.Intranet.Invitation:onSendData', {\n\t\t\t\terrors,\n\t\t\t});\n\n\t\t\treturn;\n\t\t}\n\n\t\tconst data = {\n\t\t\tinvitationText: values.join(' '),\n\t\t\tdepartmentIds: this.#departmentControl.getValues(),\n\t\t\ttab: 'mass',\n\t\t};\n\n\t\tconst analyticsLabel = {\n\t\t\tINVITATION_TYPE: 'mass',\n\t\t};\n\n\t\tconst context = event.getData()?.context;\n\t\tEventEmitter.emit(context, 'BX.Intranet.Invitation:onSendData', {\n\t\t\taction: 'massInvite',\n\t\t\tdata,\n\t\t\tanalyticsLabel,\n\t\t});\n\t}\n\n\t#getEmptyError(): string\n\t{\n\t\tif (this.#useOnlyPhone)\n\t\t{\n\t\t\treturn Loc.getMessage('INTRANET_INVITE_DIALOG_EMPTY_ERROR_PHONE');\n\t\t}\n\t\telse if (this.#smsAvailable)\n\t\t{\n\t\t\treturn Loc.getMessage('INTRANET_INVITE_DIALOG_EMPTY_ERROR_EMAIL_AND_PHONE');\n\t\t}\n\n\t\treturn Loc.getMessage('INTRANET_INVITE_DIALOG_EMPTY_ERROR_EMAIL');\n\t}\n\n\t#getValidateError(): string\n\t{\n\t\tif (this.#useOnlyPhone)\n\t\t{\n\t\t\treturn Loc.getMessage('INTRANET_INVITE_DIALOG_VALIDATE_ERROR_PHONE');\n\t\t}\n\t\telse if (this.#smsAvailable)\n\t\t{\n\t\t\treturn Loc.getMessage('INTRANET_INVITE_DIALOG_VALIDATE_ERROR_EMAIL_AND_PHONE');\n\t\t}\n\n\t\treturn Loc.getMessage('INTRANET_INVITE_DIALOG_VALIDATE_ERROR_EMAIL');\n\t}\n\n\tgetSubmitButtonText(): ?string\n\t{\n\t\treturn Loc.getMessage('BX24_INVITE_DIALOG_ACTION_INVITE');\n\t}\n}","import { Tag, Loc } from 'main.core';\nimport { EventEmitter } from 'main.core.events';\nimport { TagSelector } from 'ui.entity-selector';\nimport { Analytics } from '../analytics';\nimport DepartmentControl from 'intranet.department-control';\nimport { InputRowFactory } from '../input-row-factory';\nimport { Page } from './page';\n\nexport class RegisterPage extends Page\n{\n\t#container: HTMLElement;\n\t#inputsFactory: InputRowFactory;\n\t#isCloud: boolean;\n\t#withoutConfirm: boolean;\n\t#tagSelectorGroup: TagSelector;\n\t#departmentControl: DepartmentControl;\n\n\tconstructor(options)\n\t{\n\t\tsuper();\n\t\tthis.#isCloud = options.isCloud === true;\n\t\tthis.#withoutConfirm = options.withoutConfirm === true;\n\t\tthis.#inputsFactory = options.inputsFactory instanceof InputRowFactory ? options.inputsFactory : null;\n\t\tthis.#tagSelectorGroup = options.tagSelectorGroup instanceof TagSelector ? options.tagSelectorGroup : null;\n\t\tthis.#departmentControl = options.departmentControl instanceof DepartmentControl ? options.departmentControl : null;\n\t}\n\n\trender(): HTMLElement\n\t{\n\t\tif (this.#container)\n\t\t{\n\t\t\treturn this.#container;\n\t\t}\n\n\t\tthis.#container = Tag.render`\n\t\t\t<div class=\"invite-wrap js-intranet-invitation-block\" data-role=\"add-block\">\n\t\t\t\t<form method=\"POST\" name=\"ADD_DIALOG_FORM\">\n\t\t\t\t\t<div class=\"invite-title-container\">\n\t\t\t\t\t\t<div class=\"invite-title-icon invite-title-icon-registration\">\n\t\t\t\t\t\t\t<div class=\"ui-icon-set --person-plus\"></div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"invite-title-text\">${Loc.getMessage('INTRANET_INVITE_DIALOG_ADD_TITLE')}</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"invite-content-container\">\n\t\t\t\t\t\t<div class=\"invite-form-container\">\n\t\t\t\t\t\t\t<div data-role=\"rows-container\">\n\t\t\t\t\t\t\t\t${this.#renderFields()}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class=\"invite-form-row\">\n\t\t\t\t\t\t\t\t<div class=\"invite-form-col\">\n\t\t\t\t\t\t\t\t\t<div class=\"invite-content__field-lable\">${Loc.getMessage('INTRANET_INVITE_DIALOG_GROUP_INPUT')}</div>\n\t\t\t\t\t\t\t\t\t<div data-role=\"entity-selector-container\"></div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class=\"invite-form-row\" id=\"intranet-invitation__department-control-palce\"></div>\n\t\t\t\t\t\t\t<div class=\"invite-form-row\">\n\t\t\t\t\t\t\t\t<div class=\"invite-form-col\">\n\t\t\t\t\t\t\t\t\t<div class=\"invite-dialog-inv-form-checkbox-wrap\">\n\t\t\t\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\t\t\ttype=\"checkbox\"\n\t\t\t\t\t\t\t\t\t\tname=\"ADD_SEND_PASSWORD\"\n\t\t\t\t\t\t\t\t\t\tid=\"ADD_SEND_PASSWORD\"\n\t\t\t\t\t\t\t\t\t\tvalue=\"Y\"\n\t\t\t\t\t\t\t\t\t\tclass=\"invite-dialog-inv-form-checkbox\"\n\t\t\t\t\t\t\t\t\t\t${this.#withoutConfirm ? 'checked' : ''}\n\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t<label class=\"invite-dialog-inv-form-checkbox-label\" for=\"ADD_SEND_PASSWORD\">\n\t\t\t\t\t\t\t\t\t\t\t${Loc.getMessage(this.#isCloud ? 'BX24_INVITE_DIALOG_ADD_WO_CONFIRMATION_TITLE' : 'BX24_INVITE_DIALOG_ADD_SEND_PASSWORD_TITLE')}\n\t\t\t\t\t\t\t\t\t\t\t${this.#isCloud ? '' : '<span id=\"ADD_SEND_PASSWORD_EMAIL\"></span>'}\n\t\t\t\t\t\t\t\t\t\t</label>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</form>\n\t\t\t</div>\n\t\t`;\n\t\tthis.#tagSelectorGroup.renderTo(this.#container.querySelector('[data-role=\"entity-selector-container\"]'));\n\t\tthis.#departmentControl.renderTo(this.#container.querySelector('#intranet-invitation__department-control-palce'));\n\n\t\treturn this.#container;\n\t}\n\n\t#renderFields(): HTMLElement\n\t{\n\t\tconst element = Tag.render`\n\t\t\t<div>\n\t\t\t\t<div class=\"invite-form-row\">\n\t\t\t\t\t<div class=\"invite-form-col\">\n\t\t\t\t\t\t<div class=\"invite-content__field-lable\">${Loc.getMessage('BX24_INVITE_DIALOG_ADD_NAME_TITLE')}</div>\n\t\t\t\t\t\t<div class=\"ui-ctl ui-ctl-w100 ui-ctl-textbox ui-ctl-block ui-ctl-after-icon\">\n\t\t\t\t\t\t\t<input type=\"text\" name=\"ADD_NAME\" placeholder=\"${Loc.getMessage('INTRANET_INVITE_DIALOG_PLACEHOLDER_NAME')}\" id=\"ADD_NAME\" class=\"ui-ctl-element\">\n\t\t\t\t\t\t\t<button type=\"button\" class=\"ui-ctl-after ui-ctl-icon-clear\" style=\"display: none\"></button>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"invite-form-row\">\n\t\t\t\t\t<div class=\"invite-form-col\">\n\t\t\t\t\t\t<div class=\"invite-content__field-lable\">${Loc.getMessage('BX24_INVITE_DIALOG_ADD_LAST_NAME_TITLE')}</div>\n\t\t\t\t\t\t<div class=\"ui-ctl ui-ctl-w100 ui-ctl-textbox ui-ctl-block ui-ctl-after-icon\">\n\t\t\t\t\t\t\t<input type=\"text\" name=\"ADD_LAST_NAME\" placeholder=\"${Loc.getMessage('INTRANET_INVITE_DIALOG_PLACEHOLDER_LAST_NAME')}\" id=\"ADD_LAST_NAME\" class=\"ui-ctl-element\">\n\t\t\t\t\t\t\t<button type=\"button\" class=\"ui-ctl-after ui-ctl-icon-clear\" style=\"display: none\"></button>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"invite-form-row\">\n\t\t\t\t\t<div class=\"invite-form-col\">\n\t\t\t\t\t\t<div class=\"invite-content__field-lable\">${Loc.getMessage('BX24_INVITE_DIALOG_ADD_EMAIL_TITLE')}</div>\n\t\t\t\t\t\t<div class=\"ui-ctl ui-ctl-w100 ui-ctl-textbox ui-ctl-block ui-ctl-after-icon\">\n\t\t\t\t\t\t\t<input type=\"text\" name=\"ADD_EMAIL\" placeholder=\"${Loc.getMessage('INTRANET_INVITE_DIALOG_PLACEHOLDER_EMAIL')}\" id=\"ADD_EMAIL\" class=\"ui-ctl-element\" maxlength=\"50\">\n\t\t\t\t\t\t\t<button type=\"button\" class=\"ui-ctl-after ui-ctl-icon-clear\" style=\"display: none\"></button>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"invite-form-row\">\n\t\t\t\t\t<div class=\"invite-form-col\">\n\t\t\t\t\t\t<div class=\"invite-content__field-lable\">${Loc.getMessage('BX24_INVITE_DIALOG_ADD_POSITION_TITLE')}</div>\n\t\t\t\t\t\t<div class=\"ui-ctl ui-ctl-w100 ui-ctl-textbox ui-ctl-block ui-ctl-after-icon\">\n\t\t\t\t\t\t\t<input type=\"text\" name=\"ADD_POSITION\" placeholder=\"${Loc.getMessage('INTRANET_INVITE_DIALOG_PLACEHOLDER_POSITION')}\" id=\"ADD_POSITION\" class=\"ui-ctl-element\">\n\t\t\t\t\t\t\t<button type=\"button\" class=\"ui-ctl-after ui-ctl-icon-clear\" style=\"display: none\"></button>\n\t\t\t\t\t\t</div>\t\t\t\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\n\t\tthis.#inputsFactory.bindCloseIcons(element);\n\n\t\treturn element;\n\t}\n\n\tgetAnalyticTab(): string\n\t{\n\t\treturn Analytics.TAB_REGISTRATION;\n\t}\n\n\tonSubmit(event: BaseEvent)\n\t{\n\t\tconst addForm = this.render().querySelector('form');\n\n\t\tconst tagSelectorItems = this.#tagSelectorGroup.getDialog().getSelectedItems();\n\t\tconst projectIds = [];\n\t\ttagSelectorItems.forEach((item) => {\n\t\t\tconst id = parseInt(item.getId(), 10);\n\t\t\tprojectIds.push(id);\n\t\t});\n\n\t\tconst data = {\n\t\t\tADD_EMAIL: addForm.ADD_EMAIL.value,\n\t\t\tADD_NAME: addForm.ADD_NAME.value,\n\t\t\tADD_LAST_NAME: addForm.ADD_LAST_NAME.value,\n\t\t\tADD_POSITION: addForm.ADD_POSITION.value,\n\t\t\tADD_SEND_PASSWORD: (\n\t\t\t\taddForm.ADD_SEND_PASSWORD\n\t\t\t\t&& Boolean(addForm.ADD_SEND_PASSWORD.checked)\n\t\t\t\t\t? addForm.ADD_SEND_PASSWORD.value\n\t\t\t\t\t: 'N'\n\t\t\t),\n\t\t\tdepartmentIds: this.#departmentControl.getValues(),\n\t\t\tSONET_GROUPS_CODE: projectIds,\n\t\t};\n\n\t\tconst analyticsLabel = {\n\t\t\tINVITATION_TYPE: 'add',\n\t\t};\n\n\t\tconst context = event.getData()?.context;\n\t\tEventEmitter.emit(context, 'BX.Intranet.Invitation:onSendData', {\n\t\t\taction: 'add',\n\t\t\tdata,\n\t\t\tanalyticsLabel,\n\t\t});\n\t}\n\n\tgetSubmitButtonText(): ?string\n\t{\n\t\treturn Loc.getMessage('BX24_INVITE_DIALOG_ACTION_ADD');\n\t}\n}","import { Tag, Loc } from 'main.core';\nimport { Page } from './page';\n\nexport class SuccessPage extends Page\n{\n\t#container: HTMLElement;\n\n\trender(): HTMLElement\n\t{\n\t\tif (this.#container)\n\t\t{\n\t\t\treturn this.#container;\n\t\t}\n\n\t\tthis.#container = Tag.render`\n\t\t\t<div class=\"invite-wrap js-intranet-invitation-block\" data-role=\"success-block\" style=\"position: fixed; left: 0; right: 0; top: 0; bottom: 0; background: #fff; z-index: 90;\">\n\t\t\t\t<div style=\"height: 78vh;\" class=\"invite-send-success-wrap\">\n\t\t\t\t\t<div class=\"invite-send-success-text\">${Loc.getMessage('INTRANET_INVITE_DIALOG_SUCCESS_SEND')}</div>\n\t\t\t\t\t<div class=\"invite-send-success-decal-1\"></div>\n\t\t\t\t\t<div class=\"invite-send-success-decal-2\"></div>\n\t\t\t\t\t<div class=\"invite-send-success-decal-3\"></div>\n\t\t\t\t\t<div class=\"invite-send-success-decal-4\"></div>\n\t\t\t\t\t<div class=\"invite-send-success-decal-5\"></div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\n\t\treturn this.#container;\n\t}\n\n\tgetAnalyticTab(): ?string\n\t{\n\t\treturn null;\n\t}\n\n\tonSubmit(event: BaseEvent)\n\t{\n\t\tevent.getData()?.context?.submitButton.enable();\n\t\tevent.getData()?.context?.submitButton.ready();\n\t\tevent.getData()?.context?.changeContent(event.getData()?.context?.firstInvitationBlock);\n\t\tevent.getData()?.context?.activeMenuItem(event.getData()?.context?.firstInvitationBlock);\n\t}\n\n\tgetSubmitButtonText(): ?string\n\t{\n\t\treturn Loc.getMessage('BX24_INVITE_DIALOG_ACTION_INVITE_MORE');\n\t}\n}","import { LocalEmailPage } from './page/local-email-page';\nimport { Selector } from './selector';\nimport { EmailPage } from './page/email-page';\nimport { ExtranetPage } from './page/extranet-page';\nimport { GroupPage } from './page/group-page';\nimport { IntegratorPage } from './page/integrator-page';\nimport { LinkPage } from './page/link-page';\nimport { MassPage } from './page/mass-page';\nimport { RegisterPage } from './page/register-page';\nimport { SuccessPage } from './page/success-page';\n\nexport class PageFactory\n{\n\tcreateLocalEmailPage(): LocalEmailPage\n\t{\n\t\treturn new LocalEmailPage({\n\t\t\tdepartmentControl: this.createDepartmentControl(),\n\t\t\ttransport: this.transport,\n\t\t\tlinkRegisterEnabled: this.isSelfRegisterEnabled,\n\t\t\tanalytics: this.analytics,\n\t\t});\n\t}\n\n\tcreateEmailPage(): EmailPage\n\t{\n\t\treturn new EmailPage({\n\t\t\tdepartmentControl: this.createDepartmentControl(),\n\t\t\tinputsFactory: this.createInputRowFactory(this.useLocalEmailProgram),\n\t\t\tsmsAvailable: this.isInvitationBySmsAvailable,\n\t\t\tuseLocalEmailProgram: this.useLocalEmailProgram,\n\t\t\tonClickSwitchMode: () => {\n\t\t\t\tthis.changeContent('mass-invite');\n\t\t\t},\n\t\t\tonClickAddInputRow: () => {\n\t\t\t\tthis.getSetupArrow();\n\t\t\t\tthis.updateArrow();\n\t\t\t},\n\t\t});\n\t}\n\n\tcreateGroupPage(): GroupPage\n\t{\n\t\tconst projectId = this.userOptions?.groupId\n\t\t\t? parseInt(this.userOptions.groupId, 10)\n\t\t\t: 0;\n\n\t\tconst intranetSelector = new Selector({\n\t\t\toptions: {\n\t\t\t\tproject: true,\n\t\t\t\tprojectId,\n\t\t\t\tisAdmin: this.isAdmin,\n\t\t\t\tprojectLimitExceeded: this.projectLimitExceeded,\n\t\t\t\tprojectLimitFeatureId: this.projectLimitFeatureId,\n\t\t\t},\n\t\t});\n\n\t\treturn new GroupPage({\n\t\t\tdepartmentControl: this.createDepartmentControl(),\n\t\t\tinputsFactory: this.createInputRowFactory(),\n\t\t\ttagSelectorGroup: intranetSelector.renderTagSelector(),\n\t\t\tonClickAddInputRow: () => {\n\t\t\t\tthis.getSetupArrow();\n\t\t\t\tthis.updateArrow();\n\t\t\t},\n\t\t});\n\t}\n\n\tcreateExtranetPage(): ExtranetPage\n\t{\n\t\tconst projectId = this.userOptions?.groupId\n\t\t\t? parseInt(this.userOptions.groupId, 10)\n\t\t\t: 0;\n\n\t\tconst selectorParams = {\n\t\t\toptions: {\n\t\t\t\tproject: 'extranet',\n\t\t\t\tprojectId,\n\t\t\t\tisAdmin: this.isAdmin,\n\t\t\t\tprojectLimitExceeded: this.projectLimitExceeded,\n\t\t\t\tprojectLimitFeatureId: this.projectLimitFeatureId,\n\t\t\t\tshowCreateButton: !this.isCollabEnabled,\n\t\t\t},\n\t\t};\n\n\t\treturn new ExtranetPage({\n\t\t\tinputsFactory: this.createInputRowFactory(),\n\t\t\ttagSelectorGroup: (new Selector(selectorParams)).renderTagSelector(),\n\t\t\tonClickAddInputRow: () => {\n\t\t\t\tthis.getSetupArrow();\n\t\t\t\tthis.updateArrow();\n\t\t\t},\n\t\t});\n\t}\n\n\tcreateRegisterPage(): RegisterPage\n\t{\n\t\tconst projectId = this.userOptions?.groupId\n\t\t\t? parseInt(this.userOptions.groupId, 10)\n\t\t\t: 0;\n\n\t\tconst intranetSelector = new Selector({\n\t\t\toptions: {\n\t\t\t\tproject: true,\n\t\t\t\tprojectId,\n\t\t\t\tisAdmin: this.isAdmin,\n\t\t\t\tprojectLimitExceeded: this.projectLimitExceeded,\n\t\t\t\tprojectLimitFeatureId: this.projectLimitFeatureId,\n\t\t\t},\n\t\t});\n\n\t\treturn new RegisterPage({\n\t\t\tdepartmentControl: this.createDepartmentControl(),\n\t\t\tisCloud: this.isCloud,\n\t\t\tinputsFactory: this.createInputRowFactory(),\n\t\t\twithoutConfirm: !this.registerNeedeConfirm,\n\t\t\ttagSelectorGroup: intranetSelector.renderTagSelector(),\n\t\t});\n\t}\n\n\tcreateIntegratorPage(): IntegratorPage\n\t{\n\t\treturn new IntegratorPage();\n\t}\n\n\tcreateLinkPage(): LinkPage\n\t{\n\t\treturn new LinkPage({\n\t\t\tdepartmentControl: this.createDepartmentControl(),\n\t\t\tisAdmin: this.isAdmin,\n\t\t\tfastRegistrationAvailable: this.isSelfRegisterEnabled,\n\t\t\tneedConfirmRegistration: this.registerNeedeConfirm,\n\t\t\twishlist: this.wishlistValue,\n\t\t\tisCloud: this.isCloud,\n\t\t\tlinkRegisterEnabled: this.isSelfRegisterEnabled,\n\t\t\tanalytics: this.analytics,\n\t\t\ttransport: this.transport,\n\t\t});\n\t}\n\n\tcreateMassPage(): MassPage\n\t{\n\t\treturn new MassPage({\n\t\t\tdepartmentControl: this.createDepartmentControl(),\n\t\t\tsmsAvailable: this.isInvitationBySmsAvailable,\n\t\t\tuseOnlyPhone: this.useLocalEmailProgram,\n\t\t\tonClickSwitchMode: () => {\n\t\t\t\tthis.changeContent('invite');\n\t\t\t},\n\t\t});\n\t}\n\n\tcreateSeccessPage(): SuccessPage\n\t{\n\t\treturn new SuccessPage();\n\t}\n}\n","import { PageFactory } from './page-factory';\n\nexport class PageProvider\n{\n\tprovide(): Map\n\t{\n\t\tconst pageFactory = new PageFactory();\n\n\t\tconst pages = new Map();\n\t\tif (this.canCurrentUserInvite)\n\t\t{\n\t\t\tif (this.useLocalEmailProgram)\n\t\t\t{\n\t\t\t\tpages.set('invite-email', pageFactory.createLocalEmailPage.call(this));\n\t\t\t}\n\n\t\t\tpages.set('invite', pageFactory.createEmailPage.call(this));\n\t\t\tpages.set('mass-invite', pageFactory.createMassPage.call(this));\n\t\t\tpages.set('invite-with-group-dp', pageFactory.createGroupPage.call(this));\n\t\t\tpages.set('add', pageFactory.createRegisterPage.call(this));\n\t\t\tpages.set('self', pageFactory.createLinkPage.call(this));\n\t\t}\n\n\t\tif (this.isExtranetInstalled)\n\t\t{\n\t\t\tpages.set('extranet', pageFactory.createExtranetPage.call(this));\n\t\t}\n\n\t\tif (this.isCloud && this.canCurrentUserInvite)\n\t\t{\n\t\t\tpages.set('integrator', pageFactory.createIntegratorPage.call(this));\n\t\t}\n\n\t\tpages.set('success', pageFactory.createSeccessPage.call(this));\n\n\t\treturn pages;\n\t}\n}\n","export class ActiveDirectory\n{\n\tshowForm()\n\t{\n\t\tBX.UI.Feedback.Form.open(\n\t\t\t{\n\t\t\t\tid: 'intranet-active-directory',\n\t\t\t\tdefaultForm: { id: 309, sec: 'fbc0n3' },\n\t\t\t},\n\t\t);\n\t}\n}\n","import { Type, Dom, Event, Loc } from 'main.core';\nimport DepartmentControl from 'intranet.department-control';\nimport { InputRowFactory, InputRowType } from './input-row-factory';\nimport { MessageBar } from './message-bar';\nimport { Navigation } from './navigation';\nimport { PageProvider } from './page-provider';\nimport { LinkPage } from './page/link-page';\nimport { SubmitButton } from './submit-button';\nimport { EventEmitter, BaseEvent } from 'main.core.events';\nimport { ActiveDirectory } from './active-directory';\nimport { Analytics } from './analytics';\nimport { Transport } from './transport';\n\nexport default class Form extends EventEmitter\n{\n\tconstructor(formParams)\n\t{\n\t\tsuper();\n\t\tthis.setEventNamespace('BX.Intranet.Invitation');\n\t\tconst params = Type.isPlainObject(formParams) ? formParams : {};\n\t\tthis.menuContainer = params.menuContainerNode;\n\t\tthis.subMenuContainer = params.subMenuContainerNode;\n\t\tthis.contentContainer = params.contentContainerNode;\n\t\tthis.pageContainer = this.contentContainer.querySelector('.popup-window-tabs-content-invite');\n\t\tthis.userOptions = params.userOptions;\n\t\tthis.isExtranetInstalled = params.isExtranetInstalled === 'Y';\n\t\tthis.isCloud = params.isCloud === 'Y';\n\t\tthis.isAdmin = params.isAdmin === 'Y';\n\t\tthis.canCurrentUserInvite = params.canCurrentUserInvite === true;\n\t\tthis.isInvitationBySmsAvailable = params.isInvitationBySmsAvailable === 'Y';\n\t\tthis.isCreatorEmailConfirmed = params.isCreatorEmailConfirmed === 'Y';\n\t\tthis.firstInvitationBlock = params.firstInvitationBlock;\n\t\tthis.isSelfRegisterEnabled = params.isSelfRegisterEnabled;\n\t\tthis.analyticsLabel = params.analyticsLabel;\n\t\tthis.projectLimitExceeded = Type.isBoolean(params.projectLimitExceeded) ? params.projectLimitExceeded : true;\n\t\tthis.projectLimitFeatureId = Type.isString(params.projectLimitFeatureId) ? params.projectLimitFeatureId : '';\n\t\tthis.wishlistValue = Type.isStringFilled(params.wishlistValue) ? params.wishlistValue : '';\n\t\tthis.isCollabEnabled = params.isCollabEnabled === 'Y';\n\t\tthis.registerNeedeConfirm = params.registerConfirm === true;\n\t\tthis.useLocalEmailProgram = params.useLocalEmailProgram === true;\n\t\tthis.transport = new Transport({\n\t\t\tcomponentName: params.componentName,\n\t\t\tsignedParameters: params.signedParameters,\n\t\t});\n\n\t\tif (Type.isDomNode(this.contentContainer))\n\t\t{\n\t\t\tthis.messageBar = new MessageBar({\n\t\t\t\terrorContainer: this.contentContainer.querySelector(\"[data-role='error-message']\"),\n\t\t\t\tsuccessContainer: this.contentContainer.querySelector(\"[data-role='success-message']\"),\n\t\t\t});\n\n\t\t\tBX.UI.Hint.init(this.contentContainer);\n\t\t}\n\n\t\tif (Type.isDomNode(this.menuContainer))\n\t\t{\n\t\t\tthis.#initMenu();\n\t\t}\n\n\t\tthis.submitButton = new SubmitButton({\n\t\t\tnode: document.querySelector('#intranet-invitation-btn'),\n\t\t\tevents: {\n\t\t\t\tclick: (event) => {\n\t\t\t\t\tif (!this.isCreatorEmailConfirmed)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.messageBar.showError(Loc.getMessage('INTRANET_INVITE_DIALOG_CONFIRM_CREATOR_EMAIL_ERROR'));\n\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (!this.submitButton.isWaiting() && this.submitButton.isEnabled())\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.submitButton.wait();\n\t\t\t\t\t\tEventEmitter.emit(this.navigation.current(), 'BX.Intranet.Invitation:submit', {\n\t\t\t\t\t\t\tcontext: this,\n\t\t\t\t\t\t});\n\t\t\t\t\t\tif (this.isCloud)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tBX.userOptions.del('intranet.invitation', 'open_invitation_form_ts');\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t},\n\t\t});\n\n\t\tthis.analytics = new Analytics(this.analyticsLabel, this.isAdmin);\n\t\tthis.analytics.sendOpenSliderData(this.analyticsLabel.source);\n\n\t\tthis.arrowBox = document.querySelector('.invite-wrap-decal-arrow');\n\t\tif (Type.isDomNode(this.arrowBox))\n\t\t{\n\t\t\tthis.arrowRect = this.arrowBox.getBoundingClientRect();\n\t\t\tthis.arrowHeight = this.arrowRect.height;\n\t\t\tthis.setSetupArrow();\n\t\t}\n\n\t\tEventEmitter.subscribe('BX.Intranet.Invitation:onChangeForm', () => {\n\t\t\tthis.submitButton.enable();\n\t\t});\n\n\t\tthis.navigation = this.createNavigation();\n\t\tthis.navigation?.subscribe('onBeforeChangePage', () => {\n\t\t\tthis.messageBar.hideAll();\n\t\t});\n\t\tthis.navigation?.subscribe('onAfterChangePage', this.onAfterChangePage.bind(this));\n\n\t\tthis.navigation.showFirst();\n\n\t\tthis.subscribe('BX.Intranet.Invitation:onSendData', this.onSendRequest.bind(this));\n\n\t\tEventEmitter.subscribe('BX.Intranet.Invitation:onSubmitReady', () => {\n\t\t\tthis.submitButton.ready();\n\t\t});\n\n\t\tEventEmitter.subscribe('BX.Intranet.Invitation:onSubmitDisabled', () => {\n\t\t\tthis.submitButton.disable();\n\t\t});\n\n\t\tEventEmitter.subscribe('BX.Intranet.Invitation:onSubmitWait', () => {\n\t\t\tthis.submitButton.wait();\n\t\t});\n\t}\n\n\tonAfterChangePage(event: BaseEvent)\n\t{\n\t\tconst section = this.getSubSection();\n\t\tconst page = event.getData().current;\n\t\tlet subSection = null;\n\t\tif (page)\n\t\t{\n\t\t\tsubSection = page.getAnalyticTab();\n\t\t\tif (page.getSubmitButtonText())\n\t\t\t{\n\t\t\t\tthis.submitButton.setLabel(page.getSubmitButtonText());\n\t\t\t}\n\n\t\t\tif (page.getButtonState() === SubmitButton.ENABLED_STATE)\n\t\t\t{\n\t\t\t\tthis.submitButton.enable();\n\t\t\t}\n\t\t\telse if (page.getButtonState() === SubmitButton.DISABLED_STATE)\n\t\t\t{\n\t\t\t\tthis.submitButton.disable();\n\t\t\t}\n\t\t}\n\n\t\tif (this.analytics && section && subSection)\n\t\t{\n\t\t\tthis.analytics.sendTabData(section, subSection);\n\t\t}\n\t}\n\n\tgetSubSection(): string\n\t{\n\t\tconst regex = /analyticsLabel\\[source]=(\\w*)&/gm;\n\t\tconst match = regex.exec(decodeURI(window.location));\n\t\tif (match?.length > 1)\n\t\t{\n\t\t\treturn match[1];\n\t\t}\n\n\t\treturn null;\n\t}\n\n\t#initMenu()\n\t{\n\t\tthis.menuItems = Array.prototype.slice.call(this.menuContainer.querySelectorAll('a'));\n\t\tif (Type.isDomNode(this.subMenuContainer))\n\t\t{\n\t\t\tconst subMenuItem = Array.prototype.slice.call(this.subMenuContainer.querySelectorAll('a'));\n\n\t\t\tthis.menuItems = [...this.menuItems, ...subMenuItem];\n\t\t}\n\n\t\t(this.menuItems || []).forEach((item) => {\n\t\t\tEvent.bind(item, 'click', () => {\n\t\t\t\tthis.changeContent(item.getAttribute('data-action'));\n\t\t\t\tthis.activeMenuItem(this.navigation.getCurrentCode());\n\t\t\t});\n\n\t\t\tif (item.getAttribute('data-action') === this.firstInvitationBlock)\n\t\t\t{\n\t\t\t\tDom.addClass(item.parentElement, 'ui-sidepanel-menu-active');\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tDom.removeClass(item.parentElement, 'ui-sidepanel-menu-active');\n\t\t\t}\n\t\t});\n\t}\n\n\tactiveMenuItem(itemType: string)\n\t{\n\t\t(this.menuItems || []).forEach((item) => {\n\t\t\tDom.removeClass(item.parentElement, 'ui-sidepanel-menu-active');\n\t\t\tif (item.getAttribute('data-action') === itemType)\n\t\t\t{\n\t\t\t\tDom.addClass(item.parentElement, 'ui-sidepanel-menu-active');\n\t\t\t}\n\t\t});\n\t}\n\n\tchangeContent(action)\n\t{\n\t\tif (!Type.isStringFilled(action))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (action === 'active-directory')\n\t\t{\n\t\t\tif (!this.activeDirectory)\n\t\t\t{\n\t\t\t\tthis.activeDirectory = new ActiveDirectory(this);\n\t\t\t}\n\n\t\t\tthis.activeDirectory.showForm();\n\t\t\tthis.analytics.sendTabData(this.getSubSection(), Analytics.TAB_AD);\n\n\t\t\treturn;\n\t\t}\n\n\t\tthis.navigation.show(action);\n\t}\n\n\tcreateNavigation(): Navigation\n\t{\n\t\treturn new Navigation({\n\t\t\tcontainer: this.pageContainer,\n\t\t\tfirst: this.firstInvitationBlock,\n\t\t\tpages: (new PageProvider()).provide.call(this),\n\t\t});\n\t}\n\n\tonSendRequest(event: BaseEvent)\n\t{\n\t\tthis.submitButton.disable();\n\t\tconst request = event.getData();\n\t\tthis.messageBar.hideAll();\n\t\tif (Type.isArray(request.errors) && request.errors.length > 0)\n\t\t{\n\t\t\tthis.submitButton.enable();\n\t\t\tthis.submitButton.ready();\n\t\t\tthis.messageBar.showError(request.errors[0]);\n\n\t\t\treturn;\n\t\t}\n\n\t\trequest.userOptions = this.userOptions;\n\t\trequest.analyticsData = this.analyticsLabel;\n\t\t// eslint-disable-next-line promise/catch-or-return\n\t\tthis.transport.send(request).then((response) => {\n\t\t\tthis.submitButton.ready();\n\n\t\t\tif (response.data)\n\t\t\t{\n\t\t\t\tif (request?.action === 'self')\n\t\t\t\t{\n\t\t\t\t\tthis.messageBar.showSuccess(response.data);\n\t\t\t\t\tthis.isSelfRegisterEnabled = request.data.allow_register === 'Y';\n\t\t\t\t\tEventEmitter.emit(EventEmitter.GLOBAL_TARGET, 'BX.Intranet.Invitation:selfChange', {\n\t\t\t\t\t\tselfEnabled: this.isSelfRegisterEnabled,\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\telse if (this.useLocalEmailProgram && request?.action === 'invite' && request?.type === 'invite-email')\n\t\t\t\t{\n\t\t\t\t\tEventEmitter.emit(EventEmitter.GLOBAL_TARGET, 'BX.Intranet.Invitation:InviteSuccess');\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tthis.changeContent('success');\n\t\t\t\t\tthis.submitButton.sendSuccessEvent(response.data);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tEventEmitter.subscribe(\n\t\t\t\tEventEmitter.GLOBAL_TARGET,\n\t\t\t\t'SidePanel.Slider:onClose',\n\t\t\t\t() => {\n\t\t\t\t\tBX.SidePanel.Instance.postMessageTop(window, 'BX.Bitrix24.EmailConfirmation:showPopup');\n\t\t\t\t},\n\t\t\t);\n\t\t}, (response) => {\n\t\t\tthis.submitButton.enable();\n\t\t\tthis.submitButton.ready();\n\n\t\t\tif (response.data === 'user_limit')\n\t\t\t{\n\t\t\t\t// eslint-disable-next-line no-undef\n\t\t\t\tB24.licenseInfoPopup.show(\n\t\t\t\t\t'featureID',\n\t\t\t\t\tLoc.getMessage('BX24_INVITE_DIALOG_USERS_LIMIT_TITLE'),\n\t\t\t\t\tLoc.getMessage('BX24_INVITE_DIALOG_USERS_LIMIT_TEXT'),\n\t\t\t\t);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.messageBar.showError(response.errors[0].message);\n\t\t\t}\n\n\t\t\tif (request?.action === 'invite' && this.useLocalEmailProgram && request?.type === 'invite-email')\n\t\t\t{\n\t\t\t\tEventEmitter.emit(EventEmitter.GLOBAL_TARGET, 'BX.Intranet.Invitation:InviteFailed');\n\t\t\t}\n\t\t});\n\t}\n\n\tcreateDepartmentControl(): DepartmentControl\n\t{\n\t\tconst departmentsId = Type.isArray(this.userOptions?.departmentList)\n\t\t\t? this.userOptions.departmentList\n\t\t\t: [];\n\t\tconst rootDepartment = this.userOptions?.rootDepartment;\n\n\t\treturn new DepartmentControl({\n\t\t\tdepartmentList: departmentsId,\n\t\t\trootDepartment: Type.isObject(rootDepartment) ? rootDepartment : null,\n\t\t});\n\t}\n\n\tcreateInputRowFactory(useOnlyPhone: boolean = false): InputRowFactory\n\t{\n\t\tconst inputRowType = useOnlyPhone\n\t\t\t? InputRowType.PHONE\n\t\t\t: (this.isInvitationBySmsAvailable ? InputRowType.ALL : InputRowType.EMAIL);\n\n\t\treturn new InputRowFactory({\n\t\t\tinputRowType,\n\t\t});\n\t}\n\n\tgetSetupArrow()\n\t{\n\t\tthis.body = document.querySelector('.invite-body');\n\t\tthis.panelConfirmBtn = document.getElementById('intranet-invitation-btn');\n\t\tthis.sliderContent = document.querySelector('.ui-page-slider-workarea');\n\t\tthis.sliderHeader = document.querySelector('.ui-side-panel-wrap-title-wrap');\n\t\tthis.buttonPanel = document.querySelector('.ui-button-panel');\n\n\t\tthis.sliderHeaderHeight = this.sliderHeader?.getBoundingClientRect().height;\n\t\tthis.buttonPanelRect = this.buttonPanel.getBoundingClientRect();\n\t\tthis.panelRect = this.panelConfirmBtn.getBoundingClientRect();\n\t\tthis.btnWidth = Math.ceil(this.panelRect.width);\n\t\tthis.arrowWidth = Math.ceil(this.arrowRect.width);\n\t\tthis.sliderContentRect = this.sliderContent.getBoundingClientRect();\n\n\t\tthis.bodyHeight = this.body.getBoundingClientRect().height - this.buttonPanelRect.height + this.sliderHeaderHeight;\n\t\tthis.contentHeight = this.arrowHeight\n\t\t\t+ this.sliderContentRect.height\n\t\t\t+ this.buttonPanelRect.height\n\t\t\t+ this.sliderHeaderHeight\n\t\t\t- 65;\n\t}\n\n\tupdateArrow()\n\t{\n\t\tthis.bodyHeight = this.body.getBoundingClientRect().height - this.buttonPanelRect.height + this.sliderHeaderHeight;\n\t\tthis.contentHeight = this.arrowHeight\n\t\t\t+ this.sliderContentRect.height\n\t\t\t+ this.buttonPanelRect.height\n\t\t\t+ this.sliderHeaderHeight - 65;\n\t\t// eslint-disable-next-line no-unused-expressions\n\t\tthis.contentHeight > this.bodyHeight\n\t\t\t? Dom.addClass(this.body, 'js-intranet-invitation-arrow-hide')\n\t\t\t: Dom.removeClass(this.body, 'js-intranet-invitation-arrow-hide');\n\t}\n\n\tsetSetupArrow()\n\t{\n\t\tthis.getSetupArrow();\n\t\tconst btnPadding = 40;\n\t\tDom.style(\n\t\t\tthis.arrowBox,\n\t\t\t'left',\n\t\t\t`${this.panelRect.left + (this.btnWidth / 2) - (this.arrowWidth / 2) - btnPadding}px`,\n\t\t);\n\t\t// eslint-disable-next-line no-unused-expressions\n\t\tthis.contentHeight > this.bodyHeight\n\t\t\t? Dom.addClass(this.body, 'js-intranet-invitation-arrow-hide')\n\t\t\t: Dom.removeClass(this.body, 'js-intranet-invitation-arrow-hide');\n\n\t\tEvent.bind(window, 'resize', () => {\n\t\t\tif (window.innerWidth <= 1100)\n\t\t\t{\n\t\t\t\tDom.style(\n\t\t\t\t\tthis.arrowBox,\n\t\t\t\t\t'left',\n\t\t\t\t\t`${this.panelRect.left + (this.btnWidth / 2) - (this.arrowWidth / 2) - btnPadding}px`,\n\t\t\t\t);\n\t\t\t}\n\t\t\tthis.getSetupArrow();\n\t\t\tthis.updateArrow();\n\t\t});\n\t}\n}\n"],"names":["Phone","constructor","count","index","maxCount","inputStack","renderPhoneRow","inputNode","Type","isDomNode","num","getAttribute","parentNode","querySelector","element","Tag","render","style","paddingLeft","Dom","append","flagNode","Event","bind","showCountrySelector","changeCallback","i","e","value","country","BX","PhoneNumber","Input","node","flagSize","onChange","id","setInterval","getValue","formatter","getCountry","clearInterval","_onFlagClick","InputRowType","Object","freeze","PHONE","EMAIL","ALL","InputRowFactory","params","inputNum","inputRowType","includes","phoneObj","bindCloseIcons","container","inputNodes","Array","prototype","slice","call","querySelectorAll","forEach","closeIcon","nextElementSibling","event","preventDefault","renderInputRowTo","target","showTitles","renderEmailInputsRow","renderInputRowsTo","fieldTitle","nameTitle","lastNameTitle","Loc","getMessage","parseEmailAndPhone","form","errorInputData","items","phoneExp","rows","row","emailInput","phoneInput","nameInput","lastNameInput","emailValue","trim","phoneValue","test","String","toLowerCase","phoneCountryInput","push","PHONE_COUNTRY","NAME","LAST_NAME","Validation","isEmail","length","focus","phoneFlagBlock","remove","phoneBlock","newInput","name","placeholder","replace","MessageBar","options","errorContainer","successContainer","hideAll","showError","message","isStringFilled","clean","showSuccess","text","util","htmlspecialchars","SubmitButton","EventEmitter","setEventNamespace","unbindAll","isFunction","events","click","wait","isWaiting","hasClass","ready","disable","addClass","enable","removeClass","isEnabled","setLabel","lable","innerText","sendSuccessEvent","users","SidePanel","Instance","postMessageAll","window","isDisable","isBoolean","ENABLED_STATE","DISABLED_STATE","Page","subscribe","onSubmit","HTMLElement","getSubmitButtonText","getButtonState","Navigation","isMap","pages","Map","filter","k","page","first","has","next","show","code","get","emit","current","new","previous","prev","showFirst","getCurrentCode","add","set","delete","Analytics","cSection","isAdmin","send","sendData","tool","TOOLS","category","CATEGORY_INVITATION","EVENT_COPY","c_section","p1","p2","sendTabData","section","subSection","EVENT_TAB_VIEW","c_sub_section","sendOpenSliderData","EVENT_OPEN_SLIDER_INVITATION","sendOpenLocalEmailPopup","TAB_EMAIL","sendLocalEmailProgram","EVENT_LOCAL_MAIL","document","checked","ADMIN_ALLOW_MODE_Y","ADMIN_ALLOW_MODE_N","IS_ADMIN_Y","IS_ADMIN_N","source","TOOLS_HEADER","TAB_MASS","TAB_DEPARTMENT","TAB_INTEGRATOR","TAB_LINK","TAB_REGISTRATION","TAB_EXTRANET","TAB_AD","TAB_LOCAL_EMAIL","TAB_PHONE","Transport","componentName","signedParameters","request","ajax","runComponentAction","action","mode","method","data","analyticsLabel","EmailInvitationInput","InvitationInput","inputType","InvitationInputType","getTagSelector","setPlaceholder","getContainer","focusTextBox","clearTags","onReadySaveInputHandler","callback","unsubscribe","onUnreadySaveInputHandler","getContent","actionBlock","removeTags","getValues","selector","tags","getTags","emails","errorElements","tag","getEntityType","getTitle","InviteEmailPopup","input","close","PopupManager","create","className","autoHide","closeByEsc","width","height","setContent","setState","ButtonState","DISABLED","submitData","Button","state","size","Size","SMALL","color","Color","PRIMARY","noCaps","onclick","isDisabled","CancelButton","InviteEmailHandler","transport","linkRegisterEnabled","departmentControl","DepartmentControl","analytics","getData","selfEnabled","departmentsId","then","response","invitationUrl","invitationLink","subject","encodeURIComponent","body","location","errors","invitationForm","invitations","departmentIds","tab","INVITATION_TYPE","INVITATION_COUNT","type","isSuccess","notificationOptions","closeButton","autoHideDelay","content","notify","UI","Notification","Center","activateAutoHide","title","description","link","top","LocalEmailPage","getAnalyticTab","topBlock","block","Selector","entities","renderTo","tagSelector","renderTagSelector","preselectedItems","projectId","TagSelector","dialogOptions","context","getItems","departments","projects","tagSelectorItems","getDialog","getSelectedItems","item","parseInt","getId","getEntityId","hasOwnProperty","fillRecentTab","createProjectLink","showCreateButton","lockProjectLink","projectLimitExceeded","lockProjectLinkFeatureId","projectLimitFeatureId","optionValue","EmailPage","inputsFactory","smsAvailable","useLocalEmailProgram","onClickSwitchMode","onClickAddInputRow","formNode","join","suffix","moreButton","switchBtn","ExtranetPage","tagSelectorGroup","projectIds","workgroupIds","GroupPage","IntegratorPage","integrator_email","moreLink","Helper","popup","Popup","maxWidth","overlay","contentPadding","titleBar","offsetLeft","buttons","CreateButton","onClose","destroy","SelfRegister","isSelfRegisterEnabled","bindActions","switcherNode","switcher","Switcher","inputName","SwitcherSize","small","handlers","toggled","toggleSettings","generateLinkBtnNode","generateLinkHint","showHintPopup","showNotificationPopup","regenerateButton","regenerateSecret","copyRegisterUrlButton","copyRegisterUrl","allowRegisterConfirm","setButtonState","toggleWhiteList","selfWhiteList","allow_register_secret","Text","getRandom","copyBtnNode","copyToClipboard","r","catch","console","log","textToCopy","isString","Promise","reject","isSecureContext","navigator","clipboard","resolve","setTimeout","writeText","copy","bindNode","PopupWindow","zIndex","angle","offsetTop","darkMode","onAfterPopupShow","round","isConfirm","ApplyButton","controlBlock","toggleClass","settingsBlock","inputElement","LinkPage","isCloud","fastRegistrationAvailable","needConfirmRegistration","wishlist","prepend","allow_register","allow_register_confirm","allow_register_whitelist","MassInvitationField","useOnlyPhone","values","MassPage","helper","sufix","invitationText","RegisterPage","withoutConfirm","addForm","ADD_EMAIL","ADD_NAME","ADD_LAST_NAME","ADD_POSITION","ADD_SEND_PASSWORD","Boolean","SONET_GROUPS_CODE","SuccessPage","submitButton","changeContent","firstInvitationBlock","activeMenuItem","PageFactory","createLocalEmailPage","createDepartmentControl","createEmailPage","createInputRowFactory","isInvitationBySmsAvailable","getSetupArrow","updateArrow","createGroupPage","userOptions","groupId","intranetSelector","project","createExtranetPage","selectorParams","isCollabEnabled","createRegisterPage","registerNeedeConfirm","createIntegratorPage","createLinkPage","wishlistValue","createMassPage","createSeccessPage","PageProvider","provide","pageFactory","canCurrentUserInvite","isExtranetInstalled","ActiveDirectory","showForm","Feedback","Form","open","defaultForm","sec","formParams","isPlainObject","menuContainer","menuContainerNode","subMenuContainer","subMenuContainerNode","contentContainer","contentContainerNode","pageContainer","isCreatorEmailConfirmed","registerConfirm","messageBar","Hint","init","navigation","del","arrowBox","arrowRect","getBoundingClientRect","arrowHeight","setSetupArrow","createNavigation","onAfterChangePage","onSendRequest","getSubSection","regex","match","exec","decodeURI","itemType","menuItems","parentElement","activeDirectory","isArray","analyticsData","GLOBAL_TARGET","postMessageTop","B24","licenseInfoPopup","departmentList","rootDepartment","isObject","panelConfirmBtn","getElementById","sliderContent","sliderHeader","buttonPanel","sliderHeaderHeight","buttonPanelRect","panelRect","btnWidth","Math","ceil","arrowWidth","sliderContentRect","bodyHeight","contentHeight","btnPadding","left","innerWidth","subMenuItem"],"mappings":"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"}