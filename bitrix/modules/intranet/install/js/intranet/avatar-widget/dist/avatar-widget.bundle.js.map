{"version":3,"file":"avatar-widget.bundle.js","sources":["../src/content/content.js","../src/analytics.js","../src/content/main-content.js","../src/content/qr-auth-content.js","../src/content/desktop-content.js","../src/content/otp-content.js","../src/content/sign-documents-content.js","../src/content/salary-vacation-content.js","../src/content/extension-content.js","../src/content/logout-content.js","../src/content/theme-content.js","../src/content/perf-review-content.js","../src/popup.js","../src/avatar-widget.js"],"sourcesContent":["import { EventEmitter } from 'main.core.events';\nimport { Cache } from 'main.core';\nimport type { ConfigOptions, BaseContentOptions } from '../types';\n\nexport class Content extends EventEmitter\n{\n\tcache = new Cache.MemoryCache();\n\n\tconstructor(options: BaseContentOptions)\n\t{\n\t\tsuper();\n\t\tthis.setOptions(options);\n\t\tthis.setEventNamespace('BX.Intranet.AvatarWidget.Content');\n\t}\n\n\tsetOptions(options: BaseContentOptions): Content\n\t{\n\t\tthis.cache.set('options', options);\n\n\t\treturn this;\n\t}\n\n\tgetOptions(): BaseContentOptions\n\t{\n\t\treturn this.cache.get('options', {});\n\t}\n\n\tgetLayout(): HTMLElement\n\t{\n\t\tthrow new Error('Must be implemented in a child class');\n\t}\n\n\tgetConfig(): ConfigOptions\n\t{\n\t\treturn {\n\t\t\thtml: this.getLayout(),\n\t\t\tminHeight: '58px',\n\t\t};\n\t}\n}\n","import { sendData } from 'ui.analytics';\n\nexport class Analytics\n{\n\tstatic TOOLS = 'intranet';\n\tstatic CATEGORY = 'ava_menu';\n\tstatic CATEGORY_PROFILE = 'user_profile';\n\tstatic EVENT_OPEN_WIDGET = 'menu_open';\n\tstatic EVENT_PROFILE_VIEW = 'profile_view';\n\tstatic EVENT_CLICK_SALARY = 'click_salary';\n\tstatic EVENT_CLICK_INSTALL_DESKTOP_APP = 'click_install_desktop_app';\n\tstatic EVENT_CLICK_2FA_SETUP = 'click_2fa_setup';\n\tstatic EVENT_CLICK_EXTENSION = 'click_extension';\n\tstatic EVENT_CLICK_LOGOUT = 'click_logout';\n\tstatic EVENT_CLICK_CHANGE_PORTAL_THEME = 'click_change_portal_theme';\n\tstatic EVENT_CLICK_LOGIN_HISTORY = 'click_login_history';\n\tstatic EVENT_CLICK_NETWORK = 'click_network';\n\tstatic EVENT_CLICK_ACTIVITY_PORTAL_LIST = 'click_activity_portal_list';\n\n\tstatic send(event: string): void\n\t{\n\t\tsendData({\n\t\t\ttool: Analytics.TOOLS,\n\t\t\tcategory: Analytics.CATEGORY,\n\t\t\tevent,\n\t\t});\n\t}\n\n\tstatic sendOpenProfile(): void\n\t{\n\t\tsendData({\n\t\t\ttool: Analytics.TOOLS,\n\t\t\tcategory: Analytics.CATEGORY_PROFILE,\n\t\t\tevent: Analytics.EVENT_PROFILE_VIEW,\n\t\t\tc_section: Analytics.CATEGORY,\n\t\t});\n\t}\n\n\tstatic sendOpenCommonSecurity(): void\n\t{\n\t\tsendData({\n\t\t\ttool: 'settings',\n\t\t\tcategory: 'common_security',\n\t\t\tevent: 'start_page',\n\t\t\tc_section: Analytics.CATEGORY,\n\t\t});\n\t}\n}\n","import { Tag, Event, ajax, Runtime } from 'main.core';\nimport { EventEmitter } from 'main.core.events';\nimport { Menu } from 'main.popup';\nimport { AvatarRound, AvatarRoundExtranet, AvatarRoundGuest, AvatarBase } from 'ui.avatar';\nimport { FeaturePromotersRegistry } from 'ui.info-helper';\nimport { WorkTimeButton } from 'timeman.work-time-button';\nimport { Content } from './content';\nimport { Analytics } from '../analytics';\nimport type { MainContentOptions } from '../types';\nimport { DesktopAccountList } from 'intranet.desktop-account-list';\n\nexport class MainContent extends Content\n{\n\t#activeOnclick: boolean = true;\n\n\tgetOptions(): MainContentOptions\n\t{\n\t\treturn super.getOptions();\n\t}\n\n\tgetLayout(): HTMLElement\n\t{\n\t\treturn this.cache.remember('layout', () => {\n\t\t\tthis.#setEventHandlers();\n\t\t\tconst onclick = () => {\n\t\t\t\tif (this.#activeOnclick)\n\t\t\t\t{\n\t\t\t\t\tBX.SidePanel.Instance.open(this.getOptions().url);\n\t\t\t\t\tAnalytics.sendOpenProfile();\n\t\t\t\t}\n\t\t\t};\n\n\t\t\treturn Tag.render`\n\t\t\t\t<div onclick=\"${onclick}\" class=\"intranet-avatar-widget-item__wrapper --column-format\" data-id=\"bx-avatar-widget-content-main\">\n\t\t\t\t\t<div class=\"intranet-avatar-widget-item-main__wrapper-head\">\n\t\t\t\t\t\t<div class=\"intranet-avatar-widget-item__avatar\">\n\t\t\t\t\t\t\t${this.#getAvatar().getContainer()}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"intranet-avatar-widget-item__info-wrapper\">\n\t\t\t\t\t\t\t${this.#getFullName()}\n\t\t\t\t\t\t\t${this.#getStatus()}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<i class=\"ui-icon-set --chevron-right-m intranet-avatar-widget-item__chevron\"/>\n\t\t\t\t\t\t${this.#getMoreMenuElement()}\n\t\t\t\t\t</div>\n\t\t\t\t\t${this.#getWorkTime()}\n\t\t\t\t</div>\n\t\t\t`;\n\t\t});\n\t}\n\n\t#getFullName(): HTMLElement\n\t{\n\t\treturn this.cache.remember('title', () => {\n\t\t\treturn Tag.render`\n\t\t\t\t<span class=\"intranet-avatar-widget-item__title\">${this.getOptions().fullName}</span>\n\t\t\t`;\n\t\t});\n\t}\n\n\t#getStatus(): HTMLElement\n\t{\n\t\treturn this.cache.remember('status', () => {\n\t\t\treturn Tag.render`\n\t\t\t\t<span class=\"intranet-avatar-widget-item__description\">${this.getOptions().status}</span>\n\t\t\t`;\n\t\t});\n\t}\n\n\t#getAvatar(): AvatarBase\n\t{\n\t\treturn this.cache.remember('avatar', () => {\n\t\t\tconst options = {\n\t\t\t\tsize: 36,\n\t\t\t\tuserpicPath: encodeURI(this.getOptions().userPhotoSrc),\n\t\t\t};\n\t\t\tlet avatar = null;\n\n\t\t\tif (this.getOptions().role === 'extranet')\n\t\t\t{\n\t\t\t\tavatar = new AvatarRoundExtranet(options);\n\t\t\t}\n\t\t\telse if (this.getOptions().role === 'collaber')\n\t\t\t{\n\t\t\t\tavatar = new AvatarRoundGuest(options);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tavatar = new AvatarRound(options);\n\t\t\t}\n\n\t\t\treturn avatar;\n\t\t});\n\t}\n\n\t#getMoreMenuElement(): HTMLElement\n\t{\n\t\treturn this.cache.remember('moreMenuElement', () => {\n\t\t\tconst element = Tag.render`\n\t\t\t\t<i class=\"ui-icon-set --more-l intranet-avatar-widget-item__more\"/>\n\t\t\t`;\n\t\t\tEvent.bind(element, 'click', (event) => {\n\t\t\t\tevent.preventDefault();\n\t\t\t\tevent.stopPropagation();\n\t\t\t\tif (this.#activeOnclick)\n\t\t\t\t{\n\t\t\t\t\tthis.#getMoreMenu(event.target).toggle();\n\t\t\t\t}\n\t\t\t});\n\n\t\t\treturn element;\n\t\t});\n\t}\n\n\t#getMoreMenu(target: HTMLElement): Menu\n\t{\n\t\treturn this.cache.remember('moreMenu', () => {\n\t\t\tconst items = [];\n\n\t\t\tthis.getOptions().menuItems.forEach((item) => {\n\t\t\t\titems.push({\n\t\t\t\t\thtml: `\n\t\t\t\t\t\t<div class=\"intranet-avatar-widget-item-more-menu__wrapper\" data-id=\"bx-avatar-widget-more-menu-item-${item.type}\">\n\t\t\t\t\t\t\t<span class=\"intranet-avatar-widget-item-more-menu__title\">${item.title}</span>\n\t\t\t\t\t\t\t<i class=\"intranet-avatar-widget-item-more-menu__icon ui-icon-set ${item.icon}\"></i>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t`,\n\t\t\t\t\tonclick: () => {\n\t\t\t\t\t\tthis.#getMoreMenuActionByItem(item, target);\n\t\t\t\t\t\tthis.#getMoreMenu(target).close();\n\t\t\t\t\t\tEventEmitter.emit('BX.Intranet.AvatarWidget.Popup:openChild');\n\t\t\t\t\t},\n\t\t\t\t});\n\t\t\t});\n\n\t\t\treturn new Menu({\n\t\t\t\tbindElement: target,\n\t\t\t\titems,\n\t\t\t\tfixed: true,\n\t\t\t});\n\t\t});\n\t}\n\n\t#getMoreMenuActionByItem(item: Object): void\n\t{\n\t\t// eslint-disable-next-line default-case\n\t\tswitch (item.type)\n\t\t{\n\t\t\tcase 'settings': {\n\t\t\t\tAnalytics.sendOpenCommonSecurity();\n\t\t\t\tBX.SidePanel.Instance.open(item.url, { width: 1100 });\n\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tcase 'admin':\n\t\t\tcase 'network': {\n\t\t\t\tAnalytics.send(Analytics.EVENT_CLICK_NETWORK);\n\t\t\t\twindow.open(item.url, '_blank');\n\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tcase 'desktop': {\n\t\t\t\tAnalytics.send(Analytics.EVENT_CLICK_ACTIVITY_PORTAL_LIST);\n\t\t\t\t(new DesktopAccountList({ bindElement: document.querySelector('[data-id=\"bx-avatar-widget\"]') })).show();\n\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tcase 'login-history': {\n\t\t\t\tAnalytics.send(Analytics.EVENT_CLICK_LOGIN_HISTORY);\n\n\t\t\t\tif (!item.isAvailable)\n\t\t\t\t{\n\t\t\t\t\tFeaturePromotersRegistry.getPromoter({ code: 'limit_office_login_history' }).show();\n\t\t\t\t}\n\t\t\t\telse if (item.isConfigured)\n\t\t\t\t{\n\t\t\t\t\tBX.SidePanel.Instance.open(item.url, { allowedChangeHistory: false });\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tBX.Helper.show('redirect=detail&code=16615982');\n\t\t\t\t}\n\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tcase 'pulse': {\n\t\t\t\tajax.runAction('intranet.user.widget.getUserStatComponent', {\n\t\t\t\t\tmode: 'class'\n\t\t\t\t}).then((response) => {\n\t\t\t\t\tRuntime.html(null, response.data.html).then(() => {\n\t\t\t\t\t\tif (window['openIntranetUStat'])\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\topenIntranetUStat();\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t});\n\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\n\t#getWorkTime(): ?HTMLElement\n\t{\n\t\treturn this.cache.remember('worktime', () => {\n\t\t\tif (!this.getOptions().isTimemanAvailable)\n\t\t\t{\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\tif (!this.#getWorkTimeButton())\n\t\t\t{\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"intranet-avatar-widget-item__worktime\">\n\t\t\t\t\t${this.#getWorkTimeButton()}\n\t\t\t\t</div>\n\t\t\t`;\n\t\t});\n\t}\n\n\t#getWorkTimeButton(): ?HTMLElement\n\t{\n\t\treturn this.cache.remember('button', () => {\n\t\t\ttry\n\t\t\t{\n\t\t\t\treturn (new WorkTimeButton()).render();\n\t\t\t}\n\t\t\tcatch (error)\n\t\t\t{\n\t\t\t\tconsole.error(error);\n\n\t\t\t\treturn null;\n\t\t\t}\n\t\t});\n\t}\n\n\t#setEventHandlers(): void\n\t{\n\t\tEventEmitter.subscribe(\n\t\t\t'BX.Intranet.UserProfile:Avatar:changed',\n\t\t\t({ data: [{ url, userId }] }) => {\n\t\t\t\tif (this.getOptions().id > 0 && userId && this.getOptions().id.toString() === userId.toString())\n\t\t\t\t{\n\t\t\t\t\tconst preparedUrl = encodeURI(url);\n\t\t\t\t\tthis.getOptions().userPhotoSrc = preparedUrl;\n\t\t\t\t\tthis.#getAvatar().setUserPic(preparedUrl);\n\t\t\t\t}\n\t\t\t},\n\t\t);\n\t\tEventEmitter.subscribe(\n\t\t\t'BX.Intranet.UserProfile:Name:changed',\n\t\t\t({ data: [{ fullName }] }) => {\n\t\t\t\tthis.getOptions().fullName = fullName;\n\t\t\t\tthis.#getFullName().innerHTML = fullName;\n\t\t\t},\n\t\t);\n\t\tEventEmitter.subscribe('BX.Intranet.AvatarWidget.Popup:enabledAutoHide', () => {\n\t\t\tthis.#activeOnclick = true;\n\t\t});\n\t\tEventEmitter.subscribe('BX.Intranet.AvatarWidget.Popup:disabledAutoHide', () => {\n\t\t\tthis.#activeOnclick = false;\n\t\t});\n\t}\n}\n","import { Tag } from 'main.core';\nimport { EventEmitter } from 'main.core.events';\nimport { QrAuthorization } from 'ui.qrauthorization';\nimport { Content } from './content';\nimport { AirButtonStyle, Button } from 'ui.buttons';\nimport type { QrAuthContentOptions } from '../types';\n\nexport class QrAuthContent extends Content\n{\n\tgetOptions(): QrAuthContentOptions\n\t{\n\t\treturn super.getOptions();\n\t}\n\n\tgetConfig(): Object\n\t{\n\t\tif (this.getOptions().isSmall)\n\t\t{\n\t\t\treturn {\n\t\t\t\thtml: this.getLayout(),\n\t\t\t};\n\t\t}\n\n\t\treturn {\n\t\t\thtml: this.getLayout(),\n\t\t\tminHeight: '190px',\n\t\t\tflex: 0.5,\n\t\t};\n\t}\n\n\tgetLayout(): HTMLElement\n\t{\n\t\treturn this.cache.remember('layout', () => {\n\t\t\tif (this.getOptions().isSmall)\n\t\t\t{\n\t\t\t\treturn this.#getSmallState();\n\t\t\t}\n\n\t\t\treturn this.#getFullState();\n\t\t});\n\t}\n\n\t#getFullState(): HTMLElement\n\t{\n\t\treturn this.cache.remember('fullState', () => {\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"intranet-avatar-widget-item__wrapper --column-format\" data-id=\"bx-avatar-widget-content-qr-auth\">\n\t\t\t\t\t<span class=\"intranet-avatar-widget-item__title --qr-auth-full\">${this.getOptions().title}</span>\n\t\t\t\t\t<div class=\"intranet-avatar-widget-item-qr-auth__wrapper\">\n\t\t\t\t\t\t<i class=\"intranet-avatar-widget-item-qr-auth__icon ui-icon-set --o-qr-code\"></i>\n\t\t\t\t\t</div>\n\t\t\t\t\t${this.#getButton()}\n\t\t\t\t</div>\n\t\t\t`;\n\t\t});\n\t}\n\n\t#getSmallState(): HTMLElement\n\t{\n\t\treturn this.cache.remember('smallState', () => {\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"intranet-avatar-widget-item__wrapper --column-format\" data-id=\"bx-avatar-widget-content-qr-auth\">\n\t\t\t\t\t<div class=\"intranet-avatar-widget-item__wrapper-title\">\n\t\t\t\t\t\t<i class=\"ui-icon-set --o-qr-code intranet-avatar-widget-item__icon\"/>\n\t\t\t\t\t\t<span class=\"intranet-avatar-widget-item__title --qr-auth-small\">${this.getOptions().title}</span>\n\t\t\t\t\t</div>\n\t\t\t\t\t${this.#getButton()}\n\t\t\t\t</div>\n\t\t\t`;\n\t\t});\n\t}\n\n\t#getButton(): HTMLElement\n\t{\n\t\treturn this.cache.remember('button', () => {\n\t\t\tconst onclick = () => {\n\t\t\t\tEventEmitter.emit('BX.Intranet.AvatarWidget.Popup:openChild');\n\t\t\t\t(new QrAuthorization({\n\t\t\t\t\ttitle: this.getOptions().popup?.title,\n\t\t\t\t\tcontent: this.getOptions().popup?.description,\n\t\t\t\t\tintent: 'profile',\n\t\t\t\t})).show();\n\t\t\t};\n\t\t\tconst button = new Button({\n\t\t\t\tsize: Button.Size.EXTRA_EXTRA_SMALL,\n\t\t\t\ttext: this.getOptions().buttonTitle,\n\t\t\t\tuseAirDesign: true,\n\t\t\t\tstyle: AirButtonStyle.OUTLINE,\n\t\t\t\tnoCaps: true,\n\t\t\t\twide: true,\n\t\t\t\tonclick,\n\t\t\t});\n\n\t\t\treturn button.render();\n\t\t});\n\t}\n}\n","import { Browser, Tag } from 'main.core';\nimport { Menu } from 'main.popup';\nimport { AirButtonStyle, Button } from 'ui.buttons';\nimport { Content } from './content';\nimport { Analytics } from '../analytics';\nimport type { DesktopContentOptions, ConfigOptions } from '../types';\n\nexport class DesktopContent extends Content\n{\n\t#isLinux: boolean;\n\t#isMac: boolean;\n\t#isWindows: boolean;\n\n\tconstructor(options: DesktopContentOptions)\n\t{\n\t\tsuper(options);\n\t\tthis.#isLinux = Browser.isLinux();\n\t\tthis.#isWindows = Browser.isWin();\n\t\tthis.#isMac = Browser.isMac();\n\t}\n\n\tgetConfig(): ConfigOptions\n\t{\n\t\treturn {\n\t\t\thtml: this.getLayout(),\n\t\t\tdisplayBlock: !this.getOptions().isSmall,\n\t\t};\n\t}\n\n\tgetLayout(): HTMLElement\n\t{\n\t\treturn this.cache.remember('layout', () => {\n\t\t\tif (this.#isInstalledState())\n\t\t\t{\n\t\t\t\treturn this.#getInstalledState();\n\t\t\t}\n\n\t\t\treturn this.#getDefaultState();\n\t\t});\n\t}\n\n\t#getInstalledState(): HTMLElement\n\t{\n\t\treturn this.cache.remember('installedState', () => {\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"intranet-avatar-widget-item__wrapper --column-format\" data-id=\"bx-avatar-widget-content-desktop\">\n\t\t\t\t\t<div class=\"intranet-avatar-widget-item__wrapper-title\">\n\t\t\t\t\t\t<i class=\"ui-icon-set --o-screen intranet-avatar-widget-item__icon\"/>\n\t\t\t\t\t\t<div class=\"intranet-avatar-widget-item__info-wrapper\">\n\t\t\t\t\t\t\t${this.#getTitle()}\n\t\t\t\t\t\t\t${this.#getLink()}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"intranet-avatar-widget-item__status\">\n\t\t\t\t\t\t<i class=\"ui-icon-set --check-s\"></i>\n\t\t\t\t\t\t${this.getOptions().statusName}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t});\n\t}\n\n\t#getDefaultState(): HTMLElement\n\t{\n\t\treturn this.cache.remember('defaultState', () => {\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"intranet-avatar-widget-item__wrapper --column-format\" data-id=\"bx-avatar-widget-content-desktop\">\n\t\t\t\t\t<div class=\"intranet-avatar-widget-item__wrapper-title\">\n\t\t\t\t\t\t<i class=\"ui-icon-set --o-screen intranet-avatar-widget-item__icon --active\"/>\n\t\t\t\t\t\t${this.#getTitle()}\n\t\t\t\t\t</div>\n\t\t\t\t\t${this.#getButton()}\n\t\t\t\t</div>\n\t\t\t`;\n\t\t});\n\t}\n\n\t#isInstalledState(): boolean\n\t{\n\t\tif (this.#isLinux && this.getOptions().installInfo?.linux)\n\t\t{\n\t\t\treturn true;\n\t\t}\n\n\t\tif (this.#isMac && this.getOptions().installInfo?.mac)\n\t\t{\n\t\t\treturn true;\n\t\t}\n\n\t\treturn this.#isWindows && this.getOptions().installInfo?.windows;\n\t}\n\n\t#getTitle(): HTMLElement\n\t{\n\t\treturn this.cache.remember('title', () => {\n\t\t\tlet title = '';\n\n\t\t\tif (this.#isLinux)\n\t\t\t{\n\t\t\t\ttitle = this.getOptions().title.linux;\n\t\t\t}\n\t\t\telse if (this.#isMac)\n\t\t\t{\n\t\t\t\ttitle = this.getOptions().title.mac;\n\t\t\t}\n\t\t\telse if (this.#isWindows)\n\t\t\t{\n\t\t\t\ttitle = this.getOptions().title.windows;\n\t\t\t}\n\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"intranet-avatar-widget-item__title\">\n\t\t\t\t\t<span class=\"intranet-avatar-widget-item__title-text\">${title}</span>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t});\n\t}\n\n\t#getLink(): HTMLElement\n\t{\n\t\treturn this.cache.remember('link', () => {\n\t\t\treturn Tag.render`\n\t\t\t\t<span onclick=\"${(event) => this.#onClick(event)}\" class=\"intranet-avatar-widget-item__link\">\n\t\t\t\t\t${this.getOptions().linkName}\n\t\t\t\t</span>\n\t\t\t`;\n\t\t});\n\t}\n\n\t#getButton(): HTMLElement\n\t{\n\t\treturn this.cache.remember('button', () => {\n\t\t\tconst button = new Button({\n\t\t\t\tsize: Button.Size.SMALL,\n\t\t\t\ttext: this.getOptions().buttonName,\n\t\t\t\tuseAirDesign: true,\n\t\t\t\tstyle: AirButtonStyle.OUTLINE_ACCENT_2,\n\t\t\t\tnoCaps: true,\n\t\t\t\twide: true,\n\t\t\t\tonclick: (event) => {\n\t\t\t\t\tthis.#onClick(event);\n\t\t\t\t},\n\t\t\t});\n\n\t\t\treturn button.render();\n\t\t});\n\t}\n\n\t#onClick(target): ?string\n\t{\n\t\tAnalytics.send(Analytics.EVENT_CLICK_INSTALL_DESKTOP_APP);\n\n\t\tif (this.#isLinux)\n\t\t{\n\t\t\tthis.#getLinuxMenu(target).toggle();\n\t\t}\n\t\telse if (this.#isMac && this.getOptions().downloadLinks?.macos)\n\t\t{\n\t\t\tdocument.location.href = this.getOptions().downloadLinks.macos;\n\t\t}\n\t\telse if (this.#isWindows && this.getOptions().downloadLinks?.windows)\n\t\t{\n\t\t\tdocument.location.href = this.getOptions().downloadLinks.windows;\n\t\t}\n\t}\n\n\t#getLinuxMenu(target: Button | HTMLElement): Menu\n\t{\n\t\treturn this.cache.remember('linuxMenu', () => {\n\t\t\tlet bindElement = null;\n\t\t\tlet offsetLeft = 0;\n\t\t\tlet offsetTop = 0;\n\n\t\t\tif (target instanceof Button)\n\t\t\t{\n\t\t\t\tbindElement = target.getContainer();\n\t\t\t\toffsetLeft = 83;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tbindElement = target;\n\t\t\t\toffsetLeft = 5;\n\t\t\t\toffsetTop = 10;\n\t\t\t}\n\n\t\t\treturn new Menu({\n\t\t\t\tbindElement,\n\t\t\t\titems: [\n\t\t\t\t\t{\n\t\t\t\t\t\ttext: this.getOptions().linuxMenuTitles.deb,\n\t\t\t\t\t\thref: this.getOptions().downloadLinks.linuxDeb,\n\t\t\t\t\t\tonclick: () => {\n\t\t\t\t\t\t\tthis.#getLinuxMenu().close();\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\ttext: this.getOptions().linuxMenuTitles.rpm,\n\t\t\t\t\t\thref: this.getOptions().downloadLinks.linuxRpm,\n\t\t\t\t\t\tonclick: () => {\n\t\t\t\t\t\t\tthis.#getLinuxMenu().close();\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\n\t\t\t\t],\n\t\t\t\tangle: true,\n\t\t\t\toffsetLeft,\n\t\t\t\toffsetTop,\n\t\t\t\tfixed: true,\n\t\t\t});\n\t\t});\n\t}\n}\n","import { Tag } from 'main.core';\nimport { AirButtonStyle, Button } from 'ui.buttons';\nimport { Content } from './content';\nimport { Analytics } from '../analytics';\nimport type { OtpContentOptions } from '../types';\n\nexport class OtpContent extends Content\n{\n\tgetOptions(): OtpContentOptions\n\t{\n\t\treturn super.getOptions();\n\t}\n\n\tgetLayout(): HTMLElement\n\t{\n\t\treturn this.cache.remember('layout', () => {\n\t\t\tif (this.getOptions().isActive)\n\t\t\t{\n\t\t\t\treturn this.#getConnectedState();\n\t\t\t}\n\n\t\t\treturn this.#getCanConnectState();\n\t\t});\n\t}\n\n\t#getCanConnectState(): HTMLElement\n\t{\n\t\treturn this.cache.remember('canConnectState', () => {\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"intranet-avatar-widget-item__wrapper --column-format\" data-id=\"bx-avatar-widget-content-otp\">\n\t\t\t\t\t<div class=\"intranet-avatar-widget-item__wrapper-title\">\n\t\t\t\t\t\t<i class=\"ui-icon-set --o-shield intranet-avatar-widget-item__icon --active\"/>\n\t\t\t\t\t\t<span class=\"intranet-avatar-widget-item__title\">${this.getOptions().title}</span>\n\t\t\t\t\t</div>\n\t\t\t\t\t${this.#getButton()}\n\t\t\t\t</div>\n\t\t\t`;\n\t\t});\n\t}\n\n\t#getConnectedState(): HTMLElement\n\t{\n\t\treturn this.cache.remember('canConnectState', () => {\n\t\t\tconst onclick = () => {\n\t\t\t\tthis.#openSettingsSlider();\n\t\t\t};\n\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"intranet-avatar-widget-item__wrapper --column-format\" data-id=\"bx-avatar-widget-content-otp\">\n\t\t\t\t\t<div class=\"intranet-avatar-widget-item__wrapper-title\">\n\t\t\t\t\t\t<i class=\"ui-icon-set --o-shield intranet-avatar-widget-item__icon\"/>\n\t\t\t\t\t\t<div class=\"intranet-avatar-widget-item__info-wrapper\">\n\t\t\t\t\t\t\t<span class=\"intranet-avatar-widget-item__title\">${this.getOptions().title}</span>\n\t\t\t\t\t\t\t<span onclick=\"${onclick}\" class=\"intranet-avatar-widget-item__link\">${this.getOptions().settingsButtonTitle}</span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"intranet-avatar-widget-item__status\">\n\t\t\t\t\t\t<i class=\"ui-icon-set --check-s\"></i>\n\t\t\t\t\t\t${this.getOptions().connectStatus}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t});\n\t}\n\n\t#getButton(): HTMLElement\n\t{\n\t\treturn this.cache.remember('button', () => {\n\t\t\tconst button = new Button({\n\t\t\t\tsize: Button.Size.SMALL,\n\t\t\t\ttext: this.getOptions().connectButtonTitle,\n\t\t\t\tuseAirDesign: true,\n\t\t\t\tstyle: AirButtonStyle.OUTLINE_ACCENT_2,\n\t\t\t\tnoCaps: true,\n\t\t\t\twide: true,\n\t\t\t\tonclick: () => {\n\t\t\t\t\tthis.#openSettingsSlider();\n\t\t\t\t},\n\t\t\t});\n\n\t\t\treturn button.render();\n\t\t});\n\t}\n\n\t#openSettingsSlider(): void\n\t{\n\t\tAnalytics.send(Analytics.EVENT_CLICK_2FA_SETUP);\n\t\tBX.SidePanel.Instance.open(this.getOptions().settingsPath, { width: 1100 });\n\t}\n}\n","import { Dom, Tag, Type, Loc } from 'main.core';\nimport { PULL } from 'pull.client';\nimport { Counter } from 'ui.cnt';\nimport { FeaturePromotersRegistry } from 'ui.info-helper';\nimport { Content } from './content';\nimport { Router } from 'crm.router';\nimport type { SignDocumentsContentOptions } from '../types';\n\nexport class SignDocumentsContent extends Content\n{\n\tgetOptions(): SignDocumentsContentOptions\n\t{\n\t\treturn super.getOptions();\n\t}\n\n\tgetLayout(): HTMLElement\n\t{\n\t\treturn this.cache.remember('layout', () => {\n\t\t\tconst onclick = () => {\n\t\t\t\tthis.#onClick();\n\t\t\t};\n\n\t\t\treturn Tag.render`\n\t\t\t\t<div onclick=\"${onclick}\" class=\"intranet-avatar-widget-item__wrapper\" data-id=\"bx-avatar-widget-content-sign-documents\">\n\t\t\t\t\t<i class=\"ui-icon-set ${this.#getCounter() ? '--active' : ''} --o-file intranet-avatar-widget-item__icon\"/>\n\t\t\t\t\t<div class=\"intranet-avatar-widget-item__info-wrapper\">\n\t\t\t\t\t\t<span class=\"intranet-avatar-widget-item__title\">\n\t\t\t\t\t\t\t${this.getOptions().title}\n\t\t\t\t\t\t</span>\n\t\t\t\t\t\t<span class=\"intranet-avatar-widget-item__description\">\n\t\t\t\t\t\t\t${this.getOptions().description}\n\t\t\t\t\t\t</span>\n\t\t\t\t\t</div>\n\t\t\t\t\t${this.#getCounterWrapper()}\n\t\t\t\t\t<i class=\"ui-icon-set --chevron-right-m intranet-avatar-widget-item__chevron\"/>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t});\n\t}\n\n\t#getCounter(): ?Counter\n\t{\n\t\treturn this.cache.remember('counter', () => {\n\t\t\tif (Number(this.getOptions().counter) < 1)\n\t\t\t{\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\tPULL.subscribe({\n\t\t\t\tmoduleId: 'sign',\n\t\t\t\tcommand: this.getOptions().counterEventName,\n\t\t\t\tcallback: (params) => {\n\t\t\t\t\tif (!Type.isNumber(params?.needActionCount))\n\t\t\t\t\t{\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.getOptions().counter = params.needActionCount;\n\n\t\t\t\t\tif (params?.needActionCount > 0)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.#getCounter().update(params.needActionCount);\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.#getCounter().destroy();\n\t\t\t\t\t\tconst icon = this.getLayout().querySelector('.intranet-avatar-widget-item__icon');\n\t\t\t\t\t\tDom.removeClass(icon, '--active');\n\t\t\t\t\t\tthis.cache.delete('counter');\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t});\n\n\t\t\treturn new Counter({\n\t\t\t\tcolor: Counter.Color.DANGER,\n\t\t\t\tsize: Counter.Size.MEDIUM,\n\t\t\t\tvalue: this.getOptions().counter,\n\t\t\t});\n\t\t});\n\t}\n\n\t#getCounterWrapper(): HTMLElement\n\t{\n\t\treturn this.cache.remember('counterWrapper', () => {\n\t\t\tconst counter = this.#getCounter();\n\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"intranet-avatar-widget-item__counter\">\n\t\t\t\t\t${counter?.render()}\n\t\t\t\t</div>\n\t\t\t`;\n\t\t});\n\t}\n\n\t#onClick(): void\n\t{\n\t\tif (this.getOptions().isLocked)\n\t\t{\n\t\t\tFeaturePromotersRegistry.getPromoter({ code: 'limit_office_e_signature' }).show();\n\n\t\t\treturn;\n\t\t}\n\n\t\tconst userId = Number(Loc.getMessage('USER_ID'));\n\n\t\tif (userId > 0)\n\t\t{\n\t\t\tRouter.openSlider(\n\t\t\t\t`${Loc.getMessage('SITE_DIR')}company/personal/user/${userId}/sign?noRedirect=Y`,\n\t\t\t\t{ width: 1000, cacheable: false },\n\t\t\t);\n\t\t}\n\t}\n}\n","import { Event, Tag} from 'main.core';\nimport { EventEmitter } from 'main.core.events';\nimport { Content } from './content';\nimport { SalaryVacationMenu } from 'humanresources.hcmlink.salary-vacation-menu';\nimport { Analytics } from '../analytics';\nimport type { SalaryVacationContentOptions } from '../types';\n\nexport class SalaryVacationContent extends Content\n{\n\t#salaryVacationMenu: SalaryVacationMenu;\n\n\tconstructor(options: SalaryVacationContentOptions)\n\t{\n\t\tsuper(options);\n\t\tthis.#salaryVacationMenu = new SalaryVacationMenu();\n\t}\n\n\tgetOptions(): SalaryVacationContentOptions\n\t{\n\t\treturn super.getOptions();\n\t}\n\n\tgetLayout(): HTMLElement\n\t{\n\t\treturn this.cache.remember('layout', () => {\n\t\t\tif (this.#salaryVacationMenu.isHidden())\n\t\t\t{\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\tif (this.#salaryVacationMenu.isDisabled())\n\t\t\t{\n\t\t\t\treturn this.#getDisabledState();\n\t\t\t}\n\n\t\t\treturn this.#getActiveState();\n\t\t});\n\t}\n\n\t#getDisabledState(): HTMLElement\n\t{\n\t\treturn this.cache.remember('disabledState', () => {\n\t\t\tconst container = Tag.render`\n\t\t\t\t<div\n\t\t\t\t\tclass=\"intranet-avatar-widget-item__wrapper\"\n\t\t\t\t\tdata-id=\"bx-avatar-widget-content-salary-vacation\"\n\t\t\t\t\tdata-hint\n\t\t\t\t\tdata-hint-interactivity\n\t\t\t\t >\n\t\t\t\t\t<i class=\"ui-icon-set --o-favorite intranet-avatar-widget-item__icon\"/>\n\t\t\t\t\t<span class=\"intranet-avatar-widget-item__title\">${this.getOptions().title}</span>\n\t\t\t\t\t${this.#getChevron()}\n\t\t\t\t</div>\n\t\t\t`;\n\n\t\t\tEvent.bind(container, 'mouseenter', () => {\n\t\t\t\tthis.#getHintInstance().show(container, this.getOptions().disabledHint, true);\n\t\t\t});\n\n\t\t\tEvent.bind(container, 'mouseleave', () => {\n\t\t\t\tthis.#getHintInstance().hide(container);\n\t\t\t});\n\n\t\t\treturn container;\n\t\t});\n\t}\n\n\t#getHintInstance(): Manager\n\t{\n\t\treturn this.cache.remember('hint', () => {\n\t\t\treturn BX.UI.Hint.createInstance({\n\t\t\t\tpopupParameters: {\n\t\t\t\t\tfixed: true,\n\t\t\t\t\toffsetTop: -20,\n\t\t\t\t},\n\t\t\t});\n\t\t});\n\t}\n\n\t#getActiveState(): HTMLElement\n\t{\n\t\treturn this.cache.remember('activeState', () => {\n\t\t\tconst onclick = () => {\n\t\t\t\tthis.#salaryVacationMenu.show(this.#getChevron());\n\t\t\t\tAnalytics.send(Analytics.EVENT_CLICK_SALARY);\n\t\t\t};\n\n\t\t\treturn Tag.render`\n\t\t\t\t<div onclick=\"${onclick}\" class=\"intranet-avatar-widget-item__wrapper\" data-id=\"bx-avatar-widget-content-salary-vacation\">\n\t\t\t\t\t<i class=\"ui-icon-set --o-favorite intranet-avatar-widget-item__icon\"/>\n\t\t\t\t\t<span class=\"intranet-avatar-widget-item__title\">${this.getOptions().title}</span>\n\t\t\t\t\t${this.#getChevron()}\n\t\t\t\t</div>\n\t\t\t`;\n\t\t});\n\t}\n\n\t#getChevron(): HTMLElement\n\t{\n\t\treturn this.cache.remember('chevron', () => {\n\t\t\treturn Tag.render`<i class=\"ui-icon-set --chevron-right-m intranet-avatar-widget-item__chevron\"/>`;\n\t\t});\n\t}\n}\n","import { Tag, Text } from 'main.core';\nimport { EventEmitter } from 'main.core.events';\nimport { Menu } from 'main.popup';\nimport { Content } from './content';\nimport { Analytics } from '../analytics';\nimport type { ExtensionContentOptions } from '../types';\n\nexport class ExtensionContent extends Content\n{\n\t#bindElementDataId: string = 'intranet-avatar-widget-extensions';\n\n\tgetOptions(): ExtensionContentOptions\n\t{\n\t\treturn super.getOptions();\n\t}\n\n\tgetLayout(): HTMLElement\n\t{\n\t\treturn this.cache.remember('layout', () => {\n\t\t\tconst onclick = () => {\n\t\t\t\tAnalytics.send(Analytics.EVENT_CLICK_EXTENSION);\n\t\t\t\tthis.#getMenu().toggle();\n\t\t\t};\n\n\t\t\treturn Tag.render`\n\t\t\t\t<div onclick=\"${onclick}\" class=\"intranet-avatar-widget-item__wrapper\" data-id=\"bx-avatar-widget-content-extension\">\n\t\t\t\t\t<i class=\"ui-icon-set --o-box intranet-avatar-widget-item__icon\"/>\n\t\t\t\t\t<span class=\"intranet-avatar-widget-item__title\">${Text.encode(this.getOptions().text)}</span>\n\t\t\t\t\t<i data-id=\"${this.#bindElementDataId}\" class=\"ui-icon-set --chevron-right-m intranet-avatar-widget-item__chevron\"/>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t});\n\t}\n\n\t#getMenu(): Menu\n\t{\n\t\treturn this.cache.remember('menu', () => {\n\t\t\tconst menu = new Menu({\n\t\t\t\tbindElement: document.querySelector(`[data-id=\"${this.#bindElementDataId}\"]`),\n\t\t\t\titems: this.getOptions().items,\n\t\t\t\tangle: true,\n\t\t\t\tcachable: false,\n\t\t\t\toffsetLeft: 10,\n\t\t\t\tfixed: true,\n\t\t\t});\n\t\t\tEventEmitter.subscribe('SidePanel.Slider:onOpenStart', () => {\n\t\t\t\tmenu.close();\n\t\t\t});\n\n\t\t\treturn menu;\n\t\t});\n\t}\n}\n","import { DesktopApi } from 'im.v2.lib.desktop-api';\nimport { Tag, Uri } from 'main.core';\nimport { Content } from './content';\nimport { Analytics } from '../analytics';\nimport type { LogoutContentOptions } from '../types';\n\nexport class LogoutContent extends Content\n{\n\tgetOptions(): LogoutContentOptions\n\t{\n\t\treturn super.getOptions();\n\t}\n\n\tgetLayout(): HTMLElement\n\t{\n\t\treturn this.cache.remember('layout', () => {\n\t\t\tconst onclick = () => {\n\t\t\t\tAnalytics.send(Analytics.EVENT_CLICK_LOGOUT);\n\n\t\t\t\tif (DesktopApi.isDesktop())\n\t\t\t\t{\n\t\t\t\t\tDesktopApi.logout();\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tconst backUrl = new Uri(window.location.pathname);\n\t\t\t\t\tbackUrl.removeQueryParam(this.getOptions().removeQueryParam);\n\t\t\t\t\tconst newUrl = new Uri(this.getOptions().path);\n\t\t\t\t\tnewUrl.setQueryParam('sessid', BX.bitrix_sessid());\n\t\t\t\t\tnewUrl.setQueryParam('backurl', encodeURIComponent(backUrl.toString()));\n\t\t\t\t\tdocument.location.href = newUrl;\n\t\t\t\t}\n\t\t\t};\n\n\t\t\treturn Tag.render`\n\t\t\t\t<div onclick=\"${onclick}\" class=\"intranet-avatar-widget-item__wrapper --pointer\" data-id=\"bx-avatar-widget-content-logout\">\n\t\t\t\t\t<i class=\"ui-icon-set --o-log-out intranet-avatar-widget-item__icon\"/>\n\t\t\t\t\t<span class=\"intranet-avatar-widget-item__title\">${this.getOptions().title}</span>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t});\n\t}\n}\n","import { Tag } from 'main.core';\nimport { Content } from './content';\nimport { Analytics } from '../analytics';\n\nexport class ThemeContent extends Content\n{\n\tgetOptions(): Object\n\t{\n\t\treturn super.getOptions();\n\t}\n\n\tgetLayout(): HTMLElement\n\t{\n\t\treturn this.cache.remember('layout', () => {\n\t\t\tconst onclick = () => {\n\t\t\t\tAnalytics.send(Analytics.EVENT_CLICK_CHANGE_PORTAL_THEME);\n\t\t\t\tBX.Intranet.Bitrix24.ThemePicker.Singleton.showDialog(false);\n\t\t\t};\n\n\t\t\treturn Tag.render`\n\t\t\t\t<div onclick=\"${onclick}\" class=\"intranet-avatar-widget-item__wrapper --pointer\" data-id=\"bx-avatar-widget-content-settings\">\n\t\t\t\t\t<i class=\"ui-icon-set --o-image intranet-avatar-widget-item__icon\"/>\n\t\t\t\t\t<span class=\"intranet-avatar-widget-item__title\">${this.getOptions().title}</span>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t});\n\t}\n}\n","import { Loc, Tag } from 'main.core';\nimport { PerfReviewContentOptions } from '../types';\nimport { Content } from './content';\n\nexport class PerfReviewContent extends Content\n{\n\tgetOptions(): PerfReviewContentOptions\n\t{\n\t\treturn super.getOptions();\n\t}\n\n\tgetLayout(): HTMLElement\n\t{\n\t\treturn this.cache.remember('layout', () => {\n\t\t\tconst onclick = () => {\n\t\t\t\tthis.#onClick();\n\t\t\t};\n\n\t\t\treturn Tag.render`\n\t\t\t\t<div onclick=\"${onclick}\" class=\"intranet-avatar-widget-item__wrapper\" data-id=\"bx-avatar-widget-content-perf-review\">\n\t\t\t\t\t<i class=\"ui-icon-set --o-form intranet-avatar-widget-item__icon\"/>\n\t\t\t\t\t<div class=\"intranet-avatar-widget-item__info-wrapper\">\n\t\t\t\t\t\t<span class=\"intranet-avatar-widget-item__title\">\n\t\t\t\t\t\t\t${this.getOptions().title}\n\t\t\t\t\t\t</span>\n\t\t\t\t\t</div>\n\t\t\t\t\t<i class=\"ui-icon-set --chevron-right-m intranet-avatar-widget-item__chevron\"/>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t});\n\t}\n\n\t#onClick(): void\n\t{\n\t\tdocument.location.href = `${Loc.getMessage('SITE_DIR')}company/stafftools/performance_review/passing/`;\n\t}\n}\n","import { Cache, Dom } from 'main.core';\nimport { EventEmitter } from 'main.core.events';\nimport { PopupComponentsMaker } from 'ui.popupcomponentsmaker';\nimport { MainContent } from './content/main-content';\nimport { QrAuthContent } from './content/qr-auth-content';\nimport { DesktopContent } from './content/desktop-content';\nimport { OtpContent } from './content/otp-content';\nimport { SignDocumentsContent } from './content/sign-documents-content';\nimport { SalaryVacationContent } from './content/salary-vacation-content';\nimport { ExtensionContent } from './content/extension-content';\nimport { LogoutContent } from './content/logout-content';\nimport { ThemeContent } from './content/theme-content';\nimport { PerfReviewContent } from './content/perf-review-content';\nimport { Analytics } from './analytics';\nimport type { ConfigOptions, PopupOptions } from './types';\n\nexport class Popup extends EventEmitter\n{\n\t#cache = new Cache.MemoryCache();\n\t#popupsShowAfterBasePopup: Array<Popup> = [];\n\n\tconstructor(options: PopupOptions)\n\t{\n\t\tsuper();\n\t\tthis.setOptions(options);\n\t\tthis.setEventNamespace('BX.Intranet.AvatarWidget.Popup');\n\t\tthis.setEventHandlers();\n\t}\n\n\tsetOptions(options: PopupOptions): void\n\t{\n\t\tthis.#cache.set('options', options);\n\t}\n\n\tgetOptions(): PopupOptions\n\t{\n\t\treturn this.#cache.get('options', {});\n\t}\n\n\tshow(): void\n\t{\n\t\tthis.getBasePopup().show();\n\t\tthis.emit('show');\n\t\tAnalytics.send(Analytics.EVENT_OPEN_WIDGET);\n\t}\n\n\tclose(): void\n\t{\n\t\tthis.getBasePopup().close();\n\t}\n\n\tgetBasePopup(): PopupComponentsMaker\n\t{\n\t\treturn this.#cache.remember('popup', () => {\n\t\t\tthis.emit('beforeInit');\n\n\t\t\tconst popup = new PopupComponentsMaker({\n\t\t\t\ttarget: this.getOptions().target,\n\t\t\t\twidth: 450,\n\t\t\t\tcontent: this.#getContent(),\n\t\t\t\tpopupLoader: this.getOptions().loader,\n\t\t\t\toffsetLeft: -392,\n\t\t\t\toffsetTop: -50,\n\t\t\t});\n\t\t\tpopup.getPopup().setFixed(true);\n\t\t\tconst setOverlay = () => {\n\t\t\t\tif (BX.SidePanel.Instance.isOpen())\n\t\t\t\t{\n\t\t\t\t\tpopup.getPopup().setOverlay({\n\t\t\t\t\t\tbackgroundColor: 'transparent',\n\t\t\t\t\t});\n\t\t\t\t\tpopup.getPopup().showOverlay();\n\t\t\t\t}\n\t\t\t};\n\t\t\tsetOverlay();\n\t\t\tpopup.getPopup().subscribe('onClose', () => {\n\t\t\t\tthis.#popupsShowAfterBasePopup = [];\n\t\t\t\tpopup.getPopup().removeOverlay();\n\t\t\t});\n\t\t\tpopup.getPopup().subscribe('onBeforeShow', setOverlay);\n\t\t\tthis.#cache.set('popup', popup);\n\n\t\t\tthis.emit('afterInit');\n\n\t\t\treturn popup;\n\t\t});\n\t}\n\n\t#getContent(): Array<ConfigOptions>\n\t{\n\t\treturn this.#cache.remember('content', () => {\n\t\t\tconst content = [\n\t\t\t\tthis.#getMainContent().getConfig(),\n\t\t\t];\n\n\t\t\tif (this.getOptions().content?.signDocuments?.isAvailable)\n\t\t\t{\n\t\t\t\tcontent.push(\n\t\t\t\t\tthis.#getSignDocumentsContent().getConfig(),\n\t\t\t\t\tthis.#getSalaryVacationContent().getConfig(),\n\t\t\t\t);\n\t\t\t}\n\n\t\t\tif (this.getOptions().content?.perfReview?.isAvailable)\n\t\t\t{\n\t\t\t\tcontent.push(this.#getPerfReviewContent().getConfig());\n\t\t\t}\n\n\t\t\tif (this.getOptions().content?.otp?.isAvailable)\n\t\t\t{\n\t\t\t\tcontent.push({\n\t\t\t\t\thtml: [\n\t\t\t\t\t\tthis.#getQrAuthContent().getConfig(),\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\thtml: [\n\t\t\t\t\t\t\t\tthis.#getDesktopContent().getConfig(),\n\t\t\t\t\t\t\t\tthis.#getOtpContent().getConfig(),\n\t\t\t\t\t\t\t],\n\t\t\t\t\t\t},\n\t\t\t\t\t],\n\t\t\t\t});\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tcontent.push({\n\t\t\t\t\thtml: [\n\t\t\t\t\t\tthis.#getQrAuthContent().getConfig(),\n\t\t\t\t\t\tthis.#getDesktopContent().getConfig(),\n\t\t\t\t\t],\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tif (this.getOptions().content?.extension?.isAvailable)\n\t\t\t{\n\t\t\t\tcontent.push(this.#getExtensionContent().getConfig());\n\t\t\t}\n\n\t\t\tcontent.push(\n\t\t\t\t{\n\t\t\t\t\thtml: [\n\t\t\t\t\t\tthis.#getThemeContent().getConfig(),\n\t\t\t\t\t\tthis.#getLogoutContent().getConfig(),\n\t\t\t\t\t],\n\t\t\t\t},\n\t\t\t);\n\n\t\t\treturn content;\n\t\t});\n\t}\n\n\t#getMainContent(): MainContent\n\t{\n\t\treturn this.#cache.remember('mainContent', () => {\n\t\t\treturn new MainContent({\n\t\t\t\t...this.getOptions().content.main,\n\t\t\t});\n\t\t});\n\t}\n\n\t#getSignDocumentsContent(): SignDocumentsContent\n\t{\n\t\treturn this.#cache.remember('myDocumentsContent', () => {\n\t\t\treturn new SignDocumentsContent({\n\t\t\t\t...this.getOptions().content.signDocuments,\n\t\t\t});\n\t\t});\n\t}\n\n\t#getSalaryVacationContent(): SalaryVacationContent\n\t{\n\t\treturn this.#cache.remember('salaryVacationContent', () => {\n\t\t\treturn new SalaryVacationContent({\n\t\t\t\t...this.getOptions().content.salaryVacation,\n\t\t\t});\n\t\t});\n\t}\n\n\t#getPerfReviewContent(): PerfReviewContent\n\t{\n\t\treturn this.#cache.remember('perfReviewContent', () => {\n\t\t\treturn new PerfReviewContent({\n\t\t\t\t...this.getOptions().content.perfReview,\n\t\t\t});\n\t\t});\n\t}\n\n\t#getQrAuthContent(): QrAuthContent\n\t{\n\t\treturn this.#cache.remember('qrAuthContent', () => {\n\t\t\treturn new QrAuthContent({\n\t\t\t\tisSmall: !this.getOptions().content.otp?.isAvailable,\n\t\t\t\t...this.getOptions().content.qrAuth,\n\t\t\t});\n\t\t});\n\t}\n\n\t#getDesktopContent(): DesktopContent\n\t{\n\t\treturn this.#cache.remember('desktopContent', () => {\n\t\t\treturn new DesktopContent({\n\t\t\t\tisSmall: !this.getOptions().content.otp?.isAvailable,\n\t\t\t\t...this.getOptions().content.desktop,\n\t\t\t});\n\t\t});\n\t}\n\n\t#getOtpContent(): OtpContent\n\t{\n\t\treturn this.#cache.remember('otpContent', () => {\n\t\t\treturn new OtpContent({\n\t\t\t\t...this.getOptions().content.otp,\n\t\t\t});\n\t\t});\n\t}\n\n\t#getExtensionContent(): ExtensionContent\n\t{\n\t\treturn this.#cache.remember('extensionContent', () => {\n\t\t\treturn new ExtensionContent({\n\t\t\t\t...this.getOptions().content.extension,\n\t\t\t});\n\t\t});\n\t}\n\n\t#getThemeContent(): ThemeContent\n\t{\n\t\treturn this.#cache.remember('settingsContent', () => {\n\t\t\treturn new ThemeContent({\n\t\t\t\t...this.getOptions().content.theme,\n\t\t\t});\n\t\t});\n\t}\n\n\t#getLogoutContent(): LogoutContent\n\t{\n\t\treturn this.#cache.remember('logoutContent', () => {\n\t\t\treturn new LogoutContent({\n\t\t\t\t...this.getOptions().content.logout,\n\t\t\t});\n\t\t});\n\t}\n\n\tsetEventHandlers(): void\n\t{\n\t\tthis.subscribe('beforeInit', () => {\n\t\t\tEventEmitter.subscribe('BX.Intranet.AvatarWidget.Popup:makeWithHint', () => {\n\t\t\t\tthis.subscribe('afterInit', () => {\n\t\t\t\t\tBX.UI.Hint.init(this.getBasePopup().getPopup().getPopupContainer());\n\t\t\t\t});\n\t\t\t});\n\t\t\tthis.subscribe('afterInit', () => {\n\t\t\t\tthis.#setAutoHideEventHandlers();\n\n\t\t\t\tconst close = () => {\n\t\t\t\t\tthis.close();\n\t\t\t\t};\n\n\t\t\t\tEventEmitter.subscribe('SidePanel.Slider:onOpenStart', close);\n\t\t\t\tEventEmitter.subscribe('BX.Intranet.AvatarWidget.Popup:openChild', close);\n\t\t\t});\n\t\t});\n\t}\n\n\t#setAutoHideEventHandlers(): void\n\t{\n\t\tEventEmitter.subscribe('BX.Main.Popup:onShow', (event) => {\n\t\t\tif (!this.getBasePopup().getPopup().isShown())\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tDom.style(this.getBasePopup().getPopup().getPopupContainer(), 'overflow-y', 'hidden');\n\n\t\t\tconst popup = event.getTarget();\n\n\t\t\tif (popup && popup.getId() === this.getBasePopup().getPopup().getId())\n\t\t\t{\n\t\t\t\tthis.getBasePopup().getPopup().setAutoHide(true);\n\t\t\t\tEventEmitter.emit('BX.Intranet.AvatarWidget.Popup:enabledAutoHide');\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.getBasePopup().getPopup().setAutoHide(false);\n\t\t\t\tEventEmitter.emit('BX.Intranet.AvatarWidget.Popup:disabledAutoHide');\n\n\t\t\t\tif (!this.#popupsShowAfterBasePopup.includes(popup))\n\t\t\t\t{\n\t\t\t\t\tthis.#popupsShowAfterBasePopup.push(popup);\n\t\t\t\t}\n\n\t\t\t\tconst handler = () => {\n\t\t\t\t\tthis.#popupsShowAfterBasePopup = this.#popupsShowAfterBasePopup.filter((item) => item !== popup);\n\n\t\t\t\t\tif (this.#popupsShowAfterBasePopup.length === 0)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.getBasePopup().getPopup().setAutoHide(true);\n\t\t\t\t\t\tDom.style(this.getBasePopup().getPopup().getPopupContainer(), 'overflow-y', 'auto');\n\t\t\t\t\t\tEventEmitter.emit('BX.Intranet.AvatarWidget.Popup:enabledAutoHide');\n\t\t\t\t\t}\n\t\t\t\t};\n\n\t\t\t\tpopup.subscribeOnce('onClose', handler);\n\t\t\t\tpopup.subscribeOnce('onDestroy', handler);\n\t\t\t}\n\t\t});\n\t}\n}\n","import { Cache } from 'main.core';\nimport { Popup } from './popup';\nimport type { GeneralOptions } from './types';\nimport './style.css';\n\nexport class AvatarWidget\n{\n\t#cache = new Cache.MemoryCache();\n\tstatic #instance: AvatarWidget;\n\n\tstatic getInstance(): AvatarWidget\n\t{\n\t\tif (!this.#instance)\n\t\t{\n\t\t\tthis.#instance = new this();\n\t\t}\n\n\t\treturn this.#instance;\n\t}\n\n\tshow(): void\n\t{\n\t\tif (this.#getPopup().getBasePopup().isShown())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.#getPopup().show();\n\t}\n\n\tsetOptions(options: GeneralOptions): AvatarWidget\n\t{\n\t\tthis.#cache.set('options', options);\n\n\t\treturn this;\n\t}\n\n\tgetOptions(): GeneralOptions\n\t{\n\t\treturn this.#cache.get('options', {});\n\t}\n\n\t#getPopup(): Popup\n\t{\n\t\treturn this.#cache.remember('popup', () => {\n\t\t\treturn new Popup({\n\t\t\t\ttarget: this.getOptions().buttonWrapper,\n\t\t\t\tloader: this.getOptions().loader,\n\t\t\t\tcontent: {\n\t\t\t\t\t...this.getOptions().data,\n\t\t\t\t},\n\t\t\t});\n\t\t});\n\t}\n}\n"],"names":["Content","EventEmitter","constructor","options","super","this","cache","Cache","MemoryCache","setOptions","setEventNamespace","set","getOptions","get","getLayout","Error","getConfig","html","minHeight","Analytics","[object Object]","event","sendData","tool","TOOLS","category","CATEGORY","CATEGORY_PROFILE","EVENT_PROFILE_VIEW","c_section","EVENT_OPEN_WIDGET","EVENT_CLICK_SALARY","EVENT_CLICK_INSTALL_DESKTOP_APP","EVENT_CLICK_2FA_SETUP","EVENT_CLICK_EXTENSION","EVENT_CLICK_LOGOUT","EVENT_CLICK_CHANGE_PORTAL_THEME","EVENT_CLICK_LOGIN_HISTORY","EVENT_CLICK_NETWORK","EVENT_CLICK_ACTIVITY_PORTAL_LIST","MainContent","Object","value","writable","remember","babelHelpers","Tag","render","BX","SidePanel","Instance","open","url","sendOpenProfile","getContainer","fullName","status","size","userpicPath","encodeURI","userPhotoSrc","avatar","role","AvatarRoundExtranet","AvatarRoundGuest","AvatarRound","element","Event","bind","preventDefault","stopPropagation","target","toggle","items","menuItems","forEach","item","push","type","title","icon","onclick","close","emit","Menu","bindElement","fixed","sendOpenCommonSecurity","width","send","window","DesktopAccountList","document","querySelector","show","isAvailable","isConfigured","allowedChangeHistory","Helper","FeaturePromotersRegistry","getPromoter","code","ajax","runAction","mode","then","response","Runtime","data","openIntranetUStat","isTimemanAvailable","WorkTimeButton","error","console","subscribe","userId","id","toString","preparedUrl","setUserPic","innerHTML","QrAuthContent","isSmall","flex","Button","Size","EXTRA_EXTRA_SMALL","text","buttonTitle","useAirDesign","style","AirButtonStyle","OUTLINE","noCaps","wide","QrAuthorization","popup","_this$getOptions$popu","content","_this$getOptions$popu2","description","intent","DesktopContent","Browser","isLinux","isWin","isMac","displayBlock","statusName","installInfo","_this$getOptions$inst","linux","_this$getOptions$inst2","mac","_this$getOptions$inst3","windows","linkName","SMALL","buttonName","OUTLINE_ACCENT_2","downloadLinks","_this$getOptions$down","macos","location","href","_this$getOptions$down2","offsetLeft","offsetTop","linuxMenuTitles","deb","linuxDeb","rpm","linuxRpm","angle","OtpContent","isActive","settingsButtonTitle","connectStatus","connectButtonTitle","settingsPath","SignDocumentsContent","Number","counter","PULL","moduleId","command","counterEventName","callback","params","Type","isNumber","needActionCount","update","destroy","Dom","removeClass","delete","Counter","color","Color","DANGER","MEDIUM","isLocked","Loc","getMessage","Router","openSlider","cacheable","SalaryVacationContent","SalaryVacationMenu","isHidden","isDisabled","container","disabledHint","hide","UI","Hint","createInstance","popupParameters","ExtensionContent","Text","encode","menu","cachable","LogoutContent","DesktopApi","isDesktop","logout","backUrl","Uri","pathname","removeQueryParam","newUrl","path","setQueryParam","bitrix_sessid","encodeURIComponent","ThemeContent","Intranet","Bitrix24","ThemePicker","Singleton","showDialog","PerfReviewContent","Popup","setEventHandlers","getBasePopup","PopupComponentsMaker","popupLoader","loader","getPopup","setFixed","setOverlay","isOpen","backgroundColor","showOverlay","removeOverlay","init","getPopupContainer","_this$getOptions$cont","signDocuments","_this$getOptions$cont2","_this$getOptions$cont3","perfReview","_this$getOptions$cont4","_this$getOptions$cont5","otp","_this$getOptions$cont6","_this$getOptions$cont7","extension","_this$getOptions$cont8","main","salaryVacation","_this$getOptions$cont9","qrAuth","_this$getOptions$cont10","desktop","theme","isShown","getTarget","getId","setAutoHide","includes","handler","filter","length","subscribeOnce","AvatarWidget","buttonWrapper"],"mappings":"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"}