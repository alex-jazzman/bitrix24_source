this.BX=this.BX||{},function(e,t,s,i,a,r,n,o,l,c,p,d,u,h,b,g,v,m){"use strict";class P extends m.EventEmitter{constructor(e){super(),this.cache=new b.Cache.MemoryCache,this.setOptions(e),this.setEventNamespace("BX.Intranet.AvatarWidget.Content")}setOptions(e){return this.cache.set("options",e),this}getOptions(){return this.cache.get("options",{})}getLayout(){throw new Error("Must be implemented in a child class")}getConfig(){return{html:this.getLayout(),minHeight:"50px",margin:"0 13px"}}}class L{static send(e){a.sendData({tool:L.TOOLS,category:L.CATEGORY,event:e})}static sendOpenProfile(){a.sendData({tool:L.TOOLS,category:L.CATEGORY_PROFILE,event:L.EVENT_PROFILE_VIEW,c_section:L.CATEGORY})}static sendOpenCommonSecurity(){a.sendData({tool:"settings",category:"common_security",event:"start_page",c_section:L.CATEGORY})}}L.TOOLS="intranet",L.CATEGORY="ava_menu",L.CATEGORY_PROFILE="user_profile",L.EVENT_OPEN_WIDGET="menu_open",L.EVENT_PROFILE_VIEW="profile_view",L.EVENT_CLICK_SALARY="click_salary",L.EVENT_CLICK_INSTALL_DESKTOP_APP="click_install_desktop_app",L.EVENT_CLICK_INSTALL_MOBILE_APP="click_install_mobile_app",L.EVENT_CLICK_FAST_MOBILE_AUTH="click_fast_mobile_auth",L.EVENT_CLICK_2FA_SETUP="click_2fa_setup",L.EVENT_CLICK_EXTENSION="click_extension",L.EVENT_CLICK_LOGOUT="click_logout",L.EVENT_CLICK_CHANGE_PORTAL_THEME="click_change_portal_theme",L.EVENT_CLICK_NETWORK="click_network",L.EVENT_CLICK_ACTIVITY_PORTAL_LIST="click_activity_portal_list",L.EVENT_CLICK_PULSE="click_open_pulse",L.EVENT_CLICK_MY_DOCUMENTS="click_open_my_documents";class _{constructor(e={}){this.cache=new b.Cache.MemoryCache,this.options=e}getLayout(){throw new Error("Must be implemented in a child class")}getIconClass(){throw new Error("Must be implemented in a child class")}onClick(){throw new Error("Must be implemented in a child class")}getIconElement(){throw new Error("Must be implemented in a child class")}getTitle(){return this.options.title||this.options.text||""}}let E,C,y,I=e=>e;var w=babelHelpers.classPrivateFieldLooseKey("getCounterWrapper");class f extends _{constructor(...e){super(...e),Object.defineProperty(this,w,{value:B})}getLayout(){return this.cache.remember("layout",()=>b.Tag.render(E||(E=I`
				<div data-testid="bx-avatar-widget-main-tool-${0}" onclick="${0}" class="intranet-avatar-widget-main-tool__wrapper">
					<div class="intranet-avatar-widget-main-tool-icon__wrapper">
						${0}
						${0}
					</div>
					<div class="intranet-avatar-widget-main-tool__title">
						${0}
					</div>
				</div>
			`),this.getId(),this.onClick.bind(this),this.getIconElement(),babelHelpers.classPrivateFieldLooseBase(this,w)[w](),this.getTitle()))}getIconElement(){return this.cache.remember("icon",()=>b.Tag.render(C||(C=I`<i class="ui-icon-set ${0} intranet-avatar-widget-main-tool__icon"/>`),this.getIconClass()))}getCounter(){return null}getId(){return""}}function B(){return this.cache.remember("counterWrapper",()=>{const e=this.getCounter();return b.Tag.render(y||(y=I`
				<div class="intranet-avatar-widget-main-tool__counter-wrapper">
					${0}
				</div>
			`),null==e?void 0:e.render())})}var H=babelHelpers.classPrivateFieldLooseKey("getMenu");class O extends f{constructor(...e){super(...e),Object.defineProperty(this,H,{value:T})}getIconClass(){return"--o-box"}onClick(){L.send(L.EVENT_CLICK_EXTENSION),babelHelpers.classPrivateFieldLooseBase(this,H)[H]().toggle()}getId(){return"extension"}}function T(){return this.cache.remember("menu",()=>{const e=new u.Menu({bindElement:this.getIconElement(),items:this.options.items,angle:!0,cachable:!1,offsetLeft:10,fixed:!0});return m.EventEmitter.subscribe("SidePanel.Slider:onOpenStart",()=>{e.close()}),e})}class F extends f{getIconClass(){return"--o-shield-checked"}onClick(){L.send(L.EVENT_CLICK_2FA_SETUP),v.SidePanel.Instance.open(this.options.url,{width:1100})}getId(){return"security"}}class A extends f{getIconClass(){return"--o-file"}onClick(){if(L.send(L.EVENT_CLICK_MY_DOCUMENTS),this.options.isLocked)return void r.FeaturePromotersRegistry.getPromoter({code:"limit_office_e_signature"}).show();const e=Number(b.Loc.getMessage("USER_ID"));e>0&&n.Router.openSlider(`${b.Loc.getMessage("SITE_DIR")}company/personal/user/${e}/sign?noRedirect=Y`,{width:1e3,cacheable:!1})}getCounter(){return this.cache.remember("counter",()=>Number(this.options.counter)<1?null:(o.PULL.subscribe({moduleId:"sign",command:this.options.counterEventName,callback:e=>{if(b.Type.isNumber(null==e?void 0:e.needActionCount))if(this.options.counter=e.needActionCount,(null==e?void 0:e.needActionCount)>0)this.getCounter().update(e.needActionCount);else{this.getCounter().destroy();const e=this.getLayout().querySelector(".intranet-avatar-widget-item__icon");b.Dom.removeClass(e,"--active"),this.cache.delete("counter")}}}),new p.Counter({color:p.Counter.Color.DANGER,size:p.Counter.Size.MEDIUM,value:this.options.counter,style:p.CounterStyle.FILLED_ALERT,useAirDesign:!0})))}getId(){return"my-documents"}}var k=babelHelpers.classPrivateFieldLooseKey("getMenu"),S=babelHelpers.classPrivateFieldLooseKey("getHintInstance");class K extends f{constructor(...e){super(...e),Object.defineProperty(this,S,{value:N}),Object.defineProperty(this,k,{value:x})}getIconClass(){return"--o-favorite"}getLayout(){const e=super.getLayout();return babelHelpers.classPrivateFieldLooseBase(this,k)[k]().isHidden()?null:(babelHelpers.classPrivateFieldLooseBase(this,k)[k]().isDisabled()&&(b.Dom.attr(e,"data-hint",""),b.Dom.attr(e,"data-hint-interactivity",""),b.Event.bind(e,"mouseenter",()=>{babelHelpers.classPrivateFieldLooseBase(this,S)[S]().show(e,this.options.disabledHint)}),b.Event.bind(e,"mouseleave",()=>{babelHelpers.classPrivateFieldLooseBase(this,S)[S]().hide(e)})),super.getLayout())}onClick(){L.send(L.EVENT_CLICK_SALARY),babelHelpers.classPrivateFieldLooseBase(this,k)[k]().isHidden()||babelHelpers.classPrivateFieldLooseBase(this,k)[k]().isDisabled()||babelHelpers.classPrivateFieldLooseBase(this,k)[k]().show(this.getLayout())}getId(){return"salary-vacation"}}function x(){return this.cache.remember("salaryMenu",()=>new l.SalaryVacationMenu)}function N(){return this.cache.remember("hint",()=>BX.UI.Hint.createInstance({popupParameters:{fixed:!0}}))}let M,X,$,D,W,j,R,V,U=e=>e;var G=babelHelpers.classPrivateFieldLooseKey("activeOnclick"),Y=babelHelpers.classPrivateFieldLooseKey("handleClickTaskStatus"),z=babelHelpers.classPrivateFieldLooseKey("getFullName"),Q=babelHelpers.classPrivateFieldLooseKey("getWorkPosition"),q=babelHelpers.classPrivateFieldLooseKey("getAvatar"),J=babelHelpers.classPrivateFieldLooseKey("getStatus"),Z=babelHelpers.classPrivateFieldLooseKey("getWorkStatusBlock"),ee=babelHelpers.classPrivateFieldLooseKey("getWorkStatusControlPanel"),te=babelHelpers.classPrivateFieldLooseKey("getToolsContainer"),se=babelHelpers.classPrivateFieldLooseKey("getTools"),ie=babelHelpers.classPrivateFieldLooseKey("setEventHandlers");class ae extends P{constructor(...e){super(...e),Object.defineProperty(this,ie,{value:be}),Object.defineProperty(this,se,{value:he}),Object.defineProperty(this,te,{value:ue}),Object.defineProperty(this,ee,{value:de}),Object.defineProperty(this,Z,{value:pe}),Object.defineProperty(this,J,{value:ce}),Object.defineProperty(this,q,{value:le}),Object.defineProperty(this,Q,{value:oe}),Object.defineProperty(this,z,{value:ne}),Object.defineProperty(this,Y,{value:re}),Object.defineProperty(this,G,{writable:!0,value:!0})}getConfig(){return{html:this.getLayout()}}getOptions(){return super.getOptions()}getLayout(){return this.cache.remember("layout",()=>{babelHelpers.classPrivateFieldLooseBase(this,ie)[ie]();return b.Tag.render(M||(M=U`
				<div class="intranet-avatar-widget-item__wrapper" data-testid="bx-avatar-widget-content-main">
					<div onclick="${0}" class="intranet-avatar-widget-item-main__wrapper-head">
						<div class="intranet-avatar-widget-item__avatar">
							${0}
						</div>
						<div class="intranet-avatar-widget-item__info-wrapper">
							${0}
							${0}
						</div>
					</div>
					${0}
					${0}
					${0}
				</div>
			`),()=>{babelHelpers.classPrivateFieldLooseBase(this,G)[G]&&(BX.SidePanel.Instance.open(this.getOptions().url),L.sendOpenProfile())},babelHelpers.classPrivateFieldLooseBase(this,q)[q]().getContainer(),babelHelpers.classPrivateFieldLooseBase(this,z)[z](),babelHelpers.classPrivateFieldLooseBase(this,Q)[Q](),babelHelpers.classPrivateFieldLooseBase(this,J)[J](),babelHelpers.classPrivateFieldLooseBase(this,Z)[Z](),babelHelpers.classPrivateFieldLooseBase(this,te)[te]())})}}function re(e){e.stopPropagation(),e.preventDefault()}function ne(){return this.cache.remember("title",()=>b.Tag.render(X||(X=U`
				<span class="intranet-avatar-widget-item__title">
					<span>${0}</span>
					<i class="ui-icon-set --chevron-right-s intranet-avatar-widget-item__chevron"/>
				</span>
			`),this.getOptions().fullName))}function oe(){return this.cache.remember("workPosition",()=>this.getOptions().workPosition?b.Tag.render($||($=U`
				<span class="intranet-avatar-widget-item__description">${0}</span>
			`),this.getOptions().workPosition):null)}function le(){return this.cache.remember("avatar",()=>{const e={size:48,userpicPath:encodeURI(this.getOptions().userPhotoSrc)};let t=null;return t="extranet"===this.getOptions().role?new s.AvatarRoundExtranet(e):"collaber"===this.getOptions().role?new s.AvatarRoundGuest(e):new s.AvatarRound(e),t})}function ce(){return this.cache.remember("status",()=>{if(!this.getOptions().status&&!this.getOptions().vacation)return null;const e=b.Tag.render(D||(D=U`
				<div class="intranet-avatar-widget-main__status-wrapper"></div>
			`));if(this.getOptions().vacation&&b.Dom.append(b.Tag.render(W||(W=U`
					<span class="intranet-avatar-widget-main__status --vacation">
						${0}
					</span>
				`),this.getOptions().vacation),e),this.getOptions().status){const t=b.Tag.render(j||(j=U`
					<span class="intranet-avatar-widget-main__status">
						${0}
					</span>
				`),this.getOptions().status);"collaber"===this.getOptions().role?b.Dom.addClass(t,"--collaber"):"extranet"===this.getOptions().role&&b.Dom.addClass(t,"--extranet"),b.Dom.append(t,e)}return e})}function pe(){return this.cache.remember("worktime",()=>this.getOptions().isTimemanAvailable&&babelHelpers.classPrivateFieldLooseBase(this,ee)[ee]()?b.Tag.render(R||(R=U`
				<div
					class="intranet-avatar-widget-item__task-status task-status"
					onclick="${0}"
				>
					${0}
				</div>
			`),babelHelpers.classPrivateFieldLooseBase(this,Y)[Y],babelHelpers.classPrivateFieldLooseBase(this,ee)[ee]()):null)}function de(){return this.cache.remember("taskStatusActions",()=>{try{return(new i.WorkStatusControlPanel).renderWorkStatusControlPanel()}catch(e){return console.error(e),null}})}function ue(){return this.cache.remember("tools-container",()=>{if(!this.getOptions().tools||0===Object.keys(this.getOptions().tools).length)return null;const e=b.Tag.render(V||(V=U`
				<div class="intranet-avatar-widget-main-tools__wrapper"></div>
			`));return babelHelpers.classPrivateFieldLooseBase(this,se)[se]().forEach(t=>{b.Dom.append(t.getLayout(),e)}),e})}function he(){return this.cache.remember("tools",()=>{const e=this.getOptions().tools;return[e.myDocuments?new A(e.myDocuments):null,e.salaryVacation?new K(e.salaryVacation):null,e.security?new F(e.security):null,e.extension?new O(e.extension):null].filter(Boolean)})}function be(){m.EventEmitter.subscribe("BX.Intranet.UserProfile:Avatar:changed",({data:[{url:e,userId:t}]})=>{if(this.getOptions().id>0&&t&&this.getOptions().id.toString()===t.toString()){const t=encodeURI(e);this.getOptions().userPhotoSrc=t,babelHelpers.classPrivateFieldLooseBase(this,q)[q]().setUserPic(t)}}),m.EventEmitter.subscribe("BX.Intranet.UserProfile:Name:changed",({data:[{fullName:e}]})=>{this.getOptions().fullName=e,babelHelpers.classPrivateFieldLooseBase(this,z)[z]().querySelector("span").innerHTML=e}),m.EventEmitter.subscribe("BX.Intranet.AvatarWidget.Popup:enabledAutoHide",()=>{babelHelpers.classPrivateFieldLooseBase(this,G)[G]=!0}),m.EventEmitter.subscribe("BX.Intranet.AvatarWidget.Popup:disabledAutoHide",()=>{babelHelpers.classPrivateFieldLooseBase(this,G)[G]=!1})}let ge,ve=e=>e;class me{constructor(e={}){this.cache=new b.Cache.MemoryCache,this.options=e}getLayout(){return b.Tag.render(ge||(ge=ve`
			<div data-testid="bx-avatar-widget-footer-tool-${0}" onclick="${0}" class="intranet-avatar-widget-footer__item">
				${0}
			</div>
		`),this.getId(),this.onClick.bind(this),this.getTitle())}onClick(){throw new Error("Must be implemented in a child class")}getTitle(){return this.options.title||this.options.text||""}getId(){return""}}class Pe extends me{onClick(){L.send(L.EVENT_CLICK_CHANGE_PORTAL_THEME),m.EventEmitter.emit("BX.Intranet.AvatarWidget.Popup:openChild"),BX.Intranet.Bitrix24.ThemePicker.Singleton.showDialog(!1)}getId(){return"theme"}}class Le extends me{onClick(){L.send(L.EVENT_CLICK_PULSE),b.ajax.runAction("intranet.user.widget.getUserStatComponent",{mode:"class"}).then(e=>{b.Runtime.html(null,e.data.html).then(()=>{window.openIntranetUStat&&(m.EventEmitter.emit("BX.Intranet.AvatarWidget.Popup:openChild"),openIntranetUStat())}).catch(()=>{})}).catch(()=>{})}getId(){return"pulse"}}class _e extends me{onClick(){if(L.send(L.EVENT_CLICK_LOGOUT),!b.Type.isNil(c.DesktopApi)&&c.DesktopApi.isDesktop())c.DesktopApi.logout();else{const e=new b.Uri(window.location.pathname);e.removeQueryParam(this.options.removeQueryParam);const t=new b.Uri(this.options.path);t.setQueryParam("sessid",BX.bitrix_sessid()),t.setQueryParam("backurl",encodeURIComponent(e.toString())),document.location.href=t}}getId(){return"logout"}}let Ee,Ce=e=>e;var ye=babelHelpers.classPrivateFieldLooseKey("getTools");class Ie extends P{constructor(...e){super(...e),Object.defineProperty(this,ye,{value:we})}getConfig(){return{html:this.getLayout(),withoutBackground:!0,margin:"0 0 16px 0"}}getLayout(){return this.cache.remember("layout",()=>{const e=b.Tag.render(Ee||(Ee=Ce`
				<div data-testid="bx-avatar-widget-content-footer" class="intranet-avatar-widget-footer__wrapper"/>
			`));return babelHelpers.classPrivateFieldLooseBase(this,ye)[ye]().forEach(t=>{b.Dom.append(t.getLayout(),e)}),e})}}function we(){return this.cache.remember("tools",()=>{const e=this.getOptions().tools;return[e.theme?new Pe(e.theme):null,e.pulse?new Le(e.pulse):null,e.logout?new _e(e.logout):null].filter(Boolean)})}let fe,Be,He,Oe,Te=e=>e;var Fe=babelHelpers.classPrivateFieldLooseKey("getCounterWrapper");class Ae extends _{constructor(...e){super(...e),Object.defineProperty(this,Fe,{value:ke})}getLayout(){return this.cache.remember("layout",()=>b.Tag.render(fe||(fe=Te`
				<div data-testid="bx-avatar-widget-tool-${0}" onclick="${0}" class="intranet-avatar-widget-secondary-tool__wrapper">
					${0}
					<div class="intranet-avatar-widget-item__info-wrapper">
						<span class="intranet-avatar-widget-item__title">
							${0}
						</span>
					</div>
					${0}
					${0}
				</div>
			`),this.getId(),this.onClick.bind(this),this.getIconElement(),this.getTitle(),babelHelpers.classPrivateFieldLooseBase(this,Fe)[Fe](),this.getActionElement()))}getIconElement(){return this.cache.remember("icon",()=>b.Tag.render(Be||(Be=Te`<i class="ui-icon-set ${0} intranet-avatar-widget-secondary-tool__icon"/>`),this.getIconClass()))}getActionElement(){return this.cache.remember("actionElement",()=>b.Tag.render(He||(He=Te`<i class="ui-icon-set --chevron-right-m intranet-avatar-widget-item__chevron"/>`)))}getCounter(){return null}getId(){return""}}function ke(){return this.cache.remember("counterWrapper",()=>{const e=this.getCounter();return b.Tag.render(Oe||(Oe=Te`
				<div class="intranet-avatar-widget-item__counter">
					${0}
				</div>
			`),null==e?void 0:e.render())})}class Se extends Ae{getIconClass(){return"--o-structure-vertical"}onClick(){"desktop"===this.options.type?(L.send(L.EVENT_CLICK_ACTIVITY_PORTAL_LIST),m.EventEmitter.emit("BX.Intranet.AvatarWidget.Popup:openChild"),new d.DesktopAccountList({bindElement:document.querySelector('[data-id="bx-avatar-widget"]')}).show()):"network"===this.options.type&&(L.send(L.EVENT_CLICK_NETWORK),window.open(this.options.path,"_blank"))}getId(){return"account-changer"}}class Ke extends Ae{getIconClass(){return"--o-filter-2-lines"}onClick(){window.open(this.options.path,"_blank")}getId(){return"administration"}}class xe extends Ae{getIconClass(){return"--o-feedback"}onClick(){document.location.href=this.options.path}getId(){return"performance-review"}}let Ne,Me=e=>e;class Xe extends P{getLayout(){return this.cache.remember("layout",()=>{const e=b.Tag.render(Ne||(Ne=Me`
				<div data-testid="bx-avatar-widget-content-${0}" class="intranet-avatar-widget-item__wrapper"></div>
			`),this.getId());return this.getTools().forEach(t=>{b.Dom.append(t.getLayout(),e)}),e})}getTools(){return this.cache.remember("tools",()=>{const e=this.getOptions().tools;return[e.accountChanger?new Se(e.accountChanger):null,e.admin?new Ke(e.admin):null,e.perfReview?new xe(e.perfReview):null].filter(Boolean)})}getId(){return"secondary"}}class $e extends Ae{getIconClass(){return"--o-mobile"}onClick(){L.send(L.EVENT_CLICK_INSTALL_MOBILE_APP),m.EventEmitter.emit("BX.Intranet.AvatarWidget.FastMobileAuthTool:onClick")}}class De extends Ae{getIconClass(){return"--o-qr-code"}onClick(){L.send(L.EVENT_CLICK_FAST_MOBILE_AUTH),m.EventEmitter.emit("BX.Intranet.AvatarWidget.FastMobileAuthTool:onClick")}getId(){return"fast-mobile-auth"}}let We,je,Re,Ve,Ue,Ge=e=>e;var Ye=babelHelpers.classPrivateFieldLooseKey("getMobileIcon"),ze=babelHelpers.classPrivateFieldLooseKey("getDesktopIcon"),Qe=babelHelpers.classPrivateFieldLooseKey("getInstallMenu"),qe=babelHelpers.classPrivateFieldLooseKey("getInstallMenuItems");class Je extends Ae{constructor(...e){super(...e),Object.defineProperty(this,qe,{value:st}),Object.defineProperty(this,Qe,{value:tt}),Object.defineProperty(this,ze,{value:et}),Object.defineProperty(this,Ye,{value:Ze})}getIconElement(){return this.cache.remember("icon",()=>this.options.mobile.installed?b.Tag.render(We||(We=Ge`
					<span class="intranet-avatar-widget-secondary-tool-icons__wrapper">
						${0}
						<div class="intranet-avatar-widget-secondary-tool-icons__seporator"></div>
						${0}
					</span>
				`),babelHelpers.classPrivateFieldLooseBase(this,Ye)[Ye](),babelHelpers.classPrivateFieldLooseBase(this,ze)[ze]()):babelHelpers.classPrivateFieldLooseBase(this,ze)[ze]())}getActionElement(){return this.cache.remember("actionElement",()=>{if(this.options.desktop.installed&&this.options.menu){const e=e=>{babelHelpers.classPrivateFieldLooseBase(this,Qe)[Qe](e.target).toggle()};return b.Tag.render(je||(je=Ge`
					<i onclick="${0}" class="ui-icon-set --more-m intranet-avatar-widget-item__more"/>
				`),e)}const e=new g.Button({tag:g.Button.Tag.LINK,size:g.Button.Size.EXTRA_SMALL,text:this.options.desktop.buttonName,useAirDesign:!0,style:g.AirButtonStyle.FILLED,noCaps:!0,link:this.options.desktop.installLink,wide:!0}).render();return b.Tag.render(Re||(Re=Ge`
				<span class="intranet-avatar-widget-secondary-tool-application__button-wrapper">
					${0}
				</span>
			`),e)})}onClick(){}getId(){return"applications-installer"}}function Ze(){return this.cache.remember("mobileIcon",()=>{let e="ui-icon-set --mobile-selected intranet-avatar-widget-secondary-tool-application__icon";return this.options.mobile.installed&&(e+=" --installed"),b.Tag.render(Ve||(Ve=Ge`
				<i class="${0}"/>
			`),e)})}function et(){return this.cache.remember("desktopIcon",()=>{let e="ui-icon-set intranet-avatar-widget-secondary-tool-application__icon";return this.options.desktop.installed?e+=" --screen-selected --installed":e+=" --o-screen",b.Tag.render(Ue||(Ue=Ge`
				<i class="${0}"/>
			`),e)})}function tt(e){return this.cache.remember("installMenu",()=>{const t=babelHelpers.classPrivateFieldLooseBase(this,qe)[qe]();return 0===t.length?null:new u.Menu({bindElement:e,items:t,offsetLeft:5,angle:!0,fixed:!0})})}function st(){const e=[];return this.options.menu.forEach(t=>{"desktop"===t.type?e.push({text:t.title,href:this.options.desktop.installLink,onclick:()=>{L.send(L.EVENT_CLICK_INSTALL_DESKTOP_APP),babelHelpers.classPrivateFieldLooseBase(this,Qe)[Qe]().close()}}):"mobile"===t.type&&e.push({text:t.title,onclick:()=>{L.send(L.EVENT_CLICK_INSTALL_MOBILE_APP),babelHelpers.classPrivateFieldLooseBase(this,Qe)[Qe]().close(),m.EventEmitter.emit("BX.Intranet.AvatarWidget.ApplicationInstallerTool:onClick")}})}),e}let it,at=e=>e;var rt=babelHelpers.classPrivateFieldLooseKey("getTools");class nt extends P{constructor(...e){super(...e),Object.defineProperty(this,rt,{value:ot})}getLayout(){return this.cache.remember("layout",()=>{const e=b.Tag.render(it||(it=at`
				<div data-testid="bx-avatar-widget-content-application" class="intranet-avatar-widget-item__wrapper"></div>
			`));return babelHelpers.classPrivateFieldLooseBase(this,rt)[rt]().forEach(t=>{b.Dom.append(t.getLayout(),e)}),e})}}function ot(){return this.cache.remember("tools",()=>{const e=this.getOptions().tools;return[e.installMobile?new $e(e.installMobile):null,e.fastMobileAuth?new De(e.fastMobileAuth):null,e.applicationsInstaller?new Je(e.applicationsInstaller):null].filter(Boolean)})}let lt,ct=e=>e;var pt=babelHelpers.classPrivateFieldLooseKey("getBackButton");class dt extends P{constructor(...e){super(...e),Object.defineProperty(this,pt,{value:ut})}getConfig(){return{html:this.getLayout()}}getLayout(){return this.cache.remember("layout",()=>b.Tag.render(lt||(lt=ct`
				<div data-testid="bx-avatar-widget-content-${0}" class="intranet-avatar-widget-item__wrapper">
					<div class="intranet-avatar-widget-item-subsection__header">
						${0}
						<span class="intranet-avatar-widget-item-subsection__title">
							${0}
						</span>
					</div>
					${0}
				</div>
			`),this.getId(),babelHelpers.classPrivateFieldLooseBase(this,pt)[pt]().render(),this.getOptions().title,this.getContentWrapper()))}getId(){return""}}function ut(){return this.cache.remember("backButton",()=>{const e=new g.Button({icon:"chevron-left-l",size:g.Button.Size.EXTRA_EXTRA_SMALL,style:g.AirButtonStyle.OUTLINE,useAirDesign:!0,onclick:()=>{m.EventEmitter.emit("BX.Intranet.AvatarWidget.Subsection:back")}});return e.setCollapsed(!0),e})}let ht,bt,gt=e=>e;var vt=babelHelpers.classPrivateFieldLooseKey("getQR"),mt=babelHelpers.classPrivateFieldLooseKey("getWarning");class Pt extends dt{constructor(...e){super(...e),Object.defineProperty(this,mt,{value:_t}),Object.defineProperty(this,vt,{value:Lt})}getContentWrapper(){return this.cache.remember("content",()=>b.Tag.render(ht||(ht=gt`
				<div class="intranet-avatar-widget-fast-mobile-auth__wrapper">
					${0}
					${0}
				</div>
			`),babelHelpers.classPrivateFieldLooseBase(this,vt)[vt]().render(),babelHelpers.classPrivateFieldLooseBase(this,mt)[mt]()))}getId(){return"mobile-auth"}}function Lt(){return this.cache.remember("qr",()=>new h.ShortQrAuth({intent:"profile",small:!1,stub:!1}))}function _t(){return this.cache.remember("warning",()=>b.Tag.render(bt||(bt=gt`
				<div class="intranet-avatar-widget-fast-mobile-auth-tool__warning">
					${0}
				</div>
			`),this.getOptions().warning))}class Et extends Ae{getIconClass(){return"--o-shield-checked"}onClick(){L.send(L.EVENT_CLICK_2FA_SETUP),v.SidePanel.Instance.open(this.options.url,{width:1100})}getId(){return"security"}}class Ct extends Ae{getIconClass(){return"--o-palette"}onClick(){L.send(L.EVENT_CLICK_CHANGE_PORTAL_THEME),m.EventEmitter.emit("BX.Intranet.AvatarWidget.Popup:openChild"),BX.Intranet.Bitrix24.ThemePicker.Singleton.showDialog(!1)}getId(){return"theme"}}class yt extends Xe{getTools(){return this.cache.remember("tools",()=>{const e=this.getOptions().tools;return[e.security?new Et(e.security):null,e.theme?new Ct(e.theme):null].filter(Boolean)})}getId(){return"extranet-secondary"}}var It=babelHelpers.classPrivateFieldLooseKey("cache"),wt=babelHelpers.classPrivateFieldLooseKey("popupsShowAfterBasePopup"),ft=babelHelpers.classPrivateFieldLooseKey("getContent"),Bt=babelHelpers.classPrivateFieldLooseKey("getMainContent"),Ht=babelHelpers.classPrivateFieldLooseKey("getSecondaryContent"),Ot=babelHelpers.classPrivateFieldLooseKey("getApplicationContent"),Tt=babelHelpers.classPrivateFieldLooseKey("getFooterContent"),Ft=babelHelpers.classPrivateFieldLooseKey("getMobileAuthContent"),At=babelHelpers.classPrivateFieldLooseKey("getFastMobileAuthSubsection"),kt=babelHelpers.classPrivateFieldLooseKey("getExtranetSecondaryContent"),St=babelHelpers.classPrivateFieldLooseKey("setAutoHideEventHandlers"),Kt=babelHelpers.classPrivateFieldLooseKey("setSubsectionEventHandlers");class xt extends m.EventEmitter{constructor(e){super(),Object.defineProperty(this,Kt,{value:Ut}),Object.defineProperty(this,St,{value:Vt}),Object.defineProperty(this,kt,{value:Rt}),Object.defineProperty(this,At,{value:jt}),Object.defineProperty(this,Ft,{value:Wt}),Object.defineProperty(this,Tt,{value:Dt}),Object.defineProperty(this,Ot,{value:$t}),Object.defineProperty(this,Ht,{value:Xt}),Object.defineProperty(this,Bt,{value:Mt}),Object.defineProperty(this,ft,{value:Nt}),Object.defineProperty(this,It,{writable:!0,value:new b.Cache.MemoryCache}),Object.defineProperty(this,wt,{writable:!0,value:[]}),this.setOptions(e),this.setEventNamespace("BX.Intranet.AvatarWidget.Popup"),this.setEventHandlers()}setOptions(e){babelHelpers.classPrivateFieldLooseBase(this,It)[It].set("options",e)}getOptions(){return babelHelpers.classPrivateFieldLooseBase(this,It)[It].get("options",{})}show(){this.getBasePopup().show(),this.emit("show"),L.send(L.EVENT_OPEN_WIDGET)}close(){this.getBasePopup().close()}getBasePopup(){return babelHelpers.classPrivateFieldLooseBase(this,It)[It].remember("popup",()=>{this.emit("beforeInit");const e=new t.PopupComponentsMaker({target:this.getOptions().target,width:390,content:babelHelpers.classPrivateFieldLooseBase(this,ft)[ft](),popupLoader:this.getOptions().loader,padding:0,offsetTop:-50,offsetLeft:0});e.getPopup().setFixed(!0);const s=()=>{BX.SidePanel.Instance.isOpen()&&(e.getPopup().setOverlay({backgroundColor:"transparent"}),e.getPopup().showOverlay())};return s(),e.getPopup().subscribe("onClose",()=>{babelHelpers.classPrivateFieldLooseBase(this,wt)[wt]=[],e.getPopup().removeOverlay()}),e.getPopup().subscribe("onBeforeShow",s),babelHelpers.classPrivateFieldLooseBase(this,It)[It].set("popup",e),babelHelpers.classPrivateFieldLooseBase(this,It)[It].set("contentWrapper",e.getContentWrapper()),this.emit("afterInit"),e})}setEventHandlers(){this.subscribe("beforeInit",()=>{m.EventEmitter.subscribe("BX.Intranet.AvatarWidget.Popup:makeWithHint",()=>{this.subscribe("afterInit",()=>{BX.UI.Hint.init(this.getBasePopup().getPopup().getPopupContainer())})}),this.subscribe("afterInit",()=>{babelHelpers.classPrivateFieldLooseBase(this,St)[St](),babelHelpers.classPrivateFieldLooseBase(this,Kt)[Kt]();const e=()=>{this.close()};m.EventEmitter.subscribe("SidePanel.Slider:onOpenStart",e),m.EventEmitter.subscribe("BX.Intranet.AvatarWidget.Popup:openChild",e)})})}}function Nt(){return babelHelpers.classPrivateFieldLooseBase(this,It)[It].remember("content",()=>{const e=[babelHelpers.classPrivateFieldLooseBase(this,Bt)[Bt]().getConfig()];return e.push(babelHelpers.classPrivateFieldLooseBase(this,Ot)[Ot]().getConfig()),this.getOptions().content.extranetSecondary&&e.push(babelHelpers.classPrivateFieldLooseBase(this,kt)[kt]().getConfig()),this.getOptions().content.secondary&&e.push(babelHelpers.classPrivateFieldLooseBase(this,Ht)[Ht]().getConfig()),e.push(babelHelpers.classPrivateFieldLooseBase(this,Tt)[Tt]().getConfig()),e})}function Mt(){return babelHelpers.classPrivateFieldLooseBase(this,It)[It].remember("mainContent",()=>new ae({...this.getOptions().content.main}))}function Xt(){return babelHelpers.classPrivateFieldLooseBase(this,It)[It].remember("secondaryContent",()=>new Xe({...this.getOptions().content.secondary}))}function $t(){return babelHelpers.classPrivateFieldLooseBase(this,It)[It].remember("applicationContent",()=>new nt({...this.getOptions().content.application}))}function Dt(){return babelHelpers.classPrivateFieldLooseBase(this,It)[It].remember("footerContent",()=>new Ie({...this.getOptions().content.footer}))}function Wt(){return babelHelpers.classPrivateFieldLooseBase(this,It)[It].remember("mobileAuthContent",()=>new Pt({...this.getOptions().content.mobileAuth.tools.fastMobileAuth}))}function jt(){return babelHelpers.classPrivateFieldLooseBase(this,It)[It].remember("fastMobileAuthSubsection",()=>new t.PopupComponentsMaker({content:[babelHelpers.classPrivateFieldLooseBase(this,Ft)[Ft]().getConfig()]}).getContentWrapper())}function Rt(){return babelHelpers.classPrivateFieldLooseBase(this,It)[It].remember("extranetSecondaryContent",()=>new yt({...this.getOptions().content.extranetSecondary}))}function Vt(){m.EventEmitter.subscribe("BX.Main.Popup:onShow",e=>{if(!this.getBasePopup().getPopup().isShown())return;b.Dom.style(this.getBasePopup().getPopup().getPopupContainer(),"overflow-y","hidden");const t=e.getTarget();if(t&&t.getId()===this.getBasePopup().getPopup().getId())this.getBasePopup().getPopup().setAutoHide(!0),m.EventEmitter.emit("BX.Intranet.AvatarWidget.Popup:enabledAutoHide");else{this.getBasePopup().getPopup().setAutoHide(!1),m.EventEmitter.emit("BX.Intranet.AvatarWidget.Popup:disabledAutoHide"),babelHelpers.classPrivateFieldLooseBase(this,wt)[wt].includes(t)||babelHelpers.classPrivateFieldLooseBase(this,wt)[wt].push(t);const e=()=>{babelHelpers.classPrivateFieldLooseBase(this,wt)[wt]=babelHelpers.classPrivateFieldLooseBase(this,wt)[wt].filter(e=>e!==t),0===babelHelpers.classPrivateFieldLooseBase(this,wt)[wt].length&&(this.getBasePopup().getPopup().setAutoHide(!0),b.Dom.style(this.getBasePopup().getPopup().getPopupContainer(),"overflow-y","auto"),m.EventEmitter.emit("BX.Intranet.AvatarWidget.Popup:enabledAutoHide"))};t.subscribeOnce("onClose",e),t.subscribeOnce("onDestroy",e)}})}function Ut(){const e=()=>{const e=babelHelpers.classPrivateFieldLooseBase(this,At)[At]();this.getBasePopup().getPopup().setContent(e)};m.EventEmitter.subscribe("BX.Intranet.AvatarWidget.FastMobileAuthTool:onClick",e),m.EventEmitter.subscribe("BX.Intranet.AvatarWidget.ApplicationInstallerTool:onClick",e),m.EventEmitter.subscribe("BX.Intranet.AvatarWidget.Subsection:back",()=>{this.getBasePopup().getPopup().setContent(this.getBasePopup().getContentWrapper())})}var Gt=babelHelpers.classPrivateFieldLooseKey("cache"),Yt=babelHelpers.classPrivateFieldLooseKey("instance"),zt=babelHelpers.classPrivateFieldLooseKey("getPopup");class Qt{constructor(){Object.defineProperty(this,zt,{value:qt}),Object.defineProperty(this,Gt,{writable:!0,value:new b.Cache.MemoryCache})}static getInstance(){return babelHelpers.classPrivateFieldLooseBase(this,Yt)[Yt]||(babelHelpers.classPrivateFieldLooseBase(this,Yt)[Yt]=new this),babelHelpers.classPrivateFieldLooseBase(this,Yt)[Yt]}show(){babelHelpers.classPrivateFieldLooseBase(this,zt)[zt]().getBasePopup().isShown()||babelHelpers.classPrivateFieldLooseBase(this,zt)[zt]().show()}setOptions(e){return babelHelpers.classPrivateFieldLooseBase(this,Gt)[Gt].set("options",e),this}getOptions(){return babelHelpers.classPrivateFieldLooseBase(this,Gt)[Gt].get("options",{})}}function qt(){return babelHelpers.classPrivateFieldLooseBase(this,Gt)[Gt].remember("popup",()=>new xt({target:this.getOptions().buttonWrapper,loader:this.getOptions().loader,content:{...this.getOptions().data}}))}Object.defineProperty(Qt,Yt,{writable:!0,value:void 0}),e.AvatarWidget=Qt}(this.BX.Intranet=this.BX.Intranet||{},BX.UI,BX.UI,BX.Timeman,BX.UI.Analytics,BX.UI,BX.Crm,BX,BX.HumanResources.HcmLink,BX.Messenger.v2.Lib,BX.UI,BX.Intranet,BX.Main,BX.UI,BX,BX.UI,BX.SidePanel,BX.Event);
//# sourceMappingURL=avatar-widget.bundle.js.map
