{"version":3,"file":"dialog.bundle.js","sources":["../src/checkbox-button.js","../src/blur.js","../src/new-theme-dialog.js","../src/theme-picker-dialog.js"],"sourcesContent":["import { Tag, Loc } from 'main.core';\nimport { PopupWindowButton } from 'main.popup';\nimport { InfoHelper } from 'ui.info-helper';\n\nexport class CheckboxButton extends PopupWindowButton\n{\n\t#themePicker: BX.Intranet.Bitrix24.ThemePicker;\n\t#checkbox: HTMLInputElement;\n\n\tconstructor(themePicker: BX.Intranet.Bitrix24.ThemePicker)\n\t{\n\t\tsuper({ id: 'checkbox' });\n\n\t\tthis.#themePicker = themePicker;\n\t\tthis.#checkbox = Tag.render`\n\t\t\t<input\n\t\t\t\tid=\"theme-dialog-checkbox-input\"\n\t\t\t\tclass=\"theme-dialog-checkbox-input\"\n\t\t\t\ttype=\"checkbox\"\n\t\t\t\tname=\"defaultTheme\"\n\t\t\t\tvalue=\"Y\"\n\t\t\t\tonclick=\"${this.#handleCheckboxClick.bind(this)}\"\n\t\t\t>\n\t\t`;\n\n\t\tthis.buttonNode = Tag.render`\n\t\t\t<div class=\"theme-dialog-checkbox-button\">\n\t\t\t\t${this.#checkbox}\n\t\t\t\t<label for=\"theme-dialog-checkbox-input\" class=\"theme-dialog-checkbox-label\">\n\t\t\t\t\t${Loc.getMessage('BITRIX24_THEME_DEFAULT_THEME_FOR_ALL')}\n\t\t\t\t</label>\n\t\t\t\t${this.#themePicker.canSetDefaultTheme() ? '' : Tag.render`<span class=\"tariff-lock\"></span>`}\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tisChecked(): boolean\n\t{\n\t\treturn this.#checkbox.checked;\n\t}\n\n\tcheck(): void\n\t{\n\t\tthis.#checkbox.checked = true;\n\t}\n\n\tuncheck(): void\n\t{\n\t\tthis.#checkbox.checked = false;\n\t}\n\n\t#handleCheckboxClick(): void\n\t{\n\t\tif (this.#themePicker.canSetDefaultTheme())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tInfoHelper.show('limit_office_background_to_all');\n\n\t\tthis.uncheck();\n\t}\n}\n","import { Type, Browser, Text } from 'main.core';\nimport { Helpers } from 'ui.uploader.core';\n\nexport async function blur(file: File | HTMLImageElement, radius = 7): Promise<{ file: File, color: string }>\n{\n\tconst { image, width, height } = (\n\t\tType.isFile(file)\n\t\t\t? await Helpers.loadImage(file)\n\t\t\t: { image: file, width: file.naturalWidth || file.width, height: file.naturalHeight || file.height }\n\t);\n\n\tconst canvas = document.createElement('canvas');\n\tcanvas.width = width;\n\tcanvas.height = height;\n\tconst ctx = canvas.getContext('2d');\n\n\tif ('filter' in ctx)\n\t{\n\t\tconst padding = Math.ceil(radius) * 2;\n\t\tconst tmpCanvas = document.createElement('canvas');\n\t\tconst tmpContext = tmpCanvas.getContext('2d');\n\n\t\tconst w = image.width;\n\t\tconst h = image.height;\n\n\t\ttmpCanvas.width = w + padding * 2;\n\t\ttmpCanvas.height = h + padding * 2;\n\n\t\ttmpContext.drawImage(image, 0, 0, w, 1, padding, 0, w, padding);\n\t\ttmpContext.drawImage(image, 0, h - 1, w, 1, padding, h + padding, w, padding);\n\t\ttmpContext.drawImage(image, 0, 0, 1, h, 0, padding, padding, h);\n\t\ttmpContext.drawImage(image, w - 1, 0, 1, h, w + padding, padding, padding, h);\n\t\ttmpContext.drawImage(image, 0, 0, 1, 1, 0, 0, padding, padding);\n\t\ttmpContext.drawImage(image, w - 1, 0, 1, 1, w + padding, 0, padding, padding);\n\t\ttmpContext.drawImage(image, 0, h - 1, 1, 1, 0, h + padding, padding, padding);\n\t\ttmpContext.drawImage(image, w - 1, h - 1, 1, 1, w + padding, h + padding, padding, padding);\n\n\t\ttmpContext.drawImage(image, padding, padding);\n\t\ttmpContext.filter = `blur(${radius}px)`;\n\n\t\ttmpContext.drawImage(\n\t\t\ttmpCanvas,\n\t\t\t0,\n\t\t\t0,\n\t\t\ttmpCanvas.width,\n\t\t\ttmpCanvas.height,\n\t\t\t0,\n\t\t\t0,\n\t\t\ttmpCanvas.width,\n\t\t\ttmpCanvas.height,\n\t\t);\n\n\t\tctx.drawImage(tmpCanvas, padding, padding, w, h, 0, 0, w, h);\n\t}\n\telse\n\t{\n\t\tconsole.log('blur manually');\n\t\tctx.drawImage(image, 0, 0);\n\n\t\tconst imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);\n\t\tconst blurredImageData = blurManually(imageData, radius);\n\n\t\tctx.putImageData(blurredImageData, 0, 0);\n\t}\n\n\tconst pixel = ctx.getImageData(0, 0, 10, 10);\n\tconst [r, g, b] = pixel.data;\n\tconst hex = `#${[r, g, b].map((x) => x.toString(16).padStart(2, '0')).join('')}`;\n\n\tconst type = Browser.isSafari() ? 'image/jpeg' : 'image/webp';\n\tconst extension = Browser.isSafari() ? 'jpg' : 'webp';\n\tconst blob = await new Promise((resolve) => {\n\t\tcanvas.toBlob(resolve, type);\n\t});\n\n\tconst fileName = (\n\t\tfile.name\n\t\t\t? `blurred_${Helpers.getFilenameWithoutExtension(file.name)}.${extension}`\n\t\t\t: `blurred_${Text.getRandom()}.${extension}`\n\t);\n\n\treturn {\n\t\tfile: new File([blob], fileName, { type }),\n\t\tcolor: hex,\n\t};\n}\n\nfunction blurManually(imageData: ImageData, radius: number): ImageData\n{\n\tif (radius < 1)\n\t{\n\t\treturn imageData;\n\t}\n\n\tconst data = imageData.data;\n\tconst width = imageData.width;\n\tconst height = imageData.height;\n\n\tconst intRadius = Math.round(radius);\n\tconst boxes = calculateBoxSizes(intRadius, 3);\n\n\tconst tempData = new Uint8ClampedArray(data);\n\tlet currentSrc = data;\n\tlet currentDst = tempData;\n\n\tfor (let i = 0; i < 3; i++)\n\t{\n\t\tconst boxRadius = Math.floor((boxes[i] - 1) / 2);\n\t\tblurSymmetric(currentSrc, currentDst, width, height, boxRadius);\n\t\t[currentSrc, currentDst] = [currentDst, currentSrc];\n\t}\n\n\tif (currentSrc !== data)\n\t{\n\t\tdata.set(currentSrc);\n\t}\n\n\treturn imageData;\n}\n\nfunction blurSymmetric(\n\tsrcData: Uint8ClampedArray,\n\tdstData: Uint8ClampedArray,\n\twidth: number,\n\theight: number,\n\tradius: number,\n)\n{\n\tconst tempData = new Uint8ClampedArray(srcData.length);\n\tblurHorizontal(srcData, tempData, width, height, radius);\n\tblurVertical(tempData, dstData, width, height, radius);\n}\n\nfunction calculateBoxSizes(sigma, n): number[]\n{\n\tconst wIdeal = Math.sqrt((12 * sigma * sigma / n) + 1);\n\tlet wl = Math.floor(wIdeal);\n\tif (wl % 2 === 0)\n\t{\n\t\twl--;\n\t}\n\n\tconst wu = wl + 2;\n\n\tconst mIdeal = (12 * sigma * sigma - n * wl * wl - 4 * n * wl - 3 * n) / (-4 * wl - 4);\n\tconst m = Math.round(mIdeal);\n\n\tconst sizes = [];\n\tfor (let i = 0; i < n; i++)\n\t{\n\t\tsizes.push(i < m ? wl : wu);\n\t}\n\n\treturn sizes;\n}\n\nfunction blurHorizontal(\n\tsrcData: Uint8ClampedArray,\n\tdstData: Uint8ClampedArray,\n\twidth: number,\n\theight: number,\n\tradius: number,\n)\n{\n\tif (radius === 0)\n\t{\n\t\tdstData.set(srcData);\n\n\t\treturn;\n\t}\n\n\tconst kernelSize = radius * 2 + 1;\n\tconst iarr = 1 / kernelSize;\n\n\tfor (let y = 0; y < height; y++)\n\t{\n\t\tconst rowStart = y * width * 4;\n\t\tlet r = 0;\n\t\tlet g = 0;\n\t\tlet b = 0;\n\t\tlet a = 0;\n\n\t\tfor (let j = -radius; j <= radius; j++)\n\t\t{\n\t\t\tconst x = Math.max(0, Math.min(width - 1, j));\n\t\t\tconst offset = rowStart + x * 4;\n\t\t\tr += srcData[offset];\n\t\t\tg += srcData[offset + 1];\n\t\t\tb += srcData[offset + 2];\n\t\t\ta += srcData[offset + 3];\n\t\t}\n\n\t\tlet dstOffset = rowStart;\n\t\tdstData[dstOffset] = Math.round(r * iarr);\n\t\tdstData[dstOffset + 1] = Math.round(g * iarr);\n\t\tdstData[dstOffset + 2] = Math.round(b * iarr);\n\t\tdstData[dstOffset + 3] = Math.round(a * iarr);\n\n\t\tfor (let x = 1; x < width; x++)\n\t\t{\n\t\t\tconst leftX = Math.max(0, Math.min(width - 1, x - radius - 1));\n\t\t\tconst leftOffset = rowStart + leftX * 4;\n\t\t\tr -= srcData[leftOffset];\n\t\t\tg -= srcData[leftOffset + 1];\n\t\t\tb -= srcData[leftOffset + 2];\n\t\t\ta -= srcData[leftOffset + 3];\n\n\t\t\tconst rightX = Math.max(0, Math.min(width - 1, x + radius));\n\t\t\tconst rightOffset = rowStart + rightX * 4;\n\t\t\tr += srcData[rightOffset];\n\t\t\tg += srcData[rightOffset + 1];\n\t\t\tb += srcData[rightOffset + 2];\n\t\t\ta += srcData[rightOffset + 3];\n\n\t\t\tdstOffset = rowStart + x * 4;\n\t\t\tdstData[dstOffset] = Math.round(r * iarr);\n\t\t\tdstData[dstOffset + 1] = Math.round(g * iarr);\n\t\t\tdstData[dstOffset + 2] = Math.round(b * iarr);\n\t\t\tdstData[dstOffset + 3] = Math.round(a * iarr);\n\t\t}\n\t}\n}\n\nfunction blurVertical(\n\tsrcData: Uint8ClampedArray,\n\tdstData: Uint8ClampedArray,\n\twidth: number,\n\theight: number,\n\tradius: number,\n)\n{\n\tif (radius === 0)\n\t{\n\t\tdstData.set(srcData);\n\n\t\treturn;\n\t}\n\n\tconst kernelSize = radius * 2 + 1;\n\tconst iarr = 1 / kernelSize;\n\tconst widthBytes = width * 4;\n\n\tfor (let x = 0; x < width; x++)\n\t{\n\t\tconst colStart = x * 4;\n\n\t\tlet r = 0;\n\t\tlet g = 0;\n\t\tlet b = 0;\n\t\tlet a = 0;\n\n\t\tfor (let j = -radius; j <= radius; j++)\n\t\t{\n\t\t\tconst y = Math.max(0, Math.min(height - 1, j));\n\t\t\tconst offset = y * widthBytes + colStart;\n\t\t\tr += srcData[offset];\n\t\t\tg += srcData[offset + 1];\n\t\t\tb += srcData[offset + 2];\n\t\t\ta += srcData[offset + 3];\n\t\t}\n\n\t\tlet dstOffset = colStart;\n\t\tdstData[dstOffset] = Math.round(r * iarr);\n\t\tdstData[dstOffset + 1] = Math.round(g * iarr);\n\t\tdstData[dstOffset + 2] = Math.round(b * iarr);\n\t\tdstData[dstOffset + 3] = Math.round(a * iarr);\n\n\t\tfor (let y = 1; y < height; y++)\n\t\t{\n\t\t\tconst topY = Math.max(0, Math.min(height - 1, y - radius - 1));\n\t\t\tconst topOffset = topY * widthBytes + colStart;\n\t\t\tr -= srcData[topOffset];\n\t\t\tg -= srcData[topOffset + 1];\n\t\t\tb -= srcData[topOffset + 2];\n\t\t\ta -= srcData[topOffset + 3];\n\n\t\t\tconst bottomY = Math.max(0, Math.min(height - 1, y + radius));\n\t\t\tconst bottomOffset = bottomY * widthBytes + colStart;\n\t\t\tr += srcData[bottomOffset];\n\t\t\tg += srcData[bottomOffset + 1];\n\t\t\tb += srcData[bottomOffset + 2];\n\t\t\ta += srcData[bottomOffset + 3];\n\n\t\t\tdstOffset = y * widthBytes + colStart;\n\t\t\tdstData[dstOffset] = Math.round(r * iarr);\n\t\t\tdstData[dstOffset + 1] = Math.round(g * iarr);\n\t\t\tdstData[dstOffset + 2] = Math.round(b * iarr);\n\t\t\tdstData[dstOffset + 3] = Math.round(a * iarr);\n\t\t}\n\t}\n}\n","import { Type, ajax as Ajax, Loc, Tag, Dom, Reflection } from 'main.core';\nimport { MemoryCache, type BaseCache } from 'main.core.cache';\nimport { EventEmitter, type BaseEvent } from 'main.core.events';\nimport { PopupWindowButton, PopupWindowButtonLink, Popup } from 'main.popup';\nimport { Uploader, UploaderEvent, type UploaderError, type UploaderFile } from 'ui.uploader.core';\nimport { Loader } from 'main.loader';\n\nimport { ThemePickerDialog } from './theme-picker-dialog';\nimport { blur } from './blur';\n\nimport { type ThemePicker } from 'intranet.theme-picker';\n\nexport class NewThemeDialog extends EventEmitter\n{\n\t#themePicker: ThemePicker;\n\t#listDialog: ThemePickerDialog;\n\t#colorPicker: Object = null;\n\t#popup: Popup = null;\n\t#previewApplied: boolean = false;\n\t#origAppliedThemeId: string = null;\n\t#uploader: Uploader | null = null;\n\t#refs: BaseCache<HTMLElement> = new MemoryCache();\n\t#previewLoader: Loader | null = null;\n\n\tconstructor(themePicker: ThemePicker, listDialog: ThemePickerDialog)\n\t{\n\t\tsuper();\n\n\t\tthis.setEventNamespace('BX.Intranet.Bitrix24.ThemePicker.NewThemeDialog');\n\n\t\tthis.#themePicker = themePicker;\n\t\tthis.#listDialog = listDialog;\n\t}\n\n\tshow(): void\n\t{\n\t\tthis.#getPopup().setContent(this.#getContent());\n\t\tthis.#getPopup().show();\n\t\tthis.#themePicker.disableThemeListDialog();\n\t}\n\n\tdestroy(): void\n\t{\n\t\tthis.#resetResources();\n\t\tthis.#getPopup().destroy();\n\t\tthis.#popup = null;\n\t\tthis.#refs = null;\n\t}\n\n\tgetUploader(): Uploader\n\t{\n\t\tthis.#uploader ??= new Uploader({\n\t\t\tmultiple: false,\n\t\t\tacceptOnlyImages: true,\n\t\t\tallowReplaceSingle: true,\n\t\t\timagePreviewWidth: 1920,\n\t\t\timagePreviewHeight: 1080,\n\t\t\t// imagePreviewWidth: 4096,\n\t\t\t// imagePreviewHeight: 2160,\n\t\t\timagePreviewMimeType: 'image/webp',\n\t\t\timagePreviewMimeTypeMode: 'force',\n\t\t\timagePreviewQuality: 0.85,\n\t\t\timageMinWidth: 300,\n\t\t\timageMinHeight: 200,\n\t\t\timageMaxWidth: 10000,\n\t\t\timageMaxHeight: 10000,\n\t\t\timageMaxFileSize: 20 * 1024 * 1024,\n\t\t\tevents: {\n\t\t\t\t[UploaderEvent.FILE_LOAD_START]: () => {\n\t\t\t\t\tthis.#hidePreview();\n\t\t\t\t\tthis.#previewLoader = new Loader({ size: 40 });\n\t\t\t\t\tthis.#previewLoader.show(this.#getControl('field-file-preview'));\n\t\t\t\t},\n\t\t\t\t[UploaderEvent.FILE_ERROR]: (event: BaseEvent<{ error: UploaderError }>) => {\n\t\t\t\t\tconst error: UploaderError = event.getData().error;\n\t\t\t\t\tthis.#showError(`${error.getMessage()}<br>${error.getDescription()}`);\n\t\t\t\t\tthis.#previewLoader?.destroy();\n\t\t\t\t\tthis.#previewLoader = null;\n\t\t\t\t},\n\t\t\t\t[UploaderEvent.FILE_COMPLETE]: async (event: BaseEvent<{ file: UploaderFile }>) => {\n\t\t\t\t\tthis.#hideError();\n\t\t\t\t\tconst file: UploaderFile = event.getData().file;\n\t\t\t\t\tconst preview = file.getClientPreview();\n\n\t\t\t\t\t// console.time('blur');\n\t\t\t\t\tconst { file: bgImageBlurred, color } = await blur(preview, 7);\n\t\t\t\t\t// console.timeEnd('blur');\n\n\t\t\t\t\tconst bgImageBlurredUrl = URL.createObjectURL(bgImageBlurred);\n\n\t\t\t\t\tfile.setCustomData('bgImageBlurred', bgImageBlurred);\n\t\t\t\t\tfile.setCustomData('bgImageBlurredUrl', bgImageBlurredUrl);\n\n\t\t\t\t\tthis.#previewLoader?.destroy();\n\t\t\t\t\tthis.#previewLoader = null;\n\n\t\t\t\t\tthis.#setBgColor(color);\n\t\t\t\t\tthis.#setTextColor(this.#chooseTextColor(color));\n\t\t\t\t\tthis.#showPreview(this.#getBgImageUrl());\n\t\t\t\t\tthis.#applyThemePreview();\n\t\t\t\t},\n\t\t\t},\n\t\t});\n\n\t\treturn this.#uploader;\n\t}\n\n\t#resetResources(): void\n\t{\n\t\tif (this.#getBgImageBlurredUrl() !== null)\n\t\t{\n\t\t\tURL.revokeObjectURL(this.#getBgImageBlurredUrl());\n\t\t}\n\n\t\tthis.#uploader?.destroy();\n\t\tthis.#uploader = null;\n\n\t\tif (this.#previewApplied)\n\t\t{\n\t\t\tthis.#listDialog.applyTheme(this.#origAppliedThemeId);\n\t\t}\n\n\t\tthis.#removeThemePreview();\n\n\t\tthis.#themePicker.enableThemeListDialog();\n\t}\n\n\t#getBgImage(): UploaderFile | null\n\t{\n\t\treturn this.getUploader().getFiles()[0] || null;\n\t}\n\n\t#getBgImageUrl(): string | null\n\t{\n\t\treturn this.#getBgImage()?.getPreviewUrl() || null;\n\t}\n\n\t#getBgImageBlurred(): File | null\n\t{\n\t\treturn this.#getBgImage()?.getCustomData('bgImageBlurred') || null;\n\t}\n\n\t#getBgImageBlurredUrl(): string | null\n\t{\n\t\treturn this.#getBgImage()?.getCustomData('bgImageBlurredUrl') || null;\n\t}\n\n\t#getBgColor(): string\n\t{\n\t\tconst color = this.#getControl('field-bg-color').value;\n\n\t\treturn this.#validateBgColor(color) ? color : null;\n\t}\n\n\t#getTextColor(): string\n\t{\n\t\treturn this.#getControl('field-text-color').value;\n\t}\n\n\t#getControl(name: string): HTMLElement\n\t{\n\t\treturn this.#getPopup().getContentContainer().querySelector(`.theme-dialog-${name}`);\n\t}\n\n\t#getControls(name: string): NodeList\n\t{\n\t\treturn this.#getPopup().getContentContainer().querySelectorAll(`.theme-dialog-${name}`);\n\t}\n\n\t#getPopup(): Popup\n\t{\n\t\tif (this.#popup)\n\t\t{\n\t\t\treturn this.#popup;\n\t\t}\n\n\t\tthis.#popup = new Popup({\n\t\t\twidth: 500,\n\t\t\theight: 560,\n\t\t\tfixed: true,\n\t\t\ttitleBar: Loc.getMessage('BITRIX24_THEME_CREATE_YOUR_OWN_THEME'),\n\t\t\tcloseByEsc: true,\n\t\t\tbindOnResize: false,\n\t\t\tcloseIcon: true,\n\t\t\tdraggable: true,\n\t\t\tcacheable: false,\n\t\t\tevents: {\n\t\t\t\tonClose: () => {\n\t\t\t\t\tthis.#resetResources();\n\t\t\t\t},\n\t\t\t\tonDestroy: () => {\n\t\t\t\t\tthis.emit('onDestroy');\n\t\t\t\t},\n\t\t\t},\n\t\t\tbuttons: [\n\t\t\t\tnew PopupWindowButton({\n\t\t\t\t\tid: 'theme-dialog-create-button',\n\t\t\t\t\ttext: Loc.getMessage('BITRIX24_THEME_DIALOG_CREATE_BUTTON'),\n\t\t\t\t\tclassName: 'popup-window-button-accept',\n\t\t\t\t\tevents: {\n\t\t\t\t\t\tclick: this.#handleCreateButtonClick.bind(this),\n\t\t\t\t\t},\n\t\t\t\t}),\n\t\t\t\tnew PopupWindowButtonLink({\n\t\t\t\t\ttext: Loc.getMessage('BITRIX24_THEME_DIALOG_CANCEL_BUTTON'),\n\t\t\t\t\tclassName: 'popup-window-button-link theme-dialog-button-link',\n\t\t\t\t\tevents: {\n\t\t\t\t\t\tclick: () => {\n\t\t\t\t\t\t\tthis.#popup.close();\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t}),\n\t\t\t],\n\t\t});\n\n\t\treturn this.#popup;\n\t}\n\n\t#getColorPicker(): ?Object\n\t{\n\t\tif (this.#colorPicker)\n\t\t{\n\t\t\treturn this.#colorPicker;\n\t\t}\n\n\t\tconst ColorPicker = Reflection.getClass('BX.ColorPicker');\n\n\t\tif (ColorPicker)\n\t\t{\n\t\t\tthis.#colorPicker = new ColorPicker({\n\t\t\t\tonColorSelected: this.#handleBgColorSelect.bind(this),\n\t\t\t\tpopupOptions: {\n\t\t\t\t\tfixed: true,\n\t\t\t\t},\n\t\t\t});\n\t\t}\n\n\t\treturn this.#colorPicker;\n\t}\n\n\t#handleCreateButtonClick(): void\n\t{\n\t\tconst error = this.#validateForm();\n\t\tif (error !== null)\n\t\t{\n\t\t\tthis.#showError(error);\n\n\t\t\treturn;\n\t\t}\n\n\t\tconst createButton = this.#getPopup().getButton('theme-dialog-create-button');\n\t\tif (Dom.hasClass(createButton.getContainer(), 'popup-window-button-wait'))\n\t\t{\n\t\t\t// double click protection\n\t\t\treturn;\n\t\t}\n\n\t\tconst data = new FormData();\n\t\tdata.append('bgImage', this.#getBgImage() ? this.#getBgImage().getClientPreview() : '');\n\t\tdata.append('bgImageBlurred', this.#getBgImageBlurred() || '');\n\t\tdata.append('bgColor', this.#getBgColor() || '');\n\t\tdata.append('textColor', this.#getTextColor() || '');\n\t\tdata.append('action', 'create');\n\t\tdata.append('sessid', Loc.getMessage('bitrix_sessid'));\n\t\tdata.append('siteId', this.#themePicker.getSiteId());\n\t\tdata.append('templateId', this.#themePicker.getTemplateId());\n\n\t\tlet postSize = 0;\n\t\tfor (const [key, value] of data.entries())\n\t\t{\n\t\t\tpostSize += key.length;\n\t\t\tpostSize += value instanceof Blob ? value.size : value.length;\n\t\t}\n\n\t\tif (postSize > this.#themePicker.getMaxUploadSize())\n\t\t{\n\t\t\tconst limit = this.#themePicker.getMaxUploadSize() / 1024 / 1024;\n\n\t\t\tthis.#showError(Loc.getMessage(\n\t\t\t\t'BITRIX24_THEME_FILE_SIZE_EXCEEDED',\n\t\t\t\t{ '#LIMIT#': `${limit.toFixed(0)}Mb` },\n\t\t\t));\n\n\t\t\treturn;\n\t\t}\n\n\t\tconst form = document.forms['theme-new-theme-form'];\n\n\t\tcreateButton.addClassName('popup-window-button-wait');\n\t\tDom.addClass(form, 'theme-dialog-form-disabled');\n\n\t\tAjax({\n\t\t\turl: this.#themePicker.getAjaxHandlerPath(),\n\t\t\tmethod: 'POST',\n\t\t\tdataType: 'json',\n\t\t\tpreparePost: false,\n\t\t\tdata,\n\t\t\tonsuccess: (response) => {\n\t\t\t\tif (response && response.success && response.theme)\n\t\t\t\t{\n\t\t\t\t\tthis.#listDialog.addItem(response.theme);\n\t\t\t\t\tthis.#listDialog.preloadTheme(response.theme.id, () => {\n\t\t\t\t\t\tcreateButton.removeClassName('popup-window-button-wait');\n\t\t\t\t\t\tDom.removeClass(form, 'theme-dialog-form-disabled');\n\n\t\t\t\t\t\tthis.#removeThemePreview();\n\t\t\t\t\t\tthis.#getPopup().close();\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tcreateButton.removeClassName('popup-window-button-wait');\n\t\t\t\t\tDom.removeClass(form, 'theme-dialog-form-disabled');\n\t\t\t\t\tthis.#showError(response.error || Loc.getMessage('BITRIX24_THEME_UNKNOWN_ERROR'));\n\t\t\t\t}\n\t\t\t},\n\t\t\tonfailure: () => {\n\t\t\t\tcreateButton.removeClassName('popup-window-button-wait');\n\t\t\t\tDom.removeClass(form, 'theme-dialog-form-disabled');\n\t\t\t\tthis.#showError(Loc.getMessage('BITRIX24_THEME_UNKNOWN_ERROR'));\n\t\t\t},\n\t\t});\n\t}\n\n\t#getContent(): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<form name=\"theme-new-theme-form\" method=\"post\" onsubmit=\"${(event) => event.preventDefault()}\">\n\t\t\t\t<div class=\"theme-dialog-form-alert\">\n\t\t\t\t\t<div class=\"theme-dialog-form-alert-content\"></div>\n\t\t\t\t\t<div\n\t\t\t\t\t\tclass=\"theme-dialog-form-alert-remove\"\n\t\t\t\t\t\tonclick=\"${this.#hideError.bind(this)}\"\n\t\t\t\t\t></div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"theme-dialog-form\">\n\t\t\t\t\t${this.#createField(Loc.getMessage('BITRIX24_THEME_THEME_BG_IMAGE'), this.#getBgImageField())}\n\t\t\t\t\t${this.#createField(Loc.getMessage('BITRIX24_THEME_THEME_BG_COLOR'), this.#getBgColorField())}\n\t\t\t\t\t${this.#createField(Loc.getMessage('BITRIX24_THEME_THEME_TEXT_COLOR'), this.#getTextColorField())}\n\t\t\t\t</div>\n\t\t\t</form>\n\t\t`;\n\t}\n\n\t#showError(error: string): void\n\t{\n\t\tDom.addClass(this.#getControl('form-alert'), 'theme-dialog-form-alert-show');\n\t\tthis.#getControl('form-alert-content').innerHTML = error;\n\t}\n\n\t#hideError(): void\n\t{\n\t\tDom.removeClass(this.#getControl('form-alert'), 'theme-dialog-form-alert-show');\n\t}\n\n\t#createField(title: string, field: HTMLElement): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"theme-dialog-field\">\n\t\t\t\t<div class=\"theme-dialog-field-label\">${title}</div>\n\t\t\t\t<div class=\"theme-dialog-field-value\">${field}</div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\t#getBgColorField(): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"theme-dialog-field-textbox-wrapper\" onclick=\"${this.#handleBgColorClick.bind(this)}\">\n\t\t\t\t<div class=\"theme-dialog-field-textbox-color\"></div>\n\t\t\t\t<input\n\t\t\t\t\ttype=\"text\"\n\t\t\t\t\tplaceholder=\"\"\n\t\t\t\t\tname=\"bgColor\"\n\t\t\t\t\tmaxlength=\"7\"\n\t\t\t\t\tclass=\"theme-dialog-field-textbox theme-dialog-field-bg-color\"\n\t\t\t\t\toninput=\"${this.#handleBgColorChange.bind(this)}\"\n\t\t\t\t\tautocomplete=\"off\"\n\t\t\t\t>\n\t\t\t\t<div\n\t\t\t\t\tclass=\"theme-dialog-field-textbox-remove\"\n\t\t\t\t\tonclick=\"${this.#handleBgColorClear.bind(this)}\"\n\t\t\t\t></div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\t#getBgImageField(): HTMLElement\n\t{\n\t\treturn this.#refs.remember('image-field', () => {\n\t\t\tconst imageField = Tag.render`\n\t\t\t\t<div class=\"theme-dialog-field-file\">\n\t\t\t\t\t<div\n\t\t\t\t\t\tclass=\"theme-dialog-field-button\"\n\t\t\t\t\t\tondragenter=\"${this.#handleBgImageEnter.bind(this)}\"\n\t\t\t\t\t\tondragleave=\"${this.#handleBgImageLeave.bind(this)}\"\n\t\t\t\t\t\tondragover=\"${this.#handleBgImageOver.bind(this)}\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<div class=\"theme-dialog-field-file-preview\"></div>\n\t\t\t\t\t\t<div class=\"theme-dialog-field-file-text\">\n\t\t\t\t\t\t\t<span class=\"theme-dialog-field-file-add\">\n\t\t\t\t\t\t\t\t${Loc.getMessage('BITRIX24_THEME_UPLOAD_BG_IMAGE')}\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t<span class=\"theme-dialog-field-file-add-info\">\n\t\t\t\t\t\t\t\t${Loc.getMessage('BITRIX24_THEME_DRAG_BG_IMAGE')}\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t`;\n\n\t\t\tthis.getUploader().assignBrowse(imageField);\n\t\t\tthis.getUploader().assignDropzone(imageField);\n\n\t\t\treturn imageField;\n\t\t});\n\t}\n\n\t#validateForm(): ?string\n\t{\n\t\tconst bgImage = this.#getBgImage();\n\t\tconst bgColor = this.#getControl('field-bg-color').value;\n\n\t\tif (Type.isStringFilled(bgColor) && !this.#validateBgColor(bgColor))\n\t\t{\n\t\t\treturn Loc.getMessage('BITRIX24_THEME_WRONG_BG_COLOR');\n\t\t}\n\n\t\tif (!bgImage && !Type.isStringFilled(bgColor))\n\t\t{\n\t\t\treturn Loc.getMessage('BITRIX24_THEME_EMPTY_FORM_DATA');\n\t\t}\n\n\t\tif (bgImage && bgImage.isFailed())\n\t\t{\n\t\t\treturn `${bgImage.getError().getMessage()}<br>${bgImage.getError().getDescription()}`;\n\t\t}\n\n\t\treturn null;\n\t}\n\n\t#validateBgColor(color: string): boolean\n\t{\n\t\treturn Type.isStringFilled(color) && color.match(/^#([\\dA-Fa-f]{6})$/);\n\t}\n\n\t#showPreview(previewUrl: string): void\n\t{\n\t\tconst preview = this.#getControl('field-file-preview');\n\t\tDom.style(preview, 'background-image', `url(\"${encodeURI(previewUrl)}\")`);\n\t}\n\n\t#hidePreview(): void\n\t{\n\t\tconst preview = this.#getControl('field-file-preview');\n\t\tDom.style(preview, 'background-image', null);\n\t}\n\n\t#handleBgImageEnter(event: DragEvent): void\n\t{\n\t\tDom.addClass(this.#getControl('field-button'), 'theme-dialog-field-button-hover');\n\t\tevent.stopPropagation();\n\t\tevent.preventDefault();\n\t}\n\n\t#handleBgImageLeave(event: DragEvent): void\n\t{\n\t\tDom.removeClass(this.#getControl('field-button'), 'theme-dialog-field-button-hover');\n\n\t\tevent.stopPropagation();\n\t\tevent.preventDefault();\n\t}\n\n\t#handleBgImageOver(event: DragEvent): void\n\t{\n\t\tevent.stopPropagation();\n\t\tevent.preventDefault();\n\t}\n\n\t#handleBgColorClick(): void\n\t{\n\t\tthis.#getColorPicker().open({\n\t\t\tbindElement: this.#getControl('field-bg-color'),\n\t\t});\n\t}\n\n\t#handleBgColorChange(): void\n\t{\n\t\tif (this.#getBgColor())\n\t\t{\n\t\t\tthis.#hideError();\n\t\t}\n\n\t\tthis.#applyThemePreview();\n\t}\n\n\t#handleBgColorClear(event: MouseEvent): void\n\t{\n\t\tthis.#getColorPicker().close();\n\n\t\tDom.removeClass(this.#getControl('field-bg-color'), 'theme-dialog-field-textbox-not-empty');\n\t\tthis.#getControl('field-bg-color').value = '';\n\t\tDom.style(this.#getControl('field-textbox-color'), 'backgroundColor', null);\n\n\t\tthis.#applyThemePreview();\n\n\t\tevent.stopPropagation();\n\t}\n\n\t#handleBgColorSelect(color: string): void\n\t{\n\t\tthis.#setBgColor(color);\n\t\tthis.#hideError();\n\t\tthis.#applyThemePreview();\n\t}\n\n\t#setBgColor(color: string): void\n\t{\n\t\tthis.#getControl('field-bg-color').value = color;\n\t\tDom.addClass(this.#getControl('field-bg-color'), 'theme-dialog-field-textbox-not-empty');\n\t\tDom.style(this.#getControl('field-textbox-color'), 'backgroundColor', color);\n\t}\n\n\t#setTextColor(color: 'light' | 'dark'): void\n\t{\n\t\tconst switchers = this.#getControls('field-button-switcher-item');\n\n\t\t[].forEach.call(switchers, (switcher) => {\n\t\t\tif (switcher.dataset.textColor === color)\n\t\t\t{\n\t\t\t\tDom.addClass(switcher, 'theme-dialog-field-button-switcher-item-pressed');\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tDom.removeClass(switcher, 'theme-dialog-field-button-switcher-item-pressed');\n\t\t\t}\n\t\t});\n\n\t\tthis.#getControl('field-text-color').value = color;\n\t}\n\n\t#getTextColorField(): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"theme-dialog-field-button-switcher\">\n\t\t\t\t<div\n\t\t\t\t\tclass=\"theme-dialog-field-button-switcher-item theme-dialog-field-button-switcher-item-left theme-dialog-field-button-switcher-item-pressed\"\n\t\t\t\t\tdata-text-color=\"light\"\n\t\t\t\t\tonclick=\"${this.#handleSwitcherClick.bind(this)}\"\n\t\t\t\t>\n\t\t\t\t\t${Loc.getMessage('BITRIX24_THEME_THEME_LIGHT_COLOR')}\n\t\t\t\t</div>\n\t\t\t\t<div\n\t\t\t\t\tclass=\"theme-dialog-field-button-switcher-item theme-dialog-field-button-switcher-item-right\"\n\t\t\t\t\tdata-text-color=\"dark\"\n\t\t\t\t\tonclick=\"${this.#handleSwitcherClick.bind(this)}\"\n\t\t\t\t>\n\t\t\t\t\t${Loc.getMessage('BITRIX24_THEME_THEME_DARK_COLOR')}\n\t\t\t\t</div>\n\t\t\t\t<input\n\t\t\t\t\ttype=\"hidden\"\n\t\t\t\t\tname=\"textColor\"\n\t\t\t\t\tvalue=\"light\"\n\t\t\t\t\tclass=\"theme-dialog-field-text-color\"\n\t\t\t\t>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\t#handleSwitcherClick(event: MouseEvent): void\n\t{\n\t\tconst color = event.target.dataset.textColor;\n\t\tthis.#setTextColor(color);\n\t\tthis.#applyThemePreview();\n\t}\n\n\t#applyThemePreview(): void\n\t{\n\t\tif (this.#getBgImage() === null && this.#getBgColor() === null)\n\t\t{\n\t\t\tif (this.#previewApplied)\n\t\t\t{\n\t\t\t\tthis.#listDialog.applyTheme(this.#origAppliedThemeId);\n\t\t\t}\n\n\t\t\treturn;\n\t\t}\n\n\t\tconst baseThemes = this.#themePicker.getBaseThemes();\n\t\tconst baseThemeId = this.#getTextColor();\n\t\tif (!baseThemes[baseThemeId] || !Type.isArray(baseThemes[baseThemeId].css))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tlet style = ':root { ';\n\n\t\tif (this.#getBgImageUrl() !== null)\n\t\t{\n\t\t\tstyle += '--air-theme-bg-size: cover;';\n\t\t\tstyle += '--air-theme-bg-repeat: no-repeat;';\n\t\t\tstyle += '--air-theme-bg-position: 0 0;';\n\t\t\tstyle += '--air-theme-bg-attachment: fixed;';\n\t\t\tstyle += `--air-theme-bg-image: url(\"${encodeURI(this.#getBgImageUrl())}\");`;\n\n\t\t\tif (this.#getBgImageBlurredUrl() !== null)\n\t\t\t{\n\t\t\t\tstyle += `--air-theme-bg-image-blurred: url(\"${encodeURI(this.#getBgImageBlurredUrl())}\");`;\n\t\t\t}\n\t\t}\n\n\t\tif (this.#getBgColor())\n\t\t{\n\t\t\tstyle += `--air-theme-bg-color: ${this.#getBgColor()}; `;\n\t\t}\n\n\t\tstyle += ' }';\n\n\t\tif (!this.#previewApplied)\n\t\t{\n\t\t\tthis.#origAppliedThemeId = this.#themePicker.getAppliedThemeId();\n\t\t}\n\n\t\tthis.#listDialog.removeThemeAssets(this.#themePicker.getAppliedThemeId());\n\n\t\tthis.#listDialog.applyThemeAssets({\n\t\t\tid: this.#getPreviewThemeId(),\n\t\t\tcss: baseThemes[baseThemeId].css,\n\t\t\tstyle,\n\t\t});\n\n\t\tthis.#themePicker.setAppliedThemeId(this.#getPreviewThemeId());\n\n\t\tthis.#previewApplied = true;\n\t}\n\n\t#removeThemePreview(): void\n\t{\n\t\tthis.#listDialog.removeThemeAssets(this.#getPreviewThemeId());\n\t\tthis.#previewApplied = false;\n\t}\n\n\t#getPreviewThemeId(): string\n\t{\n\t\treturn `${this.#getTextColor()}:custom_live_preview`;\n\t}\n\n\t#chooseTextColor(color: string): 'light' | 'dark'\n\t{\n\t\tlet hexColor = color.replace(/^#/, '');\n\t\tif (hexColor.length === 3)\n\t\t{\n\t\t\thexColor = [...hexColor].map((c) => c + c).join('');\n\t\t}\n\n\t\tconst r = parseInt(hexColor.slice(0, 2), 16);\n\t\tconst g = parseInt(hexColor.slice(2, 4), 16);\n\t\tconst b = parseInt(hexColor.slice(4, 6), 16);\n\n\t\tconst brightness = (r * 299 + g * 587 + b * 114) / 1000;\n\n\t\treturn brightness > 186 ? 'dark' : 'light';\n\t}\n}\n","import { Type, ajax as Ajax, Loc, Tag, Dom, Reflection, Uri } from 'main.core';\nimport { EventEmitter, BaseEvent } from 'main.core.events';\nimport { PopupWindowButton, PopupWindowButtonLink } from 'main.popup';\nimport { Loader } from 'main.loader';\n\nimport { CheckboxButton } from './checkbox-button';\nimport { NewThemeDialog } from './new-theme-dialog';\n\nimport { blur } from './blur';\n\nimport { type ThemePicker } from 'intranet.theme-picker';\n\nexport class ThemePickerDialog\n{\n\t#themePicker: ThemePicker;\n\t#newThemeDialog: NewThemeDialog = null;\n\t#checkboxButton: CheckboxButton = null;\n\n\tconstructor(themePicker: ThemePicker)\n\t{\n\t\tthis.#themePicker = themePicker;\n\t}\n\n\tshow(): void\n\t{\n\t\tthis.#loadThemes();\n\t}\n\n\tclose(): void\n\t{\n\t\tthis.#newThemeDialog?.destroy();\n\t\tthis.#newThemeDialog = null;\n\n\t\tif (!this.#themePicker.needReturnValue())\n\t\t{\n\t\t\tthis.applyTheme(this.#themePicker.getThemeId());\n\t\t}\n\n\t\tthis.#themePicker.setThemes([]);\n\t}\n\n\tasync makeCustomThemeBlurred(theme, options = {}): Promise<void>\n\t{\n\t\tif (!Type.isStringFilled(theme.bgImageUrlToBlur))\n\t\t{\n\t\t\treturn Promise.resolve();\n\t\t}\n\n\t\tconst lsKey = 'custom_themes_errors';\n\t\tconst localStorage = Reflection.getClass('BX.localStorage');\n\t\tif (localStorage && localStorage.get(lsKey)?.includes(theme.id))\n\t\t{\n\t\t\tconsole.log('Skipping blurred image for theme', theme.id);\n\n\t\t\treturn Promise.resolve();\n\t\t}\n\n\t\tconst saveError = (timeout = 3600) => {\n\t\t\tif (localStorage)\n\t\t\t{\n\t\t\t\tconst errorCustomThemes: string = localStorage.get(lsKey) || '';\n\t\t\t\tlocalStorage.set(lsKey, `${errorCustomThemes}|${theme.id}`, timeout);\n\t\t\t}\n\t\t};\n\n\t\tlet bgImageBlurred = null;\n\t\tlet color = null;\n\t\ttry\n\t\t{\n\t\t\tconst { image } = await this.#loadImage(theme.bgImageUrlToBlur);\n\t\t\tconst result = await blur(image, 7);\n\n\t\t\tbgImageBlurred = result.file;\n\t\t\tcolor = result.color;\n\t\t}\n\t\tcatch (error)\n\t\t{\n\t\t\tsaveError();\n\n\t\t\treturn Promise.reject(error);\n\t\t}\n\n\t\tconst { ignoreErrors = false, applyTheme = false } = options;\n\n\t\tconst data = new FormData();\n\t\tdata.append('action', 'save-blurred-image');\n\t\tdata.append('themeId', theme.id);\n\t\tdata.append('bgImageBlurred', bgImageBlurred);\n\t\tdata.append('bgColor', color);\n\t\tdata.append('ignoreErrors', ignoreErrors);\n\n\t\treturn this.#ajax(data)\n\t\t\t.then((response) => {\n\t\t\t\tif (response && response.success && response.theme)\n\t\t\t\t{\n\t\t\t\t\tthis.#themePicker.updateTheme(response.theme.id, { bgImageUrlToBlur: null });\n\t\t\t\t\tthis.#themePicker.updateTheme(response.theme.id, response.theme);\n\t\t\t\t\tthis.preloadTheme(response.theme.id, () => {\n\t\t\t\t\t\tif (applyTheme)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.removeThemeAssets(this.#themePicker.getAppliedThemeId());\n\t\t\t\t\t\t\tthis.applyThemeAssets(response.theme);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tconsole.log('Error while saving blurred image for theme', theme.id);\n\t\t\t\t\tsaveError();\n\t\t\t\t}\n\t\t\t})\n\t\t\t.catch((error) => {\n\t\t\t\tconsole.error(error);\n\t\t\t\tsaveError();\n\t\t\t})\n\t\t;\n\t}\n\n\t#loadImage(src: string): Promise<{ width: number, height: number, image: HTMLImageElement }>\n\t{\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tconst image: HTMLImageElement = document.createElement('img');\n\t\t\tlet url = src;\n\t\t\tif (url.startsWith('http') && !url.startsWith(window.location.origin))\n\t\t\t{\n\t\t\t\turl = '/bitrix/tools/landing/proxy.php';\n\t\t\t\turl += `?sessid=${Loc.getMessage('bitrix_sessid')}&url=${encodeURIComponent(this.#urnEncode(src))}`;\n\t\t\t}\n\n\t\t\timage.src = url;\n\t\t\timage.onerror = (error) => {\n\t\t\t\treject(error);\n\t\t\t};\n\n\t\t\timage.onload = () => {\n\t\t\t\tresolve({\n\t\t\t\t\twidth: image.naturalWidth,\n\t\t\t\t\theight: image.naturalHeight,\n\t\t\t\t\timage,\n\t\t\t\t});\n\t\t\t};\n\t\t});\n\t}\n\n\t#urnEncode(str: string): string\n\t{\n\t\tlet result = '';\n\t\tconst parts = str.split(/(:\\/\\/|:\\d+\\/|\\/|\\?|=|&)/);\n\n\t\tfor (const [i, part] of parts.entries())\n\t\t{\n\t\t\tresult += (i % 2 === 1) ? part : encodeURIComponent(part);\n\t\t}\n\n\t\treturn result;\n\t}\n\n\t#ajax(data): Promise\n\t{\n\t\tconst formData = Type.isFormData(data) ? data : new FormData();\n\t\tif (Type.isPlainObject(data))\n\t\t{\n\t\t\tfor (const [key, value] of Object.entries(data))\n\t\t\t{\n\t\t\t\tformData.append(key, value);\n\t\t\t}\n\t\t}\n\n\t\tformData.append('sessid', Loc.getMessage('bitrix_sessid'));\n\t\tformData.append('templateId', this.#themePicker.getTemplateId());\n\t\tformData.append('siteId', this.#themePicker.getSiteId());\n\t\tformData.append('entityType', this.#themePicker.getEntityType());\n\t\tformData.append('entityId', this.#themePicker.getEntityId());\n\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tAjax({\n\t\t\t\tmethod: 'POST',\n\t\t\t\tdataType: 'json',\n\t\t\t\tpreparePost: false,\n\t\t\t\turl: this.#themePicker.getAjaxHandlerPath(),\n\t\t\t\tdata: formData,\n\t\t\t\tonsuccess: resolve,\n\t\t\t\tonfailure: reject,\n\t\t\t});\n\t\t});\n\t}\n\n\t#loadThemes(): void\n\t{\n\t\tthis.#ajax({ action: 'getlist' })\n\t\t\t.then((data) => {\n\t\t\t\tif (!data || !data.success || !Type.isArray(data.themes) || data.themes.length === 0)\n\t\t\t\t{\n\t\t\t\t\tthis.#showFatalError();\n\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tthis.#hideLoader();\n\t\t\t\tthis.#themePicker.setThemes(data.themes);\n\t\t\t\tthis.#themePicker.setBaseThemes(data.baseThemes);\n\t\t\t\tthis.#setButtons();\n\t\t\t\tthis.#renderLayout();\n\t\t\t})\n\t\t\t.catch(() => {\n\t\t\t\tthis.#showFatalError();\n\t\t\t})\n\t\t;\n\t}\n\n\t#setButtons(): void\n\t{\n\t\tconst buttons = [];\n\n\t\tif (this.#themePicker.isCurrentUserAdmin() && this.#themePicker.getEntityType() === 'USER')\n\t\t{\n\t\t\tbuttons.push(this.#getCheckboxButton());\n\t\t}\n\n\t\tbuttons.push(this.#getSaveButton(), this.#getCancelButton(), this.#getCreateButton());\n\n\t\tthis.#themePicker.getDialogPopup().setButtons(buttons);\n\t}\n\n\t#getCheckboxButton(): CheckboxButton\n\t{\n\t\tif (!this.#checkboxButton)\n\t\t{\n\t\t\tthis.#checkboxButton = new CheckboxButton(this.#themePicker);\n\t\t}\n\n\t\treturn this.#checkboxButton;\n\t}\n\n\t#showFatalError(): void\n\t{\n\t\tthis.#hideLoader();\n\t\tthis.#themePicker.getDialogPopup().setContent(Loc.getMessage('BITRIX24_THEME_UNKNOWN_ERROR'));\n\t\tthis.#themePicker.getDialogPopup().setButtons([this.#getCancelButton()]);\n\t}\n\n\t#hideLoader(): void\n\t{\n\t\tthis.#themePicker.hideLoader();\n\t}\n\n\t#getSaveButton(): PopupWindowButton\n\t{\n\t\treturn new PopupWindowButton({\n\t\t\tid: 'save-button',\n\t\t\ttext: Loc.getMessage('BITRIX24_THEME_DIALOG_SAVE_BUTTON'),\n\t\t\tclassName: 'popup-window-button-accept',\n\t\t\tevents: {\n\t\t\t\tclick: () => {\n\t\t\t\t\tthis.#handleSaveButtonClick();\n\t\t\t\t},\n\t\t\t},\n\t\t});\n\t}\n\n\t#handleSaveButtonClick(): void\n\t{\n\t\tif (this.#themePicker.needReturnValue())\n\t\t{\n\t\t\tconst eventData = {\n\t\t\t\ttheme: this.#themePicker.getTheme(this.#themePicker.getReturnValue()),\n\t\t\t};\n\n\t\t\tEventEmitter.emit(\n\t\t\t\t'Intranet.ThemePicker:onSave',\n\t\t\t\tnew BaseEvent({ data: [eventData], compatData: [eventData] }),\n\t\t\t);\n\t\t}\n\t\telse if (\n\t\t\tthis.#themePicker.getThemeId() !== this.#themePicker.getAppliedThemeId()\n\t\t\t|| this.#isCheckboxChecked()\n\t\t)\n\t\t{\n\t\t\tthis.#saveTheme(this.#themePicker.getAppliedThemeId());\n\t\t}\n\n\t\tthis.#themePicker.closeDialog();\n\t}\n\n\t#isCheckboxChecked(): boolean\n\t{\n\t\treturn this.#checkboxButton ? this.#checkboxButton.isChecked() : false;\n\t}\n\n\t#getCancelButton(): PopupWindowButtonLink\n\t{\n\t\treturn new PopupWindowButtonLink({\n\t\t\tid: 'cancel-button',\n\t\t\ttext: Loc.getMessage('BITRIX24_THEME_DIALOG_CANCEL_BUTTON'),\n\t\t\tclassName: 'popup-window-button-link theme-dialog-button-link',\n\t\t\tevents: {\n\t\t\t\tclick: () => {\n\t\t\t\t\tthis.#themePicker.closeDialog();\n\t\t\t\t},\n\t\t\t},\n\t\t});\n\t}\n\n\t#getCreateButton(): PopupWindowButtonLink\n\t{\n\t\treturn new PopupWindowButtonLink({\n\t\t\tid: 'create-button',\n\t\t\ttext: Loc.getMessage('BITRIX24_THEME_DIALOG_NEW_THEME'),\n\t\t\tclassName: 'popup-window-button-link theme-dialog-button-link theme-dialog-new-theme-btn',\n\t\t\tevents: {\n\t\t\t\tclick: () => {\n\t\t\t\t\tthis.getNewThemeDialog().show();\n\t\t\t\t},\n\t\t\t},\n\t\t});\n\t}\n\n\t#renderLayout(): void\n\t{\n\t\tconst container = Tag.render`\n\t\t\t<div class=\"theme-dialog-content\"></div>\n\t\t`;\n\n\t\tthis.#themePicker.getThemes().forEach((theme) => {\n\t\t\tDom.append(this.createItem(theme), container);\n\t\t});\n\n\t\tthis.#themePicker.getDialogPopup().setContent(\n\t\t\tTag.render`\n\t\t\t\t<div class=\"theme-dialog-container\">${container}</div>\n\t\t\t`,\n\t\t);\n\t}\n\n\taddItem(theme): void\n\t{\n\t\tconst themes = this.#themePicker.getThemes();\n\t\tthemes.unshift(theme);\n\t\tthis.#themePicker.setThemes(themes);\n\t\tconst newItem = this.createItem(theme);\n\t\tDom.prepend(newItem, this.getContentContainer());\n\t\tthis.#selectItem(newItem);\n\t}\n\n\tcreateItem(theme): HTMLElement\n\t{\n\t\tlet className = 'theme-dialog-item';\n\n\t\tif (theme.video)\n\t\t{\n\t\t\tclassName += ' theme-dialog-item-video';\n\t\t}\n\n\t\tif (this.#themePicker.getAppliedThemeId() === theme.id)\n\t\t{\n\t\t\tclassName += ' theme-dialog-item-selected';\n\t\t}\n\n\t\tconst div = Tag.render`\n\t\t\t<div\n\t\t\t\tclass=\"${className}\"\n\t\t\t\tdata-theme-id=\"${theme.id}\"\n\t\t\t\tonclick=\"${this.handleItemClick.bind(this)}\"\n\t\t\t>\n\t\t\t\t<div class=\"theme-dialog-item-title\">\n\t\t\t\t\t<span class=\"theme-dialog-item-title-text\">${theme.title}</span>\n\t\t\t\t\t${theme.removable ? Tag.render`\n\t\t\t\t\t\t<div\n\t\t\t\t\t\t\tclass=\"theme-dialog-item-remove\"\n\t\t\t\t\t\t\tdata-theme-id=\"${theme.id}\"\n\t\t\t\t\t\t\ttitle=\"${Loc.getMessage('BITRIX24_THEME_REMOVE_THEME')}\"\n\t\t\t\t\t\t\tonclick=\"${this.handleRemoveBtnClick.bind(this)}\"\n\t\t\t\t\t\t></div>\n\t\t\t\t\t` : ''}\n\t\t\t\t</div>\n\t\t\t\t${theme.default === true ? this.#createDefaultLabel() : ''}\n\t\t\t\t${theme.new === true ? this.#createNewLabel() : ''}\n\t\t\t</div>\n\t\t`;\n\n\t\tif (Type.isStringFilled(theme.previewImage))\n\t\t{\n\t\t\tconst img = Tag.render`\n\t\t\t\t<img \n\t\t\t\t\tsrc=\"${encodeURI(theme.previewImage)}\" \n\t\t\t\t\talt=\"${theme.title}\" \n\t\t\t\t\tclass=\"theme-dialog-item-preview-img\" \n\t\t\t\t\tloading=\"lazy\"\n\t\t\t\t>\n\t\t\t`;\n\n\t\t\tDom.append(img, div);\n\t\t}\n\n\t\tif (Type.isStringFilled(theme.previewColor))\n\t\t{\n\t\t\tDom.style(div, 'background-color', theme.previewColor);\n\t\t}\n\n\t\treturn div;\n\t}\n\n\tgetNewThemeDialog(): NewThemeDialog\n\t{\n\t\tif (!this.#newThemeDialog)\n\t\t{\n\t\t\tthis.#newThemeDialog = new NewThemeDialog(this.#themePicker, this);\n\t\t\tthis.#newThemeDialog.subscribe('onDestroy', () => {\n\t\t\t\tthis.#newThemeDialog = null;\n\t\t\t});\n\t\t}\n\n\t\treturn this.#newThemeDialog;\n\t}\n\n\thandleItemClick(event): void\n\t{\n\t\tthis.#selectItem(this.getItemNode(event));\n\t}\n\n\thandleRemoveBtnClick(event): void\n\t{\n\t\tconst item = this.getItemNode(event);\n\t\tif (!item)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst themeId = item.dataset.themeId;\n\t\tconst theme = this.#themePicker.getTheme(themeId);\n\t\tif (theme && theme.default)\n\t\t{\n\t\t\tconst defaultThemeItem = this.getContentContainer().querySelector('[data-theme-id=\"default\"]');\n\t\t\tif (defaultThemeItem)\n\t\t\t{\n\t\t\t\tDom.append(this.#createDefaultLabel(), defaultThemeItem);\n\t\t\t}\n\t\t}\n\n\t\tthis.#themePicker.removeTheme(themeId);\n\t\tDom.remove(item);\n\n\t\tif (this.#themePicker.getAppliedThemeId() === themeId)\n\t\t{\n\t\t\tconst firstItem = this.getContentContainer().children[0];\n\t\t\tthis.#selectItem(firstItem);\n\n\t\t\tif (this.#themePicker.getThemeId() === themeId && firstItem && firstItem.dataset.themeId)\n\t\t\t{\n\t\t\t\tthis.#saveTheme(firstItem.dataset.themeId);\n\t\t\t}\n\t\t}\n\t\telse if (this.#themePicker.getThemeId() === themeId)\n\t\t{\n\t\t\tthis.#saveTheme(this.#themePicker.getAppliedThemeId());\n\t\t}\n\n\t\tvoid this.#ajax({ action: 'remove', themeId });\n\t\tevent.stopPropagation();\n\t}\n\n\t#saveTheme(themeId): void\n\t{\n\t\tconst theme = this.#themePicker.getTheme(themeId);\n\t\tconst eventData = { theme, themeId, setDefaultTheme: this.#isCheckboxChecked() };\n\n\t\tEventEmitter.emit(\n\t\t\t'Intranet.ThemePicker:onSaveTheme',\n\t\t\tnew BaseEvent({ data: eventData, compatData: [eventData] }),\n\t\t);\n\n\t\tconst data = new FormData();\n\t\tdata.append('action', 'save');\n\t\tdata.append('themeId', themeId);\n\t\tdata.append('setDefaultTheme', this.#isCheckboxChecked());\n\n\t\tvoid this.#ajax(data);\n\n\t\tthis.#themePicker.setThemeId(themeId);\n\t}\n\n\tgetItemNode(event): ?HTMLElement\n\t{\n\t\tif (!event || !event.target)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tconst item = event.target.closest('.theme-dialog-item');\n\n\t\treturn Type.isDomNode(item) ? item : null;\n\t}\n\n\tgetContentContainer(): HTMLElement\n\t{\n\t\treturn this.#themePicker.getDialogPopup().getContentContainer().querySelector('.theme-dialog-content');\n\t}\n\n\t#createDefaultLabel(): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"theme-dialog-item-default\">\n\t\t\t\t${Loc.getMessage('BITRIX24_THEME_DEFAULT_THEME')}\n\t\t\t</div>\n\t\t`;\n\t}\n\n\t#createNewLabel(): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"theme-dialog-item-new\">\n\t\t\t\t${Loc.getMessage('BITRIX24_THEME_NEW_THEME')}\n\t\t\t</div>\n\t\t`;\n\t}\n\n\t#selectItem(item): void\n\t{\n\t\tif (!Type.isDomNode(item) || !Dom.hasClass(item, 'theme-dialog-item'))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst themeId = item.dataset.themeId;\n\n\t\tthis.getContentContainer()\n\t\t\t.querySelectorAll('div.theme-dialog-item[data-theme-id]')\n\t\t\t.forEach((currentItem) => Dom.removeClass(currentItem, 'theme-dialog-item-selected'))\n\t\t;\n\n\t\tDom.addClass(item, 'theme-dialog-item-selected');\n\n\t\tif (this.#themePicker.needReturnValue())\n\t\t{\n\t\t\tthis.#themePicker.setReturnValue(themeId);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tconst loader = new Loader({ size: 100 });\n\t\t\tloader.show(item);\n\n\t\t\tthis.preloadTheme(themeId, async () => {\n\t\t\t\tconst theme = this.#themePicker.getTheme(themeId);\n\t\t\t\tif (Type.isStringFilled(theme.bgImageUrlToBlur))\n\t\t\t\t{\n\t\t\t\t\ttry\n\t\t\t\t\t{\n\t\t\t\t\t\tawait this.makeCustomThemeBlurred(theme);\n\t\t\t\t\t}\n\t\t\t\t\tcatch (ex)\n\t\t\t\t\t{\n\t\t\t\t\t\tconsole.error(ex);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (Dom.hasClass(item, 'theme-dialog-item-selected')) // by this time user could select another theme\n\t\t\t\t{\n\t\t\t\t\tloader.hide();\n\t\t\t\t\tthis.applyTheme(themeId);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n\n\tapplyTheme(themeId): void\n\t{\n\t\tif (!Type.isStringFilled(themeId) || themeId === this.#themePicker.getAppliedThemeId())\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst theme = this.#themePicker.getTheme(themeId);\n\t\tif (!theme)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst eventData = { id: themeId, theme };\n\t\tEventEmitter.emit(\n\t\t\t'BX.Intranet.Bitrix24:ThemePicker:onThemeApply',\n\t\t\tnew BaseEvent({ data: eventData, compatData: [eventData] }),\n\t\t);\n\t\tthis.applyThemeAssets(theme);\n\t\tthis.removeThemeAssets(this.#themePicker.getAppliedThemeId());\n\t\tthis.#themePicker.setAppliedThemeId(themeId);\n\n\t\tthis.appliedTheme = theme;\n\n\t\tEventEmitter.emit('BX.Intranet.Bitrix24:ThemePicker:onThemeAfterApply', { id: themeId, theme });\n\t}\n\n\tapplyThemeAssets(assets): void\n\t{\n\t\tif (!assets || !Type.isArray(assets.css) || !Type.isStringFilled(assets.id))\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst head = document.head;\n\t\tconst themeId = assets.id;\n\n\t\tassets.css.forEach((file) => {\n\t\t\tconst link = Tag.render`\n\t\t\t\t<link type=\"text/css\" rel=\"stylesheet\" href=\"${file}\" data-theme-id=\"${themeId}\">\n\t\t\t`;\n\t\t\thead.appendChild(link);\n\t\t});\n\n\t\tif (Type.isStringFilled(assets.style))\n\t\t{\n\t\t\tconst style = Tag.render`\n\t\t\t\t<style type=\"text/css\" data-theme-id=\"${themeId}\">\n\t\t\t\t\t${assets.style}\n\t\t\t\t</style>\n\t\t\t`;\n\t\t\thead.appendChild(style);\n\t\t}\n\n\t\tif (assets.video && Type.isPlainObject(assets.video.sources))\n\t\t{\n\t\t\tconst sources = [];\n\t\t\tfor (const type in assets.video.sources)\n\t\t\t{\n\t\t\t\tsources.push(Tag.render`<source type=\"video/${type}\" src=\"${assets.video.sources[type]}\">`);\n\t\t\t}\n\n\t\t\tconst video = Tag.render`\n\t\t\t\t<div class=\"theme-video-container\" data-theme-id=\"${themeId}\">\n\t\t\t\t\t<video\n\t\t\t\t\t\tclass=\"theme-video\"\n\t\t\t\t\t\tposter=\"${assets.video.poster}\"\n\t\t\t\t\t\tautoplay\n\t\t\t\t\t\tloop\n\t\t\t\t\t\tmuted\n\t\t\t\t\t\tplaysinline\n\t\t\t\t\t\tdata-theme-id=\"${themeId}\"\n\t\t\t\t\t>\n\t\t\t\t\t\t${sources}\n\t\t\t\t\t</video>\n\t\t\t\t</div>\n\t\t\t`;\n\n\t\t\tdocument.body.insertBefore(video, document.body.firstElementChild);\n\t\t}\n\n\t\tconst appliedBaseThemeId = this.#themePicker.getAppliedThemeId().split(':')[0];\n\t\tconst baseThemeId = themeId.split(':')[0];\n\n\t\tconst contexts = {\n\t\t\tlight: '--ui-context-edge-dark',\n\t\t\tdark: '--ui-context-edge-light',\n\t\t\tdefault: '--ui-context-edge-light',\n\t\t};\n\n\t\tif (appliedBaseThemeId !== baseThemeId)\n\t\t{\n\t\t\tDom.removeClass(document.body, [`bitrix24-${appliedBaseThemeId}-theme`, contexts[appliedBaseThemeId]]);\n\t\t\tDom.addClass(document.body, [`bitrix24-${baseThemeId}-theme`, contexts[baseThemeId]]);\n\t\t}\n\t}\n\n\tremoveThemeAssets(themeId): void\n\t{\n\t\tconst styles = document.head.querySelectorAll(`[data-theme-id=\"${themeId}\"]`);\n\t\tfor (const style of styles)\n\t\t{\n\t\t\tDom.remove(style);\n\t\t}\n\n\t\tDom.remove(document.querySelector(`body > [data-theme-id=\"${themeId}\"]`));\n\t}\n\n\tpreloadTheme(themeId, callback: Function): void\n\t{\n\t\tconst fn = Type.isFunction(callback) ? callback : () => {};\n\t\tconst theme = this.#themePicker.getTheme(themeId);\n\n\t\tif (!theme)\n\t\t{\n\t\t\tfn();\n\n\t\t\treturn;\n\t\t}\n\n\t\tlet asyncCount = 2; // preloadImages & preloadCss\n\t\tconst onload = () => {\n\t\t\tasyncCount--;\n\t\t\tif (asyncCount === 0)\n\t\t\t{\n\t\t\t\tfn();\n\t\t\t}\n\t\t};\n\n\t\tthis.preloadImages(theme.prefetchImages, onload);\n\t\tthis.#preloadCss(theme.css, onload);\n\t}\n\n\tpreloadImages(images, callback): void\n\t{\n\t\tconst fn = Type.isFunction(callback) ? callback : () => {};\n\n\t\tif (!Type.isArrayFilled(images))\n\t\t{\n\t\t\tfn();\n\n\t\t\treturn;\n\t\t}\n\n\t\tlet loaded = 0;\n\n\t\timages.forEach((imageSrc) => {\n\t\t\tconst image = new Image();\n\t\t\timage.src = encodeURI(imageSrc);\n\t\t\timage.onload = image.onerror = () => {\n\t\t\t\tloaded++;\n\t\t\t\tif (loaded === images.length)\n\t\t\t\t{\n\t\t\t\t\tfn();\n\t\t\t\t}\n\t\t\t};\n\t\t});\n\t}\n\n\t#preloadCss(css, fn): void\n\t{\n\t\tif (!Type.isArray(css))\n\t\t{\n\t\t\tif (Type.isFunction(fn))\n\t\t\t{\n\t\t\t\tfn();\n\t\t\t}\n\n\t\t\treturn;\n\t\t}\n\n\t\tconst iframe = Tag.render`<iframe src=\"javascript:void(0)\" style=\"display: none\"></iframe>`;\n\t\tdocument.body.appendChild(iframe);\n\n\t\tconst iframeDoc = iframe.contentWindow.document;\n\t\tif (!iframeDoc.body)\n\t\t{\n\t\t\t// null in IE\n\t\t\tiframeDoc.write('<body></body>');\n\t\t}\n\n\t\t// to avoid a conflict between a theme's preload image and a <body>'s image from preload css files\n\t\tiframeDoc.body.style.cssText = 'background: #fff !important';\n\n\t\tBX.load(\n\t\t\tcss,\n\t\t\t() => {\n\t\t\t\tDom.remove(iframe);\n\t\t\t\tif (Type.isFunction(fn))\n\t\t\t\t{\n\t\t\t\t\tfn();\n\t\t\t\t}\n\t\t\t},\n\t\t\tiframeDoc,\n\t\t);\n\t}\n}\n"],"names":["CheckboxButton","PopupWindowButton","constructor","themePicker","id","Tag","render","bind","buttonNode","Loc","getMessage","canSetDefaultTheme","isChecked","checked","check","uncheck","InfoHelper","show","blur","file","radius","image","width","height","Type","isFile","Helpers","loadImage","naturalWidth","naturalHeight","canvas","document","createElement","ctx","getContext","padding","Math","ceil","tmpCanvas","tmpContext","w","h","drawImage","filter","console","log","imageData","getImageData","blurredImageData","blurManually","putImageData","pixel","r","g","b","data","hex","map","x","toString","padStart","join","type","Browser","isSafari","extension","blob","Promise","resolve","toBlob","fileName","name","getFilenameWithoutExtension","Text","getRandom","File","color","intRadius","round","boxes","calculateBoxSizes","tempData","Uint8ClampedArray","currentSrc","currentDst","i","boxRadius","floor","blurSymmetric","set","srcData","dstData","length","blurHorizontal","blurVertical","sigma","n","wIdeal","sqrt","wl","wu","mIdeal","m","sizes","push","kernelSize","iarr","y","rowStart","a","j","max","min","offset","dstOffset","leftX","leftOffset","rightX","rightOffset","widthBytes","colStart","topY","topOffset","bottomY","bottomOffset","NewThemeDialog","EventEmitter","listDialog","MemoryCache","setEventNamespace","setContent","disableThemeListDialog","destroy","getUploader","Uploader","multiple","acceptOnlyImages","allowReplaceSingle","imagePreviewWidth","imagePreviewHeight","imagePreviewMimeType","imagePreviewMimeTypeMode","imagePreviewQuality","imageMinWidth","imageMinHeight","imageMaxWidth","imageMaxHeight","imageMaxFileSize","events","UploaderEvent","FILE_LOAD_START","Loader","size","FILE_ERROR","event","error","getData","getDescription","FILE_COMPLETE","preview","getClientPreview","bgImageBlurred","bgImageBlurredUrl","URL","createObjectURL","setCustomData","revokeObjectURL","applyTheme","enableThemeListDialog","getFiles","getPreviewUrl","getCustomData","value","getContentContainer","querySelector","querySelectorAll","Popup","fixed","titleBar","closeByEsc","bindOnResize","closeIcon","draggable","cacheable","onClose","onDestroy","emit","buttons","text","className","click","PopupWindowButtonLink","close","ColorPicker","Reflection","getClass","onColorSelected","popupOptions","createButton","getButton","Dom","hasClass","getContainer","FormData","append","getSiteId","getTemplateId","postSize","key","entries","Blob","getMaxUploadSize","limit","toFixed","form","forms","addClassName","addClass","Ajax","url","getAjaxHandlerPath","method","dataType","preparePost","onsuccess","response","success","theme","addItem","preloadTheme","removeClassName","removeClass","onfailure","preventDefault","innerHTML","title","field","remember","imageField","assignBrowse","assignDropzone","bgImage","bgColor","isStringFilled","isFailed","getError","match","previewUrl","style","encodeURI","stopPropagation","open","bindElement","switchers","forEach","call","switcher","dataset","textColor","target","baseThemes","getBaseThemes","baseThemeId","isArray","css","getAppliedThemeId","removeThemeAssets","applyThemeAssets","setAppliedThemeId","hexColor","replace","c","parseInt","slice","brightness","ThemePickerDialog","needReturnValue","getThemeId","setThemes","makeCustomThemeBlurred","options","bgImageUrlToBlur","lsKey","localStorage","get","includes","saveError","timeout","errorCustomThemes","result","reject","ignoreErrors","then","updateTheme","catch","themes","getThemes","unshift","newItem","createItem","prepend","video","div","handleItemClick","removable","handleRemoveBtnClick","default","new","previewImage","img","previewColor","getNewThemeDialog","subscribe","getItemNode","item","themeId","getTheme","defaultThemeItem","removeTheme","remove","firstItem","children","action","closest","isDomNode","getDialogPopup","eventData","BaseEvent","compatData","appliedTheme","assets","head","link","appendChild","isPlainObject","sources","poster","body","insertBefore","firstElementChild","appliedBaseThemeId","split","contexts","light","dark","styles","callback","fn","isFunction","asyncCount","onload","preloadImages","prefetchImages","images","isArrayFilled","loaded","imageSrc","Image","src","onerror","startsWith","window","location","origin","encodeURIComponent","str","parts","part","formData","isFormData","Object","getEntityType","getEntityId","setBaseThemes","isCurrentUserAdmin","setButtons","hideLoader","getReturnValue","closeDialog","container","setDefaultTheme","setThemeId","currentItem","setReturnValue","loader","ex","hide","iframe","iframeDoc","contentWindow","write","cssText","BX","load"],"mappings":"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"}