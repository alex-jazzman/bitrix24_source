{"version":3,"file":"license-widget.bundle.js","sources":["../src/main-button.js","../src/contents/content.js","../src/contents/market-content.js","../src/contents/baas-content.js","../src/contents/license-content.js","../src/contents/partner-content.js","../src/contents/purchase-history-content.js","../src/contents/telephony-content.js","../src/contents/updates-content.js","../src/popup.js","../src/license-widget.js"],"sourcesContent":["import { Cache, Dom, Tag, Event } from 'main.core';\nimport { EventEmitter } from 'main.core.events';\nimport { Counter } from 'ui.cnt';\nimport type { MainButtonOptions } from './types/options';\n\nexport class MainButton extends EventEmitter\n{\n\t#cache = new Cache.MemoryCache();\n\n\tconstructor(options: MainButtonOptions)\n\t{\n\t\tsuper();\n\t\tthis.setEventNamespace('BX.Bitrix24.LicenseWidget.MainButton');\n\t\tthis.setOptions(options);\n\t\tEvent.bind(this.getContent(),'click', () => {\n\t\t\tthis.emit('click');\n\t\t});\n\t}\n\n\tsetOptions(options: MainButtonOptions): MainButton\n\t{\n\t\tthis.#cache.set('options', options);\n\n\t\treturn this;\n\t}\n\n\tgetOptions(): MainButtonOptions\n\t{\n\t\treturn this.#cache.get('options', {});\n\t}\n\n\tgetContent(): HTMLElement\n\t{\n\t\treturn this.#cache.remember('content', () => {\n\t\t\treturn Tag.render`\n\t\t\t\t<button data-id=\"license-widget-main-button\" class=\"${this.#getClassName()}\">\n\t\t\t\t\t<span class=\"license-btn-icon\"></span>\n\t\t\t\t\t<span class=\"license-btn-counter\"></span>\n\t\t\t\t\t${(this.getOptions().isLicenseExpired) ? this.#getBattery() : null}\n\t\t\t\t\t<span class=\"license-btn-name\">${this.getOptions().text}</span>\n\t\t\t\t</button>\n\t\t\t`;\n\t\t});\n\t}\n\n\t#getClassName(): string\n\t{\n\t\treturn this.#cache.remember('button-class-name', () => {\n\t\t\tif (this.getOptions().isLicenseExpired)\n\t\t\t{\n\t\t\t\treturn 'ui-btn ui-btn-round ui-btn-themes license-btn license-btn-alert-border license-btn-animate license-btn-animate-forward';\n\t\t\t}\n\n\t\t\treturn this.getOptions().className;\n\t\t});\n\t}\n\n\t#getBattery(): HTMLElement\n\t{\n\t\treturn this.#cache.remember('battery', () => {\n\t\t\treturn Tag.render`\n\t\t\t\t<span class=\"license-btn-icon-battery\">\n\t\t\t\t\t\t<span class=\"license-btn-icon-battery-full\">\n\t\t\t\t\t\t\t<span class=\"license-btn-icon-battery-inner\">\n\t\t\t\t\t\t\t\t<span></span>\n\t\t\t\t\t\t\t\t<span></span>\n\t\t\t\t\t\t\t\t<span></span>\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t</span>\n\t\t\t\t\t\t<svg class=\"license-btn-icon-battery-cross\" xmlns=\"http://www.w3.org/2000/svg\" width=\"22\" height=\"18\">\n\t\t\t\t\t\t\t<path fill=\"#FFF\" fill-rule=\"evenodd\" d=\"M18.567.395c.42.42.42 1.1 0 1.52l-1.04 1.038.704.001a2 2 0 012 2v1.799a1.01 1.01 0 01.116-.007H21a1 1 0 011 1v2.495a1 1 0 01-1 1h-.653l-.116-.006v1.798a2 2 0 01-2 2L5.45 15.032l-2.045 2.045a1.075 1.075 0 11-1.52-1.52L17.047.395c.42-.42 1.1-.42 1.52 0zm-2.583 4.102l-8.991 8.99 10.836.002a1 1 0 00.994-.883l.006-.117v-6.99a1 1 0 00-1-1l-1.845-.002zm-5.031-1.543L9.409 4.498h-6.23a1 1 0 00-.993.884l-.006.116-.001 6.23-1.4 1.398v-.046L.777 4.954a2 2 0 012-2h8.175z\"/>\n\t\t\t\t\t\t</svg>\n\t\t\t\t</span>\n\t\t\t`;\n\t\t});\n\t}\n\n\tgetCounter(): Counter\n\t{\n\t\treturn this.#cache.remember('counter', () => {\n\t\t\treturn new Counter({\n\t\t\t\tcolor: Counter.Color.DANGER,\n\t\t\t});\n\t\t});\n\t}\n\n\tsetCounter(value: number): void\n\t{\n\t\tif (value < 1)\n\t\t{\n\t\t\tthis.getCounter().destroy();\n\t\t\tthis.#cache.delete('counter');\n\t\t}\n\n\t\tif (value > 0)\n\t\t{\n\t\t\tthis.getCounter().update(value);\n\t\t\tthis.getCounter().renderTo(this.getCounterWrapper());\n\t\t}\n\t}\n\n\tgetCounterWrapper(): HTMLSpanElement\n\t{\n\t\treturn this.#cache.remember('counter-node', () => {\n\t\t\treturn this.getContent().querySelector('.license-btn-counter');\n\t\t});\n\t}\n\n\tonClick(): void\n\t{\n\t\tthis.emit('click');\n\t}\n\n\treplaceSkeleton(): void\n\t{\n\t\tDom.replace(this.getOptions().wrapper, this.getContent());\n\t}\n}","import { EventEmitter } from 'main.core.events';\nimport { Cache } from 'main.core';\nimport type { ConfigOptions } from '../types/options';\n\nexport class Content extends EventEmitter\n{\n\tcache = new Cache.MemoryCache();\n\n\tconstructor(options: Object)\n\t{\n\t\tsuper();\n\t\tthis.setOptions(options);\n\t\tthis.setEventNamespace('BX.Intranet.LicenseWidget.Content');\n\t}\n\n\tsetOptions(options: Object): Content\n\t{\n\t\tthis.cache.set('options', options);\n\n\t\treturn this;\n\t}\n\n\tgetOptions(): Object\n\t{\n\t\treturn this.cache.get('options', {});\n\t}\n\n\tgetLayout(): HTMLElement\n\t{\n\t\tthrow new Error('Must be implemented in a child class');\n\t}\n\n\tgetConfig(): ConfigOptions\n\t{\n\t\treturn {\n\t\t\thtml: this.getLayout(),\n\t\t\tminHeight: '58px',\n\t\t};\n\t}\n}","import { EventEmitter } from 'main.core.events';\nimport { FeaturePromotersRegistry } from 'ui.info-helper';\nimport { Content } from './content';\nimport { Tag } from 'main.core';\n\nexport class MarketContent extends Content\n{\n\tgetConfig(): Object\n\t{\n\t\treturn {\n\t\t\thtml: this.getLayout(),\n\t\t\tminHeight: this.getOptions().isSmall ? '86px' : '55px',\n\t\t};\n\t}\n\n\tgetLayout(): HTMLElement\n\t{\n\t\treturn this.cache.remember('layout', () => {\n\t\t\treturn Tag.render`\n\t\t\t\t<div data-id=\"${this.getLayoutId()}\" class=\"license-widget-item license-widget-item--secondary ${this.getMainClass()}\">\n\t\t\t\t\t<div class=\"license-widget-inner ${this.getOptions().isSmall ? '--column' : ''}\">\n\t\t\t\t\t\t<div class=\"license-widget-content\">\n\t\t\t\t\t\t\t${this.getIcon()}\n\t\t\t\t\t\t\t<div class=\"license-widget-item-content\">\n\t\t\t\t\t\t\t\t${this.getTitle()}\n\t\t\t\t\t\t\t\t${this.getDescription()}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t${this.getButton()}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t});\n\t}\n\n\tgetLayoutId(): string\n\t{\n\t\treturn 'license-widget-block-market';\n\t}\n\n\tgetTitle(): HTMLElement\n\t{\n\t\treturn this.cache.remember('title', () => {\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"license-widget-item-name\">\n\t\t\t\t\t<span>\n\t\t\t\t\t\t${this.getOptions().title}\n\t\t\t\t\t</span>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t});\n\t}\n\n\tgetIcon(): HTMLElement\n\t{\n\t\treturn this.cache.remember('icon', () => {\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"license-widget-item-icon license-widget-item-icon--mp\"/>\n\t\t\t`;\n\t\t});\n\t}\n\n\tgetDescription(): HTMLElement\n\t{\n\t\treturn this.cache.remember('description', () => {\n\t\t\tif (this.getOptions().isPaid || this.getOptions().isDemo)\n\t\t\t{\n\t\t\t\treturn this.getReminderMessage();\n\t\t\t}\n\n\t\t\treturn this.getDescriptionLink();\n\t\t});\n\t}\n\n\tgetMainClass(): string\n\t{\n\t\tif (this.getOptions().isExpired || this.getOptions().isAlmostExpired)\n\t\t{\n\t\t\treturn '--market-expired';\n\t\t}\n\n\t\tif (this.getOptions().isPaid || this.getOptions().isDemo)\n\t\t{\n\t\t\treturn '--market-active';\n\t\t}\n\n\t\treturn '--market-default';\n\t}\n\n\tgetReminderMessage(): ?HTMLDivElement\n\t{\n\t\treturn this.cache.remember('reminder-message', () => {\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"license-widget-item-info\">\n\t\t\t\t\t<span class=\"license-widget-item-info-text\">\n\t\t\t\t\t\t${this.getOptions().messages.remainder}\n\t\t\t\t\t</span>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t});\n\t}\n\n\tgetDescriptionLink(): HTMLDivElement\n\t{\n\t\treturn this.cache.remember('description-link', () => {\n\t\t\tconst showHelper = () => {\n\t\t\t\tFeaturePromotersRegistry.getPromoter({ code: this.getOptions().description.landingCode }).show();\n\t\t\t};\n\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"license-widget-item-link\">\n\t\t\t\t\t<span class=\"license-widget-item-link-text\" onclick=\"${showHelper}\">\n\t\t\t\t\t\t${this.getOptions().description.text}\n\t\t\t\t\t</span>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t});\n\t}\n\n\tgetButton(): HTMLLinkElement\n\t{\n\t\treturn this.cache.remember('button', () => {\n\t\t\tconst onclick = () => {\n\t\t\t\tEventEmitter.emit(EventEmitter.GLOBAL_TARGET, 'BX.Intranet.LicenseWidget.Popup:openChild');\n\t\t\t};\n\n\t\t\treturn Tag.render`\n\t\t\t\t<a onclick=\"${onclick}\" href=\"${this.getOptions().button.link}\" class=\"license-widget-item-btn\" target=\"_blank\">\n\t\t\t\t\t${this.getOptions().button.text}\n\t\t\t\t</a>\n\t\t\t`;\n\t\t});\n\t}\n}","import { Tag, Runtime, Extension } from 'main.core';\nimport { BaseEvent, EventEmitter } from 'main.core.events';\nimport { FeaturePromotersRegistry } from 'ui.info-helper';\nimport { MarketContent } from './market-content';\n\nconst baasWidgetMarker = Symbol('baas widget');\nexport class BaasContent extends MarketContent\n{\n\tgetConfig(): Object\n\t{\n\t\treturn {\n\t\t\thtml: this.getOptions().awaitData.then((response) => {\n\t\t\t\tthis.setOptions({\n\t\t\t\t\t...response.data.baas,\n\t\t\t\t\t...this.getOptions(),\n\t\t\t\t});\n\n\t\t\t\treturn this.getLayout();\n\t\t\t}),\n\t\t\tminHeight: this.getOptions().isSmall ? '86px' : '55px',\n\t\t};\n\t}\n\n\tgetTitle(): HTMLElement\n\t{\n\t\treturn this.cache.remember('title', () => {\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"license-widget-item-name\">\n\t\t\t\t\t<span>\n\t\t\t\t\t\t${this.getOptions().title}\n\t\t\t\t\t</span>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t});\n\t}\n\n\tgetDescription(): HTMLElement\n\t{\n\t\tif (this.getOptions().isActive)\n\t\t{\n\t\t\treturn this.getReminderMessage();\n\t\t}\n\n\t\treturn this.getDescriptionLink();\n\t}\n\n\tgetDescriptionLink(): HTMLDivElement\n\t{\n\t\treturn this.cache.remember('description-link', () => {\n\t\t\tconst showHelper = () => {\n\t\t\t\tFeaturePromotersRegistry.getPromoter({ code: this.getOptions().description.landingCode }).show();\n\t\t\t};\n\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"license-widget-item-link\">\n\t\t\t\t\t<span class=\"license-widget-item-link-text\" onclick=\"${showHelper}\">\n\t\t\t\t\t\t${this.getOptions().description.text}\n\t\t\t\t\t</span>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t});\n\t}\n\n\tgetReminderMessage(): ?HTMLDivElement\n\t{\n\t\treturn this.cache.remember('reminder-message', () => {\n\t\t\tconst node = Tag.render`\n\t\t\t\t<div class=\"license-widget-item-link\" onclick=\"${this.#showBaasWidget.bind(this)}\">\n\t\t\t\t\t<span class=\"license-widget-item-link-text --active\">\n\t\t\t\t\t\t${this.getOptions().messages.remainder}\n\t\t\t\t\t</span>\n\t\t\t\t</div>\n\t\t\t`;\n\n\t\t\tif (BX.PULL && Extension.getSettings('baas.store').pull)\n\t\t\t{\n\t\t\t\tBX.PULL.extendWatch(Extension.getSettings('baas.store').pull.channelName);\n\n\t\t\t\tEventEmitter.subscribe('onPullEvent-baas', (event: BaseEvent) => {\n\t\t\t\t\tconst [command: string, params] = event.getData();\n\t\t\t\t\tif (command === 'updateService' && params.purchaseCount)\n\t\t\t\t\t{\n\t\t\t\t\t\tnode.querySelector('[data-bx-role=\"purchaseCount\"]').innerText = params.purchaseCount;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\n\t\t\treturn node;\n\t\t});\n\t}\n\n\tgetLayoutId(): string\n\t{\n\t\treturn 'license-widget-block-baas';\n\t}\n\n\tgetButton(): HTMLLinkElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<a class=\"license-widget-item-btn\" onclick=\"${this.#showBaasWidget.bind(this)}\">\n\t\t\t\t${this.getOptions().button.text}\n\t\t\t</a>\n\t\t`;\n\t}\n\n\t#showBaasWidget(): void\n\t{\n\t\tRuntime.loadExtension(['baas.store']).then((exports) => {\n\t\t\tconst widget = exports.Widget.getInstance();\n\t\t\tif (!widget[baasWidgetMarker])\n\t\t\t{\n\t\t\t\twidget.subscribe('onClickBack', () => {\n\t\t\t\t\tthis.getOptions().licensePopup.show();\n\t\t\t\t});\n\t\t\t}\n\t\t\twidget.bind(this.getOptions().licensePopupTarget, exports.Analytics.CONTEXT_LICENSE_WIDGET).show();\n\t\t\tEventEmitter.emit(EventEmitter.GLOBAL_TARGET, 'BX.Intranet.LicenseWidget.Popup:openChild');\n\t\t});\n\t}\n\n\tgetIcon(): HTMLElement\n\t{\n\t\treturn this.cache.remember('icon', () => {\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"license-widget-item-icon license-widget-item-icon--baas\"/>\n\t\t\t`;\n\t\t});\n\t}\n\n\tgetMainClass(): string\n\t{\n\t\tif (this.getOptions().isActive)\n\t\t{\n\t\t\treturn '--baas-active';\n\t\t}\n\n\t\treturn '--baas-default';\n\t}\n}\n","import { Dom, Tag } from 'main.core';\nimport type { LicenseContentOptions } from '../types/options';\nimport { Content } from './content';\n\nexport class LicenseContent extends Content\n{\n\tconstructor(options: LicenseContentOptions)\n\t{\n\t\tsuper(options);\n\t\tthis.setEventNamespace('BX.Bitrix24.LicenseWidget.Content.License');\n\t}\n\n\tgetLayout(): HTMLDivElement\n\t{\n\t\treturn this.cache.remember('layout', () => {\n\t\t\treturn Tag.render`\n\t\t\t<div data-id=\"license-widget-block-tariff\"\n\t\t\t\tclass=\"license-widget-item license-widget-item--main ${this.getOptions().isExpired || this.getOptions().isAlmostExpired ? 'license-widget-item--expired' : ''}\"\n\t\t\t>\n\t\t\t\t<div class=\"license-widget-inner ${this.getOptions().isDemo ? '--demo' : ''}\">\n\t\t\t\t\t<div class=\"license-widget-content\">\n\t\t\t\t\t\t${this.getMainIcon()}\n\t\t\t\t\t\t<div class=\"license-widget-item-content\">\n\t\t\t\t\t\t\t<div class=\"license-widget-item-name\">\n\t\t\t\t\t\t\t\t<span>${this.getOptions().name}</span>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t${this.getOptions().isExpired ? this.getExpiredMessage() : this.getRemainderMessage()}\n\t\t\t\t\t\t\t${this.getOptions().isExpired && this.getOptions().isAlmostBlocked ? this.getBlockMessage() : ''}\n\t\t\t\t\t\t\t${this.getOptions().isAlmostBlocked ? '' : this.getLink()}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t${this.getOptions().button.isAvailable ? this.getButton() : ''}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t`;\n\t\t});\n\t}\n\n\tgetMainIcon(): HTMLElement\n\t{\n\t\tconst icon = Tag.render`\n\t\t\t<div class=\"license-widget-item-icon\"/>\n\t\t`;\n\n\t\tif (this.getOptions().isAlmostExpired)\n\t\t{\n\t\t\tDom.addClass(icon, 'license-widget-item-icon--low');\n\t\t}\n\t\telse if (this.getOptions().isExpired)\n\t\t{\n\t\t\tDom.addClass(icon, 'license-widget-item-icon--expired');\n\t\t}\n\t\telse if (this.getOptions().isDemo)\n\t\t{\n\t\t\tDom.addClass(icon, 'license-widget-item-icon--demo');\n\t\t}\n\t\telse\n\t\t{\n\t\t\tDom.addClass(icon, 'license-widget-item-icon--pro');\n\t\t}\n\n\t\treturn icon;\n\t}\n\n\tgetButton(): HTMLElement\n\t{\n\t\tif (this.getOptions().button.type === 'POST')\n\t\t{\n\t\t\tconst onclick = () => {\n\t\t\t\tdocument.querySelector('#renew-license-form').submit();\n\t\t\t};\n\n\t\t\treturn Tag.render`\n\t\t\t\t<button onclick=\"${onclick}\" class=\"license-widget-item-btn ${this.getOptions().isDemo && !this.getOptions().isAlmostExpired && !this.getOptions().isExpired ? 'license-widget-item-btn--green' : ''}\">\n\t\t\t\t\t<form id=\"renew-license-form\" action=\"${this.getOptions().button.link}\" method=\"post\" target=\"_blank\">\n\t\t\t\t\t\t<input name=\"license_key\" value=\"${this.getOptions().button.hashKey}\" hidden>\n\t\t\t\t\t</form>\n\t\t\t\t\t${this.getOptions().button.text}\n\t\t\t\t</button>\n\t\t\t`;\n\t\t}\n\n\t\treturn Tag.render`\n\t\t\t<a href=\"${this.getOptions().button.link}\" target=\"_blank\" class=\"license-widget-item-btn ${this.getOptions().isDemo && !this.getOptions().isAlmostExpired && !this.getOptions().isExpired ? 'license-widget-item-btn--green' : ''}\">\n\t\t\t\t${this.getOptions().button.text}\n\t\t\t</a>\n\t\t`;\n\t}\n\n\tgetExpiredMessage(): HTMLElement\n\t{\n\t\treturn this.cache.remember('expired-message', () => {\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"license-widget-item-expired-message\">\n\t\t\t\t\t<span class=\"license-widget-item-info-text\">\n\t\t\t\t\t\t${this.getOptions().messages.expired}\n\t\t\t\t\t</span>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t});\n\t}\n\n\tgetBlockMessage(): HTMLElement\n\t{\n\t\treturn this.cache.remember('block-message', () => {\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"license-widget-item-expired-message --scanner-info\">\n\t\t\t\t\t<span class=\"license-widget-item-info-text\">\n\t\t\t\t\t\t${this.getOptions().messages.block}\n\t\t\t\t\t</span>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t});\n\t}\n\n\tgetRemainderMessage(): HTMLElement\n\t{\n\t\treturn this.cache.remember('block-message', () => {\n\t\t\tif (this.getOptions().isExpired || this.getOptions().isAlmostExpired)\n\t\t\t{\n\t\t\t\treturn Tag.render`\n\t\t\t\t\t<div class=\"license-widget-item-expired-message --scanner-info\">\n\t\t\t\t\t\t<span class=\"license-widget-item-info-text\">\n\t\t\t\t\t\t\t${this.getOptions().messages.remainder}\n\t\t\t\t\t\t</span>\n\t\t\t\t\t</div>\n\t\t\t\t`;\n\t\t\t}\n\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"license-widget-item-info\">\n\t\t\t\t\t<span class=\"license-widget-item-info-text\">\n\t\t\t\t\t\t${this.getOptions().messages.remainder}\n\t\t\t\t\t</span>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t});\n\t}\n\n\tgetLink(): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<a href=\"${this.getOptions().more.link}\" class=\"license-widget-item-link-text\" target=\"_blank\">\n\t\t\t\t${this.getOptions().more.text}\n\t\t\t</a>\n\t\t`;\n\t}\n}\n","import { Tag } from 'main.core';\nimport { FeaturePromotersRegistry } from 'ui.info-helper';\nimport { Content } from './content';\n\nexport class PartnerContent extends Content\n{\n\tconstructor(options)\n\t{\n\t\tsuper(options);\n\t\tthis.setEventNamespace('BX.Bitrix24.LicenseWidget.Content.Orders');\n\t}\n\n\tgetConfig(): Object\n\t{\n\t\treturn {\n\t\t\thtml: this.getLayout(),\n\t\t\tminHeight: '50px',\n\t\t};\n\t}\n\n\tgetLayout(): HTMLElement\n\t{\n\t\treturn this.cache.remember('layout', () => {\n\t\t\tconst onclick = () => {\n\t\t\t\tif (this.getOptions().landingCode)\n\t\t\t\t{\n\t\t\t\t\tFeaturePromotersRegistry.getPromoter({ code: this.getOptions().landingCode }).show();\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\twindow.open(this.getOptions().link);\n\t\t\t\t}\n\t\t\t};\n\n\t\t\treturn Tag.render`\n\t\t\t\t<div data-id=\"license-widget-block-orders\" onclick=\"${onclick}\" class=\"license-widget-item license-widget-item--secondary --pointer\">\n\t\t\t\t\t<div class=\"license-widget-inner\">\n\t\t\t\t\t\t<div class=\"license-widget-content\">\n\t\t\t\t\t\t\t<div class=\"license-widget-item-icon license-widget-item-icon--partner\"></div>\n\t\t\t\t\t\t\t<div class=\"license-widget-item-content\">\n\t\t\t\t\t\t\t\t${this.getTitle()}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"license-widget-item-icon__arrow-right ui-icon-set --arrow-right\"/>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t});\n\t}\n\n\tgetTitle(): HTMLDivElement\n\t{\n\t\treturn this.cache.remember('title', () => {\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"license-widget-item-name\">\n\t\t\t\t\t<span>\n\t\t\t\t\t\t${this.getOptions().title}\n\t\t\t\t\t</span>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t});\n\t}\n}\n","import { Tag } from 'main.core';\nimport type { PurchaseHistoryContentOptions } from '../types/options';\nimport { Content } from './content';\n\nexport class PurchaseHistoryContent extends Content\n{\n\tconstructor(options: PurchaseHistoryContentOptions)\n\t{\n\t\tsuper(options);\n\t\tthis.setEventNamespace('BX.Bitrix24.LicenseWidget.Content.Orders');\n\t}\n\n\tgetConfig(): Object\n\t{\n\t\treturn {\n\t\t\thtml: this.getLayout(),\n\t\t\tminHeight: '50px',\n\t\t};\n\t}\n\n\tgetLayout(): HTMLElement\n\t{\n\t\treturn this.cache.remember('layout', () => {\n\t\t\tconst onclick = (event) => {\n\t\t\t\tdocument.querySelector('#form-purchase-history').submit();\n\t\t\t};\n\n\t\t\treturn Tag.render`\n\t\t\t\t<div data-id=\"license-widget-block-orders\" onclick=\"${onclick}\" class=\"license-widget-item license-widget-item--secondary --pointer\">\n\t\t\t\t\t<div class=\"license-widget-inner\">\n\t\t\t\t\t\t<div class=\"license-widget-content\">\n\t\t\t\t\t\t\t<div class=\"license-widget-item-icon license-widget-item-icon--order\"></div>\n\t\t\t\t\t\t\t<div class=\"license-widget-item-content\">\n\t\t\t\t\t\t\t\t${this.getTitle()}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"license-widget-item-icon__arrow-right ui-icon-set --arrow-right\"/>\n\t\t\t\t\t</div>\n\t\t\t\t\t<form id=\"form-purchase-history\" action=\"${this.getOptions().link}\" method=\"post\" target=\"_blank\">\n\t\t\t\t\t\t<input name=\"license_key\" value=\"${this.getOptions().hashKey}\" hidden>\n\t\t\t\t\t</form>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t});\n\t}\n\n\tgetTitle(): HTMLDivElement\n\t{\n\t\treturn this.cache.remember('title', () => {\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"license-widget-item-name\">\n\t\t\t\t\t<span>\n\t\t\t\t\t\t${this.getOptions().text}\n\t\t\t\t\t</span>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t});\n\t}\n}","import { Content } from './content';\nimport { Tag } from 'main.core';\n\nexport class TelephonyContent extends Content\n{\n\tconstructor(options)\n\t{\n\t\tsuper(options);\n\t\tthis.setEventNamespace('BX.Bitrix24.LicenseWidget.Content.Telephony');\n\t}\n\n\tgetConfig(): Object\n\t{\n\t\treturn {\n\t\t\thtml: this.getOptions().awaitData.then((response) => {\n\t\t\t\tthis.setOptions({\n\t\t\t\t\t...response.data.telephony,\n\t\t\t\t\t...this.getOptions(),\n\t\t\t\t});\n\n\t\t\t\treturn this.getLayout();\n\t\t\t}),\n\t\t\tminHeight: '43px',\n\t\t\tsizeLoader: 30,\n\t\t};\n\t}\n\n\tgetLayout(): HTMLElement\n\t{\n\t\treturn this.cache.remember('layout', () => {\n\t\t\tconst onclick = () => {\n\t\t\t\tdocument.location.href = this.getOptions().link;\n\t\t\t};\n\n\t\t\treturn Tag.render`\n\t\t\t\t<div data-id=\"license-widget-block-telephony\" onclick=\"${onclick}\" class=\"license-widget-item license-widget-item--secondary --pointer\">\n\t\t\t\t\t<div class=\"license-widget-inner\">\n\t\t\t\t\t\t<div class=\"license-widget-content\">\n\t\t\t\t\t\t\t<div class=\"license-widget-item-icon ${this.getOptions().isActive ? 'license-widget-item-icon--tel-active' : 'license-widget-item-icon--tel'}\"/>\n\t\t\t\t\t\t\t<div class=\"license-widget-item-content\">\n\t\t\t\t\t\t\t\t<div class=\"license-widget-item-name\">\n\t\t\t\t\t\t\t\t\t${this.getOptions().title}\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"license-widget-item-icon__arrow-right ui-icon-set --arrow-right\"/>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t});\n\t}\n}\n","import { Content } from './content';\nimport { Tag } from 'main.core';\n\nexport class UpdatesContent extends Content\n{\n\tgetConfig(): Object\n\t{\n\t\treturn {\n\t\t\thtml: this.getLayout(),\n\t\t\tminHeight: '43px',\n\t\t\tsizeLoader: 30,\n\t\t};\n\t}\n\n\tgetLayout(): HTMLElement\n\t{\n\t\treturn this.cache.remember('layout', () => {\n\t\t\tconst onclick = () => {\n\t\t\t\twindow.open(this.getOptions().link, '_blank');\n\t\t\t};\n\n\t\t\treturn Tag.render`\n\t\t\t\t<div onclick=\"${onclick}\" data-id=\"license-widget-block-whatsnew\" class=\"license-widget-item license-widget-item--secondary --pointer\">\n\t\t\t\t\t<div class=\"license-widget-inner\">\n\t\t\t\t\t\t<div class=\"license-widget-content\">\n\t\t\t\t\t\t\t${this.getMainIcon()}\n\t\t\t\t\t\t\t<div class=\"license-widget-item-content\">\n\t\t\t\t\t\t\t\t${this.getTitle()}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"license-widget-item-icon__arrow-right ui-icon-set --arrow-right\"/>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t});\n\t}\n\n\tgetMainIcon(): HTMLDivElement\n\t{\n\t\treturn this.cache.remember('main-icon', () => {\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"license-widget-item-icon license-widget-item-icon--updates\"></div>\n\t\t\t`;\n\t\t});\n\t}\n\n\tgetTitle(): HTMLDivElement\n\t{\n\t\treturn this.cache.remember('title', () => {\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"license-widget-item-name\">\n\t\t\t\t\t<span>\n\t\t\t\t\t\t${this.getOptions().title}\n\t\t\t\t\t</span>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t});\n\t}\n}\n","import { ajax, Cache } from 'main.core';\nimport { EventEmitter } from 'main.core.events';\nimport { BaasContent } from './contents/baas-content';\nimport { LicenseContent } from './contents/license-content';\nimport { MarketContent } from './contents/market-content';\nimport { PartnerContent } from './contents/partner-content';\nimport { PurchaseHistoryContent } from './contents/purchase-history-content';\nimport { TelephonyContent } from './contents/telephony-content';\nimport { UpdatesContent } from './contents/updates-content';\nimport type { PopupOptions , ConfigOptions } from './types/options';\nimport { PopupComponentsMaker } from 'ui.popupcomponentsmaker';\n\nexport class Popup extends EventEmitter\n{\n\t#cache = new Cache.MemoryCache();\n\n\tconstructor(options: PopupOptions)\n\t{\n\t\tsuper();\n\t\tthis.setOptions(options);\n\t\tthis.setEventNamespace('BX.Intranet.LicenseWidget.Popup');\n\t\tthis.setEventHandlers();\n\t}\n\n\tsetOptions(options: PopupOptions): void\n\t{\n\t\tthis.#cache.set('options', options);\n\t}\n\n\tgetOptions(): PopupOptions\n\t{\n\t\treturn this.#cache.get('options', {});\n\t}\n\n\tshow(): void\n\t{\n\t\tthis.getBasePopup().show();\n\t\tthis.emit('show');\n\t}\n\n\tclose(): void\n\t{\n\t\tthis.getBasePopup().close();\n\t}\n\n\tgetBasePopup(): PopupComponentsMaker\n\t{\n\t\treturn this.#cache.remember('popup', () => {\n\t\t\tthis.emit('init');\n\n\t\t\treturn new PopupComponentsMaker({\n\t\t\t\ttarget: this.getOptions().target,\n\t\t\t\twidth: 374,\n\t\t\t\tcontent: this.#getContent(),\n\t\t\t});\n\t\t});\n\t}\n\n\t#getContent(): Array<ConfigOptions>\n\t{\n\t\treturn this.#cache.remember('content', () => {\n\t\t\tconst content = [];\n\n\t\t\tif (this.getOptions().content.license.isAvailable)\n\t\t\t{\n\t\t\t\tcontent.push(this.#getLicenseContent().getConfig());\n\t\t\t}\n\n\t\t\tif (this.getOptions().content.baas.isAvailable &&this.getOptions().content.market.isAvailable)\n\t\t\t{\n\t\t\t\tcontent.push({\n\t\t\t\t\thtml: [\n\t\t\t\t\t\tthis.#getMarketContent(true).getConfig(),\n\t\t\t\t\t\tthis.#getBaasContent(true).getConfig(),\n\t\t\t\t\t],\n\t\t\t\t});\n\t\t\t}\n\t\t\telse if (this.getOptions().content.market.isAvailable)\n\t\t\t{\n\t\t\t\tcontent.push(this.#getMarketContent(false).getConfig());\n\t\t\t}\n\t\t\telse if (this.getOptions().content.baas.isAvailable)\n\t\t\t{\n\t\t\t\tcontent.push(this.#getBaasContent(false).getConfig());\n\t\t\t}\n\n\t\t\tcontent.push(this.#getPurchaseHistoryContent().getConfig());\n\n\t\t\tif (this.getOptions().content.telephony.isAvailable)\n\t\t\t{\n\t\t\t\tcontent.push({\n\t\t\t\t\thtml: [\n\t\t\t\t\t\tthis.#getTelephonyContent().getConfig(),\n\t\t\t\t\t\tthis.#getUpdatesContent().getConfig(),\n\t\t\t\t\t],\n\t\t\t\t});\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tcontent.push(this.#getUpdatesContent().getConfig());\n\t\t\t}\n\n\t\t\tif (this.getOptions().content.partner.isAvailable)\n\t\t\t{\n\t\t\t\tcontent.push(this.#getPartnerContent().getConfig());\n\t\t\t}\n\n\t\t\treturn content;\n\t\t});\n\t}\n\n\t#getLicenseContent(): LicenseContent\n\t{\n\t\treturn this.#cache.remember('license-content', () => {\n\t\t\treturn new LicenseContent({\n\t\t\t\t...this.getOptions().content.license,\n\t\t\t});\n\t\t});\n\t}\n\n\t#getMarketContent(small: boolean): MarketContent\n\t{\n\t\treturn this.#cache.remember('market-content', () => {\n\t\t\treturn new MarketContent({\n\t\t\t\t...this.getOptions().content.market,\n\t\t\t\tisSmall: small,\n\t\t\t});\n\t\t});\n\t}\n\n\t#getBaasContent(small: boolean): BaasContent\n\t{\n\t\treturn this.#cache.remember('baas-content', () => {\n\t\t\treturn new BaasContent({\n\t\t\t\tawaitData: this.#getDynamicContent(),\n\t\t\t\tlicensePopupTarget: this.getOptions().target,\n\t\t\t\tlicensePopup: this,\n\t\t\t\tisAdmin: this.getOptions().isAdmin,\n\t\t\t\tisSmall: small,\n\t\t\t});\n\t\t});\n\t}\n\n\t#getPurchaseHistoryContent(): PurchaseHistoryContent\n\t{\n\t\treturn this.#cache.remember('purchase-history-content', () => {\n\t\t\treturn new PurchaseHistoryContent({\n\t\t\t\t...this.getOptions().content['purchase-history'],\n\t\t\t});\n\t\t});\n\t}\n\n\t#getTelephonyContent(): TelephonyContent\n\t{\n\t\treturn this.#cache.remember('telephony-content', () => {\n\t\t\treturn new TelephonyContent({\n\t\t\t\tawaitData: this.#getDynamicContent(),\n\t\t\t\t...this.getOptions().content.telephony,\n\t\t\t});\n\t\t});\n\t}\n\n\t#getUpdatesContent(): UpdatesContent\n\t{\n\t\treturn this.#cache.remember('updates-content', () => {\n\t\t\treturn new UpdatesContent({\n\t\t\t\t...this.getOptions().content.updates,\n\t\t\t});\n\t\t});\n\t}\n\n\t#getPartnerContent(): PartnerContent\n\t{\n\t\treturn this.#cache.remember('partner-content', () => {\n\t\t\treturn new PartnerContent({\n\t\t\t\t...this.getOptions().content.partner,\n\t\t\t});\n\t\t});\n\t}\n\n\t#getDynamicContent(): Promise\n\t{\n\t\treturn this.#cache.remember('await-data', () => {\n\t\t\treturn new Promise((resolve, reject) => {\n\t\t\t\tajax.runAction(this.getOptions().content.action).then(resolve).catch(reject);\n\t\t\t});\n\t\t});\n\t}\n\n\tsetEventHandlers(): void\n\t{\n\t\tconst close = () => {\n\t\t\tthis.close();\n\t\t};\n\n\t\tthis.subscribe('init', () => {\n\t\t\tEventEmitter.subscribe(EventEmitter.GLOBAL_TARGET, 'SidePanel.Slider:onOpenStart', close);\n\t\t\tEventEmitter.subscribe(EventEmitter.GLOBAL_TARGET, 'BX.Intranet.LicenseWidget.Popup:openChild', close);\n\t\t});\n\t}\n}","import { Cache, Type } from 'main.core';\nimport { MainButton } from './main-button';\nimport { Popup } from './popup';\nimport type { GeneralOptions } from './types/options';\nimport './style.css';\n\nexport class LicenseWidget\n{\n\t#cache = new Cache.MemoryCache();\n\n\tconstructor(options: GeneralOptions)\n\t{\n\t\tif (!Type.isDomNode(options.buttonWrapper))\n\t\t{\n\t\t\tthrow new Error('LicenseWidget: The buttonWrapper option is required.');\n\t\t}\n\n\t\tthis.setOptions(options);\n\t\tthis.getMainButton().replaceSkeleton();\n\t\tthis.getMainButton().subscribe('click', () => {\n\t\t\tthis.getPopup().show();\n\t\t});\n\t}\n\n\tsetOptions(options: GeneralOptions): LicenseWidget\n\t{\n\t\tthis.#cache.set('options', options);\n\n\t\treturn this;\n\t}\n\n\tgetOptions(): GeneralOptions\n\t{\n\t\treturn this.#cache.get('options', {});\n\t}\n\n\tgetPopup(): Popup\n\t{\n\t\treturn this.#cache.remember('popup', () => {\n\t\t\treturn new Popup({\n\t\t\t\ttarget: this.getMainButton().getContent(),\n\t\t\t\tcontent: {\n\t\t\t\t\t...this.getOptions(),\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\t}\n\n\tgetMainButton(): MainButton\n\t{\n\t\treturn this.#cache.remember('main-button', () => {\n\t\t\treturn new MainButton({\n\t\t\t\twrapper: this.getOptions().buttonWrapper,\n\t\t\t\tisLicenseExpired: this.getOptions().license.isExpired,\n\t\t\t\tclassName: this.getOptions()['main-button'].className,\n\t\t\t\ttext: this.getOptions()['main-button'].text,\n\t\t\t});\n\t\t});\n\t}\n}\n"],"names":["MainButton","EventEmitter","constructor","options","super","Object","value","writable","Cache","MemoryCache","this","setEventNamespace","setOptions","Event","bind","getContent","emit","babelHelpers","set","getOptions","get","remember","Tag","render","isLicenseExpired","text","getCounter","Counter","color","Color","DANGER","setCounter","destroy","delete","update","renderTo","getCounterWrapper","querySelector","onClick","replaceSkeleton","Dom","replace","wrapper","className","Content","cache","getLayout","Error","getConfig","html","minHeight","MarketContent","isSmall","getLayoutId","getMainClass","getIcon","getTitle","getDescription","getButton","title","isPaid","isDemo","getReminderMessage","getDescriptionLink","isExpired","isAlmostExpired","messages","remainder","FeaturePromotersRegistry","getPromoter","code","description","landingCode","show","GLOBAL_TARGET","button","link","baasWidgetMarker","Symbol","BaasContent","[object Object]","awaitData","then","response","data","baas","isActive","node","BX","PULL","Extension","getSettings","pull","extendWatch","channelName","subscribe","event","command","params","getData","purchaseCount","innerText","Runtime","loadExtension","exports","widget","Widget","getInstance","licensePopup","licensePopupTarget","Analytics","CONTEXT_LICENSE_WIDGET","LicenseContent","getMainIcon","name","getExpiredMessage","getRemainderMessage","isAlmostBlocked","getBlockMessage","getLink","isAvailable","icon","addClass","type","onclick","document","submit","hashKey","expired","block","more","PartnerContent","window","open","PurchaseHistoryContent","TelephonyContent","telephony","sizeLoader","location","href","UpdatesContent","Popup","setEventHandlers","getBasePopup","close","PopupComponentsMaker","target","width","content","license","push","market","partner","small","isAdmin","updates","Promise","resolve","reject","ajax","runAction","action","catch","Type","isDomNode","buttonWrapper","getMainButton","getPopup"],"mappings":"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"}