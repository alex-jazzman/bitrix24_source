{"version":3,"file":"air-sidepanel.bundle.js","sources":["../src/chat-menu-bar.js","../src/slider.js","../src/index.js"],"sourcesContent":["import { Dom, Reflection } from 'main.core';\nimport { EventEmitter } from 'main.core.events';\nimport { type Slider, SidePanel } from 'main.sidepanel';\n\nexport class ChatMenuBar\n{\n\t#slider: Slider = null;\n\t#container: HTMLElement = null;\n\t#loaded: boolean = false;\n\n\tconstructor(slider: Slider)\n\t{\n\t\tthis.#slider = slider;\n\n\t\tthis.#container = document.getElementById('im-chat-menu');\n\t\tif (!this.#container)\n\t\t{\n\t\t\tconsole.warn('ChatMenu: container not found');\n\n\t\t\treturn;\n\t\t}\n\n\t\tDom.append(this.#container, document.body);\n\n\t\tEventEmitter.subscribeOnce(this.#slider, 'SidePanel.Slider:onOpenStart', this.#handleSliderOpenStartOnce.bind(this));\n\t\tEventEmitter.subscribe(this.#slider, 'SidePanel.Slider:onOpening', this.#handleSliderOpening.bind(this));\n\t\tEventEmitter.subscribe(this.#slider, 'SidePanel.Slider:onClosing', this.#handleSliderClosing.bind(this));\n\t\tEventEmitter.subscribe(this.#slider, 'SidePanel.Slider:onCloseComplete', this.#handleSliderCloseComplete.bind(this));\n\t\tEventEmitter.subscribe(this.#slider, 'SidePanel.Slider:onDestroy', this.#handleSliderDestroy.bind(this));\n\n\t\tEventEmitter.subscribe('SidePanel.Slider:onOpening', (event: BaseEvent) => {\n\t\t\tconst [sliderEvent] = event.getData();\n\t\t\tif (sliderEvent.getSlider() !== this.#slider)\n\t\t\t{\n\t\t\t\tDom.style(this.getContainer(), 'background', this.#slider.getOverlayBgColor());\n\t\t\t\tDom.style(this.getContainer(), 'box-shadow', `0px 0px 10px 3px ${this.#slider.getOverlayBgColor()}`);\n\t\t\t}\n\t\t});\n\n\t\tEventEmitter.subscribe('SidePanel.Slider:onClosing', () => {\n\t\t\tif (this.#slider === SidePanel.Instance.getPreviousSlider())\n\t\t\t{\n\t\t\t\tDom.style(this.getContainer(), 'background', null);\n\t\t\t\tDom.style(this.getContainer(), 'box-shadow', null);\n\t\t\t}\n\t\t});\n\n\t\tEventEmitter.subscribe('IM.Layout:onLayoutChange', () => {\n\t\t\tif (!this.#loaded)\n\t\t\t{\n\t\t\t\tthis.#loaded = true;\n\t\t\t\tDom.addClass(this.getContainer(), '--loaded');\n\t\t\t}\n\t\t});\n\t}\n\n\tgetContainer(): HTMLElement\n\t{\n\t\treturn this.#container;\n\t}\n\n\tsetZIndex(zIndex: number): void\n\t{\n\t\tDom.style(this.getContainer(), 'z-index', zIndex);\n\t}\n\n\treset(): void\n\t{\n\t\tthis.getMenu()?.reset();\n\t}\n\n\tgetMenu(): typeof(BX.Main.interfaceButtons) | null\n\t{\n\t\t/**\n\t\t *\n\t\t * @type {BX.Main.interfaceButtonsManager}\n\t\t */\n\t\tconst menuManager = Reflection.getClass('BX.Main.interfaceButtonsManager');\n\t\tif (menuManager)\n\t\t{\n\t\t\treturn menuManager.getById('chat-menu');\n\t\t}\n\n\t\treturn null;\n\t}\n\n\t#handleSliderOpenStartOnce(): void\n\t{\n\t\tEventEmitter.subscribe(this.#slider.getZIndexComponent(), 'onZIndexChange', this.#handleZIndexChange.bind(this));\n\t}\n\n\t#handleSliderOpening(): void\n\t{\n\t\tthis.setZIndex(this.#slider.getZIndexComponent().getZIndex() + 1);\n\t\tDom.style(this.getContainer(), 'display', 'block');\n\t\tDom.style(this.getContainer(), 'background', null);\n\t\tDom.style(this.getContainer(), 'box-shadow', null);\n\n\t\trequestAnimationFrame(() => {\n\t\t\tDom.addClass(this.getContainer(), '--open');\n\t\t});\n\t}\n\n\t#handleSliderClosing(): void\n\t{\n\t\tthis.reset();\n\t\tDom.removeClass(this.getContainer(), '--open');\n\t}\n\n\t#handleSliderCloseComplete(): void\n\t{\n\t\tDom.style(this.getContainer(), 'display', 'none');\n\t\tDom.style(this.getContainer(), 'background', null);\n\t\tDom.style(this.getContainer(), 'box-shadow', null);\n\t}\n\n\t#handleSliderDestroy(): void\n\t{\n\t\tthis.reset();\n\t}\n\n\t#handleZIndexChange(): void\n\t{\n\t\tconst sliderZIndex = this.#slider.getZIndexComponent().getZIndex();\n\n\t\tthis.setZIndex(sliderZIndex + 1);\n\t}\n}\n","import { Reflection, Dom, Event, Type, Browser, ZIndexManager } from 'main.core';\nimport { Slider as BaseSlider, SidePanel, type OuterBoundary, type SliderOptions } from 'main.sidepanel';\nimport { ChatMenuBar } from './chat-menu-bar';\nimport { type ThemePicker } from 'intranet.theme-picker';\n\nconst MENU_COLLAPSED_WIDTH = 65;\nconst MENU_EXPANDED_WIDTH = 240;\n\nexport class Slider extends BaseSlider\n{\n\t#onWindowResize: Function = null;\n\t#chatMenuBar: ChatMenuBar = null;\n\tstatic #verticalScrollWidth: number = null;\n\n\tconstructor(url: string, sliderOptions: SliderOptions)\n\t{\n\t\tconst options: SliderOptions = Type.isPlainObject(sliderOptions) ? { ...sliderOptions } : {};\n\t\tconst isMessenger = url.startsWith('im:slider');\n\n\t\tif (isMessenger)\n\t\t{\n\t\t\toptions.hideControls = false;\n\t\t\toptions.autoOffset = false;\n\t\t}\n\n\t\tsuper(url, options);\n\n\t\tthis.#chatMenuBar = isMessenger ? new ChatMenuBar(this) : null;\n\t\tthis.#onWindowResize = this.#handleWindowResize.bind(this);\n\t}\n\n\tapplyHacks(): void\n\t{\n\t\tSlider.#verticalScrollWidth = window.innerWidth - document.documentElement.clientWidth;\n\n\t\tthis.adjustBackgroundSize();\n\t\tEvent.bind(window, 'resize', this.#onWindowResize);\n\n\t\tif (this.getRightBar() && !this.isMessengerSlider())\n\t\t{\n\t\t\tconst stack = ZIndexManager.getOrAddStack(document.body);\n\t\t\tstack.register(this.getRightBar());\n\t\t\tDom.addClass(this.getRightBar(), '--ui-context-edge-dark --overlay-mode');\n\t\t}\n\n\t\treturn true;\n\t}\n\n\tresetHacks(): void\n\t{\n\t\tthis.resetBackgroundSize();\n\t\tEvent.unbind(window, 'resize', this.#onWindowResize);\n\n\t\tif (this.getRightBar())\n\t\t{\n\t\t\tconst stack = ZIndexManager.getOrAddStack(document.body);\n\t\t\tstack.unregister(this.getRightBar());\n\t\t\tDom.removeClass(this.getRightBar(), '--ui-context-edge-dark --overlay-mode');\n\t\t\tDom.style(this.getRightBar(), 'z-index', null); // ZIndexManager may not remove z-index, so we do it manually\n\t\t}\n\t}\n\n\topen(): boolean\n\t{\n\t\tconst opened = super.open();\n\t\tif (this.getRightBar() && opened)\n\t\t{\n\t\t\tconst stack = ZIndexManager.getOrAddStack(document.body);\n\t\t\tif (!this.isMessengerSlider() && !Slider.isMessengerOpen() && !Slider.isVideoCallOpen())\n\t\t\t{\n\t\t\t\tstack.bringToFront(this.getRightBar());\n\t\t\t}\n\t\t}\n\n\t\treturn opened;\n\t}\n\n\tstatic isMessengerOpen(): boolean\n\t{\n\t\tconst MessengerSlider = Reflection.getClass('BX.Messenger.v2.Lib.MessengerSlider');\n\t\tif (MessengerSlider && MessengerSlider.getInstance().isOpened())\n\t\t{\n\t\t\treturn true;\n\t\t}\n\n\t\treturn Slider.isMessengerEmbedded();\n\t}\n\n\tstatic isMessengerEmbedded(): boolean\n\t{\n\t\tconst LayoutManager = Reflection.getClass('BX.Messenger.v2.Lib.LayoutManager');\n\n\t\treturn LayoutManager && LayoutManager.getInstance().isEmbeddedMode();\n\t}\n\n\tstatic isMessengerOpenBeforeSlider(slider: Slider): boolean\n\t{\n\t\tif (Slider.isMessengerEmbedded())\n\t\t{\n\t\t\treturn true;\n\t\t}\n\n\t\tconst sliders = SidePanel.Instance.getOpenSliders();\n\t\tfor (const openSlider of sliders)\n\t\t{\n\t\t\tif (openSlider === slider)\n\t\t\t{\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tif (openSlider?.isMessengerSlider())\n\t\t\t{\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\n\t\treturn false;\n\t}\n\n\tisMessengerSlider(): boolean\n\t{\n\t\treturn this.#chatMenuBar !== null;\n\t}\n\n\tstatic isVideoCallOpen(): boolean\n\t{\n\t\tconst CallManager = Reflection.getClass('BX.Messenger.v2.Lib.CallManager');\n\n\t\treturn CallManager && CallManager.getInstance().hasCurrentCall();\n\t}\n\n\tgetRightBar(): HTMLElement\n\t{\n\t\treturn document.getElementById('right-bar');\n\t}\n\n\tgetLeftBoundary(): number\n\t{\n\t\tconst windowWidth = Browser.isMobile() ? window.innerWidth : document.documentElement.clientWidth;\n\t\tif (windowWidth < 1260)\n\t\t{\n\t\t\treturn this.getMinLeftBoundary();\n\t\t}\n\n\t\tconst LeftMenu = Reflection.getClass('BX.Intranet.LeftMenu');\n\n\t\treturn (\n\t\t\tLeftMenu?.isCollapsed() || this.isMessengerSlider()\n\t\t\t\t? MENU_COLLAPSED_WIDTH\n\t\t\t\t: MENU_EXPANDED_WIDTH\n\t\t);\n\t}\n\n\tgetRightBoundary(): number\n\t{\n\t\treturn 0;\n\t}\n\n\tgetTopBoundary(): number\n\t{\n\t\treturn 0;\n\t}\n\n\tcalculateOuterBoundary(): OuterBoundary\n\t{\n\t\tif (this.isMessengerSlider() || Slider.isMessengerOpenBeforeSlider(this) || Slider.isVideoCallOpen())\n\t\t{\n\t\t\treturn {\n\t\t\t\ttop: this.isMessengerSlider() ? 58 : 16,\n\t\t\t\tright: 18,\n\t\t\t};\n\t\t}\n\n\t\tconst rightBarWidth = this.getRightBar()?.offsetWidth || 0;\n\t\tconst rightMargin = Slider.#verticalScrollWidth + rightBarWidth;\n\n\t\treturn {\n\t\t\ttop: 16,\n\t\t\tright: rightMargin,\n\t\t};\n\t}\n\n\tadjustBackgroundSize(): void\n\t{\n\t\tconst themePicker: ThemePicker = Reflection.getClass('BX.Intranet.Bitrix24.ThemePicker.Singleton');\n\t\tif (!themePicker)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst theme = themePicker.getAppliedTheme();\n\t\tif (theme && theme.resizable === true)\n\t\t{\n\t\t\tif (theme.video)\n\t\t\t{\n\t\t\t\tthis.adjustVideoSize();\n\t\t\t}\n\t\t\telse if (theme.width > 0 && theme.height > 0)\n\t\t\t{\n\t\t\t\tthis.adjustImageSize(theme.width, theme.height);\n\t\t\t}\n\t\t}\n\t}\n\n\tadjustImageSize(imgWidth: number, imgHeight: number): void\n\t{\n\t\tconst containerWidth = document.documentElement.clientWidth;\n\t\tconst containerHeight = document.documentElement.clientHeight;\n\n\t\tconst imgRatio = imgHeight / imgWidth;\n\t\tconst containerRatio = containerHeight / containerWidth;\n\t\tconst width = containerRatio > imgRatio ? containerHeight / imgRatio : containerWidth;\n\t\tconst height = containerRatio > imgRatio ? containerHeight : containerWidth * imgRatio;\n\n\t\tDom.style(document.body, '--air-theme-bg-size', `${width}px ${height}px`);\n\t}\n\n\tadjustVideoSize(): void\n\t{\n\t\tconst themePicker: ThemePicker = Reflection.getClass('BX.Intranet.Bitrix24.ThemePicker.Singleton');\n\t\tif (!themePicker)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst videoContainer: HTMLElement = themePicker.getVideoContainer();\n\t\tif (videoContainer)\n\t\t{\n\t\t\tDom.style(videoContainer, 'right', `${window.innerWidth - document.documentElement.clientWidth}px`);\n\t\t}\n\t}\n\n\tresetBackgroundSize(): void\n\t{\n\t\tDom.style(document.body, '--air-theme-bg-size', null);\n\n\t\tconst themePicker: ThemePicker = Reflection.getClass('BX.Intranet.Bitrix24.ThemePicker.Singleton');\n\t\tif (themePicker)\n\t\t{\n\t\t\tconst videoContainer: HTMLElement = themePicker.getVideoContainer();\n\t\t\tif (videoContainer)\n\t\t\t{\n\t\t\t\tDom.style(videoContainer, 'right', null);\n\t\t\t}\n\t\t}\n\t}\n\n\t#handleWindowResize(): void\n\t{\n\t\tthis.adjustBackgroundSize();\n\t}\n}\n","import { Reflection } from 'main.core';\nimport { SliderManager, SidePanel } from 'main.sidepanel';\nimport { Slider } from './slider';\n\nSliderManager.registerSliderClass(\n\t'BX.Intranet.Bitrix24.Slider',\n\t{\n\t\tstartPosition: 'bottom',\n\t\toverlayBgColor: '#00204E',\n\t\toverlayBgCallback: (state, slider: Slider) => {\n\t\t\tconst { intensity } = state;\n\t\t\tconst overlayBgColor = slider.getOverlayBgColor();\n\t\t\tconst overlayOpacity = slider.getOverlayOpacity();\n\t\t\tconst start = Math.round(overlayOpacity * intensity / 100).toString(16).padStart(2, 0);\n\t\t\tconst end = Math.round(100 * intensity / 100).toString(16).padStart(2, 0);\n\n\t\t\tif (slider.isMessengerSlider())\n\t\t\t{\n\t\t\t\treturn `linear-gradient(to bottom, ${overlayBgColor}${end} 0%, ${overlayBgColor}${end} 35px, ${overlayBgColor}${start} 145px, ${overlayBgColor}${end} 100%)`;\n\t\t\t}\n\n\t\t\treturn `linear-gradient(to bottom, ${overlayBgColor}${start} 0%, ${overlayBgColor}${end} 100%)`;\n\t\t},\n\t\toverlayOpacity: 52,\n\t\tautoOffset: false,\n\t\tcopyLinkLabel: true,\n\t\tnewWindowLabel: true,\n\t},\n\t{\n\t\tanimationDuration: 200,\n\t\tlabel: {\n\t\t\ttext: '',\n\t\t},\n\t},\n);\n\nconst namespace = Reflection.namespace('BX.Bitrix24');\n\nObject.defineProperty(namespace, 'Slider', {\n\tget: () => {\n\t\t// eslint-disable-next-line no-console\n\t\tconsole.warn('Don\\'t use BX.Bitrix24.Slider.');\n\n\t\treturn SidePanel.Instance;\n\t},\n});\n\nObject.defineProperty(namespace, 'PageSlider', {\n\tget: () => {\n\t\t// eslint-disable-next-line no-console\n\t\tconsole.warn('Don\\'t use BX.Bitrix24.PageSlider.');\n\n\t\treturn SidePanel.Instance;\n\t},\n});\n\nexport {\n\tSlider,\n};\n"],"names":["ChatMenuBar","constructor","slider","document","getElementById","console","warn","Dom","append","body","EventEmitter","subscribeOnce","bind","subscribe","event","sliderEvent","getData","getSlider","style","getContainer","getOverlayBgColor","SidePanel","Instance","getPreviousSlider","addClass","setZIndex","zIndex","reset","getMenu","menuManager","Reflection","getClass","getById","getZIndexComponent","getZIndex","requestAnimationFrame","removeClass","sliderZIndex","MENU_COLLAPSED_WIDTH","MENU_EXPANDED_WIDTH","Slider","BaseSlider","url","sliderOptions","options","Type","isPlainObject","isMessenger","startsWith","hideControls","autoOffset","applyHacks","window","innerWidth","documentElement","clientWidth","adjustBackgroundSize","Event","getRightBar","isMessengerSlider","stack","ZIndexManager","getOrAddStack","register","resetHacks","resetBackgroundSize","unbind","unregister","open","opened","isMessengerOpen","isVideoCallOpen","bringToFront","MessengerSlider","getInstance","isOpened","isMessengerEmbedded","LayoutManager","isEmbeddedMode","isMessengerOpenBeforeSlider","sliders","getOpenSliders","openSlider","CallManager","hasCurrentCall","getLeftBoundary","windowWidth","Browser","isMobile","getMinLeftBoundary","LeftMenu","isCollapsed","getRightBoundary","getTopBoundary","calculateOuterBoundary","top","right","rightBarWidth","offsetWidth","rightMargin","themePicker","theme","getAppliedTheme","resizable","video","adjustVideoSize","width","height","adjustImageSize","imgWidth","imgHeight","containerWidth","containerHeight","clientHeight","imgRatio","containerRatio","videoContainer","getVideoContainer","SliderManager","registerSliderClass","startPosition","overlayBgColor","overlayBgCallback","state","intensity","overlayOpacity","getOverlayOpacity","start","Math","round","toString","padStart","end","copyLinkLabel","newWindowLabel","animationDuration","label","text","namespace","Object","defineProperty","get"],"mappings":";;;;;;CAEwD;CAAA;CAAA;CAAA;CAAA;CAAA;CAAA;CAAA;CAAA;AAExD,CAAO,MAAMA,WAAW,CACxB;GAKCC,WAAW,CAACC,MAAc,EAC1B;KAAA;OAAA;;KAAA;OAAA;;KAAA;OAAA;;KAAA;OAAA;;KAAA;OAAA;;KAAA;OAAA;;KAAA;OAAA;OAAA,OALkB;;KAAI;OAAA;OAAA,OACI;;KAAI;OAAA;OAAA,OACX;;KAIlB,4CAAI,sBAAWA,MAAM;KAErB,4CAAI,4BAAcC,QAAQ,CAACC,cAAc,CAAC,cAAc,CAAC;KACzD,IAAI,yCAAC,IAAI,yBAAW,EACpB;OACCC,OAAO,CAACC,IAAI,CAAC,+BAA+B,CAAC;OAE7C;;KAGDC,aAAG,CAACC,MAAM,yCAAC,IAAI,2BAAaL,QAAQ,CAACM,IAAI,CAAC;KAE1CC,6BAAY,CAACC,aAAa,yCAAC,IAAI,qBAAU,8BAA8B,EAAE,4CAAI,0DAA4BC,IAAI,CAAC,IAAI,CAAC,CAAC;KACpHF,6BAAY,CAACG,SAAS,yCAAC,IAAI,qBAAU,4BAA4B,EAAE,4CAAI,8CAAsBD,IAAI,CAAC,IAAI,CAAC,CAAC;KACxGF,6BAAY,CAACG,SAAS,yCAAC,IAAI,qBAAU,4BAA4B,EAAE,4CAAI,8CAAsBD,IAAI,CAAC,IAAI,CAAC,CAAC;KACxGF,6BAAY,CAACG,SAAS,yCAAC,IAAI,qBAAU,kCAAkC,EAAE,4CAAI,0DAA4BD,IAAI,CAAC,IAAI,CAAC,CAAC;KACpHF,6BAAY,CAACG,SAAS,yCAAC,IAAI,qBAAU,4BAA4B,EAAE,4CAAI,8CAAsBD,IAAI,CAAC,IAAI,CAAC,CAAC;KAExGF,6BAAY,CAACG,SAAS,CAAC,4BAA4B,EAAGC,KAAgB,IAAK;OAC1E,MAAM,CAACC,WAAW,CAAC,GAAGD,KAAK,CAACE,OAAO,EAAE;OACrC,IAAID,WAAW,CAACE,SAAS,EAAE,6CAAK,IAAI,mBAAQ,EAC5C;SACCV,aAAG,CAACW,KAAK,CAAC,IAAI,CAACC,YAAY,EAAE,EAAE,YAAY,EAAE,4CAAI,oBAASC,iBAAiB,EAAE,CAAC;SAC9Eb,aAAG,CAACW,KAAK,CAAC,IAAI,CAACC,YAAY,EAAE,EAAE,YAAY,EAAG,oBAAmB,4CAAI,oBAASC,iBAAiB,EAAG,EAAC,CAAC;;MAErG,CAAC;KAEFV,6BAAY,CAACG,SAAS,CAAC,4BAA4B,EAAE,MAAM;OAC1D,IAAI,4CAAI,wBAAaQ,wBAAS,CAACC,QAAQ,CAACC,iBAAiB,EAAE,EAC3D;SACChB,aAAG,CAACW,KAAK,CAAC,IAAI,CAACC,YAAY,EAAE,EAAE,YAAY,EAAE,IAAI,CAAC;SAClDZ,aAAG,CAACW,KAAK,CAAC,IAAI,CAACC,YAAY,EAAE,EAAE,YAAY,EAAE,IAAI,CAAC;;MAEnD,CAAC;KAEFT,6BAAY,CAACG,SAAS,CAAC,0BAA0B,EAAE,MAAM;OACxD,IAAI,yCAAC,IAAI,mBAAQ,EACjB;SACC,4CAAI,sBAAW,IAAI;SACnBN,aAAG,CAACiB,QAAQ,CAAC,IAAI,CAACL,YAAY,EAAE,EAAE,UAAU,CAAC;;MAE9C,CAAC;;GAGHA,YAAY,GACZ;KACC,+CAAO,IAAI;;GAGZM,SAAS,CAACC,MAAc,EACxB;KACCnB,aAAG,CAACW,KAAK,CAAC,IAAI,CAACC,YAAY,EAAE,EAAE,SAAS,EAAEO,MAAM,CAAC;;GAGlDC,KAAK,GACL;KAAA;KACC,qBAAI,CAACC,OAAO,EAAE,qBAAd,cAAgBD,KAAK,EAAE;;GAGxBC,OAAO,GACP;;CAED;CACA;CACA;KACE,MAAMC,WAAW,GAAGC,oBAAU,CAACC,QAAQ,CAAC,iCAAiC,CAAC;KAC1E,IAAIF,WAAW,EACf;OACC,OAAOA,WAAW,CAACG,OAAO,CAAC,WAAW,CAAC;;KAGxC,OAAO,IAAI;;CA4Cb;CAAC,uCAxCA;GACCtB,6BAAY,CAACG,SAAS,CAAC,4CAAI,oBAASoB,kBAAkB,EAAE,EAAE,gBAAgB,EAAE,4CAAI,4CAAqBrB,IAAI,CAAC,IAAI,CAAC,CAAC;CACjH;CAAC,iCAGD;GACC,IAAI,CAACa,SAAS,CAAC,4CAAI,oBAASQ,kBAAkB,EAAE,CAACC,SAAS,EAAE,GAAG,CAAC,CAAC;GACjE3B,aAAG,CAACW,KAAK,CAAC,IAAI,CAACC,YAAY,EAAE,EAAE,SAAS,EAAE,OAAO,CAAC;GAClDZ,aAAG,CAACW,KAAK,CAAC,IAAI,CAACC,YAAY,EAAE,EAAE,YAAY,EAAE,IAAI,CAAC;GAClDZ,aAAG,CAACW,KAAK,CAAC,IAAI,CAACC,YAAY,EAAE,EAAE,YAAY,EAAE,IAAI,CAAC;GAElDgB,qBAAqB,CAAC,MAAM;KAC3B5B,aAAG,CAACiB,QAAQ,CAAC,IAAI,CAACL,YAAY,EAAE,EAAE,QAAQ,CAAC;IAC3C,CAAC;CACH;CAAC,iCAGD;GACC,IAAI,CAACQ,KAAK,EAAE;GACZpB,aAAG,CAAC6B,WAAW,CAAC,IAAI,CAACjB,YAAY,EAAE,EAAE,QAAQ,CAAC;CAC/C;CAAC,uCAGD;GACCZ,aAAG,CAACW,KAAK,CAAC,IAAI,CAACC,YAAY,EAAE,EAAE,SAAS,EAAE,MAAM,CAAC;GACjDZ,aAAG,CAACW,KAAK,CAAC,IAAI,CAACC,YAAY,EAAE,EAAE,YAAY,EAAE,IAAI,CAAC;GAClDZ,aAAG,CAACW,KAAK,CAAC,IAAI,CAACC,YAAY,EAAE,EAAE,YAAY,EAAE,IAAI,CAAC;CACnD;CAAC,iCAGD;GACC,IAAI,CAACQ,KAAK,EAAE;CACb;CAAC,gCAGD;GACC,MAAMU,YAAY,GAAG,4CAAI,oBAASJ,kBAAkB,EAAE,CAACC,SAAS,EAAE;GAElE,IAAI,CAACT,SAAS,CAACY,YAAY,GAAG,CAAC,CAAC;CACjC;;CCzHD,MAAMC,oBAAoB,GAAG,EAAE;CAC/B,MAAMC,mBAAmB,GAAG,GAAG;CAAC;CAAA;CAAA;CAAA;AAEhC,CAAO,MAAMC,MAAM,SAASC,qBAAU,CACtC;GAKCxC,WAAW,CAACyC,GAAW,EAAEC,aAA4B,EACrD;KACC,MAAMC,OAAsB,GAAGC,cAAI,CAACC,aAAa,CAACH,aAAa,CAAC,GAAG;OAAE,GAAGA;MAAe,GAAG,EAAE;KAC5F,MAAMI,WAAW,GAAGL,GAAG,CAACM,UAAU,CAAC,WAAW,CAAC;KAE/C,IAAID,WAAW,EACf;OACCH,OAAO,CAACK,YAAY,GAAG,KAAK;OAC5BL,OAAO,CAACM,UAAU,GAAG,KAAK;;KAG3B,KAAK,CAACR,GAAG,EAAEE,OAAO,CAAC;KAAC;OAAA;;KAAA;OAAA;OAAA,OAfO;;KAAI;OAAA;OAAA,OACJ;;KAgB3B,4CAAI,gCAAgBG,WAAW,GAAG,IAAI/C,WAAW,CAAC,IAAI,CAAC,GAAG,IAAI;KAC9D,4CAAI,sCAAmB,4CAAI,4CAAqBY,IAAI,CAAC,IAAI,CAAC;;GAG3DuC,UAAU,GACV;KACC,wCAAAX,MAAM,gDAAwBY,MAAM,CAACC,UAAU,GAAGlD,QAAQ,CAACmD,eAAe,CAACC,WAAW;KAEtF,IAAI,CAACC,oBAAoB,EAAE;KAC3BC,eAAK,CAAC7C,IAAI,CAACwC,MAAM,EAAE,QAAQ,0CAAE,IAAI,oCAAiB;KAElD,IAAI,IAAI,CAACM,WAAW,EAAE,IAAI,CAAC,IAAI,CAACC,iBAAiB,EAAE,EACnD;OACC,MAAMC,KAAK,GAAGC,uBAAa,CAACC,aAAa,CAAC3D,QAAQ,CAACM,IAAI,CAAC;OACxDmD,KAAK,CAACG,QAAQ,CAAC,IAAI,CAACL,WAAW,EAAE,CAAC;OAClCnD,aAAG,CAACiB,QAAQ,CAAC,IAAI,CAACkC,WAAW,EAAE,EAAE,uCAAuC,CAAC;;KAG1E,OAAO,IAAI;;GAGZM,UAAU,GACV;KACC,IAAI,CAACC,mBAAmB,EAAE;KAC1BR,eAAK,CAACS,MAAM,CAACd,MAAM,EAAE,QAAQ,0CAAE,IAAI,oCAAiB;KAEpD,IAAI,IAAI,CAACM,WAAW,EAAE,EACtB;OACC,MAAME,KAAK,GAAGC,uBAAa,CAACC,aAAa,CAAC3D,QAAQ,CAACM,IAAI,CAAC;OACxDmD,KAAK,CAACO,UAAU,CAAC,IAAI,CAACT,WAAW,EAAE,CAAC;OACpCnD,aAAG,CAAC6B,WAAW,CAAC,IAAI,CAACsB,WAAW,EAAE,EAAE,uCAAuC,CAAC;OAC5EnD,aAAG,CAACW,KAAK,CAAC,IAAI,CAACwC,WAAW,EAAE,EAAE,SAAS,EAAE,IAAI,CAAC,CAAC;;;;GAIjDU,IAAI,GACJ;KACC,MAAMC,MAAM,GAAG,KAAK,CAACD,IAAI,EAAE;KAC3B,IAAI,IAAI,CAACV,WAAW,EAAE,IAAIW,MAAM,EAChC;OACC,MAAMT,KAAK,GAAGC,uBAAa,CAACC,aAAa,CAAC3D,QAAQ,CAACM,IAAI,CAAC;OACxD,IAAI,CAAC,IAAI,CAACkD,iBAAiB,EAAE,IAAI,CAACnB,MAAM,CAAC8B,eAAe,EAAE,IAAI,CAAC9B,MAAM,CAAC+B,eAAe,EAAE,EACvF;SACCX,KAAK,CAACY,YAAY,CAAC,IAAI,CAACd,WAAW,EAAE,CAAC;;;KAIxC,OAAOW,MAAM;;GAGd,OAAOC,eAAe,GACtB;KACC,MAAMG,eAAe,GAAG3C,oBAAU,CAACC,QAAQ,CAAC,qCAAqC,CAAC;KAClF,IAAI0C,eAAe,IAAIA,eAAe,CAACC,WAAW,EAAE,CAACC,QAAQ,EAAE,EAC/D;OACC,OAAO,IAAI;;KAGZ,OAAOnC,MAAM,CAACoC,mBAAmB,EAAE;;GAGpC,OAAOA,mBAAmB,GAC1B;KACC,MAAMC,aAAa,GAAG/C,oBAAU,CAACC,QAAQ,CAAC,mCAAmC,CAAC;KAE9E,OAAO8C,aAAa,IAAIA,aAAa,CAACH,WAAW,EAAE,CAACI,cAAc,EAAE;;GAGrE,OAAOC,2BAA2B,CAAC7E,MAAc,EACjD;KACC,IAAIsC,MAAM,CAACoC,mBAAmB,EAAE,EAChC;OACC,OAAO,IAAI;;KAGZ,MAAMI,OAAO,GAAG3D,wBAAS,CAACC,QAAQ,CAAC2D,cAAc,EAAE;KACnD,KAAK,MAAMC,UAAU,IAAIF,OAAO,EAChC;OACC,IAAIE,UAAU,KAAKhF,MAAM,EACzB;SACC,OAAO,KAAK;;OAGb,IAAIgF,UAAU,YAAVA,UAAU,CAAEvB,iBAAiB,EAAE,EACnC;SACC,OAAO,IAAI;;;KAIb,OAAO,KAAK;;GAGbA,iBAAiB,GACjB;KACC,OAAO,4CAAI,kCAAkB,IAAI;;GAGlC,OAAOY,eAAe,GACtB;KACC,MAAMY,WAAW,GAAGrD,oBAAU,CAACC,QAAQ,CAAC,iCAAiC,CAAC;KAE1E,OAAOoD,WAAW,IAAIA,WAAW,CAACT,WAAW,EAAE,CAACU,cAAc,EAAE;;GAGjE1B,WAAW,GACX;KACC,OAAOvD,QAAQ,CAACC,cAAc,CAAC,WAAW,CAAC;;GAG5CiF,eAAe,GACf;KACC,MAAMC,WAAW,GAAGC,iBAAO,CAACC,QAAQ,EAAE,GAAGpC,MAAM,CAACC,UAAU,GAAGlD,QAAQ,CAACmD,eAAe,CAACC,WAAW;KACjG,IAAI+B,WAAW,GAAG,IAAI,EACtB;OACC,OAAO,IAAI,CAACG,kBAAkB,EAAE;;KAGjC,MAAMC,QAAQ,GAAG5D,oBAAU,CAACC,QAAQ,CAAC,sBAAsB,CAAC;KAE5D,OACC2D,QAAQ,YAARA,QAAQ,CAAEC,WAAW,EAAE,IAAI,IAAI,CAAChC,iBAAiB,EAAE,GAChDrB,oBAAoB,GACpBC,mBAAmB;;GAIxBqD,gBAAgB,GAChB;KACC,OAAO,CAAC;;GAGTC,cAAc,GACd;KACC,OAAO,CAAC;;GAGTC,sBAAsB,GACtB;KAAA;KACC,IAAI,IAAI,CAACnC,iBAAiB,EAAE,IAAInB,MAAM,CAACuC,2BAA2B,CAAC,IAAI,CAAC,IAAIvC,MAAM,CAAC+B,eAAe,EAAE,EACpG;OACC,OAAO;SACNwB,GAAG,EAAE,IAAI,CAACpC,iBAAiB,EAAE,GAAG,EAAE,GAAG,EAAE;SACvCqC,KAAK,EAAE;QACP;;KAGF,MAAMC,aAAa,GAAG,0BAAI,CAACvC,WAAW,EAAE,qBAAlB,kBAAoBwC,WAAW,KAAI,CAAC;KAC1D,MAAMC,WAAW,GAAG,wCAAA3D,MAAM,gDAAwByD,aAAa;KAE/D,OAAO;OACNF,GAAG,EAAE,EAAE;OACPC,KAAK,EAAEG;MACP;;GAGF3C,oBAAoB,GACpB;KACC,MAAM4C,WAAwB,GAAGtE,oBAAU,CAACC,QAAQ,CAAC,4CAA4C,CAAC;KAClG,IAAI,CAACqE,WAAW,EAChB;OACC;;KAGD,MAAMC,KAAK,GAAGD,WAAW,CAACE,eAAe,EAAE;KAC3C,IAAID,KAAK,IAAIA,KAAK,CAACE,SAAS,KAAK,IAAI,EACrC;OACC,IAAIF,KAAK,CAACG,KAAK,EACf;SACC,IAAI,CAACC,eAAe,EAAE;QACtB,MACI,IAAIJ,KAAK,CAACK,KAAK,GAAG,CAAC,IAAIL,KAAK,CAACM,MAAM,GAAG,CAAC,EAC5C;SACC,IAAI,CAACC,eAAe,CAACP,KAAK,CAACK,KAAK,EAAEL,KAAK,CAACM,MAAM,CAAC;;;;GAKlDC,eAAe,CAACC,QAAgB,EAAEC,SAAiB,EACnD;KACC,MAAMC,cAAc,GAAG5G,QAAQ,CAACmD,eAAe,CAACC,WAAW;KAC3D,MAAMyD,eAAe,GAAG7G,QAAQ,CAACmD,eAAe,CAAC2D,YAAY;KAE7D,MAAMC,QAAQ,GAAGJ,SAAS,GAAGD,QAAQ;KACrC,MAAMM,cAAc,GAAGH,eAAe,GAAGD,cAAc;KACvD,MAAML,KAAK,GAAGS,cAAc,GAAGD,QAAQ,GAAGF,eAAe,GAAGE,QAAQ,GAAGH,cAAc;KACrF,MAAMJ,MAAM,GAAGQ,cAAc,GAAGD,QAAQ,GAAGF,eAAe,GAAGD,cAAc,GAAGG,QAAQ;KAEtF3G,aAAG,CAACW,KAAK,CAACf,QAAQ,CAACM,IAAI,EAAE,qBAAqB,EAAG,GAAEiG,KAAM,MAAKC,MAAO,IAAG,CAAC;;GAG1EF,eAAe,GACf;KACC,MAAML,WAAwB,GAAGtE,oBAAU,CAACC,QAAQ,CAAC,4CAA4C,CAAC;KAClG,IAAI,CAACqE,WAAW,EAChB;OACC;;KAGD,MAAMgB,cAA2B,GAAGhB,WAAW,CAACiB,iBAAiB,EAAE;KACnE,IAAID,cAAc,EAClB;OACC7G,aAAG,CAACW,KAAK,CAACkG,cAAc,EAAE,OAAO,EAAG,GAAEhE,MAAM,CAACC,UAAU,GAAGlD,QAAQ,CAACmD,eAAe,CAACC,WAAY,IAAG,CAAC;;;GAIrGU,mBAAmB,GACnB;KACC1D,aAAG,CAACW,KAAK,CAACf,QAAQ,CAACM,IAAI,EAAE,qBAAqB,EAAE,IAAI,CAAC;KAErD,MAAM2F,WAAwB,GAAGtE,oBAAU,CAACC,QAAQ,CAAC,4CAA4C,CAAC;KAClG,IAAIqE,WAAW,EACf;OACC,MAAMgB,cAA2B,GAAGhB,WAAW,CAACiB,iBAAiB,EAAE;OACnE,IAAID,cAAc,EAClB;SACC7G,aAAG,CAACW,KAAK,CAACkG,cAAc,EAAE,OAAO,EAAE,IAAI,CAAC;;;;CAS5C;CAAC,gCAHA;GACC,IAAI,CAAC5D,oBAAoB,EAAE;CAC5B;CAAC,sBAlPWhB,MAAM;GAAA;GAAA,OAIoB;CAAI;;ACR3C8E,6BAAa,CAACC,mBAAmB,CAChC,6BAA6B,EAC7B;GACCC,aAAa,EAAE,QAAQ;GACvBC,cAAc,EAAE,SAAS;GACzBC,iBAAiB,EAAE,CAACC,KAAK,EAAEzH,MAAc,KAAK;KAC7C,MAAM;OAAE0H;MAAW,GAAGD,KAAK;KAC3B,MAAMF,cAAc,GAAGvH,MAAM,CAACkB,iBAAiB,EAAE;KACjD,MAAMyG,cAAc,GAAG3H,MAAM,CAAC4H,iBAAiB,EAAE;KACjD,MAAMC,KAAK,GAAGC,IAAI,CAACC,KAAK,CAACJ,cAAc,GAAGD,SAAS,GAAG,GAAG,CAAC,CAACM,QAAQ,CAAC,EAAE,CAAC,CAACC,QAAQ,CAAC,CAAC,EAAE,CAAC,CAAC;KACtF,MAAMC,GAAG,GAAGJ,IAAI,CAACC,KAAK,CAAC,GAAG,GAAGL,SAAS,GAAG,GAAG,CAAC,CAACM,QAAQ,CAAC,EAAE,CAAC,CAACC,QAAQ,CAAC,CAAC,EAAE,CAAC,CAAC;KAEzE,IAAIjI,MAAM,CAACyD,iBAAiB,EAAE,EAC9B;OACC,OAAQ,8BAA6B8D,cAAe,GAAEW,GAAI,QAAOX,cAAe,GAAEW,GAAI,UAASX,cAAe,GAAEM,KAAM,WAAUN,cAAe,GAAEW,GAAI,QAAO;;KAG7J,OAAQ,8BAA6BX,cAAe,GAAEM,KAAM,QAAON,cAAe,GAAEW,GAAI,QAAO;IAC/F;GACDP,cAAc,EAAE,EAAE;GAClB3E,UAAU,EAAE,KAAK;GACjBmF,aAAa,EAAE,IAAI;GACnBC,cAAc,EAAE;CACjB,CAAC,EACD;GACCC,iBAAiB,EAAE,GAAG;GACtBC,KAAK,EAAE;KACNC,IAAI,EAAE;;CAER,CAAC,CACD;CAED,MAAMC,SAAS,GAAG5G,oBAAU,CAAC4G,SAAS,CAAC,aAAa,CAAC;CAErDC,MAAM,CAACC,cAAc,CAACF,SAAS,EAAE,QAAQ,EAAE;GAC1CG,GAAG,EAAE,MAAM;;KAEVxI,OAAO,CAACC,IAAI,CAAC,gCAAgC,CAAC;KAE9C,OAAOe,wBAAS,CAACC,QAAQ;;CAE3B,CAAC,CAAC;CAEFqH,MAAM,CAACC,cAAc,CAACF,SAAS,EAAE,YAAY,EAAE;GAC9CG,GAAG,EAAE,MAAM;;KAEVxI,OAAO,CAACC,IAAI,CAAC,oCAAoC,CAAC;KAElD,OAAOe,wBAAS,CAACC,QAAQ;;CAE3B,CAAC,CAAC;;;;;;;;"}