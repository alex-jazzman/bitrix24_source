this.BX=this.BX||{};this.BX.Intranet=this.BX.Intranet||{};(function(e,t,s,i){"use strict";var r=babelHelpers.classPrivateFieldLooseKey("slider");var n=babelHelpers.classPrivateFieldLooseKey("container");var a=babelHelpers.classPrivateFieldLooseKey("loaded");var l=babelHelpers.classPrivateFieldLooseKey("handleSliderOpenStartOnce");var o=babelHelpers.classPrivateFieldLooseKey("handleSliderOpening");var d=babelHelpers.classPrivateFieldLooseKey("handleSliderClosing");var c=babelHelpers.classPrivateFieldLooseKey("handleSliderCloseComplete");var b=babelHelpers.classPrivateFieldLooseKey("handleSliderDestroy");var u=babelHelpers.classPrivateFieldLooseKey("handleZIndexChange");class h{constructor(e){Object.defineProperty(this,u,{value:P});Object.defineProperty(this,b,{value:m});Object.defineProperty(this,c,{value:B});Object.defineProperty(this,d,{value:v});Object.defineProperty(this,o,{value:p});Object.defineProperty(this,l,{value:g});Object.defineProperty(this,r,{writable:true,value:null});Object.defineProperty(this,n,{writable:true,value:null});Object.defineProperty(this,a,{writable:true,value:false});babelHelpers.classPrivateFieldLooseBase(this,r)[r]=e;babelHelpers.classPrivateFieldLooseBase(this,n)[n]=document.getElementById("im-chat-menu");if(!babelHelpers.classPrivateFieldLooseBase(this,n)[n]){console.warn("ChatMenu: container not found");return}t.Dom.append(babelHelpers.classPrivateFieldLooseBase(this,n)[n],document.body);s.EventEmitter.subscribeOnce(babelHelpers.classPrivateFieldLooseBase(this,r)[r],"SidePanel.Slider:onOpenStart",babelHelpers.classPrivateFieldLooseBase(this,l)[l].bind(this));s.EventEmitter.subscribe(babelHelpers.classPrivateFieldLooseBase(this,r)[r],"SidePanel.Slider:onOpening",babelHelpers.classPrivateFieldLooseBase(this,o)[o].bind(this));s.EventEmitter.subscribe(babelHelpers.classPrivateFieldLooseBase(this,r)[r],"SidePanel.Slider:onClosing",babelHelpers.classPrivateFieldLooseBase(this,d)[d].bind(this));s.EventEmitter.subscribe(babelHelpers.classPrivateFieldLooseBase(this,r)[r],"SidePanel.Slider:onCloseComplete",babelHelpers.classPrivateFieldLooseBase(this,c)[c].bind(this));s.EventEmitter.subscribe(babelHelpers.classPrivateFieldLooseBase(this,r)[r],"SidePanel.Slider:onDestroy",babelHelpers.classPrivateFieldLooseBase(this,b)[b].bind(this));s.EventEmitter.subscribe("SidePanel.Slider:onOpening",(e=>{const[s]=e.getData();if(s.getSlider()!==babelHelpers.classPrivateFieldLooseBase(this,r)[r]){t.Dom.style(this.getContainer(),"background",babelHelpers.classPrivateFieldLooseBase(this,r)[r].getOverlayBgColor());t.Dom.style(this.getContainer(),"box-shadow",`0px 0px 10px 3px ${babelHelpers.classPrivateFieldLooseBase(this,r)[r].getOverlayBgColor()}`)}}));s.EventEmitter.subscribe("SidePanel.Slider:onClosing",(()=>{if(babelHelpers.classPrivateFieldLooseBase(this,r)[r]===i.SidePanel.Instance.getPreviousSlider()){t.Dom.style(this.getContainer(),"background",null);t.Dom.style(this.getContainer(),"box-shadow",null)}}));s.EventEmitter.subscribe("IM.Layout:onLayoutChange",(()=>{if(!babelHelpers.classPrivateFieldLooseBase(this,a)[a]){babelHelpers.classPrivateFieldLooseBase(this,a)[a]=true;t.Dom.addClass(this.getContainer(),"--loaded")}}))}getContainer(){return babelHelpers.classPrivateFieldLooseBase(this,n)[n]}setZIndex(e){t.Dom.style(this.getContainer(),"z-index",e)}reset(){var e;(e=this.getMenu())==null?void 0:e.reset()}getMenu(){const e=t.Reflection.getClass("BX.Main.interfaceButtonsManager");if(e){return e.getById("chat-menu")}return null}}function g(){s.EventEmitter.subscribe(babelHelpers.classPrivateFieldLooseBase(this,r)[r].getZIndexComponent(),"onZIndexChange",babelHelpers.classPrivateFieldLooseBase(this,u)[u].bind(this))}function p(){this.setZIndex(babelHelpers.classPrivateFieldLooseBase(this,r)[r].getZIndexComponent().getZIndex()+1);t.Dom.style(this.getContainer(),"display","block");t.Dom.style(this.getContainer(),"background",null);t.Dom.style(this.getContainer(),"box-shadow",null);requestAnimationFrame((()=>{t.Dom.addClass(this.getContainer(),"--open")}))}function v(){this.reset();t.Dom.removeClass(this.getContainer(),"--open")}function B(){t.Dom.style(this.getContainer(),"display","none");t.Dom.style(this.getContainer(),"background",null);t.Dom.style(this.getContainer(),"box-shadow",null)}function m(){this.reset()}function P(){const e=babelHelpers.classPrivateFieldLooseBase(this,r)[r].getZIndexComponent().getZIndex();this.setZIndex(e+1)}const f=65;const y=240;var S=babelHelpers.classPrivateFieldLooseKey("onWindowResize");var L=babelHelpers.classPrivateFieldLooseKey("chatMenuBar");var C=babelHelpers.classPrivateFieldLooseKey("verticalScrollWidth");var F=babelHelpers.classPrivateFieldLooseKey("handleWindowResize");class H extends i.Slider{constructor(e,s){const i=t.Type.isPlainObject(s)?{...s}:{};const r=e.startsWith("im:slider");if(r){i.hideControls=false;i.autoOffset=false}super(e,i);Object.defineProperty(this,F,{value:x});Object.defineProperty(this,S,{writable:true,value:null});Object.defineProperty(this,L,{writable:true,value:null});babelHelpers.classPrivateFieldLooseBase(this,L)[L]=r?new h(this):null;babelHelpers.classPrivateFieldLooseBase(this,S)[S]=babelHelpers.classPrivateFieldLooseBase(this,F)[F].bind(this)}applyHacks(){babelHelpers.classPrivateFieldLooseBase(H,C)[C]=window.innerWidth-document.documentElement.clientWidth;this.adjustBackgroundSize();t.Event.bind(window,"resize",babelHelpers.classPrivateFieldLooseBase(this,S)[S]);if(this.getRightBar()&&!this.isMessengerSlider()){const e=t.ZIndexManager.getOrAddStack(document.body);e.register(this.getRightBar());t.Dom.addClass(this.getRightBar(),"--ui-context-edge-dark")}return true}resetHacks(){this.resetBackgroundSize();t.Event.unbind(window,"resize",babelHelpers.classPrivateFieldLooseBase(this,S)[S]);if(this.getRightBar()){const e=t.ZIndexManager.getOrAddStack(document.body);e.unregister(this.getRightBar());t.Dom.removeClass(this.getRightBar(),"--ui-context-edge-dark");t.Dom.style(this.getRightBar(),"z-index",null)}}open(){const e=super.open();if(this.getRightBar()&&e){const e=t.ZIndexManager.getOrAddStack(document.body);if(!this.isMessengerSlider()&&!H.isMessengerOpen()){e.bringToFront(this.getRightBar())}}return e}static isMessengerOpen(){const e=t.Reflection.getClass("BX.Messenger.v2.Lib.MessengerSlider");if(e&&e.getInstance().isOpened()){return true}return H.isMessengerEmbedded()}static isMessengerEmbedded(){const e=t.Reflection.getClass("BX.Messenger.v2.Lib.LayoutManager");return e&&e.getInstance().isEmbeddedMode()}static isMessengerOpenBeforeSlider(e){if(H.isMessengerEmbedded()){return true}const t=i.SidePanel.Instance.getOpenSliders();for(const s of t){if(s===e){return false}if(s!=null&&s.isMessengerSlider()){return true}}return false}isMessengerSlider(){return babelHelpers.classPrivateFieldLooseBase(this,L)[L]!==null}getRightBar(){return document.getElementById("right-bar")}getLeftBoundary(){const e=t.Browser.isMobile()?window.innerWidth:document.documentElement.clientWidth;if(e<1260){return this.getMinLeftBoundary()}const s=t.Reflection.getClass("BX.Intranet.LeftMenu");return s!=null&&s.isCollapsed()||this.isMessengerSlider()?f:y}getRightBoundary(){return 0}getTopBoundary(){return 0}calculateOuterBoundary(){var e;if(this.isMessengerSlider()||H.isMessengerOpenBeforeSlider(this)){return{top:this.isMessengerSlider()?58:18,right:18}}const t=((e=this.getRightBar())==null?void 0:e.offsetWidth)||0;const s=babelHelpers.classPrivateFieldLooseBase(H,C)[C]+t;return{top:18,right:s}}adjustBackgroundSize(){const e=t.Reflection.getClass("BX.Intranet.Bitrix24.ThemePicker.Singleton");if(!e){return}const s=e.getAppliedTheme();if(s&&s.resizable===true){if(s.video){this.adjustVideoSize()}else if(s.width>0&&s.height>0){this.adjustImageSize(s.width,s.height)}}}adjustImageSize(e,s){const i=document.documentElement.clientWidth;const r=document.documentElement.clientHeight;const n=s/e;const a=r/i;const l=a>n?r/n:i;const o=a>n?r:i*n;t.Dom.style(document.body,"--air-theme-bg-size",`${l}px ${o}px`)}adjustVideoSize(){const e=t.Reflection.getClass("BX.Intranet.Bitrix24.ThemePicker.Singleton");if(!e){return}const s=e.getVideoContainer();if(s){t.Dom.style(s,"right",`${window.innerWidth-document.documentElement.clientWidth}px`)}}resetBackgroundSize(){t.Dom.style(document.body,"--air-theme-bg-size",null);const e=t.Reflection.getClass("BX.Intranet.Bitrix24.ThemePicker.Singleton");if(e){const s=e.getVideoContainer();if(s){t.Dom.style(s,"right",null)}}}}function x(){this.adjustBackgroundSize()}Object.defineProperty(H,C,{writable:true,value:null});i.SliderManager.registerSliderClass("BX.Intranet.Bitrix24.Slider",{startPosition:"bottom",overlayBgColor:"#00204E",overlayBgCallback:(e,t)=>{const{intensity:s}=e;const i=t.getOverlayBgColor();const r=t.getOverlayOpacity();const n=Math.round(r*s/100).toString(16).padStart(2,0);const a=Math.round(100*s/100).toString(16).padStart(2,0);if(t.isMessengerSlider()){return`linear-gradient(to bottom, ${i}${a} 0%, ${i}${a} 35px, ${i}${n} 145px, ${i}${a} 100%)`}return`linear-gradient(to bottom, ${i}${n} 0%, ${i}${a} 100%)`},overlayOpacity:52,autoOffset:false},{animationDuration:200,label:{text:"",bgColor:"#0075FF"}});const O=t.Reflection.namespace("BX.Bitrix24");Object.defineProperty(O,"Slider",{get:()=>{console.warn("Don't use BX.Bitrix24.Slider.");return i.SidePanel.Instance}});Object.defineProperty(O,"PageSlider",{get:()=>{console.warn("Don't use BX.Bitrix24.PageSlider.");return i.SidePanel.Instance}});e.Slider=H})(this.BX.Intranet.Bitrix24=this.BX.Intranet.Bitrix24||{},BX,BX.Event,BX.SidePanel);
//# sourceMappingURL=air-sidepanel.bundle.map.js