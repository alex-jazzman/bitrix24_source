this.BX=this.BX||{};this.BX.Intranet=this.BX.Intranet||{};(function(e,t,s,i){"use strict";var n=babelHelpers.classPrivateFieldLooseKey("slider");var r=babelHelpers.classPrivateFieldLooseKey("container");var l=babelHelpers.classPrivateFieldLooseKey("loaded");var a=babelHelpers.classPrivateFieldLooseKey("handleSliderOpenStartOnce");var o=babelHelpers.classPrivateFieldLooseKey("handleSliderOpening");var d=babelHelpers.classPrivateFieldLooseKey("handleSliderClosing");var c=babelHelpers.classPrivateFieldLooseKey("handleSliderCloseComplete");var b=babelHelpers.classPrivateFieldLooseKey("handleSliderDestroy");var u=babelHelpers.classPrivateFieldLooseKey("handleZIndexChange");class h{constructor(e){Object.defineProperty(this,u,{value:P});Object.defineProperty(this,b,{value:m});Object.defineProperty(this,c,{value:B});Object.defineProperty(this,d,{value:v});Object.defineProperty(this,o,{value:p});Object.defineProperty(this,a,{value:g});Object.defineProperty(this,n,{writable:true,value:null});Object.defineProperty(this,r,{writable:true,value:null});Object.defineProperty(this,l,{writable:true,value:false});babelHelpers.classPrivateFieldLooseBase(this,n)[n]=e;babelHelpers.classPrivateFieldLooseBase(this,r)[r]=document.getElementById("im-chat-menu");if(!babelHelpers.classPrivateFieldLooseBase(this,r)[r]){console.warn("ChatMenu: container not found");return}t.Dom.append(babelHelpers.classPrivateFieldLooseBase(this,r)[r],document.body);s.EventEmitter.subscribeOnce(babelHelpers.classPrivateFieldLooseBase(this,n)[n],"SidePanel.Slider:onOpenStart",babelHelpers.classPrivateFieldLooseBase(this,a)[a].bind(this));s.EventEmitter.subscribe(babelHelpers.classPrivateFieldLooseBase(this,n)[n],"SidePanel.Slider:onOpening",babelHelpers.classPrivateFieldLooseBase(this,o)[o].bind(this));s.EventEmitter.subscribe(babelHelpers.classPrivateFieldLooseBase(this,n)[n],"SidePanel.Slider:onClosing",babelHelpers.classPrivateFieldLooseBase(this,d)[d].bind(this));s.EventEmitter.subscribe(babelHelpers.classPrivateFieldLooseBase(this,n)[n],"SidePanel.Slider:onCloseComplete",babelHelpers.classPrivateFieldLooseBase(this,c)[c].bind(this));s.EventEmitter.subscribe(babelHelpers.classPrivateFieldLooseBase(this,n)[n],"SidePanel.Slider:onDestroy",babelHelpers.classPrivateFieldLooseBase(this,b)[b].bind(this));if(!this.canUseBlurry()){s.EventEmitter.subscribe("SidePanel.Slider:onOpening",(e=>{const[s]=e.getData();if(s.getSlider()!==babelHelpers.classPrivateFieldLooseBase(this,n)[n]){t.Dom.style(this.getContainer(),"visibility","hidden")}}));s.EventEmitter.subscribe("SidePanel.Slider:onCloseComplete",(()=>{if(babelHelpers.classPrivateFieldLooseBase(this,n)[n]===i.SidePanel.Instance.getTopSlider()){t.Dom.style(this.getContainer(),"visibility",null)}}))}s.EventEmitter.subscribe("IM.Layout:onLayoutChange",(()=>{if(!babelHelpers.classPrivateFieldLooseBase(this,l)[l]){babelHelpers.classPrivateFieldLooseBase(this,l)[l]=true;t.Dom.addClass(this.getContainer(),"--loaded")}}))}canUseBlurry(){return!t.Dom.hasClass(document.documentElement,"bx-integrated-gpu")}getContainer(){return babelHelpers.classPrivateFieldLooseBase(this,r)[r]}setZIndex(e){t.Dom.style(this.getContainer(),"z-index",e)}reset(){var e;(e=this.getMenu())==null?void 0:e.reset()}getMenu(){const e=t.Reflection.getClass("BX.Main.interfaceButtonsManager");if(e){return e.getById("chat-menu")}return null}}function g(){s.EventEmitter.subscribe(babelHelpers.classPrivateFieldLooseBase(this,n)[n].getZIndexComponent(),"onZIndexChange",babelHelpers.classPrivateFieldLooseBase(this,u)[u].bind(this))}function p(){this.setZIndex(babelHelpers.classPrivateFieldLooseBase(this,n)[n].getZIndexComponent().getZIndex()+1);t.Dom.style(this.getContainer(),"display","block");t.Dom.style(this.getContainer(),"visibility",null);requestAnimationFrame((()=>{t.Dom.addClass(this.getContainer(),"--open")}))}function v(){this.reset();t.Dom.removeClass(this.getContainer(),"--open")}function B(){t.Dom.style(this.getContainer(),"display","none");t.Dom.style(this.getContainer(),"visibility",null)}function m(){this.reset()}function P(){const e=babelHelpers.classPrivateFieldLooseBase(this,n)[n].getZIndexComponent().getZIndex();this.setZIndex(e+1)}const y=65;const f=240;var S=babelHelpers.classPrivateFieldLooseKey("onWindowResize");var L=babelHelpers.classPrivateFieldLooseKey("chatMenuBar");var F=babelHelpers.classPrivateFieldLooseKey("verticalScrollWidth");var H=babelHelpers.classPrivateFieldLooseKey("handleWindowResize");class C extends i.Slider{constructor(e,s){const i=t.Type.isPlainObject(s)?{...s}:{};const n=e.startsWith("im:slider");if(n){i.hideControls=false;i.autoOffset=false;const e=!t.Dom.hasClass(document.documentElement,"bx-integrated-gpu");if(!e){i.overlayOpacity=85}}super(e,i);Object.defineProperty(this,H,{value:O});Object.defineProperty(this,S,{writable:true,value:null});Object.defineProperty(this,L,{writable:true,value:null});babelHelpers.classPrivateFieldLooseBase(this,L)[L]=n?new h(this):null;babelHelpers.classPrivateFieldLooseBase(this,S)[S]=babelHelpers.classPrivateFieldLooseBase(this,H)[H].bind(this)}applyHacks(){babelHelpers.classPrivateFieldLooseBase(C,F)[F]=window.innerWidth-document.documentElement.clientWidth;this.adjustBackgroundSize();t.Event.bind(window,"resize",babelHelpers.classPrivateFieldLooseBase(this,S)[S]);if(this.getRightBar()&&!this.isMessengerSlider()){const e=t.ZIndexManager.getOrAddStack(document.body);e.register(this.getRightBar())}return true}resetHacks(){this.resetBackgroundSize();t.Event.unbind(window,"resize",babelHelpers.classPrivateFieldLooseBase(this,S)[S]);if(this.getRightBar()){const e=t.ZIndexManager.getOrAddStack(document.body);e.unregister(this.getRightBar());t.Dom.style(this.getRightBar(),"z-index",null)}}open(){const e=super.open();if(this.getRightBar()&&e){const e=t.ZIndexManager.getOrAddStack(document.body);if(!this.isMessengerSlider()&&!C.isMessengerOpen()){e.bringToFront(this.getRightBar())}}return e}static isMessengerOpen(){const e=t.Reflection.getClass("BX.Messenger.v2.Lib.MessengerSlider");if(e&&e.getInstance().isOpened()){return true}const s=t.Reflection.getClass("BX.Messenger.v2.Lib.LayoutManager");return s&&s.getInstance().isEmbeddedMode()}isMessengerSlider(){return babelHelpers.classPrivateFieldLooseBase(this,L)[L]!==null}getRightBar(){return document.getElementById("right-bar")}getLeftBoundary(){const e=t.Browser.isMobile()?window.innerWidth:document.documentElement.clientWidth;if(e<1260){return this.getMinLeftBoundary()}const s=t.Reflection.getClass("BX.Intranet.LeftMenu");return s!=null&&s.isCollapsed()||this.isMessengerSlider()?y:f}getRightBoundary(){return 0}getTopBoundary(){return 0}calculateOuterBoundary(){var e;if(this.isMessengerSlider()||C.isMessengerOpen()){return{top:this.isMessengerSlider()?58:18,right:18}}const t=((e=this.getRightBar())==null?void 0:e.offsetWidth)||0;const s=babelHelpers.classPrivateFieldLooseBase(C,F)[F]+t;return{top:18,right:s}}adjustBackgroundSize(){const e=t.Reflection.getClass("BX.Intranet.Bitrix24.ThemePicker.Singleton");if(!e){return}const s=e.getAppliedTheme();if(s&&s.resizable===true){if(s.video){this.adjustVideoSize()}else if(s.width>0&&s.height>0){this.adjustImageSize(s.width,s.height)}}}adjustImageSize(e,s){const i=document.documentElement.clientWidth;const n=document.documentElement.clientHeight;const r=s/e;const l=n/i;const a=l>r?n/r:i;const o=l>r?n:i*r;t.Dom.style(document.body,"background-size",`${a}px ${o}px`)}adjustVideoSize(){const e=t.Reflection.getClass("BX.Intranet.Bitrix24.ThemePicker.Singleton");if(!e){return}const s=e.getVideoContainer();if(s){t.Dom.style(s,"right",`${window.innerWidth-document.documentElement.clientWidth}px`)}}resetBackgroundSize(){t.Dom.style(document.body,"background-size",null);const e=t.Reflection.getClass("BX.Intranet.Bitrix24.ThemePicker.Singleton");if(e){const s=e.getVideoContainer();if(s){t.Dom.style(s,"right",null)}}}}function O(){this.adjustBackgroundSize()}Object.defineProperty(C,F,{writable:true,value:null});i.SliderManager.registerSliderClass("BX.Intranet.Bitrix24.Slider",{startPosition:"bottom",overlayBgColor:"#00204E",overlayOpacity:52},{animationDuration:200,label:{text:"",bgColor:"#0075FF"}});const I=t.Reflection.namespace("BX.Bitrix24");Object.defineProperty(I,"Slider",{get:()=>{console.warn("Don't use BX.Bitrix24.Slider.");return i.SidePanel.Instance}});Object.defineProperty(I,"PageSlider",{get:()=>{console.warn("Don't use BX.Bitrix24.PageSlider.");return i.SidePanel.Instance}});e.Slider=C})(this.BX.Intranet.Bitrix24=this.BX.Intranet.Bitrix24||{},BX,BX.Event,BX.SidePanel);
//# sourceMappingURL=air-sidepanel.bundle.map.js