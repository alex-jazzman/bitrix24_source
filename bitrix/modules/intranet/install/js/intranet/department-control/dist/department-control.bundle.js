this.BX=this.BX||{},function(e,t,s,a){"use strict";let l,i,r,o,n=e=>e;var d=babelHelpers.classPrivateFieldLooseKey("tagSelector"),c=babelHelpers.classPrivateFieldLooseKey("rootDepartment"),b=babelHelpers.classPrivateFieldLooseKey("departmentList"),p=babelHelpers.classPrivateFieldLooseKey("title"),v=babelHelpers.classPrivateFieldLooseKey("description"),g=babelHelpers.classPrivateFieldLooseKey("initTagSelector"),h=babelHelpers.classPrivateFieldLooseKey("isRootItem");class u extends a.EventEmitter{constructor(e){var s,a;super(),Object.defineProperty(this,h,{value:L}),Object.defineProperty(this,g,{value:T}),Object.defineProperty(this,d,{writable:!0,value:void 0}),Object.defineProperty(this,c,{writable:!0,value:void 0}),Object.defineProperty(this,b,{writable:!0,value:void 0}),Object.defineProperty(this,p,{writable:!0,value:void 0}),Object.defineProperty(this,v,{writable:!0,value:void 0}),this.setEventNamespace("BX.Intranet.DepartmentControl"),babelHelpers.classPrivateFieldLooseBase(this,c)[c]=t.Type.isNil(null==e?void 0:e.rootDepartment)?null:null==e?void 0:e.rootDepartment,babelHelpers.classPrivateFieldLooseBase(this,b)[b]=t.Type.isArray(null==e?void 0:e.departmentList)?null==e?void 0:e.departmentList:[],babelHelpers.classPrivateFieldLooseBase(this,p)[p]=null!=(s=e.title)?s:t.Loc.getMessage("INTRANET_INVITE_DIALOG_DEPARTMENT_CONTROL_LABEL"),babelHelpers.classPrivateFieldLooseBase(this,v)[v]=null!=(a=e.description)?a:t.Loc.getMessage("INTRANET_INVITE_DIALOG_DEPARTMENT_CONTROL_DESCRIPTION"),babelHelpers.classPrivateFieldLooseBase(this,d)[d]=babelHelpers.classPrivateFieldLooseBase(this,g)[g](e)}getDefaultItems(){let e=[];if(!t.Type.isNil(babelHelpers.classPrivateFieldLooseBase(this,c)[c])&&t.Type.isArray(babelHelpers.classPrivateFieldLooseBase(this,b)[b])&&babelHelpers.classPrivateFieldLooseBase(this,b)[b].length>0)e=babelHelpers.classPrivateFieldLooseBase(this,b)[b].map(e=>({id:parseInt(e.id,10),avatar:"/bitrix/js/humanresources/entity-selector/src/images/company.svg",entityId:"structure-node",textColor:"#006E7C",bgColor:"#DDF6F9",title:e.name,customData:{accessCode:e.accessCode}}));else if(!t.Type.isNil(babelHelpers.classPrivateFieldLooseBase(this,c)[c])){const t={id:parseInt(babelHelpers.classPrivateFieldLooseBase(this,c)[c].id,10),avatar:"/bitrix/js/humanresources/entity-selector/src/images/company.svg",entityId:"structure-node",textColor:"#006E7C",bgColor:"#DDF6F9",title:babelHelpers.classPrivateFieldLooseBase(this,c)[c].name,customData:{accessCode:babelHelpers.classPrivateFieldLooseBase(this,c)[c].accessCode}};e.push(t)}return e}reset(){babelHelpers.classPrivateFieldLooseBase(this,d)[d].removeTags(),this.getDefaultItems().forEach(e=>{babelHelpers.classPrivateFieldLooseBase(this,d)[d].addTag(e)})}renderTo(e){t.Dom.append(this.render(),e)}getValues(){const e=babelHelpers.classPrivateFieldLooseBase(this,d)[d].getDialog().getSelectedItems(),t=[];return e.forEach(e=>{const s=parseInt(null==e?void 0:e.id,10);s>0&&t.push(s)}),t}render(){const e=t.Tag.render(l||(l=n`<label class="department-control__dialog-title">${0}</label>`),babelHelpers.classPrivateFieldLooseBase(this,p)[p]),s=t.Tag.render(i||(i=n`<div class="department-control__dialog-description">${0}</div>`),babelHelpers.classPrivateFieldLooseBase(this,v)[v]),a=t.Tag.render(r||(r=n`<div></div>`));return babelHelpers.classPrivateFieldLooseBase(this,d)[d].renderTo(a),t.Tag.render(o||(o=n`<div>${0}${0}${0}</div>`),e,s,a)}onAfterTagChange(e){const t=e.getTarget();this.emit("onChange",{tags:t.getTags()})}}function T(e){return new s.TagSelector({tagTextColor:"#1E8D36",tagBgColor:"#D4FDB0",items:this.getDefaultItems(),events:{onBeforeTagRemove:e=>{const t=e.getTarget(),{tag:s}=e.getData();1===t.getTags().length&&babelHelpers.classPrivateFieldLooseBase(this,h)[h](s)&&e.preventDefault()},onAfterTagAdd:this.onAfterTagChange.bind(this),onAfterTagRemove:this.onAfterTagChange.bind(this)},dialogOptions:{context:"INVITATION_STRUCTURE",width:350,enableSearch:!0,multiple:!0,entities:[{id:"structure-node",options:{selectMode:"departmentsOnly",restricted:"inviteUser"}}],events:{"Item:onBeforeDeselect":e=>{const t=e.getTarget().getSelectedItems();1===t.length&&babelHelpers.classPrivateFieldLooseBase(this,h)[h](t[0])&&e.preventDefault()},"Item:onDeselect":t=>{const s=t.getTarget();if(s.getSelectedItems().length<=0){const t=s.getItem(["structure-node",null==e?void 0:e.rootDepartment.id]);null==t||t.select()}},onLoad:e=>{e.getTarget().selectTab("structure-departments-tab")}}}})}function L(e){var s,a;const l=t.Type.isNil(null==e?void 0:e.id)?null:parseInt(null==e?void 0:e.id,10),i=t.Type.isNil(null==(s=babelHelpers.classPrivateFieldLooseBase(this,c)[c])?void 0:s.id)?null:parseInt(null==(a=babelHelpers.classPrivateFieldLooseBase(this,c)[c])?void 0:a.id,10);return!t.Type.isNil(l)&&!t.Type.isNil(i)&&l===i}e.default=u}(this.BX.Intranet=this.BX.Intranet||{},BX,BX.UI.EntitySelector,BX.Event);
//# sourceMappingURL=department-control.bundle.js.map
