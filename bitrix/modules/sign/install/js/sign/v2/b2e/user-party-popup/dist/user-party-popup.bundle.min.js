this.BX=this.BX||{};this.BX.Sign=this.BX.Sign||{};this.BX.Sign.V2=this.BX.Sign.V2||{};(function(e,s,a,t,l,r){"use strict";let i=e=>e,o,p,b,n,d,c,u,v,h,P;const m=20;var L=babelHelpers.classPrivateFieldLooseKey("popup");var H=babelHelpers.classPrivateFieldLooseKey("api");var F=babelHelpers.classPrivateFieldLooseKey("options");var B=babelHelpers.classPrivateFieldLooseKey("ui");var y=babelHelpers.classPrivateFieldLooseKey("loader");var f=babelHelpers.classPrivateFieldLooseKey("documentUid");var g=babelHelpers.classPrivateFieldLooseKey("membersObserver");var x=babelHelpers.classPrivateFieldLooseKey("departmentsObserver");var C=babelHelpers.classPrivateFieldLooseKey("initialized");var w=babelHelpers.classPrivateFieldLooseKey("membersLoaded");var O=babelHelpers.classPrivateFieldLooseKey("departmentsLoaded");var D=babelHelpers.classPrivateFieldLooseKey("membersLoadingLocked");var T=babelHelpers.classPrivateFieldLooseKey("departmentsLoadingLocked");var j=babelHelpers.classPrivateFieldLooseKey("init");var K=babelHelpers.classPrivateFieldLooseKey("getPopup");var $=babelHelpers.classPrivateFieldLooseKey("createPopup");var S=babelHelpers.classPrivateFieldLooseKey("renderContent");var E=babelHelpers.classPrivateFieldLooseKey("switchTab");var M=babelHelpers.classPrivateFieldLooseKey("loadNextMembersPage");var X=babelHelpers.classPrivateFieldLooseKey("loadNextDepartmentsPage");var _=babelHelpers.classPrivateFieldLooseKey("loadMembersPage");var U=babelHelpers.classPrivateFieldLooseKey("loadDepartmentsPage");var I=babelHelpers.classPrivateFieldLooseKey("appendDepartmentsToPopup");var k=babelHelpers.classPrivateFieldLooseKey("appendMembersToPopup");class R{constructor(e){Object.defineProperty(this,k,{value:Z});Object.defineProperty(this,I,{value:W});Object.defineProperty(this,U,{value:Q});Object.defineProperty(this,_,{value:J});Object.defineProperty(this,X,{value:Y});Object.defineProperty(this,M,{value:G});Object.defineProperty(this,E,{value:z});Object.defineProperty(this,S,{value:q});Object.defineProperty(this,$,{value:N});Object.defineProperty(this,K,{value:A});Object.defineProperty(this,j,{value:V});Object.defineProperty(this,L,{writable:true,value:null});Object.defineProperty(this,H,{writable:true,value:void 0});Object.defineProperty(this,F,{writable:true,value:{}});Object.defineProperty(this,B,{writable:true,value:{membersContent:HTMLDivElement=null,departmentsContent:HTMLDivElement=null,tabs:HTMLElement=null}});Object.defineProperty(this,y,{writable:true,value:void 0});Object.defineProperty(this,f,{writable:true,value:null});Object.defineProperty(this,g,{writable:true,value:void 0});Object.defineProperty(this,x,{writable:true,value:void 0});Object.defineProperty(this,C,{writable:true,value:false});Object.defineProperty(this,w,{writable:true,value:false});Object.defineProperty(this,O,{writable:true,value:false});Object.defineProperty(this,D,{writable:true,value:false});Object.defineProperty(this,T,{writable:true,value:false});babelHelpers.classPrivateFieldLooseBase(this,F)[F]=e;babelHelpers.classPrivateFieldLooseBase(this,H)[H]=new t.Api;const s={threshold:.1};babelHelpers.classPrivateFieldLooseBase(this,g)[g]=new IntersectionObserver((e=>{e.forEach((e=>{if(!babelHelpers.classPrivateFieldLooseBase(this,w)[w]&&e.isIntersecting){babelHelpers.classPrivateFieldLooseBase(this,g)[g].unobserve(e.target);babelHelpers.classPrivateFieldLooseBase(this,M)[M]().then((e=>{if(e.length>0){babelHelpers.classPrivateFieldLooseBase(this,k)[k](e);if(e.length>=m){babelHelpers.classPrivateFieldLooseBase(this,g)[g].observe(babelHelpers.classPrivateFieldLooseBase(this,B)[B].membersContent.lastChild)}}}))}}))}),s);babelHelpers.classPrivateFieldLooseBase(this,x)[x]=new IntersectionObserver((e=>{e.forEach((e=>{if(!babelHelpers.classPrivateFieldLooseBase(this,O)[O]&&e.isIntersecting){babelHelpers.classPrivateFieldLooseBase(this,x)[x].unobserve(e.target);babelHelpers.classPrivateFieldLooseBase(this,X)[X]().then((e=>{if(e.length>0){babelHelpers.classPrivateFieldLooseBase(this,I)[I](e);if(e.length>=m){babelHelpers.classPrivateFieldLooseBase(this,x)[x].observe(babelHelpers.classPrivateFieldLooseBase(this,B)[B].departmentsContent.lastChild)}}}))}}))}),s)}show(){babelHelpers.classPrivateFieldLooseBase(this,K)[K]().show();if(babelHelpers.classPrivateFieldLooseBase(this,C)[C]===false){babelHelpers.classPrivateFieldLooseBase(this,y)[y].show();s.Dom.clean(babelHelpers.classPrivateFieldLooseBase(this,B)[B].membersContent);s.Dom.clean(babelHelpers.classPrivateFieldLooseBase(this,B)[B].departmentsContent);babelHelpers.classPrivateFieldLooseBase(this,j)[j]().then((async()=>{babelHelpers.classPrivateFieldLooseBase(this,y)[y].hide();babelHelpers.classPrivateFieldLooseBase(this,C)[C]=true}))}}setDocumentUid(e){babelHelpers.classPrivateFieldLooseBase(this,f)[f]=e;return this}resetData(){s.Dom.clean(babelHelpers.classPrivateFieldLooseBase(this,B)[B].membersContent);s.Dom.clean(babelHelpers.classPrivateFieldLooseBase(this,B)[B].departmentsContent);babelHelpers.classPrivateFieldLooseBase(this,C)[C]=false;babelHelpers.classPrivateFieldLooseBase(this,w)[w]=false;babelHelpers.classPrivateFieldLooseBase(this,O)[O]=false;return this}}async function V(){const e=await babelHelpers.classPrivateFieldLooseBase(this,_)[_](1);if(e.length>0){babelHelpers.classPrivateFieldLooseBase(this,k)[k](e);if(e.length>=m){babelHelpers.classPrivateFieldLooseBase(this,g)[g].observe(babelHelpers.classPrivateFieldLooseBase(this,B)[B].membersContent.lastChild)}}if(babelHelpers.classPrivateFieldLooseBase(this,F)[F].isDepartmentsVisible===false){return}const s=await babelHelpers.classPrivateFieldLooseBase(this,U)[U](1);if(s.length===0){return}babelHelpers.classPrivateFieldLooseBase(this,I)[I](s);if(s.length>=m){babelHelpers.classPrivateFieldLooseBase(this,x)[x].observe(babelHelpers.classPrivateFieldLooseBase(this,B)[B].departmentsContent.lastChild)}}function A(){if(!babelHelpers.classPrivateFieldLooseBase(this,L)[L]){return babelHelpers.classPrivateFieldLooseBase(this,$)[$]()}return babelHelpers.classPrivateFieldLooseBase(this,L)[L]}function N(){babelHelpers.classPrivateFieldLooseBase(this,L)[L]=new a.Popup({content:babelHelpers.classPrivateFieldLooseBase(this,S)[S](),bindElement:babelHelpers.classPrivateFieldLooseBase(this,F)[F].bindElement,width:330,autoHide:true,closeByEsc:true});return babelHelpers.classPrivateFieldLooseBase(this,L)[L]}function q(){const e=e=>{babelHelpers.classPrivateFieldLooseBase(this,E)[E]("members");e.preventDefault()};const a=e=>{babelHelpers.classPrivateFieldLooseBase(this,E)[E]("departments");e.preventDefault()};let t=s.Tag.render(o||(o=i``));if(babelHelpers.classPrivateFieldLooseBase(this,F)[F].isDepartmentsVisible===true){t=s.Tag.render(p||(p=i`
				<span onclick="${0}" class="bx-user-party-popup-popup-head-item --department">
					<span class="bx-user-party-popup-popup-head-icon"></span>
					<span class="bx-user-party-popup-popup-head-text">${0}</span>
				</span>
			`),a,s.Loc.getMessage("SIGN_USER_PARTY_POPUP_TAB_DEPARTMENTS"))}babelHelpers.classPrivateFieldLooseBase(this,B)[B].tabs=s.Tag.render(b||(b=i`
			<span class="bx-user-party-popup-popup-head">
				<span onclick="${0}" class="bx-user-party-popup-popup-head-item --member bx-user-party-popup-popup-head-item-current">
					<span class="bx-user-party-popup-popup-head-icon"></span>
					<span class="bx-user-party-popup-popup-head-text">${0}</span>
				</span>
				${0}
			</span>
		`),e,s.Loc.getMessage("SIGN_USER_PARTY_POPUP_TAB_MEMBERS"),t);babelHelpers.classPrivateFieldLooseBase(this,B)[B].membersContent=s.Tag.render(n||(n=i`<div class="bx-user-party-popup-popup-content-container"></div>`));babelHelpers.classPrivateFieldLooseBase(this,B)[B].departmentsContent=s.Tag.render(d||(d=i`
			<div class="bx-user-party-popup-popup-content-container bx-user-party-popup-popup-content-invisible"></div>
		`));const r=s.Tag.render(c||(c=i`
			<div class="bx-sign-user-party-popup">
				${0}
				${0}
				${0}
			</div>
		`),babelHelpers.classPrivateFieldLooseBase(this,B)[B].tabs,babelHelpers.classPrivateFieldLooseBase(this,B)[B].membersContent,babelHelpers.classPrivateFieldLooseBase(this,B)[B].departmentsContent);babelHelpers.classPrivateFieldLooseBase(this,y)[y]=new l.Loader({size:80,target:r,offset:{top:"10px"}});return r}function z(e){switch(e){case"departments":s.Dom.removeClass(babelHelpers.classPrivateFieldLooseBase(this,B)[B].departmentsContent,"bx-user-party-popup-popup-content-invisible");s.Dom.addClass(babelHelpers.classPrivateFieldLooseBase(this,B)[B].membersContent,"bx-user-party-popup-popup-content-invisible");s.Dom.removeClass(babelHelpers.classPrivateFieldLooseBase(this,B)[B].tabs.querySelector(".bx-user-party-popup-popup-head-item.--member"),"bx-user-party-popup-popup-head-item-current");s.Dom.addClass(babelHelpers.classPrivateFieldLooseBase(this,B)[B].tabs.querySelector(".bx-user-party-popup-popup-head-item.--department"),"bx-user-party-popup-popup-head-item-current");break;case"members":default:s.Dom.removeClass(babelHelpers.classPrivateFieldLooseBase(this,B)[B].membersContent,"bx-user-party-popup-popup-content-invisible");s.Dom.addClass(babelHelpers.classPrivateFieldLooseBase(this,B)[B].departmentsContent,"bx-user-party-popup-popup-content-invisible");s.Dom.removeClass(babelHelpers.classPrivateFieldLooseBase(this,B)[B].tabs.querySelector(".bx-user-party-popup-popup-head-item.--department"),"bx-user-party-popup-popup-head-item-current");s.Dom.addClass(babelHelpers.classPrivateFieldLooseBase(this,B)[B].tabs.querySelector(".bx-user-party-popup-popup-head-item.--member"),"bx-user-party-popup-popup-head-item-current");break}}async function G(){if(babelHelpers.classPrivateFieldLooseBase(this,D)[D]===true){return[]}babelHelpers.classPrivateFieldLooseBase(this,D)[D]=true;const e=Math.ceil(babelHelpers.classPrivateFieldLooseBase(this,B)[B].membersContent.children.length/m)+1;const s=await babelHelpers.classPrivateFieldLooseBase(this,_)[_](e);if(s.length===0){babelHelpers.classPrivateFieldLooseBase(this,w)[w]=true}babelHelpers.classPrivateFieldLooseBase(this,D)[D]=false;return s}async function Y(){if(babelHelpers.classPrivateFieldLooseBase(this,T)[T]===true){return[]}babelHelpers.classPrivateFieldLooseBase(this,T)[T]=true;const e=Math.ceil(babelHelpers.classPrivateFieldLooseBase(this,B)[B].departmentsContent.children.length/m)+1;const s=await babelHelpers.classPrivateFieldLooseBase(this,U)[U](e);if(s.length===0){babelHelpers.classPrivateFieldLooseBase(this,O)[O]=true}babelHelpers.classPrivateFieldLooseBase(this,T)[T]=false;return s}async function J(e){var s;const a=(s=babelHelpers.classPrivateFieldLooseBase(this,F)[F].role)!=null?s:r.MemberRole.signer;const t=await babelHelpers.classPrivateFieldLooseBase(this,H)[H].getMembersForDocument(babelHelpers.classPrivateFieldLooseBase(this,f)[f],e,m,a);return(t==null?void 0:t.members)||[]}async function Q(e){const s=await babelHelpers.classPrivateFieldLooseBase(this,H)[H].getDepartmentsForDocument(babelHelpers.classPrivateFieldLooseBase(this,f)[f],e,m);return(s==null?void 0:s.departments)||[]}function W(e){e.forEach((e=>{const a=s.Text.encode(e.name);babelHelpers.classPrivateFieldLooseBase(this,B)[B].departmentsContent.append(s.Tag.render(u||(u=i`
				<div data-department-id="${0}" class="bx-user-party-popup-popup-user-item --department">
					<span class="bx-user-party-popup-popup-user-icon --default"></span>
					<span class="bx-user-party-popup-popup-user-name" title="${0}">${0}</span>
				</div>
			`),s.Text.encode(e.id),a,a))}))}function Z(e){e.forEach((e=>{const a=s.Text.encode(e.name);const t=s.Tag.render(v||(v=i`<span class="bx-user-party-popup-popup-user-icon"></span>`));if(e.profileUrl){babelHelpers.classPrivateFieldLooseBase(this,B)[B].membersContent.append(s.Tag.render(h||(h=i`
					<a href="${0}" data-member-id="${0}" class="bx-user-party-popup-popup-user-item --user">
						${0}
						<span class="bx-user-party-popup-popup-user-name" title="${0}">${0}</span>
					</a>
				`),s.Text.encode(e.profileUrl),s.Text.encode(e.memberId),t,a,a))}else{babelHelpers.classPrivateFieldLooseBase(this,B)[B].membersContent.append(s.Tag.render(P||(P=i`
					<span class="bx-user-party-popup-popup-user-item --role">
						${0}
						<span class="bx-user-party-popup-popup-user-name" title="${0}">${0}</span>
					</span>
				`),t,a,a))}if(e.avatar){const a=s.Text.encode(`data:image;base64,${e.avatar}`);s.Dom.style(t,"backgroundImage",`url('${a}')`)}else{s.Dom.addClass(t,"--default")}}))}e.UserPartyPopup=R})(this.BX.Sign.V2.B2e=this.BX.Sign.V2.B2e||{},BX,BX.Main,BX.Sign.V2,BX,BX.Sign);
//# sourceMappingURL=user-party-popup.bundle.map.js