this.BX=this.BX||{};this.BX.Sign=this.BX.Sign||{};this.BX.Sign.V2=this.BX.Sign.V2||{};(function(e,s,a,i,l,r,t){"use strict";const o=Object.freeze({User:"user",Company:"company",Role:"structure-node-role"});var c=babelHelpers.classPrivateFieldLooseKey("api");var n=babelHelpers.classPrivateFieldLooseKey("ui");var b=babelHelpers.classPrivateFieldLooseKey("dataDialog");var d=babelHelpers.classPrivateFieldLooseKey("loader");var v=babelHelpers.classPrivateFieldLooseKey("data");var p=babelHelpers.classPrivateFieldLooseKey("viewData");var h=babelHelpers.classPrivateFieldLooseKey("load");var P=babelHelpers.classPrivateFieldLooseKey("loadCompany");var L=babelHelpers.classPrivateFieldLooseKey("loadUser");var H=babelHelpers.classPrivateFieldLooseKey("loadRole");var u=babelHelpers.classPrivateFieldLooseKey("refreshView");var y=babelHelpers.classPrivateFieldLooseKey("getLoader");var F=babelHelpers.classPrivateFieldLooseKey("hideLoader");var B=babelHelpers.classPrivateFieldLooseKey("showLoader");let g=e=>e,m,f,w,K,_;const k=6;const I="/bitrix/js/socialnetwork/entity-selector/src/images/default-user.svg";var M=babelHelpers.classPrivateFieldLooseKey("api");var E=babelHelpers.classPrivateFieldLooseKey("documentUid");var S=babelHelpers.classPrivateFieldLooseKey("integrationId");var N=babelHelpers.classPrivateFieldLooseKey("employeeIds");var O=babelHelpers.classPrivateFieldLooseKey("participantsIds");var T=babelHelpers.classPrivateFieldLooseKey("container");var X=babelHelpers.classPrivateFieldLooseKey("usersPreviewContainer");var U=babelHelpers.classPrivateFieldLooseKey("enabled");var j=babelHelpers.classPrivateFieldLooseKey("openMapper");var C=babelHelpers.classPrivateFieldLooseKey("loadUsersAvatarMap");var D=babelHelpers.classPrivateFieldLooseKey("updateUsersPreview");var V=babelHelpers.classPrivateFieldLooseKey("getUsersPreviewContainer");class G extends s.EventEmitter{constructor(e){super();Object.defineProperty(this,V,{value:x});Object.defineProperty(this,D,{value:R});Object.defineProperty(this,C,{value:A});Object.defineProperty(this,j,{value:$});Object.defineProperty(this,M,{writable:true,value:void 0});Object.defineProperty(this,E,{writable:true,value:null});Object.defineProperty(this,S,{writable:true,value:null});Object.defineProperty(this,N,{writable:true,value:[]});Object.defineProperty(this,O,{writable:true,value:[]});Object.defineProperty(this,T,{writable:true,value:null});Object.defineProperty(this,X,{writable:true,value:null});Object.defineProperty(this,U,{writable:true,value:false});babelHelpers.classPrivateFieldLooseBase(this,M)[M]=e.api;this.setEventNamespace("BX.Sign.V2.B2e.HcmLinkMapping");babelHelpers.classPrivateFieldLooseBase(this,T)[T]=this.render()}render(){if(babelHelpers.classPrivateFieldLooseBase(this,T)[T]){return babelHelpers.classPrivateFieldLooseBase(this,T)[T]}const{root:e,syncButton:s}=i.Tag.render(m||(m=g`
			<div class="sign-b2e-hcm-link-party-checker-container --orange">
				<div class="sign-b2e-hcm-link-party-checker-wrapper">
					<div class="sign-b2e-hcm-link-party-checker-wrapper-part --left">
						<div class="sign-b2e-hcm-link-party-checker-title">
							${0}
						</div>
						<div class="sign-b2e-hcm-link-party-checker-description">
							${0}
						</div>
					</div>
					<div class="sign-b2e-hcm-link-party-checker-wrapper-part --right">
						${0}
						<div class="sign-b2e-hcm-link-party-checker__action-button" ref="syncButton">
							${0}
						</div>
					</div>
				</div>
			</div>
		`),i.Loc.getMessage("SIGN_V2_B2E_HCM_LINK_MAPPING_TITLE"),i.Loc.getMessage("SIGN_V2_B2E_HCM_LINK_MAPPING_TEXT"),babelHelpers.classPrivateFieldLooseBase(this,V)[V](),i.Loc.getMessage("SIGN_V2_B2E_HCM_LINK_MAPPING_SYNC_BUTTON"));i.Event.bind(s,"click",(()=>babelHelpers.classPrivateFieldLooseBase(this,j)[j]()));babelHelpers.classPrivateFieldLooseBase(this,T)[T]=e;this.hide();return babelHelpers.classPrivateFieldLooseBase(this,T)[T]}setEnabled(e){babelHelpers.classPrivateFieldLooseBase(this,U)[U]=e}setDocumentUid(e){babelHelpers.classPrivateFieldLooseBase(this,E)[E]=e}async check(){if(!i.Type.isStringFilled(babelHelpers.classPrivateFieldLooseBase(this,E)[E])){return true}const{integrationId:e,userIds:s,allUserIds:a}=await babelHelpers.classPrivateFieldLooseBase(this,M)[M].checkNotMappedMembersHrIntegration(babelHelpers.classPrivateFieldLooseBase(this,E)[E]);babelHelpers.classPrivateFieldLooseBase(this,O)[O]=a;babelHelpers.classPrivateFieldLooseBase(this,N)[N]=s;babelHelpers.classPrivateFieldLooseBase(this,S)[S]=e;if(babelHelpers.classPrivateFieldLooseBase(this,N)[N].length>0){await babelHelpers.classPrivateFieldLooseBase(this,D)[D]()}return!i.Type.isArrayFilled(babelHelpers.classPrivateFieldLooseBase(this,N)[N])}hide(){i.Dom.hide(babelHelpers.classPrivateFieldLooseBase(this,T)[T])}show(){i.Dom.show(babelHelpers.classPrivateFieldLooseBase(this,T)[T])}}function $(){a.Mapper.openSlider({companyId:babelHelpers.classPrivateFieldLooseBase(this,S)[S],userIds:new Set(babelHelpers.classPrivateFieldLooseBase(this,O)[O]),mode:a.Mapper.MODE_DIRECT},{onCloseHandler:()=>{this.emit("update")}})}function A(e){return new Promise((s=>{const a=new r.Dialog({entities:[{id:o.User}],events:{onLoad:e=>{const i=a.getSelectedItems();const l=new Map;i.forEach((e=>{l.set(Number(e.id),e.avatar)}));s(l)}},preselectedItems:e.map((e=>["user",e]))});a.load()}))}async function R(){const e=babelHelpers.classPrivateFieldLooseBase(this,N)[N].length;const s=babelHelpers.classPrivateFieldLooseBase(this,N)[N].slice(0,k);const a=await babelHelpers.classPrivateFieldLooseBase(this,C)[C](s);i.Dom.clean(babelHelpers.classPrivateFieldLooseBase(this,V)[V]());const l=i.Tag.render(f||(f=g`
			<div class="sign-b2e-hcm-link-party-checker-users-avatar-container"></div>
		`));s.forEach((e=>{var s;const r=(s=a.get(e))!=null?s:I;const t=i.Tag.render(w||(w=g`
				<div class="sign-b2e-hcm-link-party-checker-user-preview --orange">
					<img src="${0}">
				</div>
			`),r);i.Dom.append(t,l)}));i.Dom.append(l,babelHelpers.classPrivateFieldLooseBase(this,V)[V]());const r=e-k;if(r>0){const e=i.Tag.render(K||(K=g`
				<div class="sign-b2e-hcm-link-party-checker-users-preview-counter">
					${0}
				</div>
			`),i.Loc.getMessage("SIGN_V2_B2E_HCM_LINK_EMPLOYEE_USERS_COUNT_PLUS",{"#COUNT#":r}));i.Dom.append(e,babelHelpers.classPrivateFieldLooseBase(this,V)[V]())}}function x(){if(!babelHelpers.classPrivateFieldLooseBase(this,X)[X]){babelHelpers.classPrivateFieldLooseBase(this,X)[X]=i.Tag.render(_||(_=g`
				<div class="sign-b2e-hcm-link-party-checker-users-preview-container"></div>
			`))}return babelHelpers.classPrivateFieldLooseBase(this,X)[X]}e.HcmLinkMapping=G})(this.BX.Sign.V2.B2e=this.BX.Sign.V2.B2e||{},BX.Event,BX.Humanresources.Hcmlink,BX,BX,BX.UI.EntitySelector,BX.Sign.V2);
//# sourceMappingURL=hcm-link-mapping.bundle.map.js