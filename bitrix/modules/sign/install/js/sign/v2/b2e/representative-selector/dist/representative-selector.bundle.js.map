{"version":3,"file":"representative-selector.bundle.js","sources":["../src/index.js"],"sourcesContent":["import { Loc, Tag, Type, Dom, Text as TextFormat, Text } from 'main.core';\nimport { Menu, Popup } from 'main.popup';\nimport { UserSelector, UserSelectorEvent } from 'sign.v2.b2e.user-selector';\nimport type { ItemOptions } from 'ui.entity-selector';\nimport { Helpdesk } from 'sign.v2.helper';\nimport { EntityType } from 'sign.type';\n\nimport './style.css';\n\nconst defaultAvatarLink = '/bitrix/js/socialnetwork/entity-selector/src/images/default-user.svg';\nconst HelpdeskCodes = Object.freeze({\n\tWhoCanBeRepresentative: '19740734',\n});\nconst representativeSelectorMenuButtonId = 'sign-document-b2e-representative_selector_menu_button';\n\ntype UserInfo = {\n\tid: ?Number,\n\tname: ?String,\n\tposition: ?String,\n\tavatarLink: ?String,\n};\n\nexport type RepresentativeSelectorOptions = {\n\texcludedEntityList: ?[],\n\tisDescriptionVisible: boolean;\n\tisMenuButtonVisible: boolean;\n\tonDelete: () => void;\n\tonSelect: () => void;\n\tonHide: () => void;\n\tcacheable?: boolean,\n\tuserId?: Number;\n\tdescription?: string;\n\troleEnabled?: boolean;\n\tcontext?: string;\n}\n\nexport class RepresentativeSelector\n{\n\t#userSelector: UserSelector = null;\n\t#description: ?string;\n\t#isDescriptionVisible: boolean = true;\n\t#isMenuButtonVisible: boolean = false;\n\t#isMenuVisible: boolean = false;\n\t#uuid: ?string;\n\t#itemType: ?string;\n\t#onDelete: () => void;\n\t#onSelect: () => void;\n\t#onHide: () => void;\n\n\t#ui = {\n\t\tcontainer: HTMLDivElement = null,\n\t\tinfo: {\n\t\t\tcontainer: HTMLDivElement = null,\n\t\t\tavatar: HTMLImageElement = null,\n\t\t\ttitle: {\n\t\t\t\tcontainer: HTMLDivElement = null,\n\t\t\t\tname: HTMLDivElement = null,\n\t\t\t\tposition: HTMLDivElement = null,\n\t\t\t},\n\t\t},\n\t\tchangeBtn: {\n\t\t\tcontainer: HTMLDivElement = null,\n\t\t\telement: HTMLDivElement = null,\n\t\t},\n\t\tmenuBtn: {\n\t\t\tcontainer: HTMLDivElement = null,\n\t\t\telement: HTMLSpanElement = null,\n\t\t},\n\t\tselect: {\n\t\t\tcontainer: HTMLDivElement = null,\n\t\t\ttext: HTMLSpanElement = null,\n\t\t\tbutton: HTMLButtonElement = null,\n\t\t},\n\t\tdescription: HTMLParagraphElement = null,\n\t};\n\n\t#data: UserInfo = {\n\t\tid: null,\n\t\tname: null,\n\t\tposition: null,\n\t\tavatarLink: null,\n\t};\n\n\tconstructor(options: RepresentativeSelectorOptions = {})\n\t{\n\t\tthis.#data.id = Type.isInteger(options.userId) ? options.userId : null;\n\t\tthis.#description = options.description;\n\t\tthis.#isDescriptionVisible = options.isDescriptionVisible ?? true;\n\t\tthis.#isMenuButtonVisible = options.isMenuButtonVisible ?? false;\n\t\tthis.#userSelector = new UserSelector({\n\t\t\tcacheable: options.cacheable,\n\t\t\tmultiple: false,\n\t\t\troleEnabled: options.roleEnabled ?? false,\n\t\t\tcontext: options.context ?? 'sign_b2e_representative_selector',\n\t\t\texcludedEntityList: options.excludedEntityList ?? [],\n\t\t});\n\n\t\tconst defaultCallback = () => null;\n\t\tthis.#onDelete = options.onDelete ?? defaultCallback;\n\t\tthis.#onSelect = options.onSelect ?? defaultCallback;\n\t\tthis.#onHide = options.onHide ?? defaultCallback;\n\n\t\tthis.#ui.container = this.getLayout();\n\t}\n\n\tsetExcludedEntityList(excludedEntityList: Array): void\n\t{\n\t\tif (!this.#userSelector)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.#userSelector.setExcludedEntityList(excludedEntityList);\n\t}\n\n\tgetContainerId(): string\n\t{\n\t\tif (!this.#uuid)\n\t\t{\n\t\t\tthis.#uuid = Text.getRandom();\n\t\t}\n\n\t\treturn `sign_b2e_representative_selector_${this.#uuid}`;\n\t}\n\n\tgetLayout(): HTMLDivElement\n\t{\n\t\tif (this.#ui.container)\n\t\t{\n\t\t\treturn this.#ui.container;\n\t\t}\n\n\t\tthis.#ui.info.title.name = Tag.render`\n\t\t\t<div class=\"sign-document-b2e-representative-info-user-name\"></div>\n\t\t`;\n\t\tthis.#ui.info.title.position = Tag.render`\n\t\t\t<div class=\"sign-document-b2e-representative-info-user-pos\"></div>\n\t\t`;\n\t\tthis.#ui.info.avatar = Tag.render`\n\t\t\t<img src=\"${defaultAvatarLink}\">\n\t\t`;\n\n\t\tthis.#ui.info.title.container = Tag.render`\n\t\t\t<div class=\"sign-document-b2e-representative-info-user-title\">\n\t\t\t\t${this.#ui.info.title.name}\n\t\t\t\t${this.#ui.info.title.position}\n\t\t\t</div>\n\t\t`;\n\n\t\tthis.#ui.select.text = Tag.render`\n\t\t\t<span class=\"sign-document-b2e-representative-select-text\">\n\t\t\t\t${Loc.getMessage('SIGN_PARTIES_REPRESENTATIVE_SELECT_TEXT')}\n\t\t\t</span>\n\t\t`;\n\t\tthis.#ui.select.button = Tag.render`\n\t\t\t<button class=\"ui-btn ui-btn-success ui-btn-xs ui-btn-round\">\n\t\t\t\t${Loc.getMessage('SIGN_PARTIES_REPRESENTATIVE_SELECT_BUTTON')}\n\t\t\t</button>\n\t\t`;\n\t\tthis.#ui.select.container = Tag.render`\n\t\t\t<div class=\"sign-document-b2e-representative-select\">\n\t\t\t\t${this.#ui.select.text}\n\t\t\t\t${this.#ui.select.button}\n\t\t\t</div>\n\t\t`;\n\n\t\tthis.#ui.changeBtn.element = Tag.render`\n\t\t\t<span class=\"sign-document-b2e-representative-change-btn\"></span>\n\t\t`;\n\t\tthis.#ui.changeBtn.container = Tag.render`\n\t\t\t<div class=\"sign-document-b2e-representative-change\">\n\t\t\t\t${this.#ui.changeBtn.element}\n\t\t\t</div>\n\t\t`;\n\n\t\tthis.#ui.menuBtn.container = Tag.render`\n\t\t\t<div id=\"${representativeSelectorMenuButtonId}\" class=\"sign-document-b2e-company-info-edit\" onclick=\"${(): void => this.#showMenu()}\"></div>\n\t\t`;\n\n\t\tthis.#ui.info.container = Tag.render`\n\t\t\t<div class=\"sign-document-b2e-representative-info\">\n\t\t\t\t<div class=\"sign-document-b2e-representative-info-user-photo\">\n\t\t\t\t\t${this.#ui.info.avatar}\n\t\t\t\t</div>\n\t\t\t\t${this.#ui.info.title.container}\n\t\t\t</div>\n\t\t`;\n\n\t\tlet description = '';\n\n\t\tif (this.#isDescriptionVisible)\n\t\t{\n\t\t\tdescription = this.#description\n\t\t\t\t? Tag.render`<p class=\"sign-document-b2e-representative__info_paragraph\">${this.#description}</p>`\n\t\t\t\t: Tag.render`\n\t\t\t\t\t<span>\n\t\t\t\t\t\t${Helpdesk.replaceLink(\n\t\t\t\t\t\t\tLoc.getMessage('SIGN_PARTIES_REPRESENTATIVE_INFO'),\n\t\t\t\t\t\t\tHelpdeskCodes.WhoCanBeRepresentative,\n\t\t\t\t\t\t)}\n\t\t\t\t\t</span>\n\t\t\t\t`\n\t\t\t;\n\t\t}\n\n\t\tthis.#ui.description = Tag.render`\n\t\t\t<div class=\"sign-document-b2e-representative__info\">\n\t\t\t\t${description}\n\t\t\t</div>\n\t\t`;\n\n\t\tconst menuBtn = this.#isMenuButtonVisible ? this.#ui.menuBtn.container : Tag.render``;\n\n\t\tthis.#ui.container = Tag.render`\n\t\t\t<div id=\"${this.getContainerId()}\">\n\t\t\t\t<div class=\"sign-document-b2e-representative__selector\">\n\t\t\t\t\t${this.#ui.select.container}\n\t\t\t\t\t${this.#ui.info.container}\n\t\t\t\t\t${this.#ui.changeBtn.container}\n\t\t\t\t\t${menuBtn}\n\t\t\t\t</div>\n\t\t\t\t${this.#ui.description}\n\t\t\t</div>\n\t\t`;\n\n\t\tthis.#setEmptyState();\n\t\tthis.#bindEvents();\n\n\t\treturn this.#ui.container;\n\t}\n\n\t#showMenu(): void\n\t{\n\t\tconst representativeSelectorElement = document.getElementById(this.getContainerId());\n\t\tif (representativeSelectorElement === null)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst menuButtonElement = representativeSelectorElement.querySelector(`#${representativeSelectorMenuButtonId}`);\n\t\tif (menuButtonElement === null)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst menu = new Menu({\n\t\t\tbindElement: menuButtonElement,\n\t\t\tcacheable: false,\n\t\t\tevents: {\n\t\t\t\tonPopupClose: (popup: Popup) => {\n\t\t\t\t\tthis.#isMenuVisible = false;\n\t\t\t\t},\n\t\t\t},\n\t\t});\n\n\t\tif (this.#isMenuVisible)\n\t\t{\n\t\t\tmenu.close();\n\n\t\t\treturn;\n\t\t}\n\n\t\tthis.#isMenuVisible = true;\n\n\t\tmenu.addMenuItem({\n\t\t\ttext: Loc.getMessage('SIGN_B2E_REPRESENTATIVE_SELECTOR_DELETE_BUTTON_TITLE'),\n\t\t\tonclick: () => {\n\t\t\t\trepresentativeSelectorElement.remove();\n\t\t\t\tthis.#onDelete(this.getContainerId());\n\t\t\t\tmenu.close();\n\t\t\t},\n\t\t});\n\t\tmenu.show();\n\t}\n\n\tformatSelectButton(className: string)\n\t{\n\t\tthis.#ui.select.button.className = `ui-btn ${className}`;\n\t}\n\n\t#setInfoState()\n\t{\n\t\tthis.#ui.info.container.style.display = 'flex';\n\t\tBX.show(this.#ui.changeBtn.container);\n\t\tBX.show(this.#ui.description);\n\t\tBX.hide(this.#ui.select.container);\n\t}\n\n\t#setEmptyState()\n\t{\n\t\tBX.hide(this.#ui.info.container);\n\t\tBX.hide(this.#ui.changeBtn.container);\n\t\tBX.hide(this.#ui.description);\n\t\tBX.show(this.#ui.select.container);\n\t}\n\n\tformat(id: string, className: string)\n\t{\n\t\tthis.#ui[id].className = className;\n\t}\n\n\tvalidate(): boolean\n\t{\n\t\tconst isValid = Type.isInteger(this.getRepresentativeId()) && this.getRepresentativeId() > 0;\n\t\tif (isValid)\n\t\t{\n\t\t\tDom.removeClass(this.#ui.container.firstElementChild, '--invalid');\n\t\t}\n\t\telse\n\t\t{\n\t\t\tDom.addClass(this.#ui.container.firstElementChild, '--invalid');\n\t\t}\n\n\t\treturn isValid;\n\t}\n\n\tload(representativeId: number, entityType: string = EntityType.USER): void\n\t{\n\t\tconst dialog = this.#userSelector.getDialog();\n\t\tdialog.subscribeOnce('onLoad', () => {\n\t\t\tconst userItems = dialog.items.get(entityType);\n\t\t\tconst userItem = userItems.get(`${representativeId}`);\n\t\t\tuserItem.select();\n\t\t\tthis.#showItem(userItem);\n\t\t});\n\t\tdialog.load();\n\t\tthis.#data.id = representativeId;\n\t\tthis.#itemType = entityType;\n\t}\n\n\tloadFistRepresentative(): void\n\t{\n\t\tconst dialog = this.#userSelector.getDialog();\n\t\tdialog.subscribeOnce('onLoad', () => {\n\t\t\tconst userItems = dialog.items.get('user');\n\n\t\t\tif (userItems.size === 0)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst firstUserItem = userItems.values().next().value;\n\t\t\tfirstUserItem.select();\n\t\t\tthis.#showItem(firstUserItem);\n\t\t});\n\t\tdialog.load();\n\t}\n\n\tgetRepresentativeId(): ?number\n\t{\n\t\treturn this.#data.id;\n\t}\n\n\tgetRepresentativeItemType(): ?string\n\t{\n\t\treturn this.#itemType;\n\t}\n\n\t#bindEvents()\n\t{\n\t\tBX.bind(this.#ui.changeBtn.element, 'click', () => this.#onChangeButtonClickHandler());\n\t\tBX.bind(this.#ui.select.button, 'click', () => this.#onChangeButtonClickHandler());\n\t\tthis.#userSelector.subscribe(\n\t\t\tUserSelectorEvent.onItemSelect,\n\t\t\t(event) => this.#onSelectorItemSelectedHandler(event),\n\t\t);\n\t\tthis.#userSelector.subscribe(\n\t\t\tUserSelectorEvent.onItemDeselect,\n\t\t\t(event) => this.onSelectorItemDeselectedHandler(event),\n\t\t);\n\t\tthis.#userSelector.subscribe(\n\t\t\tUserSelectorEvent.onHide,\n\t\t\t(event) => this.#onSelectorDialogHide(event),\n\t\t);\n\t}\n\n\t#onChangeButtonClickHandler(): void\n\t{\n\t\tthis.#userSelector.getDialog().setTargetNode(this.#ui.container.firstElementChild);\n\t\tthis.#userSelector.toggle();\n\t}\n\n\t#onSelectorDialogHide(event): void\n\t{\n\t\tthis.#onHide(this.getContainerId());\n\t}\n\n\t#onSelectorItemSelectedHandler(event): void\n\t{\n\t\tthis.#onSelect(this.getContainerId());\n\t\tif (!event?.data?.items || Number(event?.data?.items?.length) === 0)\n\t\t{\n\t\t\tthis.#data.id = null;\n\t\t\tthis.#setEmptyState();\n\t\t\tthis.#userSelector.setPreselectedEntityList([]);\n\n\t\t\treturn;\n\t\t}\n\n\t\tconst item = event.data.items[0];\n\t\tthis.#userSelector.setPreselectedEntityList([\n\t\t\t{\n\t\t\t\tid: item.id,\n\t\t\t\ttype: item.entityId,\n\t\t\t},\n\t\t]);\n\n\t\tthis.#showItem(item);\n\t}\n\n\t#showItem(item: ItemOptions): void\n\t{\n\t\tthis.#itemType = item.entityId;\n\n\t\tif (item.entityId === EntityType.USER)\n\t\t{\n\t\t\tthis.#showUserItem(item);\n\t\t}\n\t\telse if (item.entityId === EntityType.STRUCTURE_NODE_ROLE)\n\t\t{\n\t\t\tthis.#showRoleItem(item);\n\t\t}\n\t}\n\n\t#showUserItem(item: ItemOptions): void\n\t{\n\t\tthis.#data.id = item.id;\n\t\tif (!Type.isInteger(this.#data.id) || this.#data.id <= 0)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst name = item.customData?.get('name') ?? '';\n\t\tconst lastName = item.customData?.get('lastName') ?? '';\n\t\tthis.#data.name = Type.isStringFilled(name) ? name : '';\n\t\tif (Type.isStringFilled(lastName))\n\t\t{\n\t\t\tif (Type.isStringFilled(name))\n\t\t\t{\n\t\t\t\tthis.#data.name += ' ';\n\t\t\t}\n\t\t\tthis.#data.name += lastName;\n\t\t}\n\n\t\tif (!Type.isStringFilled(this.#data.name))\n\t\t{\n\t\t\tthis.#data.name = item.customData?.get('login') ?? '';\n\t\t}\n\n\t\tthis.#data.position = item.customData?.get('position') || '';\n\t\tthis.#data.avatarLink = (item?.avatar || defaultAvatarLink);\n\n\t\tthis.#refreshView();\n\t}\n\n\t#showRoleItem(item: ItemOptions): void\n\t{\n\t\tthis.#data.id = item.id;\n\t\tif (!Type.isInteger(this.#data.id) || this.#data.id <= 0)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.#data.name = item.title;\n\t\tthis.#data.avatarLink = defaultAvatarLink;\n\t\tthis.#data.position = '';\n\n\t\tthis.#refreshView();\n\t}\n\n\tonSelectorItemDeselectedHandler(event): void\n\t{\n\t\tthis.#data.id = null;\n\t\tthis.#onSelectorItemSelectedHandler(event);\n\t\tthis.#userSelector.setPreselectedEntityList([]);\n\t}\n\n\t#refreshView(): void\n\t{\n\t\tthis.#ui.info.title.name.innerText = TextFormat.encode(this.#data?.name);\n\t\tthis.#ui.info.title.position.innerText = TextFormat.encode(this.#data?.position);\n\t\tthis.#ui.info.avatar.src = this.#data?.avatarLink;\n\t\tthis.#setInfoState();\n\t}\n}\n"],"names":["defaultAvatarLink","HelpdeskCodes","Object","freeze","WhoCanBeRepresentative","representativeSelectorMenuButtonId","RepresentativeSelector","constructor","options","container","HTMLDivElement","info","avatar","HTMLImageElement","title","name","position","changeBtn","element","menuBtn","HTMLSpanElement","select","text","button","HTMLButtonElement","description","HTMLParagraphElement","id","avatarLink","Type","isInteger","userId","isDescriptionVisible","isMenuButtonVisible","UserSelector","cacheable","multiple","roleEnabled","context","excludedEntityList","defaultCallback","onDelete","onSelect","onHide","getLayout","setExcludedEntityList","getContainerId","Text","getRandom","Tag","render","Loc","getMessage","Helpdesk","replaceLink","formatSelectButton","className","format","validate","isValid","getRepresentativeId","Dom","removeClass","firstElementChild","addClass","load","representativeId","entityType","EntityType","USER","dialog","getDialog","subscribeOnce","userItems","items","get","userItem","loadFistRepresentative","size","firstUserItem","values","next","value","getRepresentativeItemType","onSelectorItemDeselectedHandler","event","setPreselectedEntityList","representativeSelectorElement","document","getElementById","menuButtonElement","querySelector","menu","Menu","bindElement","events","onPopupClose","popup","close","addMenuItem","onclick","remove","show","style","display","BX","hide","bind","subscribe","UserSelectorEvent","onItemSelect","onItemDeselect","setTargetNode","toggle","data","Number","length","item","type","entityId","STRUCTURE_NODE_ROLE","customData","lastName","isStringFilled","innerText","TextFormat","encode","src"],"mappings":"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"}