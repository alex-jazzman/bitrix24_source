this.BX=this.BX||{};this.BX.Sign=this.BX.Sign||{};this.BX.Sign.V2=this.BX.Sign.V2||{};(function(e,s,l,a,i,t){"use strict";let r=e=>e,o,n,b,c,d,v,p,h,u,L,P,B,H,F,g,m;const f="/bitrix/js/socialnetwork/entity-selector/src/images/default-user.svg";const y=Object.freeze({WhoCanBeRepresentative:"19740734"});const E="sign-document-b2e-representative_selector_menu_button";var T=babelHelpers.classPrivateFieldLooseKey("userSelector");var S=babelHelpers.classPrivateFieldLooseKey("description");var I=babelHelpers.classPrivateFieldLooseKey("isDescriptionVisible");var _=babelHelpers.classPrivateFieldLooseKey("isMenuButtonVisible");var O=babelHelpers.classPrivateFieldLooseKey("isMenuVisible");var D=babelHelpers.classPrivateFieldLooseKey("uuid");var R=babelHelpers.classPrivateFieldLooseKey("itemType");var j=babelHelpers.classPrivateFieldLooseKey("onDelete");var M=babelHelpers.classPrivateFieldLooseKey("onSelect");var $=babelHelpers.classPrivateFieldLooseKey("onHide");var w=babelHelpers.classPrivateFieldLooseKey("ui");var K=babelHelpers.classPrivateFieldLooseKey("data");var X=babelHelpers.classPrivateFieldLooseKey("showMenu");var x=babelHelpers.classPrivateFieldLooseKey("setInfoState");var C=babelHelpers.classPrivateFieldLooseKey("setEmptyState");var N=babelHelpers.classPrivateFieldLooseKey("bindEvents");var V=babelHelpers.classPrivateFieldLooseKey("onChangeButtonClickHandler");var k=babelHelpers.classPrivateFieldLooseKey("onSelectorDialogHide");var U=babelHelpers.classPrivateFieldLooseKey("onSelectorItemSelectedHandler");var A=babelHelpers.classPrivateFieldLooseKey("showItem");var G=babelHelpers.classPrivateFieldLooseKey("showUserItem");var z=babelHelpers.classPrivateFieldLooseKey("showRoleItem");var W=babelHelpers.classPrivateFieldLooseKey("refreshView");class q{constructor(e={}){var l,i,t,r,o,n,b,c;Object.defineProperty(this,W,{value:re});Object.defineProperty(this,z,{value:te});Object.defineProperty(this,G,{value:ie});Object.defineProperty(this,A,{value:ae});Object.defineProperty(this,U,{value:le});Object.defineProperty(this,k,{value:se});Object.defineProperty(this,V,{value:ee});Object.defineProperty(this,N,{value:Z});Object.defineProperty(this,C,{value:Y});Object.defineProperty(this,x,{value:Q});Object.defineProperty(this,X,{value:J});Object.defineProperty(this,T,{writable:true,value:null});Object.defineProperty(this,S,{writable:true,value:void 0});Object.defineProperty(this,I,{writable:true,value:true});Object.defineProperty(this,_,{writable:true,value:false});Object.defineProperty(this,O,{writable:true,value:false});Object.defineProperty(this,D,{writable:true,value:void 0});Object.defineProperty(this,R,{writable:true,value:void 0});Object.defineProperty(this,j,{writable:true,value:void 0});Object.defineProperty(this,M,{writable:true,value:void 0});Object.defineProperty(this,$,{writable:true,value:void 0});Object.defineProperty(this,w,{writable:true,value:{container:HTMLDivElement=null,info:{container:HTMLDivElement=null,avatar:HTMLImageElement=null,title:{container:HTMLDivElement=null,name:HTMLDivElement=null,position:HTMLDivElement=null}},changeBtn:{container:HTMLDivElement=null,element:HTMLDivElement=null},menuBtn:{container:HTMLDivElement=null,element:HTMLSpanElement=null},select:{container:HTMLDivElement=null,text:HTMLSpanElement=null,button:HTMLButtonElement=null},description:HTMLParagraphElement=null}});Object.defineProperty(this,K,{writable:true,value:{id:null,name:null,position:null,avatarLink:null}});babelHelpers.classPrivateFieldLooseBase(this,K)[K].id=s.Type.isInteger(e.userId)?e.userId:null;babelHelpers.classPrivateFieldLooseBase(this,S)[S]=e.description;babelHelpers.classPrivateFieldLooseBase(this,I)[I]=(l=e.isDescriptionVisible)!=null?l:true;babelHelpers.classPrivateFieldLooseBase(this,_)[_]=(i=e.isMenuButtonVisible)!=null?i:false;babelHelpers.classPrivateFieldLooseBase(this,T)[T]=new a.UserSelector({cacheable:e.cacheable,multiple:false,roleEnabled:(t=e.roleEnabled)!=null?t:false,context:(r=e.context)!=null?r:"sign_b2e_representative_selector",excludedEntityList:(o=e.excludedEntityList)!=null?o:[]});const d=()=>null;babelHelpers.classPrivateFieldLooseBase(this,j)[j]=(n=e.onDelete)!=null?n:d;babelHelpers.classPrivateFieldLooseBase(this,M)[M]=(b=e.onSelect)!=null?b:d;babelHelpers.classPrivateFieldLooseBase(this,$)[$]=(c=e.onHide)!=null?c:d;babelHelpers.classPrivateFieldLooseBase(this,w)[w].container=this.getLayout()}setExcludedEntityList(e){if(!babelHelpers.classPrivateFieldLooseBase(this,T)[T]){return}babelHelpers.classPrivateFieldLooseBase(this,T)[T].setExcludedEntityList(e)}getContainerId(){if(!babelHelpers.classPrivateFieldLooseBase(this,D)[D]){babelHelpers.classPrivateFieldLooseBase(this,D)[D]=s.Text.getRandom()}return`sign_b2e_representative_selector_${babelHelpers.classPrivateFieldLooseBase(this,D)[D]}`}getLayout(){if(babelHelpers.classPrivateFieldLooseBase(this,w)[w].container){return babelHelpers.classPrivateFieldLooseBase(this,w)[w].container}babelHelpers.classPrivateFieldLooseBase(this,w)[w].info.title.name=s.Tag.render(o||(o=r`
			<div class="sign-document-b2e-representative-info-user-name"></div>
		`));babelHelpers.classPrivateFieldLooseBase(this,w)[w].info.title.position=s.Tag.render(n||(n=r`
			<div class="sign-document-b2e-representative-info-user-pos"></div>
		`));babelHelpers.classPrivateFieldLooseBase(this,w)[w].info.avatar=s.Tag.render(b||(b=r`
			<img src="${0}">
		`),f);babelHelpers.classPrivateFieldLooseBase(this,w)[w].info.title.container=s.Tag.render(c||(c=r`
			<div class="sign-document-b2e-representative-info-user-title">
				${0}
				${0}
			</div>
		`),babelHelpers.classPrivateFieldLooseBase(this,w)[w].info.title.name,babelHelpers.classPrivateFieldLooseBase(this,w)[w].info.title.position);babelHelpers.classPrivateFieldLooseBase(this,w)[w].select.text=s.Tag.render(d||(d=r`
			<span class="sign-document-b2e-representative-select-text">
				${0}
			</span>
		`),s.Loc.getMessage("SIGN_PARTIES_REPRESENTATIVE_SELECT_TEXT"));babelHelpers.classPrivateFieldLooseBase(this,w)[w].select.button=s.Tag.render(v||(v=r`
			<button class="ui-btn ui-btn-success ui-btn-xs ui-btn-round">
				${0}
			</button>
		`),s.Loc.getMessage("SIGN_PARTIES_REPRESENTATIVE_SELECT_BUTTON"));babelHelpers.classPrivateFieldLooseBase(this,w)[w].select.container=s.Tag.render(p||(p=r`
			<div class="sign-document-b2e-representative-select">
				${0}
				${0}
			</div>
		`),babelHelpers.classPrivateFieldLooseBase(this,w)[w].select.text,babelHelpers.classPrivateFieldLooseBase(this,w)[w].select.button);babelHelpers.classPrivateFieldLooseBase(this,w)[w].changeBtn.element=s.Tag.render(h||(h=r`
			<span class="sign-document-b2e-representative-change-btn"></span>
		`));babelHelpers.classPrivateFieldLooseBase(this,w)[w].changeBtn.container=s.Tag.render(u||(u=r`
			<div class="sign-document-b2e-representative-change">
				${0}
			</div>
		`),babelHelpers.classPrivateFieldLooseBase(this,w)[w].changeBtn.element);babelHelpers.classPrivateFieldLooseBase(this,w)[w].menuBtn.container=s.Tag.render(L||(L=r`
			<div id="${0}" class="sign-document-b2e-company-info-edit" onclick="${0}"></div>
		`),E,(()=>babelHelpers.classPrivateFieldLooseBase(this,X)[X]()));babelHelpers.classPrivateFieldLooseBase(this,w)[w].info.container=s.Tag.render(P||(P=r`
			<div class="sign-document-b2e-representative-info">
				<div class="sign-document-b2e-representative-info-user-photo">
					${0}
				</div>
				${0}
			</div>
		`),babelHelpers.classPrivateFieldLooseBase(this,w)[w].info.avatar,babelHelpers.classPrivateFieldLooseBase(this,w)[w].info.title.container);let e="";if(babelHelpers.classPrivateFieldLooseBase(this,I)[I]){e=babelHelpers.classPrivateFieldLooseBase(this,S)[S]?s.Tag.render(B||(B=r`<p class="sign-document-b2e-representative__info_paragraph">${0}</p>`),babelHelpers.classPrivateFieldLooseBase(this,S)[S]):s.Tag.render(H||(H=r`
					<span>
						${0}
					</span>
				`),i.Helpdesk.replaceLink(s.Loc.getMessage("SIGN_PARTIES_REPRESENTATIVE_INFO"),y.WhoCanBeRepresentative))}babelHelpers.classPrivateFieldLooseBase(this,w)[w].description=s.Tag.render(F||(F=r`
			<div class="sign-document-b2e-representative__info">
				${0}
			</div>
		`),e);const l=babelHelpers.classPrivateFieldLooseBase(this,_)[_]?babelHelpers.classPrivateFieldLooseBase(this,w)[w].menuBtn.container:s.Tag.render(g||(g=r``));babelHelpers.classPrivateFieldLooseBase(this,w)[w].container=s.Tag.render(m||(m=r`
			<div id="${0}">
				<div class="sign-document-b2e-representative__selector">
					${0}
					${0}
					${0}
					${0}
				</div>
				${0}
			</div>
		`),this.getContainerId(),babelHelpers.classPrivateFieldLooseBase(this,w)[w].select.container,babelHelpers.classPrivateFieldLooseBase(this,w)[w].info.container,babelHelpers.classPrivateFieldLooseBase(this,w)[w].changeBtn.container,l,babelHelpers.classPrivateFieldLooseBase(this,w)[w].description);babelHelpers.classPrivateFieldLooseBase(this,C)[C]();babelHelpers.classPrivateFieldLooseBase(this,N)[N]();return babelHelpers.classPrivateFieldLooseBase(this,w)[w].container}formatSelectButton(e){babelHelpers.classPrivateFieldLooseBase(this,w)[w].select.button.className=`ui-btn ${e}`}format(e,s){babelHelpers.classPrivateFieldLooseBase(this,w)[w][e].className=s}validate(){const e=s.Type.isInteger(this.getRepresentativeId())&&this.getRepresentativeId()>0;if(e){s.Dom.removeClass(babelHelpers.classPrivateFieldLooseBase(this,w)[w].container.firstElementChild,"--invalid")}else{s.Dom.addClass(babelHelpers.classPrivateFieldLooseBase(this,w)[w].container.firstElementChild,"--invalid")}return e}load(e,s=t.EntityType.USER){const l=babelHelpers.classPrivateFieldLooseBase(this,T)[T].getDialog();l.subscribeOnce("onLoad",(()=>{const a=l.items.get(s);const i=a.get(`${e}`);i.select();babelHelpers.classPrivateFieldLooseBase(this,A)[A](i)}));l.load();babelHelpers.classPrivateFieldLooseBase(this,K)[K].id=e;babelHelpers.classPrivateFieldLooseBase(this,R)[R]=s}loadFistRepresentative(){const e=babelHelpers.classPrivateFieldLooseBase(this,T)[T].getDialog();e.subscribeOnce("onLoad",(()=>{const s=e.items.get("user");if(s.size===0){return}const l=s.values().next().value;l.select();babelHelpers.classPrivateFieldLooseBase(this,A)[A](l)}));e.load()}getRepresentativeId(){return babelHelpers.classPrivateFieldLooseBase(this,K)[K].id}getRepresentativeItemType(){return babelHelpers.classPrivateFieldLooseBase(this,R)[R]}onSelectorItemDeselectedHandler(e){babelHelpers.classPrivateFieldLooseBase(this,K)[K].id=null;babelHelpers.classPrivateFieldLooseBase(this,U)[U](e);babelHelpers.classPrivateFieldLooseBase(this,T)[T].setPreselectedEntityList([])}}function J(){const e=document.getElementById(this.getContainerId());if(e===null){return}const a=e.querySelector(`#${E}`);if(a===null){return}const i=new l.Menu({bindElement:a,cacheable:false,events:{onPopupClose:e=>{babelHelpers.classPrivateFieldLooseBase(this,O)[O]=false}}});if(babelHelpers.classPrivateFieldLooseBase(this,O)[O]){i.close();return}babelHelpers.classPrivateFieldLooseBase(this,O)[O]=true;i.addMenuItem({text:s.Loc.getMessage("SIGN_B2E_REPRESENTATIVE_SELECTOR_DELETE_BUTTON_TITLE"),onclick:()=>{e.remove();babelHelpers.classPrivateFieldLooseBase(this,j)[j](this.getContainerId());i.close()}});i.show()}function Q(){babelHelpers.classPrivateFieldLooseBase(this,w)[w].info.container.style.display="flex";BX.show(babelHelpers.classPrivateFieldLooseBase(this,w)[w].changeBtn.container);BX.show(babelHelpers.classPrivateFieldLooseBase(this,w)[w].description);BX.hide(babelHelpers.classPrivateFieldLooseBase(this,w)[w].select.container)}function Y(){BX.hide(babelHelpers.classPrivateFieldLooseBase(this,w)[w].info.container);BX.hide(babelHelpers.classPrivateFieldLooseBase(this,w)[w].changeBtn.container);BX.hide(babelHelpers.classPrivateFieldLooseBase(this,w)[w].description);BX.show(babelHelpers.classPrivateFieldLooseBase(this,w)[w].select.container)}function Z(){BX.bind(babelHelpers.classPrivateFieldLooseBase(this,w)[w].changeBtn.element,"click",(()=>babelHelpers.classPrivateFieldLooseBase(this,V)[V]()));BX.bind(babelHelpers.classPrivateFieldLooseBase(this,w)[w].select.button,"click",(()=>babelHelpers.classPrivateFieldLooseBase(this,V)[V]()));babelHelpers.classPrivateFieldLooseBase(this,T)[T].subscribe(a.UserSelectorEvent.onItemSelect,(e=>babelHelpers.classPrivateFieldLooseBase(this,U)[U](e)));babelHelpers.classPrivateFieldLooseBase(this,T)[T].subscribe(a.UserSelectorEvent.onItemDeselect,(e=>this.onSelectorItemDeselectedHandler(e)));babelHelpers.classPrivateFieldLooseBase(this,T)[T].subscribe(a.UserSelectorEvent.onHide,(e=>babelHelpers.classPrivateFieldLooseBase(this,k)[k](e)))}function ee(){babelHelpers.classPrivateFieldLooseBase(this,T)[T].getDialog().setTargetNode(babelHelpers.classPrivateFieldLooseBase(this,w)[w].container.firstElementChild);babelHelpers.classPrivateFieldLooseBase(this,T)[T].toggle()}function se(e){babelHelpers.classPrivateFieldLooseBase(this,$)[$](this.getContainerId())}function le(e){var s,l,a;babelHelpers.classPrivateFieldLooseBase(this,M)[M](this.getContainerId());if(!(e!=null&&(s=e.data)!=null&&s.items)||Number(e==null?void 0:(l=e.data)==null?void 0:(a=l.items)==null?void 0:a.length)===0){babelHelpers.classPrivateFieldLooseBase(this,K)[K].id=null;babelHelpers.classPrivateFieldLooseBase(this,C)[C]();babelHelpers.classPrivateFieldLooseBase(this,T)[T].setPreselectedEntityList([]);return}const i=e.data.items[0];babelHelpers.classPrivateFieldLooseBase(this,T)[T].setPreselectedEntityList([{id:i.id,type:i.entityId}]);babelHelpers.classPrivateFieldLooseBase(this,A)[A](i)}function ae(e){babelHelpers.classPrivateFieldLooseBase(this,R)[R]=e.entityId;if(e.entityId===t.EntityType.USER){babelHelpers.classPrivateFieldLooseBase(this,G)[G](e)}else if(e.entityId===t.EntityType.STRUCTURE_NODE_ROLE){babelHelpers.classPrivateFieldLooseBase(this,z)[z](e)}}function ie(e){var l,a,i,t,r;babelHelpers.classPrivateFieldLooseBase(this,K)[K].id=e.id;if(!s.Type.isInteger(babelHelpers.classPrivateFieldLooseBase(this,K)[K].id)||babelHelpers.classPrivateFieldLooseBase(this,K)[K].id<=0){return}const o=(l=(a=e.customData)==null?void 0:a.get("name"))!=null?l:"";const n=(i=(t=e.customData)==null?void 0:t.get("lastName"))!=null?i:"";babelHelpers.classPrivateFieldLooseBase(this,K)[K].name=s.Type.isStringFilled(o)?o:"";if(s.Type.isStringFilled(n)){if(s.Type.isStringFilled(o)){babelHelpers.classPrivateFieldLooseBase(this,K)[K].name+=" "}babelHelpers.classPrivateFieldLooseBase(this,K)[K].name+=n}if(!s.Type.isStringFilled(babelHelpers.classPrivateFieldLooseBase(this,K)[K].name)){var b,c;babelHelpers.classPrivateFieldLooseBase(this,K)[K].name=(b=(c=e.customData)==null?void 0:c.get("login"))!=null?b:""}babelHelpers.classPrivateFieldLooseBase(this,K)[K].position=((r=e.customData)==null?void 0:r.get("position"))||"";babelHelpers.classPrivateFieldLooseBase(this,K)[K].avatarLink=(e==null?void 0:e.avatar)||f;babelHelpers.classPrivateFieldLooseBase(this,W)[W]()}function te(e){babelHelpers.classPrivateFieldLooseBase(this,K)[K].id=e.id;if(!s.Type.isInteger(babelHelpers.classPrivateFieldLooseBase(this,K)[K].id)||babelHelpers.classPrivateFieldLooseBase(this,K)[K].id<=0){return}babelHelpers.classPrivateFieldLooseBase(this,K)[K].name=e.title;babelHelpers.classPrivateFieldLooseBase(this,K)[K].avatarLink=f;babelHelpers.classPrivateFieldLooseBase(this,W)[W]()}function re(){var e,l,a;babelHelpers.classPrivateFieldLooseBase(this,w)[w].info.title.name.innerText=s.Text.encode((e=babelHelpers.classPrivateFieldLooseBase(this,K)[K])==null?void 0:e.name);babelHelpers.classPrivateFieldLooseBase(this,w)[w].info.title.position.innerText=s.Text.encode((l=babelHelpers.classPrivateFieldLooseBase(this,K)[K])==null?void 0:l.position);babelHelpers.classPrivateFieldLooseBase(this,w)[w].info.avatar.src=(a=babelHelpers.classPrivateFieldLooseBase(this,K)[K])==null?void 0:a.avatarLink;babelHelpers.classPrivateFieldLooseBase(this,x)[x]()}e.RepresentativeSelector=q})(this.BX.Sign.V2.B2e=this.BX.Sign.V2.B2e||{},BX,BX.Main,BX.Sign.V2.B2e,BX.Sign.V2,BX.Sign);
//# sourceMappingURL=representative-selector.bundle.map.js