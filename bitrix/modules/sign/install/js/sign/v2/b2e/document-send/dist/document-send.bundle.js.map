{"version":3,"file":"document-send.bundle.js","sources":["../src/item.js","../src/index.js"],"sourcesContent":["import { Tag, Type, Dom, Loc, Text as TextFormat } from 'main.core';\nimport { Loader } from 'main.loader';\nimport type { MemberRoleType } from 'sign.type';\nimport { Dialog } from 'ui.entity-selector';\nimport { Api } from 'sign.v2.api';\n\nexport type ItemData = {\n\tentityType: string,\n\tentityId: number,\n\trole?: MemberRoleType,\n};\n\ntype ItemViewData = {\n\theader: string,\n\tfooter: string,\n\tavatar: ?string,\n};\n\nexport const EntityTypes = Object.freeze({\n\tUser: 'user',\n\tCompany: 'company',\n\tRole: 'structure-node-role',\n});\n\nexport class Item\n{\n\t#api: Api;\n\t#ui = {\n\t\tcontainer: HTMLDivElement = null,\n\t\tavatar: HTMLDivElement = null,\n\t\ttitle: {\n\t\t\tcontainer: HTMLDivElement = null,\n\t\t\theader: HTMLDivElement = null,\n\t\t\tfooter: HTMLDivElement = null,\n\t\t},\n\t};\n\n\t#dataDialog: ?Dialog = null;\n\t#loader: ?Loader = null;\n\n\t#data: ?ItemData = null;\n\t#viewData: ?ItemViewData = null;\n\n\tconstructor(data: ItemData)\n\t{\n\t\tthis.#api = new Api();\n\t\tthis.#data = data;\n\t\tthis.#ui.container = this.getLayout();\n\t\tif (Type.isStringFilled(data?.entityType) && Type.isInteger(data?.entityId))\n\t\t{\n\t\t\tthis.#load();\n\t\t}\n\t}\n\n\tsetItemData(data: ItemData): void\n\t{\n\t\tif (this.#data.entityId === data.entityId && this.#data.entityType === data.entityType)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis.#data = data;\n\t\tif (Type.isStringFilled(data?.entityType) && Type.isInteger(data?.entityId))\n\t\t{\n\t\t\tthis.#load();\n\t\t}\n\t}\n\n\tgetLayout(): HTMLDivElement\n\t{\n\t\tif (this.#ui.container)\n\t\t{\n\t\t\treturn this.#ui.container;\n\t\t}\n\n\t\tconst modifier = this.#data.entityType === EntityTypes.User ? ' --user' : '';\n\t\tthis.#ui.avatar = Tag.render`<div class=\"sign-b2e-send__party_item-info-avatar${modifier}\"></div>`;\n\t\tthis.#ui.title.header = Tag.render`<div class=\"sign-b2e-send__party_item-info-header\"></div>`;\n\t\tthis.#ui.title.footer = Tag.render`<div class=\"sign-b2e-send__party_item-info-footer\"></div>`;\n\t\tthis.#ui.title.container = Tag.render`\n\t\t\t<div class=\"sign-b2e-send__party_item-info-title\">\n\t\t\t\t${this.#ui.title.header}\n\t\t\t\t${this.#ui.title.footer}\n\t\t\t</div>\n\t\t`;\n\n\t\tthis.#ui.container = Tag.render`\n\t\t\t<div class=\"sign-b2e-send__party_item-info\">\n\t\t\t\t${this.#ui.avatar}\n\t\t\t\t${this.#ui.title.container}\n\t\t\t</div>\n\t\t`;\n\n\t\treturn this.#ui.container;\n\t}\n\n\tasync #load(): Promise<void>\n\t{\n\t\tthis.#showLoader();\n\t\tswitch (this.#data.entityType)\n\t\t{\n\t\t\tcase EntityTypes.Company:\n\t\t\t{\n\t\t\t\tawait this.#loadCompany();\n\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tcase EntityTypes.User:\n\t\t\t{\n\t\t\t\tawait this.#loadUser();\n\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tcase EntityTypes.Role:\n\t\t\t{\n\t\t\t\tawait this.#loadRole();\n\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tdefault:\n\t\t\t{\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tthis.#refreshView();\n\t\tthis.#hideLoader();\n\t}\n\n\t#loadCompany(): Promise<void>\n\t{\n\t\treturn this.#api.loadB2eCompanyList()\n\t\t\t.then(data => {\n\t\t\t\tif (Type.isObject(data.companies) && Type.isArray(data.companies))\n\t\t\t\t{\n\t\t\t\t\tconst company = data.companies.filter(company => company.id === this.#data.entityId)[0] ?? null;\n\t\t\t\t\tif (company === null)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tconst footer = Type.isBoolean(data?.showTaxId) && data?.showTaxId && company?.rqInn\n\t\t\t\t\t\t? Loc.getMessage('SIGN_DOCUMENT_SUMMARY_COMPANY_INN',\n\t\t\t\t\t\t\t{ '%innValue%': TextFormat.encode(company?.rqInn) },\n\t\t\t\t\t\t)\n\t\t\t\t\t\t: null\n\t\t\t\t\t;\n\n\t\t\t\t\tthis.#viewData = {\n\t\t\t\t\t\theader: company?.title,\n\t\t\t\t\t\tfooter: footer,\n\t\t\t\t\t\tavatar: null,\n\t\t\t\t\t};\n\n\t\t\t\t\tthis.#refreshView();\n\t\t\t\t}\n\n\t\t\t\tthis.#hideLoader();\n\t\t\t}).catch((response) => {\n\t\t\t\tconsole.log(response);\n\t\t\t})\n\t\t;\n\t}\n\n\t#loadUser(): Promise<void>\n\t{\n\t\treturn new Promise((resolve) => {\n\t\t\tthis.#dataDialog = new Dialog({\n\t\t\t\tentities: [\n\t\t\t\t\t{ id: EntityTypes.User },\n\t\t\t\t],\n\t\t\t\tevents: {\n\t\t\t\t\t'onLoad': (event) => {\n\t\t\t\t\t\tconst user = this.#dataDialog.getSelectedItems()[0] ?? null;\n\t\t\t\t\t\tif (Type.isObject(user))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tconst lastName = user?.customData?.get('lastName') ?? '';\n\t\t\t\t\t\t\tthis.#viewData = {\n\t\t\t\t\t\t\t\theader: user?.customData?.get('name') + ' ' + lastName,\n\t\t\t\t\t\t\t\tfooter: user?.customData?.get('position') ?? '',\n\t\t\t\t\t\t\t\tavatar: user?.avatar ?? null,\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\tthis.#refreshView();\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tthis.#hideLoader();\n\t\t\t\t\t\tresolve();\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\tpreselectedItems: [[EntityTypes.User, this.#data.entityId]],\n\t\t\t});\n\n\t\t\tthis.#dataDialog.load();\n\t\t});\n\t}\n\n\t#loadRole(): Promise<void>\n\t{\n\t\treturn new Promise((resolve) => {\n\t\t\tthis.#dataDialog = new Dialog({\n\t\t\t\tentities: [\n\t\t\t\t\t{\n\t\t\t\t\t\tid: EntityTypes.Role,\n\t\t\t\t\t\tdynamicLoad: true,\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t\tevents: {\n\t\t\t\t\t'onLoad': (event) => {\n\t\t\t\t\t\tconst data = this.#dataDialog.getSelectedItems()[0] ?? null;\n\t\t\t\t\t\tif (Type.isObject(data))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.#viewData = {\n\t\t\t\t\t\t\t\theader: data.title ?? '',\n\t\t\t\t\t\t\t\tfooter: '',\n\t\t\t\t\t\t\t\tavatar: data?.avatar ?? null,\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\tthis.#refreshView();\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tthis.#hideLoader();\n\t\t\t\t\t\tresolve();\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\tpreselectedItems: [[EntityTypes.Role, this.#data.entityId]],\n\t\t\t});\n\n\t\t\tthis.#dataDialog.load();\n\t\t});\n\t}\n\n\t#refreshView(): void\n\t{\n\t\tif (this.#viewData?.avatar)\n\t\t{\n\t\t\tthis.#ui.avatar.style.backgroundImage = `url(\"${this.#viewData.avatar}\")`;\n\t\t}\n\n\t\tthis.#ui.title.header.innerText = this.#viewData.header;\n\t\tthis.#ui.title.header.title = this.#viewData.header;\n\t\tthis.#ui.title.footer.innerText = this.#viewData.footer;\n\t\tthis.#ui.title.footer.title = this.#viewData.footer;\n\t}\n\n\t#getLoader(): Loader\n\t{\n\t\tif (this.#loader)\n\t\t{\n\t\t\treturn this.#loader;\n\t\t}\n\n\t\tthis.#loader = new BX.Loader({\n\t\t\ttarget: this.#ui.container,\n\t\t\tmode: 'inline',\n\t\t\tsize: 40,\n\t\t});\n\n\t\treturn this.#loader;\n\t}\n\n\t#hideLoader(): void\n\t{\n\t\tthis.#ui.title.container.style.display = 'flex';\n\t\tthis.#ui.avatar.style.display = 'block';\n\t\tthis.#getLoader().hide();\n\t}\n\n\t#showLoader(): void\n\t{\n\t\tthis.#ui.avatar.style.display = 'none';\n\t\tthis.#ui.title.container.style.display = 'none';\n\t\tthis.#getLoader().show(this.#ui.container);\n\t}\n}\n","import { Tag, Loc, Type, Dom } from 'main.core';\nimport { EventEmitter, type BaseEvent } from 'main.core.events';\nimport { type DocumentDetails } from 'sign.v2.document-setup';\nimport { isTemplateMode } from 'sign.v2.sign-settings';\nimport { UserParty } from 'sign.v2.b2e.user-party';\nimport { ReminderSelector, type Options as ReminderOptions } from 'sign.v2.b2e.reminder-selector';\nimport type { MemberRoleType, DocumentModeType } from 'sign.type';\nimport { MemberRole, Reminder } from 'sign.type';\nimport { Item, EntityTypes } from './item';\nimport { Api, type Provider } from 'sign.v2.api';\nimport { ProviderCode } from 'sign.type';\nimport { DocumentSummary } from 'sign.v2.document-summary';\nimport { LangSelector } from 'sign.v2.lang-selector';\nimport { DatetimeLimitSelector } from 'sign.v2.datetime-limit-selector';\nimport type { PartiesData, DocumentData } from './type';\nimport type { DocumentSendConfig } from 'sign.v2.b2b.document-send';\nimport { Hint } from 'sign.v2.helper';\nimport { ProgressBar } from 'ui.progressbar';\nimport { HcmLinkPartyChecker } from 'sign.v2.b2e.hcm-link-party-checker';\nimport type { Analytics } from 'sign.v2.analytics';\n\nimport 'sign.v2.ui.notice';\nimport './style.css';\n\nexport type CommunicationType = 'idle' | 'phone' | 'email';\n\ntype CommunicationSelectedData = {\n\t[key: string]: {\n\t\tid: string,\n\t\toption: CommunicationType,\n\t}\n};\n\nconst ReminderSelectorOptionsByRole: Record<MemberRoleType, ReminderOptions> = {\n\t[MemberRole.assignee]: { preSelectedType: Reminder.oncePerDay },\n\t[MemberRole.signer]: { preSelectedType: Reminder.twicePerDay },\n};\n\nconst idleCommunication: CommunicationType = 'idle';\n\nconst fallbackDefaultMonths = 3;\n\nexport class DocumentSend extends EventEmitter\n{\n\tevents = Object.freeze({\n\t\tonTemplateComplete: 'onTemplateComplete',\n\t});\n\n\t#ui = {\n\t\tcontainer: HTMLDivElement = null,\n\t\temployeesTitle: HTMLParagraphElement,\n\t};\n\n\t#communicationSelectedOption: CommunicationSelectedData = {\n\t\tcompany: {\n\t\t\tid: 'company',\n\t\t\toption: idleCommunication,\n\t\t},\n\t\temployee: {\n\t\t\tid: 'employee',\n\t\t\toption: idleCommunication,\n\t\t},\n\t\tvalidation: {\n\t\t\tid: 'validation',\n\t\t\toption: idleCommunication,\n\t\t},\n\t};\n\n\t#items = {\n\t\tcompany: Item,\n\t\trepresentative: Item,\n\t\temployees: UserParty,\n\t\treviewers: UserParty,\n\t\teditor: Item,\n\t};\n\n\t#partiesData: ?PartiesData = null;\n\t#documentSummary: DocumentSummary;\n\t#documentData: Map<string, DocumentDetails>;\n\t#langSelector: LangSelector;\n\t#dateTimeLimitSelector: DatetimeLimitSelector | null = null;\n\t#progress: ProgressBar;\n\t#progressOverlay: ?HTMLElement;\n\t#progressContainer: ?HTMLElement;\n\t#itemsToHide: Array<HTMLElement> = [];\n\t#reminderSelectorByRole: Record<MemberRoleType, ReminderSelector> = {};\n\t#documentMode: DocumentModeType;\n\t#isExistingTemplate: boolean = false;\n\t#isOpenedFromRobot: boolean = false;\n\n\t#analytics: ?Analytics;\n\n\t#hcmLinkPartyChecker: HcmLinkPartyChecker | null = null;\n\n\t#provider: Provider | null = null;\n\n\tconstructor(documentSendConfig: DocumentSendConfig)\n\t{\n\t\tsuper();\n\t\tthis.setEventNamespace('BX.Sign.V2.B2e.DocumentSend');\n\t\tthis.#items.company = new Item({ entityType: EntityTypes.Company });\n\t\tthis.#items.representative = new Item({ entityType: EntityTypes.User });\n\t\tthis.#items.editor = new Item({ entityType: EntityTypes.User });\n\t\tthis.#items.employees = new UserParty({ mode: 'view', role: MemberRole.signer });\n\t\tthis.#items.reviewers = new UserParty({ mode: 'view', role: MemberRole.reviewer });\n\t\tthis.#documentSummary = new DocumentSummary({\n\t\t\tevents: {\n\t\t\t\tchangeTitle: (event: BaseEvent) => {\n\t\t\t\t\tconst data = event.getData();\n\t\t\t\t\tthis.emit('changeTitle', data);\n\t\t\t\t},\n\t\t\t\tshowEditor: (event: BaseEvent) => {\n\t\t\t\t\tconst data = event.getData();\n\t\t\t\t\tthis.emit('showEditor', data);\n\t\t\t\t},\n\t\t\t},\n\t\t});\n\t\tconst { region, languages, documentMode, isOpenedFromRobot, analytics } = documentSendConfig;\n\t\tthis.#isOpenedFromRobot = isOpenedFromRobot;\n\t\tthis.#langSelector = new LangSelector(region, languages);\n\t\tthis.#documentData = {};\n\t\tthis.#analytics = analytics;\n\t\tthis.#documentMode = documentMode;\n\t\tthis.#ui.employeesTitle = Tag.render`\n\t\t\t<p class=\"sign-b2e-send__party_signing-employees\">\n\t\t\t\t${Loc.getMessage('SIGN_SEND_SIGNING_EMPLOYEES', { '#CNT#': 0 })}\n\t\t\t</p>\n\t\t`;\n\t\tthis.#progress = new ProgressBar({\n\t\t\tmaxValue: 100,\n\t\t\tvalue: 0,\n\t\t\tcolorTrack: '#dfe3e6',\n\t\t});\n\n\t\t[MemberRole.assignee, MemberRole.signer].forEach((role: MemberRoleType) => {\n\t\t\tthis.#getOrCreateReminderSelectorForRole(role);\n\t\t});\n\n\t\tif (!this.#isTemplateMode())\n\t\t{\n\t\t\tthis.#hcmLinkPartyChecker = new HcmLinkPartyChecker({\n\t\t\t\tapi: new Api(),\n\t\t\t});\n\n\t\t\tthis.#hcmLinkPartyChecker.subscribe(\n\t\t\t\t'updateValidation',\n\t\t\t\t(event) => this.#onHcmLinkCheckerUpdateValidation(event),\n\t\t\t);\n\t\t}\n\n\t\tif (!this.#isTemplateMode())\n\t\t{\n\t\t\tconst defaultDate = new Date();\n\t\t\tdefaultDate.setMonth(defaultDate.getMonth() + fallbackDefaultMonths);\n\t\t\tthis.#dateTimeLimitSelector = new DatetimeLimitSelector(defaultDate);\n\n\t\t\tthis.#dateTimeLimitSelector\n\t\t\t\t.subscribe('beforeDateModify', (event) => {\n\t\t\t\t\tthis.emit('disableComplete');\n\t\t\t\t})\n\t\t\t\t.subscribe('afterDateModify', (event) => {\n\t\t\t\t\tif (event.data.isValid === true)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.emit('enableComplete');\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t;\n\t\t}\n\t}\n\n\tget documentData(): DocumentData\n\t{\n\t\treturn this.#documentData;\n\t}\n\n\tset hcmLinkEnabled(value: boolean): void\n\t{\n\t\tthis.#hcmLinkPartyChecker?.setEnabled(value);\n\t}\n\n\tset documentData(documentData: Map<string, DocumentDetails>)\n\t{\n\t\tdocumentData.forEach((data) => {\n\t\t\tconst { uid, id, title, blocks, externalId, isTemplate, entityId, urls } = data;\n\t\t\tthis.#documentSummary.addItem(uid, { uid, id, title, blocks, externalId, isTemplate, entityId, urls });\n\t\t});\n\n\t\tthis.#documentData = documentData;\n\n\t\tconst uids = [...documentData.values()].map(data => data.uid);\n\t\tconst lastUid = [...documentData.values()].pop().uid;\n\t\tconst documentGroupUids = [...documentData.keys()];\n\n\t\tthis.#langSelector.setDocumentUids(uids);\n\n\t\tif (!Type.isNull(this.#dateTimeLimitSelector))\n\t\t{\n\t\t\tthis.#dateTimeLimitSelector.setDocumentUids(uids);\n\n\t\t\tif (Type.isNull(this.#dateTimeLimitSelector.getSelectedDate()))\n\t\t\t{\n\t\t\t\tconst untilDate = this.#getDateSignUntilFromDocumentDetails(documentData?.values().next().value);\n\t\t\t\tthis.#dateTimeLimitSelector.setDate(untilDate);\n\t\t\t}\n\t\t}\n\n\t\tthis.#items.employees.setDocumentUid(lastUid);\n\t\tthis.#items.reviewers.setDocumentUid(lastUid);\n\n\t\tthis.#hcmLinkPartyChecker?.setDocumentGroupUids(documentGroupUids);\n\t\tvoid this.#hcmLinkPartyChecker?.check();\n\t}\n\n\t#getDateSignUntilFromDocumentDetails(documentDetails: DocumentDetails): Date\n\t{\n\t\treturn documentDetails?.dateSignUntil\n\t\t\t? new Date(documentDetails?.dateSignUntil)\n\t\t\t: new Date(new Date().setMonth(new Date().getMonth() + fallbackDefaultMonths))\n\t\t;\n\t}\n\n\t#getProgressAnimateLayout(): HTMLElement\n\t{\n\t\tconst createDocumentOverlapLayout = (docsCount: number) => {\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"sign-b2e-overlay__overlap-docs\">\n\t\t\t\t\t${Array.from({ length: docsCount }).map(() => {\n\t\t\t\t\t\treturn Tag.render`\n\t\t\t\t\t\t\t<div class=\"sign-b2e-overlay__overlap-doc\"></div>\n\t\t\t\t\t\t`;\n\t\t\t\t\t})}\n\t\t\t\t</div>\n\t\t\t`;\n\t\t};\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"sign-b2e-overlay__animate-layout\">\n\t\t\t\t${createDocumentOverlapLayout(4)}\n\t\t\t\t${createDocumentOverlapLayout(3)}\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tgetLayout(): HTMLElement\n\t{\n\t\tconst layout = Tag.render`\n\t\t\t<div class=\"sign-b2e-send\">\n\t\t\t\t<h1 class=\"sign-b2e-settings__header\">${Loc.getMessage('SIGN_DOCUMENT_SEND_HEADER_1')}</h1>\n\t\t\t</div>\n\t\t`;\n\n\t\tconst summaryTitle = this.#isTemplateMode()\n\t\t\t? Loc.getMessage('SIGN_DOCUMENT_SUMMARY_TEMPLATE_TITLE')\n\t\t\t: Loc.getMessage('SIGN_DOCUMENT_SUMMARY_TITLE')\n\t\t;\n\n\t\tthis.#itemsToHide = [];\n\t\tconst summaryLayout = Tag.render`\n\t\t\t<div class=\"sign-b2e-settings__item\">\n\t\t\t\t<p class=\"sign-b2e-settings__item_title\">\n\t\t\t\t\t${summaryTitle}\n\t\t\t\t</p>\n\t\t\t\t${this.#documentSummary.getLayout()}\n\t\t\t\t${this.#renderLangAndDateContainer()}\n\t\t\t</div>\n\t\t`;\n\t\tthis.#itemsToHide.push(summaryLayout);\n\n\t\tlet usersLayout = null;\n\t\tif (!this.#isTemplateMode())\n\t\t{\n\t\t\tusersLayout = Tag.render`\n\t\t\t\t<div class=\"sign-b2e-settings__item\">\n\t\t\t\t\t<p class=\"sign-b2e-settings__item_title\">\n\t\t\t\t\t\t${Loc.getMessage('SIGN_DOCUMENT_SEND_SECOND_PARTY')}\n\t\t\t\t\t</p>\n\t\t\t\t\t${this.#ui.employeesTitle}\n\t\t\t\t\t${this.#items.employees.getLayout()}\n\t\t\t\t\t<div class=\"sign-b2e-send__config-container\">\n\t\t\t\t\t\t${this.#getCommunicationsLayout('employee')}\n\t\t\t\t\t\t${this.#getReminderSelectorLayout(MemberRole.signer)}\n\t\t\t\t\t</div>\n\t\t\t\t\t${this.#hcmLinkPartyChecker.render()}\n\t\t\t\t</div>\n\t\t\t`;\n\t\t\tthis.#itemsToHide.push(usersLayout);\n\t\t}\n\t\tconst itemTitleText = this.#isTemplateMode()\n\t\t\t? Loc.getMessage('SIGN_DOCUMENT_SEND_FIRST_PARTY_TEMPLATE')\n\t\t\t: Loc.getMessage('SIGN_DOCUMENT_SEND_FIRST_PARTY')\n\t\t;\n\t\tconst companyLayout = Tag.render`\n\t\t\t<div class=\"sign-b2e-settings__item\">\n\t\t\t\t<p class=\"sign-b2e-settings__item_title\">\n\t\t\t\t\t${itemTitleText}\n\t\t\t\t</p>\n\t\t\t\t<div class=\"sign-b2e-send__company-items\">\n\t\t\t\t\t<div class=\"sign-b2e-send__company-items_flex\">\n\t\t\t\t\t\t<p class=\"sign-b2e-send__company-items_item-title\">\n\t\t\t\t\t\t\t${Loc.getMessage('SIGN_SEND_SIGNING_COMPANY')}\n\t\t\t\t\t\t</p>\n\t\t\t\t\t\t<span class=\"sign-b2e-send__company-items_shrunk\"></span>\n\t\t\t\t\t\t<p class=\"sign-b2e-send__company-items_item-title\">\n\t\t\t\t\t\t\t${Loc.getMessage('SIGN_SEND_SIGNING_REPRESENTATIVE')}\n\t\t\t\t\t\t</p>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"sign-b2e-send__company-items_flex\">\n\t\t\t\t\t\t${this.#items.company.getLayout()}\n\t\t\t\t\t\t<span class=\"sign-b2e-send__company-items_shrunk sign-b2e-send__party-item-separator\">\n\t\t\t\t\t\t\t&#43;\n\t\t\t\t\t\t</span>\n\t\t\t\t\t\t${this.#items.representative.getLayout()}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"sign-b2e-send__config-container\">\n\t\t\t\t\t${this.#getCommunicationsLayout('company')}\n\t\t\t\t\t${this.#getReminderSelectorLayout(MemberRole.assignee)}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t\tthis.#itemsToHide.push(companyLayout);\n\t\tDom.append(summaryLayout, layout);\n\t\tconst reviewerHeaderText = this.#isTemplateMode()\n\t\t\t? Loc.getMessage('SIGN_SEND_SIGNING_VALIDATION_HEAD_REVIEWER_TEMPLATE')\n\t\t\t: Loc.getMessage('SIGN_SEND_SIGNING_VALIDATION_HEAD_REVIEWER')\n\t\t;\n\t\tconst validationTitles = {\n\t\t\t[MemberRole.editor]: {\n\t\t\t\theader: Loc.getMessage('SIGN_SEND_SIGNING_VALIDATION_HEAD_EDITOR'),\n\t\t\t\thint: Loc.getMessage('SIGN_SEND_SIGNING_VALIDATION_TITLE_EDITOR'),\n\t\t\t},\n\t\t};\n\n\t\tthis.#partiesData.validation.forEach(({ role }): void => {\n\t\t\tif (role === MemberRole.reviewer)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst roleBlockLayout = this.#items[role].getLayout();\n\t\t\tif (!roleBlockLayout)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst { hint, header } = validationTitles[role];\n\t\t\tconst validationLayout = this.#getPartyLayout(header, hint, roleBlockLayout);\n\t\t\tthis.#itemsToHide.push(validationLayout);\n\t\t\tDom.append(validationLayout, layout);\n\t\t});\n\n\t\tif (this.#items.reviewers.getPreselectedUserData().length > 0)\n\t\t{\n\t\t\tconst reviewerListLayout = Tag.render`\n\t\t\t\t<div class=\"sign-b2e-document-send-reviewers\">\n\t\t\t\t\t${this.#items.reviewers.getLayout()}\n\t\t\t\t</div>\n\t\t\t`;\n\t\t\tconst reviewersLayout = this.#getPartyLayout(\n\t\t\t\treviewerHeaderText,\n\t\t\t\tLoc.getMessage('SIGN_SEND_SIGNING_VALIDATION_TITLE_REVIEWER_MSGVER_1'),\n\t\t\t\treviewerListLayout,\n\t\t\t);\n\t\t\tthis.#itemsToHide.push(reviewersLayout);\n\t\t\tDom.append(reviewersLayout, layout);\n\t\t}\n\n\t\tDom.append(companyLayout, layout);\n\t\tif (!Type.isNull(usersLayout))\n\t\t{\n\t\t\tDom.append(usersLayout, layout);\n\t\t}\n\n\t\tthis.#progressContainer = Tag.render`<div class=\"send-b2e-progress-container\"></div>`;\n\t\tthis.#progress.renderTo(this.#progressContainer);\n\n\t\tthis.#progressOverlay = this.#isTemplateMode() ? this.#getTemplateProgressOverlay()\n\t\t\t: this.#getProgressOverlay();\n\n\t\tDom.style(this.#progressOverlay, 'display', 'none');\n\t\tthis.emit('appendOverlay', { overlay: this.#progressOverlay });\n\t\tHint.create(layout);\n\n\t\treturn layout;\n\t}\n\n\t#getPartyLayout(header: string, hint: string, layout: HTMLDivElement): HTMLDivElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"sign-b2e-settings__item\">\n\t\t\t\t<p class=\"sign-b2e-settings__item_title\">\n\t\t\t\t\t${header}\n\t\t\t\t</p>\n\t\t\t\t<div class=\"sign-b2e-send__party_item\">\n\t\t\t\t\t<p class=\"sign-b2e-send__company-items_item-title\">\n\t\t\t\t\t\t${hint}\n\t\t\t\t\t</p>\n\t\t\t\t\t${layout}\n\t\t\t\t\t${this.#getCommunicationsLayout('validation')}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\t#renderLangAndDateContainer(): HTMLElement\n\t{\n\t\tconst showSignUntil = !Type.isNull(this.#dateTimeLimitSelector);\n\n\t\tconst dateSignUntilLayout = showSignUntil\n\t\t\t? this.#renderDateSignUntilSelectorLayout()\n\t\t\t: null\n\t\t;\n\n\t\tconst goskeySignUntilNotice = showSignUntil && this.#provider?.code === ProviderCode.goskey\n\t\t\t? this.#renderGoskeyAlertForSignUntilSelector()\n\t\t\t: null\n\t\t;\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"sign-b2e-send__lang-dt-container\">\n\t\t\t\t${this.#renderLangSelectorLayout()}\n\t\t\t\t${dateSignUntilLayout}\n\t\t\t\t${goskeySignUntilNotice}\n\t\t\t</div>\n\t\t`;\n\t}\n\n\t#renderLangSelectorLayout(): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"sign-b2e-send__lang-selector\">\n\t\t\t\t${this.#langSelector.getLayout()}\n\t\t\t\t<span\n\t\t\t\t\tdata-hint=\"${Loc.getMessage('SIGN_DOCUMENT_SEND_LANG_SELECTOR_HINT')}\"\n\t\t\t\t></span>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\t#renderDateSignUntilSelectorLayout(): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"sign-b2e-send__datetime-limit-selector\">\n\t\t\t\t${this.#dateTimeLimitSelector.getLayout()}\n\t\t\t\t<span\n\t\t\t\t\tdata-hint=\"${Loc.getMessage('SIGN_DOCUMENT_SEND_DATETIME_LIMIT_SELECTOR_HINT')}\"\n\t\t\t\t></span>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\t#renderGoskeyAlertForSignUntilSelector(): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<p class=\"sign-wizard__notice\">\n\t\t\t\t${Loc.getMessage('SIGN_DOCUMENT_SEND_DATETIME_LIMIT_SELECTOR_GOSKEY_ALERT')}\n\t\t\t</p>\n\t\t`;\n\t}\n\n\t#getProgressOverlay(): HTMLElement\n\t{\n\t\tconst closeDescriptionText = Loc.getMessage('SIGN_SEND_CLOSE_DESCRIPTION');\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"send-b2e-overlay\">\n\t\t\t\t<div class=\"sign-b2e-overlay-content\">\n\t\t\t\t\t${this.#getProgressAnimateLayout()}\n\t\t\t\t\t<div class=\"sign-b2e-overlay-progress-title\">\n\t\t\t\t\t\t${Loc.getMessage('SIGN_SEND_PROGRESS_TITLE')}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"sign-b2e-overlay-close-description\">\n\t\t\t\t\t\t${closeDescriptionText}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div>\n\t\t\t\t\t\t${this.#getCloseBtn()}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t${this.#progressContainer}\n\t\t\t</div>\n\t\t`;\n\t}\n\n\t#getTemplateProgressOverlay(): HTMLElement\n\t{\n\t\tconst templateTitle = this.#isExistingTemplate ? Loc.getMessage('SIGN_SETTINGS_TEMPLATE_CHANGED')\n\t\t\t: Loc.getMessage('SIGN_SETTINGS_TEMPLATE_CREATED');\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"sign-b2e-template-status\">\n\t\t\t\t<div class=\"sign-b2e-template-status-inner\">\n\t\t\t\t\t<div class=\"sign-b2e-template-status-img\"></div>\n\t\t\t\t\t<div class=\"sign-b2e-template-status-title\">${templateTitle}</div>\n\t\t\t\t\t<div class=\"sign-b2e-template-status-info\">${Loc.getMessage('SIGN_SETTINGS_TEMPLATE_CREATED_INFO')}</div>\n\t\t\t\t\t${this.#getAllTemplatesBtn()}\n\t\t\t\t\t</div>\n\t\t\t </div>\n\t\t`;\n\t}\n\n\tsetExistingTemplate(): void\n\t{\n\t\tthis.#isExistingTemplate = true;\n\t}\n\n\t#getCloseBtn(): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<button\n\t\t\t\tclass=\"ui-btn ui-btn-light-border ui-btn-round\"\n\t\t\t\tonclick=\"${() => this.emit('close')}\">\n\t\t\t\t${Loc.getMessage('SIGN_SEND_CLOSE_BTN')}\n\t\t\t</button>\n\t\t`;\n\t}\n\n\t#getAllTemplatesBtn(): HTMLElement | null\n\t{\n\t\tif (this.#isOpenedFromRobot)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\treturn Tag.render`\n\t\t\t<button class=\"ui-btn ui-btn-light-border ui-btn-round\" onclick=\"BX.SidePanel.Instance.close();\">\n\t\t\t\t${Loc.getMessage('SIGN_SETTINGS_TEMPLATES_LIST')}\n\t\t\t</button>\n\t\t`;\n\t}\n\n\tresetUserPartyPopup(): DocumentSend\n\t{\n\t\tthis.#items.employees.resetUserPartyPopup();\n\t\tthis.#items.reviewers.resetUserPartyPopup();\n\n\t\treturn this;\n\t}\n\n\tsetProvider(provider: Provider | null): DocumentSend\n\t{\n\t\tthis.#provider = provider;\n\n\t\treturn this;\n\t}\n\n\tsetPartiesData(parties: PartiesData): DocumentSend\n\t{\n\t\tthis.#partiesData = parties;\n\n\t\tif (Type.isNumber(parties?.company?.entityId))\n\t\t{\n\t\t\tthis.#items.company.setItemData({\n\t\t\t\tentityId: parties?.company?.entityId,\n\t\t\t\tentityType: parties?.company?.entityType,\n\t\t\t});\n\t\t}\n\n\t\tif (Type.isNumber(parties?.representative?.entityId))\n\t\t{\n\t\t\tthis.#items.representative.setItemData({\n\t\t\t\tentityId: parties?.representative?.entityId,\n\t\t\t\tentityType: parties?.representative?.entityType,\n\t\t\t});\n\t\t}\n\n\t\tif (Type.isArrayFilled(parties?.employees))\n\t\t{\n\t\t\tthis.#items.employees.setUserIds(parties?.employees.map((employee) => {\n\t\t\t\treturn { entityId: employee.entityId, entityType: employee.entityType };\n\t\t\t}));\n\t\t}\n\n\t\tif (Type.isArrayFilled(parties?.validation))\n\t\t{\n\t\t\tconst reviewerIdList = [];\n\t\t\tparties.validation.forEach((party) => {\n\t\t\t\tconst { entityId, entityType, role } = party;\n\t\t\t\tif (role === MemberRole.reviewer)\n\t\t\t\t{\n\t\t\t\t\treviewerIdList.push({ entityId, entityType });\n\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tthis.#items[role].setItemData({ entityId, entityType });\n\t\t\t});\n\n\t\t\tif (reviewerIdList.length > 0)\n\t\t\t{\n\t\t\t\tthis.#items.reviewers.setUserIds(reviewerIdList);\n\t\t\t}\n\t\t}\n\n\t\tthis.#refreshView();\n\n\t\treturn this;\n\t}\n\n\tasync sendForSign(): Promise<boolean>\n\t{\n\t\tconst api = new Api();\n\n\t\ttry\n\t\t{\n\t\t\tthis.emit('disableBack');\n\t\t\tawait this.#saveReminderTypesForRoles();\n\n\t\t\tthis.#showProgressOverlay();\n\t\t\tif (this.#isTemplateMode())\n\t\t\t{\n\t\t\t\tconst { template: { id: templateId } } = await api.template.completeTemplate(this.documentData.values().next().value.templateUid);\n\t\t\t\tthis.emit('onTemplateComplete', { templateId });\n\t\t\t}\n\t\t\telse if (this.#isGroupDocuments())\n\t\t\t{\n\t\t\t\tconst groupId = this.#getGroupIdFromGroup();\n\t\t\t\tconst configureDocumentGroupPromise = api.configureDocumentGroup(groupId);\n\t\t\t\tconst groupCheckFillAndStartProgressPromise = this.#groupCheckFillAndStartProgress(groupId);\n\n\t\t\t\tawait Promise.all([configureDocumentGroupPromise, groupCheckFillAndStartProgressPromise]);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tfor (const [uid] of this.documentData)\n\t\t\t\t{\n\t\t\t\t\tconst configureDocumentPromise = api.configureDocument(uid);\n\t\t\t\t\tconst checkFillAndStartProgressPromise = this.#checkFillAndStartProgress(uid);\n\n\t\t\t\t\tawait Promise.all([configureDocumentPromise, checkFillAndStartProgressPromise]);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn true;\n\t\t}\n\t\tcatch (ex)\n\t\t{\n\t\t\tconsole.error(ex);\n\t\t\tthis.#hideProgressOverlay();\n\t\t\tthis.emit('enableBack');\n\n\t\t\treturn false;\n\t\t}\n\t}\n\n\tdeleteDocument(uid: string): void\n\t{\n\t\tthis.#documentSummary.deleteItem(uid);\n\t}\n\n\tsetDocumentsBlock(documents): void\n\t{\n\t\tconst documentsObject = Object.fromEntries(documents);\n\t\tthis.#documentSummary.setItems(documentsObject);\n\t}\n\n\tasync #checkFillAndStartProgress(uid: string): Promise<void>\n\t{\n\t\tconst api = new Api();\n\t\tlet completed = false;\n\t\twhile (!completed)\n\t\t{\n\t\t\t// eslint-disable-next-line no-await-in-loop\n\t\t\tconst result = await api.getDocumentFillAndStartProgress(uid);\n\t\t\tcompleted = result.completed;\n\t\t\tthis.#progress.update(Math.round(result.progress));\n\t\t\t// eslint-disable-next-line no-await-in-loop\n\t\t\tawait this.#sleep(1000);\n\t\t}\n\t}\n\n\tasync #groupCheckFillAndStartProgress(groupId: number): Promise<void>\n\t{\n\t\tconst api = new Api();\n\t\tlet completed = false;\n\t\twhile (!completed)\n\t\t{\n\t\t\t// eslint-disable-next-line no-await-in-loop\n\t\t\tconst result = await api.getDocumentGroupFillAndStartProgress(groupId);\n\t\t\tcompleted = result.completed;\n\t\t\tthis.#progress.update(Math.round(result.progress));\n\t\t\t// eslint-disable-next-line no-await-in-loop\n\t\t\tawait this.#sleep(2000);\n\t\t}\n\t}\n\n\tisDateTimeLimitSelectorValid(): boolean\n\t{\n\t\treturn this.#dateTimeLimitSelector ? this.#dateTimeLimitSelector.isValid() : true;\n\t}\n\n\t#sleep(ms: Number): Promise\n\t{\n\t\treturn new Promise((resolve) => {\n\t\t\tsetTimeout(resolve, ms);\n\t\t});\n\t}\n\n\t#refreshView(): void\n\t{\n\t\tthis.#ui.employeesTitle.innerText = Loc.getMessage(\n\t\t\t'SIGN_SEND_SIGNING_EMPLOYEES',\n\t\t\t{ '#CNT#': this.#partiesData?.employees?.length ?? 0 },\n\t\t);\n\t}\n\n\t#getCommunicationsLayout(communicationChannelId: string): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"sign-b2e-send__communications\">\n\t\t\t\t<span class=\"sign-b2e-send__communications_title\">\n\t\t\t\t\t${Loc.getMessage('SIGN_DOCUMENT_SEND_COMMUNICATION_TITLE_MSGVER_1')}\n\t\t\t\t</span>\n\t\t\t\t<div class=\"sign-b2e-send__communications_communication-type\">\n\t\t\t\t\t<span class=\"sign-b2e-send__communications_communication-type-text\">\n\t\t\t\t\t\t${Loc.getMessage('SIGN_DOCUMENT_SEND_COMMUNICATION_CHANEL_IDLE')}\n\t\t\t\t\t</span>\n\t\t\t\t\t<span\n\t\t\t\t\t\tdata-hint=\"${Loc.getMessage('SIGN_DOCUMENT_SEND_COMMUNICATION_CHANEL_HINT')}\"\n\t\t\t\t\t></span>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\t#showProgressOverlay(): void\n\t{\n\t\tthis.#progress.update(0);\n\t\tthis.emit('hidePreview');\n\t\tthis.#itemsToHide.forEach((item) => Dom.hide(item));\n\t\tDom.style(this.#progressOverlay, 'display', 'flex');\n\t\tthis.emit('showOverlay');\n\t}\n\n\t#hideProgressOverlay(): void\n\t{\n\t\tthis.#itemsToHide.forEach((item) => Dom.show(item));\n\t\tthis.emit('hideOverlay');\n\t\tDom.style(this.#progressOverlay, 'display', 'none');\n\t\tthis.emit('showPreview');\n\t}\n\n\t#getReminderSelectorLayout(role: MemberRoleType): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"sign-b2e-send__reminder-selector\">\n\t\t\t\t${this.#getOrCreateReminderSelectorForRole(role).getLayout()}\n\t\t\t\t<span\n\t\t\t\t\tdata-hint=\"${Loc.getMessage('SIGN_DOCUMENT_SEND_REMINDER_TYPE_SELECTOR_HINT')}\"\n\t\t\t\t></span>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\t#getOrCreateReminderSelectorForRole(role: MemberRoleType): ReminderSelector\n\t{\n\t\tthis.#reminderSelectorByRole[role] ??= new ReminderSelector(ReminderSelectorOptionsByRole[role] ?? {});\n\n\t\treturn this.#reminderSelectorByRole[role];\n\t}\n\n\t#saveReminderTypesForRoles(): Promise<void>\n\t{\n\t\tconst uid = this.#getFirstDocumentUidFromGroup();\n\t\tconst promises: Array<Promise> = Object.entries(this.#reminderSelectorByRole)\n\t\t\t.map(([role, selector]) => selector.save(uid, role))\n\t\t;\n\n\t\treturn Promise.all(promises);\n\t}\n\n\t#getFirstDocumentUidFromGroup(): string\n\t{\n\t\treturn this.documentData.keys().next().value;\n\t}\n\n\t#isTemplateMode(): boolean\n\t{\n\t\treturn isTemplateMode(this.#documentMode);\n\t}\n\n\t#isGroupDocuments(): boolean\n\t{\n\t\treturn this.documentData.size > 1;\n\t}\n\n\t#getGroupIdFromGroup(): string\n\t{\n\t\treturn this.documentData.values().next().value.groupId;\n\t}\n\n\t#onHcmLinkCheckerUpdateValidation(event: BaseEvent): void\n\t{\n\t\tconst enableComplete = event?.data ?? false;\n\n\t\tthis.emit(\n\t\t\tenableComplete\n\t\t\t\t? 'enableComplete'\n\t\t\t\t: 'disableComplete',\n\t\t);\n\t}\n}\n"],"names":["EntityTypes","Object","freeze","User","Company","Role","Item","data","babelHelpers","_classPrivateMethodInitSpec","_classPrivateFieldInitSpec","writable","value","container","HTMLDivElement","avatar","title","header","footer","Api","this","getLayout","Type","isStringFilled","entityType","isInteger","entityId","_classPrivateMethodGet","key","modifier","Tag","render","_load3","_context","loadB2eCompanyList","then","isObject","companies","isArray","company","filter","id","isBoolean","showTaxId","rqInn","Loc","getMessage","%innValue%","TextFormat","encode","_this","response","console","log","Promise","resolve","Dialog","entities","events","onLoad","event","user","getSelectedItems","lastName","customData","_user$customData","get","_user$customData2","_user$customData3","_this2","preselectedItems","load","dynamicLoad","_this3","_babelHelpers$classPr3","style","backgroundImage","innerText","BX","Loader","target","mode","size","display","hide","show","ReminderSelectorOptionsByRole","MemberRole","assignee","preSelectedType","Reminder","oncePerDay","signer","twicePerDay","DocumentSend","documentSendConfig","onTemplateComplete","employeesTitle","HTMLParagraphElement","option","employee","validation","representative","employees","UserParty","reviewers","editor","setEventNamespace","role","reviewer","DocumentSummary","changeTitle","getData","emit","showEditor","region","languages","documentMode","isOpenedFromRobot","analytics","LangSelector","#CNT#","ProgressBar","maxValue","colorTrack","forEach","HcmLinkPartyChecker","api","subscribe","defaultDate","Date","setMonth","getMonth","DatetimeLimitSelector","isValid","layout","summaryTitle","summaryLayout","push","usersLayout","itemTitleText","companyLayout","Dom","append","reviewerHeaderText","validationTitles","hint","roleBlockLayout","validationLayout","getPreselectedUserData","length","reviewerListLayout","reviewersLayout","isNull","renderTo","overlay","Hint","create","resetUserPartyPopup","provider","parties","_parties$representati","isNumber","_parties$company","setItemData","_parties$company2","_parties$company3","_parties$representati2","_parties$representati3","isArrayFilled","setUserIds","map","reviewerIdList","party","template","completeTemplate","documentData","values","next","templateUid","_yield$api$template$c","templateId","groupId","configureDocumentGroupPromise","configureDocumentGroup","groupCheckFillAndStartProgressPromise","all","_iterator","_step$value","uid","configureDocumentPromise","configureDocument","checkFillAndStartProgressPromise","error","deleteItem","documents","documentsObject","fromEntries","setItems","set","_babelHelpers$classPr","_babelHelpers$classPr2","blocks","externalId","isTemplate","urls","addItem","uids","lastUid","pop","documentGroupUids","keys","setDocumentUids","getSelectedDate","untilDate","setDate","setDocumentUid","setDocumentGroupUids","check","setEnabled","EventEmitter","documentDetails","dateSignUntil","createDocumentOverlapLayout","docsCount","Array","from","showSignUntil","dateSignUntilLayout","goskeySignUntilNotice","_babelHelpers$classPr4","code","ProviderCode","goskey","closeDescriptionText","templateTitle","_this5","_checkFillAndStartProgress3","completed","_context2","getDocumentFillAndStartProgress","result","update","Math","round","progress","_groupCheckFillAndStartProgress3","_context3","getDocumentGroupFillAndStartProgress","ms","setTimeout","_babelHelpers$classPr6","_babelHelpers$classPr7","communicationChannelId","item","_babelHelpers$classPr8","ReminderSelector","promises","entries","save","isTemplateMode","enableComplete"],"mappings":"ovNACA,gCAAA,oCAAA,kHAAA,8GAiBO,gDAAMA,EAAcC,OAAOC,OAAO,CACxCC,KAAM,OACNC,QAAS,UACTC,KAAM,qOAGMC,cAmBZ,WAAYC,GACZC,oCAAAC,WAAAA,WAAAA,WAAAA,WAAAA,WAAAA,WAAAA,WAAAA,WAAAC,UAAAC,YAAAC,eAAAF,UAAAC,YAAAC,MAjBM,CACLC,UAAWC,eAAiB,KAC5BC,OAAQD,eAAiB,KACzBE,MAAO,CACNH,UAAWC,eAAiB,KAC5BG,OAAQH,eAAiB,KACzBI,OAAQJ,eAAiB,SAE1BJ,UAAAC,YAAAC,MAEsB,OAAIF,UAAAC,YAAAC,MACR,OAAIF,UAAAC,YAAAC,MAEJ,OAAIF,WAAAC,YAAAC,MACI,OAI1BJ,yCAAY,IAAIW,OAChBX,yCAAaD,GACbC,0CAASK,UAAYO,KAAKC,YACtBC,OAAKC,eAAehB,MAAAA,SAAAA,EAAMiB,aAAeF,OAAKG,UAAUlB,MAAAA,SAAAA,EAAMmB,WAEjEC,mBAAAP,MA4CD,OA1CAZ,6BAAAoB,kBAAAhB,eAEWL,GAEPC,0CAAWkB,WAAanB,EAAKmB,UAAYlB,0CAAWgB,aAAejB,EAAKiB,aAK5EhB,yCAAaD,GACTe,OAAKC,eAAehB,MAAAA,SAAAA,EAAMiB,aAAeF,OAAKG,UAAUlB,MAAAA,SAAAA,EAAMmB,WAEjEC,mBAAAP,UAEDQ,gBAAAhB,iBAIA,GAAIJ,0CAASK,UAEZ,OAAOL,0CAASK,UAGjB,IAAMgB,EAAWrB,0CAAWgB,aAAexB,EAAYG,KAAO,UAAY,GAkB1E,OAjBAK,0CAASO,OAASe,MAAIC,mHAA0DF,GAChFrB,0CAASQ,MAAMC,OAASa,MAAIC,iHAC5BvB,0CAASQ,MAAME,OAASY,MAAIC,iHAC5BvB,0CAASQ,MAAMH,UAAYiB,MAAIC,+JAE3BvB,0CAASQ,MAAMC,OACfT,0CAASQ,MAAME,QAInBV,0CAASK,UAAYiB,MAAIC,yJAErBvB,0CAASO,OACTP,0CAASQ,MAAMH,WAIZL,0CAASK,mBAqLjB,cAAA,gCAAA,cAlJoB,OAkJpBmB,wDAAA,6BAAA,6BAAA,OAhLCL,mBAAAP,MAAmBa,KACXzB,0CAAWgB,WAAUS,cAEvBjC,EAAYI,iBAOZJ,EAAYG,cAOZH,EAAYK,WAAI,MAAA,OAAA,OAAA4B,WAZdb,iBAAAA,MAAI,OAAA,4BAAA,OAAA,OAAAa,WAOJb,iBAAAA,MAAI,OAAA,4BAAA,QAAA,OAAAa,YAOJb,iBAAAA,MAAI,QAAA,QAAA,4BAAA,QAUZO,mBAAAP,MACAO,mBAAAP,MAAmB,QAAA,UAAA,sDAAA,cAIpB,WACC,OAAOZ,0CAAU0B,qBACfC,MAAK,SAAA5B,GACL,GAAIe,OAAKc,SAAS7B,EAAK8B,YAAcf,OAAKgB,QAAQ/B,EAAK8B,WACvD,CAAA,MACOE,YAAUhC,EAAK8B,UAAUG,QAAO,SAAAD,GAAO,OAAIA,EAAQE,KAAOjC,uCAAWkB,YAAU,kBAAM,KAC3F,GAAgB,OAAZa,EAEH,OAGD,IAAMrB,EAASI,OAAKoB,UAAUnC,MAAAA,SAAAA,EAAMoC,YAArBrB,MAAmCf,GAAAA,EAAMoC,WAAzCrB,MAAsDiB,GAAAA,EAASK,MAC3EC,MAAIC,WAAW,oCAChB,CAAEC,aAAcC,OAAWC,OAAOV,MAAAA,SAAAA,EAASK,SAE1C,KAGHpC,uCAAiB,CAChBS,OAAQsB,MAAAA,SAAAA,EAASvB,MACjBE,OAAQA,EACRH,OAAQ,OAGTY,gBAAAuB,GAGDvB,gBAAAuB,aACQ,SAACC,GACTC,QAAQC,IAAIF,MAGd,cAGD,WACC,OAAO,IAAIG,SAAQ,SAACC,GACnB/C,sCAAmB,IAAIgD,SAAO,CAC7BC,SAAU,CACT,CAAEhB,GAAIzC,EAAYG,OAEnBuD,OAAQ,CACPC,OAAU,SAACC,GAAU,MACdC,YAAOrD,uCAAiBsD,mBAAmB,kBAAM,KACvD,GAAIxC,OAAKc,SAASyB,GAClB,CAAA,gBACOE,YAAWF,MAAAA,aAAAA,EAAMG,+BAANC,EAAkBC,IAAI,2BAAe,GACtD1D,uCAAiB,CAChBS,QAAQ4C,MAAAA,aAAAA,EAAMG,+BAANG,EAAkBD,IAAI,SAAU,IAAMH,EAC9C7C,iBAAQ2C,MAAAA,aAAAA,EAAMG,+BAANI,EAAkBF,IAAI,2BAAe,GAC7CnD,iBAAQ8C,MAAAA,SAAAA,EAAM9C,sBAAU,OAEzBY,gBAAA0C,GAGD1C,gBAAA0C,GACAd,MAGFe,iBAAkB,CAAC,CAACtE,EAAYG,KAAMK,uCAAWkB,cAGlDlB,uCAAiB+D,UAElB,cAGD,WACC,OAAO,IAAIjB,SAAQ,SAACC,GACnB/C,sCAAmB,IAAIgD,SAAO,CAC7BC,SAAU,CACT,CACChB,GAAIzC,EAAYK,KAChBmE,aAAa,IAGfd,OAAQ,CACPC,OAAU,SAACC,GAAU,UACdrD,YAAOC,uCAAiBsD,mBAAmB,kBAAM,KACnDxC,OAAKc,SAAS7B,KAEjBC,uCAAiB,CAChBS,iBAAQV,EAAKS,qBAAS,GACtBE,OAAQ,GACRH,iBAAQR,MAAAA,SAAAA,EAAMQ,sBAAU,OAEzBY,gBAAA8C,IAGD9C,gBAAA8C,GACAlB,MAGFe,iBAAkB,CAAC,CAACtE,EAAYK,KAAMG,uCAAWkB,cAGlDlB,uCAAiB+D,UAElB,cAGD,kDACKnD,uBAAAsD,EAAgB3D,SAEnBP,0CAASO,OAAO4D,MAAMC,+BAA0BpE,2CAAeO,cAGhEP,0CAASQ,MAAMC,OAAO4D,UAAYrE,2CAAeS,OACjDT,0CAASQ,MAAMC,OAAOD,MAAQR,2CAAeS,OAC7CT,0CAASQ,MAAME,OAAO2D,UAAYrE,2CAAeU,OACjDV,0CAASQ,MAAME,OAAOF,MAAQR,2CAAeU,OAC7C,cAIA,yCAAIE,SAKJZ,yCAAe,IAAIsE,GAAGC,OAAO,CAC5BC,OAAQxE,0CAASK,UACjBoE,KAAM,SACNC,KAAM,wCANC9D,QAUR,cAIAZ,0CAASQ,MAAMH,UAAU8D,MAAMQ,QAAU,OACzC3E,0CAASO,OAAO4D,MAAMQ,QAAU,QAChCxD,mBAAAP,MAAkBgE,OAClB,cAIA5E,0CAASO,OAAO4D,MAAMQ,QAAU,OAChC3E,0CAASQ,MAAMH,UAAU8D,MAAMQ,QAAU,OACzCxD,mBAAAP,MAAkBiE,KAAK7E,0CAASK,smNC/QlC,sHAAA,uzBAAA,2GAAA,kCAAA,sCAAA,mHAAA,+GAgCA,IAAMyE,uCACJC,aAAWC,SAAW,CAAEC,gBAAiBC,WAASC,2CAClDJ,aAAWK,OAAS,CAAEH,gBAAiBC,WAASG,orBAOrCC,eAsDZ,WAAYC,GACZ,MAAAvF,oCACC0C,yFAAQzC,6CAAAA,6CAAAA,6CAAAA,6CAAAA,6CAAAA,6CAAAA,6CAAAA,6CAAAA,6CAAAA,6CAAAA,6CAAAA,6CAAAA,6CAAAA,6CAAAA,6CAAAA,6CAAAA,6CAAAA,6CAAAA,6CAAAA,6CAAAA,6CAAAA,6CAAAA,6CAAAA,6CAAAA,6CAAAA,6CAAAD,2EAtDAP,OAAOC,OAAO,CACtB8F,mBAAoB,wBACnBtF,6CAAAC,YAAAC,MAEI,CACLC,UAAWC,eAAiB,KAC5BmF,eAAgBC,wBAChBxF,6CAAAC,YAAAC,MAEyD,CACzD2B,QAAS,CACRE,GAAI,UACJ0D,OAlB0C,QAoB3CC,SAAU,CACT3D,GAAI,WACJ0D,OAtB0C,QAwB3CE,WAAY,CACX5D,GAAI,aACJ0D,OA1B0C,WA4B3CzF,6CAAAC,YAAAC,MAEQ,CACR2B,QAASjC,GACTgG,eAAgBhG,GAChBiG,UAAWC,YACXC,UAAWD,YACXE,OAAQpG,MACRI,6CAAAC,YAAAC,MAE4B,OAAIF,6CAAAC,YAAAC,eAAAF,6CAAAC,YAAAC,eAAAF,6CAAAC,YAAAC,eAAAF,6CAAAC,YAAAC,MAIsB,OAAIF,6CAAAC,YAAAC,eAAAF,6CAAAC,YAAAC,eAAAF,6CAAAC,YAAAC,eAAAF,6CAAAC,YAAAC,MAIxB,KAAEF,6CAAAC,YAAAC,MAC+B,KAAEF,6CAAAC,YAAAC,eAAAF,6CAAAC,YAAAC,OAEvC,IAAKF,6CAAAC,YAAAC,OACN,IAAKF,6CAAAC,YAAAC,eAAAF,6CAAAC,YAAAC,MAIgB,OAAIF,6CAAAC,YAAAC,MAE1B,OAK5BsC,EAAKyD,kBAAkB,+BACvBnG,4EAAY+B,QAAU,IAAIjC,GAAK,CAAEkB,WAAYxB,EAAYI,UACzDI,4EAAY8F,eAAiB,IAAIhG,GAAK,CAAEkB,WAAYxB,EAAYG,OAChEK,4EAAYkG,OAAS,IAAIpG,GAAK,CAAEkB,WAAYxB,EAAYG,OACxDK,4EAAY+F,UAAY,IAAIC,YAAU,CAAEvB,KAAM,OAAQ2B,KAAMrB,aAAWK,SACvEpF,4EAAYiG,UAAY,IAAID,YAAU,CAAEvB,KAAM,OAAQ2B,KAAMrB,aAAWsB,WACvErG,2EAAwB,IAAIsG,kBAAgB,CAC3CpD,OAAQ,CACPqD,YAAa,SAACnD,GACb,IAAMrD,EAAOqD,EAAMoD,UACnB9D,EAAK+D,KAAK,cAAe1G,IAE1B2G,WAAY,SAACtD,GACZ,IAAMrD,EAAOqD,EAAMoD,UACnB9D,EAAK+D,KAAK,aAAc1G,QAI3B,IAAQ4G,EAAkEpB,EAAlEoB,OAAQC,EAA0DrB,EAA1DqB,UAAWC,EAA+CtB,EAA/CsB,aAAcC,EAAiCvB,EAAjCuB,kBAAmBC,EAAcxB,EAAdwB,UAiC5D,GAhCA/G,2EAA0B8G,GAC1B9G,2EAAqB,IAAIgH,eAAaL,EAAQC,IAC9C5G,2EAAqB,IACrBA,2EAAkB+G,GAClB/G,2EAAqB6G,GACrB7G,4EAASyF,eAAiBnE,MAAIC,gJAE1Bc,MAAIC,WAAW,8BAA+B,CAAE2E,QAAS,KAG7DjH,2EAAiB,IAAIkH,cAAY,CAChCC,SAAU,IACV/G,MAAO,EACPgH,WAAY,aAGb,CAACrC,aAAWC,SAAUD,aAAWK,QAAQiC,SAAQ,SAACjB,GACjDjF,2FAAyCiF,oGAKzCpG,2EAA4B,IAAIsH,sBAAoB,CACnDC,IAAK,IAAI5G,SAGVX,4EAA0BwH,UACzB,oBACA,SAACpE,GAAK,kGAA4CA,oGAKpD,CACC,IAAMqE,EAAc,IAAIC,KACxBD,EAAYE,SAASF,EAAYG,WAjHN,GAkH3B5H,2EAA8B,IAAI6H,wBAAsBJ,IAExDzH,4EACEwH,UAAU,oBAAoB,SAACpE,GAC/BV,EAAK+D,KAAK,sBAEVe,UAAU,mBAAmB,SAACpE,IACH,IAAvBA,EAAMrD,KAAK+H,SAEdpF,EAAK+D,KAAK,qBAIb,eAWD,OAxIuBzG,2BA8HvBA,6BAAAoB,gBAAAhB,iBA4ED,WACO2H,EAASzG,MAAIC,sKAEuBc,MAAIC,WAAW,gCAInD0F,EAAe7G,oBAAAP,MAClByB,MAAIC,WAAW,wCACfD,MAAIC,WAAW,+BAGlBtC,0CAAoB,IACpB,IAAMiI,EAAgB3G,MAAIC,kOAGrByG,EAEDhI,2CAAsBa,eACtBD,iBAAAA,OAGJZ,2CAAkBkI,KAAKD,GAEvB,IAAIE,EAAc,QACbvH,iBAAAA,QAEJuH,EAAc7G,MAAIC,8WAGbc,MAAIC,WAAW,mCAEhBtC,2CAASyF,eACTzF,2CAAY+F,UAAUlF,eAErBD,iBAAAA,KAA8B,eAC9BA,iBAAAA,KAAgCmE,aAAWK,QAE5CpF,2CAA0BuB,UAG9BvB,2CAAkBkI,KAAKC,IAExB,IAAMC,EAAgBjH,oBAAAP,MACnByB,MAAIC,WAAW,2CACfD,MAAIC,WAAW,kCAEZ+F,EAAgB/G,MAAIC,88BAGrB6G,EAKE/F,MAAIC,WAAW,6BAIfD,MAAIC,WAAW,oCAIhBtC,2CAAY+B,QAAQlB,YAIpBb,2CAAY8F,eAAejF,eAI5BD,iBAAAA,KAA8B,cAC9BA,iBAAAA,KAAgCmE,aAAWC,WAIhDhF,2CAAkBkI,KAAKG,GACvBC,MAAIC,OAAON,EAAeF,GAC1B,IAAMS,EAAqBrH,oBAAAP,MACxByB,MAAIC,WAAW,uDACfD,MAAIC,WAAW,l9/DAEZmG,iCACJ1D,aAAWmB,OAAS,CACpBzF,OAAQ4B,MAAIC,WAAW,4CACvBoG,KAAMrG,MAAIC,WAAW,+CAsBvB,GAlBAtC,2CAAkB6F,WAAWwB,SAAQ,YAAoB,IAAjBjB,IAAAA,KACvC,GAAIA,IAASrB,aAAWsB,SAAxB,CAKA,IAAMsC,EAAkB3I,wCAAYoG,GAAMvF,YAC1C,GAAK8H,EAAL,CAKA,MAAyBF,EAAiBrC,GAAlCsC,IAAAA,KAAMjI,IAAAA,OACRmI,KAAmB/E,cAAAA,EAAqBpD,EAAQiI,EAAMC,GAC5D3I,wCAAkBkI,KAAKU,GACvBN,MAAIC,OAAOK,EAAkBb,QAG1B/H,2CAAYiG,UAAU4C,yBAAyBC,OAAS,EAC5D,CACC,IAAMC,EAAqBzH,MAAIC,sJAE3BvB,2CAAYiG,UAAUpF,aAGpBmI,KAAkBpI,iBAAAA,KACvB4H,EACAnG,MAAIC,WAAW,wDACfyG,GAED/I,2CAAkBkI,KAAKc,GACvBV,MAAIC,OAAOS,EAAiBjB,GAmB7B,OAhBAO,MAAIC,OAAOF,EAAeN,GACrBjH,OAAKmI,OAAOd,IAEhBG,MAAIC,OAAOJ,EAAaJ,GAGzB/H,0CAA0BsB,MAAIC,wGAC9BvB,2CAAekJ,2CAAStI,UAExBZ,0CAAwBmB,oBAAAP,SAAyBA,iBAAAA,SAC9CA,iBAAAA,OAEH0H,MAAInE,wCAAMvD,SAAuB,UAAW,QAC5CA,KAAK6F,KAAK,gBAAiB,CAAE0C,0CAASvI,WACtCwI,OAAKC,OAAOtB,GAELA,KACP3G,0BAAAhB,iBAsHAJ,2CAA2B,MAC3BoB,0BAAAhB,iBAgCA,OAHAJ,2CAAY+F,UAAUuD,sBACtBtJ,2CAAYiG,UAAUqD,sBAEf1I,QACPQ,kBAAAhB,eAEWmJ,GAIX,OAFAvJ,0CAAiBuJ,GAEV3I,QACPQ,qBAAAhB,eAEcoJ,GACf,MAAAC,UAAAxF,QACCjE,0CAAoBwJ,GAEhB1I,OAAK4I,SAASF,MAAAA,aAAAA,EAASzH,4BAAT4H,EAAkBzI,YAEnClB,2CAAY+B,QAAQ6H,YAAY,CAC/B1I,SAAUsI,MAAAA,aAAAA,EAASzH,4BAAT8H,EAAkB3I,SAC5BF,WAAYwI,MAAAA,aAAAA,EAASzH,4BAAT+H,EAAkB9I,aAI5BF,OAAK4I,SAASF,MAAAA,aAAAA,EAAS1D,mCAAT2D,EAAyBvI,WAE1ClB,2CAAY8F,eAAe8D,YAAY,CACtC1I,SAAUsI,MAAAA,aAAAA,EAAS1D,mCAATiE,EAAyB7I,SACnCF,WAAYwI,MAAAA,aAAAA,EAAS1D,mCAATkE,EAAyBhJ,aAWvC,GAPIF,OAAKmJ,cAAcT,MAAAA,SAAAA,EAASzD,YAE/B/F,2CAAY+F,UAAUmE,WAAWV,MAAAA,SAAAA,EAASzD,UAAUoE,KAAI,SAACvE,GACxD,MAAO,CAAE1E,SAAU0E,EAAS1E,SAAUF,WAAY4E,EAAS5E,gBAIzDF,OAAKmJ,cAAcT,MAAAA,SAAAA,EAAS3D,YAChC,CACC,IAAMuE,EAAiB,GACvBZ,EAAQ3D,WAAWwB,SAAQ,SAACgD,GAC3B,IAAQnJ,EAA+BmJ,EAA/BnJ,SAAUF,EAAqBqJ,EAArBrJ,WAAYoF,EAASiE,EAATjE,KAC1BA,IAASrB,aAAWsB,SAOxBrG,wCAAYoG,GAAMwD,YAAY,CAAE1I,SAAAA,EAAUF,WAAAA,IALzCoJ,EAAelC,KAAK,CAAEhH,SAAAA,EAAUF,WAAAA,OAQ9BoJ,EAAetB,OAAS,GAE3B9I,2CAAYiG,UAAUiE,WAAWE,GAMnC,OAFAjJ,oBAAAP,MAEOA,QACPQ,kBAAAhB,+DAAA,4BAAA,8BAAA,6BAAA,OAQ0B,OAJpBmH,EAAM,IAAI5G,MAAKc,SAIpBb,KAAK6F,KAAK,eAAehF,YACnBb,iBAAAA,MAAI,OAEkB,GAA5BO,oBAAAP,UACIA,iBAAAA,OAAIa,UAAA,MAAA,OAAAA,SAEwC8F,EAAI+C,SAASC,iBAAiB3J,KAAK4J,aAAaC,SAASC,OAAOtK,MAAMuK,aAAY,OAAAC,SAAzGC,IAAhBP,SAAYrI,GACpBrB,KAAK6F,KAAK,qBAAsB,CAAEoE,WAAAA,IAAcpJ,UAAA,MAAA,QAAA,OAExCb,iBAAAA,OAAIa,UAAA,MAI8E,OAFpFqJ,KAAUlK,iBAAAA,MACVmK,EAAgCxD,EAAIyD,uBAAuBF,GAC3DG,KAAwCrK,iBAAAA,KAAqCkK,GAAOrJ,UAEpFqB,QAAQoI,IAAI,CAACH,EAA+BE,IAAuC,QAAAxJ,UAAA,MAAA,QAAA0J,KAIrEvK,KAAK4J,cAAY/I,UAAA0J,MAAA,QAAA,mBAAA1J,UAAA,MAGwC,OAHxC2J,wCAAzBC,OAELC,EAA2B/D,EAAIgE,kBAAkBF,GACjDG,KAAmC5K,iBAAAA,KAAgCyK,GAAG5J,UAEtEqB,QAAQoI,IAAI,CAACI,EAA0BE,IAAkC,QAAA/J,UAAA,MAAA,QAAAA,UAAA,MAAA,QAAAA,UAAAA,iBAAA0J,UAAA,QAAA,OAAA1J,UAAA0J,mBAAA,QAAA,0BAI1E,GAAI,QAMa,OANb1J,UAAAA,gBAIXmB,QAAQ6I,YACRtK,oBAAAP,MACAA,KAAK6F,KAAK,iCAEH,GAAK,QAAA,UAAA,sDAAA,WAAA,mCAAArF,qBAAAhB,eAICiL,GAEdrL,2CAAsB0L,WAAWL,MACjCjK,wBAAAhB,eAEiBuL,GAEjB,IAAMC,EAAkBnM,OAAOoM,YAAYF,GAC3C3L,2CAAsB8L,SAASF,MAC/BxK,mCAAAhB,iBAkCA,OAAOJ,4CAA8BA,2CAA4B8H,aACjE1G,mBAAAsC,eApgBA,yCAAO9C,UACPmL,aAOgBvB,GACjB,IAAAwB,EAAAC,SACCzB,EAAanD,SAAQ,SAACtH,GACrB,IAAQsL,EAAmEtL,EAAnEsL,IAAKpJ,EAA8DlC,EAA9DkC,GAAIzB,EAA0DT,EAA1DS,MAAO0L,EAAmDnM,EAAnDmM,OAAQC,EAA2CpM,EAA3CoM,WAAYC,EAA+BrM,EAA/BqM,WAAYlL,EAAmBnB,EAAnBmB,SAAUmL,EAAStM,EAATsM,KAClErM,wCAAsBsM,QAAQjB,EAAK,CAAEA,IAAAA,EAAKpJ,GAAAA,EAAIzB,MAAAA,EAAO0L,OAAAA,EAAQC,WAAAA,EAAYC,WAAAA,EAAYlL,SAAAA,EAAUmL,KAAAA,OAGhGrM,0CAAqBwK,GAErB,IAAM+B,EAAOvM,+BAAIwK,EAAaC,UAAUN,KAAI,SAAApK,GAAI,OAAIA,EAAKsL,OACnDmB,EAAUxM,+BAAIwK,EAAaC,UAAUgC,MAAMpB,IAC3CqB,iCAAwBlC,EAAamC,QAI3C,GAFA3M,2CAAmB4M,gBAAgBL,IAE9BzL,OAAKmI,yCAAOrI,YAEhBZ,2CAA4B4M,gBAAgBL,GAExCzL,OAAKmI,OAAOjJ,2CAA4B6M,oBAC5C,CACC,IAAMC,KAAYlM,iBAAAA,KAA0C4J,MAAAA,SAAAA,EAAcC,SAASC,OAAOtK,OAC1FJ,2CAA4B+M,QAAQD,GAItC9M,2CAAY+F,UAAUiH,eAAeR,GACrCxM,2CAAYiG,UAAU+G,eAAeR,sEAErCR,EAA2BiB,qBAAqBP,+CAC3C9L,uBAAAqL,EAA2BiB,WAChC9L,qBAAA2K,aApCkB3L,GACnB,yEACC8D,EAA2BiJ,WAAW/M,UAvINgN,gBAsvBjC,YA3kBqCC,GAEpC,OAAOA,MAAAA,GAAAA,EAAiBC,cACrB,IAAI5F,KAAK2F,MAAAA,SAAAA,EAAiBC,eAC1B,IAAI5F,MAAK,IAAIA,MAAOC,UAAS,IAAID,MAAOE,WAjLf,IAmL5B,cAIA,IAAM2F,EAA8B,SAACC,GACpC,OAAOlM,MAAIC,oJAEPkM,MAAMC,KAAK,CAAE5E,OAAQ0E,IAAarD,KAAI,WACvC,OAAO7I,MAAIC,4IAQf,OAAOD,MAAIC,2JAEPgM,EAA4B,GAC5BA,EAA4B,IAGhC,YAiJe9M,EAAgBiI,EAAcX,GAE7C,OAAOzG,MAAIC,uYAGNd,EAICiI,EAEDX,KACAnH,iBAAAA,KAA8B,eAInC,cAGD,MACO+M,GAAiB7M,OAAKmI,yCAAOrI,UAE7BgN,EAAsBD,KACzB/M,iBAAAA,MACA,KAGGiN,EAAwBF,6EAAiBG,EAAgBC,QAASC,eAAaC,UAClFrN,iBAAAA,MACA,KAGH,OAAOU,MAAIC,2KAEPX,iBAAAA,MACAgN,EACAC,GAGJ,cAIA,OAAOvM,MAAIC,sMAEPvB,2CAAmBa,YAEPwB,MAAIC,WAAW,0CAI/B,cAIA,OAAOhB,MAAIC,gNAEPvB,2CAA4Ba,YAEhBwB,MAAIC,WAAW,oDAI/B,cAIA,OAAOhB,MAAIC,6HAEPc,MAAIC,WAAW,4DAGnB,cAIA,IAAM4L,EAAuB7L,MAAIC,WAAW,+BAE5C,OAAOhB,MAAIC,+bAGNX,iBAAAA,MAECyB,MAAIC,WAAW,4BAGf4L,KAGAtN,iBAAAA,wCAGFA,UAGJ,cAIA,IAAMuN,EAAgBnO,2CAA2BqC,MAAIC,WAAW,kCAC7DD,MAAIC,WAAW,kCAElB,OAAOhB,MAAIC,8YAIsC4M,EACD9L,MAAIC,WAAW,0CAC1D1B,iBAAAA,OAIL,cAQD,WACC,OAAOU,MAAIC,4LAGE,WAAA,OAAM6M,EAAK3H,KAAK,WACzBpE,MAAIC,WAAW,wBAGnB,cAIA,yCAAI1B,SAEI,KAGDU,MAAIC,oMAEPc,MAAIC,WAAW,iCAGnB,eAAA,gCAAA,cA0IuB,OA1IvB+L,uDA+HgChD,GAAW,UAAA,8BAAA,6BAAA,OAErC9D,EAAM,IAAI5G,MACZ2N,GAAY,EAAK,OAAA,GACbA,GAASC,UAAA,MAAA,OAAAA,SAGKhH,EAAIiH,gCAAgCnD,GAAI,OAG7D,OAHMoD,SACNH,EAAYG,EAAOH,UACnBtO,2CAAe0O,OAAOC,KAAKC,MAAMH,EAAOI,WACxCN,aACM3N,iBAAAA,KAAY,KAAI,QAAA2N,SAAA,MAAA,QAAA,UAAA,sDAAA,eAAA,gCAAA,cAeA,OAfAO,uDAIchE,GAAe,UAAA,8BAAA,6BAAA,OAE9CvD,EAAM,IAAI5G,MACZ2N,GAAY,EAAK,OAAA,GACbA,GAASS,UAAA,MAAA,OAAAA,SAGKxH,EAAIyH,qCAAqClE,GAAQ,OAGtE,OAHM2D,SACNH,EAAYG,EAAOH,UACnBtO,2CAAe0O,OAAOC,KAAKC,MAAMH,EAAOI,WACxCE,aACMnO,iBAAAA,KAAY,KAAI,QAAAmO,SAAA,MAAA,QAAA,UAAA,sDAAA,YASjBE,GAEN,OAAO,IAAInM,SAAQ,SAACC,GACnBmM,WAAWnM,EAASkM,MAErB,cAGD,UACCjP,2CAASyF,eAAepB,UAAYhC,MAAIC,WACvC,8BACA,CAAE2E,8DAASrG,iCAAAuO,EAAmBpJ,8BAAnBqJ,EAA8BtG,sBAAU,IAEpD,YAEwBuG,GAExB,OAAO/N,MAAIC,weAGNc,MAAIC,WAAW,mDAIdD,MAAIC,WAAW,gDAGJD,MAAIC,WAAW,iDAKhC,cAIAtC,2CAAe0O,OAAO,GACtB9N,KAAK6F,KAAK,eACVzG,2CAAkBqH,SAAQ,SAACiI,GAAI,OAAKhH,MAAI1D,KAAK0K,MAC7ChH,MAAInE,wCAAMvD,SAAuB,UAAW,QAC5CA,KAAK6F,KAAK,eACV,cAIAzG,2CAAkBqH,SAAQ,SAACiI,GAAI,OAAKhH,MAAIzD,KAAKyK,MAC7C1O,KAAK6F,KAAK,eACV6B,MAAInE,wCAAMvD,SAAuB,UAAW,QAC5CA,KAAK6F,KAAK,eACV,YAE0BL,GAE1B,OAAO9E,MAAIC,0MAEPJ,oBAAAP,KAAyCwF,GAAMvF,YAEnCwB,MAAIC,WAAW,mDAI/B,YAEmC8D,GACpC,UAGC,gEAF6BA,kBAA7BmJ,EAA6BnJ,GAAU,IAAIoJ,6BAAiB1K,GAA8BsB,kBAAS,KAE5FpG,2CAA6BoG,GACpC,cAIA,IAAMiF,KAAMzK,iBAAAA,MACN6O,EAA2BhQ,OAAOiQ,0CAAQ9O,UAC9CuJ,KAAI,YAAA,sCAAE/D,OAAc,YAAeuJ,KAAKtE,EAAKjF,MAG/C,OAAOtD,QAAQoI,IAAIuE,GACnB,cAIA,OAAO7O,KAAK4J,aAAamC,OAAOjC,OAAOtK,MACvC,cAIA,OAAOwP,mDAAehP,UACtB,cAIA,OAAOA,KAAK4J,aAAa9F,KAAO,EAChC,cAIA,OAAO9D,KAAK4J,aAAaC,SAASC,OAAOtK,MAAM0K,QAC/C,YAEiC1H,GAClC,MACOyM,YAAiBzM,MAAAA,SAAAA,EAAOrD,qBAE9Ba,KAAK6F,KACJoJ,EACG,iBACA"}