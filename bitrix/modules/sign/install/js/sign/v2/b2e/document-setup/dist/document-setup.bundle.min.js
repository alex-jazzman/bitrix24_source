this.BX=this.BX||{};this.BX.Sign=this.BX.Sign||{};this.BX.Sign.V2=this.BX.Sign.V2||{};(function(e,t,s,i,a,l,o,r,n,c,d,u,b){"use strict";var p="/bitrix/js/sign/v2/b2e/document-setup/dist/images/components/reupload-files-popup/icon.svg";let h=e=>e,v;const P=Object.freeze({upload:"upload",select:"select"});var m=babelHelpers.classPrivateFieldLooseKey("instances");var _=babelHelpers.classPrivateFieldLooseKey("isUploadPopupCompleted");var L=babelHelpers.classPrivateFieldLooseKey("isSelectBlankPopupCompleted");var g=babelHelpers.classPrivateFieldLooseKey("cache");var B=babelHelpers.classPrivateFieldLooseKey("createPopupContent");var T=babelHelpers.classPrivateFieldLooseKey("createSelectPopupButtons");var y=babelHelpers.classPrivateFieldLooseKey("getSelectBlankPopup");var F=babelHelpers.classPrivateFieldLooseKey("createUploadPopupButtons");var S=babelHelpers.classPrivateFieldLooseKey("getUploadPopup");class D extends d.EventEmitter{constructor(){super();Object.defineProperty(this,S,{value:C});Object.defineProperty(this,F,{value:O});Object.defineProperty(this,y,{value:f});Object.defineProperty(this,T,{value:E});Object.defineProperty(this,B,{value:H});this.events={uploadPopup:{onConfirm:"onUploadFilePopupConfirm",onCancel:"onUploadFilePopupCancel"},selectBlankPopup:{onConfirm:"onSelectBlankPopupConfirm",onCancel:"onSelectBlankPopupCancel"}};Object.defineProperty(this,_,{writable:true,value:false});Object.defineProperty(this,L,{writable:true,value:false});Object.defineProperty(this,g,{writable:true,value:new c.MemoryCache});this.setEventNamespace("BX.Sign.B2e.DocumentSetup.ReuploadFilesPopup")}static getOrCreateForObject(e){if(!babelHelpers.classPrivateFieldLooseBase(D,m)[m].has(e)){babelHelpers.classPrivateFieldLooseBase(D,m)[m].set(e,new D)}return babelHelpers.classPrivateFieldLooseBase(D,m)[m].get(e)}showSelectBlankPopup(){babelHelpers.classPrivateFieldLooseBase(this,y)[y]().show()}showUploadPopup(){babelHelpers.classPrivateFieldLooseBase(this,S)[S]().show()}isUploadPopupCompletedOnce(){return babelHelpers.classPrivateFieldLooseBase(this,_)[_]}isSelectBlankPopupCompletedOnce(){return babelHelpers.classPrivateFieldLooseBase(this,L)[L]}}function H(e){const t=e==="upload"?n.Loc.getMessage("SIGN_V2_B2E_DOCUMENT_SETUP_COMPONENTS_POPUP_UPLOAD_DESCRIPTION"):n.Loc.getMessage("SIGN_V2_B2E_DOCUMENT_SETUP_COMPONENTS_POPUP_SELECT_DESCRIPTION");return n.Tag.render(v||(v=h`
			<div class="sign-b2e-document-setup__reupload__wrapper">
				<div class="sign-b2e-document-setup__reupload__icon-container">
					<img class="sign-b2e-document-setup__reupload__icon" src="${0}" alt="Icon"/>
				</div>
				<div class="sign-b2e-document-setup__reupload__text">
					<div class="sign-b2e-document-setup__reupload__title">
						${0}
					</div>
					<div class="sign-b2e-document-setup__reupload__description">
						${0}
					</div>
				</div>
			</div>
		`),p,n.Loc.getMessage("SIGN_V2_B2E_DOCUMENT_SETUP_COMPONENTS_POPUP_TITLE"),t)}function E(){const e=new b.Button({text:n.Loc.getMessage("SIGN_V2_B2E_DOCUMENT_SETUP_COMPONENTS_POPUP_SELECT_CONFIRM"),color:b.Button.Color.PRIMARY,round:true,events:{click:()=>{babelHelpers.classPrivateFieldLooseBase(this,y)[y]().close();babelHelpers.classPrivateFieldLooseBase(this,L)[L]=true;this.emit(this.events.selectBlankPopup.onConfirm)}}});const t=new b.Button({text:n.Loc.getMessage("SIGN_V2_B2E_DOCUMENT_SETUP_COMPONENTS_POPUP_CANCEL"),color:b.Button.Color.LIGHT_BORDER,round:true,events:{click:()=>{babelHelpers.classPrivateFieldLooseBase(this,y)[y]().close();this.emit(this.events.selectBlankPopup.onCancel)}}});return[e,t]}function f(){return babelHelpers.classPrivateFieldLooseBase(this,g)[g].remember("selectBlankPopup",(()=>new u.Popup({disableScroll:true,className:"sign-b2e-document-setup__reupload__popup",content:babelHelpers.classPrivateFieldLooseBase(this,B)[B](P.select),width:386,overlay:true,closeByEsc:false,buttons:babelHelpers.classPrivateFieldLooseBase(this,T)[T]()})))}function O(){const e=new b.Button({text:n.Loc.getMessage("SIGN_V2_B2E_DOCUMENT_SETUP_COMPONENTS_POPUP_UPLOAD_CONFIRM"),color:b.Button.Color.PRIMARY,round:true,closeByEsc:false,events:{click:()=>{babelHelpers.classPrivateFieldLooseBase(this,S)[S]().close();babelHelpers.classPrivateFieldLooseBase(this,_)[_]=true;this.emit(this.events.uploadPopup.onConfirm)}}});const t=new b.Button({text:n.Loc.getMessage("SIGN_V2_B2E_DOCUMENT_SETUP_COMPONENTS_POPUP_CANCEL"),color:b.Button.Color.LIGHT_BORDER,round:true,events:{click:()=>{babelHelpers.classPrivateFieldLooseBase(this,S)[S]().close();this.emit(this.events.uploadPopup.onCancel)}}});return[e,t]}function C(){return babelHelpers.classPrivateFieldLooseBase(this,g)[g].remember("uploadPopup",(()=>new u.Popup({disableScroll:true,className:"sign-b2e-document-setup__reupload__popup",content:babelHelpers.classPrivateFieldLooseBase(this,B)[B](P.upload),width:386,overlay:true,buttons:babelHelpers.classPrivateFieldLooseBase(this,F)[F]()})))}Object.defineProperty(D,m,{writable:true,value:new WeakMap});let N=e=>e,M,U,I,k,A,w,j,K,$,G,x,R,X,V,W,Y;const q=Object.freeze({HowToWorkWithTemplates:"23174934"});var z=babelHelpers.classPrivateFieldLooseKey("cache");var J=babelHelpers.classPrivateFieldLooseKey("api");var Q=babelHelpers.classPrivateFieldLooseKey("region");var Z=babelHelpers.classPrivateFieldLooseKey("senderDocumentTypes");var ee=babelHelpers.classPrivateFieldLooseKey("documentSenderTypeDropdown");var te=babelHelpers.classPrivateFieldLooseKey("documentTitleInput");var se=babelHelpers.classPrivateFieldLooseKey("b2eDocumentLimitCount");var ie=babelHelpers.classPrivateFieldLooseKey("currentEditedId");var ae=babelHelpers.classPrivateFieldLooseKey("currentEditButton");var le=babelHelpers.classPrivateFieldLooseKey("currentEditBlock");var oe=babelHelpers.classPrivateFieldLooseKey("isOpenedFromRobot");var re=babelHelpers.classPrivateFieldLooseKey("isOpenedFromTemplateFolder");var ne=babelHelpers.classPrivateFieldLooseKey("isOpenedAsFolder");var ce=babelHelpers.classPrivateFieldLooseKey("initiatedByType");var de=babelHelpers.classPrivateFieldLooseKey("init");var ue=babelHelpers.classPrivateFieldLooseKey("getSenderDocumentTypes");var be=babelHelpers.classPrivateFieldLooseKey("subscribeOnEvents");var pe=babelHelpers.classPrivateFieldLooseKey("onBlankSelectorAddFile");var he=babelHelpers.classPrivateFieldLooseKey("onBlankSelectorToggleSelection");var ve=babelHelpers.classPrivateFieldLooseKey("onBlankSelectorBeforeAddFileSuccessfully");var Pe=babelHelpers.classPrivateFieldLooseKey("initDocumentSenderType");var me=babelHelpers.classPrivateFieldLooseKey("getDocumentSenderTypeLayout");var _e=babelHelpers.classPrivateFieldLooseKey("shouldHideSenderTypeLayout");var Le=babelHelpers.classPrivateFieldLooseKey("getHelpLink");var ge=babelHelpers.classPrivateFieldLooseKey("getDocumentTitleLayout");var Be=babelHelpers.classPrivateFieldLooseKey("getAddDocumentLayout");var Te=babelHelpers.classPrivateFieldLooseKey("getAddDocumentButtonText");var ye=babelHelpers.classPrivateFieldLooseKey("setDocumentLimitNoticeText");var Fe=babelHelpers.classPrivateFieldLooseKey("setAddDocumentNoticeText");var Se=babelHelpers.classPrivateFieldLooseKey("onClickAddDocument");var De=babelHelpers.classPrivateFieldLooseKey("createDocumentBlock");var He=babelHelpers.classPrivateFieldLooseKey("getDocumentHintLayout");var Ee=babelHelpers.classPrivateFieldLooseKey("onClickDeleteDocument");var fe=babelHelpers.classPrivateFieldLooseKey("onClickEditDocument");var Oe=babelHelpers.classPrivateFieldLooseKey("sendDocumentSenderType");var Ce=babelHelpers.classPrivateFieldLooseKey("getDocumentSenderType");var Ne=babelHelpers.classPrivateFieldLooseKey("validateInput");var Me=babelHelpers.classPrivateFieldLooseKey("disableDocumentInputs");class Ue extends o.DocumentSetup{constructor(e){super(e);Object.defineProperty(this,Me,{value:at});Object.defineProperty(this,Ne,{value:it});Object.defineProperty(this,Ce,{value:st});Object.defineProperty(this,Oe,{value:tt});Object.defineProperty(this,fe,{value:et});Object.defineProperty(this,Ee,{value:Ze});Object.defineProperty(this,He,{value:Qe});Object.defineProperty(this,De,{value:Je});Object.defineProperty(this,Se,{value:ze});Object.defineProperty(this,Fe,{value:qe});Object.defineProperty(this,ye,{value:Ye});Object.defineProperty(this,Te,{value:We});Object.defineProperty(this,Be,{value:Ve});Object.defineProperty(this,ge,{value:Xe});Object.defineProperty(this,Le,{value:Re});Object.defineProperty(this,_e,{value:xe});Object.defineProperty(this,me,{value:Ge});Object.defineProperty(this,Pe,{value:$e});Object.defineProperty(this,ve,{value:Ke});Object.defineProperty(this,he,{value:je});Object.defineProperty(this,pe,{value:we});Object.defineProperty(this,be,{value:Ae});Object.defineProperty(this,ue,{value:ke});Object.defineProperty(this,de,{value:Ie});Object.defineProperty(this,z,{writable:true,value:new c.MemoryCache});Object.defineProperty(this,J,{writable:true,value:void 0});Object.defineProperty(this,Q,{writable:true,value:void 0});Object.defineProperty(this,Z,{writable:true,value:void 0});Object.defineProperty(this,ee,{writable:true,value:void 0});Object.defineProperty(this,te,{writable:true,value:void 0});this.documentCounters=null;Object.defineProperty(this,se,{writable:true,value:void 0});Object.defineProperty(this,ie,{writable:true,value:void 0});Object.defineProperty(this,ae,{writable:true,value:void 0});Object.defineProperty(this,le,{writable:true,value:void 0});Object.defineProperty(this,oe,{writable:true,value:false});Object.defineProperty(this,re,{writable:true,value:false});Object.defineProperty(this,ne,{writable:true,value:false});Object.defineProperty(this,ce,{writable:true,value:void 0});const{region:t,b2eDocumentLimitCount:s,isOpenedFromRobot:a,isOpenedFromTemplateFolder:l,isOpenedAsFolder:o,initiatedByType:r}=e;babelHelpers.classPrivateFieldLooseBase(this,J)[J]=new i.Api;babelHelpers.classPrivateFieldLooseBase(this,Q)[Q]=t;babelHelpers.classPrivateFieldLooseBase(this,se)[se]=s;this.editMode=false;this.onClickShowHintPopup=this.showHintPopup.bind(this);babelHelpers.classPrivateFieldLooseBase(this,oe)[oe]=a;babelHelpers.classPrivateFieldLooseBase(this,re)[re]=l;babelHelpers.classPrivateFieldLooseBase(this,ne)[ne]=o;babelHelpers.classPrivateFieldLooseBase(this,Z)[Z]=babelHelpers.classPrivateFieldLooseBase(this,ue)[ue]();babelHelpers.classPrivateFieldLooseBase(this,te)[te]=n.Tag.render(M||(M=N`
			<input
				type="text"
				class="ui-ctl-element"
				maxlength="255"
				oninput="${0}"
			/>
		`),(({target:e})=>this.setDocumentTitle(e.value)));babelHelpers.classPrivateFieldLooseBase(this,ce)[ce]=r;babelHelpers.classPrivateFieldLooseBase(this,Me)[Me]();this.disableAddButton();babelHelpers.classPrivateFieldLooseBase(this,de)[de]()}isRuRegion(){return babelHelpers.classPrivateFieldLooseBase(this,Q)[Q]==="ru"}getAddDocumentButton(){return babelHelpers.classPrivateFieldLooseBase(this,z)[z].remember("addDocumentButton",(()=>n.Tag.render(U||(U=N`
				<button type="button" class="sign-b2e-document-setup__add-button" onclick="${0}">
					${0}
				</button>
			`),babelHelpers.classPrivateFieldLooseBase(this,Se)[Se].bind(this),babelHelpers.classPrivateFieldLooseBase(this,Te)[Te]())))}getAddDocumentNotice(){return babelHelpers.classPrivateFieldLooseBase(this,z)[z].remember("addDocumentNotice",(()=>n.Tag.render(I||(I=N`
				<p class="sign-wizard__notice">${0}</p>
			`),n.Loc.getMessage("SIGN_DOCUMENT_SETUP_ADD_DOCUMENT_NOTICE"))))}switchAddDocumentButtonLoadingState(e){if(e){n.Dom.addClass(this.getAddDocumentButton(),"ui-btn-wait")}else{n.Dom.removeClass(this.getAddDocumentButton(),"ui-btn-wait")}}disableAddButton(){n.Dom.addClass(this.getAddDocumentButton(),"--disabled")}enableAddButton(){n.Dom.removeClass(this.getAddDocumentButton(),"--disabled")}toggleDeleteBtnLoadingState(e){n.Dom.toggleClass(e,"ui-btn-wait")}renderDocumentBlock(e){if(!e){return}n.Dom.append(babelHelpers.classPrivateFieldLooseBase(this,De)[De](e),this.headerLayout)}updateDocumentBlock(e){const t=this.layout.querySelector(`[data-id="document-id-${e}"]`);const s=t.querySelector(".sign-b2e-document-setup__document-block_title");s.textContent=babelHelpers.classPrivateFieldLooseBase(this,te)[te].title}replaceDocumentBlock(e,t){const s=this.layout.querySelector(`[data-id="document-id-${e.id}"]`);n.Dom.replace(s,babelHelpers.classPrivateFieldLooseBase(this,De)[De](t))}toggleEditMode(e,t){if(babelHelpers.classPrivateFieldLooseBase(this,ie)[ie]!==e){this.resetEditMode()}const s=t.closest(`[data-id="document-id-${e}"]`);n.Dom.toggleClass(s,"--edit");if(this.editMode){t.textContent=n.Loc.getMessage("SIGN_DOCUMENT_SETUP_DOCUMENT_EDIT_BUTTON");babelHelpers.classPrivateFieldLooseBase(this,Me)[Me]();this.disableAddButton();this.editMode=false}else{t.textContent=n.Loc.getMessage("SIGN_DOCUMENT_SETUP_DOCUMENT_CANCEL_BUTTON");this.editMode=true;this.enableDocumentInputs();this.enableAddButton();babelHelpers.classPrivateFieldLooseBase(this,ie)[ie]=e;babelHelpers.classPrivateFieldLooseBase(this,ae)[ae]=t;babelHelpers.classPrivateFieldLooseBase(this,le)[le]=s}}resetEditMode(){if(!babelHelpers.classPrivateFieldLooseBase(this,ie)[ie]){return}babelHelpers.classPrivateFieldLooseBase(this,ae)[ae].textContent=n.Loc.getMessage("SIGN_DOCUMENT_SETUP_DOCUMENT_EDIT_BUTTON");n.Dom.removeClass(babelHelpers.classPrivateFieldLooseBase(this,le)[le],"--edit");this.editMode=false;babelHelpers.classPrivateFieldLooseBase(this,ae)[ae]=null;babelHelpers.classPrivateFieldLooseBase(this,le)[le]=null;babelHelpers.classPrivateFieldLooseBase(this,ie)[ie]=null}getHeaderLayout(){const e=this.isTemplateMode()?n.Loc.getMessage("SIGN_DOCUMENT_SETUP_TEMPLATE_HEADER"):n.Loc.getMessage("SIGN_DOCUMENT_SETUP_HEADER");this.headerLayout=n.Tag.render(k||(k=N`
			<h1 class="sign-b2e-settings__header">${0}</h1>
		`),e);return this.headerLayout}setDocumentTitle(e=""){babelHelpers.classPrivateFieldLooseBase(this,te)[te].value=e;babelHelpers.classPrivateFieldLooseBase(this,te)[te].title=e}setDocumentSenderType(e){if(!this.isTemplateMode()||!this.isSenderTypeAvailable()){return}const t=babelHelpers.classPrivateFieldLooseBase(this,Z)[Z].includes(e)?e:"employee";babelHelpers.classPrivateFieldLooseBase(this,ee)[ee].selectItem(t)}initLayout(){this.layout=n.Tag.render(A||(A=N`
			<div class="sign-document-setup">
				${0}
				${0}
			</div>
		`),this.getHeaderLayout(),this.getDocumentSectionLayout())}getDocumentSectionLayout(){if(!this.documentSectionLayout){this.documentSectionLayout=n.Tag.render(w||(w=N`
				<div class="sign-b2e-settings__item">
					${0}
				</div>
			`),this.getDocumentSectionInnerLayout());this.createHintPopup()}return this.documentSectionLayout}getDocumentSectionInnerLayout(){const e=this.isTemplateMode()?n.Loc.getMessage("SIGN_DOCUMENT_SETUP_ADD_TEMPLATE_TITLE"):n.Loc.getMessage("SIGN_DOCUMENT_SETUP_ADD_TITLE");this.documentSectionInnerLayout=n.Tag.render(j||(j=N`
			<div class="sign-b2e-settings__item-inner">
				<p class="sign-b2e-settings__item_title">
					${0}
				</p>
				${0}
			</div>
		`),e,this.blankSelector.getLayout());return this.documentSectionInnerLayout}createHintPopup(){this.hintPopup=new u.Popup({content:n.Loc.getMessage("SIGN_DOCUMENT_SETUP_DOCUMENT_LIMIT_POPUP"),autoHide:true,darkMode:true})}setAvailabilityDocumentSection(e){if(e){n.Dom.removeClass(this.documentSectionInnerLayout,"--disabled");n.Event.unbind(this.documentSectionLayout,"click",this.onClickShowHintPopup);this.hintPopup.close();return}n.Dom.addClass(this.documentSectionInnerLayout,"--disabled");n.Event.bind(this.documentSectionLayout,"click",this.onClickShowHintPopup)}showHintPopup(e){this.hintPopup.setBindElement(e);this.hintPopup.show()}async setup(e){try{const t=this.isEditActionMode()&&this.isTemplateMode()&&this.blankSelector.isFilesReadyForUpload();await super.setup(e,this.isTemplateMode(),t,babelHelpers.classPrivateFieldLooseBase(this,Ce)[Ce]());if(!this.setupData||this.blankIsNotSelected){this.ready=true;return}if(e){const{title:e,initiatedByType:t}=this.setupData;this.setDocumentTitle(e);this.setDocumentSenderType(t);return}this.ready=false;this.setupData=await this.updateDocumentData(this.setupData)}catch{const{blankId:e}=this.setupData;this.handleError(e)}this.ready=true}async updateDocumentData(e){if(!e){return}await Promise.all([babelHelpers.classPrivateFieldLooseBase(this,Oe)[Oe](e.uid)]);const{value:t}=babelHelpers.classPrivateFieldLooseBase(this,te)[te];const{templateUid:s}=this.setupData;const i=await babelHelpers.classPrivateFieldLooseBase(this,J)[J].modifyTitle(e.uid,t);const{blankTitle:a}=i;if(a){const{blankId:t}=e;this.blankSelector.modifyBlankTitle(t,a)}return{...e,title:t,templateUid:s}}validate(){return babelHelpers.classPrivateFieldLooseBase(this,Ne)[Ne](babelHelpers.classPrivateFieldLooseBase(this,te)[te])}isSenderTypeAvailable(){const e=n.Extension.getSettings("sign.v2.b2e.document-setup");return e.get("isSenderTypeAvailable")}resetDocument(){this.blankSelector.resetSelectedBlank();this.setDocumentTitle("");this.isFileAdded=false;babelHelpers.classPrivateFieldLooseBase(this,Me)[Me]();this.disableAddButton()}enableDocumentInputs(){babelHelpers.classPrivateFieldLooseBase(this,te)[te].disabled=false;this.blankIsNotSelected=false}}function Ie(){babelHelpers.classPrivateFieldLooseBase(this,Pe)[Pe]();const e=this.isTemplateMode()?n.Loc.getMessage("SIGN_DOCUMENT_SETUP_TITLE_TEMPLATE_HEAD_LABEL"):n.Loc.getMessage("SIGN_DOCUMENT_SETUP_TITLE_HEAD_LABEL");const s=n.Tag.render(K||(K=N`
			<div class="sign-b2e-settings__item">
				<p class="sign-b2e-settings__item_title">
					${0}
				</p>
				${0}
			</div>
		`),e,babelHelpers.classPrivateFieldLooseBase(this,ge)[ge]());n.Dom.append(babelHelpers.classPrivateFieldLooseBase(this,me)[me](),this.layout);n.Dom.append(s,this.layout);if(!this.isTemplateMode()&&t.FeatureStorage.isGroupSendingEnabled()){this.documentCounters=new a.DocumentCounters({documentCountersLimit:babelHelpers.classPrivateFieldLooseBase(this,se)[se]});n.Dom.append(this.documentCounters.getLayout(),this.layout);const e=babelHelpers.classPrivateFieldLooseBase(this,Be)[Be]();n.Dom.append(e,this.layout)}r.Hint.create(this.layout);babelHelpers.classPrivateFieldLooseBase(this,be)[be]()}function ke(){if(babelHelpers.classPrivateFieldLooseBase(this,re)[re]||babelHelpers.classPrivateFieldLooseBase(this,ne)[ne]){return[s.DocumentInitiated.company]}return Object.values(s.DocumentInitiated)}function Ae(){const e=this.blankSelector;e.subscribe(e.events.toggleSelection,babelHelpers.classPrivateFieldLooseBase(this,he)[he].bind(this));e.subscribe(e.events.addFile,babelHelpers.classPrivateFieldLooseBase(this,pe)[pe].bind(this));e.subscribe(e.events.beforeAddFileSuccessfully,babelHelpers.classPrivateFieldLooseBase(this,ve)[ve].bind(this));if(!this.isTemplateMode()&&t.FeatureStorage.isGroupSendingEnabled()){this.documentCounters.subscribe("limitNotExceeded",(()=>{this.enableAddButton();babelHelpers.classPrivateFieldLooseBase(this,Fe)[Fe]();this.emit("documentsLimitNotExceeded")}));this.documentCounters.subscribe("limitExceeded",(()=>{this.disableAddButton();babelHelpers.classPrivateFieldLooseBase(this,ye)[ye]();this.emit("documentsLimitExceeded")}))}}function we(e){const t=e.getData();this.isFileAdded=true;this.enableDocumentInputs();this.enableAddButton();if(!this.isTemplateMode()||!this.isEditActionMode()){this.setDocumentTitle(t.title)}const s=D.getOrCreateForObject(this);if(s.isUploadPopupCompletedOnce()){this.setDocumentTitle(t.title)}}function je(e){if(this.blankIsNotSelected&&this.editMode){return}const t=e.getData();const s=()=>{this.setDocumentTitle(t.title);if(t.selected){this.enableDocumentInputs();this.enableAddButton()}};if(!this.isEditActionMode()||!this.isTemplateMode()){s();return}const i=D.getOrCreateForObject(this);if(i.isSelectBlankPopupCompletedOnce()){s();return}const a=t.extra;if(!t.selected||a!=null&&a.isInitial||a!=null&&a.skipSelectPopupShow){return}const l=t.previousSelectedBlankId;i.showSelectBlankPopup();i.subscribeOnce(i.events.selectBlankPopup.onConfirm,s);i.subscribeOnce(i.events.selectBlankPopup.onCancel,(()=>{i.unsubscribe(i.events.selectBlankPopup.onConfirm,s);if(n.Type.isNumber(l)&&l>0){this.blankSelector.selectBlank(l,{skipSelectPopupShow:true})}}))}function Ke(e){if(!this.isTemplateMode()||!this.isEditActionMode()){return}const t=D.getOrCreateForObject(this);const s=this.blankSelector.selectedBlankId;if(t.isUploadPopupCompletedOnce()){return}t.showUploadPopup();const i=()=>{this.blankSelector.clearFiles();this.blankSelector.selectBlank(s,{skipSelectPopupShow:true})};const a=()=>{this.blankSelector.getBlank();const e=this.blankSelector.getUploadedFileName(0);if(n.Type.isStringFilled(e)){this.setDocumentTitle(e)}};const l=(e,s)=>i=>{e(i);t.unsubscribe(t.events.uploadPopup.onCancel,s);t.unsubscribe(t.events.uploadPopup.onConfirm,s)};t.subscribeOnce(t.events.uploadPopup.onCancel,l(i,a));t.subscribeOnce(t.events.uploadPopup.onConfirm,l(a,i))}function $e(){var e;if(!this.isTemplateMode()||!this.isSenderTypeAvailable()){return}babelHelpers.classPrivateFieldLooseBase(this,ee)[ee]=new l.SignDropdown({tabs:[{id:"b2e-document-sender-types",title:" "}],entities:[{id:"b2e-document-sender-type",searchFields:[{name:"caption",system:true}]}],className:"sign-b2e-document-setup__sender-type-selector",withCaption:true,isEnableSearch:false,height:110,width:350});babelHelpers.classPrivateFieldLooseBase(this,Z)[Z].forEach((e=>{if(n.Type.isStringFilled(e)){const t=`SIGN_DOCUMENT_SETUP_SENDER_TYPE_${e.toUpperCase()}`;babelHelpers.classPrivateFieldLooseBase(this,ee)[ee].addItem({id:e,title:n.Loc.getMessage(t),entityId:"b2e-document-sender-type",tabs:"b2e-document-sender-types",deselectable:false})}}));const t=babelHelpers.classPrivateFieldLooseBase(this,oe)[oe]?1:0;const s=(e=babelHelpers.classPrivateFieldLooseBase(this,Z)[Z][t])!=null?e:null;if(s){babelHelpers.classPrivateFieldLooseBase(this,ee)[ee].selectItem(s)}}function Ge(){if(babelHelpers.classPrivateFieldLooseBase(this,_e)[_e]()){return null}return n.Tag.render($||($=N`
			<div class="sign-b2e-settings__item">
				<p class="sign-b2e-settings__item_title">
					<span>${0}</span>
				</p>
				${0}
				${0}
			</div>
		`),n.Loc.getMessage("SIGN_DOCUMENT_SETUP_SENDER_TYPE_TITLE"),babelHelpers.classPrivateFieldLooseBase(this,ee)[ee].getLayout(),babelHelpers.classPrivateFieldLooseBase(this,Le)[Le]())}function xe(){return!this.isTemplateMode()||!this.isSenderTypeAvailable()||babelHelpers.classPrivateFieldLooseBase(this,oe)[oe]||babelHelpers.classPrivateFieldLooseBase(this,re)[re]||babelHelpers.classPrivateFieldLooseBase(this,ne)[ne]}function Re(){return r.Helpdesk.replaceLink(n.Loc.getMessage("SIGN_DOCUMENT_SETUP_SENDER_TYPE_HELP_LINK"),q.HowToWorkWithTemplates,"detail",["ui-link"])}function Xe(){return n.Tag.render(G||(G=N`
			<div>
				<div class="sign-b2e-document-setup__title-item --full">
					<div class="ui-ctl ui-ctl-textbox">
						${0}
					</div>
				</div>
				${0}
			</div>
		`),babelHelpers.classPrivateFieldLooseBase(this,te)[te],babelHelpers.classPrivateFieldLooseBase(this,He)[He]())}function Ve(){return babelHelpers.classPrivateFieldLooseBase(this,z)[z].remember("addDocumentLayout",(()=>n.Tag.render(x||(x=N`
				<div class="sign-b2e-settings__item --add">
					<div class="sign-b2e-settings__item_title">
						<span>${0}</span>
						${0}
					</div>
					${0}
					${0}
				</div>
			`),n.Loc.getMessage("SIGN_DOCUMENT_SETUP_ADD_DOCUMENT"),this.documentCounters.getLayout(),this.getAddDocumentButton(),this.getAddDocumentNotice())))}function We(){return babelHelpers.classPrivateFieldLooseBase(this,z)[z].remember("addDocumentButtonText",(()=>n.Tag.render(R||(R=N`
				<span class="sign-b2e-document-setup__add-button_text">${0}</span>
			`),n.Loc.getMessage("SIGN_DOCUMENT_SETUP_ADD_ANOTHER_DOCUMENT"))))}function Ye(){n.Dom.addClass(this.getAddDocumentNotice(),"--warning");this.getAddDocumentNotice().textContent=n.Loc.getMessage("SIGN_DOCUMENT_SETUP_DOCUMENT_GROUP_LIMIT_NOTICE",{"%limit%":babelHelpers.classPrivateFieldLooseBase(this,se)[se]})}function qe(){n.Dom.removeClass(this.getAddDocumentNotice(),"--warning");this.getAddDocumentNotice().textContent=n.Loc.getMessage("SIGN_DOCUMENT_SETUP_ADD_DOCUMENT_NOTICE")}function ze(){this.emit("addDocument")}function Je(e){const t=n.Tag.render(X||(X=N`
			<button class="sign-b2e-document-setup__document-block_delete" type="button"></button>
		`));const s=n.Tag.render(V||(V=N`
			<button class="ui-btn ui-btn-round ui-btn-sm ui-btn-light-border" type="button">
				${0}
			</button>
		`),n.Loc.getMessage("SIGN_DOCUMENT_SETUP_DOCUMENT_EDIT_BUTTON"));n.Event.bind(t,"click",(t=>{babelHelpers.classPrivateFieldLooseBase(this,Ee)[Ee](e,t)}));n.Event.bind(s,"click",(t=>{babelHelpers.classPrivateFieldLooseBase(this,fe)[fe](e,t)}));return n.Tag.render(W||(W=N`
			<div class="sign-b2e-document-setup__document-block" data-id="document-id-${0}">
				<div class="sign-b2e-document-setup__document-block_inner">
					<div class="sign-b2e-document-setup__document-block_title">${0}</div>
				</div>
				<div class="sign-b2e-document-setup__document-block_btn">
					${0}
					${0}
				</div>
				<div class="sign-b2e-document-setup__document-block_hint">
					${0}
				</div>
			</div>
		`),e.id,e.title,s,t,n.Loc.getMessage("SIGN_DOCUMENT_SETUP_ADD_DOCUMENT_HINT"))}function Qe(){if(this.isTemplateMode()){return null}return babelHelpers.classPrivateFieldLooseBase(this,z)[z].remember("documentHintLayout",(()=>n.Tag.render(Y||(Y=N`
				<p class="sign-b2e-document-setup__title-text">
					${0}
				</p>
			`),n.Loc.getMessage("SIGN_DOCUMENT_SETUP_TITLE_HINT"))))}function Ze(e,t){this.setupData=null;const{id:s,uid:i,blankId:a}=e;const l=t.target;this.toggleDeleteBtnLoadingState(l);this.emit("deleteDocument",{id:s,uid:i,blankId:a,deleteButton:l})}function et(e,t){const{id:s,uid:i}=e;this.toggleEditMode(s,t.target);this.emit("editDocument",{uid:i})}function tt(e){if(!this.isTemplateMode()||!this.isSenderTypeAvailable()){return Promise.resolve()}const t=babelHelpers.classPrivateFieldLooseBase(this,Ce)[Ce]();this.setupData.initiatedByType=t;return babelHelpers.classPrivateFieldLooseBase(this,J)[J].changeSenderDocumentType(e,t)}function st(){if(!this.isTemplateMode()){return null}if(!this.isSenderTypeAvailable()){return babelHelpers.classPrivateFieldLooseBase(this,ce)[ce]}return babelHelpers.classPrivateFieldLooseBase(this,ee)[ee].getSelectedId()}function it(e){if(!e){return true}const{parentNode:t,value:s}=e;if(s.trim()!==""){n.Dom.removeClass(t,"ui-ctl-warning");return true}n.Dom.addClass(t,"ui-ctl-warning");e.focus();return false}function at(){babelHelpers.classPrivateFieldLooseBase(this,te)[te].disabled=true;this.blankIsNotSelected=true}e.DocumentSetup=Ue})(this.BX.Sign.V2.B2e=this.BX.Sign.V2.B2e||{},BX.Sign,BX.Sign,BX.Sign.V2,BX.Sign.V2.B2e,BX.Sign.V2.B2e,BX.Sign.V2,BX.Sign.V2,BX,BX.Cache,BX.Event,BX.Main,BX.UI);
//# sourceMappingURL=document-setup.bundle.map.js