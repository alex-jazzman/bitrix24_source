{"version":3,"file":"regional-settings.bundle.js","sources":["../src/store.js","../src/components/document-type-selector.js","../src/components/hcmlink-document-type-selector.js","../src/components/registration-number-settings.js","../src/components/date-settings.js","../../vue-util/src/components/switcher/switcher.js","../src/components/company-selector.js","../../vue-util/src/components/document-preview/document-preview.js","../src/components/document-regional-settings.js","../../vue-util/src/components/document-preview-list/document-preview-list.js","../src/app.js","../src/regional-settings.js"],"sourcesContent":["import { DateTimeFormat } from 'main.date';\nimport { defineStore } from 'ui.vue3.pinia';\nimport type { DocumentSettings } from './types';\nimport type { DocumentDetails } from 'sign.v2.document-setup';\nimport { Api } from 'sign.v2.api';\n\nexport type RegionalSettingsStoreState = {\n\tcompanyId: null | number,\n\tisIntegrationEnabled: boolean,\n\tisIntegrationVisible: boolean,\n\thcmLinkCompanyId: null,\n\thcmLinkAvailableSettings: {\n\t\tdocumentTypeList: Array<{ id: number, title: string }>,\n\t\texternalIdTypeList: Array<{ id: number, title: string }>,\n\t\tdateTypeList: Array<{ id: number, title: string }>,\n\t},\n\tdocumentTypeList: Array<{ code: string, description: string }>,\n\tdocumentSettingsMap: Map<string, DocumentSettings>,\n\tcurrentDocumentUid: string | null,\n\tdocumentsGroup: Map<string, DocumentDetails>,\n};\n\nexport type RegionalSettingsStoreInitOptions = {\n\tdocumentTypeList: Array<{ id: string, title: string }>\n}\n\nexport const DefaultDocumentSettings: DocumentSettings = {\n\tdate: {\n\t\tsourceType: 'manual',\n\t\tvalue: new Date(),\n\t\thcmLinkSettingId: null,\n\t},\n\texternalId: {\n\t\tsourceType: 'manual',\n\t\tvalue: null,\n\t\thcmLinkSettingId: null,\n\t},\n\thcmLinkDocumentTypeSettingId: null,\n\tdocumentType: null,\n};\n\nexport const useRegionalSettingsStore = defineStore('sign-b2e-regional-settings-store', {\n\tstate: (): RegionalSettingsStoreState => ({\n\t\tcurrentDocumentUid: null,\n\t\tcompanyId: null,\n\t\tisIntegrationEnabled: false,\n\t\tisIntegrationVisible: true,\n\t\tdocumentTypeList: [],\n\t\thcmLinkCompanyId: null,\n\t\thcmLinkAvailableSettings: {\n\t\t\tdocumentTypeList: [],\n\t\t\texternalIdTypeList: [],\n\t\t\tdateTypeList: [],\n\t\t},\n\t\tdocumentSettingsMap: new Map(),\n\t\tdocumentsGroup: new Map(),\n\t}),\n\tgetters: {\n\t\tcurrentDocumentSettings(state): DocumentSettings\n\t\t{\n\t\t\tif (!state.currentDocumentUid || !state.documentSettingsMap.has(state.currentDocumentUid))\n\t\t\t{\n\t\t\t\treturn DefaultDocumentSettings;\n\t\t\t}\n\n\t\t\treturn state.documentSettingsMap.get(state.currentDocumentUid);\n\t\t},\n\t},\n\tactions: {\n\t\tinit(options: RegionalSettingsStoreInitOptions): void\n\t\t{\n\t\t\tthis.documentTypeList = options.documentTypeList;\n\t\t},\n\t\tupdateDocumentsGroup(documentsGroup: Map<string, DocumentDetails>): void\n\t\t{\n\t\t\tconst documentsToDelete = [...this.documentsGroup.keys()].filter((key) => !documentsGroup.has(key));\n\t\t\tdocumentsToDelete.forEach((key): void => {\n\t\t\t\tthis.documentsGroup.delete(key);\n\t\t\t\tthis.documentSettingsMap.delete(key);\n\t\t\t});\n\n\t\t\tfor (const [uid, documentDetail] of documentsGroup)\n\t\t\t{\n\t\t\t\tconst documentDetailPrevious = this.documentsGroup.has(uid) ? this.documentsGroup.get(uid) : {};\n\n\t\t\t\tthis.documentsGroup.set(uid, {\n\t\t\t\t\t...documentDetailPrevious,\n\t\t\t\t\t...documentDetail,\n\t\t\t\t});\n\t\t\t\tif (this.documentSettingsMap.has(uid))\n\t\t\t\t{\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tconst settings = {\n\t\t\t\t\tdate: {\n\t\t\t\t\t\tsourceType: documentDetail.externalDateCreateSourceType,\n\t\t\t\t\t\thcmLinkSettingId: documentDetail.hcmLinkDateSettingId,\n\t\t\t\t\t\tvalue: documentDetail.externalDateCreate ? new Date(documentDetail.externalDateCreate) : new Date(),\n\t\t\t\t\t},\n\t\t\t\t\texternalId: {\n\t\t\t\t\t\tsourceType: documentDetail.externalIdSourceType,\n\t\t\t\t\t\thcmLinkSettingId: documentDetail.hcmLinkExternalIdSettingId,\n\t\t\t\t\t\tvalue: documentDetail.externalId,\n\t\t\t\t\t},\n\t\t\t\t\thcmLinkDocumentTypeSettingId: documentDetail.hcmLinkDocumentTypeSettingId,\n\t\t\t\t\tdocumentType: documentDetail.regionDocumentType,\n\t\t\t\t};\n\n\t\t\t\tthis.documentSettingsMap.set(uid, settings);\n\t\t\t\tif (this.hcmLinkCompanyId === null)\n\t\t\t\t{\n\t\t\t\t\tthis.hcmLinkCompanyId = documentDetail.hcmLinkCompanyId;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (documentsToDelete.includes(this.currentDocumentUid))\n\t\t\t{\n\t\t\t\tthis.currentDocumentUid = null;\n\t\t\t}\n\n\t\t\tconst documentsToAdd = [...documentsGroup.keys()].filter((key) => !this.documentSettingsMap.has(key));\n\t\t\tdocumentsToAdd.forEach((key) => {\n\t\t\t\tthis.documentSettingsMap.set(key, {\n\t\t\t\t\t...DefaultDocumentSettings,\n\t\t\t\t\tdocumentType: this.documentTypeList[0].code ?? null,\n\t\t\t\t});\n\t\t\t});\n\n\t\t\tif (this.currentDocumentUid === null)\n\t\t\t{\n\t\t\t\tthis.currentDocumentUid = documentsToAdd[0] ?? null;\n\t\t\t}\n\t\t},\n\t\tmodifyHcmLinkCompanyId(id: number | null): void\n\t\t{\n\t\t\tif (id === null)\n\t\t\t{\n\t\t\t\tfor (const [uid, settings] of this.documentSettingsMap)\n\t\t\t\t{\n\t\t\t\t\tthis.documentSettingsMap.set(uid, {\n\t\t\t\t\t\t...settings,\n\t\t\t\t\t\tdate: {\n\t\t\t\t\t\t\t...settings.date,\n\t\t\t\t\t\t\tsourceType: 'manual',\n\t\t\t\t\t\t\thcmLinkSettingId: null,\n\t\t\t\t\t\t},\n\t\t\t\t\t\texternalId: {\n\t\t\t\t\t\t\t...settings.externalId,\n\t\t\t\t\t\t\tsourceType: 'manual',\n\t\t\t\t\t\t\thcmLinkSettingId: null,\n\t\t\t\t\t\t},\n\t\t\t\t\t\thcmLinkDocumentTypeSettingId: null,\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis.hcmLinkCompanyId = id;\n\t\t},\n\t\tmodifyAvailableHcmLinkSettings(settings: RegionalSettingsStoreState['hcmLinkAvailableSettings']): void\n\t\t{\n\t\t\tthis.hcmLinkAvailableSettings = settings;\n\t\t\tconst documentUids = [...this.documentSettingsMap.keys()];\n\n\t\t\tdocumentUids.forEach((uid: string) => {\n\t\t\t\tif (!this.documentSettingsMap.has(uid))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tconst stored = this.documentSettingsMap.get(uid);\n\t\t\t\tif (!this.documentsGroup.has(uid))\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tconst documentDetails = this.documentsGroup.get(uid);\n\n\t\t\t\tif (documentDetails.hcmLinkCompanyId === this.hcmLinkCompanyId)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tthis.documentSettingsMap.set(uid, {\n\t\t\t\t\t...stored,\n\t\t\t\t\tdate: {\n\t\t\t\t\t\t...stored.date,\n\t\t\t\t\t\thcmLinkSettingId: settings?.dateTypeList[0]?.id ?? null,\n\t\t\t\t\t},\n\t\t\t\t\texternalId: {\n\t\t\t\t\t\t...stored.externalId,\n\t\t\t\t\t\thcmLinkSettingId: settings?.externalIdTypeList[0]?.id ?? null,\n\t\t\t\t\t},\n\t\t\t\t\thcmLinkDocumentTypeSettingId: null,\n\t\t\t\t});\n\t\t\t});\n\t\t},\n\t\tmodifyCurrentDocumentSettings(settings: Partial<DocumentSettings>): void\n\t\t{\n\t\t\tif (!this.currentDocumentUid)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst storedSettings = this.documentSettingsMap.get(this.currentDocumentUid);\n\t\t\tthis.documentSettingsMap.set(this.currentDocumentUid, {\n\t\t\t\t...storedSettings,\n\t\t\t\t...settings,\n\t\t\t});\n\t\t},\n\t\tsetDocumentSettings(uid: string, settings: DocumentSettings): void\n\t\t{\n\t\t\tif (!uid)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (!this.documentSettingsMap.has(uid))\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst storedSettings = this.documentSettingsMap.get(uid);\n\t\t\tthis.documentSettingsMap.set(uid, {\n\t\t\t\t...storedSettings,\n\t\t\t\t...settings,\n\t\t\t});\n\t\t},\n\t\tasync save(): Promise<void>\n\t\t{\n\t\t\tconst api = new Api();\n\n\t\t\tconst documentUids = [...this.documentSettingsMap.keys()];\n\n\t\t\tawait Promise.all(documentUids.map((uid: string) => {\n\t\t\t\treturn api.changeIntegrationId(uid, this.hcmLinkCompanyId);\n\t\t\t}));\n\n\t\t\tawait Promise.all(documentUids.map((uid: string) => {\n\t\t\t\tconst { documentType, externalId, date, hcmLinkDocumentTypeSettingId } = this.documentSettingsMap.get(uid);\n\t\t\t\tlet dateValue = date.value;\n\t\t\t\tif (date.value)\n\t\t\t\t{\n\t\t\t\t\tdateValue = DateTimeFormat.format(DateTimeFormat.getFormat('SHORT_DATE_FORMAT'), date.value);\n\t\t\t\t}\n\n\t\t\t\tconst apiPromises = [\n\t\t\t\t\tapi.changeRegionDocumentType(uid, documentType),\n\t\t\t\t];\n\n\t\t\t\tif (this.isIntegrationVisible)\n\t\t\t\t{\n\t\t\t\t\tapiPromises.push(\n\t\t\t\t\t\tapi.changeHcmLinkDocumentType(uid, hcmLinkDocumentTypeSettingId),\n\t\t\t\t\t\tapi.changeExternalDate(uid, dateValue, date.sourceType, date.hcmLinkSettingId),\n\t\t\t\t\t\tapi.changeExternalId(uid, externalId.value, externalId.sourceType, externalId.hcmLinkSettingId),\n\t\t\t\t\t);\n\t\t\t\t}\n\n\t\t\t\treturn Promise.all(apiPromises);\n\t\t\t}));\n\t\t},\n\t},\n});\n","import { Hint } from 'ui.vue3.components.hint';\nimport { LocMixin, SignDropdownComponent } from 'sign.v2.b2e.vue-util';\n\n// @vue/component\nexport const DocumentTypeSelector = {\n\tname: 'DocumentTypeSelector',\n\tcomponents: {\n\t\tSignDropdownComponent,\n\t\tHint,\n\t},\n\tmixins: [LocMixin],\n\tprops: {\n\t\ttypeList: {\n\t\t\ttype: Array,\n\t\t\trequired: true,\n\t\t\tdefault: () => [],\n\t\t},\n\t\tselectedId: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t},\n\temits: ['onSelected'],\n\n\tcomputed: {\n\t\tdropdownItems(): Array<{ id: string, title: string, description: string }>\n\t\t{\n\t\t\treturn this.typeList.map(({ code, description }) => ({\n\t\t\t\tid: code,\n\t\t\t\ttitle: code,\n\t\t\t\tcaption: `(${description})`,\n\t\t\t\tentityId: 'b2e-document-code',\n\t\t\t\ttabId: 'b2e-document-codes',\n\t\t\t}));\n\t\t},\n\t},\n\n\tmethods: {\n\t\tsetType(item: { id: string }): void\n\t\t{\n\t\t\tthis.$emit('onSelected', item.id);\n\t\t},\n\t},\n\n\ttemplate: `\n\t\t<div class=\"sign-b2e-regional-settings__item\">\n\t\t\t<p class=\"sign-b2e-regional-settings__item-text\">\n\t\t\t\t<span>{{ loc('SIGN_DOCUMENT_SETUP_TYPE') }}</span>\n\t\t\t  \t<Hint class=\"sign-b2e-regional-settings__hint\" :text=\"loc('SIGN_DOCUMENT_SETUP_TYPE_HINT')\"/>\n\t\t\t</p>\n\t\t\t<SignDropdownComponent \n\t\t\t\tclass=\"sign-b2e-regional-settings-dropdown\"\n\t\t\t\t:entities=\"[{ id: 'b2e-document-code', searchFields: [{ name: 'caption', system: true }] }]\"\n\t\t\t\t:tabs=\"[{ id: 'b2e-document-codes', title: ' ' }]\"\n\t\t\t\t:items=\"dropdownItems\"\n\t\t\t\t:isEnableSearch=\"true\"\n\t\t\t\t:isWithCaption=\"true\"\n\t\t\t\t:selectedId=\"selectedId\"\n\t\t\t\t@onSelected=\"setType\"\n\t\t\t/>\n\t\t</div>\n\t`,\n};\n","import { Loc } from 'main.core';\nimport { LocMixin, SignSelector } from 'sign.v2.b2e.vue-util';\n\nconst NotSelectedItem = Object.freeze({\n\tid: null,\n\ttitle: Loc.getMessage('SIGN_V2_B2E_REGIONAL_SETTINGS_NOT_SELECTED_ITEM'),\n});\n\n// @vue/component\nexport const HcmLinkDocumentTypeSelector = {\n\tname: 'HcmLinkDocumentTypeSelector',\n\tcomponents: {\n\t\tSignSelector,\n\t},\n\tmixins: [LocMixin],\n\tprops: {\n\t\ttypeList: {\n\t\t\ttype: Array,\n\t\t\trequired: true,\n\t\t\tdefault: () => [],\n\t\t},\n\t\tselectedId: {\n\t\t\ttype: [Number, null],\n\t\t\trequired: true,\n\t\t},\n\t},\n\temits: ['onSelected'],\n\n\tcomputed: {\n\t\tdropdownItems(): Array<{ id: number, title: string, }>\n\t\t{\n\t\t\tconst typeList = this.typeList.length > 0 ? [NotSelectedItem, ...this.typeList] : [NotSelectedItem];\n\n\t\t\treturn typeList.map(({ id, title }) => ({\n\t\t\t\tid,\n\t\t\t\ttitle,\n\t\t\t}));\n\t\t},\n\t},\n\n\tmethods: {\n\t\tonSelected(id: number | null): void\n\t\t{\n\t\t\tthis.$emit('onSelected', id);\n\t\t},\n\t},\n\n\ttemplate: `\n\t\t<div class=\"sign-b2e-regional-settings__item\">\n\t\t  <p class=\"sign-b2e-regional-settings__item-text\">\n\t\t    <span>{{ loc('SIGN_V2_B2E_REGIONAL_SETTINGS_DOCUMENT_HCMLINK_UID_TYPE') }}</span>\n\t\t  </p>\n\t\t  <SignSelector\n\t\t      :items=\"dropdownItems\"\n\t\t\t  :selectedId=\"selectedId\"\n\t\t\t  @onSelect=\"onSelected\"\n\t\t  />\n\t\t</div>\n\t`,\n};\n","import { Tag, Text } from 'main.core';\nimport { Popup } from 'main.popup';\nimport { Switcher } from 'ui.vue3.components.switcher';\nimport { SwitcherSize } from 'ui.switcher';\nimport { LocMixin, Notice, SignSelector } from 'sign.v2.b2e.vue-util';\nimport { type ExternalIdSettings } from '../types';\n\n// @vue/component\nexport const RegistrationNumberSettings = {\n\tname: 'RegistrationNumberSettings',\n\tcomponents: {\n\t\tSwitcher,\n\t\tSignSelector,\n\t\tNotice,\n\t},\n\tmixins: [LocMixin],\n\tprops: {\n\t\thcmLinkTypeList: {\n\t\t\ttype: Array,\n\t\t\trequired: false,\n\t\t\tdefault: () => [],\n\t\t},\n\t\ttemplateMode: {\n\t\t\ttype: Boolean,\n\t\t\trequired: false,\n\t\t\tdefault: false,\n\t\t},\n\t\tsettings: {\n\t\t\t/** @type ExternalIdSettings */\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t\tisIntegrationEnabled: {\n\t\t\ttype: Boolean,\n\t\t\trequired: false,\n\t\t\tdefault: false,\n\t\t},\n\t\tisIntegrationDisabledByProvider: {\n\t\t\ttype: Boolean,\n\t\t\trequired: false,\n\t\t\tdefault: false,\n\t\t},\n\t},\n\temits: ['onChange'],\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tisValid: true,\n\t\t\tswitcherSize: SwitcherSize.extraSmall,\n\t\t};\n\t},\n\tcomputed: {\n\t\tdropdownItems(): Array<{ id: string, title: string, }>\n\t\t{\n\t\t\treturn this.hcmLinkTypeList.map(({ id, title }) => ({\n\t\t\t\tid,\n\t\t\t\ttitle,\n\t\t\t}));\n\t\t},\n\t\tisChecked(): boolean\n\t\t{\n\t\t\treturn this.settings.sourceType === 'hcmlink' && this.isIntegrationEnabled;\n\t\t},\n\t},\n\twatch: {\n\t\tisChecked(newValue: boolean)\n\t\t{\n\t\t\tthis.toggleHcmLink(newValue);\n\t\t},\n\t},\n\tmethods: {\n\t\ttoggleHcmLink(value: boolean): void\n\t\t{\n\t\t\tthis.$emit('onChange', this.settings);\n\t\t\tif (value === true)\n\t\t\t{\n\t\t\t\tif (this.hcmLinkTypeList.length <= 0 || !this.isIntegrationEnabled)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tthis.changeSettings({\n\t\t\t\t\t...this.settings,\n\t\t\t\t\tsourceType: 'hcmlink',\n\t\t\t\t});\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.changeSettings({\n\t\t\t\t...this.settings,\n\t\t\t\tsourceType: 'manual',\n\t\t\t});\n\t\t},\n\t\tselectHcmLinkSetting(id: number): void\n\t\t{\n\t\t\tthis.changeSettings({\n\t\t\t\t...this.settings,\n\t\t\t\thcmLinkSettingId: id,\n\t\t\t});\n\t\t},\n\t\tchangeManualValue(value: string): void\n\t\t{\n\t\t\tthis.changeSettings({\n\t\t\t\t...this.settings,\n\t\t\t\tvalue,\n\t\t\t});\n\t\t},\n\t\tchangeSettings(settings: ExternalIdSettings): void\n\t\t{\n\t\t\tthis.$emit('onChange', settings);\n\t\t},\n\t\tvalidate(): boolean\n\t\t{\n\t\t\tthis.isValid = !(this.isChecked === false && !this.settings.value);\n\n\t\t\treturn this.isValid;\n\t\t},\n\t\tshowHideTooltipIfDisabled(event): void\n\t\t{\n\t\t\tthis.hintDisabled?.close();\n\t\t\tthis.hintDisabled?.destroy();\n\n\t\t\tconst commonHintSettings = {\n\t\t\t\tbindElement: event?.target,\n\t\t\t\tdarkMode: true,\n\t\t\t\tautoHide: true,\n\t\t\t\tcacheable: false,\n\t\t\t};\n\t\t\tif (this.isIntegrationDisabledByProvider)\n\t\t\t{\n\t\t\t\tthis.hintDisabled = new Popup({\n\t\t\t\t\tcontent: Tag.render`\n\t\t\t\t\t\t<span class='ui-hint-content'>\n\t\t\t\t\t\t\t${Text.encode(this.loc('SIGN_V2_B2E_REGIONAL_SETTINGS_DOCUMENT_EXTERNAL_ID_DISABLED_HINT'))}\n\t\t\t\t\t\t</span>\n\t\t\t\t\t`,\n\t\t\t\t\t...commonHintSettings,\n\t\t\t\t});\n\t\t\t}\n\t\t\telse if (this.isIntegrationEnabled && this.hcmLinkTypeList.length === 0)\n\t\t\t{\n\t\t\t\tthis.hintDisabled = new Popup({\n\t\t\t\t\tcontent: Tag.render`\n\t\t\t\t\t\t<span class='ui-hint-content'>\n\t\t\t\t\t\t\t${Text.encode(this.loc('SIGN_V2_B2E_REGIONAL_SETTINGS_DOCUMENT_EXTERNAL_ID_NO_SETTINGS'))}\n\t\t\t\t\t\t</span>\n\t\t\t\t\t`,\n\t\t\t\t\t...commonHintSettings,\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tthis.hintDisabled?.show();\n\t\t},\n\t\tcreated(): void\n\t\t{\n\t\t\tthis.hintDisabled = null;\n\t\t},\n\t},\n\n\ttemplate: `\n\t\t<div class=\"sign-b2e-regional-settings__item\">\n\t\t\t<p class=\"sign-b2e-regional-settings__item-text\">\n\t\t\t\t<Switcher style=\"height: 13px\"\n\t\t\t\t\t:isChecked=\"isChecked\"\n\t\t\t\t\t:options=\"{ size: switcherSize }\"\n\t\t\t\t\t@check=\"toggleHcmLink(true)\"\n\t\t\t\t\t@uncheck=\"toggleHcmLink(false)\"\n\t\t\t\t\t@click=\"showHideTooltipIfDisabled\"\n\t\t\t\t/>\n\t\t\t\t<span style=\"margin-left: 8px\">\n\t\t\t\t  {{ loc('SIGN_V2_B2E_REGIONAL_SETTINGS_DOCUMENT_EXTERNAL_ID_HCMLINK_SWITCHER_TEXT') }}\n\t\t\t\t</span>\n\t\t    </p>\n\t\t\t<SignSelector v-if=\"isChecked\"\n\t\t\t\t:items=\"dropdownItems\"\n\t\t\t\t:selectedId=\"settings.hcmLinkSettingId\"\n\t\t\t\t@onSelect=\"selectHcmLinkSetting\"\n\t\t\t/>\n\t\t\t<div v-else-if=\"!templateMode\"\n\t\t\t\tclass=\"ui-ctl-textbox ui-ctl-w100 ui-ctl-md\"\n\t\t\t>\n\t\t\t\t<input\n\t\t\t\t\t:value=\"settings.value\"\n\t\t\t\t\t:placeholder=\"loc('SIGN_V2_B2E_REGIONAL_SETTINGS_DOCUMENT_EXTERNAL_ID_INPUT_HINT')\" \n\t\t\t\t\ttype=\"text\" \n\t\t\t\t\tclass=\"ui-ctl-element sign-b2e-regional-settings-reg-number-input\"\n\t\t\t\t\t:class=\"{'ui-element-invalid': !isValid}\"\n\t\t\t\t\tmaxlength=\"255\"\n\t\t\t\t\t@input=\"changeManualValue($event.target.value)\"\n\t\t\t\t>\n\t\t\t</div>\n\t\t  \t<Notice style=\"margin-top: 8px\">\n\t\t\t  {{ loc('SIGN_V2_B2E_REGIONAL_SETTINGS_DOCUMENT_EXTERNAL_ID_NOTICE') }}\n\t\t\t</Notice>\n\t\t</div>\n\t`,\n};\n","import { Tag, Text } from 'main.core';\nimport { Popup } from 'main.popup';\nimport { Switcher } from 'ui.vue3.components.switcher';\nimport { SwitcherSize } from 'ui.switcher';\nimport { DateSelector, LocMixin, SignSelector, RoundedSmallSelectedItemView } from 'sign.v2.b2e.vue-util';\nimport type { DateSettings as DateSettingsType } from '../types';\nimport { Hint } from 'ui.vue3.components.hint';\n\n// @vue/component\nexport const DateSettings = {\n\tname: 'DateSettings',\n\tcomponents: {\n\t\tDateSelector,\n\t\tSignSelector,\n\t\tSwitcher,\n\t\tRoundedSmallSelectedItemView,\n\t\tHint,\n\t},\n\tmixins: [LocMixin],\n\tprops: {\n\t\thcmLinkTypeList: {\n\t\t\ttype: Array,\n\t\t\trequired: true,\n\t\t\tdefault: () => [],\n\t\t},\n\t\ttemplateMode: {\n\t\t\ttype: Boolean,\n\t\t\trequired: false,\n\t\t\tdefault: false,\n\t\t},\n\t\tisIntegrationEnabled: {\n\t\t\ttype: Boolean,\n\t\t\trequired: false,\n\t\t\tdefault: false,\n\t\t},\n\t\tsettings: {\n\t\t\t/** @type DateSettingsType */\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t\tisIntegrationDisabledByProvider: {\n\t\t\ttype: Boolean,\n\t\t\trequired: false,\n\t\t\tdefault: false,\n\t\t},\n\t},\n\temits: ['onChange'],\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tswitcherSize: SwitcherSize.extraSmall,\n\t\t};\n\t},\n\tcomputed: {\n\t\tdropdownItems(): Array<{ id: string, title: string, }>\n\t\t{\n\t\t\treturn this.hcmLinkTypeList.map(({ id, title }) => ({\n\t\t\t\tid,\n\t\t\t\ttitle,\n\t\t\t}));\n\t\t},\n\t\tisChecked(): boolean\n\t\t{\n\t\t\treturn this.settings.sourceType === 'hcmlink' && this.isIntegrationEnabled;\n\t\t},\n\t},\n\twatch: {\n\t\tisChecked(newValue: boolean)\n\t\t{\n\t\t\tthis.toggleHcmLink(newValue);\n\t\t},\n\t},\n\tmethods: {\n\t\ttoggleHcmLink(value: boolean): void\n\t\t{\n\t\t\tif (value === true)\n\t\t\t{\n\t\t\t\tif (this.hcmLinkTypeList.length <= 0 || !this.isIntegrationEnabled)\n\t\t\t\t{\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tthis.changeSettings({\n\t\t\t\t\t...this.settings,\n\t\t\t\t\tsourceType: 'hcmlink',\n\t\t\t\t});\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.changeSettings({\n\t\t\t\t...this.settings,\n\t\t\t\tsourceType: 'manual',\n\t\t\t});\n\t\t},\n\t\tselectHcmLinkSetting(id: number): void\n\t\t{\n\t\t\tthis.changeSettings({\n\t\t\t\t...this.settings,\n\t\t\t\thcmLinkSettingId: id,\n\t\t\t});\n\t\t},\n\t\tselectDate(date: Date): void\n\t\t{\n\t\t\tthis.changeSettings({\n\t\t\t\t...this.settings,\n\t\t\t\tvalue: date,\n\t\t\t});\n\t\t},\n\t\tchangeSettings(settings: DateSettingsType): void\n\t\t{\n\t\t\tthis.$emit('onChange', settings);\n\t\t},\n\t\tshowHideTooltipIfDisabled(event): void\n\t\t{\n\t\t\tthis.hintDisabled?.close();\n\t\t\tthis.hintDisabled?.destroy();\n\n\t\t\tconst commonHintSettings = {\n\t\t\t\tbindElement: event?.target,\n\t\t\t\tdarkMode: true,\n\t\t\t\tautoHide: true,\n\t\t\t\tcacheable: false,\n\t\t\t};\n\t\t\tif (this.isIntegrationDisabledByProvider)\n\t\t\t{\n\t\t\t\tthis.hintDisabled = new Popup({\n\t\t\t\t\tcontent: Tag.render`\n\t\t\t\t\t\t<span class='ui-hint-content'>\n\t\t\t\t\t\t\t${Text.encode(this.loc('SIGN_V2_B2E_REGIONAL_SETTINGS_DOCUMENT_DATE_DISABLED_HINT'))}\n\t\t\t\t\t\t</span>\n\t\t\t\t\t`,\n\t\t\t\t\t...commonHintSettings,\n\t\t\t\t});\n\t\t\t}\n\t\t\telse if (this.isIntegrationEnabled && this.hcmLinkTypeList.length === 0)\n\t\t\t{\n\t\t\t\tthis.hintDisabled = new Popup({\n\t\t\t\t\tcontent: Tag.render`\n\t\t\t\t\t\t<span class='ui-hint-content'>\n\t\t\t\t\t\t\t${Text.encode(this.loc('SIGN_V2_B2E_REGIONAL_SETTINGS_DOCUMENT_DATE_NO_SETTINGS'))}\n\t\t\t\t\t\t</span>\n\t\t\t\t\t`,\n\t\t\t\t\t...commonHintSettings,\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tthis.hintDisabled?.show();\n\t\t},\n\t\tcreated(): void\n\t\t{\n\t\t\tthis.hintDisabled = null;\n\t\t},\n\t},\n\n\ttemplate: `\n\t\t<div class=\"sign-b2e-regional-settings__item --row\">\n\t\t\t<p class=\"sign-b2e-regional-settings__item-text\">\n\t\t\t\t<Switcher style=\"height: 13px\"\n\t\t\t\t\t:isChecked=\"isChecked\"\n\t\t\t\t\t:options=\"{ size: switcherSize }\"\n\t\t\t\t\t@check=\"toggleHcmLink(true)\"\n\t\t\t\t\t@uncheck=\"toggleHcmLink(false)\"\n\t\t\t\t\t @click=\"showHideTooltipIfDisabled\"\n\t\t\t\t/>\n\t\t\t\t<span style=\"margin-left: 8px\">\n\t\t\t\t\t{{ loc('SIGN_V2_B2E_REGIONAL_SETTINGS_DOCUMENT_DATE_HCMLINK_SWITCHER_TEXT') }}\n\t\t\t\t</span>\n\t\t\t</p>\n\t\t\t<div class=\"sign-b2e-regional-settings_date_container\">\n\t\t\t\t<SignSelector v-if=\"isChecked\"\n\t\t\t\t\t:items=\"dropdownItems\"\n\t\t\t\t\t:selectedId=\"settings.hcmLinkSettingId\"\n\t\t\t\t\t@onSelect=\"selectHcmLinkSetting\"\n\t\t\t\t\tv-slot=\"{ title }\"\n\t\t\t\t>\n\t\t\t\t\t<RoundedSmallSelectedItemView\n\t\t\t\t\t\t:title=\"title\"\n\t\t\t\t\t/>\n\t\t\t\t</SignSelector>\n\t\t\t\t<div v-else-if=\"!templateMode\">\n\t\t\t\t\t<DateSelector\n\t\t\t\t\t\t:value=\"settings.value\"\n\t\t\t\t\t\t@onSelect=\"selectDate\"\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<Hint v-if=\"isChecked\" class=\"sign-b2e-regional-settings__hint sign-b2e-regional-settings_date_hint\" :text=\"loc('SIGN_V2_B2E_REGIONAL_SETTINGS_DOCUMENT_DATE_HCMLINK_SWITCHER_HINT')\"/>\n\t\t</div>\n\t`,\n};\n","import { Switcher as UiSwitcher } from 'ui.vue3.components.switcher';\nimport { SwitcherSize } from 'ui.switcher';\nimport { Hint } from 'ui.vue3.components.hint';\nimport './style.css';\n\n// @vue/component\nexport const Switcher = {\n\t// eslint-disable-next-line vue/multi-word-component-names\n\tname: 'Switcher',\n\tcomponents: {\n\t\tUiSwitcher,\n\t\tHint,\n\t},\n\tprops: {\n\t\tmodelValue: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t\ttitle: {\n\t\t\ttype: String,\n\t\t\trequired: false,\n\t\t\tdefault: '',\n\t\t},\n\t\thint: {\n\t\t\ttype: String,\n\t\t\trequired: false,\n\t\t\tdefault: '',\n\t\t},\n\t\tisEnabled: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: true,\n\t\t},\n\t},\n\temits: ['update:modelValue'],\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tisChecked: false,\n\t\t\tswitcherSize: SwitcherSize.extraSmall,\n\t\t};\n\t},\n\twatch: {\n\t\tmodelValue(newValue: boolean): void\n\t\t{\n\t\t\tthis.isChecked = newValue;\n\t\t},\n\t},\n\tmounted()\n\t{\n\t\tthis.isChecked = this.isEnabled && this.modelValue;\n\t},\n\tmethods: {\n\t\tsetValue(value: boolean): void\n\t\t{\n\t\t\tif (this.isEnabled === false)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.isChecked = value;\n\t\t\tthis.$emit('update:modelValue', value);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div>\n\t\t\t<UiSwitcher class=\"sign-b2e_switcher\"\n\t\t\t\t\t  :isChecked=\"isChecked\"\n\t\t\t\t\t  :options=\"{ size: switcherSize }\"\n\t\t\t\t\t  @check=\"setValue(true)\" \n\t\t\t\t\t  @uncheck=\"setValue(false)\"\n\t\t\t/>\n\t\t\t<span @click=\"setValue(!isChecked)\" class=\"sign-b2e-settings__item_title sign-b2e_switcher__title\">{{ title }}</span>\n\t\t\t<Hint v-if=\"hint\" class=\"sign-b2e_switcher__hint\" :text=\"hint\"/>\n\t\t</div>\n\t`,\n};\n","import { Dom } from 'main.core';\nimport { Switcher } from '../../../vue-util/src/components/switcher/switcher';\nimport { LocMixin, Notice } from 'sign.v2.b2e.vue-util';\nimport { HcmLinkCompanySelector } from 'sign.v2.b2e.hcm-link-company-selector';\nimport { Hint } from 'ui.vue3.components.hint';\n\n// @vue/component\nexport const CompanySelector = {\n\tname: 'CompanySelector',\n\tcomponents: {\n\t\tSwitcher,\n\t\tNotice,\n\t\tHint,\n\t},\n\tmixins: [LocMixin],\n\tprops: {\n\t\tcompanyId: {\n\t\t\ttype: Number,\n\t\t\trequired: true,\n\t\t},\n\t\tisChecked: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t\tisEnabled: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t},\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tisHcmLinkCompanySelectorVisible: false,\n\t\t\tisCompanySelectorActive: false,\n\t\t};\n\t},\n\twatch: {\n\t\tcompanyId(\n\t\t\tnewValue: number | null,\n\t\t\toldValue: number | null,\n\t\t): void\n\t\t{\n\t\t\tif (!this.isHcmLinkCompanySelectorVisible)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (newValue === oldValue)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.hcmLinkCompanySelector.setCompanyId(newValue);\n\t\t},\n\t\tisChecked(newValue: boolean): void\n\t\t{\n\t\t\tthis.isHcmLinkCompanySelectorVisible = newValue;\n\t\t},\n\t\tisHcmLinkCompanySelectorVisible(newValue: boolean, oldValue: boolean): void\n\t\t{\n\t\t\tif (newValue === oldValue)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.onHcmLinkCompanySelectorVisibleChange(newValue);\n\t\t},\n\t\tisEnabled(newValue: boolean): void\n\t\t{\n\t\t\tif (newValue)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.isHcmLinkCompanySelectorVisible = newValue;\n\t\t},\n\t},\n\tcreated(): void\n\t{\n\t\tthis.initCompanySelector();\n\t},\n\tmounted(): void\n\t{\n\t\tif (this.$refs.hcmLinkCompanySelector)\n\t\t{\n\t\t\tDom.append(this.hcmLinkCompanySelector.render(), this.$refs.hcmLinkCompanySelector);\n\t\t}\n\n\t\tthis.isHcmLinkCompanySelectorVisible = this.isEnabled && this.isChecked;\n\t},\n\tmethods: {\n\t\tonHcmLinkCompanySelectorVisibleChange(isVisible: boolean): void\n\t\t{\n\t\t\tif (this.isEnabled === false)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (isVisible && this.companyId > 0)\n\t\t\t{\n\t\t\t\tthis.hcmLinkCompanySelector.setCompanyId(this.companyId);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.$emit(\n\t\t\t\t\t'on-change',\n\t\t\t\t\tnull,\n\t\t\t\t\t[],\n\t\t\t\t\t[],\n\t\t\t\t\t[],\n\t\t\t\t);\n\t\t\t}\n\t\t},\n\t\tinitCompanySelector(): void\n\t\t{\n\t\t\tthis.hcmLinkCompanySelector = new HcmLinkCompanySelector();\n\t\t\tthis.hcmLinkCompanySelector.setAvailability(true);\n\t\t\tthis.hcmLinkCompanySelector.subscribe(\n\t\t\t\t'selected',\n\t\t\t\t(event): void => {\n\t\t\t\t\tconst { id, availableSettings } = event.data;\n\t\t\t\t\tthis.$emit(\n\t\t\t\t\t\t'on-change',\n\t\t\t\t\t\tid ?? 0,\n\t\t\t\t\t\tavailableSettings?.documentType ?? [],\n\t\t\t\t\t\tavailableSettings?.externalId ?? [],\n\t\t\t\t\t\tavailableSettings?.date ?? [],\n\t\t\t\t\t);\n\t\t\t\t},\n\t\t\t);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div>\n\t\t\t<p class=\"sign-b2e-settings__item_title\">\n\t\t\t\t<Switcher\n\t\t\t\t\tv-model=\"isHcmLinkCompanySelectorVisible\"\n\t\t\t\t\t:title=\"loc('SIGN_V2_B2E_REGIONAL_SETTINGS_HCMLINK_INTEGRATION')\"\n\t\t\t\t\t:is-enabled=\"isEnabled\"\n\t\t\t\t/>\n\t\t\t</p>\n\t\t\t<div v-show=\"isHcmLinkCompanySelectorVisible\" ref=\"hcmLinkCompanySelector\"></div>\n\t\t\t<Notice class=\"sign-b2e-regional-settings-company_selector_notice\">\n\t\t\t\t<template v-if=\"isHcmLinkCompanySelectorVisible\">\n\t\t\t\t\t{{ loc('SIGN_V2_B2E_REGIONAL_SETTINGS_HCMLINK_INTEGRATION_ENABLED_NOTICE') }}\n\t\t\t\t</template>\n\t\t\t\t<template v-else>\n\t\t\t\t\t{{ loc('SIGN_V2_B2E_REGIONAL_SETTINGS_HCMLINK_INTEGRATION_DISABLED_NOTICE') }}\n\t\t\t\t</template>\n\t\t\t</Notice>\n\t\t</div>\n\t`,\n};\n","import { Router } from 'crm.router';\nimport './style.css';\n\n// @vue/component\nexport const DocumentPreview = {\n\tname: 'DocumentPreview',\n\tprops: {\n\t\tpreviewSrc: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t\ttitle: {\n\t\t\ttype: String,\n\t\t\trequired: false,\n\t\t\tdefault: '',\n\t\t},\n\t\tdocumentId: {\n\t\t\ttype: Number,\n\t\t\trequired: true,\n\t\t},\n\t\tpreviewImageClass: {\n\t\t\ttype: String,\n\t\t\trequired: false,\n\t\t\tdefault: '',\n\t\t},\n\t\tisIconVisible: {\n\t\t\ttype: Boolean,\n\t\t\trequired: false,\n\t\t\tdefault: false,\n\t\t},\n\t},\n\tmethods: {\n\t\tpreviewDocument(): Promise\n\t\t{\n\t\t\tif (this.documentId < 1)\n\t\t\t{\n\t\t\t\treturn Promise.resolve();\n\t\t\t}\n\n\t\t\treturn Router.openSlider(\n\t\t\t\t`/sign/b2e/preview/0/?documentId=${this.documentId}&noRedirect=Y`,\n\t\t\t\t{ width: 800, cacheable: false },\n\t\t\t);\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"sign-b2e_document_preview_container\">\n\t\t\t<div v-if=\"isIconVisible\" @click=\"previewDocument()\" class=\"sign-b2e_document_preview_icon\"></div>\n\t\t\t<img v-if=\"previewSrc\" @click=\"previewDocument()\" :class=\"previewImageClass\" :src=\"previewSrc\" :alt=\"title\">\n\t\t</div>\t\n\t`,\n};\n","import { DocumentTypeSelector } from './document-type-selector';\nimport { HcmLinkDocumentTypeSelector } from './hcmlink-document-type-selector';\nimport { RegistrationNumberSettings } from './registration-number-settings';\nimport { DateSettings } from './date-settings';\nimport { DocumentPreview } from '../../../vue-util/src/components/document-preview/document-preview';\nimport { LocMixin } from 'sign.v2.b2e.vue-util';\n\nimport type {\n\tDateSettings as DateSettingsType, DocumentSettings,\n\tExternalIdSettings,\n} from '../types';\n\n// @vue/component\nexport const DocumentRegionalSettings = {\n\tname: 'DocumentRegionalSettings',\n\tcomponents: {\n\t\tDocumentTypeSelector,\n\t\tHcmLinkDocumentTypeSelector,\n\t\tRegistrationNumberSettings,\n\t\tDateSettings,\n\t\tDocumentPreview,\n\t},\n\tmixins: [LocMixin],\n\tprops: {\n\t\ttemplateMode: {\n\t\t\ttype: Boolean,\n\t\t\trequired: false,\n\t\t\tdefault: false,\n\t\t},\n\t\tdocumentTypeList: {\n\t\t\ttype: Array,\n\t\t\trequired: true,\n\t\t},\n\t\texternalIdTypeList: {\n\t\t\ttype: Array,\n\t\t\trequired: true,\n\t\t},\n\t\tdateTypeList: {\n\t\t\ttype: Array,\n\t\t\trequired: true,\n\t\t},\n\t\thcmLinkDocumentTypeList: {\n\t\t\ttype: Array,\n\t\t\trequired: true,\n\t\t},\n\t\tpreviewSrc: {\n\t\t\ttype: [String, null],\n\t\t\trequired: false,\n\t\t\tdefault: null,\n\t\t},\n\t\tdocumentId: {\n\t\t\ttype: Number,\n\t\t\trequired: false,\n\t\t\tdefault: 0,\n\t\t},\n\t\tuid: {\n\t\t\ttype: [String, null],\n\t\t\trequired: false,\n\t\t\tdefault: null,\n\t\t},\n\t\ttitle: {\n\t\t\ttype: [String, null],\n\t\t\trequired: false,\n\t\t\tdefault: null,\n\t\t},\n\t\tisPreviewVisible: {\n\t\t\ttype: Boolean,\n\t\t\trequired: false,\n\t\t\tdefault: true,\n\t\t},\n\t\tsettings: {\n\t\t\t/** @type DocumentSettings */\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t\tisIntegrationEnabled: {\n\t\t\ttype: Boolean,\n\t\t\trequired: false,\n\t\t\tdefault: false,\n\t\t},\n\t\tisHcmLinkDocumentTypeVisible: {\n\t\t\ttype: Boolean,\n\t\t\trequired: false,\n\t\t\tdefault: true,\n\t\t},\n\t\tisDocumentTypeVisible: {\n\t\t\ttype: Boolean,\n\t\t\trequired: false,\n\t\t\tdefault: true,\n\t\t},\n\t\tisRegistrationNumberVisible: {\n\t\t\ttype: Boolean,\n\t\t\trequired: false,\n\t\t\tdefault: true,\n\t\t},\n\t\tisDateVisible: {\n\t\t\ttype: Boolean,\n\t\t\trequired: false,\n\t\t\tdefault: true,\n\t\t},\n\t\tisIntegrationDisabledByProvider: {\n\t\t\ttype: Boolean,\n\t\t\trequired: false,\n\t\t\tdefault: false,\n\t\t},\n\t},\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tcurrentValue: {},\n\t\t};\n\t},\n\twatch: {\n\t\tisIntegrationEnabled(newVal: boolean): void\n\t\t{\n\t\t\tif (newVal === false)\n\t\t\t{\n\t\t\t\tthis.currentValue.hcmLinkDocumentTypeSettingId = 0;\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.setDefaultValues(this.settings);\n\t\t},\n\t},\n\tcreated(): void\n\t{\n\t\tthis.setDefaultValues(this.settings);\n\t},\n\tmethods: {\n\t\tmodifyDocumentType(code: string): void\n\t\t{\n\t\t\tthis.currentValue.documentType = code;\n\t\t\tthis.$emit('on-change-document-type', this.currentValue, this.uid);\n\t\t\tthis.$emit('on-change', this.currentValue, this.uid);\n\t\t},\n\t\tmodifyDateSettings(settings: DateSettingsType): void\n\t\t{\n\t\t\tthis.currentValue.date = settings;\n\t\t\tthis.$emit('on-change-date-created', this.currentValue, this.uid);\n\t\t\tthis.$emit('on-change', this.currentValue, this.uid);\n\t\t},\n\t\tmodifyRegistrationNumberSettings(settings: ExternalIdSettings): void\n\t\t{\n\t\t\tthis.currentValue.externalId = settings;\n\t\t\tthis.$emit('on-change-registration-number', this.currentValue, this.uid);\n\t\t\tthis.$emit('on-change', this.currentValue, this.uid);\n\t\t},\n\t\tmodifyHcmLinkDocumentType(id: number | null): void\n\t\t{\n\t\t\tthis.currentValue.hcmLinkDocumentTypeSettingId = id;\n\t\t\tthis.$emit('on-change-hcm-link-document-type', this.currentValue, this.uid);\n\t\t\tthis.$emit('on-change', this.currentValue, this.uid);\n\t\t},\n\t\tvalidate(): boolean\n\t\t{\n\t\t\tif (!this.isRegistrationNumberVisible)\n\t\t\t{\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\treturn this.$refs.registrationNumberSettings.validate();\n\t\t},\n\t\tsetDefaultValues(settings: DocumentSettings): void\n\t\t{\n\t\t\tthis.currentValue = this.getDefaultValues(settings);\n\t\t\tthis.$emit('on-change', this.currentValue, this.uid);\n\t\t},\n\t\tgetDefaultValues(settings: DocumentSettings): DocumentSettings\n\t\t{\n\t\t\treturn {\n\t\t\t\tdate: this.getDateDefaultValue(settings),\n\t\t\t\texternalId: this.getExternalIdDefaultValue(settings),\n\t\t\t\thcmLinkDocumentTypeSettingId: this.getHcmLinkDocumentTypeSettingIdDefaultValue(settings),\n\t\t\t\tdocumentType: this.getDocumentTypeDefaultValue(settings),\n\t\t\t};\n\t\t},\n\t\tgetHcmLinkDocumentTypeSettingIdDefaultValue(settings: DocumentSettings): number | null\n\t\t{\n\t\t\treturn settings.hcmLinkDocumentTypeSettingId ?? null;\n\t\t},\n\t\tgetDocumentTypeDefaultValue(settings: DocumentSettings): string | null\n\t\t{\n\t\t\treturn settings.documentType ?? this.documentTypeList[0]?.code;\n\t\t},\n\t\tgetExternalIdDefaultValue(settings: DocumentSettings): ExternalIdSettings\n\t\t{\n\t\t\treturn {\n\t\t\t\tsourceType: settings.externalId.sourceType,\n\t\t\t\tvalue: settings.externalId.value ?? this.loc('SIGN_V2_B2E_REGIONAL_SETTINGS_DOCUMENT_EXTERNAL_ID_WITHOUT_NUMBER'),\n\t\t\t\thcmLinkSettingId: settings.externalId.hcmLinkSettingId ?? this.externalIdTypeList[0]?.id,\n\t\t\t};\n\t\t},\n\t\tgetDateDefaultValue(settings: DocumentSettings): DateSettings\n\t\t{\n\t\t\treturn {\n\t\t\t\tsourceType: settings.date.sourceType,\n\t\t\t\tvalue: settings.date.value ?? new Date(),\n\t\t\t\thcmLinkSettingId: settings.date.hcmLinkSettingId ?? this.dateTypeList[0]?.id,\n\t\t\t};\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div :class=\"{'sign-b2e-regional-settings__step_settings_wrapper': uid}\" v-if=\"currentValue\" >\n\t\t\t<div>\n\t\t\t\t<DocumentPreview\n\t\t\t\t\tv-if=\"isPreviewVisible\"\n\t\t\t\t\t:title=\"title ?? ''\"\n\t\t\t\t\t:preview-src=\"previewSrc ?? ''\"\n\t\t\t\t\t:document-id=\"documentId\"\n\t\t\t\t\t:is-icon-visible=\"true\"\n\t\t\t\t\tclass=\"sign-b2e_document_preview_container\"\n\t\t\t\t\tpreview-image-class=\"sign-b2e_document_preview_image\">\n\t\t\t\t</DocumentPreview>\n\t\t\t</div>\n\t\t\t<div class=\"sign-b2e-regional-settings-gap\">\n\t\t\t\t<span v-if=\"title\" class=\"sign-b2e-regional-settings-company_selector_title\">\n\t\t\t\t\t{{ title }}\n\t\t\t\t</span>\n\t\t\t\t<HcmLinkDocumentTypeSelector v-if=\"isHcmLinkDocumentTypeVisible && hcmLinkDocumentTypeList.length > 0 && isIntegrationEnabled\"\n\t\t\t\t\t:typeList=\"hcmLinkDocumentTypeList\"\n\t\t\t\t\t:selectedId=\"currentValue.hcmLinkDocumentTypeSettingId\"\n\t\t\t\t\t:is-integration-enabled=\"isIntegrationEnabled\"\n\t\t\t\t\t@onSelected=\"modifyHcmLinkDocumentType\"\n\t\t\t\t/>\n\t\t\t\t<DocumentTypeSelector v-if=\"isDocumentTypeVisible && documentTypeList.length > 0\"\n\t\t\t\t\t:typeList=\"documentTypeList\"\n\t\t\t\t\t:selectedId=\"currentValue.documentType\"\n\t\t\t\t\t@onSelected=\"modifyDocumentType\"\n\t\t\t\t/>\n\t\t\t\t<RegistrationNumberSettings\n\t\t\t\t\tv-if=\"isRegistrationNumberVisible\"\n\t\t\t\t\tref=\"registrationNumberSettings\"\n\t\t\t\t\t:hcmLinkTypeList=\"externalIdTypeList\"\n\t\t\t\t\t:templateMode=\"templateMode\"\n\t\t\t\t\t:settings=\"currentValue.externalId\"\n\t\t\t\t\t:is-integration-enabled=\"isIntegrationEnabled\"\n\t\t\t\t\t:is-integration-disabled-by-provider=\"isIntegrationDisabledByProvider\"\n\t\t\t\t\t@onChange=\"modifyRegistrationNumberSettings\"\n\t\t\t\t/>\n\t\t\t\t<DateSettings\n\t\t\t\t\tv-if=\"isDateVisible\"\n\t\t\t\t\t:hcmLinkTypeList=\"dateTypeList\"\n\t\t    \t\t:templateMode=\"templateMode\"\n\t\t\t\t\t:settings=\"currentValue.date\"\n\t\t\t\t\t:is-integration-enabled=\"isIntegrationEnabled\"\n\t\t\t\t\t:is-integration-disabled-by-provider=\"isIntegrationDisabledByProvider\"\n\t\t\t\t\t@onChange=\"modifyDateSettings\"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import { DocumentPreview } from '../document-preview/document-preview';\nimport { LocMixin } from 'sign.v2.b2e.vue-util';\nimport './style.css';\n\n// @vue/component\nexport const DocumentPreviewList = {\n\tname: 'DocumentPreviewList',\n\tcomponents: {\n\t\tDocumentPreview,\n\t},\n\tmixins: [LocMixin],\n\tprops: {\n\t\tdocumentList: {\n\t\t\ttype: Array,\n\t\t\trequired: true,\n\t\t},\n\t\tmaxPreviewCount: {\n\t\t\ttype: Number,\n\t\t\tdefault: 7,\n\t\t},\n\t},\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tisShowMoreButtonVisible: true,\n\t\t\tpreviewCount: 0,\n\t\t};\n\t},\n\tcomputed: {\n\t\tshowMoreCount(): number\n\t\t{\n\t\t\treturn this.documentCount - this.maxPreviewCount;\n\t\t},\n\t\tisShowMoreVisible(): boolean\n\t\t{\n\t\t\treturn this.showMoreCount > 0;\n\t\t},\n\t\tdocumentCount(): number\n\t\t{\n\t\t\treturn this.documentList.length;\n\t\t},\n\t\tdocumentPreviewList(): Array\n\t\t{\n\t\t\tconst result = [];\n\t\t\tfor (const document of this.documentList)\n\t\t\t{\n\t\t\t\tresult.push(document);\n\n\t\t\t\tif (result.length >= this.previewCount)\n\t\t\t\t{\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn result;\n\t\t},\n\t},\n\tcreated(): void {\n\t\tthis.previewCount = this.maxPreviewCount;\n\t},\n\tmethods: {\n\t\tonShowMoreClick(): void\n\t\t{\n\t\t\tthis.previewCount = this.documentCount;\n\t\t\tthis.isShowMoreButtonVisible = false;\n\t\t},\n\t\tonShowLessClick(): void\n\t\t{\n\t\t\tthis.previewCount = this.maxPreviewCount;\n\t\t\tthis.isShowMoreButtonVisible = true;\n\t\t},\n\t},\n\ttemplate: `\n\t\t<div class=\"sign-b2e-settings__item sign-b2e-regional-settings_apply_for_all_list\">\n\t\t\t<template v-for=\"document in documentPreviewList\">\n\t\t\t\t<div class=\"sign-b2e-regional-settings_apply_for_all_settings_preview_block\">\n\t\t\t\t\t<DocumentPreview\n\t\t\t\t\t\t:document-id=\"document?.documentId\"\n\t\t\t\t\t\t:preview-src=\"document?.previewUrl\"\n\t\t\t\t\t\t:is-icon-visible=\"true\"\n\t\t\t\t\t\tpreview-image-class=\"sign-b2e-regional-settings_apply_for_all_settings_preview\">\n\t\t\t\t\t</DocumentPreview>\n\t\t\t\t\t<div class=\"sign-b2e-regional-settings_apply_for_all_settings_preview_title\">\n\t\t\t\t\t\t{{ document.title }}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</template>\n\t\t\t<div v-if=\"isShowMoreVisible\" class=\"sign-b2e-regional-settings_apply_for_all_settings_preview_show_more_less\">\n\t\t\t\t<span v-if=\"isShowMoreButtonVisible\" @click=\"onShowMoreClick\" class=\"sign-b2e-regional-settings_apply_for_all_settings_more_less_button\">\n\t\t\t\t\t{{ loc('SIGN_V2_B2E_DOCUMENT_PREVIEW_LIST_MORE_TITLE', { '#COUNT#': String(showMoreCount) }) }}\n\t\t\t\t</span>\n\t\t\t\t<span v-else @click=\"onShowLessClick\" class=\"sign-b2e-regional-settings_apply_for_all_settings_more_less_button\">\n\t\t\t\t\t{{ loc('SIGN_V2_B2E_DOCUMENT_PREVIEW_LIST_LESS_TITLE') }}\n\t\t\t\t</span>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import { Api } from 'sign.v2.api';\nimport type { DocumentDetails } from 'sign.v2.document-setup';\nimport { mapState } from 'ui.vue3.pinia';\n\nimport { LocMixin, Notice } from 'sign.v2.b2e.vue-util';\nimport { DefaultDocumentSettings, useRegionalSettingsStore } from './store';\n\nimport { DocumentTypeSelector } from './components/document-type-selector';\nimport { HcmLinkDocumentTypeSelector } from './components/hcmlink-document-type-selector';\nimport { RegistrationNumberSettings } from './components/registration-number-settings';\nimport { DateSettings } from './components/date-settings';\nimport { CompanySelector } from './components/company-selector';\nimport { DocumentPreview } from '../../vue-util/src/components/document-preview/document-preview';\nimport { DocumentRegionalSettings } from './components/document-regional-settings';\nimport { Switcher } from '../../vue-util/src/components/switcher/switcher';\nimport { DocumentPreviewList } from '../../vue-util/src/components/document-preview-list/document-preview-list';\nimport type { DocumentSettings } from './types';\n\nconst maxPreviewCount = 7;\n\n// @vue/component\nexport const RegionalSettingsApp = {\n\tname: 'RegionalSettingsApp',\n\tcomponents: {\n\t\tDocumentTypeSelector,\n\t\tHcmLinkDocumentTypeSelector,\n\t\tRegistrationNumberSettings,\n\t\tDateSettings,\n\t\tDocumentRegionalSettings,\n\t\tCompanySelector,\n\t\tDocumentPreview,\n\t\tDocumentPreviewList,\n\t\tNotice,\n\t\tSwitcher,\n\t},\n\tmixins: [LocMixin],\n\tprops: {\n\t\ttemplateMode: {\n\t\t\ttype: Boolean,\n\t\t\trequired: false,\n\t\t\tdefault: false,\n\t\t},\n\t},\n\tdata(): Object\n\t{\n\t\treturn {\n\t\t\tselectedCompanyId: 0,\n\t\t\tisApplySettingsForAll: false,\n\t\t\tpreviewCount: maxPreviewCount,\n\t\t\tapi: null,\n\t\t\tpreviewUrlList: {},\n\t\t};\n\t},\n\tcomputed: {\n\t\t...mapState(useRegionalSettingsStore, ['companyId']),\n\t\t...mapState(useRegionalSettingsStore, ['currentDocumentSettings']),\n\t\t...mapState(useRegionalSettingsStore, ['hcmLinkCompanyId']),\n\t\t...mapState(useRegionalSettingsStore, ['hcmLinkAvailableSettings']),\n\t\t...mapState(useRegionalSettingsStore, ['documentTypeList']),\n\t\t...mapState(useRegionalSettingsStore, ['documentSettingsMap']),\n\t\t...mapState(useRegionalSettingsStore, ['documentsGroup']),\n\t\t...mapState(useRegionalSettingsStore, ['isIntegrationEnabled']),\n\t\t...mapState(useRegionalSettingsStore, ['isIntegrationVisible']),\n\t\tshowMoreCount(): number\n\t\t{\n\t\t\treturn this.documentCount - maxPreviewCount;\n\t\t},\n\t\tisShowMoreVisible(): boolean\n\t\t{\n\t\t\treturn this.showMoreCount > 0;\n\t\t},\n\t\tdocumentCount(): number\n\t\t{\n\t\t\treturn this.documentsGroup.size;\n\t\t},\n\t\tisHcmLinkCompanyIdSet(): boolean\n\t\t{\n\t\t\treturn Number(this.hcmLinkCompanyId) > 0;\n\t\t},\n\t\tdocumentPreviewList(): Array\n\t\t{\n\t\t\tconst result = [];\n\t\t\tfor (const [uid] of this.documentsGroup)\n\t\t\t{\n\t\t\t\tresult.push({\n\t\t\t\t\tuid,\n\t\t\t\t\tdocumentId: this.getDocumentId(uid),\n\t\t\t\t\tpreviewUrl: this.getDocumentPreviewUrl(uid),\n\t\t\t\t\ttitle: this.getDocumentTitle(uid),\n\t\t\t\t});\n\t\t\t}\n\n\t\t\treturn result;\n\t\t},\n\t\tdocumentList(): Array\n\t\t{\n\t\t\tconst result = [];\n\t\t\tfor (const [uid, documentDetails] of this.documentsGroup)\n\t\t\t{\n\t\t\t\tresult.push({\n\t\t\t\t\tuid,\n\t\t\t\t\tid: documentDetails.id,\n\t\t\t\t\tpreviewUrl: this.getDocumentPreviewUrl(uid),\n\t\t\t\t\ttitle: documentDetails.title,\n\t\t\t\t});\n\t\t\t}\n\n\t\t\treturn result;\n\t\t},\n\t\tisIntegrationDisabledByProvider(): boolean\n\t\t{\n\t\t\treturn this.isHcmLinkCompanyIdSet && !this.isIntegrationEnabled;\n\t\t},\n\t},\n\twatch: {\n\t\tcompanyId(\n\t\t\tnewVal: number | null,\n\t\t\toldVal: number | null,\n\t\t): void\n\t\t{\n\t\t\tif (newVal !== oldVal)\n\t\t\t{\n\t\t\t\tthis.selectedCompanyId = newVal;\n\t\t\t}\n\t\t},\n\t\tisIntegrationEnabled(newVal: boolean): void\n\t\t{\n\t\t\tif (newVal)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tuseRegionalSettingsStore().modifyAvailableHcmLinkSettings({\n\t\t\t\tdocumentTypeList: [],\n\t\t\t\texternalIdTypeList: [],\n\t\t\t\tdateTypeList: [],\n\t\t\t});\n\t\t},\n\t\tdocumentCount(newVal: number): void\n\t\t{\n\t\t\tif (newVal < 2)\n\t\t\t{\n\t\t\t\tthis.isApplySettingsForAll = false;\n\t\t\t}\n\t\t},\n\t},\n\tcreated(): void\n\t{\n\t\tthis.api = new Api();\n\t\tthis.selectedCompanyId = this.companyId;\n\t\tthis.previewUrlList = new Map();\n\t},\n\tmethods: {\n\t\tgetDocumentSettings(uid: string | null = null): DocumentSettings | null\n\t\t{\n\t\t\tif (!uid || !this.documentSettingsMap.has(uid))\n\t\t\t{\n\t\t\t\treturn DefaultDocumentSettings;\n\t\t\t}\n\n\t\t\treturn this.documentSettingsMap.get(uid);\n\t\t},\n\t\tgetDocumentDetails(uid: string | null = null): DocumentDetails | null\n\t\t{\n\t\t\tif (!uid || !this.documentsGroup.has(uid))\n\t\t\t{\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\treturn this.documentsGroup.get(uid);\n\t\t},\n\t\tgetDocumentId(uid: string): number\n\t\t{\n\t\t\tconst documentDetails = this.getDocumentDetails(uid);\n\t\t\tif (documentDetails === null)\n\t\t\t{\n\t\t\t\treturn 0;\n\t\t\t}\n\n\t\t\treturn documentDetails.id;\n\t\t},\n\t\tasync loadDocumentPreviewUrl(uid: string): void\n\t\t{\n\t\t\tif (this.previewUrlList.has(uid))\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.previewUrlList.set(uid, '');\n\t\t\tconst data = await this.api.getDocumentPreviewUrl(uid);\n\t\t\tthis.previewUrlList.set(uid, data?.url);\n\t\t},\n\t\tgetDocumentPreviewUrl(uid: string): string | null\n\t\t{\n\t\t\tconst documentDetails = this.getDocumentDetails(uid);\n\t\t\tif (documentDetails === null)\n\t\t\t{\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\tif (documentDetails.previewUrl)\n\t\t\t{\n\t\t\t\treturn documentDetails.previewUrl;\n\t\t\t}\n\n\t\t\tthis.loadDocumentPreviewUrl(uid);\n\n\t\t\tif (!this.previewUrlList.has(uid))\n\t\t\t{\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\treturn this.previewUrlList.get(uid);\n\t\t},\n\t\tgetDocumentTitle(uid: string): string\n\t\t{\n\t\t\tconst documentDetails = this.getDocumentDetails(uid);\n\t\t\tif (documentDetails === null)\n\t\t\t{\n\t\t\t\treturn '';\n\t\t\t}\n\n\t\t\treturn documentDetails.title;\n\t\t},\n\t\tonCompanySelectorChange(\n\t\t\tid: Number | null,\n\t\t\tdocumentTypeList: Array,\n\t\t\texternalIdTypeList: Array,\n\t\t\tdateTypeList: Array,\n\t\t): void\n\t\t{\n\t\t\tuseRegionalSettingsStore().modifyHcmLinkCompanyId(id);\n\t\t\tuseRegionalSettingsStore().modifyAvailableHcmLinkSettings({\n\t\t\t\tdocumentTypeList,\n\t\t\t\texternalIdTypeList,\n\t\t\t\tdateTypeList,\n\t\t\t});\n\t\t},\n\t\tsetAllDocumentSettings(settings: DocumentSettings): void\n\t\t{\n\t\t\tfor (const uid of this.documentSettingsMap.keys())\n\t\t\t{\n\t\t\t\tuseRegionalSettingsStore().setDocumentSettings(uid, settings);\n\t\t\t}\n\t\t},\n\t\tsetSettings(settings: DocumentSettings, uid: string | null): void\n\t\t{\n\t\t\tif (this.isApplySettingsForAll)\n\t\t\t{\n\t\t\t\tthis.setAllDocumentSettings(settings);\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tuseRegionalSettingsStore().setDocumentSettings(uid, settings);\n\t\t},\n\t\tvalidate(): boolean\n\t\t{\n\t\t\tlet result = true;\n\n\t\t\tif (this.isApplySettingsForAll)\n\t\t\t{\n\t\t\t\treturn this.$refs.applySettingsForAll.validate();\n\t\t\t}\n\n\t\t\tfor (const uid of this.documentSettingsMap.keys())\n\t\t\t{\n\t\t\t\tif (!this.$refs[`document_settings_${uid}`][0]?.validate())\n\t\t\t\t{\n\t\t\t\t\tif (result === true && this.documentCount > 1)\n\t\t\t\t\t{\n\t\t\t\t\t\tdocument.getElementById(`document_settings_${uid}`).scrollIntoView({ behavior: 'smooth' });\n\t\t\t\t\t}\n\t\t\t\t\tresult = false;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn result;\n\t\t},\n\t},\n\ttemplate: `\n\t\t<h1 class=\"sign-b2e-settings__header\">\n\t\t\t{{ loc('SIGN_SETTINGS_B2E_REGIONAL_SETTINGS') }}\n\t\t</h1>\n\t\t<div v-if=\"isIntegrationVisible\" class=\"sign-b2e-settings__item\">\n\t\t\t<div class=\"sign-b2e-settings__counter\">\n\t\t\t\t<span class=\"sign-b2e-settings__counter_num\" data-num=\"1\"></span>\n\t\t\t</div>\n\t\t\t<CompanySelector \n\t\t\t\t:is-enabled=\"true\" \n\t\t\t\t:is-checked=\"isHcmLinkCompanyIdSet\" \n\t\t\t\t@onChange=\"onCompanySelectorChange\" \n\t\t\t\t:company-id=\"Number(selectedCompanyId)\"\n\t\t\t/>\n\t\t</div>\n\t\t<div v-if=\"documentCount > 1 && isIntegrationVisible\" class=\"sign-b2e-settings__item\">\n\t\t\t<div class=\"sign-b2e-settings__counter\">\n\t\t\t\t<span class=\"sign-b2e-settings__counter_num\" :data-num=\"2\"></span>\n\t\t\t\t<span v-if=\"isApplySettingsForAll\" class=\"sign-b2e-settings__counter_connect\"></span>\n\t\t\t</div>\n\t\t\t<Switcher \n\t\t\t\tv-model=\"isApplySettingsForAll\"\n\t\t\t\t:title=\"loc('SIGN_V2_B2E_REGIONAL_SETTINGS_APPLY_FOR_ALL_TITLE')\"\n\t\t\t\t:hint=\"loc('SIGN_V2_B2E_REGIONAL_SETTINGS_APPLY_FOR_ALL_HINT')\"\n\t\t\t/>\n\t\t\t<div v-if=\"isApplySettingsForAll\">\n\t\t\t\t<div class=\"sign-b2e-regional-settings__item-text sign-b2e-regional-settings_apply_for_all_title\">\n\t\t\t\t\t{{ loc('SIGN_V2_B2E_REGIONAL_SETTINGS_APPLY_FOR_ALL_DOCUMENTS_TITLE') }}\n\t\t\t\t</div>\n\t\t\t\t<DocumentPreviewList \n\t\t\t\t\t:document-list=\"documentPreviewList\"\n\t\t\t\t\t:max-preview-count=\"maxPreviewCount\"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t\t<DocumentRegionalSettings\n\t\t\t\tv-if=\"isApplySettingsForAll\"\n\t\t\t\tref=\"applySettingsForAll\"\n\t\t\t\t:is-preview-visible=\"false\"\n\t\t\t\t:template-mode=\"templateMode\"\n\t\t\t\t:document-type-list=\"documentTypeList\"\n\t\t\t\t:external-id-type-list=\"hcmLinkAvailableSettings.externalIdTypeList\"\n\t\t\t\t:date-type-list=\"hcmLinkAvailableSettings.dateTypeList\"\n\t\t\t\t:hcm-link-document-type-list=\"hcmLinkAvailableSettings.documentTypeList\"\n\t\t\t\t:settings=\"getDocumentSettings()\"\n\t\t\t\t@onChange=\"setSettings\"\n\t\t\t\tclass=\"sign-b2e-regional-settings_apply_for_all_settings\"\n\t\t\t\t:is-integration-enabled=\"isIntegrationEnabled && isHcmLinkCompanyIdSet\"\n\t\t\t\t:is-integration-disabled-by-provider=\"isIntegrationDisabledByProvider\"\n\t\t\t/>\n\t\t</div>\n\t\t<template v-if=\"!isApplySettingsForAll\" v-for=\"(document, index) in documentList\" :key=\"document.uid\">\n\t\t\t<div class=\"sign-b2e-settings__item\">\n\t\t\t\t<div class=\"sign-b2e-settings__counter\"  :class=\"{'sign-b2e-regional-settings__counter_connect_with_margin': index > 0 && index < (documentCount - 1), 'sign-b2e-regional-settings__counter_connect_with_left': index === (documentCount - 1)}\">\n\t\t\t\t\t<span v-if=\"index === 0\" class=\"sign-b2e-settings__counter_num\" :data-num=\"isIntegrationVisible ? (index + (documentCount > 1 ? 3 : 2)) : 1\"></span>\n\t\t\t\t\t<span v-if=\"index === (documentCount - 1)\" \n\t\t\t\t\t\t  class=\"sign-b2e-settings__counter_connect\" \n\t\t\t\t\t\t  :class=\"{'sign-b2e-regional-settings__counter_connect': index > 0}\">\n\t\t\t\t\t</span>\n\t\t\t\t</div>\n\t\t\t\t<DocumentRegionalSettings\n\t\t\t\t\t:ref=\"'document_settings_' + document.uid\"\n\t\t\t\t\t:id=\"'document_settings_' + document.uid\"\n\t\t\t\t\t:document-id=\"document.id\"\n\t\t\t\t\t:preview-src=\"document.previewUrl\"\n\t\t\t\t\t:template-mode=\"templateMode\"\n\t\t\t\t\t:document-type-list=\"documentTypeList\"\n\t\t\t\t\t:external-id-type-list=\"hcmLinkAvailableSettings.externalIdTypeList\"\n\t\t\t\t\t:date-type-list=\"hcmLinkAvailableSettings.dateTypeList\"\n\t\t\t\t\t:hcm-link-document-type-list=\"hcmLinkAvailableSettings.documentTypeList\"\n\t\t\t\t\t:uid=\"document.uid\"\n\t\t\t\t\t:title=\"document.title\"\n\t\t\t\t\t:settings=\"getDocumentSettings(document.uid)\"\n\t\t\t\t\t@onChange=\"setSettings\"\n\t\t\t\t\t:is-integration-enabled=\"isIntegrationEnabled && isHcmLinkCompanyIdSet\"\n\t\t\t\t\t:is-hcm-link-document-type-visible=\"isIntegrationVisible\"\n\t\t\t\t\t:is-registration-number-visible=\"isIntegrationVisible\"\n\t\t\t\t\t:is-date-visible=\"isIntegrationVisible\"\n\t\t\t\t\t:is-integration-disabled-by-provider=\"isIntegrationDisabledByProvider\"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t</template>\n\t`,\n};\n","import { Tag } from 'main.core';\nimport type { RegionalSettingsOptions } from './types';\n\nimport './style.css';\nimport { BitrixVue, VueCreateAppResult } from 'ui.vue3';\nimport { RegionalSettingsApp } from './app';\nimport { EventEmitter } from 'main.core.events';\nimport { createPinia } from 'ui.vue3.pinia';\nimport { useRegionalSettingsStore } from './store';\nimport type { DocumentDetails } from 'sign.v2.document-setup';\n\nexport class RegionalSettings\n{\n\t#app: VueCreateAppResult | null;\n\t#vueApp: Object | null;\n\t#options: RegionalSettingsOptions;\n\t#companyId: number | null;\n\t#container: HTMLElement;\n\n\tconstructor(regionalSettingsOptions: RegionalSettingsOptions)\n\t{\n\t\tthis.#options = regionalSettingsOptions;\n\t\tthis.#container = this.getLayout();\n\t}\n\n\tgetLayout(): HTMLElement\n\t{\n\t\tif (this.#container)\n\t\t{\n\t\t\treturn this.#container;\n\t\t}\n\n\t\tthis.#container = Tag.render`<div></div>`;\n\n\t\tthis.#createApp(this.#container);\n\n\t\tif (BX.UI.Hint)\n\t\t{\n\t\t\tBX.UI.Hint.init(this.#container);\n\t\t}\n\n\t\treturn this.#container;\n\t}\n\n\t#createApp(container: HTMLElement): void\n\t{\n\t\tconst store = createPinia();\n\t\tthis.#app = BitrixVue.createApp(RegionalSettingsApp, {\n\t\t\ttemplateMode: this.#options.templateMode,\n\t\t});\n\n\t\tthis.#app.use(store);\n\t\tuseRegionalSettingsStore().init({\n\t\t\tdocumentTypeList: this.#options.regionDocumentTypes,\n\t\t});\n\n\t\tthis.#vueApp = this.#app.mount(container);\n\n\t\tconst onClose = () => {\n\t\t\tEventEmitter.unsubscribe('SidePanel.Slider:onCloseByEsc', onClose);\n\t\t\tEventEmitter.unsubscribe('SidePanel.Slider:onClose', onClose);\n\t\t\tthis.#app?.unmount();\n\t\t};\n\t\tEventEmitter.subscribe('SidePanel.Slider:onCloseByEsc', onClose);\n\t\tEventEmitter.subscribe('SidePanel.Slider:onClose', onClose);\n\t}\n\n\tasync save(): void\n\t{\n\t\tif (!this.#vueApp.validate())\n\t\t{\n\t\t\tthrow new Error('Validation error');\n\t\t}\n\t\tawait useRegionalSettingsStore().save();\n\t}\n\n\tset companyId(id: number): void\n\t{\n\t\tthis.#companyId = id;\n\n\t\tconst store = useRegionalSettingsStore();\n\t\tstore.companyId = this.#companyId;\n\t}\n\n\tset isIntegrationEnabled(isEnabled: boolean): void\n\t{\n\t\tconst store = useRegionalSettingsStore();\n\t\tstore.isIntegrationEnabled = isEnabled;\n\t}\n\n\tset isIntegrationVisible(isVisible: boolean): void\n\t{\n\t\tconst store = useRegionalSettingsStore();\n\t\tstore.isIntegrationVisible = isVisible;\n\t}\n\n\tset documentsGroup(documentGroup: Map<string, DocumentDetails>): void\n\t{\n\t\tuseRegionalSettingsStore().updateDocumentsGroup(documentGroup);\n\t}\n\n\tgetSelectedHcmLinkCompanyId(): number | null\n\t{\n\t\tconst store = useRegionalSettingsStore();\n\n\t\treturn store.hcmLinkCompanyId;\n\t}\n\n\tsetLastSavedHcmLinkCompanyId(id: number | null): void\n\t{\n\t\t/* @todo */\n\t\t//this.#hcmLinkCompanySelector.setLastSavedId(id);\n\t}\n}\n"],"names":["DefaultDocumentSettings","date","sourceType","value","Date","hcmLinkSettingId","externalId","hcmLinkDocumentTypeSettingId","documentType","useRegionalSettingsStore","defineStore","state","currentDocumentUid","companyId","isIntegrationEnabled","isIntegrationVisible","documentTypeList","hcmLinkCompanyId","hcmLinkAvailableSettings","externalIdTypeList","dateTypeList","documentSettingsMap","Map","documentsGroup","getters","currentDocumentSettings","has","get","actions","init","options","this","updateDocumentsGroup","documentsToDelete","keys","filter","key","forEach","delete","uid","documentDetail","documentDetailPrevious","set","settings","externalDateCreateSourceType","hcmLinkDateSettingId","externalDateCreate","externalIdSourceType","hcmLinkExternalIdSettingId","regionDocumentType","includes","documentsToAdd","code","modifyHcmLinkCompanyId","id","modifyAvailableHcmLinkSettings","stored","_settings$dateTypeLis2","_settings$externalIdT2","modifyCurrentDocumentSettings","storedSettings","setDocumentSettings","[object Object]","api","Api","documentUids","Promise","all","map","changeIntegrationId","dateValue","DateTimeFormat","format","getFormat","apiPromises","changeRegionDocumentType","push","changeHcmLinkDocumentType","changeExternalDate","changeExternalId","DocumentTypeSelector","name","components","SignDropdownComponent","Hint","mixins","LocMixin","props","typeList","type","Array","required","default","selectedId","String","emits","computed","dropdownItems","description","title","caption","entityId","tabId","methods","setType","item","$emit","template","NotSelectedItem","Object","freeze","Loc","getMessage","HcmLinkDocumentTypeSelector","SignSelector","Number","length","onSelected","RegistrationNumberSettings","Switcher","Notice","hcmLinkTypeList","templateMode","Boolean","isIntegrationDisabledByProvider","data","isValid","switcherSize","SwitcherSize","extraSmall","isChecked","watch","newValue","toggleHcmLink","changeSettings","selectHcmLinkSetting","changeManualValue","validate","showHideTooltipIfDisabled","event","hintDisabled","_this$hintDisabled","close","_this$hintDisabled2","destroy","commonHintSettings","bindElement","target","darkMode","autoHide","cacheable","Popup","content","Tag","render","Text","encode","loc","_this$hintDisabled3","show","created","DateSettings","DateSelector","RoundedSmallSelectedItemView","selectDate","UiSwitcher","modelValue","hint","isEnabled","mounted","setValue","CompanySelector","isHcmLinkCompanySelectorVisible","isCompanySelectorActive","oldValue","hcmLinkCompanySelector","setCompanyId","onHcmLinkCompanySelectorVisibleChange","initCompanySelector","$refs","Dom","append","isVisible","HcmLinkCompanySelector","setAvailability","subscribe","availableSettings","DocumentPreview","previewSrc","documentId","previewImageClass","isIconVisible","previewDocument","resolve","Router","openSlider","width","DocumentRegionalSettings","hcmLinkDocumentTypeList","isPreviewVisible","isHcmLinkDocumentTypeVisible","isDocumentTypeVisible","isRegistrationNumberVisible","isDateVisible","currentValue","newVal","setDefaultValues","modifyDocumentType","modifyDateSettings","modifyRegistrationNumberSettings","modifyHcmLinkDocumentType","registrationNumberSettings","getDefaultValues","getDateDefaultValue","getExternalIdDefaultValue","getHcmLinkDocumentTypeSettingIdDefaultValue","getDocumentTypeDefaultValue","_this$documentTypeLis","_this$externalIdTypeL","_this$dateTypeList$","DocumentPreviewList","documentList","maxPreviewCount","isShowMoreButtonVisible","previewCount","showMoreCount","documentCount","isShowMoreVisible","documentPreviewList","result","document","onShowMoreClick","onShowLessClick","RegionalSettingsApp","selectedCompanyId","isApplySettingsForAll","previewUrlList","mapState","size","isHcmLinkCompanyIdSet","getDocumentId","previewUrl","getDocumentPreviewUrl","getDocumentTitle","documentDetails","oldVal","getDocumentSettings","getDocumentDetails","url","loadDocumentPreviewUrl","onCompanySelectorChange","setAllDocumentSettings","setSettings","applySettingsForAll","_this$$refs$","getElementById","scrollIntoView","behavior","container","store","createPinia","babelHelpers","BitrixVue","createApp","use","regionDocumentTypes","mount","onClose","EventEmitter","unsubscribe","_babelHelpers$classPr","unmount","constructor","regionalSettingsOptions","writable","getLayout","BX","UI","Error","save","documentGroup","getSelectedHcmLinkCompanyId","setLastSavedHcmLinkCompanyId"],"mappings":"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"}