this.BX=this.BX||{};this.BX.Sign=this.BX.Sign||{};(function(e,s,t,l,a,i,o,r,n,d,c,b,v,p){"use strict";let h=e=>e,L,u;var B=babelHelpers.classPrivateFieldLooseKey("layout");var P=babelHelpers.classPrivateFieldLooseKey("props");var F=babelHelpers.classPrivateFieldLooseKey("titleNode");var g=babelHelpers.classPrivateFieldLooseKey("descriptionNode");var H=babelHelpers.classPrivateFieldLooseKey("createListItem");class f{constructor(e){Object.defineProperty(this,H,{value:y});Object.defineProperty(this,B,{writable:true,value:void 0});Object.defineProperty(this,P,{writable:true,value:void 0});Object.defineProperty(this,F,{writable:true,value:void 0});Object.defineProperty(this,g,{writable:true,value:void 0});babelHelpers.classPrivateFieldLooseBase(this,F)[F]=d.Tag.render(L||(L=h`
			<span class="sign-blank-selector__list_item-title"></span>
		`));babelHelpers.classPrivateFieldLooseBase(this,g)[g]=d.Tag.render(u||(u=h`
			<span class="sign-blank-selector__list_item-info"></span>
		`));this.setProps(e);babelHelpers.classPrivateFieldLooseBase(this,B)[B]=babelHelpers.classPrivateFieldLooseBase(this,H)[H]()}getLayout(){return babelHelpers.classPrivateFieldLooseBase(this,B)[B]}setTitle(e=""){babelHelpers.classPrivateFieldLooseBase(this,F)[F].textContent=e;babelHelpers.classPrivateFieldLooseBase(this,F)[F].title=e;this.setProps({...this.getProps(),title:e})}setDescription(e=""){babelHelpers.classPrivateFieldLooseBase(this,g)[g].textContent=e;babelHelpers.classPrivateFieldLooseBase(this,g)[g].title=e;this.setProps({...this.getProps(),description:e})}getProps(){return babelHelpers.classPrivateFieldLooseBase(this,P)[P]}setProps(e){babelHelpers.classPrivateFieldLooseBase(this,P)[P]=e}}function y(){const{title:e,description:s,modifier:t}=this.getProps();this.setTitle(e);this.setDescription(s);return d.Dom.create("div",{attrs:{className:`sign-blank-selector__list_item --${t}`},children:[babelHelpers.classPrivateFieldLooseBase(this,F)[F],babelHelpers.classPrivateFieldLooseBase(this,g)[g]]})}let m=e=>e,_,S,E,O;var T=babelHelpers.classPrivateFieldLooseKey("placeholder");var k=babelHelpers.classPrivateFieldLooseKey("preview");var w=babelHelpers.classPrivateFieldLooseKey("loader");class C extends f{constructor(e){super({...e,modifier:"blank"});Object.defineProperty(this,T,{writable:true,value:void 0});Object.defineProperty(this,k,{writable:true,value:void 0});Object.defineProperty(this,w,{writable:true,value:void 0});babelHelpers.classPrivateFieldLooseBase(this,T)[T]=d.Tag.render(_||(_=m`<div class="sign-blank-selector__list_item-status"></div>`));babelHelpers.classPrivateFieldLooseBase(this,k)[k]=d.Tag.render(S||(S=m`
			<div class="sign-blank-selector__list_item-preview" hidden>
				<img
					onload="${0}"
				/>
			</div>
		`),(()=>{babelHelpers.classPrivateFieldLooseBase(this,k)[k].hidden=false;babelHelpers.classPrivateFieldLooseBase(this,T)[T].hidden=true}));babelHelpers.classPrivateFieldLooseBase(this,w)[w]=new r.Loader({size:30,target:babelHelpers.classPrivateFieldLooseBase(this,T)[T]});const s=this.getLayout();d.Dom.prepend(babelHelpers.classPrivateFieldLooseBase(this,T)[T],s);d.Dom.prepend(babelHelpers.classPrivateFieldLooseBase(this,k)[k],s)}setAvatarWithDescription(e,s){this.setDescription(e);this.setProps({...this.getProps(),userAvatarUrl:s});const t=s?d.Tag.render(E||(E=m`
				<img class="sign-blank-selector__list_item-info-avatar" src="${0}" />
			`),s):d.Tag.render(O||(O=m`
				<span class="sign-blank-selector__list_item-info-avatar ui-icon ui-icon-common-user">
					<i></i>
				</span>
			`));const{lastElementChild:l}=this.getLayout();d.Dom.prepend(t,l)}select(){d.Dom.addClass(this.getLayout(),"--active")}deselect(){d.Dom.removeClass(this.getLayout(),"--active");this.getLayout().blur()}remove(){d.Dom.remove(this.getLayout())}setId(e){this.getLayout().dataset.id=e}setReady(e){if(!e){babelHelpers.classPrivateFieldLooseBase(this,w)[w].show();return}const s=this.getLayout();s.tabIndex="0";babelHelpers.classPrivateFieldLooseBase(this,w)[w].hide();d.Dom.addClass(s,"--loaded")}setPreview(e){if(e){babelHelpers.classPrivateFieldLooseBase(this,k)[k].firstElementChild.src=e}}}let I=e=>e,K;var N=babelHelpers.classPrivateFieldLooseKey("cache");var D=babelHelpers.classPrivateFieldLooseKey("setOptions");var A=babelHelpers.classPrivateFieldLooseKey("getOptions");var j=babelHelpers.classPrivateFieldLooseKey("getApi");var R=babelHelpers.classPrivateFieldLooseKey("getBlankSelector");var U=babelHelpers.classPrivateFieldLooseKey("getTagSelector");var M=babelHelpers.classPrivateFieldLooseKey("resetBlankSelector");class x extends c.EventEmitter{constructor(e){var s;super();Object.defineProperty(this,M,{value:z});Object.defineProperty(this,U,{value:V});Object.defineProperty(this,R,{value:W});Object.defineProperty(this,j,{value:G});Object.defineProperty(this,A,{value:$});Object.defineProperty(this,D,{value:X});Object.defineProperty(this,N,{writable:true,value:new d.Cache.MemoryCache});this.setEventNamespace("BX.Sign.BlankSelector.BlankField");this.subscribeFromOptions(e==null?void 0:e.events);babelHelpers.classPrivateFieldLooseBase(this,D)[D](e);const t=e==null?void 0:(s=e.data)==null?void 0:s.blankId;if(d.Type.isStringFilled(t)||d.Type.isNumber(t)){babelHelpers.classPrivateFieldLooseBase(this,j)[j]().getBlankById(e.data.blankId).then((({id:e,title:s})=>{babelHelpers.classPrivateFieldLooseBase(this,U)[U]().addTag({id:e,title:s,entityId:"blank"})}))}}getLayout(){return babelHelpers.classPrivateFieldLooseBase(this,N)[N].remember("layout",(()=>{const e=d.Tag.render(K||(K=I`
				<div class="sign-blank-selector-field">
				</div>
			`));babelHelpers.classPrivateFieldLooseBase(this,U)[U]().renderTo(e);return e}))}renderTo(e){if(d.Type.isDomNode(e)){d.Dom.append(this.getLayout(),e)}}}function X(e){babelHelpers.classPrivateFieldLooseBase(this,N)[N].set("options",e)}function $(){return babelHelpers.classPrivateFieldLooseBase(this,N)[N].get("options",{})}function G(){return babelHelpers.classPrivateFieldLooseBase(this,N)[N].remember("api",(()=>new b.Api))}function W(){return babelHelpers.classPrivateFieldLooseBase(this,N)[N].remember("blankSelector",(()=>new Ie({...babelHelpers.classPrivateFieldLooseBase(this,A)[A]().selectorOptions,events:{toggleSelection:e=>{const{id:s,title:t,selected:l}=e.getData();const a=babelHelpers.classPrivateFieldLooseBase(this,U)[U]();if(l){a.addTag({id:s,title:t,entityId:"blank"});a.showAddButton();this.emit("onSelect",e);return}if(a.getTags().length===0){a.showAddButton()}this.emit("onCancel")},onSliderClose:()=>{const e=babelHelpers.classPrivateFieldLooseBase(this,U)[U]();if(e.getTags().length===0){e.showAddButton()}babelHelpers.classPrivateFieldLooseBase(this,M)[M]()}}})))}function V(){return babelHelpers.classPrivateFieldLooseBase(this,N)[N].remember("tagSelector",(()=>new v.TagSelector({id:d.Text.getRandom(),multiple:false,showTextBox:false,addButtonCaption:d.Loc.getMessage("SIGN_BLANK_SELECTOR_FIELD_ADD_BUTTON_LABEL"),tagMaxWidth:500,events:{onAddButtonClick:()=>{babelHelpers.classPrivateFieldLooseBase(this,R)[R]().openInSlider();babelHelpers.classPrivateFieldLooseBase(this,U)[U]().hideTextBox()},onAfterTagRemove:()=>{babelHelpers.classPrivateFieldLooseBase(this,U)[U]().hideTextBox();babelHelpers.classPrivateFieldLooseBase(this,U)[U]().showAddButton();this.emit("onRemove")}}})))}function z(){babelHelpers.classPrivateFieldLooseBase(this,N)[N].delete("blankSelector")}let Y=e=>e,q,J,Q,Z,ee,se;const te={controller:"sign.upload.blankUploadController",acceptedFileTypes:[".jpg",".jpeg",".png",".pdf",".doc",".docx",".rtf",".odt"],multiple:true,autoUpload:false,maxFileSize:50*1024*1024,maxFileCount:100,imageMaxFileSize:10*1024*1024,maxTotalFileSize:50*1024*1024};const le={id:"qwerty",padding:20,offsetLeft:40,offsetTop:-12,angle:true,darkMode:true,width:300,autoHide:true,cacheable:false,bindOptions:{position:"bottom"}};var ae=babelHelpers.classPrivateFieldLooseKey("cache");var ie=babelHelpers.classPrivateFieldLooseKey("blanks");var oe=babelHelpers.classPrivateFieldLooseKey("tileWidget");var re=babelHelpers.classPrivateFieldLooseKey("tileWidgetContainer");var ne=babelHelpers.classPrivateFieldLooseKey("uploadButtonsContainer");var de=babelHelpers.classPrivateFieldLooseKey("relatedTarget");var ce=babelHelpers.classPrivateFieldLooseKey("blanksContainer");var be=babelHelpers.classPrivateFieldLooseKey("page");var ve=babelHelpers.classPrivateFieldLooseKey("loadMoreButton");var pe=babelHelpers.classPrivateFieldLooseKey("api");var he=babelHelpers.classPrivateFieldLooseKey("config");var Le=babelHelpers.classPrivateFieldLooseKey("checkForFilesValid");var ue=babelHelpers.classPrivateFieldLooseKey("onFileBeforeAdd");var Be=babelHelpers.classPrivateFieldLooseKey("getImagesLimit");var Pe=babelHelpers.classPrivateFieldLooseKey("onFileAdd");var Fe=babelHelpers.classPrivateFieldLooseKey("onFileRemove");var ge=babelHelpers.classPrivateFieldLooseKey("onUploadStart");var He=babelHelpers.classPrivateFieldLooseKey("toggleTileVisibility");var fe=babelHelpers.classPrivateFieldLooseKey("createUploadButtons");var ye=babelHelpers.classPrivateFieldLooseKey("resumeUploading");var me=babelHelpers.classPrivateFieldLooseKey("loadBlanks");var _e=babelHelpers.classPrivateFieldLooseKey("setupBlank");var Se=babelHelpers.classPrivateFieldLooseKey("normalizeTitle");var Ee=babelHelpers.classPrivateFieldLooseKey("addBlank");var Oe=babelHelpers.classPrivateFieldLooseKey("setSaveButtonIntoSlider");var Te=babelHelpers.classPrivateFieldLooseKey("disableSaveButtonIntoSlider");var ke=babelHelpers.classPrivateFieldLooseKey("enableSaveButtonIntoSlider");var we=babelHelpers.classPrivateFieldLooseKey("getSaveButtonIntoSlider");var Ce=babelHelpers.classPrivateFieldLooseKey("isAllFileUploadsComplete");class Ie extends c.EventEmitter{constructor(e){var s;super();Object.defineProperty(this,Ce,{value:Je});Object.defineProperty(this,we,{value:qe});Object.defineProperty(this,ke,{value:Ye});Object.defineProperty(this,Te,{value:ze});Object.defineProperty(this,Oe,{value:Ve});Object.defineProperty(this,Ee,{value:We});Object.defineProperty(this,Se,{value:Ge});Object.defineProperty(this,_e,{value:$e});Object.defineProperty(this,me,{value:Xe});Object.defineProperty(this,ye,{value:xe});Object.defineProperty(this,fe,{value:Me});Object.defineProperty(this,He,{value:Ue});Object.defineProperty(this,ge,{value:Re});Object.defineProperty(this,Fe,{value:je});Object.defineProperty(this,Pe,{value:Ae});Object.defineProperty(this,Be,{value:De});Object.defineProperty(this,ue,{value:Ne});Object.defineProperty(this,Le,{value:Ke});this.events=Object.freeze({beforeAddFileSuccessfully:"beforeAddFileSuccessfully",toggleSelection:"toggleSelection",addFile:"addFile"});Object.defineProperty(this,ae,{writable:true,value:new d.Cache.MemoryCache});Object.defineProperty(this,ie,{writable:true,value:void 0});Object.defineProperty(this,oe,{writable:true,value:void 0});Object.defineProperty(this,re,{writable:true,value:void 0});Object.defineProperty(this,ne,{writable:true,value:void 0});Object.defineProperty(this,de,{writable:true,value:void 0});Object.defineProperty(this,ce,{writable:true,value:void 0});Object.defineProperty(this,be,{writable:true,value:void 0});Object.defineProperty(this,ve,{writable:true,value:void 0});Object.defineProperty(this,pe,{writable:true,value:void 0});Object.defineProperty(this,he,{writable:true,value:void 0});this.setEventNamespace("BX.Sign.V2.BlankSelector");this.subscribeFromOptions((s=e==null?void 0:e.events)!=null?s:{});babelHelpers.classPrivateFieldLooseBase(this,he)[he]=e;this.selectedBlankId=0;babelHelpers.classPrivateFieldLooseBase(this,ie)[ie]=new Map;babelHelpers.classPrivateFieldLooseBase(this,be)[be]=0;const t=babelHelpers.classPrivateFieldLooseBase(this,fe)[fe]();const l=d.Tag.render(q||(q=Y`
			<label class="sign-blank-selector__list_drag-area-label">
				${0}
			</label>
		`),d.Loc.getMessage("SIGN_BLANK_SELECTOR_DRAG_AREA"));const a={slots:{afterDropArea:{computed:{title:()=>d.Loc.getMessage("SIGN_BLANK_SELECTOR_CLEAR_ALL")},methods:{clear:()=>{this.clearFiles({removeFromServer:false})}},template:`\n\t\t\t\t\t\t<span\n\t\t\t\t\t\t\tclass="sign-blank-selector__tile-widget_clear-btn"\n\t\t\t\t\t\t\t:title="title"\n\t\t\t\t\t\t\t@click="clear()"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t</span>\n\t\t\t\t\t`}}};babelHelpers.classPrivateFieldLooseBase(this,ne)[ne]=d.Tag.render(J||(J=Y`
			<div class="sign-blank-selector__list --with-buttons">
				${0}
				${0}
			</div>
		`),t,l);babelHelpers.classPrivateFieldLooseBase(this,oe)[oe]=new i.TileWidget({...te,...e.uploaderOptions,dropElement:babelHelpers.classPrivateFieldLooseBase(this,ne)[ne],browseElement:[...t,l],events:{[o.UploaderEvent.BEFORE_FILES_ADD]:e=>babelHelpers.classPrivateFieldLooseBase(this,ue)[ue](e),[o.UploaderEvent.FILE_ADD]:e=>babelHelpers.classPrivateFieldLooseBase(this,Pe)[Pe](e),[o.UploaderEvent.FILE_REMOVE]:e=>babelHelpers.classPrivateFieldLooseBase(this,Fe)[Fe](e),[o.UploaderEvent.UPLOAD_START]:e=>babelHelpers.classPrivateFieldLooseBase(this,ge)[ge](e)}},a);babelHelpers.classPrivateFieldLooseBase(this,de)[de]=null;d.Event.bind(document,"mousedown",(e=>{babelHelpers.classPrivateFieldLooseBase(this,de)[de]=e.target}));babelHelpers.classPrivateFieldLooseBase(this,ce)[ce]=d.Tag.render(Q||(Q=Y`
			<div
				class="sign-blank-selector__list"
				onfocusin="${0}"
				onclick="${0}"
			></div>
		`),(({target:e})=>{this.selectBlank(Number(e.dataset.id))}),(({target:e,ctrlKey:s,metaKey:t})=>{if(s||t){this.resetSelectedBlank(Number(e.dataset.id),babelHelpers.classPrivateFieldLooseBase(this,de)[de])}}));babelHelpers.classPrivateFieldLooseBase(this,re)[re]=d.Tag.render(Z||(Z=Y`
			<div class="sign-blank-selector__tile-widget"></div>
		`));babelHelpers.classPrivateFieldLooseBase(this,ve)[ve]=d.Tag.render(ee||(ee=Y`
			<div class="sign-blank-selector__load-more --hidden">
				<span onclick="${0}">
					${0}
				</span>
			</div>
		`),(()=>babelHelpers.classPrivateFieldLooseBase(this,me)[me](babelHelpers.classPrivateFieldLooseBase(this,be)[be]+1)),d.Loc.getMessage("SIGN_BLANK_SELECTOR_LOAD_MORE"));babelHelpers.classPrivateFieldLooseBase(this,pe)[pe]=new b.Api}getUploadedFileName(e){const s=babelHelpers.classPrivateFieldLooseBase(this,oe)[oe].getUploader();const t=s.getFiles();if(t.length===0){return null}const l=t.at(e);if(!l){return null}return babelHelpers.classPrivateFieldLooseBase(this,Se)[Se](l.getName())}async createBlankFromOuterUploaderFiles(e){if(e.length===0){return}if(!babelHelpers.classPrivateFieldLooseBase(this,Ce)[Ce](e)){const e=d.Loc.getMessage("SIGN_BLANK_SELECTOR_UPLOADER_ERROR_INCOMPLETE");p.UI.Notification.Center.notify({content:e});throw new Error(e)}const s=e.at(0);const t=new C({title:s.getName()});t.setReady(false);d.Dom.prepend(t.getLayout(),babelHelpers.classPrivateFieldLooseBase(this,ce)[ce]);try{var a;const s=e.map((e=>e.getServerFileId()));const i=await babelHelpers.classPrivateFieldLooseBase(this,pe)[pe].createBlank(s,(a=babelHelpers.classPrivateFieldLooseBase(this,he)[he].type)!=null?a:null,l.isTemplateMode(babelHelpers.classPrivateFieldLooseBase(this,he)[he].documentMode));babelHelpers.classPrivateFieldLooseBase(this,_e)[_e]({...i,userName:d.Loc.getMessage("SIGN_BLANK_SELECTOR_CREATED_MYSELF")},t);return i.id}catch(e){t==null?void 0:t.remove==null?void 0:t.remove();console.log(e);throw e}}async createBlank(){const e=babelHelpers.classPrivateFieldLooseBase(this,oe)[oe].getUploader();const s=e.getFiles();if(s.length===0){return}const[t]=s;await babelHelpers.classPrivateFieldLooseBase(this,ye)[ye]();const a=t.getCustomData(t.getId());if(!babelHelpers.classPrivateFieldLooseBase(this,Ce)[Ce](s)){const e=d.Loc.getMessage("SIGN_BLANK_SELECTOR_UPLOADER_ERROR_INCOMPLETE");p.UI.Notification.Center.notify({content:e});throw new Error(e)}try{var i;const e=s.map((e=>e.getServerFileId()));const t=await babelHelpers.classPrivateFieldLooseBase(this,pe)[pe].createBlank(e,(i=babelHelpers.classPrivateFieldLooseBase(this,he)[he].type)!=null?i:null,l.isTemplateMode(babelHelpers.classPrivateFieldLooseBase(this,he)[he].documentMode));babelHelpers.classPrivateFieldLooseBase(this,_e)[_e]({...t,userName:d.Loc.getMessage("SIGN_BLANK_SELECTOR_CREATED_MYSELF")},a);return t.id}catch(e){a.remove();throw e}}resetSelectedBlank(){const e=this.selectedBlankId;const s=this.getBlank(this.selectedBlankId);s==null?void 0:s.deselect();this.selectedBlankId=0;if(s){this.emit(this.events.toggleSelection,{selected:false,previousSelectedBlankId:e})}babelHelpers.classPrivateFieldLooseBase(this,ke)[ke]()}async modifyBlankTitle(e,s){let t=babelHelpers.classPrivateFieldLooseBase(this,ie)[ie].get(e);if(!t){await this.loadBlankById(e);t=babelHelpers.classPrivateFieldLooseBase(this,ie)[ie].get(e)}t.setTitle(s)}hasBlank(e){return babelHelpers.classPrivateFieldLooseBase(this,ie)[ie].has(e)}getBlank(e){return babelHelpers.classPrivateFieldLooseBase(this,ie)[ie].get(e)}async loadBlankById(e){const s=await babelHelpers.classPrivateFieldLooseBase(this,pe)[pe].getBlankById(e);if(!this.hasBlank(e)){const e=new C({title:s.title});babelHelpers.classPrivateFieldLooseBase(this,Ee)[Ee](s,e)}}async selectBlank(e,s={}){const t=this.selectedBlankId;if(e!==this.selectedBlankId){this.resetSelectedBlank()}this.selectedBlankId=e;babelHelpers.classPrivateFieldLooseBase(this,He)[He](false);let l=this.getBlank(e);if(!l){await this.loadBlankById(e);l=this.getBlank(e)}const{title:a}=l.getProps();l.select();this.emit(this.events.toggleSelection,{id:e,selected:true,title:babelHelpers.classPrivateFieldLooseBase(this,Se)[Se](a),extra:s,previousSelectedBlankId:t})}deleteBlank(e){const s=babelHelpers.classPrivateFieldLooseBase(this,ie)[ie].get(e);if(s){babelHelpers.classPrivateFieldLooseBase(this,ie)[ie].delete(e);s.remove()}}clearFiles(e){const s=babelHelpers.classPrivateFieldLooseBase(this,oe)[oe].getUploader();s.removeFiles(e)}isFilesReadyForUpload(){if(babelHelpers.classPrivateFieldLooseBase(this,oe)[oe].getUploader().getFiles().length===0){return false}return babelHelpers.classPrivateFieldLooseBase(this,oe)[oe].getUploader().getFiles().every((e=>e.getErrors().length<=0))}getLayout(){var e;babelHelpers.classPrivateFieldLooseBase(this,oe)[oe].renderTo(babelHelpers.classPrivateFieldLooseBase(this,re)[re]);babelHelpers.classPrivateFieldLooseBase(this,He)[He](false);const s=(e=babelHelpers.classPrivateFieldLooseBase(this,he)[he].canUploadNewBlank)!=null?e:true;const t=d.Tag.render(se||(se=Y`
			<div class="sign-blank-selector">
				${0}
				${0}
				<p class="sign-blank-selector__templates_title">
					${0}
				</p>
				${0}
				${0}
			</div>
		`),babelHelpers.classPrivateFieldLooseBase(this,re)[re],s?babelHelpers.classPrivateFieldLooseBase(this,ne)[ne]:"",d.Loc.getMessage("SIGN_BLANK_SELECTOR_RECENT_TEMPLATES_TITLE"),babelHelpers.classPrivateFieldLooseBase(this,ce)[ce],babelHelpers.classPrivateFieldLooseBase(this,ve)[ve]);if(babelHelpers.classPrivateFieldLooseBase(this,be)[be]===0){babelHelpers.classPrivateFieldLooseBase(this,me)[me](1)}return t}openInSlider(){const e=d.Reflection.getClass("BX.SidePanel");if(!d.Type.isNil(e)){e.Instance.open("v2-blank-selector",{width:628,cacheable:false,events:{onClose:()=>{this.emit("onSliderClose")}},contentCallback:()=>a.Layout.createContent({extensions:["sign.v2.blank-selector"],title:d.Loc.getMessage("SIGN_BLANK_SELECTOR_SLIDER_TITLE"),content:()=>this.getLayout(),buttons:({cancelButton:s,SaveButton:t})=>{babelHelpers.classPrivateFieldLooseBase(this,Oe)[Oe](new t({text:d.Loc.getMessage("SIGN_BLANK_SELECTOR_SLIDER_SELECT_BLANK_BUTTON_LABEL"),onclick:()=>{e.Instance.close()}}));babelHelpers.classPrivateFieldLooseBase(this,Te)[Te]();return[babelHelpers.classPrivateFieldLooseBase(this,we)[we](),s]}})})}}disableSelectedBlank(e){const s=babelHelpers.classPrivateFieldLooseBase(this,ie)[ie].get(e);if(s){d.Dom.addClass(s.getLayout(),"--disabled")}}enableSelectedBlank(e){const s=babelHelpers.classPrivateFieldLooseBase(this,ie)[ie].get(e);if(s){d.Dom.removeClass(s.getLayout(),"--disabled")}}}function Ke(e){const s=e=>e.getType().includes("image/");const t=e.every((e=>s(e)));const l=e.every((e=>te.acceptedFileTypes.includes(`.${e.getExtension()}`)));if(!l||e.length>1&&!t){return false}const a=babelHelpers.classPrivateFieldLooseBase(this,oe)[oe].getUploader();const i=a.getFiles();const o=i.length;const r=babelHelpers.classPrivateFieldLooseBase(this,Be)[Be]();if(o===0&&e.length===1){return true}const n=i.every((e=>s(e)));return t&&n&&r-o>=e.length}function Ne(e){const{files:s}=e.getData();const l=babelHelpers.classPrivateFieldLooseBase(this,Le)[Le](s);if(l){const e=new c.BaseEvent({data:{files:s}});this.emit(this.events.beforeAddFileSuccessfully,e);if(e.isDefaultPrevented()){return}return}let a=babelHelpers.classPrivateFieldLooseBase(this,ne)[ne].firstElementChild;if(d.Dom.hasClass(babelHelpers.classPrivateFieldLooseBase(this,ne)[ne],"--hidden")){const{$refs:{container:e}}=babelHelpers.classPrivateFieldLooseBase(this,oe)[oe].getRootComponent();a=e.firstElementChild}const i=new t.Popup({...le,bindElement:a,content:d.Loc.getMessage("SIGN_BLANK_SELECTOR_UPLOAD_HINT",{"%imageCountLimit%":babelHelpers.classPrivateFieldLooseBase(this,Be)[Be]()})});i.show();e.preventDefault()}function De(){var e,s,t,l;return d.Type.isInteger(parseInt((e=babelHelpers.classPrivateFieldLooseBase(this,he)[he])==null?void 0:(s=e.uploaderOptions)==null?void 0:s.maxFileCount,10))?(t=babelHelpers.classPrivateFieldLooseBase(this,he)[he])==null?void 0:(l=t.uploaderOptions)==null?void 0:l.maxFileCount:te.maxFileCount}function Ae(e){const s=e.data.file.getName();babelHelpers.classPrivateFieldLooseBase(this,He)[He](true);this.resetSelectedBlank();this.emit(this.events.addFile,{title:babelHelpers.classPrivateFieldLooseBase(this,Se)[Se](s)})}function je(e){this.emit("removeFile");const s=babelHelpers.classPrivateFieldLooseBase(this,oe)[oe].getUploader();const t=s.getFiles();if(t.length===0){babelHelpers.classPrivateFieldLooseBase(this,He)[He](false);this.emit("clearFiles")}}function Re(){const e=babelHelpers.classPrivateFieldLooseBase(this,oe)[oe].getUploader();const[s]=e.getFiles();const t=s.getName();const l=s.getId();const a=new C({title:t});a.setReady(false);d.Dom.prepend(a.getLayout(),babelHelpers.classPrivateFieldLooseBase(this,ce)[ce]);s.setCustomData(l,a)}function Ue(e){const s="--hidden";if(e){d.Dom.removeClass(babelHelpers.classPrivateFieldLooseBase(this,re)[re],s);d.Dom.addClass(babelHelpers.classPrivateFieldLooseBase(this,ne)[ne],s);return}d.Dom.addClass(babelHelpers.classPrivateFieldLooseBase(this,re)[re],s);d.Dom.removeClass(babelHelpers.classPrivateFieldLooseBase(this,ne)[ne],s);this.clearFiles({removeFromServer:false})}function Me(){const e={img:{title:d.Loc.getMessage("SIGN_BLANK_SELECTOR_CREATE_NEW_PIC"),description:"jpeg, png"},pdf:{title:d.Loc.getMessage("SIGN_BLANK_SELECTOR_NEW_PDF"),description:"Adobe Acrobat"},doc:{title:d.Loc.getMessage("SIGN_BLANK_SELECTOR_NEW_DOC"),description:"doc, docx"}};const s=Object.entries(e);return s.map((([e,{title:s,description:t}])=>{const l=new f({title:s,description:t,modifier:e});return l.getLayout()}))}async function xe(){const e=babelHelpers.classPrivateFieldLooseBase(this,oe)[oe].getUploader();const s=e.getFiles();e.setMaxParallelUploads(s.length);const t=new Promise((s=>{e.subscribeOnce("onUploadComplete",s)}));e.start();await t}async function Xe(e){const s=new r.Loader({target:babelHelpers.classPrivateFieldLooseBase(this,ce)[ce],size:80,mode:"custom"});s.show();try{var t;const s=3;const l=await babelHelpers.classPrivateFieldLooseBase(this,pe)[pe].loadBlanks(e,(t=babelHelpers.classPrivateFieldLooseBase(this,he)[he].type)!=null?t:null,s);if(l.length<s){d.Dom.addClass(babelHelpers.classPrivateFieldLooseBase(this,ve)[ve],"--hidden")}else{d.Dom.removeClass(babelHelpers.classPrivateFieldLooseBase(this,ve)[ve],"--hidden")}if(l.length>0){l.forEach((e=>{if(this.hasBlank(e.id)){return}const{title:s}=e;const t=new C({title:s});babelHelpers.classPrivateFieldLooseBase(this,Ee)[Ee](e,t)}));babelHelpers.classPrivateFieldLooseBase(this,be)[be]=e}}catch{d.Dom.removeClass(babelHelpers.classPrivateFieldLooseBase(this,ve)[ve],"--hidden")}s.destroy()}function $e(e,t){const{id:l,previewUrl:a,userAvatarUrl:i,userName:o,dateCreate:r}=e;const n=r?new Date(r):new Date;const d=`${o}, ${s.DateTimeFormat.format("j M. Y",n)}`;t.setId(l);t.setReady(true);t.setPreview(a);t.setAvatarWithDescription(d,i);babelHelpers.classPrivateFieldLooseBase(this,ie)[ie].set(l,t)}function Ge(e){const s=te.acceptedFileTypes.find((s=>e.endsWith(s)));if(!s){return e}const t=e.lastIndexOf(s);return e.slice(0,t)}function We(e,s){babelHelpers.classPrivateFieldLooseBase(this,_e)[_e](e,s);d.Dom.append(s.getLayout(),babelHelpers.classPrivateFieldLooseBase(this,ce)[ce])}function Ve(e){babelHelpers.classPrivateFieldLooseBase(this,ae)[ae].set("saveButton",e)}function ze(){const e=babelHelpers.classPrivateFieldLooseBase(this,we)[we]();e==null?void 0:e.setDisabled(true)}function Ye(){const e=babelHelpers.classPrivateFieldLooseBase(this,we)[we]();e==null?void 0:e.setDisabled(false)}function qe(){return babelHelpers.classPrivateFieldLooseBase(this,ae)[ae].get("saveButton")}function Je(e){const s=e.filter((e=>e.getStatus()!==o.FileStatus.COMPLETE||d.Type.isNull(e.getServerFileId())));return s.length===0}e.BlankField=x;e.ListItem=f;e.BlankSelector=Ie})(this.BX.Sign.V2=this.BX.Sign.V2||{},BX.Main,BX.Main,BX.Sign.V2,BX.UI.SidePanel,BX.UI.Uploader,BX.UI.Uploader,BX,BX,BX,BX.Event,BX.Sign.V2,BX.UI.EntitySelector,BX);
//# sourceMappingURL=blank-selector.bundle.map.js