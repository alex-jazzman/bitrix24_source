{"version":3,"file":"lang-selector.bundle.js","sources":["../src/index.js"],"sourcesContent":["import { Loc, Tag } from 'main.core';\nimport { Button } from 'ui.buttons';\nimport { Api } from 'sign.v2.api';\nimport './style.css';\n\nexport class LangSelector\n{\n\t#api: Api;\n\t#langs: ?Object;\n\t#langButton: Button;\n\t#region: string;\n\t#documentUids: Array<string>;\n\n\tconstructor(region, langs)\n\t{\n\t\tthis.#region = region;\n\t\tthis.#langs = langs;\n\t\tthis.#documentUids = [];\n\t\tthis.#langButton = this.#getLanguageButton();\n\t\tthis.#api = new Api();\n\t}\n\n\tgetLayout(): HTMLElement\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"sign-lang-selector\">\n\t\t\t\t<span class=\"sign-lang-selector__label\">\n\t\t\t\t\t${Loc.getMessage('SIGN_BLANK_LANGUAGE_SELECTOR_LABEL_MSGVER_1')}\n\t\t\t\t</span>\n\t\t\t\t${this.#langButton.getContainer()}\n\t\t\t</div>\n\t\t`;\n\t}\n\n\t#getLanguageItems(): Array<{ text: string; onclick: Function; dataset: { langId: string; }}>\n\t{\n\t\tconst onItemClick = function(event) {\n\t\t\tconst id = event.currentTarget.getAttribute('data-lang-id');\n\t\t\tthis.#langButton.menuWindow.close();\n\t\t\tthis.#changeLang(id);\n\t\t\tthis.#langButton.setText(this.#langs[id].NAME);\n\t\t}.bind(this);\n\n\t\treturn Object.entries(this.#langs).map((lang) => {\n\t\t\treturn {\n\t\t\t\ttext: lang[1].NAME,\n\t\t\t\tonclick: onItemClick,\n\t\t\t\tdataset: { langId: lang[0] },\n\t\t\t};\n\t\t});\n\t}\n\n\t#getLanguageButton(): Button\n\t{\n\t\treturn new Button({\n\t\t\ttext: (this.#langs[this.#region]?.NAME || Loc.getMessage('SIGN_BLANK_LANGUAGE_SELECTOR_BUTTON_TITLE')),\n\t\t\tdropdown: true,\n\t\t\tcloseByEsc: true,\n\t\t\tautoHide: true,\n\t\t\tautoClose: true,\n\t\t\tcolor: BX.UI.Button.Color.LIGHT,\n\t\t\tsize: BX.UI.Button.Size.SMALL,\n\t\t\tmenu: {\n\t\t\t\titems: this.#getLanguageItems(),\n\t\t\t},\n\t\t\tclassName: 'sign-lang-selector__language-button',\n\t\t});\n\t}\n\n\tasync #changeLang(langId)\n\t{\n\t\tconst promises = this.#documentUids.map((uid: string) => this.#api.modifyLanguageId(uid, langId));\n\t\tawait Promise.all(promises);\n\t}\n\n\tsetDocumentUids(uids: Array<string>)\n\t{\n\t\tthis.#documentUids = uids;\n\t}\n}\n"],"names":["LangSelector","constructor","region","langs","Api","getLayout","Tag","render","Loc","getMessage","getContainer","setDocumentUids","uids","onItemClick","event","id","currentTarget","getAttribute","menuWindow","close","setText","NAME","bind","Object","entries","map","lang","text","onclick","dataset","langId","Button","dropdown","closeByEsc","autoHide","autoClose","color","BX","UI","Color","LIGHT","size","Size","SMALL","menu","items","className","promises","uid","modifyLanguageId","Promise","all"],"mappings":";;;;;;;;AAAA,CAGqB;CAAA;CAAA;CAAA;CAAA;CAAA;CAAA;CAAA;AAErB,CAAO,MAAMA,YAAY,CACzB;GAOCC,WAAW,CAACC,MAAM,EAAEC,KAAK,EACzB;KAAA;OAAA;;KAAA;OAAA;;KAAA;OAAA;;KAAA;OAAA;OAAA;;KAAA;OAAA;OAAA;;KAAA;OAAA;OAAA;;KAAA;OAAA;OAAA;;KAAA;OAAA;OAAA;;KACC,4CAAI,sBAAWD,MAAM;KACrB,4CAAI,oBAAUC,KAAK;KACnB,4CAAI,kCAAiB,EAAE;KACvB,4CAAI,sEAAe,IAAI,2CAAqB;KAC5C,4CAAI,gBAAQ,IAAIC,eAAG,EAAE;;GAGtBC,SAAS,GACT;KACC,OAAOC,aAAG,CAACC,MAAM,cAAC;;;OAGf,CAAgE;;MAEjE,CAAkC;;GAEpC,GAJKC,aAAG,CAACC,UAAU,CAAC,6CAA6C,CAAC,EAE9D,4CAAI,4BAAaC,YAAY,EAAE;;GA8CpCC,eAAe,CAACC,IAAmB,EACnC;KACC,4CAAI,kCAAiBA,IAAI;;CAE3B;CAAC,8BA5CA;GACC,MAAMC,WAAW,GAAG,UAASC,KAAK,EAAE;KACnC,MAAMC,EAAE,GAAGD,KAAK,CAACE,aAAa,CAACC,YAAY,CAAC,cAAc,CAAC;KAC3D,4CAAI,4BAAaC,UAAU,CAACC,KAAK,EAAE;KACnC,4CAAI,4BAAaJ,EAAE;KACnB,4CAAI,4BAAaK,OAAO,CAAC,4CAAI,kBAAQL,EAAE,CAAC,CAACM,IAAI,CAAC;IAC9C,CAACC,IAAI,CAAC,IAAI,CAAC;GAEZ,OAAOC,MAAM,CAACC,OAAO,yCAAC,IAAI,kBAAQ,CAACC,GAAG,CAAEC,IAAI,IAAK;KAChD,OAAO;OACNC,IAAI,EAAED,IAAI,CAAC,CAAC,CAAC,CAACL,IAAI;OAClBO,OAAO,EAAEf,WAAW;OACpBgB,OAAO,EAAE;SAAEC,MAAM,EAAEJ,IAAI,CAAC,CAAC;;MACzB;IACD,CAAC;CACH;CAAC,+BAGD;GAAA;GACC,OAAO,IAAIK,iBAAM,CAAC;KACjBJ,IAAI,EAAG,sEAAI,0DAAQ,IAAI,oBAAS,qBAAzB,sBAA2BN,IAAI,KAAIb,aAAG,CAACC,UAAU,CAAC,2CAA2C,CAAE;KACtGuB,QAAQ,EAAE,IAAI;KACdC,UAAU,EAAE,IAAI;KAChBC,QAAQ,EAAE,IAAI;KACdC,SAAS,EAAE,IAAI;KACfC,KAAK,EAAEC,EAAE,CAACC,EAAE,CAACP,MAAM,CAACQ,KAAK,CAACC,KAAK;KAC/BC,IAAI,EAAEJ,EAAE,CAACC,EAAE,CAACP,MAAM,CAACW,IAAI,CAACC,KAAK;KAC7BC,IAAI,EAAE;OACLC,KAAK,0CAAE,IAAI;MACX;KACDC,SAAS,EAAE;IACX,CAAC;CACH;CAAC,4BAEiBhB,MAAM,EACxB;GACC,MAAMiB,QAAQ,GAAG,4CAAI,gCAAetB,GAAG,CAAEuB,GAAW,IAAK,4CAAI,cAAMC,gBAAgB,CAACD,GAAG,EAAElB,MAAM,CAAC,CAAC;GACjG,MAAMoB,OAAO,CAACC,GAAG,CAACJ,QAAQ,CAAC;CAC5B;;;;;;;;"}