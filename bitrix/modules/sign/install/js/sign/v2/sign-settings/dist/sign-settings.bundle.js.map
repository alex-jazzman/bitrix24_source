{"version":3,"file":"sign-settings.bundle.js","sources":["../src/functions.js","../src/index.js"],"sourcesContent":["import { Type } from 'main.core';\nimport { DocumentMode } from 'sign.type';\n\nexport function decorateResultBeforeCompletion(\n\tinnerCallback: () => Promise<boolean>,\n\tonSuccess: () => void | Promise<void>,\n\tonFail: () => void | Promise<void>,\n): () => Promise<boolean>\n{\n\treturn async () => {\n\t\tlet result = false;\n\t\ttry\n\t\t{\n\t\t\tresult = await innerCallback();\n\t\t}\n\t\tcatch (e)\n\t\t{\n\t\t\tawait onFail();\n\t\t\tthrow e;\n\t\t}\n\n\t\tif (result)\n\t\t{\n\t\t\tawait onSuccess();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tawait onFail();\n\t\t}\n\n\t\treturn result;\n\t};\n}\n\nexport function isTemplateMode(mode: string): boolean\n{\n\treturn mode === DocumentMode.template;\n}\n\nexport function getFilledStringOrUndefined(value: string): string | undefined\n{\n\treturn Type.isStringFilled(value) ? value : undefined;\n}\n","import { Dom, Loc, Reflection, Tag, Type } from 'main.core';\nimport { MemoryCache } from 'main.core.cache';\nimport { DocumentMode, type DocumentModeType } from 'sign.type';\nimport type { AnalyticsOptions } from 'sign.v2.analytics';\nimport { Analytics, Context } from 'sign.v2.analytics';\nimport type { DocumentSend } from 'sign.v2.document-send';\nimport { type DocumentDetails, DocumentSetup } from 'sign.v2.document-setup';\nimport type { Editor } from 'sign.v2.editor';\nimport './style.css';\nimport { Preview } from 'sign.v2.preview';\nimport { type Metadata, Wizard, type WizardOptions } from 'ui.wizard';\nimport { decorateResultBeforeCompletion, getFilledStringOrUndefined, isTemplateMode } from './functions';\nimport type { SignOptions, SignOptionsConfig } from './types';\n\nexport type { SignOptions, SignOptionsConfig };\nexport { decorateResultBeforeCompletion, isTemplateMode };\n\nexport class SignSettings\n{\n\t#cache: MemoryCache<any> = new MemoryCache();\n\t#containerId: string;\n\t#preview: Preview;\n\t#type: string;\n\t#wizardOptions: WizardOptions;\n\tdocumentSetup: DocumentSetup;\n\tdocumentSend: DocumentSend;\n\twizard: Wizard;\n\teditor: Editor;\n\t#previewLayout: ?HTMLElement = null;\n\t#container: HTMLElement | null = null;\n\t#overlayContainer: HTMLElement | null = null;\n\t#currentOverlay: HTMLElement | null = null;\n\tdocumentMode: DocumentModeType;\n\tdocumentsGroup: Map<string, DocumentDetails>;\n\tdocumentsGroupUids: Array<string>;\n\t#isEditMode: boolean = false;\n\t#isSameBlankSelected: boolean = false;\n\teditedDocument: DocumentDetails | null;\n\tisB2bSignMaster: boolean = false;\n\thasPreviewUrls: boolean = false;\n\n\tconstructor(containerId: string, signOptions: SignOptions = {}, wizardOptions: WizardOptions = {})\n\t{\n\t\tthis.#containerId = containerId;\n\t\tthis.#wizardOptions = wizardOptions;\n\t\tconst { type = '', config = {}, documentMode, initiatedByType } = signOptions;\n\t\tthis.documentMode = documentMode;\n\t\tthis.#type = type;\n\t\tthis.documentsGroup = new Map();\n\t\tthis.documentsGroupUids = [];\n\t\tconst { languages, needSkipEditorStep } = config.documentSendConfig ?? {};\n\t\tconst EditorConstructor = Reflection.getClass('top.BX.Sign.V2.Editor');\n\t\tthis.editor = new EditorConstructor(\n\t\t\ttype,\n\t\t\t{ languages, isTemplateMode: this.isTemplateMode(), documentInitiatedByType: initiatedByType, needSkipEditorStep },\n\t\t);\n\t\tthis.#preview = new Preview({ layout: { getAfterPreviewLayoutCallback: () => this.getAfterPreviewLayout() } });\n\t}\n\n\t#createHead(): HTMLElement\n\t{\n\t\tconst headerTitle = this.#getHeaderTitleText();\n\t\tconst headerTitleSub = this.#getHeaderTitleSubText();\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"sign-settings__head\">\n\t\t\t\t<div>\n\t\t\t\t\t<p class=\"sign-settings__head_title\">${headerTitle}</p>\n\t\t\t\t\t<p class=\"sign-settings__head_title --sub\">\n\t\t\t\t\t\t${headerTitleSub}\n\t\t\t\t\t</p>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\t#getHeaderTitleSubText(): ?string\n\t{\n\t\tif (this.#type === 'b2b')\n\t\t{\n\t\t\treturn Loc.getMessage('SIGN_SETTINGS_B2B_TITLE_SUB');\n\t\t}\n\n\t\tif (this.isTemplateMode() && this.#isEditMode)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\treturn Loc.getMessage('SIGN_SETTINGS_B2E_TITLE_SUB');\n\t}\n\n\t#getHeaderTitleText(): ?string\n\t{\n\t\tif (this.isTemplateMode())\n\t\t{\n\t\t\treturn this.#isEditMode\n\t\t\t\t? Loc.getMessage('SIGN_SETTINGS_TITLE_TEMPLATE_EDIT')\n\t\t\t\t: Loc.getMessage('SIGN_SETTINGS_TITLE_TEMPLATE');\n\t\t}\n\n\t\treturn Loc.getMessage('SIGN_SETTINGS_TITLE');\n\t}\n\n\tisTemplateMode(): boolean\n\t{\n\t\treturn this.documentMode === DocumentMode.template;\n\t}\n\n\tisDocumentMode(): boolean\n\t{\n\t\treturn this.documentMode === DocumentMode.document;\n\t}\n\n\t#getLayout(): HTMLElement\n\t{\n\t\tthis.#previewLayout = this.#preview.getLayout();\n\n\t\tthis.#container = this.getLayoutTemplate(\n\t\t\tthis.#createHead(),\n\t\t\tthis.wizard.getLayout(),\n\t\t\tthis.#previewLayout,\n\t\t);\n\n\t\treturn this.#container;\n\t}\n\n\tgetLayoutTemplate(header: HTMLElement, wizard: HTMLElement, preview: HTMLElement): HTMLElement\n\t{\n\t\tconst className = this.#type === 'b2e' ? 'sign-settings --b2e' : 'sign-settings';\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"sign-settings__scope ${className}\">\n\t\t\t\t<div class=\"sign-settings__sidebar\">\n\t\t\t\t\t${header}\n\t\t\t\t\t${wizard}\n\t\t\t\t</div>\n\t\t\t\t<div class=\"sing-settings-preview-block\">\n\t\t\t\t\t${preview}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\t#getOverlayContainer(): HTMLElement\n\t{\n\t\tif (!this.#overlayContainer)\n\t\t{\n\t\t\tthis.#overlayContainer = Tag.render`<div class=\"sign-settings__overlay\"></div>`;\n\t\t}\n\t\tDom.hide(this.#overlayContainer);\n\n\t\treturn this.#overlayContainer;\n\t}\n\n\t#showCompleteNotification(): void\n\t{\n\t\tconst Notification = Reflection.getClass('top.BX.UI.Notification');\n\t\tconst notificationText = this.isGroupDocuments()\n\t\t\t? Loc.getMessage('SIGN_SETTINGS_COMPLETE_NOTIFICATION_TEXT_GROUP')\n\t\t\t: Loc.getMessage('SIGN_SETTINGS_COMPLETE_NOTIFICATION_TEXT');\n\n\t\tNotification.Center.notify({\n\t\t\tcontent: notificationText,\n\t\t\tautoHideDelay: 4000,\n\t\t});\n\t}\n\n\tonComplete(showNotification: boolean = true): void\n\t{\n\t\tBX.SidePanel.Instance.close();\n\t\tif (showNotification)\n\t\t{\n\t\t\tthis.#showCompleteNotification();\n\t\t}\n\n\t\tif (this.isSingleDocument())\n\t\t{\n\t\t\tconst queryString = window.location.search;\n\t\t\tconst urlParams = new URLSearchParams(queryString);\n\t\t\tif (!urlParams.has('noRedirect'))\n\t\t\t{\n\t\t\t\tconst { entityTypeId, entityId } = this.documentSetup.setupData;\n\t\t\t\tconst detailsUrl = `/crm/type/${entityTypeId}/details/${entityId}/`;\n\t\t\t\tBX.SidePanel.Instance.open(detailsUrl);\n\t\t\t}\n\t\t}\n\t}\n\n\tisSingleDocument(): boolean\n\t{\n\t\treturn this.documentsGroup.size === 1;\n\t}\n\n\tisGroupDocuments(): boolean\n\t{\n\t\treturn this.documentsGroup.size > 1;\n\t}\n\n\tasync renderPages(\n\t\tdocumentData: DocumentDetails,\n\t\tpreparedPages: boolean = false,\n\t\tisSelectBlank: boolean = true,\n\t): Promise<void>\n\t{\n\t\tthis.#preview.urls = [];\n\t\tthis.disablePreviewReady();\n\t\tthis.#preview.setBlocks(documentData.blocks);\n\t\tthis.editor.setUrls([], 0);\n\t\tthis.wizard.toggleBtnActiveState('back', true);\n\t\tconst handler = (urls, totalPages, newBlocks): void => {\n\t\t\tthis.enablePreviewReady();\n\t\t\tthis.#preview.urls = urls;\n\t\t\tthis.editor.setUrls(urls, totalPages);\n\t\t\tif (Type.isArray(newBlocks))\n\t\t\t{\n\t\t\t\tthis.#preview.setBlocks(newBlocks);\n\t\t\t}\n\t\t\tthis.wizard.toggleBtnActiveState('back', false);\n\t\t};\n\n\t\tthis.documentSetup.waitForPagesList(documentData, handler, preparedPages, isSelectBlank);\n\t}\n\n\tgetFirstDocumentUidFromGroup(): string\n\t{\n\t\treturn this.documentsGroup.keys().next().value;\n\t}\n\n\tgetFirstDocumentDataFromGroup(): DocumentDetails\n\t{\n\t\treturn this.documentsGroup.values().next().value;\n\t}\n\n\t/**\n\t * Returns document data with settings in the wizard\n\t */\n\tgetDocumentSetupData(): DocumentDetails\n\t{\n\t\tconst firstDocumentData = this.getFirstDocumentDataFromGroup() || {};\n\t\tconst setupData = this.documentSetup.setupData || {};\n\n\t\treturn { ...firstDocumentData, ...setupData };\n\t}\n\n\t#subscribeOnEditorEvents(): void\n\t{\n\t\tthis.editor.subscribe('save', ({ data }) => {\n\t\t\tconst blocks = data.blocks;\n\t\t\tconst uid = data.uid;\n\n\t\t\tif (this.documentsGroup.has(uid) === false)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst selectedDocument = this.documentsGroup.get(uid);\n\t\t\tselectedDocument.blocks = blocks;\n\n\t\t\tif (uid === this.getFirstDocumentUidFromGroup())\n\t\t\t{\n\t\t\t\tthis.#preview.setBlocks(blocks);\n\t\t\t\tthis.documentSetup.setupData = {\n\t\t\t\t\t...this.documentSetup.setupData,\n\t\t\t\t\tblocks,\n\t\t\t\t};\n\t\t\t}\n\t\t});\n\t}\n\n\tsubscribeOnEvents(): void\n\t{\n\t\tconst settingsEvents = [\n\t\t\t{\n\t\t\t\ttype: 'toggleActivity',\n\t\t\t\tstage: 'setup',\n\t\t\t\tmethod: ({ data }) => {\n\t\t\t\t\tconst { selected } = data;\n\t\t\t\t\tthis.wizard.toggleBtnActiveState('next', !selected);\n\t\t\t\t},\n\t\t\t},\n\t\t\t{\n\t\t\t\ttype: 'addFile',\n\t\t\t\tstage: 'setup',\n\t\t\t\tmethod: ({ data }) => {\n\t\t\t\t\tthis.wizard.toggleBtnActiveState('next', !data.ready);\n\t\t\t\t},\n\t\t\t},\n\t\t\t{\n\t\t\t\ttype: 'removeFile',\n\t\t\t\tstage: 'setup',\n\t\t\t\tmethod: ({ data }) => {\n\t\t\t\t\tthis.wizard.toggleBtnActiveState('next', !data.ready);\n\t\t\t\t},\n\t\t\t},\n\t\t\t{\n\t\t\t\ttype: 'clearFiles',\n\t\t\t\tstage: 'setup',\n\t\t\t\tmethod: () => this.wizard.toggleBtnActiveState('next', true),\n\t\t\t},\n\t\t\t{\n\t\t\t\ttype: 'showEditor',\n\t\t\t\tstage: 'send',\n\t\t\t\tmethod: async (event) => {\n\t\t\t\t\tconst { uid } = event.getData();\n\t\t\t\t\tif (uid && this.isGroupDocuments())\n\t\t\t\t\t{\n\t\t\t\t\t\tawait this.#executeEditorActionsForGroup(uid);\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.editor.show();\n\t\t\t\t},\n\t\t\t},\n\t\t\t{\n\t\t\t\ttype: 'changeTitle',\n\t\t\t\tstage: 'send',\n\t\t\t\tmethod: ({ data }) => {\n\t\t\t\t\tthis.documentSetup.setupData = {\n\t\t\t\t\t\t...this.documentSetup.setupData,\n\t\t\t\t\t\ttitle: data.title,\n\t\t\t\t\t};\n\t\t\t\t\tconst { blankTitle } = data;\n\t\t\t\t\tif (blankTitle)\n\t\t\t\t\t{\n\t\t\t\t\t\tconst { blankSelector, setupData } = this.documentSetup;\n\t\t\t\t\t\tblankSelector.modifyBlankTitle(setupData.blankId, blankTitle);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t},\n\t\t\t{\n\t\t\t\ttype: 'close',\n\t\t\t\tstage: 'send',\n\t\t\t\tmethod: () => this.onComplete(false),\n\t\t\t},\n\t\t\t{\n\t\t\t\ttype: 'hidePreview',\n\t\t\t\tstage: 'send',\n\t\t\t\tmethod: () => Dom.style(this.#previewLayout, 'display', 'none'),\n\t\t\t},\n\t\t\t{\n\t\t\t\ttype: 'showPreview',\n\t\t\t\tstage: 'send',\n\t\t\t\tmethod: () => Dom.style(this.#previewLayout, 'display', 'flex'),\n\t\t\t},\n\t\t\t{\n\t\t\t\ttype: 'appendOverlay',\n\t\t\t\tstage: 'send',\n\t\t\t\tmethod: (event) => this.#appendOverlay(event?.data?.overlay),\n\t\t\t},\n\t\t\t{\n\t\t\t\ttype: 'showOverlay',\n\t\t\t\tstage: 'send',\n\t\t\t\tmethod: () => this.#showOverlay(),\n\t\t\t},\n\t\t\t{\n\t\t\t\ttype: 'hideOverlay',\n\t\t\t\tstage: 'send',\n\t\t\t\tmethod: () => this.#hideOverlay(),\n\t\t\t},\n\t\t];\n\t\tsettingsEvents.forEach(({ type, method, stage }) => {\n\t\t\tconst step = stage === 'setup' ? this.documentSetup : this.documentSend;\n\t\t\tstep.subscribe(type, method);\n\t\t});\n\t\tthis.#subscribeOnEditorEvents();\n\t}\n\n\tasync getPagesUrls(data: DocumentDetails): Promise\n\t{\n\t\tconst documentUrls = [];\n\t\tconst handler = (urls): void => {\n\t\t\tconst targetDocument = this.documentsGroup.get(data.uid);\n\t\t\tdocumentUrls.push(...urls);\n\t\t\ttargetDocument.urls = documentUrls;\n\t\t};\n\t\tawait this.documentSetup.waitForPagesList(data, handler);\n\t}\n\n\tasync #executeEditorActionsForGroup(uid: string): Promise<void>\n\t{\n\t\tthis.editor.setUrls([], 0);\n\n\t\tconst setupData = this.documentsGroup.get(uid);\n\n\t\tif (!setupData.urls)\n\t\t{\n\t\t\tconst openEditorButton = this.#container.querySelector(`span[data-id=\"${setupData.id}\"]`);\n\t\t\tDom.addClass(openEditorButton, 'ui-btn-clock');\n\t\t\tawait this.getPagesUrls(setupData);\n\t\t\tDom.removeClass(openEditorButton, 'ui-btn-clock');\n\t\t\tthis.documentSetup.blankSelector.disableSelectedBlank(setupData.blankId);\n\t\t\tthis.documentSetup.resetDocument();\n\t\t\tthis.wizard.toggleBtnActiveState('next', false);\n\t\t}\n\n\t\tconst targetDocument = this.documentsGroup.get(uid);\n\t\tthis.editor.documentData = targetDocument;\n\t\tthis.editor.setUrls(targetDocument.urls, targetDocument.urls.length);\n\n\t\tawait this.editor.waitForPagesUrls();\n\t\tawait this.editor.renderDocument();\n\t}\n\n\t#appendOverlay(overlay: ?HTMLElement): void\n\t{\n\t\tif (!overlay)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.#currentOverlay)\n\t\t{\n\t\t\tDom.remove(this.#currentOverlay);\n\t\t}\n\n\t\tthis.#currentOverlay = overlay;\n\n\t\tDom.append(this.#currentOverlay, this.#overlayContainer);\n\t}\n\n\tasync setupDocument(uid?: string, preparedPages: boolean = false): Promise<DocumentDetails>\n\t{\n\t\tif (this.documentSetup.isSameBlankSelected())\n\t\t{\n\t\t\tvoid await this.documentSetup.setup(uid);\n\t\t\tthis.#isSameBlankSelected = true;\n\n\t\t\treturn this.documentSetup.setupData;\n\t\t}\n\n\t\tif (this.documentsGroup.size === 0)\n\t\t{\n\t\t\tthis.#preview.urls = [];\n\t\t\tthis.editor.setUrls([], 0);\n\t\t\tthis.#preview.setBlocks();\n\t\t}\n\n\t\tawait this.documentSetup.setup(uid);\n\n\t\tconst { setupData } = this.documentSetup;\n\t\tif (!setupData)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\tawait this.renderPages(setupData, preparedPages);\n\n\t\tif (this.#preview.hasUrls())\n\t\t{\n\t\t\tthis.hasPreviewUrls = true;\n\t\t\tthis.wizard.toggleBtnActiveState('next', false);\n\t\t}\n\n\t\tthis.#isSameBlankSelected = false;\n\n\t\treturn setupData;\n\t}\n\n\tasync init(uid: ?string, templateUid?: string): void\n\t{\n\t\tthis.#isEditMode = Type.isStringFilled(uid) || Type.isStringFilled(templateUid);\n\t\tconst metadata = this.getStepsMetadata(\n\t\t\tthis,\n\t\t\tgetFilledStringOrUndefined(uid),\n\t\t\tgetFilledStringOrUndefined(templateUid),\n\t\t);\n\t\tconst { complete, ...rest } = this.#wizardOptions;\n\n\t\tconst title = this.isTemplateMode()\n\t\t\t? Loc.getMessage('SIGN_SETTINGS_CREATE_TEMPLATE')\n\t\t\t: Loc.getMessage('SIGN_SETTINGS_SEND_FOR_SIGN');\n\t\tthis.wizard = new Wizard(metadata, {\n\t\t\tback: { className: 'ui-btn-light-border' },\n\t\t\tnext: {\n\t\t\t\tclassName: 'ui-btn-primary',\n\t\t\t},\n\t\t\tcomplete: {\n\t\t\t\tclassName: 'ui-btn-primary',\n\t\t\t\ttitle,\n\t\t\t\tonComplete: () => this.onComplete(),\n\t\t\t\t...complete,\n\t\t\t},\n\t\t\t...rest,\n\t\t});\n\t\tif (uid)\n\t\t{\n\t\t\tawait this.applyDocumentData(uid);\n\t\t}\n\n\t\tif (templateUid)\n\t\t{\n\t\t\tawait this.applyTemplateData(templateUid);\n\t\t}\n\n\t\tthis.#render(uid);\n\t}\n\n\tasync applyTemplateData(templateUid: string): Promise<void>\n\t// eslint-disable-next-line no-empty-function\n\t{}\n\n\t#render(uid: ?string): void\n\t{\n\t\tconst container = document.getElementById(this.#containerId);\n\t\tDom.append(this.#getOverlayContainer(), container);\n\t\tDom.append(this.#getLayout(), container);\n\t\tconst step = this.documentSetup.setupData ? 1 : 0;\n\n\t\tif (!this.isB2bSignMaster)\n\t\t{\n\t\t\tconst isDraft = Type.isStringFilled(uid);\n\t\t\tthis.wizard.toggleBtnActiveState('next', !isDraft);\n\t\t}\n\t\tthis.wizard.moveOnStep(step);\n\t}\n\n\tgetStepsMetadata(signSettings: this, documentUid?: string, templateUid?: string): Metadata\n\t{\n\t\treturn {};\n\t}\n\n\t#showOverlay(): void\n\t{\n\t\tDom.style(this.#container, 'display', 'none');\n\t\tDom.show(this.#overlayContainer);\n\t}\n\n\t#hideOverlay(): void\n\t{\n\t\tDom.style(this.#container, 'display', 'flex');\n\t\tDom.hide(this.#overlayContainer);\n\t}\n\n\tsetAnalyticsContext(context: Partial<AnalyticsOptions>): void\n\t{\n\t\tthis.getAnalytics().setContext(new Context(context));\n\t}\n\n\tgetAnalytics(): Analytics\n\t{\n\t\treturn this.#cache.remember('analytics', () => new (top.BX?.Sign.V2.Analytics ?? Analytics)());\n\t}\n\n\tisEditMode(): boolean\n\t{\n\t\treturn this.#isEditMode;\n\t}\n\n\tresetPreview(): void\n\t{\n\t\tthis.#preview.urls = [];\n\t\tthis.#preview.setBlocks();\n\t}\n\n\tdisablePreviewReady(): void\n\t{\n\t\tthis.#preview.ready = false;\n\t}\n\n\tenablePreviewReady(): void\n\t{\n\t\tthis.#preview.ready = true;\n\t}\n\n\tsetSingleDocument(setupData: DocumentDetails): void\n\t{\n\t\tthis.documentsGroup.clear();\n\t\tthis.documentsGroup.set(setupData.uid, setupData);\n\t\tthis.documentsGroupUids.length = 0;\n\t\tthis.documentsGroupUids.push(setupData.uid);\n\t\tthis.documentSend.setDocumentsBlock(this.documentsGroup);\n\n\t\tif (!this.#isSameBlankSelected)\n\t\t{\n\t\t\tthis.resetPreview();\n\t\t\tthis.editor.setUrls([]);\n\t\t\tthis.disablePreviewReady();\n\t\t}\n\t}\n\n\tisFirstDocumentSelected(uid: string)\n\t{\n\t\treturn this.documentsGroupUids[0] === uid;\n\t}\n\n\tgetAfterPreviewLayout(): HTMLElement | null\n\t{\n\t\treturn null;\n\t}\n\n\tasync applyDocumentData(uid: string): Promise<boolean>\n\t{}\n}\n"],"names":["decorateResultBeforeCompletion","innerCallback","onSuccess","onFail","result","e","isTemplateMode","mode","DocumentMode","template","getFilledStringOrUndefined","value","Type","isStringFilled","undefined","SignSettings","constructor","containerId","signOptions","wizardOptions","MemoryCache","isB2bSignMaster","hasPreviewUrls","type","config","documentMode","initiatedByType","documentsGroup","Map","documentsGroupUids","languages","needSkipEditorStep","documentSendConfig","EditorConstructor","Reflection","getClass","editor","documentInitiatedByType","Preview","layout","getAfterPreviewLayoutCallback","getAfterPreviewLayout","isDocumentMode","document","getLayoutTemplate","header","wizard","preview","className","Tag","render","onComplete","showNotification","BX","SidePanel","Instance","close","isSingleDocument","queryString","window","location","search","urlParams","URLSearchParams","has","entityTypeId","entityId","documentSetup","setupData","detailsUrl","open","size","isGroupDocuments","renderPages","documentData","preparedPages","isSelectBlank","urls","disablePreviewReady","setBlocks","blocks","setUrls","toggleBtnActiveState","handler","totalPages","newBlocks","enablePreviewReady","isArray","waitForPagesList","getFirstDocumentUidFromGroup","keys","next","getFirstDocumentDataFromGroup","values","getDocumentSetupData","firstDocumentData","subscribeOnEvents","settingsEvents","stage","method","data","selected","ready","event","uid","getData","show","title","blankTitle","blankSelector","modifyBlankTitle","blankId","Dom","style","overlay","forEach","step","documentSend","subscribe","getPagesUrls","documentUrls","targetDocument","get","push","setupDocument","isSameBlankSelected","setup","hasUrls","init","templateUid","metadata","getStepsMetadata","complete","rest","Loc","getMessage","Wizard","back","applyDocumentData","applyTemplateData","signSettings","documentUid","setAnalyticsContext","context","getAnalytics","setContext","Context","remember","top","Sign","V2","Analytics","isEditMode","resetPreview","setSingleDocument","clear","set","length","setDocumentsBlock","isFirstDocumentSelected","headerTitle","headerTitleSub","getLayout","hide","Notification","notificationText","Center","notify","content","autoHideDelay","selectedDocument","openEditorButton","querySelector","id","addClass","removeClass","disableSelectedBlank","resetDocument","waitForPagesUrls","renderDocument","remove","append","container","getElementById","isDraft","moveOnStep"],"mappings":";;;;;;CAGO,SAASA,8BAA8B,CAC7CC,aAAqC,EACrCC,SAAqC,EACrCC,MAAkC,EAEnC;GACC,OAAO,YAAY;KAClB,IAAIC,MAAM,GAAG,KAAK;KAClB,IACA;OACCA,MAAM,GAAG,MAAMH,aAAa,EAAE;MAC9B,CACD,OAAOI,CAAC,EACR;OACC,MAAMF,MAAM,EAAE;OACd,MAAME,CAAC;;KAGR,IAAID,MAAM,EACV;OACC,MAAMF,SAAS,EAAE;MACjB,MAED;OACC,MAAMC,MAAM,EAAE;;KAGf,OAAOC,MAAM;IACb;CACF;AAEA,CAAO,SAASE,cAAc,CAACC,IAAY,EAC3C;GACC,OAAOA,IAAI,KAAKC,sBAAY,CAACC,QAAQ;CACtC;AAEA,CAAO,SAASC,0BAA0B,CAACC,KAAa,EACxD;GACC,OAAOC,cAAI,CAACC,cAAc,CAACF,KAAK,CAAC,GAAGA,KAAK,GAAGG,SAAS;CACtD;;;;;;AC1CA,CAe0D;CAAA;CAAA;CAAA;CAAA;CAAA;CAAA;CAAA;CAAA;CAAA;CAAA;CAAA;CAAA;CAAA;CAAA;CAAA;CAAA;CAAA;CAAA;CAAA;CAAA;CAAA;CAAA;AAE1D,CAAO,MAAMC,YAAY,CACzB;GAuBCC,WAAW,CAACC,WAAmB,EAAEC,WAAwB,GAAG,EAAE,EAAEC,aAA4B,GAAG,EAAE,EACjG;KAAA;KAAA;OAAA;;KAAA;OAAA;;KAAA;OAAA;;KAAA;OAAA;;KAAA;OAAA;;KAAA;OAAA;;KAAA;OAAA;;KAAA;OAAA;;KAAA;OAAA;;KAAA;OAAA;;KAAA;OAAA;;KAAA;OAAA;;KAAA;OAAA;OAAA,OAvB2B,IAAIC,2BAAW;;KAAE;OAAA;OAAA;;KAAA;OAAA;OAAA;;KAAA;OAAA;OAAA;;KAAA;OAAA;OAAA;;KAAA;OAAA;OAAA,OASb;;KAAI;OAAA;OAAA,OACF;;KAAI;OAAA;OAAA,OACG;;KAAI;OAAA;OAAA,OACN;;KAAI;OAAA;OAAA,OAInB;;KAAK;OAAA;OAAA,OACI;;KAAK,KAErCC,eAAe,GAAY,KAAK;KAAA,KAChCC,cAAc,GAAY,KAAK;KAI9B,4CAAI,gCAAgBL,WAAW;KAC/B,4CAAI,oCAAkBE,aAAa;KACnC,MAAM;OAAEI,IAAI,GAAG,EAAE;OAAEC,MAAM,GAAG,EAAE;OAAEC,YAAY;OAAEC;MAAiB,GAAGR,WAAW;KAC7E,IAAI,CAACO,YAAY,GAAGA,YAAY;KAChC,4CAAI,kBAASF,IAAI;KACjB,IAAI,CAACI,cAAc,GAAG,IAAIC,GAAG,EAAE;KAC/B,IAAI,CAACC,kBAAkB,GAAG,EAAE;KAC5B,MAAM;OAAEC,SAAS;OAAEC;MAAoB,4BAAGP,MAAM,CAACQ,kBAAkB,oCAAI,EAAE;KACzE,MAAMC,iBAAiB,GAAGC,oBAAU,CAACC,QAAQ,CAAC,uBAAuB,CAAC;KACtE,IAAI,CAACC,MAAM,GAAG,IAAIH,iBAAiB,CAClCV,IAAI,EACJ;OAAEO,SAAS;OAAExB,cAAc,EAAE,IAAI,CAACA,cAAc,EAAE;OAAE+B,uBAAuB,EAAEX,eAAe;OAAEK;MAAoB,CAClH;KACD,4CAAI,wBAAY,IAAIO,uBAAO,CAAC;OAAEC,MAAM,EAAE;SAAEC,6BAA6B,EAAE,MAAM,IAAI,CAACC,qBAAqB;;MAAM,CAAC;;GA+C/GnC,cAAc,GACd;KACC,OAAO,IAAI,CAACmB,YAAY,KAAKjB,sBAAY,CAACC,QAAQ;;GAGnDiC,cAAc,GACd;KACC,OAAO,IAAI,CAACjB,YAAY,KAAKjB,sBAAY,CAACmC,QAAQ;;GAgBnDC,iBAAiB,CAACC,MAAmB,EAAEC,MAAmB,EAAEC,OAAoB,EAChF;KACC,MAAMC,SAAS,GAAG,4CAAI,oBAAW,KAAK,GAAG,qBAAqB,GAAG,eAAe;KAEhF,OAAOC,aAAG,CAACC,MAAM,cAAC;sCACgB,CAAY;;OAE3C,CAAS;OACT,CAAS;;;OAGT,CAAU;;;GAGb,GAToCF,SAAS,EAExCH,MAAM,EACNC,MAAM,EAGNC,OAAO;;GA8BbI,UAAU,CAACC,gBAAyB,GAAG,IAAI,EAC3C;KACCC,EAAE,CAACC,SAAS,CAACC,QAAQ,CAACC,KAAK,EAAE;KAC7B,IAAIJ,gBAAgB,EACpB;OACC,4CAAI;;KAGL,IAAI,IAAI,CAACK,gBAAgB,EAAE,EAC3B;OACC,MAAMC,WAAW,GAAGC,MAAM,CAACC,QAAQ,CAACC,MAAM;OAC1C,MAAMC,SAAS,GAAG,IAAIC,eAAe,CAACL,WAAW,CAAC;OAClD,IAAI,CAACI,SAAS,CAACE,GAAG,CAAC,YAAY,CAAC,EAChC;SACC,MAAM;WAAEC,YAAY;WAAEC;UAAU,GAAG,IAAI,CAACC,aAAa,CAACC,SAAS;SAC/D,MAAMC,UAAU,GAAI,aAAYJ,YAAa,YAAWC,QAAS,GAAE;SACnEb,EAAE,CAACC,SAAS,CAACC,QAAQ,CAACe,IAAI,CAACD,UAAU,CAAC;;;;GAKzCZ,gBAAgB,GAChB;KACC,OAAO,IAAI,CAAC9B,cAAc,CAAC4C,IAAI,KAAK,CAAC;;GAGtCC,gBAAgB,GAChB;KACC,OAAO,IAAI,CAAC7C,cAAc,CAAC4C,IAAI,GAAG,CAAC;;GAGpC,MAAME,WAAW,CAChBC,YAA6B,EAC7BC,aAAsB,GAAG,KAAK,EAC9BC,aAAsB,GAAG,IAAI,EAE9B;KACC,4CAAI,sBAAUC,IAAI,GAAG,EAAE;KACvB,IAAI,CAACC,mBAAmB,EAAE;KAC1B,4CAAI,sBAAUC,SAAS,CAACL,YAAY,CAACM,MAAM,CAAC;KAC5C,IAAI,CAAC5C,MAAM,CAAC6C,OAAO,CAAC,EAAE,EAAE,CAAC,CAAC;KAC1B,IAAI,CAACnC,MAAM,CAACoC,oBAAoB,CAAC,MAAM,EAAE,IAAI,CAAC;KAC9C,MAAMC,OAAO,GAAG,CAACN,IAAI,EAAEO,UAAU,EAAEC,SAAS,KAAW;OACtD,IAAI,CAACC,kBAAkB,EAAE;OACzB,4CAAI,sBAAUT,IAAI,GAAGA,IAAI;OACzB,IAAI,CAACzC,MAAM,CAAC6C,OAAO,CAACJ,IAAI,EAAEO,UAAU,CAAC;OACrC,IAAIxE,cAAI,CAAC2E,OAAO,CAACF,SAAS,CAAC,EAC3B;SACC,4CAAI,sBAAUN,SAAS,CAACM,SAAS,CAAC;;OAEnC,IAAI,CAACvC,MAAM,CAACoC,oBAAoB,CAAC,MAAM,EAAE,KAAK,CAAC;MAC/C;KAED,IAAI,CAACf,aAAa,CAACqB,gBAAgB,CAACd,YAAY,EAAES,OAAO,EAAER,aAAa,EAAEC,aAAa,CAAC;;GAGzFa,4BAA4B,GAC5B;KACC,OAAO,IAAI,CAAC9D,cAAc,CAAC+D,IAAI,EAAE,CAACC,IAAI,EAAE,CAAChF,KAAK;;GAG/CiF,6BAA6B,GAC7B;KACC,OAAO,IAAI,CAACjE,cAAc,CAACkE,MAAM,EAAE,CAACF,IAAI,EAAE,CAAChF,KAAK;;;;CAIlD;CACA;GACCmF,oBAAoB,GACpB;KACC,MAAMC,iBAAiB,GAAG,IAAI,CAACH,6BAA6B,EAAE,IAAI,EAAE;KACpE,MAAMxB,SAAS,GAAG,IAAI,CAACD,aAAa,CAACC,SAAS,IAAI,EAAE;KAEpD,OAAO;OAAE,GAAG2B,iBAAiB;OAAE,GAAG3B;MAAW;;GA4B9C4B,iBAAiB,GACjB;KACC,MAAMC,cAAc,GAAG,CACtB;OACC1E,IAAI,EAAE,gBAAgB;OACtB2E,KAAK,EAAE,OAAO;OACdC,MAAM,EAAE,CAAC;SAAEC;QAAM,KAAK;SACrB,MAAM;WAAEC;UAAU,GAAGD,IAAI;SACzB,IAAI,CAACtD,MAAM,CAACoC,oBAAoB,CAAC,MAAM,EAAE,CAACmB,QAAQ,CAAC;;MAEpD,EACD;OACC9E,IAAI,EAAE,SAAS;OACf2E,KAAK,EAAE,OAAO;OACdC,MAAM,EAAE,CAAC;SAAEC;QAAM,KAAK;SACrB,IAAI,CAACtD,MAAM,CAACoC,oBAAoB,CAAC,MAAM,EAAE,CAACkB,IAAI,CAACE,KAAK,CAAC;;MAEtD,EACD;OACC/E,IAAI,EAAE,YAAY;OAClB2E,KAAK,EAAE,OAAO;OACdC,MAAM,EAAE,CAAC;SAAEC;QAAM,KAAK;SACrB,IAAI,CAACtD,MAAM,CAACoC,oBAAoB,CAAC,MAAM,EAAE,CAACkB,IAAI,CAACE,KAAK,CAAC;;MAEtD,EACD;OACC/E,IAAI,EAAE,YAAY;OAClB2E,KAAK,EAAE,OAAO;OACdC,MAAM,EAAE,MAAM,IAAI,CAACrD,MAAM,CAACoC,oBAAoB,CAAC,MAAM,EAAE,IAAI;MAC3D,EACD;OACC3D,IAAI,EAAE,YAAY;OAClB2E,KAAK,EAAE,MAAM;OACbC,MAAM,EAAE,MAAOI,KAAK,IAAK;SACxB,MAAM;WAAEC;UAAK,GAAGD,KAAK,CAACE,OAAO,EAAE;SAC/B,IAAID,GAAG,IAAI,IAAI,CAAChC,gBAAgB,EAAE,EAClC;WACC,8CAAM,IAAI,gEAA+BgC,GAAG,CAAC;;SAG9C,IAAI,CAACpE,MAAM,CAACsE,IAAI,EAAE;;MAEnB,EACD;OACCnF,IAAI,EAAE,aAAa;OACnB2E,KAAK,EAAE,MAAM;OACbC,MAAM,EAAE,CAAC;SAAEC;QAAM,KAAK;SACrB,IAAI,CAACjC,aAAa,CAACC,SAAS,GAAG;WAC9B,GAAG,IAAI,CAACD,aAAa,CAACC,SAAS;WAC/BuC,KAAK,EAAEP,IAAI,CAACO;UACZ;SACD,MAAM;WAAEC;UAAY,GAAGR,IAAI;SAC3B,IAAIQ,UAAU,EACd;WACC,MAAM;aAAEC,aAAa;aAAEzC;YAAW,GAAG,IAAI,CAACD,aAAa;WACvD0C,aAAa,CAACC,gBAAgB,CAAC1C,SAAS,CAAC2C,OAAO,EAAEH,UAAU,CAAC;;;MAG/D,EACD;OACCrF,IAAI,EAAE,OAAO;OACb2E,KAAK,EAAE,MAAM;OACbC,MAAM,EAAE,MAAM,IAAI,CAAChD,UAAU,CAAC,KAAK;MACnC,EACD;OACC5B,IAAI,EAAE,aAAa;OACnB2E,KAAK,EAAE,MAAM;OACbC,MAAM,EAAE,MAAMa,aAAG,CAACC,KAAK,yCAAC,IAAI,mCAAiB,SAAS,EAAE,MAAM;MAC9D,EACD;OACC1F,IAAI,EAAE,aAAa;OACnB2E,KAAK,EAAE,MAAM;OACbC,MAAM,EAAE,MAAMa,aAAG,CAACC,KAAK,yCAAC,IAAI,mCAAiB,SAAS,EAAE,MAAM;MAC9D,EACD;OACC1F,IAAI,EAAE,eAAe;OACrB2E,KAAK,EAAE,MAAM;OACbC,MAAM,EAAGI,KAAK;SAAA;SAAA,+CAAK,IAAI,kCAAgBA,KAAK,mCAALA,KAAK,CAAEH,IAAI,qBAAX,YAAac,OAAO;;MAC3D,EACD;OACC3F,IAAI,EAAE,aAAa;OACnB2E,KAAK,EAAE,MAAM;OACbC,MAAM,EAAE,8CAAM,IAAI;MAClB,EACD;OACC5E,IAAI,EAAE,aAAa;OACnB2E,KAAK,EAAE,MAAM;OACbC,MAAM,EAAE,8CAAM,IAAI;MAClB,CACD;KACDF,cAAc,CAACkB,OAAO,CAAC,CAAC;OAAE5F,IAAI;OAAE4E,MAAM;OAAED;MAAO,KAAK;OACnD,MAAMkB,IAAI,GAAGlB,KAAK,KAAK,OAAO,GAAG,IAAI,CAAC/B,aAAa,GAAG,IAAI,CAACkD,YAAY;OACvED,IAAI,CAACE,SAAS,CAAC/F,IAAI,EAAE4E,MAAM,CAAC;MAC5B,CAAC;KACF,4CAAI;;GAGL,MAAMoB,YAAY,CAACnB,IAAqB,EACxC;KACC,MAAMoB,YAAY,GAAG,EAAE;KACvB,MAAMrC,OAAO,GAAIN,IAAI,IAAW;OAC/B,MAAM4C,cAAc,GAAG,IAAI,CAAC9F,cAAc,CAAC+F,GAAG,CAACtB,IAAI,CAACI,GAAG,CAAC;OACxDgB,YAAY,CAACG,IAAI,CAAC,GAAG9C,IAAI,CAAC;OAC1B4C,cAAc,CAAC5C,IAAI,GAAG2C,YAAY;MAClC;KACD,MAAM,IAAI,CAACrD,aAAa,CAACqB,gBAAgB,CAACY,IAAI,EAAEjB,OAAO,CAAC;;GA6CzD,MAAMyC,aAAa,CAACpB,GAAY,EAAE7B,aAAsB,GAAG,KAAK,EAChE;KACC,IAAI,IAAI,CAACR,aAAa,CAAC0D,mBAAmB,EAAE,EAC5C;OACC,MAAK,MAAM,IAAI,CAAC1D,aAAa,CAAC2D,KAAK,CAACtB,GAAG,CAAC;OACxC,4CAAI,gDAAwB,IAAI;OAEhC,OAAO,IAAI,CAACrC,aAAa,CAACC,SAAS;;KAGpC,IAAI,IAAI,CAACzC,cAAc,CAAC4C,IAAI,KAAK,CAAC,EAClC;OACC,4CAAI,sBAAUM,IAAI,GAAG,EAAE;OACvB,IAAI,CAACzC,MAAM,CAAC6C,OAAO,CAAC,EAAE,EAAE,CAAC,CAAC;OAC1B,4CAAI,sBAAUF,SAAS,EAAE;;KAG1B,MAAM,IAAI,CAACZ,aAAa,CAAC2D,KAAK,CAACtB,GAAG,CAAC;KAEnC,MAAM;OAAEpC;MAAW,GAAG,IAAI,CAACD,aAAa;KACxC,IAAI,CAACC,SAAS,EACd;OACC,OAAO,IAAI;;KAGZ,MAAM,IAAI,CAACK,WAAW,CAACL,SAAS,EAAEO,aAAa,CAAC;KAEhD,IAAI,4CAAI,sBAAUoD,OAAO,EAAE,EAC3B;OACC,IAAI,CAACzG,cAAc,GAAG,IAAI;OAC1B,IAAI,CAACwB,MAAM,CAACoC,oBAAoB,CAAC,MAAM,EAAE,KAAK,CAAC;;KAGhD,4CAAI,gDAAwB,KAAK;KAEjC,OAAOd,SAAS;;GAGjB,MAAM4D,IAAI,CAACxB,GAAY,EAAEyB,WAAoB,EAC7C;KACC,4CAAI,8BAAerH,cAAI,CAACC,cAAc,CAAC2F,GAAG,CAAC,IAAI5F,cAAI,CAACC,cAAc,CAACoH,WAAW,CAAC;KAC/E,MAAMC,QAAQ,GAAG,IAAI,CAACC,gBAAgB,CACrC,IAAI,EACJzH,0BAA0B,CAAC8F,GAAG,CAAC,EAC/B9F,0BAA0B,CAACuH,WAAW,CAAC,CACvC;KACD,MAAM;OAAEG,QAAQ;OAAE,GAAGC;MAAM,2CAAG,IAAI,iCAAe;KAEjD,MAAM1B,KAAK,GAAG,IAAI,CAACrG,cAAc,EAAE,GAChCgI,aAAG,CAACC,UAAU,CAAC,+BAA+B,CAAC,GAC/CD,aAAG,CAACC,UAAU,CAAC,6BAA6B,CAAC;KAChD,IAAI,CAACzF,MAAM,GAAG,IAAI0F,gBAAM,CAACN,QAAQ,EAAE;OAClCO,IAAI,EAAE;SAAEzF,SAAS,EAAE;QAAuB;OAC1C2C,IAAI,EAAE;SACL3C,SAAS,EAAE;QACX;OACDoF,QAAQ,EAAE;SACTpF,SAAS,EAAE,gBAAgB;SAC3B2D,KAAK;SACLxD,UAAU,EAAE,MAAM,IAAI,CAACA,UAAU,EAAE;SACnC,GAAGiF;QACH;OACD,GAAGC;MACH,CAAC;KACF,IAAI7B,GAAG,EACP;OACC,MAAM,IAAI,CAACkC,iBAAiB,CAAClC,GAAG,CAAC;;KAGlC,IAAIyB,WAAW,EACf;OACC,MAAM,IAAI,CAACU,iBAAiB,CAACV,WAAW,CAAC;;KAG1C,4CAAI,oBAASzB,GAAG;;GAGjB,MAAMmC,iBAAiB,CAACV,WAAmB;;GAE3C;GAiBAE,gBAAgB,CAACS,YAAkB,EAAEC,WAAoB,EAAEZ,WAAoB,EAC/E;KACC,OAAO,EAAE;;GAeVa,mBAAmB,CAACC,OAAkC,EACtD;KACC,IAAI,CAACC,YAAY,EAAE,CAACC,UAAU,CAAC,IAAIC,yBAAO,CAACH,OAAO,CAAC,CAAC;;GAGrDC,YAAY,GACZ;KACC,OAAO,4CAAI,kBAAQG,QAAQ,CAAC,WAAW,EAAE;OAAA;OAAA,OAAM,yCAAKC,GAAG,CAAC/F,EAAE,qBAAN,QAAQgG,IAAI,CAACC,EAAE,CAACC,SAAS,oCAAIA,2BAAS,GAAG;OAAC;;GAG/FC,UAAU,GACV;KACC,+CAAO,IAAI;;GAGZC,YAAY,GACZ;KACC,4CAAI,sBAAU5E,IAAI,GAAG,EAAE;KACvB,4CAAI,sBAAUE,SAAS,EAAE;;GAG1BD,mBAAmB,GACnB;KACC,4CAAI,sBAAUwB,KAAK,GAAG,KAAK;;GAG5BhB,kBAAkB,GAClB;KACC,4CAAI,sBAAUgB,KAAK,GAAG,IAAI;;GAG3BoD,iBAAiB,CAACtF,SAA0B,EAC5C;KACC,IAAI,CAACzC,cAAc,CAACgI,KAAK,EAAE;KAC3B,IAAI,CAAChI,cAAc,CAACiI,GAAG,CAACxF,SAAS,CAACoC,GAAG,EAAEpC,SAAS,CAAC;KACjD,IAAI,CAACvC,kBAAkB,CAACgI,MAAM,GAAG,CAAC;KAClC,IAAI,CAAChI,kBAAkB,CAAC8F,IAAI,CAACvD,SAAS,CAACoC,GAAG,CAAC;KAC3C,IAAI,CAACa,YAAY,CAACyC,iBAAiB,CAAC,IAAI,CAACnI,cAAc,CAAC;KAExD,IAAI,yCAAC,IAAI,6CAAqB,EAC9B;OACC,IAAI,CAAC8H,YAAY,EAAE;OACnB,IAAI,CAACrH,MAAM,CAAC6C,OAAO,CAAC,EAAE,CAAC;OACvB,IAAI,CAACH,mBAAmB,EAAE;;;GAI5BiF,uBAAuB,CAACvD,GAAW,EACnC;KACC,OAAO,IAAI,CAAC3E,kBAAkB,CAAC,CAAC,CAAC,KAAK2E,GAAG;;GAG1C/D,qBAAqB,GACrB;KACC,OAAO,IAAI;;GAGZ,MAAMiG,iBAAiB,CAAClC,GAAW,EACnC;CACD;CAAC,wBAnhBA;GACC,MAAMwD,WAAW,2CAAG,IAAI,6CAAsB;GAC9C,MAAMC,cAAc,2CAAG,IAAI,mDAAyB;GAEpD,OAAOhH,aAAG,CAACC,MAAM,gBAAC;;;4CAGsB,CAAc;;QAElD,CAAiB;;;;GAIrB,GAN0C8G,WAAW,EAE/CC,cAAc;CAKrB;CAAC,mCAGD;GACC,IAAI,4CAAI,oBAAW,KAAK,EACxB;KACC,OAAO3B,aAAG,CAACC,UAAU,CAAC,6BAA6B,CAAC;;GAGrD,IAAI,IAAI,CAACjI,cAAc,EAAE,4CAAI,IAAI,2BAAY,EAC7C;KACC,OAAO,IAAI;;GAGZ,OAAOgI,aAAG,CAACC,UAAU,CAAC,6BAA6B,CAAC;CACrD;CAAC,gCAGD;GACC,IAAI,IAAI,CAACjI,cAAc,EAAE,EACzB;KACC,OAAO,4CAAI,8BACRgI,aAAG,CAACC,UAAU,CAAC,mCAAmC,CAAC,GACnDD,aAAG,CAACC,UAAU,CAAC,8BAA8B,CAAC;;GAGlD,OAAOD,aAAG,CAACC,UAAU,CAAC,qBAAqB,CAAC;CAC7C;CAAC,uBAaD;GACC,4CAAI,oCAAkB,4CAAI,sBAAU2B,SAAS,EAAE;GAE/C,4CAAI,4BAAc,IAAI,CAACtH,iBAAiB,yCACvC,IAAI,+BACJ,IAAI,CAACE,MAAM,CAACoH,SAAS,EAAE,0CACvB,IAAI,kCACJ;GAED,+CAAO,IAAI;CACZ;CAAC,iCAoBD;GACC,IAAI,yCAAC,IAAI,uCAAkB,EAC3B;KACC,4CAAI,0CAAqBjH,aAAG,CAACC,MAAM,gBAAC,4CAA0C,EAAC;;GAEhF8D,aAAG,CAACmD,IAAI,yCAAC,IAAI,wCAAmB;GAEhC,+CAAO,IAAI;CACZ;CAAC,sCAGD;GACC,MAAMC,YAAY,GAAGlI,oBAAU,CAACC,QAAQ,CAAC,wBAAwB,CAAC;GAClE,MAAMkI,gBAAgB,GAAG,IAAI,CAAC7F,gBAAgB,EAAE,GAC7C8D,aAAG,CAACC,UAAU,CAAC,gDAAgD,CAAC,GAChED,aAAG,CAACC,UAAU,CAAC,0CAA0C,CAAC;GAE7D6B,YAAY,CAACE,MAAM,CAACC,MAAM,CAAC;KAC1BC,OAAO,EAAEH,gBAAgB;KACzBI,aAAa,EAAE;IACf,CAAC;CACH;CAAC,qCAgFD;GACC,IAAI,CAACrI,MAAM,CAACkF,SAAS,CAAC,MAAM,EAAE,CAAC;KAAElB;IAAM,KAAK;KAC3C,MAAMpB,MAAM,GAAGoB,IAAI,CAACpB,MAAM;KAC1B,MAAMwB,GAAG,GAAGJ,IAAI,CAACI,GAAG;KAEpB,IAAI,IAAI,CAAC7E,cAAc,CAACqC,GAAG,CAACwC,GAAG,CAAC,KAAK,KAAK,EAC1C;OACC;;KAGD,MAAMkE,gBAAgB,GAAG,IAAI,CAAC/I,cAAc,CAAC+F,GAAG,CAAClB,GAAG,CAAC;KACrDkE,gBAAgB,CAAC1F,MAAM,GAAGA,MAAM;KAEhC,IAAIwB,GAAG,KAAK,IAAI,CAACf,4BAA4B,EAAE,EAC/C;OACC,4CAAI,sBAAUV,SAAS,CAACC,MAAM,CAAC;OAC/B,IAAI,CAACb,aAAa,CAACC,SAAS,GAAG;SAC9B,GAAG,IAAI,CAACD,aAAa,CAACC,SAAS;SAC/BY;QACA;;IAEF,CAAC;CACH;CAAC,8CA8GmCwB,GAAW,EAC/C;GACC,IAAI,CAACpE,MAAM,CAAC6C,OAAO,CAAC,EAAE,EAAE,CAAC,CAAC;GAE1B,MAAMb,SAAS,GAAG,IAAI,CAACzC,cAAc,CAAC+F,GAAG,CAAClB,GAAG,CAAC;GAE9C,IAAI,CAACpC,SAAS,CAACS,IAAI,EACnB;KACC,MAAM8F,gBAAgB,GAAG,4CAAI,0BAAYC,aAAa,CAAE,iBAAgBxG,SAAS,CAACyG,EAAG,IAAG,CAAC;KACzF7D,aAAG,CAAC8D,QAAQ,CAACH,gBAAgB,EAAE,cAAc,CAAC;KAC9C,MAAM,IAAI,CAACpD,YAAY,CAACnD,SAAS,CAAC;KAClC4C,aAAG,CAAC+D,WAAW,CAACJ,gBAAgB,EAAE,cAAc,CAAC;KACjD,IAAI,CAACxG,aAAa,CAAC0C,aAAa,CAACmE,oBAAoB,CAAC5G,SAAS,CAAC2C,OAAO,CAAC;KACxE,IAAI,CAAC5C,aAAa,CAAC8G,aAAa,EAAE;KAClC,IAAI,CAACnI,MAAM,CAACoC,oBAAoB,CAAC,MAAM,EAAE,KAAK,CAAC;;GAGhD,MAAMuC,cAAc,GAAG,IAAI,CAAC9F,cAAc,CAAC+F,GAAG,CAAClB,GAAG,CAAC;GACnD,IAAI,CAACpE,MAAM,CAACsC,YAAY,GAAG+C,cAAc;GACzC,IAAI,CAACrF,MAAM,CAAC6C,OAAO,CAACwC,cAAc,CAAC5C,IAAI,EAAE4C,cAAc,CAAC5C,IAAI,CAACgF,MAAM,CAAC;GAEpE,MAAM,IAAI,CAACzH,MAAM,CAAC8I,gBAAgB,EAAE;GACpC,MAAM,IAAI,CAAC9I,MAAM,CAAC+I,cAAc,EAAE;CACnC;CAAC,yBAEcjE,OAAqB,EACpC;GACC,IAAI,CAACA,OAAO,EACZ;KACC;;GAGD,4CAAI,IAAI,qCACR;KACCF,aAAG,CAACoE,MAAM,yCAAC,IAAI,oCAAiB;;GAGjC,4CAAI,sCAAmBlE,OAAO;GAE9BF,aAAG,CAACqE,MAAM,yCAAC,IAAI,6EAAkB,IAAI,wCAAmB;CACzD;CAAC,kBAmFO7E,GAAY,EACpB;GACC,MAAM8E,SAAS,GAAG3I,QAAQ,CAAC4I,cAAc,yCAAC,IAAI,8BAAc;GAC5DvE,aAAG,CAACqE,MAAM,yCAAC,IAAI,iDAAyBC,SAAS,CAAC;GAClDtE,aAAG,CAACqE,MAAM,yCAAC,IAAI,6BAAeC,SAAS,CAAC;GACxC,MAAMlE,IAAI,GAAG,IAAI,CAACjD,aAAa,CAACC,SAAS,GAAG,CAAC,GAAG,CAAC;GAEjD,IAAI,CAAC,IAAI,CAAC/C,eAAe,EACzB;KACC,MAAMmK,OAAO,GAAG5K,cAAI,CAACC,cAAc,CAAC2F,GAAG,CAAC;KACxC,IAAI,CAAC1D,MAAM,CAACoC,oBAAoB,CAAC,MAAM,EAAE,CAACsG,OAAO,CAAC;;GAEnD,IAAI,CAAC1I,MAAM,CAAC2I,UAAU,CAACrE,IAAI,CAAC;CAC7B;CAAC,yBAQD;GACCJ,aAAG,CAACC,KAAK,yCAAC,IAAI,2BAAa,SAAS,EAAE,MAAM,CAAC;GAC7CD,aAAG,CAACN,IAAI,yCAAC,IAAI,wCAAmB;CACjC;CAAC,yBAGD;GACCM,aAAG,CAACC,KAAK,yCAAC,IAAI,2BAAa,SAAS,EAAE,MAAM,CAAC;GAC7CD,aAAG,CAACmD,IAAI,yCAAC,IAAI,wCAAmB;CACjC;;;;;;;;;;"}