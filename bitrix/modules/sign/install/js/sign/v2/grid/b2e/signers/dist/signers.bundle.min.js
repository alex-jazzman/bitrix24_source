this.BX=this.BX||{};this.BX.Sign=this.BX.Sign||{};this.BX.Sign.V2=this.BX.Sign.V2||{};this.BX.Sign.V2.Grid=this.BX.Sign.V2.Grid||{};(function(e,t,s,i,o,n){"use strict";let a=e=>e,c,l;var r=babelHelpers.classPrivateFieldLooseKey("handleSave");var I=babelHelpers.classPrivateFieldLooseKey("showError");class S{constructor(){Object.defineProperty(this,I,{value:g});Object.defineProperty(this,r,{value:_})}async show(e=null){return new Promise((t=>{const s=`listNameInput_${Date.now()}`;const S=i.Tag.render(c||(c=a`
				<input
					type="text"
					id="${0}"
					class="ui-ctl-element"
					placeholder="${0}"
					value="${0}"
				>
			`),s,i.Loc.getMessage("SIGN_SIGNERS_GRID_CREATE_LIST_POPUP_INPUT_PLACEHOLDER"),e===null?"":i.Text.encode(e));const _=new n.Popup(`listNamePopup_${s}`,null,{draggable:false,overlay:true,width:500,height:280,padding:0,closeByEsc:true,closeIcon:true,className:"sign-signers-grid-create-list-popup",content:i.Tag.render(l||(l=a`
					<div class="sign-create-list-popup-item-container-wrapper">
						<span class="sign-create-list-title-titlebar">${0}</span>
						<div class="sign-create-list-popup-item-container">
							<div class="sign-create-list-title-input-container">
								${0}
							</div>
							<span style="text-align: left; width: 100%">${0}</span>
						</div>
					</div>
				`),i.Loc.getMessage("SIGN_SIGNERS_GRID_CREATE_LIST_POPUP_TITLE"),S,i.Loc.getMessage("SIGN_SIGNERS_GRID_CREATE_LIST_DESCRIPTION")),buttons:[new o.CreateButton({text:e===null?i.Loc.getMessage("SIGN_SIGNERS_GRID_CREATE_LIST_CREATE_BUTTON_TEXT"):i.Loc.getMessage("SIGN_SIGNERS_GRID_CREATE_LIST_SAVE_BUTTON_TEXT"),round:true,events:{click:async()=>{try{const e=await babelHelpers.classPrivateFieldLooseBase(this,r)[r](S);t(e);_.close()}catch(e){babelHelpers.classPrivateFieldLooseBase(this,I)[I](e)}}}}),new o.CancelButton({text:i.Loc.getMessage("SIGN_SIGNERS_GRID_CREATE_LIST_CANCEL_BUTTON_TEXT"),events:{click(){_.close()}}})],events:{onPopupShow(){i.Dom.style(this.popupContainer,"backgroundColor","rgba(255, 255, 255)")},onAfterShow:()=>{S.focus();if(e!==null&&e.length>1){S.setSelectionRange(S.value.length,S.value.length)}i.Event.bind(S,"keydown",(async e=>{if(e.key==="Enter"){try{const e=await babelHelpers.classPrivateFieldLooseBase(this,r)[r](S);t(e);_.close()}catch(e){babelHelpers.classPrivateFieldLooseBase(this,I)[I](e)}}}))}}});_.show()}))}}async function _(e){const t=e?e.value:"";if(!t){throw new Error(i.Loc.getMessage("SIGN_SIGNERS_GRID_CREATE_LIST_HINT_TITLE_NOT_EMPTY"))}return t}function g(e){BX.UI.Notification.Center.notify({content:e.message})}let E=e=>e,d;const L="SIGN_B2E_SIGNERS_LIST_GRID";const N="SIGN_B2E_SIGNERS_LIST_GRID_EDIT";var G=babelHelpers.classPrivateFieldLooseKey("api");var B=babelHelpers.classPrivateFieldLooseKey("getGridManager");class T{constructor(){Object.defineProperty(this,B,{value:R});Object.defineProperty(this,G,{writable:true,value:new t.Api})}reloadSigners(){const e=babelHelpers.classPrivateFieldLooseBase(this,B)[B]();i.Event.ready((()=>{var t;const s=e==null?void 0:(t=e.getById(N))==null?void 0:t.instance;if(i.Type.isObject(s)){s.reload()}}))}reloadLists(){const e=babelHelpers.classPrivateFieldLooseBase(this,B)[B]();i.Event.ready((()=>{var t;const s=e==null?void 0:(t=e.getById(L))==null?void 0:t.instance;if(i.Type.isObject(s)){s.reload()}}))}async deleteList(e){const t=i.Tag.render(d||(d=E`
			<div>
				${0}
			</div>
		`),i.Loc.getMessage("SIGN_SIGNERS_DELETE_CONFIRMATION_MESSAGE"));i.Dom.style(t,"margin-top","5%");i.Dom.style(t,"color","#535c69");s.MessageBox.show({title:i.Loc.getMessage("SIGN_SIGNERS_DELETE_CONFIRMATION_TITLE"),message:t.outerHTML,modal:true,buttons:[new BX.UI.Button({text:i.Loc.getMessage("SIGN_SIGNERS_GRID_DELETE_POPUP_YES"),color:BX.UI.Button.Color.PRIMARY,onclick:async t=>{t.setDisabled(true);t.setState(BX.UI.Button.State.WAITING);try{const t=babelHelpers.classPrivateFieldLooseBase(this,G)[G];await t.signersList.deleteSignersList(e);window.top.BX.UI.Notification.Center.notify({content:i.Loc.getMessage("SIGN_SIGNERS_GRID_DELETE_HINT_SUCCESS")})}catch{window.top.BX.UI.Notification.Center.notify({content:i.Loc.getMessage("SIGN_SIGNERS_GRID_DELETE_HINT_FAIL")})}await this.reloadLists();t.getContext().close()}}),new BX.UI.Button({text:i.Loc.getMessage("SIGN_SIGNERS_GRID_DELETE_POPUP_NO"),color:BX.UI.Button.Color.LINK,onclick:e=>{e.getContext().close()}})]})}async copyList(e){try{await babelHelpers.classPrivateFieldLooseBase(this,G)[G].signersList.copySignersList(e);await this.reloadLists();window.top.BX.UI.Notification.Center.notify({content:i.Loc.getMessage("SIGN_SIGNERS_GRID_COPY_HINT_SUCCESS")})}catch(e){console.error("Error copying list:",e);window.top.BX.UI.Notification.Center.notify({content:i.Loc.getMessage("SIGN_SIGNERS_GRID_COPY_HINT_FAIL")})}}async deleteSelectedSigners(e){var t;const s=babelHelpers.classPrivateFieldLooseBase(this,B)[B]();const i=s==null?void 0:(t=s.getById(N))==null?void 0:t.instance;if(!i){return}const o=i.getRows().getSelectedIds();if(o.length===0){return}await this.deleteSigners(e,o)}async deleteSigners(e,t){BX.UI.Dialogs.MessageBox.show({message:i.Loc.getMessage("SIGN_SIGNERS_SIGNER_DELETE_CONFIRMATION_TITLE"),modal:true,buttons:[new BX.UI.Button({text:i.Loc.getMessage("SIGN_SIGNERS_GRID_DELETE_POPUP_YES"),color:BX.UI.Button.Color.PRIMARY,onclick:async s=>{s.setDisabled(true);s.setState(BX.UI.Button.State.WAITING);const o=t.length===1;const n=o?i.Loc.getMessage("SIGN_SIGNERS_SIGNER_GRID_DELETE_HINT_SUCCESS"):i.Loc.getMessage("SIGN_SIGNERS_SIGNERS_GRID_DELETE_HINT_SUCCESS");const a=o?i.Loc.getMessage("SIGN_SIGNERS_SIGNER_GRID_DELETE_HINT_FAIL"):i.Loc.getMessage("SIGN_SIGNERS_SIGNERS_GRID_DELETE_HINT_FAIL");try{await babelHelpers.classPrivateFieldLooseBase(this,G)[G].signersList.deleteSignersFromList(e,t);window.top.BX.UI.Notification.Center.notify({content:n})}catch{window.top.BX.UI.Notification.Center.notify({content:a})}await this.reloadSigners();s.getContext().close()}}),new BX.UI.Button({text:i.Loc.getMessage("SIGN_SIGNERS_GRID_DELETE_POPUP_NO"),color:BX.UI.Button.Color.LINK,onclick:e=>e.getContext().close()})]})}async createList(){try{const e=new S;const t=await e.show();await babelHelpers.classPrivateFieldLooseBase(this,G)[G].signersList.createList(t);window.top.BX.UI.Notification.Center.notify({content:i.Loc.getMessage("SIGN_SIGNERS_GRID_LIST_CREATE_SUCCESS")})}catch{window.top.BX.UI.Notification.Center.notify({content:i.Loc.getMessage("SIGN_SIGNERS_GRID_LIST_CREATE_FAIL")})}await this.reloadLists()}async renameList(e,t){try{const s=new S;const o=await s.show(t);await babelHelpers.classPrivateFieldLooseBase(this,G)[G].signersList.renameList(e,o);window.top.BX.UI.Notification.Center.notify({content:i.Loc.getMessage("SIGN_SIGNERS_GRID_LIST_CREATE_SUCCESS")})}catch{window.top.BX.UI.Notification.Center.notify({content:i.Loc.getMessage("SIGN_SIGNERS_GRID_LIST_CREATE_FAIL")})}await this.reloadLists()}async addSigners(e,t,s=true){const i=t.map((e=>({...e,party:2})));await babelHelpers.classPrivateFieldLooseBase(this,G)[G].signersList.addSignersToList(e,i,s);BX.SidePanel.Instance.close();await this.reloadSigners()}async handleAddSignersButtonClick(e,t){if(t.validate()){const s=new BX.Sign.V2.Grid.B2e.Signers;await s.addSigners(e,t.getEntities(),t.isRejectExcludedEnabled())}}}function R(){if(BX.Main.gridManager){return BX.Main.gridManager}const e=BX.SidePanel.Instance.getPreviousSlider(BX.SidePanel.Instance.getSliderByWindow(window));const t=e?e.getWindow():window.top;return t==null?void 0:t.BX.Main.gridManager}e.Signers=T})(this.BX.Sign.V2.Grid.B2e=this.BX.Sign.V2.Grid.B2e||{},BX.Sign.V2,BX.UI.Dialogs,BX,BX.UI,BX.Main);
//# sourceMappingURL=signers.bundle.map.js