this.BX=this.BX||{};(function(e,s,t,l,a){"use strict";let i=e=>e,r;const o=s.Reflection.namespace("BX.Sign");const c={HEAD:"1",DEPUTY_HEAD:"3"};const b="#id_representative";const n="#id_reviewer";const d="#id_editor";var v=babelHelpers.classPrivateFieldLooseKey("buttonNode");var p=babelHelpers.classPrivateFieldLooseKey("select");var u=babelHelpers.classPrivateFieldLooseKey("documentType");var P=babelHelpers.classPrivateFieldLooseKey("formName");var h=babelHelpers.classPrivateFieldLooseKey("api");var f=babelHelpers.classPrivateFieldLooseKey("templateId");var L=babelHelpers.classPrivateFieldLooseKey("previousData");var F=babelHelpers.classPrivateFieldLooseKey("openSlider");var H=babelHelpers.classPrivateFieldLooseKey("onSliderClose");var B=babelHelpers.classPrivateFieldLooseKey("setTemplateList");var y=babelHelpers.classPrivateFieldLooseKey("setSelectorValues");var m=babelHelpers.classPrivateFieldLooseKey("getUserSelectorsMap");var g=babelHelpers.classPrivateFieldLooseKey("getDialog");var S=babelHelpers.classPrivateFieldLooseKey("getUserSelector");var O=babelHelpers.classPrivateFieldLooseKey("updateTemplateListSelect");var j=babelHelpers.classPrivateFieldLooseKey("updateTagSelectors");var E=babelHelpers.classPrivateFieldLooseKey("selectMembers");var K=babelHelpers.classPrivateFieldLooseKey("loadTemplatesList");class T extends t.EventEmitter{constructor(e){super();Object.defineProperty(this,K,{value:U});Object.defineProperty(this,E,{value:V});Object.defineProperty(this,j,{value:R});Object.defineProperty(this,O,{value:M});Object.defineProperty(this,S,{value:_});Object.defineProperty(this,g,{value:N});Object.defineProperty(this,m,{value:A});Object.defineProperty(this,y,{value:X});Object.defineProperty(this,B,{value:I});Object.defineProperty(this,H,{value:D});Object.defineProperty(this,F,{value:w});Object.defineProperty(this,v,{writable:true,value:null});Object.defineProperty(this,p,{writable:true,value:null});Object.defineProperty(this,u,{writable:true,value:[]});Object.defineProperty(this,P,{writable:true,value:void 0});Object.defineProperty(this,h,{writable:true,value:void 0});Object.defineProperty(this,f,{writable:true,value:void 0});Object.defineProperty(this,L,{writable:true,value:{}});this.setEventNamespace("BX.Sign.SignB2EDocumentActivity");babelHelpers.classPrivateFieldLooseBase(this,v)[v]=e.buttonNode;babelHelpers.classPrivateFieldLooseBase(this,u)[u]=e.documentType;babelHelpers.classPrivateFieldLooseBase(this,p)[p]=e.select;babelHelpers.classPrivateFieldLooseBase(this,h)[h]=new l.Api;babelHelpers.classPrivateFieldLooseBase(this,f)[f]=e.templateId;if(!s.Type.isStringFilled(e.formName)){throw new Error("formName must be filled string")}babelHelpers.classPrivateFieldLooseBase(this,P)[P]=e.formName}init(){babelHelpers.classPrivateFieldLooseBase(this,B)[B]();if(!babelHelpers.classPrivateFieldLooseBase(this,v)[v]){return}s.Event.bind(babelHelpers.classPrivateFieldLooseBase(this,v)[v],"click",babelHelpers.classPrivateFieldLooseBase(this,F)[F].bind(this))}}function w(){BX.SidePanel.Instance.open("/sign/b2e/doc/0/?mode=template&IFRAME=Y&IFRAME_TYPE=SIDE_SLIDER&FROM_ROBOT=1",{width:1250,cacheable:false,events:{onClose:e=>{babelHelpers.classPrivateFieldLooseBase(this,H)[H](e)}}})}async function D(e){const s=e.getSlider();if(s){babelHelpers.classPrivateFieldLooseBase(this,B)[B](true,true)}}function I(e=false,t=false){babelHelpers.classPrivateFieldLooseBase(this,K)[K]().then((({data:l})=>{if(s.Type.isPlainObject(l)){babelHelpers.classPrivateFieldLooseBase(this,O)[O](l,t);Object.entries(babelHelpers.classPrivateFieldLooseBase(this,m)[m]()).forEach((([e,s])=>{const t=babelHelpers.classPrivateFieldLooseBase(this,g)[g](s);if(t===null){return}t.subscribe("onLoad",(()=>{var t;const a=babelHelpers.classPrivateFieldLooseBase(this,f)[f]===""?0:babelHelpers.classPrivateFieldLooseBase(this,f)[f];const i=(t=Object.values(l)[a])==null?void 0:t[`${e}SelectorValue`];if(i){babelHelpers.classPrivateFieldLooseBase(this,y)[y]([i],s)}}));t.load()}));if(e===true){babelHelpers.classPrivateFieldLooseBase(this,j)[j](l)}babelHelpers.classPrivateFieldLooseBase(this,p)[p].onchange=()=>{babelHelpers.classPrivateFieldLooseBase(this,j)[j](l)}}})).catch((e=>console.error(e.errors)))}function X(e,t){const l=babelHelpers.classPrivateFieldLooseBase(this,g)[g](t);if(l===null){return}l.getSelectedItems().forEach((e=>{e.deselect()}));e.forEach((e=>{let t=null;const a=c[e];if(a!==undefined){t=l.getItem([a,e])}else if(s.Type.isInteger(Number(e))){t=l.getItem(["user",e])}if(t){t.select()}}))}function A(){return{assignee:b,reviewer:n,editor:d}}function N(e){const s=babelHelpers.classPrivateFieldLooseBase(this,S)[S](e);if(!s){return null}return s.tagSelector.getDialog()}function _(e){return BX.Bizproc.UserSelector.getByNode(document.querySelector(e))}function M(e,t){if(babelHelpers.classPrivateFieldLooseBase(this,L)[L]&&t){const s=Object.keys(babelHelpers.classPrivateFieldLooseBase(this,L)[L])[0];const t=Object.keys(e)[0];if(s!==t){babelHelpers.classPrivateFieldLooseBase(this,f)[f]=t}}if(babelHelpers.classPrivateFieldLooseBase(this,p)[p]){babelHelpers.classPrivateFieldLooseBase(this,p)[p].innerHTML=""}Object.entries(e).forEach((([e,{title:t}])=>{const l=babelHelpers.classPrivateFieldLooseBase(this,f)[f]===e?"selected":"";const a=s.Text.encode(e);const o=s.Text.encode(t);const c=s.Tag.render(r||(r=i`<option value="${0}" ${0}>${0}</option>`),a,l,o);s.Dom.append(c,babelHelpers.classPrivateFieldLooseBase(this,p)[p])}));babelHelpers.classPrivateFieldLooseBase(this,L)[L]={...e}}function R(e){const s=babelHelpers.classPrivateFieldLooseBase(this,p)[p].value;if(!(s in e)){return}const t=e[s];if(t){babelHelpers.classPrivateFieldLooseBase(this,E)[E](t)}}function V(e){if(e){babelHelpers.classPrivateFieldLooseBase(this,y)[y]([e.assigneeSelectorValue],b);babelHelpers.classPrivateFieldLooseBase(this,y)[y](e.reviewerSelectorValue,n);babelHelpers.classPrivateFieldLooseBase(this,y)[y]([e.editorSelectorValue],d)}}function U(){return s.ajax.runAction("bizproc.activity.request",{data:{activity:"SignB2EDocumentActivity",documentType:babelHelpers.classPrivateFieldLooseBase(this,u)[u],params:{form_name:babelHelpers.classPrivateFieldLooseBase(this,P)[P]}}})}o.SignB2EDocumentActivity=T;e.SignB2EDocumentActivity=T})(this.BX.Sign=this.BX.Sign||{},BX,BX.Event,BX.Sign.V2,BX.UI.FormElements);
//# sourceMappingURL=script.map.js