(function(){"use strict";BX.namespace("BX.Bizproc.WorkflowEditComponent");if(typeof BX.Bizproc.WorkflowEditComponent.Globals!=="undefined"){return}BX.Bizproc.WorkflowEditComponent.Globals={};BX.Bizproc.WorkflowEditComponent.Globals.init=function(o){this.documentTypeSigned=String(o.documentTypeSigned)};BX.Bizproc.WorkflowEditComponent.Globals.onAfterSliderClose=function(o,e){var t=o.getData();if(t.get("upsert")){var a=t.get("upsert");for(var r in a){e[r]=a[r]}}if(t.get("delete")){var n=t.get("delete");for(var l in n){delete e[n[l]]}}};BX.Bizproc.WorkflowEditComponent.Globals.showGlobalVariables=function(){var o=this;BX.Bizproc.Globals.Manager.Instance.showGlobals(BX.Bizproc.Globals.Manager.Instance.mode.variable,String(this.documentTypeSigned)).then((function(e){o.onAfterSliderClose(e,arWorkflowGlobalVariables)}))};BX.Bizproc.WorkflowEditComponent.Globals.showGlobalConstants=function(){var o=this;BX.Bizproc.Globals.Manager.Instance.showGlobals(BX.Bizproc.Globals.Manager.Instance.mode.constant,String(this.documentTypeSigned)).then((function(e){o.onAfterSliderClose(e,arWorkflowGlobalConstants)}))};BX.Bizproc.WorkflowEditComponent.Globals.showDrafts=function(o){const e=BX.Uri.addParam("/bitrix/tools/bizproc/show_dratfs_tmp.php",{signedDocumentType:o});BX.SidePanel.Instance.open(e,{width:900,cacheable:false,allowChangeHistory:false})};BX.Bizproc.WorkflowEditComponent.Globals.loadDraft=function(o){return new Promise(((e,t)=>{BX.ajax.runAction("bizprocdesigner.Template.loadDraft",{data:{draftId:o}}).then((o=>{if(!o.data||!o.data.TEMPLATE_DATA){return}const{TEMPLATE:t,NAME:a,DESCRIPTION:r,AUTO_EXECUTE:n,SORT:l,IS_SYSTEM:i}=o.data.TEMPLATE_DATA;if(!t||t.length===0){return}arWorkflowTemplate=t[0];workflowTemplateName=a||"";workflowTemplateDescription=r||"";workflowTemplateAutostart=n||1;workflowTemplateSort=l||10;workflowTemplateIsSystem=i??"N";BPTemplateIsModified=true;ReDraw();e(o.data)})).catch((o=>{alert(o.errors?.[0]?.message);t(o)}))}))}})();function BPImportToClipboard(){var o=JSON.stringify({template:rootActivity.Serialize(),parameters:arWorkflowParameters,variables:arWorkflowVariables,constants:arWorkflowConstants});BX.clipboard.copy(encodeURIComponent(o))}function BPExportFromString(o){try{var e=JSON.parse(decodeURIComponent(o))}catch(o){e={}}if(e.parameters&&BX.type.isPlainObject(e.parameters)){arWorkflowParameters=e.parameters}if(e.variables&&BX.type.isPlainObject(e.variables)){arWorkflowVariables=e.variables}if(e.constants&&BX.type.isPlainObject(e.constants)){arWorkflowConstants=e.constants}if(e.template&&BX.type.isPlainObject(e.template)){arWorkflowTemplate=e.template;ReDraw()}}
//# sourceMappingURL=script.map.js